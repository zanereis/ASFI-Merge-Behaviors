[{"url":"https://api.github.com/repos/apache/spark/pulls/32945","id":672389365,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcyMzg5MzY1","html_url":"https://github.com/apache/spark/pull/32945","diff_url":"https://github.com/apache/spark/pull/32945.diff","patch_url":"https://github.com/apache/spark/pull/32945.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32945","number":32945,"state":"closed","locked":false,"title":"[SPARK-35769][SQL] Truncate java.time.Period by fields of year-month interval type","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nSupport truncate java.time.Period by fields of year-month interval type\r\n\r\n### Why are the changes needed?\r\nTo follow the SQL standard and respect the field restriction of the target year-month type.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nAdded UT\r\n","created_at":"2021-06-17T08:39:07Z","updated_at":"2021-06-18T11:22:10Z","closed_at":"2021-06-18T08:56:06Z","merged_at":null,"merge_commit_sha":"e20db10b5db1a5283b26ba7542eb1d4c757a8fdb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32945/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32945/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32945/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d7a1d335c6a72798269fe6a559d97596d983fddc","head":{"label":"AngersZhuuuu:SPARK-35769","ref":"SPARK-35769","sha":"d7a1d335c6a72798269fe6a559d97596d983fddc","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":176224753,"node_id":"MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=","name":"spark","full_name":"AngersZhuuuu/spark","private":false,"owner":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/AngersZhuuuu/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/AngersZhuuuu/spark","forks_url":"https://api.github.com/repos/AngersZhuuuu/spark/forks","keys_url":"https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/AngersZhuuuu/spark/teams","hooks_url":"https://api.github.com/repos/AngersZhuuuu/spark/hooks","issue_events_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/AngersZhuuuu/spark/events","assignees_url":"https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/tags","blobs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/AngersZhuuuu/spark/languages","stargazers_url":"https://api.github.com/repos/AngersZhuuuu/spark/stargazers","contributors_url":"https://api.github.com/repos/AngersZhuuuu/spark/contributors","subscribers_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscribers","subscription_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscription","commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/AngersZhuuuu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/AngersZhuuuu/spark/merges","archive_url":"https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/AngersZhuuuu/spark/downloads","issues_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/AngersZhuuuu/spark/labels{/name}","releases_url":"https://api.github.com/repos/AngersZhuuuu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/AngersZhuuuu/spark/deployments","created_at":"2019-03-18T07:13:25Z","updated_at":"2024-12-31T06:48:27Z","pushed_at":"2024-12-31T06:45:23Z","git_url":"git://github.com/AngersZhuuuu/spark.git","ssh_url":"git@github.com:AngersZhuuuu/spark.git","clone_url":"https://github.com/AngersZhuuuu/spark.git","svn_url":"https://github.com/AngersZhuuuu/spark","homepage":"","size":446399,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"939ae91e00b71eb6048f0ce0ed944b8aabf64b3f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32945"},"html":{"href":"https://github.com/apache/spark/pull/32945"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32945"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32945/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32945/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32945/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d7a1d335c6a72798269fe6a559d97596d983fddc"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32944","id":672382037,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcyMzgyMDM3","html_url":"https://github.com/apache/spark/pull/32944","diff_url":"https://github.com/apache/spark/pull/32944.diff","patch_url":"https://github.com/apache/spark/pull/32944.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32944","number":32944,"state":"closed","locked":false,"title":"[SPARK-35794][SQL] Allow custom plugin for AQE cost evaluator","user":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nCurrent AQE has cost evaluator to decide whether to use new plan after replanning. The current used evaluator is `SimpleCostEvaluator` to make decision based on number of shuffle in the query plan. This is not perfect cost evaluator, and different production environments might want to use different custom evaluators. E.g., sometimes we might want to still do skew join even though it might introduce extra shuffle (trade off resource for better latency), sometimes we might want to take sort into consideration for cost as well. Take our own setting as an example, we are using a custom remote shuffle service (Cosco), and the cost model is more complicated. So We want to make the cost evaluator to be pluggable, and developers can implement their own `CostEvaluator` subclass and plug in dynamically based on configuration.\r\n\r\nThe approach is to introduce a new config to allow define sub-class name of `CostEvaluator` - `spark.sql.adaptive.customCostEvaluatorClass`. And add `CostEvaluator.instantiate` to instantiate the cost evaluator class in `AdaptiveSparkPlanExec.costEvaluator`.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nMake AQE cost evaluation more flexible.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo but an internal config is introduced - `spark.sql.adaptive.customCostEvaluatorClass` to allow custom implementation of `CostEvaluator`.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nAdded unit test in `AdaptiveQueryExecSuite.scala`.","created_at":"2021-06-17T08:31:32Z","updated_at":"2021-07-06T04:55:28Z","closed_at":"2021-07-05T09:06:53Z","merged_at":null,"merge_commit_sha":"1fb789f16d613876248c101f8b53cb741807d279","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32944/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32944/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32944/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ac5c12186035a47bbe7c0b1891564066db676354","head":{"label":"c21:aqe-cost","ref":"aqe-cost","sha":"ac5c12186035a47bbe7c0b1891564066db676354","user":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":159474643,"node_id":"MDEwOlJlcG9zaXRvcnkxNTk0NzQ2NDM=","name":"spark","full_name":"c21/spark","private":false,"owner":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/c21/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/c21/spark","forks_url":"https://api.github.com/repos/c21/spark/forks","keys_url":"https://api.github.com/repos/c21/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/c21/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/c21/spark/teams","hooks_url":"https://api.github.com/repos/c21/spark/hooks","issue_events_url":"https://api.github.com/repos/c21/spark/issues/events{/number}","events_url":"https://api.github.com/repos/c21/spark/events","assignees_url":"https://api.github.com/repos/c21/spark/assignees{/user}","branches_url":"https://api.github.com/repos/c21/spark/branches{/branch}","tags_url":"https://api.github.com/repos/c21/spark/tags","blobs_url":"https://api.github.com/repos/c21/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/c21/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/c21/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/c21/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/c21/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/c21/spark/languages","stargazers_url":"https://api.github.com/repos/c21/spark/stargazers","contributors_url":"https://api.github.com/repos/c21/spark/contributors","subscribers_url":"https://api.github.com/repos/c21/spark/subscribers","subscription_url":"https://api.github.com/repos/c21/spark/subscription","commits_url":"https://api.github.com/repos/c21/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/c21/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/c21/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/c21/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/c21/spark/contents/{+path}","compare_url":"https://api.github.com/repos/c21/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/c21/spark/merges","archive_url":"https://api.github.com/repos/c21/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/c21/spark/downloads","issues_url":"https://api.github.com/repos/c21/spark/issues{/number}","pulls_url":"https://api.github.com/repos/c21/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/c21/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/c21/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/c21/spark/labels{/name}","releases_url":"https://api.github.com/repos/c21/spark/releases{/id}","deployments_url":"https://api.github.com/repos/c21/spark/deployments","created_at":"2018-11-28T09:15:08Z","updated_at":"2022-01-05T00:02:56Z","pushed_at":"2022-11-14T20:23:44Z","git_url":"git://github.com/c21/spark.git","ssh_url":"git@github.com:c21/spark.git","clone_url":"https://github.com/c21/spark.git","svn_url":"https://github.com/c21/spark","homepage":null,"size":420642,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"0c9c8ff56933e6ae13454845e831746360af84e3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32944"},"html":{"href":"https://github.com/apache/spark/pull/32944"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32944"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32944/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32944/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32944/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ac5c12186035a47bbe7c0b1891564066db676354"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32943","id":672288409,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcyMjg4NDA5","html_url":"https://github.com/apache/spark/pull/32943","diff_url":"https://github.com/apache/spark/pull/32943.diff","patch_url":"https://github.com/apache/spark/pull/32943.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32943","number":32943,"state":"closed","locked":false,"title":"[SPARK-35735][SQL]  Take into account day-time interval fields in cast","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nSupport take into account day-time interval field in cast.\r\n\r\n### Why are the changes needed?\r\nTo conform to the SQL standard.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nAn user can use `cast(str, DayTimeInterval(DAY, HOUR))`, for instance.\r\n\r\n### How was this patch tested?\r\nAdded UT.","created_at":"2021-06-17T06:50:02Z","updated_at":"2021-06-30T13:05:27Z","closed_at":"2021-06-30T13:05:27Z","merged_at":null,"merge_commit_sha":"b362535f47631fde26096a7edc0f2704bcc756fe","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32943/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32943/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32943/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7dfa4f88762bc262a3822e58aa8626e9d10f3a9b","head":{"label":"AngersZhuuuu:SPARK-35735","ref":"SPARK-35735","sha":"7dfa4f88762bc262a3822e58aa8626e9d10f3a9b","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":176224753,"node_id":"MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=","name":"spark","full_name":"AngersZhuuuu/spark","private":false,"owner":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/AngersZhuuuu/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/AngersZhuuuu/spark","forks_url":"https://api.github.com/repos/AngersZhuuuu/spark/forks","keys_url":"https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/AngersZhuuuu/spark/teams","hooks_url":"https://api.github.com/repos/AngersZhuuuu/spark/hooks","issue_events_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/AngersZhuuuu/spark/events","assignees_url":"https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/tags","blobs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/AngersZhuuuu/spark/languages","stargazers_url":"https://api.github.com/repos/AngersZhuuuu/spark/stargazers","contributors_url":"https://api.github.com/repos/AngersZhuuuu/spark/contributors","subscribers_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscribers","subscription_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscription","commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/AngersZhuuuu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/AngersZhuuuu/spark/merges","archive_url":"https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/AngersZhuuuu/spark/downloads","issues_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/AngersZhuuuu/spark/labels{/name}","releases_url":"https://api.github.com/repos/AngersZhuuuu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/AngersZhuuuu/spark/deployments","created_at":"2019-03-18T07:13:25Z","updated_at":"2024-12-31T06:48:27Z","pushed_at":"2024-12-31T06:45:23Z","git_url":"git://github.com/AngersZhuuuu/spark.git","ssh_url":"git@github.com:AngersZhuuuu/spark.git","clone_url":"https://github.com/AngersZhuuuu/spark.git","svn_url":"https://github.com/AngersZhuuuu/spark","homepage":"","size":446399,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5e77ca807170893ccb075dfe9747e2341ccd4b04","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32943"},"html":{"href":"https://github.com/apache/spark/pull/32943"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32943"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32943/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32943/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32943/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7dfa4f88762bc262a3822e58aa8626e9d10f3a9b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32942","id":672272096,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcyMjcyMDk2","html_url":"https://github.com/apache/spark/pull/32942","diff_url":"https://github.com/apache/spark/pull/32942.diff","patch_url":"https://github.com/apache/spark/pull/32942.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32942","number":32942,"state":"closed","locked":false,"title":"[SPARK-35378][SQL][FOLLOWUP] Move CommandResult to catalyst.plans.logical","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nhttps://github.com/apache/spark/pull/32513 added the case class `CommandResult` in package `org.apache.spark.sql.expression`. It is not suitable, so this PR move `CommandResult` from `org.apache.spark.sql.expression` to `org.apache.spark.sql.catalyst.plans.logical`.\r\n\r\n\r\n### Why are the changes needed?\r\nMake `CommandResult` in suitable package.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n'No'.\r\n\r\n\r\n### How was this patch tested?\r\nNo need.\r\n","created_at":"2021-06-17T06:30:33Z","updated_at":"2021-06-18T02:08:27Z","closed_at":"2021-06-17T14:47:54Z","merged_at":null,"merge_commit_sha":"c6aa09322e16b3422ae57827bf00e42965a7dfa2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32942/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32942/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32942/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/4e8c7622983d2c09903a8f44be12ac9a07b0a049","head":{"label":"beliefer:SPARK-35378-followup","ref":"SPARK-35378-followup","sha":"4e8c7622983d2c09903a8f44be12ac9a07b0a049","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":237617513,"node_id":"MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=","name":"spark","full_name":"beliefer/spark","private":false,"owner":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/beliefer/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/beliefer/spark","forks_url":"https://api.github.com/repos/beliefer/spark/forks","keys_url":"https://api.github.com/repos/beliefer/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/beliefer/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/beliefer/spark/teams","hooks_url":"https://api.github.com/repos/beliefer/spark/hooks","issue_events_url":"https://api.github.com/repos/beliefer/spark/issues/events{/number}","events_url":"https://api.github.com/repos/beliefer/spark/events","assignees_url":"https://api.github.com/repos/beliefer/spark/assignees{/user}","branches_url":"https://api.github.com/repos/beliefer/spark/branches{/branch}","tags_url":"https://api.github.com/repos/beliefer/spark/tags","blobs_url":"https://api.github.com/repos/beliefer/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/beliefer/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/beliefer/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/beliefer/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/beliefer/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/beliefer/spark/languages","stargazers_url":"https://api.github.com/repos/beliefer/spark/stargazers","contributors_url":"https://api.github.com/repos/beliefer/spark/contributors","subscribers_url":"https://api.github.com/repos/beliefer/spark/subscribers","subscription_url":"https://api.github.com/repos/beliefer/spark/subscription","commits_url":"https://api.github.com/repos/beliefer/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/beliefer/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/beliefer/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/beliefer/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/beliefer/spark/contents/{+path}","compare_url":"https://api.github.com/repos/beliefer/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/beliefer/spark/merges","archive_url":"https://api.github.com/repos/beliefer/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/beliefer/spark/downloads","issues_url":"https://api.github.com/repos/beliefer/spark/issues{/number}","pulls_url":"https://api.github.com/repos/beliefer/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/beliefer/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/beliefer/spark/labels{/name}","releases_url":"https://api.github.com/repos/beliefer/spark/releases{/id}","deployments_url":"https://api.github.com/repos/beliefer/spark/deployments","created_at":"2020-02-01T13:17:08Z","updated_at":"2025-01-28T09:45:49Z","pushed_at":"2025-01-28T11:57:29Z","git_url":"git://github.com/beliefer/spark.git","ssh_url":"git@github.com:beliefer/spark.git","clone_url":"https://github.com/beliefer/spark.git","svn_url":"https://github.com/beliefer/spark","homepage":"","size":488033,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"234163fbe08c8ac51b2ce52094c38baaa4e06709","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32942"},"html":{"href":"https://github.com/apache/spark/pull/32942"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32942"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32942/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32942/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32942/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/4e8c7622983d2c09903a8f44be12ac9a07b0a049"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32941","id":672181187,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcyMTgxMTg3","html_url":"https://github.com/apache/spark/pull/32941","diff_url":"https://github.com/apache/spark/pull/32941.diff","patch_url":"https://github.com/apache/spark/pull/32941.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32941","number":32941,"state":"closed","locked":false,"title":"[SPARK-35792][SQL] View should not capture configs used in `RelationConversions`","user":{"login":"linhongliu-db","id":67896261,"node_id":"MDQ6VXNlcjY3ODk2MjYx","avatar_url":"https://avatars.githubusercontent.com/u/67896261?v=4","gravatar_id":"","url":"https://api.github.com/users/linhongliu-db","html_url":"https://github.com/linhongliu-db","followers_url":"https://api.github.com/users/linhongliu-db/followers","following_url":"https://api.github.com/users/linhongliu-db/following{/other_user}","gists_url":"https://api.github.com/users/linhongliu-db/gists{/gist_id}","starred_url":"https://api.github.com/users/linhongliu-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/linhongliu-db/subscriptions","organizations_url":"https://api.github.com/users/linhongliu-db/orgs","repos_url":"https://api.github.com/users/linhongliu-db/repos","events_url":"https://api.github.com/users/linhongliu-db/events{/privacy}","received_events_url":"https://api.github.com/users/linhongliu-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n`RelationConversions` is actually an optimization rule while it's executed in the analysis phase.\r\nFor view, it's designed to only capture semantic configs, so we should ignore the optimization\r\nconfigs that will be used in the analysis phase.\r\n\r\nThis PR also fixes the issue that view resolution will always use the default value for uncaptured config\r\n\r\n\r\n### Why are the changes needed?\r\nBugfix\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes, after this PR view resolution will respect the values set in the current session for the below configs\r\n```\r\n\"spark.sql.hive.convertMetastoreParquet\"\r\n\"spark.sql.hive.convertMetastoreOrc\"\r\n\"spark.sql.hive.convertInsertingPartitionedTable\"\r\n\"spark.sql.hive.convertMetastoreCtas\"\r\n```\r\n\r\n\r\n### How was this patch tested?\r\nBy running new UT:\r\n```\r\n$ build/sbt -Phive-2.3 -Phive-thriftserver \"test:testOnly *HiveSQLViewSuite\"\r\n```\r\n","created_at":"2021-06-17T04:24:17Z","updated_at":"2021-06-17T14:08:08Z","closed_at":"2021-06-17T13:41:11Z","merged_at":null,"merge_commit_sha":"fea3f07a77cb619547f0dd0b51510455cdc6d165","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32941/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32941/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32941/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a3530c029481c182cf6b8c0bc509a2e2c7d20b61","head":{"label":"linhongliu-db:SPARK-35792-ignore-convert-configs","ref":"SPARK-35792-ignore-convert-configs","sha":"a3530c029481c182cf6b8c0bc509a2e2c7d20b61","user":{"login":"linhongliu-db","id":67896261,"node_id":"MDQ6VXNlcjY3ODk2MjYx","avatar_url":"https://avatars.githubusercontent.com/u/67896261?v=4","gravatar_id":"","url":"https://api.github.com/users/linhongliu-db","html_url":"https://github.com/linhongliu-db","followers_url":"https://api.github.com/users/linhongliu-db/followers","following_url":"https://api.github.com/users/linhongliu-db/following{/other_user}","gists_url":"https://api.github.com/users/linhongliu-db/gists{/gist_id}","starred_url":"https://api.github.com/users/linhongliu-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/linhongliu-db/subscriptions","organizations_url":"https://api.github.com/users/linhongliu-db/orgs","repos_url":"https://api.github.com/users/linhongliu-db/repos","events_url":"https://api.github.com/users/linhongliu-db/events{/privacy}","received_events_url":"https://api.github.com/users/linhongliu-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":289223205,"node_id":"MDEwOlJlcG9zaXRvcnkyODkyMjMyMDU=","name":"spark","full_name":"linhongliu-db/spark","private":false,"owner":{"login":"linhongliu-db","id":67896261,"node_id":"MDQ6VXNlcjY3ODk2MjYx","avatar_url":"https://avatars.githubusercontent.com/u/67896261?v=4","gravatar_id":"","url":"https://api.github.com/users/linhongliu-db","html_url":"https://github.com/linhongliu-db","followers_url":"https://api.github.com/users/linhongliu-db/followers","following_url":"https://api.github.com/users/linhongliu-db/following{/other_user}","gists_url":"https://api.github.com/users/linhongliu-db/gists{/gist_id}","starred_url":"https://api.github.com/users/linhongliu-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/linhongliu-db/subscriptions","organizations_url":"https://api.github.com/users/linhongliu-db/orgs","repos_url":"https://api.github.com/users/linhongliu-db/repos","events_url":"https://api.github.com/users/linhongliu-db/events{/privacy}","received_events_url":"https://api.github.com/users/linhongliu-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/linhongliu-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/linhongliu-db/spark","forks_url":"https://api.github.com/repos/linhongliu-db/spark/forks","keys_url":"https://api.github.com/repos/linhongliu-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/linhongliu-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/linhongliu-db/spark/teams","hooks_url":"https://api.github.com/repos/linhongliu-db/spark/hooks","issue_events_url":"https://api.github.com/repos/linhongliu-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/linhongliu-db/spark/events","assignees_url":"https://api.github.com/repos/linhongliu-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/linhongliu-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/linhongliu-db/spark/tags","blobs_url":"https://api.github.com/repos/linhongliu-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/linhongliu-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/linhongliu-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/linhongliu-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/linhongliu-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/linhongliu-db/spark/languages","stargazers_url":"https://api.github.com/repos/linhongliu-db/spark/stargazers","contributors_url":"https://api.github.com/repos/linhongliu-db/spark/contributors","subscribers_url":"https://api.github.com/repos/linhongliu-db/spark/subscribers","subscription_url":"https://api.github.com/repos/linhongliu-db/spark/subscription","commits_url":"https://api.github.com/repos/linhongliu-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/linhongliu-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/linhongliu-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/linhongliu-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/linhongliu-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/linhongliu-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/linhongliu-db/spark/merges","archive_url":"https://api.github.com/repos/linhongliu-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/linhongliu-db/spark/downloads","issues_url":"https://api.github.com/repos/linhongliu-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/linhongliu-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/linhongliu-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/linhongliu-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/linhongliu-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/linhongliu-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/linhongliu-db/spark/deployments","created_at":"2020-08-21T08:51:10Z","updated_at":"2025-01-08T17:15:03Z","pushed_at":"2025-01-08T18:35:59Z","git_url":"git://github.com/linhongliu-db/spark.git","ssh_url":"git@github.com:linhongliu-db/spark.git","clone_url":"https://github.com/linhongliu-db/spark.git","svn_url":"https://github.com/linhongliu-db/spark","homepage":"https://spark.apache.org/","size":456796,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"939ae91e00b71eb6048f0ce0ed944b8aabf64b3f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32941"},"html":{"href":"https://github.com/apache/spark/pull/32941"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32941"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32941/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32941/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32941/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a3530c029481c182cf6b8c0bc509a2e2c7d20b61"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32940","id":672152671,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcyMTUyNjcx","html_url":"https://github.com/apache/spark/pull/32940","diff_url":"https://github.com/apache/spark/pull/32940.diff","patch_url":"https://github.com/apache/spark/pull/32940.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32940","number":32940,"state":"closed","locked":false,"title":"[SPARK-35768][SQL] Take into account year-month interval fields in cast","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nSupport take into account year-month interval field in cast\r\n\r\n##### Rule cast to target YearMonthIntervalType\r\n\r\n|  string  | demo | strict target type  |   months |\r\n|---|---|---|---|\r\n|  [+\\|-]y-m | 1-1  | YearMonthIntervalType(YEAR. MONTH) | 13  | \r\n| [+\\|-]y| 1 | YearMonthIntervalType(YEAR. YEAR) | 12  | \r\n| [+\\|-]m | 1 | YearMonthIntervalType(MONTH. MONTH) | 1  | \r\n|  INTERVAL [+\\|-]'[+\\|-]y-m' YEAR TO MONTH | interval '1-1' year to month | YearMonthIntervalType(YEAR. MONTH) | 13  | \r\n|  INTERVAL [+\\|-]'[+\\|-]m' MONTH | interval '1' month | YearMonthIntervalType(MONTH. MONTH) |  1 |\r\n|  INTERVAL [+\\|-]'[+\\|-]y' YEAR | interval '1' year | YearMonthIntervalType(YEAR.YEAR) | 12 |\r\n\r\n\r\n\r\n\r\n### Why are the changes needed?\r\nSupport take into account year-month interval field in cast\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nuser can use `cast(str, YearMonthInterval(YEAR, YEAR))` etc\r\n\r\n### How was this patch tested?\r\nAdded UT","created_at":"2021-06-17T03:34:19Z","updated_at":"2021-06-24T08:00:48Z","closed_at":"2021-06-24T07:49:03Z","merged_at":null,"merge_commit_sha":"f282d970538718512140394bf25ad372a156ce04","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32940/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32940/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32940/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/bb9f055ad27514f574d4bdbe2f91a0a4bf3b43ff","head":{"label":"AngersZhuuuu:SPARK-35768","ref":"SPARK-35768","sha":"bb9f055ad27514f574d4bdbe2f91a0a4bf3b43ff","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":176224753,"node_id":"MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=","name":"spark","full_name":"AngersZhuuuu/spark","private":false,"owner":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/AngersZhuuuu/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/AngersZhuuuu/spark","forks_url":"https://api.github.com/repos/AngersZhuuuu/spark/forks","keys_url":"https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/AngersZhuuuu/spark/teams","hooks_url":"https://api.github.com/repos/AngersZhuuuu/spark/hooks","issue_events_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/AngersZhuuuu/spark/events","assignees_url":"https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/tags","blobs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/AngersZhuuuu/spark/languages","stargazers_url":"https://api.github.com/repos/AngersZhuuuu/spark/stargazers","contributors_url":"https://api.github.com/repos/AngersZhuuuu/spark/contributors","subscribers_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscribers","subscription_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscription","commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/AngersZhuuuu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/AngersZhuuuu/spark/merges","archive_url":"https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/AngersZhuuuu/spark/downloads","issues_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/AngersZhuuuu/spark/labels{/name}","releases_url":"https://api.github.com/repos/AngersZhuuuu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/AngersZhuuuu/spark/deployments","created_at":"2019-03-18T07:13:25Z","updated_at":"2024-12-31T06:48:27Z","pushed_at":"2024-12-31T06:45:23Z","git_url":"git://github.com/AngersZhuuuu/spark.git","ssh_url":"git@github.com:AngersZhuuuu/spark.git","clone_url":"https://github.com/AngersZhuuuu/spark.git","svn_url":"https://github.com/AngersZhuuuu/spark","homepage":"","size":446399,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"20edfdd39a83c52813f91e4028f816d06a6be99e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32940"},"html":{"href":"https://github.com/apache/spark/pull/32940"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32940"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32940/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32940/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32940/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/bb9f055ad27514f574d4bdbe2f91a0a4bf3b43ff"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32939","id":672019646,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcyMDE5NjQ2","html_url":"https://github.com/apache/spark/pull/32939","diff_url":"https://github.com/apache/spark/pull/32939.diff","patch_url":"https://github.com/apache/spark/pull/32939.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32939","number":32939,"state":"closed","locked":false,"title":"[SPARK-35791][SQL] Release on-going map properly for NULL-aware ANTI join","user":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nNULL-aware ANTI join (https://issues.apache.org/jira/browse/SPARK-32290) detects NULL join keys during building the map for `HashedRelation`, and will immediately return `HashedRelationWithAllNullKeys` without taking care of the map built already. Before returning `HashedRelationWithAllNullKeys`, the map needs to be freed properly to save memory and keep memory accounting correctly.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nSave memory and keep memory accounting correctly for the join query.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nExisting unit tests introduced in https://github.com/apache/spark/pull/29104 .","created_at":"2021-06-16T23:59:25Z","updated_at":"2021-06-17T05:58:27Z","closed_at":"2021-06-17T05:57:45Z","merged_at":null,"merge_commit_sha":"a3790a6b9d414c3d523f6c2a9ecd592b5bee5345","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32939/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32939/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32939/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d944e923f9e3a527b8009b34902c984b6bc966bb","head":{"label":"c21:free-null-aware","ref":"free-null-aware","sha":"d944e923f9e3a527b8009b34902c984b6bc966bb","user":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":159474643,"node_id":"MDEwOlJlcG9zaXRvcnkxNTk0NzQ2NDM=","name":"spark","full_name":"c21/spark","private":false,"owner":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/c21/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/c21/spark","forks_url":"https://api.github.com/repos/c21/spark/forks","keys_url":"https://api.github.com/repos/c21/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/c21/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/c21/spark/teams","hooks_url":"https://api.github.com/repos/c21/spark/hooks","issue_events_url":"https://api.github.com/repos/c21/spark/issues/events{/number}","events_url":"https://api.github.com/repos/c21/spark/events","assignees_url":"https://api.github.com/repos/c21/spark/assignees{/user}","branches_url":"https://api.github.com/repos/c21/spark/branches{/branch}","tags_url":"https://api.github.com/repos/c21/spark/tags","blobs_url":"https://api.github.com/repos/c21/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/c21/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/c21/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/c21/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/c21/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/c21/spark/languages","stargazers_url":"https://api.github.com/repos/c21/spark/stargazers","contributors_url":"https://api.github.com/repos/c21/spark/contributors","subscribers_url":"https://api.github.com/repos/c21/spark/subscribers","subscription_url":"https://api.github.com/repos/c21/spark/subscription","commits_url":"https://api.github.com/repos/c21/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/c21/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/c21/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/c21/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/c21/spark/contents/{+path}","compare_url":"https://api.github.com/repos/c21/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/c21/spark/merges","archive_url":"https://api.github.com/repos/c21/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/c21/spark/downloads","issues_url":"https://api.github.com/repos/c21/spark/issues{/number}","pulls_url":"https://api.github.com/repos/c21/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/c21/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/c21/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/c21/spark/labels{/name}","releases_url":"https://api.github.com/repos/c21/spark/releases{/id}","deployments_url":"https://api.github.com/repos/c21/spark/deployments","created_at":"2018-11-28T09:15:08Z","updated_at":"2022-01-05T00:02:56Z","pushed_at":"2022-11-14T20:23:44Z","git_url":"git://github.com/c21/spark.git","ssh_url":"git@github.com:c21/spark.git","clone_url":"https://github.com/c21/spark.git","svn_url":"https://github.com/c21/spark","homepage":null,"size":420642,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"8e594f084a9f307cefcad13ccf439b0b608228c9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32939"},"html":{"href":"https://github.com/apache/spark/pull/32939"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32939"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32939/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32939/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32939/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d944e923f9e3a527b8009b34902c984b6bc966bb"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32938","id":671914319,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxOTE0MzE5","html_url":"https://github.com/apache/spark/pull/32938","diff_url":"https://github.com/apache/spark/pull/32938.diff","patch_url":"https://github.com/apache/spark/pull/32938.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32938","number":32938,"state":"closed","locked":false,"title":"[SPARK-35800][SS] Improving GroupState testability by introducing TestGroupState","user":{"login":"lizhangdatabricks","id":85116904,"node_id":"MDQ6VXNlcjg1MTE2OTA0","avatar_url":"https://avatars.githubusercontent.com/u/85116904?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhangdatabricks","html_url":"https://github.com/lizhangdatabricks","followers_url":"https://api.github.com/users/lizhangdatabricks/followers","following_url":"https://api.github.com/users/lizhangdatabricks/following{/other_user}","gists_url":"https://api.github.com/users/lizhangdatabricks/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhangdatabricks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhangdatabricks/subscriptions","organizations_url":"https://api.github.com/users/lizhangdatabricks/orgs","repos_url":"https://api.github.com/users/lizhangdatabricks/repos","events_url":"https://api.github.com/users/lizhangdatabricks/events{/privacy}","received_events_url":"https://api.github.com/users/lizhangdatabricks/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nProposed changes in this pull request:\r\n\r\n1. Introducing the `TestGroupState` interface which is inherited from `GroupState` so that testing related getters can be exposed in a controlled manner\r\n2. Changing `GroupStateImpl` to inherit from `TestGroupState` interface, instead of directly from `GroupState`\r\n3. Implementing `TestGroupState` object with `create()` method to forward inputs to the private `GroupStateImpl` constructor\r\n4. User input validations have been added into `GroupStateImpl`'s `createForStreaming()` method to prevent users from creating invalid GroupState objects.\r\n5. Replacing existing `GroupStateImpl` usages in sql pkg internal unit tests with the newly added `TestGroupState` to give user best practice about `TestGroupState` usage.\r\n\r\nWith the changes in this PR, the class hierarchy is changed from `GroupStateImpl` -> `GroupState` to `GroupStateImpl` -> `TestGroupState` -> `GroupState` (-> means inherits from)\r\n\r\n### Why are the changes needed?\r\nThe internal `GroupStateImpl` implementation for the `GroupState` interface has no public constructors accessible outside of the sql pkg. However, the user-provided state transition function for `[map|flatMap]GroupsWithState` requires a `GroupState` object as the prevState input.\r\n \r\nCurrently, users are calling the Structured Streaming engine in their unit tests in order to instantiate such `GroupState` instances, which makes UTs cumbersome.\r\n\r\nThe proposed `TestGroupState` interface is to give users controlled access to the `GroupStateImpl` internal implementation to largely improve testability of Structured Streaming state transition functions.\r\n\r\n**Usage Example**\r\n```\r\nimport org.apache.spark.sql.streaming.TestGroupState\r\n\r\ntest(“Structured Streaming state update function”) {\r\n  var prevState = TestGroupState.create[UserStatus](\r\n    optionalState = Optional.empty[UserStatus],\r\n    timeoutConf = EventTimeTimeout,\r\n    batchProcessingTimeMs = 1L,\r\n    eventTimeWatermarkMs = Optional.of(1L),\r\n    hasTimedOut = false)\r\n\r\n  val userId: String = ...\r\n  val actions: Iterator[UserAction] = ...\r\n\r\n  assert(!prevState.hasUpdated)\r\n\r\n  updateState(userId, actions, prevState)\r\n\r\n  assert(prevState.hasUpdated)\r\n}\r\n```\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes, the `TestGroupState` interface and its corresponding `create()` factory function in its companion object are introduced in this pull request for users to use in unit tests.\r\n\r\n### How was this patch tested?\r\n- New unit tests are added\r\n- Existing GroupState unit tests are updated","created_at":"2021-06-16T21:21:28Z","updated_at":"2021-06-23T05:24:50Z","closed_at":"2021-06-22T19:04:50Z","merged_at":null,"merge_commit_sha":"10d93f53aae00d162d95282823496414c74c8527","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32938/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32938/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32938/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ba3a3abf60b92bcbc309306c639d00612766921b","head":{"label":"lizhangdatabricks:improve-group-state-testability","ref":"improve-group-state-testability","sha":"ba3a3abf60b92bcbc309306c639d00612766921b","user":{"login":"lizhangdatabricks","id":85116904,"node_id":"MDQ6VXNlcjg1MTE2OTA0","avatar_url":"https://avatars.githubusercontent.com/u/85116904?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhangdatabricks","html_url":"https://github.com/lizhangdatabricks","followers_url":"https://api.github.com/users/lizhangdatabricks/followers","following_url":"https://api.github.com/users/lizhangdatabricks/following{/other_user}","gists_url":"https://api.github.com/users/lizhangdatabricks/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhangdatabricks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhangdatabricks/subscriptions","organizations_url":"https://api.github.com/users/lizhangdatabricks/orgs","repos_url":"https://api.github.com/users/lizhangdatabricks/repos","events_url":"https://api.github.com/users/lizhangdatabricks/events{/privacy}","received_events_url":"https://api.github.com/users/lizhangdatabricks/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":377603845,"node_id":"MDEwOlJlcG9zaXRvcnkzNzc2MDM4NDU=","name":"spark","full_name":"lizhangdatabricks/spark","private":false,"owner":{"login":"lizhangdatabricks","id":85116904,"node_id":"MDQ6VXNlcjg1MTE2OTA0","avatar_url":"https://avatars.githubusercontent.com/u/85116904?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhangdatabricks","html_url":"https://github.com/lizhangdatabricks","followers_url":"https://api.github.com/users/lizhangdatabricks/followers","following_url":"https://api.github.com/users/lizhangdatabricks/following{/other_user}","gists_url":"https://api.github.com/users/lizhangdatabricks/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhangdatabricks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhangdatabricks/subscriptions","organizations_url":"https://api.github.com/users/lizhangdatabricks/orgs","repos_url":"https://api.github.com/users/lizhangdatabricks/repos","events_url":"https://api.github.com/users/lizhangdatabricks/events{/privacy}","received_events_url":"https://api.github.com/users/lizhangdatabricks/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/lizhangdatabricks/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/lizhangdatabricks/spark","forks_url":"https://api.github.com/repos/lizhangdatabricks/spark/forks","keys_url":"https://api.github.com/repos/lizhangdatabricks/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/lizhangdatabricks/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/lizhangdatabricks/spark/teams","hooks_url":"https://api.github.com/repos/lizhangdatabricks/spark/hooks","issue_events_url":"https://api.github.com/repos/lizhangdatabricks/spark/issues/events{/number}","events_url":"https://api.github.com/repos/lizhangdatabricks/spark/events","assignees_url":"https://api.github.com/repos/lizhangdatabricks/spark/assignees{/user}","branches_url":"https://api.github.com/repos/lizhangdatabricks/spark/branches{/branch}","tags_url":"https://api.github.com/repos/lizhangdatabricks/spark/tags","blobs_url":"https://api.github.com/repos/lizhangdatabricks/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/lizhangdatabricks/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/lizhangdatabricks/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/lizhangdatabricks/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/lizhangdatabricks/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/lizhangdatabricks/spark/languages","stargazers_url":"https://api.github.com/repos/lizhangdatabricks/spark/stargazers","contributors_url":"https://api.github.com/repos/lizhangdatabricks/spark/contributors","subscribers_url":"https://api.github.com/repos/lizhangdatabricks/spark/subscribers","subscription_url":"https://api.github.com/repos/lizhangdatabricks/spark/subscription","commits_url":"https://api.github.com/repos/lizhangdatabricks/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/lizhangdatabricks/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/lizhangdatabricks/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/lizhangdatabricks/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/lizhangdatabricks/spark/contents/{+path}","compare_url":"https://api.github.com/repos/lizhangdatabricks/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/lizhangdatabricks/spark/merges","archive_url":"https://api.github.com/repos/lizhangdatabricks/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/lizhangdatabricks/spark/downloads","issues_url":"https://api.github.com/repos/lizhangdatabricks/spark/issues{/number}","pulls_url":"https://api.github.com/repos/lizhangdatabricks/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/lizhangdatabricks/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/lizhangdatabricks/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/lizhangdatabricks/spark/labels{/name}","releases_url":"https://api.github.com/repos/lizhangdatabricks/spark/releases{/id}","deployments_url":"https://api.github.com/repos/lizhangdatabricks/spark/deployments","created_at":"2021-06-16T19:19:22Z","updated_at":"2021-06-16T19:19:23Z","pushed_at":"2021-06-22T14:42:00Z","git_url":"git://github.com/lizhangdatabricks/spark.git","ssh_url":"git@github.com:lizhangdatabricks/spark.git","clone_url":"https://github.com/lizhangdatabricks/spark.git","svn_url":"https://github.com/lizhangdatabricks/spark","homepage":"https://spark.apache.org/","size":375519,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"506ef9aad7a826e1cac5300eb1c30262f1c46e51","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32938"},"html":{"href":"https://github.com/apache/spark/pull/32938"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32938"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32938/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32938/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32938/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ba3a3abf60b92bcbc309306c639d00612766921b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32937","id":671727422,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxNzI3NDIy","html_url":"https://github.com/apache/spark/pull/32937","diff_url":"https://github.com/apache/spark/pull/32937.diff","patch_url":"https://github.com/apache/spark/pull/32937.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32937","number":32937,"state":"closed","locked":false,"title":"[SPARK-35789][SQL] Refine lateral join syntax to only allow subqueries","user":{"login":"allisonwang-db","id":66282705,"node_id":"MDQ6VXNlcjY2MjgyNzA1","avatar_url":"https://avatars.githubusercontent.com/u/66282705?v=4","gravatar_id":"","url":"https://api.github.com/users/allisonwang-db","html_url":"https://github.com/allisonwang-db","followers_url":"https://api.github.com/users/allisonwang-db/followers","following_url":"https://api.github.com/users/allisonwang-db/following{/other_user}","gists_url":"https://api.github.com/users/allisonwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/allisonwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/allisonwang-db/subscriptions","organizations_url":"https://api.github.com/users/allisonwang-db/orgs","repos_url":"https://api.github.com/users/allisonwang-db/repos","events_url":"https://api.github.com/users/allisonwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/allisonwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR is a follow-up for SPARK-34382. It refines the lateral join syntax to only allow the LATERAL keyword to be in front of subqueries, instead of all `relationPriamry`. For example, `SELECT * FROM t1, LATERAL t2` should not be allowed. \r\n\r\n### Why are the changes needed?\r\nTo be consistent with Postgres.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes. After this PR, the LATERAL keyword can only be in front of subqueries.\r\n\r\n```scala\r\nsql(\"SELECT * FROM t1, LATERAL t2\")\r\n\r\norg.apache.spark.sql.catalyst.parser.ParseException:\r\nLATERAL can only be used with subquery(line 1, pos 26)\r\n\r\n== SQL ==\r\nselect * from t1, lateral t2\r\n--------------------------^^^\r\n```\r\n\r\n### How was this patch tested?\r\nNew unit tests.","created_at":"2021-06-16T17:45:24Z","updated_at":"2024-01-19T01:22:31Z","closed_at":"2021-06-17T16:47:51Z","merged_at":null,"merge_commit_sha":"09ef7987263eb9ce8c121ea4050b1a9d55187fe9","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32937/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32937/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32937/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/243d80eb53cc9e7fe7731f6bc84760d7b695b8a0","head":{"label":"allisonwang-db:spark-35789-lateral-join-parser","ref":"spark-35789-lateral-join-parser","sha":"243d80eb53cc9e7fe7731f6bc84760d7b695b8a0","user":{"login":"allisonwang-db","id":66282705,"node_id":"MDQ6VXNlcjY2MjgyNzA1","avatar_url":"https://avatars.githubusercontent.com/u/66282705?v=4","gravatar_id":"","url":"https://api.github.com/users/allisonwang-db","html_url":"https://github.com/allisonwang-db","followers_url":"https://api.github.com/users/allisonwang-db/followers","following_url":"https://api.github.com/users/allisonwang-db/following{/other_user}","gists_url":"https://api.github.com/users/allisonwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/allisonwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/allisonwang-db/subscriptions","organizations_url":"https://api.github.com/users/allisonwang-db/orgs","repos_url":"https://api.github.com/users/allisonwang-db/repos","events_url":"https://api.github.com/users/allisonwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/allisonwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":271915022,"node_id":"MDEwOlJlcG9zaXRvcnkyNzE5MTUwMjI=","name":"spark","full_name":"allisonwang-db/spark","private":false,"owner":{"login":"allisonwang-db","id":66282705,"node_id":"MDQ6VXNlcjY2MjgyNzA1","avatar_url":"https://avatars.githubusercontent.com/u/66282705?v=4","gravatar_id":"","url":"https://api.github.com/users/allisonwang-db","html_url":"https://github.com/allisonwang-db","followers_url":"https://api.github.com/users/allisonwang-db/followers","following_url":"https://api.github.com/users/allisonwang-db/following{/other_user}","gists_url":"https://api.github.com/users/allisonwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/allisonwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/allisonwang-db/subscriptions","organizations_url":"https://api.github.com/users/allisonwang-db/orgs","repos_url":"https://api.github.com/users/allisonwang-db/repos","events_url":"https://api.github.com/users/allisonwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/allisonwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/allisonwang-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/allisonwang-db/spark","forks_url":"https://api.github.com/repos/allisonwang-db/spark/forks","keys_url":"https://api.github.com/repos/allisonwang-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/allisonwang-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/allisonwang-db/spark/teams","hooks_url":"https://api.github.com/repos/allisonwang-db/spark/hooks","issue_events_url":"https://api.github.com/repos/allisonwang-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/allisonwang-db/spark/events","assignees_url":"https://api.github.com/repos/allisonwang-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/allisonwang-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/allisonwang-db/spark/tags","blobs_url":"https://api.github.com/repos/allisonwang-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/allisonwang-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/allisonwang-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/allisonwang-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/allisonwang-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/allisonwang-db/spark/languages","stargazers_url":"https://api.github.com/repos/allisonwang-db/spark/stargazers","contributors_url":"https://api.github.com/repos/allisonwang-db/spark/contributors","subscribers_url":"https://api.github.com/repos/allisonwang-db/spark/subscribers","subscription_url":"https://api.github.com/repos/allisonwang-db/spark/subscription","commits_url":"https://api.github.com/repos/allisonwang-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/allisonwang-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/allisonwang-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/allisonwang-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/allisonwang-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/allisonwang-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/allisonwang-db/spark/merges","archive_url":"https://api.github.com/repos/allisonwang-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/allisonwang-db/spark/downloads","issues_url":"https://api.github.com/repos/allisonwang-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/allisonwang-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/allisonwang-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/allisonwang-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/allisonwang-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/allisonwang-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/allisonwang-db/spark/deployments","created_at":"2020-06-13T00:43:34Z","updated_at":"2025-01-07T02:25:07Z","pushed_at":"2025-01-24T00:00:13Z","git_url":"git://github.com/allisonwang-db/spark.git","ssh_url":"git@github.com:allisonwang-db/spark.git","clone_url":"https://github.com/allisonwang-db/spark.git","svn_url":"https://github.com/allisonwang-db/spark","homepage":"https://spark.apache.org/","size":467528,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"87bf6b0ea4ca0618c8604895d05037edce8b7cb0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32937"},"html":{"href":"https://github.com/apache/spark/pull/32937"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32937"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32937/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32937/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32937/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/243d80eb53cc9e7fe7731f6bc84760d7b695b8a0"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32936","id":671694492,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxNjk0NDky","html_url":"https://github.com/apache/spark/pull/32936","diff_url":"https://github.com/apache/spark/pull/32936.diff","patch_url":"https://github.com/apache/spark/pull/32936.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32936","number":32936,"state":"closed","locked":false,"title":"[SPARK-35720][SQL] Support casting of String to timestamp without time zone type","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nExtend the Cast expression and support StringType in casting to TimestampWithoutTZType.\r\n\r\nCloses #32898\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo conform the ANSI SQL standard which requires to support such casting.\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo, the new timestamp type is not released yet.\r\n\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit test","created_at":"2021-06-16T17:10:12Z","updated_at":"2021-06-17T20:23:09Z","closed_at":"2021-06-17T18:02:34Z","merged_at":null,"merge_commit_sha":"2d53a4845c799bcff4e27a6b1086dd076383b0b6","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32936/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32936/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32936/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8ca381cd56a4b02f0c93b8bb5092e4bc7106f866","head":{"label":"gengliangwang:castStringToTswtz","ref":"castStringToTswtz","sha":"8ca381cd56a4b02f0c93b8bb5092e4bc7106f866","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"87bf6b0ea4ca0618c8604895d05037edce8b7cb0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32936"},"html":{"href":"https://github.com/apache/spark/pull/32936"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32936"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32936/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32936/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32936/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8ca381cd56a4b02f0c93b8bb5092e4bc7106f866"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32935","id":671667179,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxNjY3MTc5","html_url":"https://github.com/apache/spark/pull/32935","diff_url":"https://github.com/apache/spark/pull/32935.diff","patch_url":"https://github.com/apache/spark/pull/32935.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32935","number":32935,"state":"closed","locked":false,"title":"[WIP] Reproduce `selfDestruct` resulting in immutable pandas DataFrame","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\n","created_at":"2021-06-16T16:39:17Z","updated_at":"2021-07-08T20:54:10Z","closed_at":"2021-07-08T20:54:10Z","merged_at":null,"merge_commit_sha":"6284c09ad1759bfd35a3fef6f05af58416e48941","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":true,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32935/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32935/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32935/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9e2e650c39cf16540396696c3e7111598a4802e1","head":{"label":"xinrong-meng:selfDestruct","ref":"selfDestruct","sha":"9e2e650c39cf16540396696c3e7111598a4802e1","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":335786381,"node_id":"MDEwOlJlcG9zaXRvcnkzMzU3ODYzODE=","name":"spark","full_name":"xinrong-meng/spark","private":false,"owner":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xinrong-meng/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xinrong-meng/spark","forks_url":"https://api.github.com/repos/xinrong-meng/spark/forks","keys_url":"https://api.github.com/repos/xinrong-meng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xinrong-meng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xinrong-meng/spark/teams","hooks_url":"https://api.github.com/repos/xinrong-meng/spark/hooks","issue_events_url":"https://api.github.com/repos/xinrong-meng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xinrong-meng/spark/events","assignees_url":"https://api.github.com/repos/xinrong-meng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xinrong-meng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xinrong-meng/spark/tags","blobs_url":"https://api.github.com/repos/xinrong-meng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xinrong-meng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xinrong-meng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xinrong-meng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xinrong-meng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xinrong-meng/spark/languages","stargazers_url":"https://api.github.com/repos/xinrong-meng/spark/stargazers","contributors_url":"https://api.github.com/repos/xinrong-meng/spark/contributors","subscribers_url":"https://api.github.com/repos/xinrong-meng/spark/subscribers","subscription_url":"https://api.github.com/repos/xinrong-meng/spark/subscription","commits_url":"https://api.github.com/repos/xinrong-meng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xinrong-meng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xinrong-meng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xinrong-meng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xinrong-meng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xinrong-meng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xinrong-meng/spark/merges","archive_url":"https://api.github.com/repos/xinrong-meng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xinrong-meng/spark/downloads","issues_url":"https://api.github.com/repos/xinrong-meng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xinrong-meng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xinrong-meng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xinrong-meng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xinrong-meng/spark/labels{/name}","releases_url":"https://api.github.com/repos/xinrong-meng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xinrong-meng/spark/deployments","created_at":"2021-02-03T23:47:29Z","updated_at":"2024-09-27T08:09:06Z","pushed_at":"2025-02-08T02:14:33Z","git_url":"git://github.com/xinrong-meng/spark.git","ssh_url":"git@github.com:xinrong-meng/spark.git","clone_url":"https://github.com/xinrong-meng/spark.git","svn_url":"https://github.com/xinrong-meng/spark","homepage":"https://spark.apache.org/","size":469811,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":2,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"87bf6b0ea4ca0618c8604895d05037edce8b7cb0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32935"},"html":{"href":"https://github.com/apache/spark/pull/32935"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32935"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32935/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32935/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32935/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9e2e650c39cf16540396696c3e7111598a4802e1"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32934","id":671572578,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxNTcyNTc4","html_url":"https://github.com/apache/spark/pull/32934","diff_url":"https://github.com/apache/spark/pull/32934.diff","patch_url":"https://github.com/apache/spark/pull/32934.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32934","number":32934,"state":"closed","locked":false,"title":"[SPARK-35788][SS] Metrics support for RocksDB instance","user":{"login":"xuanyuanking","id":4833765,"node_id":"MDQ6VXNlcjQ4MzM3NjU=","avatar_url":"https://avatars.githubusercontent.com/u/4833765?v=4","gravatar_id":"","url":"https://api.github.com/users/xuanyuanking","html_url":"https://github.com/xuanyuanking","followers_url":"https://api.github.com/users/xuanyuanking/followers","following_url":"https://api.github.com/users/xuanyuanking/following{/other_user}","gists_url":"https://api.github.com/users/xuanyuanking/gists{/gist_id}","starred_url":"https://api.github.com/users/xuanyuanking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuanyuanking/subscriptions","organizations_url":"https://api.github.com/users/xuanyuanking/orgs","repos_url":"https://api.github.com/users/xuanyuanking/repos","events_url":"https://api.github.com/users/xuanyuanking/events{/privacy}","received_events_url":"https://api.github.com/users/xuanyuanking/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nAdd more metrics for the RocksDB instance. We transform the native states from RocksDB.\r\n\r\n### Why are the changes needed?\r\nImprove the usability with more metrics for RocksDB instance.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nExisting tests.\r\n","created_at":"2021-06-16T15:01:52Z","updated_at":"2021-07-06T05:16:08Z","closed_at":"2021-07-06T02:12:36Z","merged_at":null,"merge_commit_sha":"6fde329d92915394d31423d341dcb32c93e3768b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32934/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32934/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32934/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/355953ea779cbde18511fd150f92b3d5fd2e60ef","head":{"label":"xuanyuanking:SPARK-35788","ref":"SPARK-35788","sha":"355953ea779cbde18511fd150f92b3d5fd2e60ef","user":{"login":"xuanyuanking","id":4833765,"node_id":"MDQ6VXNlcjQ4MzM3NjU=","avatar_url":"https://avatars.githubusercontent.com/u/4833765?v=4","gravatar_id":"","url":"https://api.github.com/users/xuanyuanking","html_url":"https://github.com/xuanyuanking","followers_url":"https://api.github.com/users/xuanyuanking/followers","following_url":"https://api.github.com/users/xuanyuanking/following{/other_user}","gists_url":"https://api.github.com/users/xuanyuanking/gists{/gist_id}","starred_url":"https://api.github.com/users/xuanyuanking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuanyuanking/subscriptions","organizations_url":"https://api.github.com/users/xuanyuanking/orgs","repos_url":"https://api.github.com/users/xuanyuanking/repos","events_url":"https://api.github.com/users/xuanyuanking/events{/privacy}","received_events_url":"https://api.github.com/users/xuanyuanking/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":52511431,"node_id":"MDEwOlJlcG9zaXRvcnk1MjUxMTQzMQ==","name":"spark","full_name":"xuanyuanking/spark","private":false,"owner":{"login":"xuanyuanking","id":4833765,"node_id":"MDQ6VXNlcjQ4MzM3NjU=","avatar_url":"https://avatars.githubusercontent.com/u/4833765?v=4","gravatar_id":"","url":"https://api.github.com/users/xuanyuanking","html_url":"https://github.com/xuanyuanking","followers_url":"https://api.github.com/users/xuanyuanking/followers","following_url":"https://api.github.com/users/xuanyuanking/following{/other_user}","gists_url":"https://api.github.com/users/xuanyuanking/gists{/gist_id}","starred_url":"https://api.github.com/users/xuanyuanking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuanyuanking/subscriptions","organizations_url":"https://api.github.com/users/xuanyuanking/orgs","repos_url":"https://api.github.com/users/xuanyuanking/repos","events_url":"https://api.github.com/users/xuanyuanking/events{/privacy}","received_events_url":"https://api.github.com/users/xuanyuanking/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xuanyuanking/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/xuanyuanking/spark","forks_url":"https://api.github.com/repos/xuanyuanking/spark/forks","keys_url":"https://api.github.com/repos/xuanyuanking/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xuanyuanking/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xuanyuanking/spark/teams","hooks_url":"https://api.github.com/repos/xuanyuanking/spark/hooks","issue_events_url":"https://api.github.com/repos/xuanyuanking/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xuanyuanking/spark/events","assignees_url":"https://api.github.com/repos/xuanyuanking/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xuanyuanking/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xuanyuanking/spark/tags","blobs_url":"https://api.github.com/repos/xuanyuanking/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xuanyuanking/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xuanyuanking/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xuanyuanking/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xuanyuanking/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xuanyuanking/spark/languages","stargazers_url":"https://api.github.com/repos/xuanyuanking/spark/stargazers","contributors_url":"https://api.github.com/repos/xuanyuanking/spark/contributors","subscribers_url":"https://api.github.com/repos/xuanyuanking/spark/subscribers","subscription_url":"https://api.github.com/repos/xuanyuanking/spark/subscription","commits_url":"https://api.github.com/repos/xuanyuanking/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xuanyuanking/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xuanyuanking/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xuanyuanking/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xuanyuanking/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xuanyuanking/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xuanyuanking/spark/merges","archive_url":"https://api.github.com/repos/xuanyuanking/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xuanyuanking/spark/downloads","issues_url":"https://api.github.com/repos/xuanyuanking/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xuanyuanking/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xuanyuanking/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xuanyuanking/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xuanyuanking/spark/labels{/name}","releases_url":"https://api.github.com/repos/xuanyuanking/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xuanyuanking/spark/deployments","created_at":"2016-02-25T09:08:00Z","updated_at":"2022-02-08T22:43:27Z","pushed_at":"2023-09-05T19:46:43Z","git_url":"git://github.com/xuanyuanking/spark.git","ssh_url":"git@github.com:xuanyuanking/spark.git","clone_url":"https://github.com/xuanyuanking/spark.git","svn_url":"https://github.com/xuanyuanking/spark","homepage":null,"size":396515,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["spark"],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"77696448db5975343cf609b51f42702b49d7b08b","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32934"},"html":{"href":"https://github.com/apache/spark/pull/32934"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32934"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32934/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32934/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32934/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/355953ea779cbde18511fd150f92b3d5fd2e60ef"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32933","id":671504590,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxNTA0NTkw","html_url":"https://github.com/apache/spark/pull/32933","diff_url":"https://github.com/apache/spark/pull/32933.diff","patch_url":"https://github.com/apache/spark/pull/32933.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32933","number":32933,"state":"closed","locked":false,"title":"[SPARK-35785][SS] Cleanup support for RocksDB instance","user":{"login":"xuanyuanking","id":4833765,"node_id":"MDQ6VXNlcjQ4MzM3NjU=","avatar_url":"https://avatars.githubusercontent.com/u/4833765?v=4","gravatar_id":"","url":"https://api.github.com/users/xuanyuanking","html_url":"https://github.com/xuanyuanking","followers_url":"https://api.github.com/users/xuanyuanking/followers","following_url":"https://api.github.com/users/xuanyuanking/following{/other_user}","gists_url":"https://api.github.com/users/xuanyuanking/gists{/gist_id}","starred_url":"https://api.github.com/users/xuanyuanking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuanyuanking/subscriptions","organizations_url":"https://api.github.com/users/xuanyuanking/orgs","repos_url":"https://api.github.com/users/xuanyuanking/repos","events_url":"https://api.github.com/users/xuanyuanking/events{/privacy}","received_events_url":"https://api.github.com/users/xuanyuanking/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nAdd the functionality of cleaning up files of old versions for the RocksDB instance and RocksDBFileManager.\r\n\r\n\r\n### Why are the changes needed?\r\nPart of the implementation of RocksDB state store.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nNew UT added.\r\n","created_at":"2021-06-16T14:01:59Z","updated_at":"2021-07-02T17:27:28Z","closed_at":"2021-07-02T07:48:06Z","merged_at":null,"merge_commit_sha":"c03817e4dca3c6932a1a01d81dbdaafe5b37a68f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32933/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32933/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32933/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ea949836c26be0124e37df0eb641be806628d94d","head":{"label":"xuanyuanking:SPARK-35785","ref":"SPARK-35785","sha":"ea949836c26be0124e37df0eb641be806628d94d","user":{"login":"xuanyuanking","id":4833765,"node_id":"MDQ6VXNlcjQ4MzM3NjU=","avatar_url":"https://avatars.githubusercontent.com/u/4833765?v=4","gravatar_id":"","url":"https://api.github.com/users/xuanyuanking","html_url":"https://github.com/xuanyuanking","followers_url":"https://api.github.com/users/xuanyuanking/followers","following_url":"https://api.github.com/users/xuanyuanking/following{/other_user}","gists_url":"https://api.github.com/users/xuanyuanking/gists{/gist_id}","starred_url":"https://api.github.com/users/xuanyuanking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuanyuanking/subscriptions","organizations_url":"https://api.github.com/users/xuanyuanking/orgs","repos_url":"https://api.github.com/users/xuanyuanking/repos","events_url":"https://api.github.com/users/xuanyuanking/events{/privacy}","received_events_url":"https://api.github.com/users/xuanyuanking/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":52511431,"node_id":"MDEwOlJlcG9zaXRvcnk1MjUxMTQzMQ==","name":"spark","full_name":"xuanyuanking/spark","private":false,"owner":{"login":"xuanyuanking","id":4833765,"node_id":"MDQ6VXNlcjQ4MzM3NjU=","avatar_url":"https://avatars.githubusercontent.com/u/4833765?v=4","gravatar_id":"","url":"https://api.github.com/users/xuanyuanking","html_url":"https://github.com/xuanyuanking","followers_url":"https://api.github.com/users/xuanyuanking/followers","following_url":"https://api.github.com/users/xuanyuanking/following{/other_user}","gists_url":"https://api.github.com/users/xuanyuanking/gists{/gist_id}","starred_url":"https://api.github.com/users/xuanyuanking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuanyuanking/subscriptions","organizations_url":"https://api.github.com/users/xuanyuanking/orgs","repos_url":"https://api.github.com/users/xuanyuanking/repos","events_url":"https://api.github.com/users/xuanyuanking/events{/privacy}","received_events_url":"https://api.github.com/users/xuanyuanking/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xuanyuanking/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/xuanyuanking/spark","forks_url":"https://api.github.com/repos/xuanyuanking/spark/forks","keys_url":"https://api.github.com/repos/xuanyuanking/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xuanyuanking/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xuanyuanking/spark/teams","hooks_url":"https://api.github.com/repos/xuanyuanking/spark/hooks","issue_events_url":"https://api.github.com/repos/xuanyuanking/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xuanyuanking/spark/events","assignees_url":"https://api.github.com/repos/xuanyuanking/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xuanyuanking/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xuanyuanking/spark/tags","blobs_url":"https://api.github.com/repos/xuanyuanking/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xuanyuanking/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xuanyuanking/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xuanyuanking/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xuanyuanking/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xuanyuanking/spark/languages","stargazers_url":"https://api.github.com/repos/xuanyuanking/spark/stargazers","contributors_url":"https://api.github.com/repos/xuanyuanking/spark/contributors","subscribers_url":"https://api.github.com/repos/xuanyuanking/spark/subscribers","subscription_url":"https://api.github.com/repos/xuanyuanking/spark/subscription","commits_url":"https://api.github.com/repos/xuanyuanking/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xuanyuanking/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xuanyuanking/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xuanyuanking/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xuanyuanking/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xuanyuanking/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xuanyuanking/spark/merges","archive_url":"https://api.github.com/repos/xuanyuanking/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xuanyuanking/spark/downloads","issues_url":"https://api.github.com/repos/xuanyuanking/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xuanyuanking/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xuanyuanking/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xuanyuanking/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xuanyuanking/spark/labels{/name}","releases_url":"https://api.github.com/repos/xuanyuanking/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xuanyuanking/spark/deployments","created_at":"2016-02-25T09:08:00Z","updated_at":"2022-02-08T22:43:27Z","pushed_at":"2023-09-05T19:46:43Z","git_url":"git://github.com/xuanyuanking/spark.git","ssh_url":"git@github.com:xuanyuanking/spark.git","clone_url":"https://github.com/xuanyuanking/spark.git","svn_url":"https://github.com/xuanyuanking/spark","homepage":null,"size":396515,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["spark"],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"912d2b983402e9217c081a9bafc08c5720c3ad12","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32933"},"html":{"href":"https://github.com/apache/spark/pull/32933"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32933"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32933/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32933/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32933/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ea949836c26be0124e37df0eb641be806628d94d"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32932","id":671416091,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxNDE2MDkx","html_url":"https://github.com/apache/spark/pull/32932","diff_url":"https://github.com/apache/spark/pull/32932.diff","patch_url":"https://github.com/apache/spark/pull/32932.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32932","number":32932,"state":"closed","locked":false,"title":"[SPARK-35786][SQL] Add a new operator to rebalance the query output if AQE is enabled","user":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n* Add a new repartition operator `RebalanceRepartition`.\r\n* Support a new hint `REBALANCE`\r\n\r\nAfter this patch, user can run this query:\r\n```sql\r\nSELECT /*+ REBALANCE(c) */ * FROM t\r\n```\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nAdd a new hint to distingush if we can optimize it safely.\r\n\r\nThis new hint can let AQE optimize with `CustomShuffleReaderExec` safely. Currently, AQE can only coalesce shuffle partitions but can not expand shuffle partitions due to the semantics of output partitioning.\r\nLet's say we have a query:\r\n```sql\r\nSELECT /*+ REPARTITION(col) */ * FROM t\r\n```\r\nAQE can not expand the shuffle partitions even if `col` is skewed because expanding shuffle partitions will break the hashed output paritioning of `RepartitionByExpression`. But if the query is use`REPARTITION_BY_AQE`, AQE can optimize it without considering the semantics of output partitioning.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nYes, a new hint.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nAdd test.","created_at":"2021-06-16T12:35:20Z","updated_at":"2021-06-27T12:34:15Z","closed_at":"2021-06-24T09:04:45Z","merged_at":null,"merge_commit_sha":"e4a928d98d642aecbeb30819a622474367b78937","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32932/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32932/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32932/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0fe14d0001adedef66696699d478dd4d4e9c392c","head":{"label":"ulysses-you:SPARK-35786","ref":"SPARK-35786","sha":"0fe14d0001adedef66696699d478dd4d4e9c392c","user":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":195747855,"node_id":"MDEwOlJlcG9zaXRvcnkxOTU3NDc4NTU=","name":"spark","full_name":"ulysses-you/spark","private":false,"owner":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ulysses-you/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/ulysses-you/spark","forks_url":"https://api.github.com/repos/ulysses-you/spark/forks","keys_url":"https://api.github.com/repos/ulysses-you/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ulysses-you/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ulysses-you/spark/teams","hooks_url":"https://api.github.com/repos/ulysses-you/spark/hooks","issue_events_url":"https://api.github.com/repos/ulysses-you/spark/issues/events{/number}","events_url":"https://api.github.com/repos/ulysses-you/spark/events","assignees_url":"https://api.github.com/repos/ulysses-you/spark/assignees{/user}","branches_url":"https://api.github.com/repos/ulysses-you/spark/branches{/branch}","tags_url":"https://api.github.com/repos/ulysses-you/spark/tags","blobs_url":"https://api.github.com/repos/ulysses-you/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ulysses-you/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ulysses-you/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ulysses-you/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ulysses-you/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ulysses-you/spark/languages","stargazers_url":"https://api.github.com/repos/ulysses-you/spark/stargazers","contributors_url":"https://api.github.com/repos/ulysses-you/spark/contributors","subscribers_url":"https://api.github.com/repos/ulysses-you/spark/subscribers","subscription_url":"https://api.github.com/repos/ulysses-you/spark/subscription","commits_url":"https://api.github.com/repos/ulysses-you/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ulysses-you/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ulysses-you/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ulysses-you/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ulysses-you/spark/contents/{+path}","compare_url":"https://api.github.com/repos/ulysses-you/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ulysses-you/spark/merges","archive_url":"https://api.github.com/repos/ulysses-you/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ulysses-you/spark/downloads","issues_url":"https://api.github.com/repos/ulysses-you/spark/issues{/number}","pulls_url":"https://api.github.com/repos/ulysses-you/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ulysses-you/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ulysses-you/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ulysses-you/spark/labels{/name}","releases_url":"https://api.github.com/repos/ulysses-you/spark/releases{/id}","deployments_url":"https://api.github.com/repos/ulysses-you/spark/deployments","created_at":"2019-07-08T06:11:57Z","updated_at":"2022-01-10T01:34:59Z","pushed_at":"2024-08-13T23:12:37Z","git_url":"git://github.com/ulysses-you/spark.git","ssh_url":"git@github.com:ulysses-you/spark.git","clone_url":"https://github.com/ulysses-you/spark.git","svn_url":"https://github.com/ulysses-you/spark","homepage":"","size":399300,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a2961ddfdf5bb3bc31dc616c1dbd1a2bf7e17265","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32932"},"html":{"href":"https://github.com/apache/spark/pull/32932"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32932"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32932/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32932/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32932/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0fe14d0001adedef66696699d478dd4d4e9c392c"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32931","id":671354968,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxMzU0OTY4","html_url":"https://github.com/apache/spark/pull/32931","diff_url":"https://github.com/apache/spark/pull/32931.diff","patch_url":"https://github.com/apache/spark/pull/32931.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32931","number":32931,"state":"closed","locked":false,"title":"[SPARK-33898][SQL] Support SHOW CREATE TABLE In V2","user":{"login":"Peng-Lei","id":41178002,"node_id":"MDQ6VXNlcjQxMTc4MDAy","avatar_url":"https://avatars.githubusercontent.com/u/41178002?v=4","gravatar_id":"","url":"https://api.github.com/users/Peng-Lei","html_url":"https://github.com/Peng-Lei","followers_url":"https://api.github.com/users/Peng-Lei/followers","following_url":"https://api.github.com/users/Peng-Lei/following{/other_user}","gists_url":"https://api.github.com/users/Peng-Lei/gists{/gist_id}","starred_url":"https://api.github.com/users/Peng-Lei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Peng-Lei/subscriptions","organizations_url":"https://api.github.com/users/Peng-Lei/orgs","repos_url":"https://api.github.com/users/Peng-Lei/repos","events_url":"https://api.github.com/users/Peng-Lei/events{/privacy}","received_events_url":"https://api.github.com/users/Peng-Lei/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n1. Implement V2 execution node `ShowCreateTableExec` similar to V1 `ShowCreateTableCommand`\r\n2. No support `SHOW CREATE TABLE XXX AS SERDE`\r\n\r\n### Why are the changes needed?\r\n[SPARK-33898](https://issues.apache.org/jira/browse/SPARK-33898)\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes. Support the user to execute `SHOW CREATE TABLE` command in V2 table\r\n\r\n### How was this patch tested?\r\nAdd two UT tests\r\n1. ./dev/scalastyle\r\n2. run test DataSourceV2SQLSuite\r\n","created_at":"2021-06-16T11:23:06Z","updated_at":"2021-06-29T02:15:49Z","closed_at":"2021-06-29T02:15:01Z","merged_at":null,"merge_commit_sha":"6cc8486547119b7ce0003b2e153b2eea1a82afd4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32931/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32931/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32931/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b8e6db8840b5de34213179ea54e02db287d6427f","head":{"label":"Peng-Lei:SPARK-33898","ref":"SPARK-33898","sha":"b8e6db8840b5de34213179ea54e02db287d6427f","user":{"login":"Peng-Lei","id":41178002,"node_id":"MDQ6VXNlcjQxMTc4MDAy","avatar_url":"https://avatars.githubusercontent.com/u/41178002?v=4","gravatar_id":"","url":"https://api.github.com/users/Peng-Lei","html_url":"https://github.com/Peng-Lei","followers_url":"https://api.github.com/users/Peng-Lei/followers","following_url":"https://api.github.com/users/Peng-Lei/following{/other_user}","gists_url":"https://api.github.com/users/Peng-Lei/gists{/gist_id}","starred_url":"https://api.github.com/users/Peng-Lei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Peng-Lei/subscriptions","organizations_url":"https://api.github.com/users/Peng-Lei/orgs","repos_url":"https://api.github.com/users/Peng-Lei/repos","events_url":"https://api.github.com/users/Peng-Lei/events{/privacy}","received_events_url":"https://api.github.com/users/Peng-Lei/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":350306448,"node_id":"MDEwOlJlcG9zaXRvcnkzNTAzMDY0NDg=","name":"spark","full_name":"Peng-Lei/spark","private":false,"owner":{"login":"Peng-Lei","id":41178002,"node_id":"MDQ6VXNlcjQxMTc4MDAy","avatar_url":"https://avatars.githubusercontent.com/u/41178002?v=4","gravatar_id":"","url":"https://api.github.com/users/Peng-Lei","html_url":"https://github.com/Peng-Lei","followers_url":"https://api.github.com/users/Peng-Lei/followers","following_url":"https://api.github.com/users/Peng-Lei/following{/other_user}","gists_url":"https://api.github.com/users/Peng-Lei/gists{/gist_id}","starred_url":"https://api.github.com/users/Peng-Lei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Peng-Lei/subscriptions","organizations_url":"https://api.github.com/users/Peng-Lei/orgs","repos_url":"https://api.github.com/users/Peng-Lei/repos","events_url":"https://api.github.com/users/Peng-Lei/events{/privacy}","received_events_url":"https://api.github.com/users/Peng-Lei/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Peng-Lei/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/Peng-Lei/spark","forks_url":"https://api.github.com/repos/Peng-Lei/spark/forks","keys_url":"https://api.github.com/repos/Peng-Lei/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Peng-Lei/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Peng-Lei/spark/teams","hooks_url":"https://api.github.com/repos/Peng-Lei/spark/hooks","issue_events_url":"https://api.github.com/repos/Peng-Lei/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Peng-Lei/spark/events","assignees_url":"https://api.github.com/repos/Peng-Lei/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Peng-Lei/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Peng-Lei/spark/tags","blobs_url":"https://api.github.com/repos/Peng-Lei/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Peng-Lei/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Peng-Lei/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Peng-Lei/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Peng-Lei/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Peng-Lei/spark/languages","stargazers_url":"https://api.github.com/repos/Peng-Lei/spark/stargazers","contributors_url":"https://api.github.com/repos/Peng-Lei/spark/contributors","subscribers_url":"https://api.github.com/repos/Peng-Lei/spark/subscribers","subscription_url":"https://api.github.com/repos/Peng-Lei/spark/subscription","commits_url":"https://api.github.com/repos/Peng-Lei/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Peng-Lei/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Peng-Lei/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Peng-Lei/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Peng-Lei/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Peng-Lei/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Peng-Lei/spark/merges","archive_url":"https://api.github.com/repos/Peng-Lei/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Peng-Lei/spark/downloads","issues_url":"https://api.github.com/repos/Peng-Lei/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Peng-Lei/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Peng-Lei/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Peng-Lei/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Peng-Lei/spark/labels{/name}","releases_url":"https://api.github.com/repos/Peng-Lei/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Peng-Lei/spark/deployments","created_at":"2021-03-22T10:48:39Z","updated_at":"2022-01-06T02:14:06Z","pushed_at":"2022-02-24T07:07:46Z","git_url":"git://github.com/Peng-Lei/spark.git","ssh_url":"git@github.com:Peng-Lei/spark.git","clone_url":"https://github.com/Peng-Lei/spark.git","svn_url":"https://github.com/Peng-Lei/spark","homepage":"https://spark.apache.org/","size":401840,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"356aef48b8dc2fa97b28d960ae9e84a1b7a5752a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32931"},"html":{"href":"https://github.com/apache/spark/pull/32931"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32931"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32931/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32931/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32931/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b8e6db8840b5de34213179ea54e02db287d6427f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32930","id":671251377,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxMjUxMzc3","html_url":"https://github.com/apache/spark/pull/32930","diff_url":"https://github.com/apache/spark/pull/32930.diff","patch_url":"https://github.com/apache/spark/pull/32930.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32930","number":32930,"state":"closed","locked":false,"title":"[SPARK-35732][SQL] Parse DayTimeIntervalType from JSON","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n### What changes were proposed in this pull request?\r\nSupport Parse DayTimeIntervalType from JSON\r\n\r\n### Why are the changes needed?\r\nthis will allow to store day-second intervals as table columns into Hive external catalog.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nAdded UT\r\n","created_at":"2021-06-16T09:21:29Z","updated_at":"2021-06-17T13:08:09Z","closed_at":"2021-06-17T09:54:44Z","merged_at":null,"merge_commit_sha":"4e6303852ca2be707c7893c946db16352e105e84","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32930/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32930/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32930/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8ed6d86480284cb2a0c0c577dcd1539a154c1ad9","head":{"label":"AngersZhuuuu:SPARK-35732","ref":"SPARK-35732","sha":"8ed6d86480284cb2a0c0c577dcd1539a154c1ad9","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":176224753,"node_id":"MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=","name":"spark","full_name":"AngersZhuuuu/spark","private":false,"owner":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/AngersZhuuuu/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/AngersZhuuuu/spark","forks_url":"https://api.github.com/repos/AngersZhuuuu/spark/forks","keys_url":"https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/AngersZhuuuu/spark/teams","hooks_url":"https://api.github.com/repos/AngersZhuuuu/spark/hooks","issue_events_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/AngersZhuuuu/spark/events","assignees_url":"https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/tags","blobs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/AngersZhuuuu/spark/languages","stargazers_url":"https://api.github.com/repos/AngersZhuuuu/spark/stargazers","contributors_url":"https://api.github.com/repos/AngersZhuuuu/spark/contributors","subscribers_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscribers","subscription_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscription","commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/AngersZhuuuu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/AngersZhuuuu/spark/merges","archive_url":"https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/AngersZhuuuu/spark/downloads","issues_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/AngersZhuuuu/spark/labels{/name}","releases_url":"https://api.github.com/repos/AngersZhuuuu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/AngersZhuuuu/spark/deployments","created_at":"2019-03-18T07:13:25Z","updated_at":"2024-12-31T06:48:27Z","pushed_at":"2024-12-31T06:45:23Z","git_url":"git://github.com/AngersZhuuuu/spark.git","ssh_url":"git@github.com:AngersZhuuuu/spark.git","clone_url":"https://github.com/AngersZhuuuu/spark.git","svn_url":"https://github.com/AngersZhuuuu/spark","homepage":"","size":446399,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"939ae91e00b71eb6048f0ce0ed944b8aabf64b3f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32930"},"html":{"href":"https://github.com/apache/spark/pull/32930"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32930"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32930/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32930/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32930/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8ed6d86480284cb2a0c0c577dcd1539a154c1ad9"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32929","id":671245925,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxMjQ1OTI1","html_url":"https://github.com/apache/spark/pull/32929","diff_url":"https://github.com/apache/spark/pull/32929.diff","patch_url":"https://github.com/apache/spark/pull/32929.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32929","number":32929,"state":"closed","locked":false,"title":"[SPARK-35770][SQL] Parse YearMonthIntervalType from JSON","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nParse YearMonthIntervalType from JSON.\r\n\r\n### Why are the changes needed?\r\nThis will allow to store year-month intervals as table columns into Hive external catalog.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nPeople can store year-month interval types as json string.\r\n\r\n### How was this patch tested?\r\nAdded UT.","created_at":"2021-06-16T09:15:18Z","updated_at":"2021-06-17T06:52:05Z","closed_at":"2021-06-17T06:52:05Z","merged_at":null,"merge_commit_sha":"5827c29363849a8ee912b54c365ff7c06f30ca93","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32929/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32929/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32929/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2be136b01fb24c37e7bbd2e7c07b96d4371192a5","head":{"label":"AngersZhuuuu:SPARK-35770","ref":"SPARK-35770","sha":"2be136b01fb24c37e7bbd2e7c07b96d4371192a5","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":176224753,"node_id":"MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=","name":"spark","full_name":"AngersZhuuuu/spark","private":false,"owner":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/AngersZhuuuu/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/AngersZhuuuu/spark","forks_url":"https://api.github.com/repos/AngersZhuuuu/spark/forks","keys_url":"https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/AngersZhuuuu/spark/teams","hooks_url":"https://api.github.com/repos/AngersZhuuuu/spark/hooks","issue_events_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/AngersZhuuuu/spark/events","assignees_url":"https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/tags","blobs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/AngersZhuuuu/spark/languages","stargazers_url":"https://api.github.com/repos/AngersZhuuuu/spark/stargazers","contributors_url":"https://api.github.com/repos/AngersZhuuuu/spark/contributors","subscribers_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscribers","subscription_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscription","commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/AngersZhuuuu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/AngersZhuuuu/spark/merges","archive_url":"https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/AngersZhuuuu/spark/downloads","issues_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/AngersZhuuuu/spark/labels{/name}","releases_url":"https://api.github.com/repos/AngersZhuuuu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/AngersZhuuuu/spark/deployments","created_at":"2019-03-18T07:13:25Z","updated_at":"2024-12-31T06:48:27Z","pushed_at":"2024-12-31T06:45:23Z","git_url":"git://github.com/AngersZhuuuu/spark.git","ssh_url":"git@github.com:AngersZhuuuu/spark.git","clone_url":"https://github.com/AngersZhuuuu/spark.git","svn_url":"https://github.com/AngersZhuuuu/spark","homepage":"","size":446399,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"184f65e7c7359d4ff68ce5b558b186bca6e8efb1","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32929"},"html":{"href":"https://github.com/apache/spark/pull/32929"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32929"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32929/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32929/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32929/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2be136b01fb24c37e7bbd2e7c07b96d4371192a5"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32928","id":671236618,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxMjM2NjE4","html_url":"https://github.com/apache/spark/pull/32928","diff_url":"https://github.com/apache/spark/pull/32928.diff","patch_url":"https://github.com/apache/spark/pull/32928.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32928","number":32928,"state":"closed","locked":false,"title":"[SPARK-35784][SS] Implementation for RocksDB instance","user":{"login":"xuanyuanking","id":4833765,"node_id":"MDQ6VXNlcjQ4MzM3NjU=","avatar_url":"https://avatars.githubusercontent.com/u/4833765?v=4","gravatar_id":"","url":"https://api.github.com/users/xuanyuanking","html_url":"https://github.com/xuanyuanking","followers_url":"https://api.github.com/users/xuanyuanking/followers","following_url":"https://api.github.com/users/xuanyuanking/following{/other_user}","gists_url":"https://api.github.com/users/xuanyuanking/gists{/gist_id}","starred_url":"https://api.github.com/users/xuanyuanking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuanyuanking/subscriptions","organizations_url":"https://api.github.com/users/xuanyuanking/orgs","repos_url":"https://api.github.com/users/xuanyuanking/repos","events_url":"https://api.github.com/users/xuanyuanking/events{/privacy}","received_events_url":"https://api.github.com/users/xuanyuanking/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThe implementation for the RocksDB instance, which is used in the RocksDB state store. It plays a role as a handler for the RocksDB instance and RocksDBFileManager.\r\n\r\n\r\n### Why are the changes needed?\r\nPart of the RocksDB state store implementation.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n\r\n### How was this patch tested?\r\nNew UT added.\r\n","created_at":"2021-06-16T09:04:50Z","updated_at":"2021-06-30T02:10:16Z","closed_at":"2021-06-30T00:47:21Z","merged_at":null,"merge_commit_sha":"c267d92bf2368d88e8d945ff4fc42d180f8110f3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32928/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32928/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32928/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/21e1728cddab0fcd39886d914190a899aaac6d59","head":{"label":"xuanyuanking:SPARK-35784","ref":"SPARK-35784","sha":"21e1728cddab0fcd39886d914190a899aaac6d59","user":{"login":"xuanyuanking","id":4833765,"node_id":"MDQ6VXNlcjQ4MzM3NjU=","avatar_url":"https://avatars.githubusercontent.com/u/4833765?v=4","gravatar_id":"","url":"https://api.github.com/users/xuanyuanking","html_url":"https://github.com/xuanyuanking","followers_url":"https://api.github.com/users/xuanyuanking/followers","following_url":"https://api.github.com/users/xuanyuanking/following{/other_user}","gists_url":"https://api.github.com/users/xuanyuanking/gists{/gist_id}","starred_url":"https://api.github.com/users/xuanyuanking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuanyuanking/subscriptions","organizations_url":"https://api.github.com/users/xuanyuanking/orgs","repos_url":"https://api.github.com/users/xuanyuanking/repos","events_url":"https://api.github.com/users/xuanyuanking/events{/privacy}","received_events_url":"https://api.github.com/users/xuanyuanking/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":52511431,"node_id":"MDEwOlJlcG9zaXRvcnk1MjUxMTQzMQ==","name":"spark","full_name":"xuanyuanking/spark","private":false,"owner":{"login":"xuanyuanking","id":4833765,"node_id":"MDQ6VXNlcjQ4MzM3NjU=","avatar_url":"https://avatars.githubusercontent.com/u/4833765?v=4","gravatar_id":"","url":"https://api.github.com/users/xuanyuanking","html_url":"https://github.com/xuanyuanking","followers_url":"https://api.github.com/users/xuanyuanking/followers","following_url":"https://api.github.com/users/xuanyuanking/following{/other_user}","gists_url":"https://api.github.com/users/xuanyuanking/gists{/gist_id}","starred_url":"https://api.github.com/users/xuanyuanking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuanyuanking/subscriptions","organizations_url":"https://api.github.com/users/xuanyuanking/orgs","repos_url":"https://api.github.com/users/xuanyuanking/repos","events_url":"https://api.github.com/users/xuanyuanking/events{/privacy}","received_events_url":"https://api.github.com/users/xuanyuanking/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xuanyuanking/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/xuanyuanking/spark","forks_url":"https://api.github.com/repos/xuanyuanking/spark/forks","keys_url":"https://api.github.com/repos/xuanyuanking/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xuanyuanking/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xuanyuanking/spark/teams","hooks_url":"https://api.github.com/repos/xuanyuanking/spark/hooks","issue_events_url":"https://api.github.com/repos/xuanyuanking/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xuanyuanking/spark/events","assignees_url":"https://api.github.com/repos/xuanyuanking/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xuanyuanking/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xuanyuanking/spark/tags","blobs_url":"https://api.github.com/repos/xuanyuanking/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xuanyuanking/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xuanyuanking/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xuanyuanking/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xuanyuanking/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xuanyuanking/spark/languages","stargazers_url":"https://api.github.com/repos/xuanyuanking/spark/stargazers","contributors_url":"https://api.github.com/repos/xuanyuanking/spark/contributors","subscribers_url":"https://api.github.com/repos/xuanyuanking/spark/subscribers","subscription_url":"https://api.github.com/repos/xuanyuanking/spark/subscription","commits_url":"https://api.github.com/repos/xuanyuanking/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xuanyuanking/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xuanyuanking/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xuanyuanking/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xuanyuanking/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xuanyuanking/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xuanyuanking/spark/merges","archive_url":"https://api.github.com/repos/xuanyuanking/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xuanyuanking/spark/downloads","issues_url":"https://api.github.com/repos/xuanyuanking/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xuanyuanking/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xuanyuanking/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xuanyuanking/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xuanyuanking/spark/labels{/name}","releases_url":"https://api.github.com/repos/xuanyuanking/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xuanyuanking/spark/deployments","created_at":"2016-02-25T09:08:00Z","updated_at":"2022-02-08T22:43:27Z","pushed_at":"2023-09-05T19:46:43Z","git_url":"git://github.com/xuanyuanking/spark.git","ssh_url":"git@github.com:xuanyuanking/spark.git","clone_url":"https://github.com/xuanyuanking/spark.git","svn_url":"https://github.com/xuanyuanking/spark","homepage":null,"size":396515,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["spark"],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1c81ad20296d34f137238dadd67cc6ae405944eb","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32928"},"html":{"href":"https://github.com/apache/spark/pull/32928"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32928"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32928/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32928/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32928/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/21e1728cddab0fcd39886d914190a899aaac6d59"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32927","id":671175679,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxMTc1Njc5","html_url":"https://github.com/apache/spark/pull/32927","diff_url":"https://github.com/apache/spark/pull/32927.diff","patch_url":"https://github.com/apache/spark/pull/32927.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32927","number":32927,"state":"closed","locked":false,"title":"[SPARK-35678][ML][FOLLOWUP] softmax support offset and step","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nuse newly impled softmax function in NB\r\n\r\n\r\n### Why are the changes needed?\r\nto simplify impl\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nexisting testsuite\r\n","created_at":"2021-06-16T08:17:03Z","updated_at":"2021-06-21T08:28:12Z","closed_at":"2021-06-18T05:46:53Z","merged_at":null,"merge_commit_sha":"0b0261d67826398552b2511997b1a6673b52e86c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801475,"node_id":"MDU6TGFiZWwxNDA1ODAxNDc1","url":"https://api.github.com/repos/apache/spark/labels/ML","name":"ML","color":"ededed","default":false,"description":null},{"id":1405803268,"node_id":"MDU6TGFiZWwxNDA1ODAzMjY4","url":"https://api.github.com/repos/apache/spark/labels/MLLIB","name":"MLLIB","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32927/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32927/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32927/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6ee9054e99ded57a6f30f4dde63b956d6e3c71e4","head":{"label":"zhengruifeng:softmax__followup","ref":"softmax__followup","sha":"6ee9054e99ded57a6f30f4dde63b956d6e3c71e4","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"184f65e7c7359d4ff68ce5b558b186bca6e8efb1","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32927"},"html":{"href":"https://github.com/apache/spark/pull/32927"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32927"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32927/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32927/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32927/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6ee9054e99ded57a6f30f4dde63b956d6e3c71e4"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32926","id":671079053,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxMDc5MDUz","html_url":"https://github.com/apache/spark/pull/32926","diff_url":"https://github.com/apache/spark/pull/32926.diff","patch_url":"https://github.com/apache/spark/pull/32926.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32926","number":32926,"state":"closed","locked":false,"title":"[SPARK-35644][PYTHON][DOCS] Merge contents and remove obsolete pages in Development section","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to merge contents and remove obsolete pages in Development section, especially about pandas API on Spark.\r\n\r\nSome were removed, and some were merged to the existing PySpark guides. I will inline some comments in the PRs to make the review easier.\r\n\r\n### Why are the changes needed?\r\n\r\nTo guide developers on the code base of pandas API on Spark.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, it updates the user-facing documentation.\r\n\r\n### How was this patch tested?\r\n\r\nManually built the docs and checked.","created_at":"2021-06-16T06:54:23Z","updated_at":"2022-01-04T00:53:33Z","closed_at":"2021-06-17T04:35:30Z","merged_at":null,"merge_commit_sha":"487941042f9eed6b463277128c4897c1b648b57b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32926/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32926/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32926/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6eea4e5b8c05eb73f927f4f88f3134ddd8d43d6b","head":{"label":"HyukjinKwon:SPARK-35644","ref":"SPARK-35644","sha":"6eea4e5b8c05eb73f927f4f88f3134ddd8d43d6b","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"8e594f084a9f307cefcad13ccf439b0b608228c9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32926"},"html":{"href":"https://github.com/apache/spark/pull/32926"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32926"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32926/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32926/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32926/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6eea4e5b8c05eb73f927f4f88f3134ddd8d43d6b"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32925","id":671032804,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxMDMyODA0","html_url":"https://github.com/apache/spark/pull/32925","diff_url":"https://github.com/apache/spark/pull/32925.diff","patch_url":"https://github.com/apache/spark/pull/32925.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32925","number":32925,"state":"closed","locked":false,"title":"SPARK-35622: DataFrame's count function do not need groupBy and avoid shuffle","user":{"login":"StefanXiepj","id":26733114,"node_id":"MDQ6VXNlcjI2NzMzMTE0","avatar_url":"https://avatars.githubusercontent.com/u/26733114?v=4","gravatar_id":"","url":"https://api.github.com/users/StefanXiepj","html_url":"https://github.com/StefanXiepj","followers_url":"https://api.github.com/users/StefanXiepj/followers","following_url":"https://api.github.com/users/StefanXiepj/following{/other_user}","gists_url":"https://api.github.com/users/StefanXiepj/gists{/gist_id}","starred_url":"https://api.github.com/users/StefanXiepj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/StefanXiepj/subscriptions","organizations_url":"https://api.github.com/users/StefanXiepj/orgs","repos_url":"https://api.github.com/users/StefanXiepj/repos","events_url":"https://api.github.com/users/StefanXiepj/events{/privacy}","received_events_url":"https://api.github.com/users/StefanXiepj/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nUse `df.rdd.count()` replace `df.count()`.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nDataFrame's count function do not need groupBy,  use `df.rdd.count()` replace `df.count()` and avoid shuffle\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nAdded UT test","created_at":"2021-06-16T05:41:19Z","updated_at":"2021-09-26T00:44:28Z","closed_at":"2021-09-26T00:44:28Z","merged_at":null,"merge_commit_sha":"37aa64c56f27c76f36eb55aba1edbca71f365726","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32925/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32925/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32925/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c63cece5c8a4a1f0772670fc5f240e507e9c9561","head":{"label":"StefanXiepj:SPARK-35622","ref":"SPARK-35622","sha":"c63cece5c8a4a1f0772670fc5f240e507e9c9561","user":{"login":"StefanXiepj","id":26733114,"node_id":"MDQ6VXNlcjI2NzMzMTE0","avatar_url":"https://avatars.githubusercontent.com/u/26733114?v=4","gravatar_id":"","url":"https://api.github.com/users/StefanXiepj","html_url":"https://github.com/StefanXiepj","followers_url":"https://api.github.com/users/StefanXiepj/followers","following_url":"https://api.github.com/users/StefanXiepj/following{/other_user}","gists_url":"https://api.github.com/users/StefanXiepj/gists{/gist_id}","starred_url":"https://api.github.com/users/StefanXiepj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/StefanXiepj/subscriptions","organizations_url":"https://api.github.com/users/StefanXiepj/orgs","repos_url":"https://api.github.com/users/StefanXiepj/repos","events_url":"https://api.github.com/users/StefanXiepj/events{/privacy}","received_events_url":"https://api.github.com/users/StefanXiepj/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":272186674,"node_id":"MDEwOlJlcG9zaXRvcnkyNzIxODY2NzQ=","name":"spark","full_name":"StefanXiepj/spark","private":false,"owner":{"login":"StefanXiepj","id":26733114,"node_id":"MDQ6VXNlcjI2NzMzMTE0","avatar_url":"https://avatars.githubusercontent.com/u/26733114?v=4","gravatar_id":"","url":"https://api.github.com/users/StefanXiepj","html_url":"https://github.com/StefanXiepj","followers_url":"https://api.github.com/users/StefanXiepj/followers","following_url":"https://api.github.com/users/StefanXiepj/following{/other_user}","gists_url":"https://api.github.com/users/StefanXiepj/gists{/gist_id}","starred_url":"https://api.github.com/users/StefanXiepj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/StefanXiepj/subscriptions","organizations_url":"https://api.github.com/users/StefanXiepj/orgs","repos_url":"https://api.github.com/users/StefanXiepj/repos","events_url":"https://api.github.com/users/StefanXiepj/events{/privacy}","received_events_url":"https://api.github.com/users/StefanXiepj/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/StefanXiepj/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/StefanXiepj/spark","forks_url":"https://api.github.com/repos/StefanXiepj/spark/forks","keys_url":"https://api.github.com/repos/StefanXiepj/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/StefanXiepj/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/StefanXiepj/spark/teams","hooks_url":"https://api.github.com/repos/StefanXiepj/spark/hooks","issue_events_url":"https://api.github.com/repos/StefanXiepj/spark/issues/events{/number}","events_url":"https://api.github.com/repos/StefanXiepj/spark/events","assignees_url":"https://api.github.com/repos/StefanXiepj/spark/assignees{/user}","branches_url":"https://api.github.com/repos/StefanXiepj/spark/branches{/branch}","tags_url":"https://api.github.com/repos/StefanXiepj/spark/tags","blobs_url":"https://api.github.com/repos/StefanXiepj/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/StefanXiepj/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/StefanXiepj/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/StefanXiepj/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/StefanXiepj/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/StefanXiepj/spark/languages","stargazers_url":"https://api.github.com/repos/StefanXiepj/spark/stargazers","contributors_url":"https://api.github.com/repos/StefanXiepj/spark/contributors","subscribers_url":"https://api.github.com/repos/StefanXiepj/spark/subscribers","subscription_url":"https://api.github.com/repos/StefanXiepj/spark/subscription","commits_url":"https://api.github.com/repos/StefanXiepj/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/StefanXiepj/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/StefanXiepj/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/StefanXiepj/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/StefanXiepj/spark/contents/{+path}","compare_url":"https://api.github.com/repos/StefanXiepj/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/StefanXiepj/spark/merges","archive_url":"https://api.github.com/repos/StefanXiepj/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/StefanXiepj/spark/downloads","issues_url":"https://api.github.com/repos/StefanXiepj/spark/issues{/number}","pulls_url":"https://api.github.com/repos/StefanXiepj/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/StefanXiepj/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/StefanXiepj/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/StefanXiepj/spark/labels{/name}","releases_url":"https://api.github.com/repos/StefanXiepj/spark/releases{/id}","deployments_url":"https://api.github.com/repos/StefanXiepj/spark/deployments","created_at":"2020-06-14T11:17:12Z","updated_at":"2021-10-20T06:48:37Z","pushed_at":"2023-07-18T15:22:52Z","git_url":"git://github.com/StefanXiepj/spark.git","ssh_url":"git@github.com:StefanXiepj/spark.git","clone_url":"https://github.com/StefanXiepj/spark.git","svn_url":"https://github.com/StefanXiepj/spark","homepage":"https://spark.apache.org/","size":389397,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:branch-3.1","ref":"branch-3.1","sha":"d8ea6bcfad8d82f6886c7f538481ef2338fc04be","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32925"},"html":{"href":"https://github.com/apache/spark/pull/32925"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32925"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32925/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32925/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32925/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c63cece5c8a4a1f0772670fc5f240e507e9c9561"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32924","id":671027583,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxMDI3NTgz","html_url":"https://github.com/apache/spark/pull/32924","diff_url":"https://github.com/apache/spark/pull/32924.diff","patch_url":"https://github.com/apache/spark/pull/32924.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32924","number":32924,"state":"closed","locked":false,"title":"[SPARK-35771][SQL] Format year-month intervals using type fields","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR proposes to format year-month interval to strings using the start and end fields of `YearMonthIntervalType`.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n Currently, they are ignored, and any `YearMonthIntervalType` is formatted as `INTERVAL YEAR TO MONTH`.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nNew test.","created_at":"2021-06-16T05:30:31Z","updated_at":"2021-06-16T11:17:08Z","closed_at":"2021-06-16T08:08:13Z","merged_at":null,"merge_commit_sha":"01ba0c9ad9a8428b4aaaec4d4d7f95fcadf77d21","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32924/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32924/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32924/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/26ff872bdfae93961f7df84e75b50eafe41a7f75","head":{"label":"sarutak:year-month-interval-format","ref":"year-month-interval-format","sha":"26ff872bdfae93961f7df84e75b50eafe41a7f75","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19300892,"node_id":"MDEwOlJlcG9zaXRvcnkxOTMwMDg5Mg==","name":"spark","full_name":"sarutak/spark","private":false,"owner":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sarutak/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sarutak/spark","forks_url":"https://api.github.com/repos/sarutak/spark/forks","keys_url":"https://api.github.com/repos/sarutak/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sarutak/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sarutak/spark/teams","hooks_url":"https://api.github.com/repos/sarutak/spark/hooks","issue_events_url":"https://api.github.com/repos/sarutak/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sarutak/spark/events","assignees_url":"https://api.github.com/repos/sarutak/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sarutak/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sarutak/spark/tags","blobs_url":"https://api.github.com/repos/sarutak/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sarutak/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sarutak/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sarutak/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sarutak/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sarutak/spark/languages","stargazers_url":"https://api.github.com/repos/sarutak/spark/stargazers","contributors_url":"https://api.github.com/repos/sarutak/spark/contributors","subscribers_url":"https://api.github.com/repos/sarutak/spark/subscribers","subscription_url":"https://api.github.com/repos/sarutak/spark/subscription","commits_url":"https://api.github.com/repos/sarutak/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sarutak/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sarutak/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sarutak/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sarutak/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sarutak/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sarutak/spark/merges","archive_url":"https://api.github.com/repos/sarutak/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sarutak/spark/downloads","issues_url":"https://api.github.com/repos/sarutak/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sarutak/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sarutak/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sarutak/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sarutak/spark/labels{/name}","releases_url":"https://api.github.com/repos/sarutak/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sarutak/spark/deployments","created_at":"2014-04-30T04:35:03Z","updated_at":"2021-11-06T06:43:35Z","pushed_at":"2025-01-23T16:33:44Z","git_url":"git://github.com/sarutak/spark.git","ssh_url":"git@github.com:sarutak/spark.git","clone_url":"https://github.com/sarutak/spark.git","svn_url":"https://github.com/sarutak/spark","homepage":null,"size":467531,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"aaa8a80c9d3426107de5873b4391600701121385","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32924"},"html":{"href":"https://github.com/apache/spark/pull/32924"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32924"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32924/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32924/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32924/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/26ff872bdfae93961f7df84e75b50eafe41a7f75"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32923","id":671024054,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxMDI0MDU0","html_url":"https://github.com/apache/spark/pull/32923","diff_url":"https://github.com/apache/spark/pull/32923.diff","patch_url":"https://github.com/apache/spark/pull/32923.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32923","number":32923,"state":"closed","locked":false,"title":"[SPARK-35783][SQL] Set the list of read columns in the task configuration to reduce reading of ORC data.","user":{"login":"weixiuli","id":39684231,"node_id":"MDQ6VXNlcjM5Njg0MjMx","avatar_url":"https://avatars.githubusercontent.com/u/39684231?v=4","gravatar_id":"","url":"https://api.github.com/users/weixiuli","html_url":"https://github.com/weixiuli","followers_url":"https://api.github.com/users/weixiuli/followers","following_url":"https://api.github.com/users/weixiuli/following{/other_user}","gists_url":"https://api.github.com/users/weixiuli/gists{/gist_id}","starred_url":"https://api.github.com/users/weixiuli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weixiuli/subscriptions","organizations_url":"https://api.github.com/users/weixiuli/orgs","repos_url":"https://api.github.com/users/weixiuli/repos","events_url":"https://api.github.com/users/weixiuli/events{/privacy}","received_events_url":"https://api.github.com/users/weixiuli/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nSet the list of read columns in the task configuration to reduce reading of ORC data.\r\n### Why are the changes needed?\r\nNow, the ORC reader will read all columns of the ORC table when the task configuration does not set the list of read columns . Therefore, we should set the list of read columns in the task configuration to reduce reading of ORC data.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nexist unittests\r\n","created_at":"2021-06-16T05:25:23Z","updated_at":"2022-03-04T03:51:09Z","closed_at":"2021-06-17T05:06:43Z","merged_at":null,"merge_commit_sha":"f4037dc5220b4e327f7ba9eb0e326047009365a5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32923/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32923/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32923/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/4b13e61899350fffb91364e2808bf432db78ae35","head":{"label":"weixiuli:SPARK-35783","ref":"SPARK-35783","sha":"4b13e61899350fffb91364e2808bf432db78ae35","user":{"login":"weixiuli","id":39684231,"node_id":"MDQ6VXNlcjM5Njg0MjMx","avatar_url":"https://avatars.githubusercontent.com/u/39684231?v=4","gravatar_id":"","url":"https://api.github.com/users/weixiuli","html_url":"https://github.com/weixiuli","followers_url":"https://api.github.com/users/weixiuli/followers","following_url":"https://api.github.com/users/weixiuli/following{/other_user}","gists_url":"https://api.github.com/users/weixiuli/gists{/gist_id}","starred_url":"https://api.github.com/users/weixiuli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weixiuli/subscriptions","organizations_url":"https://api.github.com/users/weixiuli/orgs","repos_url":"https://api.github.com/users/weixiuli/repos","events_url":"https://api.github.com/users/weixiuli/events{/privacy}","received_events_url":"https://api.github.com/users/weixiuli/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":140506691,"node_id":"MDEwOlJlcG9zaXRvcnkxNDA1MDY2OTE=","name":"spark","full_name":"weixiuli/spark","private":false,"owner":{"login":"weixiuli","id":39684231,"node_id":"MDQ6VXNlcjM5Njg0MjMx","avatar_url":"https://avatars.githubusercontent.com/u/39684231?v=4","gravatar_id":"","url":"https://api.github.com/users/weixiuli","html_url":"https://github.com/weixiuli","followers_url":"https://api.github.com/users/weixiuli/followers","following_url":"https://api.github.com/users/weixiuli/following{/other_user}","gists_url":"https://api.github.com/users/weixiuli/gists{/gist_id}","starred_url":"https://api.github.com/users/weixiuli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weixiuli/subscriptions","organizations_url":"https://api.github.com/users/weixiuli/orgs","repos_url":"https://api.github.com/users/weixiuli/repos","events_url":"https://api.github.com/users/weixiuli/events{/privacy}","received_events_url":"https://api.github.com/users/weixiuli/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/weixiuli/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/weixiuli/spark","forks_url":"https://api.github.com/repos/weixiuli/spark/forks","keys_url":"https://api.github.com/repos/weixiuli/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/weixiuli/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/weixiuli/spark/teams","hooks_url":"https://api.github.com/repos/weixiuli/spark/hooks","issue_events_url":"https://api.github.com/repos/weixiuli/spark/issues/events{/number}","events_url":"https://api.github.com/repos/weixiuli/spark/events","assignees_url":"https://api.github.com/repos/weixiuli/spark/assignees{/user}","branches_url":"https://api.github.com/repos/weixiuli/spark/branches{/branch}","tags_url":"https://api.github.com/repos/weixiuli/spark/tags","blobs_url":"https://api.github.com/repos/weixiuli/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/weixiuli/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/weixiuli/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/weixiuli/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/weixiuli/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/weixiuli/spark/languages","stargazers_url":"https://api.github.com/repos/weixiuli/spark/stargazers","contributors_url":"https://api.github.com/repos/weixiuli/spark/contributors","subscribers_url":"https://api.github.com/repos/weixiuli/spark/subscribers","subscription_url":"https://api.github.com/repos/weixiuli/spark/subscription","commits_url":"https://api.github.com/repos/weixiuli/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/weixiuli/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/weixiuli/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/weixiuli/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/weixiuli/spark/contents/{+path}","compare_url":"https://api.github.com/repos/weixiuli/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/weixiuli/spark/merges","archive_url":"https://api.github.com/repos/weixiuli/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/weixiuli/spark/downloads","issues_url":"https://api.github.com/repos/weixiuli/spark/issues{/number}","pulls_url":"https://api.github.com/repos/weixiuli/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/weixiuli/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/weixiuli/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/weixiuli/spark/labels{/name}","releases_url":"https://api.github.com/repos/weixiuli/spark/releases{/id}","deployments_url":"https://api.github.com/repos/weixiuli/spark/deployments","created_at":"2018-07-11T01:41:23Z","updated_at":"2021-12-04T07:08:38Z","pushed_at":"2022-09-13T11:48:55Z","git_url":"git://github.com/weixiuli/spark.git","ssh_url":"git@github.com:weixiuli/spark.git","clone_url":"https://github.com/weixiuli/spark.git","svn_url":"https://github.com/weixiuli/spark","homepage":null,"size":416133,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"aaa8a80c9d3426107de5873b4391600701121385","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32923"},"html":{"href":"https://github.com/apache/spark/pull/32923"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32923"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32923/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32923/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32923/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/4b13e61899350fffb91364e2808bf432db78ae35"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32922","id":671021192,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcxMDIxMTky","html_url":"https://github.com/apache/spark/pull/32922","diff_url":"https://github.com/apache/spark/pull/32922.diff","patch_url":"https://github.com/apache/spark/pull/32922.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32922","number":32922,"state":"closed","locked":false,"title":"[SPARK-35774][SQL] Parse any year-month interval types in SQL","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR extends the parser rules to be able to parse the following types:\r\n\r\n* INTERVAL YEAR\r\n* INTERVAL YEAR TO MONTH\r\n* INTERVAL MONTH\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nFor ANSI compliance.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nNew assertion.","created_at":"2021-06-16T05:19:10Z","updated_at":"2021-06-23T06:02:23Z","closed_at":"2021-06-16T06:42:06Z","merged_at":null,"merge_commit_sha":"90bd1546459dabb0de4a777f18f0bf69bec3ef09","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32922/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32922/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32922/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d260bb1bc27d68f0cdf2287662413351e6b7b3c0","head":{"label":"sarutak:parse-any-year-month","ref":"parse-any-year-month","sha":"d260bb1bc27d68f0cdf2287662413351e6b7b3c0","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19300892,"node_id":"MDEwOlJlcG9zaXRvcnkxOTMwMDg5Mg==","name":"spark","full_name":"sarutak/spark","private":false,"owner":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sarutak/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sarutak/spark","forks_url":"https://api.github.com/repos/sarutak/spark/forks","keys_url":"https://api.github.com/repos/sarutak/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sarutak/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sarutak/spark/teams","hooks_url":"https://api.github.com/repos/sarutak/spark/hooks","issue_events_url":"https://api.github.com/repos/sarutak/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sarutak/spark/events","assignees_url":"https://api.github.com/repos/sarutak/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sarutak/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sarutak/spark/tags","blobs_url":"https://api.github.com/repos/sarutak/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sarutak/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sarutak/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sarutak/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sarutak/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sarutak/spark/languages","stargazers_url":"https://api.github.com/repos/sarutak/spark/stargazers","contributors_url":"https://api.github.com/repos/sarutak/spark/contributors","subscribers_url":"https://api.github.com/repos/sarutak/spark/subscribers","subscription_url":"https://api.github.com/repos/sarutak/spark/subscription","commits_url":"https://api.github.com/repos/sarutak/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sarutak/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sarutak/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sarutak/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sarutak/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sarutak/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sarutak/spark/merges","archive_url":"https://api.github.com/repos/sarutak/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sarutak/spark/downloads","issues_url":"https://api.github.com/repos/sarutak/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sarutak/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sarutak/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sarutak/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sarutak/spark/labels{/name}","releases_url":"https://api.github.com/repos/sarutak/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sarutak/spark/deployments","created_at":"2014-04-30T04:35:03Z","updated_at":"2021-11-06T06:43:35Z","pushed_at":"2025-01-23T16:33:44Z","git_url":"git://github.com/sarutak/spark.git","ssh_url":"git@github.com:sarutak/spark.git","clone_url":"https://github.com/sarutak/spark.git","svn_url":"https://github.com/sarutak/spark","homepage":null,"size":467531,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"aaa8a80c9d3426107de5873b4391600701121385","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32922"},"html":{"href":"https://github.com/apache/spark/pull/32922"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32922"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32922/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32922/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32922/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d260bb1bc27d68f0cdf2287662413351e6b7b3c0"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32921","id":670769193,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcwNzY5MTkz","html_url":"https://github.com/apache/spark/pull/32921","diff_url":"https://github.com/apache/spark/pull/32921.diff","patch_url":"https://github.com/apache/spark/pull/32921.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32921","number":32921,"state":"closed","locked":false,"title":"[SPARK-35779][SQL] Dynamic filtering for Data Source V2","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nThis PR implemented the proposal per [design doc](https://docs.google.com/document/d/1RfFn2e9o_1uHJ8jFGsSakp-BZMizX1uRrJSybMe2a6M) for SPARK-35779.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nSpark supports dynamic partition filtering that enables reusing parts of the query to skip unnecessary partitions in the larger table during joins. This optimization has proven to be beneficial for star-schema queries which are common in the industry. Unfortunately, dynamic pruning is currently limited to partition pruning during joins and is only supported for built-in v1 sources. As more and more Spark users migrate to Data Source V2, it is important to generalize dynamic filtering and expose it to all v2 connectors.\r\n\r\nPlease, see the design doc for more information on this effort.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nYes, this PR adds a new optional mix-in interface for `Scan` in Data Source V2.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\n\r\nThis PR comes with tests.","created_at":"2021-06-15T21:39:17Z","updated_at":"2023-02-06T10:16:13Z","closed_at":"2021-07-02T00:00:26Z","merged_at":null,"merge_commit_sha":"23e26820526bb762c76b82098bd0437831b80681","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406605079,"node_id":"MDU6TGFiZWwxNDA2NjA1MDc5","url":"https://api.github.com/repos/apache/spark/labels/WEB%20UI","name":"WEB UI","color":"ededed","default":false,"description":null},{"id":1988040187,"node_id":"MDU6TGFiZWwxOTg4MDQwMTg3","url":"https://api.github.com/repos/apache/spark/labels/AVRO","name":"AVRO","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32921/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32921/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32921/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/881d2b2b7246d9453bfa7e074ab19334bf8d9876","head":{"label":"aokolnychyi:dynamic-filtering-wip","ref":"dynamic-filtering-wip","sha":"881d2b2b7246d9453bfa7e074ab19334bf8d9876","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":61945043,"node_id":"MDEwOlJlcG9zaXRvcnk2MTk0NTA0Mw==","name":"spark","full_name":"aokolnychyi/spark","private":false,"owner":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/aokolnychyi/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/aokolnychyi/spark","forks_url":"https://api.github.com/repos/aokolnychyi/spark/forks","keys_url":"https://api.github.com/repos/aokolnychyi/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/aokolnychyi/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/aokolnychyi/spark/teams","hooks_url":"https://api.github.com/repos/aokolnychyi/spark/hooks","issue_events_url":"https://api.github.com/repos/aokolnychyi/spark/issues/events{/number}","events_url":"https://api.github.com/repos/aokolnychyi/spark/events","assignees_url":"https://api.github.com/repos/aokolnychyi/spark/assignees{/user}","branches_url":"https://api.github.com/repos/aokolnychyi/spark/branches{/branch}","tags_url":"https://api.github.com/repos/aokolnychyi/spark/tags","blobs_url":"https://api.github.com/repos/aokolnychyi/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/aokolnychyi/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/aokolnychyi/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/aokolnychyi/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/aokolnychyi/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/aokolnychyi/spark/languages","stargazers_url":"https://api.github.com/repos/aokolnychyi/spark/stargazers","contributors_url":"https://api.github.com/repos/aokolnychyi/spark/contributors","subscribers_url":"https://api.github.com/repos/aokolnychyi/spark/subscribers","subscription_url":"https://api.github.com/repos/aokolnychyi/spark/subscription","commits_url":"https://api.github.com/repos/aokolnychyi/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/aokolnychyi/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/aokolnychyi/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/aokolnychyi/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/aokolnychyi/spark/contents/{+path}","compare_url":"https://api.github.com/repos/aokolnychyi/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/aokolnychyi/spark/merges","archive_url":"https://api.github.com/repos/aokolnychyi/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/aokolnychyi/spark/downloads","issues_url":"https://api.github.com/repos/aokolnychyi/spark/issues{/number}","pulls_url":"https://api.github.com/repos/aokolnychyi/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/aokolnychyi/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/aokolnychyi/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/aokolnychyi/spark/labels{/name}","releases_url":"https://api.github.com/repos/aokolnychyi/spark/releases{/id}","deployments_url":"https://api.github.com/repos/aokolnychyi/spark/deployments","created_at":"2016-06-25T13:46:06Z","updated_at":"2024-05-24T16:27:18Z","pushed_at":"2025-01-20T03:24:19Z","git_url":"git://github.com/aokolnychyi/spark.git","ssh_url":"git@github.com:aokolnychyi/spark.git","clone_url":"https://github.com/aokolnychyi/spark.git","svn_url":"https://github.com/aokolnychyi/spark","homepage":null,"size":436260,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a9ebfc5374b224867e067856f53d511d0cf25396","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32921"},"html":{"href":"https://github.com/apache/spark/pull/32921"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32921"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32921/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32921/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32921/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/881d2b2b7246d9453bfa7e074ab19334bf8d9876"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32920","id":670565622,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcwNTY1NjIy","html_url":"https://github.com/apache/spark/pull/32920","diff_url":"https://github.com/apache/spark/pull/32920.diff","patch_url":"https://github.com/apache/spark/pull/32920.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32920","number":32920,"state":"closed","locked":false,"title":"[SPARK-35767] [SQL] Avoid executing child plan twice in CoalesceExec","user":{"login":"andygrove","id":934084,"node_id":"MDQ6VXNlcjkzNDA4NA==","avatar_url":"https://avatars.githubusercontent.com/u/934084?v=4","gravatar_id":"","url":"https://api.github.com/users/andygrove","html_url":"https://github.com/andygrove","followers_url":"https://api.github.com/users/andygrove/followers","following_url":"https://api.github.com/users/andygrove/following{/other_user}","gists_url":"https://api.github.com/users/andygrove/gists{/gist_id}","starred_url":"https://api.github.com/users/andygrove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andygrove/subscriptions","organizations_url":"https://api.github.com/users/andygrove/orgs","repos_url":"https://api.github.com/users/andygrove/repos","events_url":"https://api.github.com/users/andygrove/events{/privacy}","received_events_url":"https://api.github.com/users/andygrove/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n`CoalesceExec` needlessly calls `child.execute` twice when it could just call it once and re-use the results. This only happens when `numPartitions == 1`.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nIt is more efficient to execute the child plan once rather than twice.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nThere are no functional changes. This is just a performance optimization, so the existing tests should be sufficient to catch any regressions.\r\n","created_at":"2021-06-15T16:25:30Z","updated_at":"2021-06-16T02:07:16Z","closed_at":"2021-06-15T18:59:33Z","merged_at":null,"merge_commit_sha":"c3cd56d605210ff63a6feb30db4d9837c07b514c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32920/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32920/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32920/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a5aa5d874e5d2712baef582e25b295f9c625b7e1","head":{"label":"andygrove:coalesce-exec-executes-twice","ref":"coalesce-exec-executes-twice","sha":"a5aa5d874e5d2712baef582e25b295f9c625b7e1","user":{"login":"andygrove","id":934084,"node_id":"MDQ6VXNlcjkzNDA4NA==","avatar_url":"https://avatars.githubusercontent.com/u/934084?v=4","gravatar_id":"","url":"https://api.github.com/users/andygrove","html_url":"https://github.com/andygrove","followers_url":"https://api.github.com/users/andygrove/followers","following_url":"https://api.github.com/users/andygrove/following{/other_user}","gists_url":"https://api.github.com/users/andygrove/gists{/gist_id}","starred_url":"https://api.github.com/users/andygrove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andygrove/subscriptions","organizations_url":"https://api.github.com/users/andygrove/orgs","repos_url":"https://api.github.com/users/andygrove/repos","events_url":"https://api.github.com/users/andygrove/events{/privacy}","received_events_url":"https://api.github.com/users/andygrove/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":205463461,"node_id":"MDEwOlJlcG9zaXRvcnkyMDU0NjM0NjE=","name":"spark","full_name":"andygrove/spark","private":false,"owner":{"login":"andygrove","id":934084,"node_id":"MDQ6VXNlcjkzNDA4NA==","avatar_url":"https://avatars.githubusercontent.com/u/934084?v=4","gravatar_id":"","url":"https://api.github.com/users/andygrove","html_url":"https://github.com/andygrove","followers_url":"https://api.github.com/users/andygrove/followers","following_url":"https://api.github.com/users/andygrove/following{/other_user}","gists_url":"https://api.github.com/users/andygrove/gists{/gist_id}","starred_url":"https://api.github.com/users/andygrove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andygrove/subscriptions","organizations_url":"https://api.github.com/users/andygrove/orgs","repos_url":"https://api.github.com/users/andygrove/repos","events_url":"https://api.github.com/users/andygrove/events{/privacy}","received_events_url":"https://api.github.com/users/andygrove/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/andygrove/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/andygrove/spark","forks_url":"https://api.github.com/repos/andygrove/spark/forks","keys_url":"https://api.github.com/repos/andygrove/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/andygrove/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/andygrove/spark/teams","hooks_url":"https://api.github.com/repos/andygrove/spark/hooks","issue_events_url":"https://api.github.com/repos/andygrove/spark/issues/events{/number}","events_url":"https://api.github.com/repos/andygrove/spark/events","assignees_url":"https://api.github.com/repos/andygrove/spark/assignees{/user}","branches_url":"https://api.github.com/repos/andygrove/spark/branches{/branch}","tags_url":"https://api.github.com/repos/andygrove/spark/tags","blobs_url":"https://api.github.com/repos/andygrove/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/andygrove/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/andygrove/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/andygrove/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/andygrove/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/andygrove/spark/languages","stargazers_url":"https://api.github.com/repos/andygrove/spark/stargazers","contributors_url":"https://api.github.com/repos/andygrove/spark/contributors","subscribers_url":"https://api.github.com/repos/andygrove/spark/subscribers","subscription_url":"https://api.github.com/repos/andygrove/spark/subscription","commits_url":"https://api.github.com/repos/andygrove/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/andygrove/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/andygrove/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/andygrove/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/andygrove/spark/contents/{+path}","compare_url":"https://api.github.com/repos/andygrove/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/andygrove/spark/merges","archive_url":"https://api.github.com/repos/andygrove/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/andygrove/spark/downloads","issues_url":"https://api.github.com/repos/andygrove/spark/issues{/number}","pulls_url":"https://api.github.com/repos/andygrove/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/andygrove/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/andygrove/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/andygrove/spark/labels{/name}","releases_url":"https://api.github.com/repos/andygrove/spark/releases{/id}","deployments_url":"https://api.github.com/repos/andygrove/spark/deployments","created_at":"2019-08-30T22:14:32Z","updated_at":"2022-01-10T22:21:57Z","pushed_at":"2024-06-27T22:01:21Z","git_url":"git://github.com/andygrove/spark.git","ssh_url":"git@github.com:andygrove/spark.git","clone_url":"https://github.com/andygrove/spark.git","svn_url":"https://github.com/andygrove/spark","homepage":"","size":417966,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"8a02f3a413e7163f8d29216de5a49ac77d9319e0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32920"},"html":{"href":"https://github.com/apache/spark/pull/32920"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32920"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32920/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32920/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32920/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a5aa5d874e5d2712baef582e25b295f9c625b7e1"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32919","id":670532819,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcwNTMyODE5","html_url":"https://github.com/apache/spark/pull/32919","diff_url":"https://github.com/apache/spark/pull/32919.diff","patch_url":"https://github.com/apache/spark/pull/32919.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32919","number":32919,"state":"closed","locked":false,"title":"[SPARK-35378][SQL][FOLLOWUP] Restore the command execution name for DataFrameWriterV2","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis is a followup of https://github.com/apache/spark/pull/32513\r\n\r\nIt's hard to keep the command execution name for `DataFrameWriter`, as the command logical plan is a bit messy (DS v1, file source and hive and different command logical plans) and sometimes it's hard to distinguish \"insert\" and \"save\".\r\n\r\nHowever, `DataFrameWriterV2` only produce v2 commands which are pretty clean. It's easy to keep the command execution name for them.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nless breaking changes.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nno\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nN/A","created_at":"2021-06-15T15:51:38Z","updated_at":"2021-06-17T08:55:48Z","closed_at":"2021-06-17T08:55:48Z","merged_at":null,"merge_commit_sha":"f2674c7c9adf88aff7ac89706d57e76c6fc67ed1","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32919/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32919/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32919/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/adc141d2e36104ce4d79b8ab291d16aa2e5ba0a1","head":{"label":"cloud-fan:follow","ref":"follow","sha":"adc141d2e36104ce4d79b8ab291d16aa2e5ba0a1","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"aaa8a80c9d3426107de5873b4391600701121385","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32919"},"html":{"href":"https://github.com/apache/spark/pull/32919"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32919"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32919/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32919/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32919/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/adc141d2e36104ce4d79b8ab291d16aa2e5ba0a1"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32918","id":670464178,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcwNDY0MTc4","html_url":"https://github.com/apache/spark/pull/32918","diff_url":"https://github.com/apache/spark/pull/32918.diff","patch_url":"https://github.com/apache/spark/pull/32918.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32918","number":32918,"state":"closed","locked":false,"title":"[SPARK-35766][SQL][TESTS] Break down CastSuite/AnsiCastSuite into multiple files","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nCurrently, the file CastSuite.scala becomes big: 2000 lines, 2 base classes, 4 test suites.\r\nIn my previous work of Timestamp without time zone, I planned to put new test cases in CastSuiteBase, but they were accidentally added in AnsiCastSuiteBase.\r\n\r\nThis PR is to break the file down into 3 files. It also moves the test cases about timestamp without time zone to the right base class.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nMake development and review easier.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit tests","created_at":"2021-06-15T14:33:04Z","updated_at":"2021-06-15T20:01:09Z","closed_at":"2021-06-15T16:17:20Z","merged_at":null,"merge_commit_sha":"37d60af5fbc7343a4a86586c76deac68ba7bfccd","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32918/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32918/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32918/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6428b1675481401b5f0421cc6431d9c9fea3072f","head":{"label":"gengliangwang:refactorCastSuite","ref":"refactorCastSuite","sha":"6428b1675481401b5f0421cc6431d9c9fea3072f","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"b74260f67fa53b91ffb800636f17d112abbdb5c0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32918"},"html":{"href":"https://github.com/apache/spark/pull/32918"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32918"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32918/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32918/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32918/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6428b1675481401b5f0421cc6431d9c9fea3072f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32917","id":670171379,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcwMTcxMzc5","html_url":"https://github.com/apache/spark/pull/32917","diff_url":"https://github.com/apache/spark/pull/32917.diff","patch_url":"https://github.com/apache/spark/pull/32917.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32917","number":32917,"state":"closed","locked":false,"title":"[SPARK-35758][DOCS] Update the document about building Spark with Hadoop for Hadoop 2.x and 3.x","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR updates the document about building Spark with Hadoop for Hadoop 3.x and Hadoop 3.2.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nThe document says about how to build like as follows:\r\n```\r\n./build/mvn -Pyarn -Dhadoop.version=2.8.5 -DskipTests clean package\r\n```\r\n\r\nBut this command fails because the default build settings are for Hadoop 3.x.\r\nSo, we need to modify the command example.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nI confirmed both of these commands successfully finished.\r\n```\r\n./build/mvn -Pyarn -Dhadoop.version=3.3.0 -DskipTests package\r\n./build/mvn -Phadoop-2.7 -Pyarn -Dhadoop.version=2.8.5 -DskipTests package\r\n```\r\n\r\nI also built the document and confirmed the result.\r\nThis is before:\r\n![hadoop-version-before](https://user-images.githubusercontent.com/4736016/122016157-bf020c80-cdfb-11eb-8e74-4840861f8541.png)\r\n\r\nAnd this is after:\r\n![hadoop-version-after](https://user-images.githubusercontent.com/4736016/122016188-c75a4780-cdfb-11eb-8427-2f0765e6ff7a.png)\r\n","created_at":"2021-06-15T08:05:16Z","updated_at":"2021-06-15T11:20:05Z","closed_at":"2021-06-15T11:20:05Z","merged_at":null,"merge_commit_sha":"f99b79c4f6182e5f0fb2635b0c6b9cb03518e0af","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32917/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32917/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32917/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/06e7b301ecf3c8e96332c5c57725c101ca61bfb4","head":{"label":"sarutak:fix-build-doc-with-hadoop","ref":"fix-build-doc-with-hadoop","sha":"06e7b301ecf3c8e96332c5c57725c101ca61bfb4","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19300892,"node_id":"MDEwOlJlcG9zaXRvcnkxOTMwMDg5Mg==","name":"spark","full_name":"sarutak/spark","private":false,"owner":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sarutak/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sarutak/spark","forks_url":"https://api.github.com/repos/sarutak/spark/forks","keys_url":"https://api.github.com/repos/sarutak/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sarutak/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sarutak/spark/teams","hooks_url":"https://api.github.com/repos/sarutak/spark/hooks","issue_events_url":"https://api.github.com/repos/sarutak/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sarutak/spark/events","assignees_url":"https://api.github.com/repos/sarutak/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sarutak/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sarutak/spark/tags","blobs_url":"https://api.github.com/repos/sarutak/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sarutak/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sarutak/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sarutak/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sarutak/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sarutak/spark/languages","stargazers_url":"https://api.github.com/repos/sarutak/spark/stargazers","contributors_url":"https://api.github.com/repos/sarutak/spark/contributors","subscribers_url":"https://api.github.com/repos/sarutak/spark/subscribers","subscription_url":"https://api.github.com/repos/sarutak/spark/subscription","commits_url":"https://api.github.com/repos/sarutak/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sarutak/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sarutak/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sarutak/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sarutak/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sarutak/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sarutak/spark/merges","archive_url":"https://api.github.com/repos/sarutak/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sarutak/spark/downloads","issues_url":"https://api.github.com/repos/sarutak/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sarutak/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sarutak/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sarutak/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sarutak/spark/labels{/name}","releases_url":"https://api.github.com/repos/sarutak/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sarutak/spark/deployments","created_at":"2014-04-30T04:35:03Z","updated_at":"2021-11-06T06:43:35Z","pushed_at":"2025-01-23T16:33:44Z","git_url":"git://github.com/sarutak/spark.git","ssh_url":"git@github.com:sarutak/spark.git","clone_url":"https://github.com/sarutak/spark.git","svn_url":"https://github.com/sarutak/spark","homepage":null,"size":467531,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"b9aeeb4e6c66575df69173ef62c399824107001e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32917"},"html":{"href":"https://github.com/apache/spark/pull/32917"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32917"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32917/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32917/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32917/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/06e7b301ecf3c8e96332c5c57725c101ca61bfb4"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32916","id":670169162,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcwMTY5MTYy","html_url":"https://github.com/apache/spark/pull/32916","diff_url":"https://github.com/apache/spark/pull/32916.diff","patch_url":"https://github.com/apache/spark/pull/32916.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32916","number":32916,"state":"closed","locked":false,"title":"[SPARK-35064][SQL] Group error in spark-catalyst","user":{"login":"dgd-contributor","id":84778052,"node_id":"MDQ6VXNlcjg0Nzc4MDUy","avatar_url":"https://avatars.githubusercontent.com/u/84778052?v=4","gravatar_id":"","url":"https://api.github.com/users/dgd-contributor","html_url":"https://github.com/dgd-contributor","followers_url":"https://api.github.com/users/dgd-contributor/followers","following_url":"https://api.github.com/users/dgd-contributor/following{/other_user}","gists_url":"https://api.github.com/users/dgd-contributor/gists{/gist_id}","starred_url":"https://api.github.com/users/dgd-contributor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgd-contributor/subscriptions","organizations_url":"https://api.github.com/users/dgd-contributor/orgs","repos_url":"https://api.github.com/users/dgd-contributor/repos","events_url":"https://api.github.com/users/dgd-contributor/events{/privacy}","received_events_url":"https://api.github.com/users/dgd-contributor/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR group exception messages in sql/catalyst/src/main/scala/org/apache/spark/sql (except catalyst)\r\n\r\n### Why are the changes needed?\r\nIt will largely help with standardization of error messages and its maintenance.\r\n\r\n### Does this PR introduce any user-facing change?\r\nNo. Error messages remain unchanged.\r\n\r\n### How was this patch tested?\r\nNo new tests - pass all original tests to make sure it doesn't break any existing behavior.","created_at":"2021-06-15T08:02:21Z","updated_at":"2021-06-28T07:29:04Z","closed_at":"2021-06-28T07:21:39Z","merged_at":null,"merge_commit_sha":"6c470d33199b085a96dba8cf81038bcb58d6c101","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32916/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32916/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32916/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9caf48fe9a9a0ad40b803fdb411c5cfad26f288f","head":{"label":"dgd-contributor:SPARK-35064_catalyst_group_error","ref":"SPARK-35064_catalyst_group_error","sha":"9caf48fe9a9a0ad40b803fdb411c5cfad26f288f","user":{"login":"dgd-contributor","id":84778052,"node_id":"MDQ6VXNlcjg0Nzc4MDUy","avatar_url":"https://avatars.githubusercontent.com/u/84778052?v=4","gravatar_id":"","url":"https://api.github.com/users/dgd-contributor","html_url":"https://github.com/dgd-contributor","followers_url":"https://api.github.com/users/dgd-contributor/followers","following_url":"https://api.github.com/users/dgd-contributor/following{/other_user}","gists_url":"https://api.github.com/users/dgd-contributor/gists{/gist_id}","starred_url":"https://api.github.com/users/dgd-contributor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgd-contributor/subscriptions","organizations_url":"https://api.github.com/users/dgd-contributor/orgs","repos_url":"https://api.github.com/users/dgd-contributor/repos","events_url":"https://api.github.com/users/dgd-contributor/events{/privacy}","received_events_url":"https://api.github.com/users/dgd-contributor/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":370663608,"node_id":"MDEwOlJlcG9zaXRvcnkzNzA2NjM2MDg=","name":"spark","full_name":"dgd-contributor/spark","private":false,"owner":{"login":"dgd-contributor","id":84778052,"node_id":"MDQ6VXNlcjg0Nzc4MDUy","avatar_url":"https://avatars.githubusercontent.com/u/84778052?v=4","gravatar_id":"","url":"https://api.github.com/users/dgd-contributor","html_url":"https://github.com/dgd-contributor","followers_url":"https://api.github.com/users/dgd-contributor/followers","following_url":"https://api.github.com/users/dgd-contributor/following{/other_user}","gists_url":"https://api.github.com/users/dgd-contributor/gists{/gist_id}","starred_url":"https://api.github.com/users/dgd-contributor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgd-contributor/subscriptions","organizations_url":"https://api.github.com/users/dgd-contributor/orgs","repos_url":"https://api.github.com/users/dgd-contributor/repos","events_url":"https://api.github.com/users/dgd-contributor/events{/privacy}","received_events_url":"https://api.github.com/users/dgd-contributor/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dgd-contributor/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/dgd-contributor/spark","forks_url":"https://api.github.com/repos/dgd-contributor/spark/forks","keys_url":"https://api.github.com/repos/dgd-contributor/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dgd-contributor/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dgd-contributor/spark/teams","hooks_url":"https://api.github.com/repos/dgd-contributor/spark/hooks","issue_events_url":"https://api.github.com/repos/dgd-contributor/spark/issues/events{/number}","events_url":"https://api.github.com/repos/dgd-contributor/spark/events","assignees_url":"https://api.github.com/repos/dgd-contributor/spark/assignees{/user}","branches_url":"https://api.github.com/repos/dgd-contributor/spark/branches{/branch}","tags_url":"https://api.github.com/repos/dgd-contributor/spark/tags","blobs_url":"https://api.github.com/repos/dgd-contributor/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dgd-contributor/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dgd-contributor/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/dgd-contributor/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dgd-contributor/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/dgd-contributor/spark/languages","stargazers_url":"https://api.github.com/repos/dgd-contributor/spark/stargazers","contributors_url":"https://api.github.com/repos/dgd-contributor/spark/contributors","subscribers_url":"https://api.github.com/repos/dgd-contributor/spark/subscribers","subscription_url":"https://api.github.com/repos/dgd-contributor/spark/subscription","commits_url":"https://api.github.com/repos/dgd-contributor/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/dgd-contributor/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/dgd-contributor/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/dgd-contributor/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/dgd-contributor/spark/contents/{+path}","compare_url":"https://api.github.com/repos/dgd-contributor/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dgd-contributor/spark/merges","archive_url":"https://api.github.com/repos/dgd-contributor/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dgd-contributor/spark/downloads","issues_url":"https://api.github.com/repos/dgd-contributor/spark/issues{/number}","pulls_url":"https://api.github.com/repos/dgd-contributor/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/dgd-contributor/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/dgd-contributor/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dgd-contributor/spark/labels{/name}","releases_url":"https://api.github.com/repos/dgd-contributor/spark/releases{/id}","deployments_url":"https://api.github.com/repos/dgd-contributor/spark/deployments","created_at":"2021-05-25T11:08:20Z","updated_at":"2021-10-06T01:57:55Z","pushed_at":"2021-10-06T01:57:45Z","git_url":"git://github.com/dgd-contributor/spark.git","ssh_url":"git@github.com:dgd-contributor/spark.git","clone_url":"https://github.com/dgd-contributor/spark.git","svn_url":"https://github.com/dgd-contributor/spark","homepage":"https://spark.apache.org/","size":390391,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a8fdb98ecb243cf92ef67fe9adaac712e4d5ae3a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32916"},"html":{"href":"https://github.com/apache/spark/pull/32916"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32916"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32916/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32916/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32916/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9caf48fe9a9a0ad40b803fdb411c5cfad26f288f"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32915","id":670159905,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcwMTU5OTA1","html_url":"https://github.com/apache/spark/pull/32915","diff_url":"https://github.com/apache/spark/pull/32915.diff","patch_url":"https://github.com/apache/spark/pull/32915.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32915","number":32915,"state":"closed","locked":false,"title":"[SPARK-35764][SQL] Assign pretty names to TimestampWithoutTZType","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nIn the PR, I propose to override the typeName() method in TimestampWithoutTZType, and assign it a name according to the ANSI SQL standard\r\n![image](https://user-images.githubusercontent.com/1097932/122013859-2cf50680-cdf1-11eb-9fcd-0ec1b59fb5c0.png)\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo improve Spark SQL user experience, and have readable types in error messages.\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo, the new timestamp type is not released yet.\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit test\r\n","created_at":"2021-06-15T07:49:05Z","updated_at":"2021-06-15T13:00:09Z","closed_at":"2021-06-15T09:15:39Z","merged_at":null,"merge_commit_sha":"2a246a86da444ead19d57e39f2ce11c2a50c06a4","assignee":null,"assignees":[],"requested_reviewers":[{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32915/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32915/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32915/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1e5357158acd7fe371de542c09e69052708e5f89","head":{"label":"gengliangwang:typename","ref":"typename","sha":"1e5357158acd7fe371de542c09e69052708e5f89","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"b9aeeb4e6c66575df69173ef62c399824107001e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32915"},"html":{"href":"https://github.com/apache/spark/pull/32915"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32915"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32915/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32915/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32915/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1e5357158acd7fe371de542c09e69052708e5f89"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32914","id":670106241,"node_id":"MDExOlB1bGxSZXF1ZXN0NjcwMTA2MjQx","html_url":"https://github.com/apache/spark/pull/32914","diff_url":"https://github.com/apache/spark/pull/32914.diff","patch_url":"https://github.com/apache/spark/pull/32914.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32914","number":32914,"state":"closed","locked":false,"title":"[SPARK-35763][SS] Remove the StateStoreCustomMetric subclass enumeration dependency","user":{"login":"vkorukanti","id":1719945,"node_id":"MDQ6VXNlcjE3MTk5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/1719945?v=4","gravatar_id":"","url":"https://api.github.com/users/vkorukanti","html_url":"https://github.com/vkorukanti","followers_url":"https://api.github.com/users/vkorukanti/followers","following_url":"https://api.github.com/users/vkorukanti/following{/other_user}","gists_url":"https://api.github.com/users/vkorukanti/gists{/gist_id}","starred_url":"https://api.github.com/users/vkorukanti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vkorukanti/subscriptions","organizations_url":"https://api.github.com/users/vkorukanti/orgs","repos_url":"https://api.github.com/users/vkorukanti/repos","events_url":"https://api.github.com/users/vkorukanti/events{/privacy}","received_events_url":"https://api.github.com/users/vkorukanti/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nRemove the usage of the enumerating subclasses of `StateStoreCustomMetric` dependency. \r\n\r\nTo achieve it, add couple of utility methods to `StateStoreCustomMetric`\r\n* `withNewDesc(desc : String)` to `StateStoreCustomMetric` for cloning the instance with a new `desc` (currently used in `SymmetricHashJoinStateManager`)\r\n* `createSQLMetric(sparkContext: sparkContext): SQLMetric` for creating a corresponding `SQLMetric` to show the metric in UI and accumulate at the query level (currently used in `statefulOperator. stateStoreCustomMetrics`)\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCode in [SymmetricHashJoinStateManager](https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/streaming/state/SymmetricHashJoinStateManager.scala#L321) and [StateStoreWriter](https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/streaming/statefulOperators.scala#L129) rely on the subclass implementations of [StateStoreCustomMetric](https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/streaming/state/StateStore.scala#L187).\r\n\r\nIf a new subclass of `StateStoreCustomMetric` is added, it requires code changes to `SymmetricHashJoinStateManager` and `StateStoreWriter`, and we may miss the update if there is no existing test coverage. \r\n\r\nTo prevent these issues add a couple of utility methods to `StateStoreCustomMetric` as mentioned above.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nExisting UT and a new UT","created_at":"2021-06-15T06:37:28Z","updated_at":"2021-06-16T22:48:39Z","closed_at":"2021-06-16T22:48:39Z","merged_at":null,"merge_commit_sha":"e64a60c8005c29869ae08678e4a2161a72bf7771","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32914/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32914/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32914/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7211c4b407e5bf8353af3d2cbf6f072c79d5a175","head":{"label":"vkorukanti:SPARK-35763","ref":"SPARK-35763","sha":"7211c4b407e5bf8353af3d2cbf6f072c79d5a175","user":{"login":"vkorukanti","id":1719945,"node_id":"MDQ6VXNlcjE3MTk5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/1719945?v=4","gravatar_id":"","url":"https://api.github.com/users/vkorukanti","html_url":"https://github.com/vkorukanti","followers_url":"https://api.github.com/users/vkorukanti/followers","following_url":"https://api.github.com/users/vkorukanti/following{/other_user}","gists_url":"https://api.github.com/users/vkorukanti/gists{/gist_id}","starred_url":"https://api.github.com/users/vkorukanti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vkorukanti/subscriptions","organizations_url":"https://api.github.com/users/vkorukanti/orgs","repos_url":"https://api.github.com/users/vkorukanti/repos","events_url":"https://api.github.com/users/vkorukanti/events{/privacy}","received_events_url":"https://api.github.com/users/vkorukanti/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":311178081,"node_id":"MDEwOlJlcG9zaXRvcnkzMTExNzgwODE=","name":"spark","full_name":"vkorukanti/spark","private":false,"owner":{"login":"vkorukanti","id":1719945,"node_id":"MDQ6VXNlcjE3MTk5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/1719945?v=4","gravatar_id":"","url":"https://api.github.com/users/vkorukanti","html_url":"https://github.com/vkorukanti","followers_url":"https://api.github.com/users/vkorukanti/followers","following_url":"https://api.github.com/users/vkorukanti/following{/other_user}","gists_url":"https://api.github.com/users/vkorukanti/gists{/gist_id}","starred_url":"https://api.github.com/users/vkorukanti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vkorukanti/subscriptions","organizations_url":"https://api.github.com/users/vkorukanti/orgs","repos_url":"https://api.github.com/users/vkorukanti/repos","events_url":"https://api.github.com/users/vkorukanti/events{/privacy}","received_events_url":"https://api.github.com/users/vkorukanti/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vkorukanti/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/vkorukanti/spark","forks_url":"https://api.github.com/repos/vkorukanti/spark/forks","keys_url":"https://api.github.com/repos/vkorukanti/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vkorukanti/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vkorukanti/spark/teams","hooks_url":"https://api.github.com/repos/vkorukanti/spark/hooks","issue_events_url":"https://api.github.com/repos/vkorukanti/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vkorukanti/spark/events","assignees_url":"https://api.github.com/repos/vkorukanti/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vkorukanti/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vkorukanti/spark/tags","blobs_url":"https://api.github.com/repos/vkorukanti/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vkorukanti/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vkorukanti/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vkorukanti/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vkorukanti/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vkorukanti/spark/languages","stargazers_url":"https://api.github.com/repos/vkorukanti/spark/stargazers","contributors_url":"https://api.github.com/repos/vkorukanti/spark/contributors","subscribers_url":"https://api.github.com/repos/vkorukanti/spark/subscribers","subscription_url":"https://api.github.com/repos/vkorukanti/spark/subscription","commits_url":"https://api.github.com/repos/vkorukanti/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vkorukanti/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vkorukanti/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vkorukanti/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vkorukanti/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vkorukanti/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vkorukanti/spark/merges","archive_url":"https://api.github.com/repos/vkorukanti/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vkorukanti/spark/downloads","issues_url":"https://api.github.com/repos/vkorukanti/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vkorukanti/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vkorukanti/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vkorukanti/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vkorukanti/spark/labels{/name}","releases_url":"https://api.github.com/repos/vkorukanti/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vkorukanti/spark/deployments","created_at":"2020-11-08T23:48:31Z","updated_at":"2020-11-08T23:48:34Z","pushed_at":"2024-07-25T06:42:13Z","git_url":"git://github.com/vkorukanti/spark.git","ssh_url":"git@github.com:vkorukanti/spark.git","clone_url":"https://github.com/vkorukanti/spark.git","svn_url":"https://github.com/vkorukanti/spark","homepage":"https://spark.apache.org/","size":389551,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"aaa8a80c9d3426107de5873b4391600701121385","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32914"},"html":{"href":"https://github.com/apache/spark/pull/32914"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32914"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32914/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32914/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32914/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7211c4b407e5bf8353af3d2cbf6f072c79d5a175"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32913","id":669927712,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5OTI3NzEy","html_url":"https://github.com/apache/spark/pull/32913","diff_url":"https://github.com/apache/spark/pull/32913.diff","patch_url":"https://github.com/apache/spark/pull/32913.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32913","number":32913,"state":"closed","locked":false,"title":"[SPARK-35761][PYTHON] Use type-annotation based pandas_udf or avoid specifying udf types to suppress warnings","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nModify the `pandas_udf` usage to use type-annotation based pandas_udf or avoid specifying udf types to suppress warnings.\r\n\r\n### Why are the changes needed?\r\n\r\nThe usage of `pandas_udf` in pandas-on-Spark is outdated and shows warnings.\r\nWe should use type-annotation based `pandas_udf` or avoid specifying udf types.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests.","created_at":"2021-06-14T22:59:37Z","updated_at":"2021-06-15T02:18:08Z","closed_at":"2021-06-15T02:18:08Z","merged_at":null,"merge_commit_sha":"8d585ca0cce661ea1bb7004ea1691f3e11715ef7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32913/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32913/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32913/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/84c1b9949f83370579b952626852a4ac91401fe7","head":{"label":"ueshin:issues/SPARK-35761/suppress_warnings","ref":"issues/SPARK-35761/suppress_warnings","sha":"84c1b9949f83370579b952626852a4ac91401fe7","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":17234665,"node_id":"MDEwOlJlcG9zaXRvcnkxNzIzNDY2NQ==","name":"apache-spark","full_name":"ueshin/apache-spark","private":false,"owner":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ueshin/apache-spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/ueshin/apache-spark","forks_url":"https://api.github.com/repos/ueshin/apache-spark/forks","keys_url":"https://api.github.com/repos/ueshin/apache-spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ueshin/apache-spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ueshin/apache-spark/teams","hooks_url":"https://api.github.com/repos/ueshin/apache-spark/hooks","issue_events_url":"https://api.github.com/repos/ueshin/apache-spark/issues/events{/number}","events_url":"https://api.github.com/repos/ueshin/apache-spark/events","assignees_url":"https://api.github.com/repos/ueshin/apache-spark/assignees{/user}","branches_url":"https://api.github.com/repos/ueshin/apache-spark/branches{/branch}","tags_url":"https://api.github.com/repos/ueshin/apache-spark/tags","blobs_url":"https://api.github.com/repos/ueshin/apache-spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ueshin/apache-spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ueshin/apache-spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ueshin/apache-spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ueshin/apache-spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ueshin/apache-spark/languages","stargazers_url":"https://api.github.com/repos/ueshin/apache-spark/stargazers","contributors_url":"https://api.github.com/repos/ueshin/apache-spark/contributors","subscribers_url":"https://api.github.com/repos/ueshin/apache-spark/subscribers","subscription_url":"https://api.github.com/repos/ueshin/apache-spark/subscription","commits_url":"https://api.github.com/repos/ueshin/apache-spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ueshin/apache-spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ueshin/apache-spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ueshin/apache-spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ueshin/apache-spark/contents/{+path}","compare_url":"https://api.github.com/repos/ueshin/apache-spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ueshin/apache-spark/merges","archive_url":"https://api.github.com/repos/ueshin/apache-spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ueshin/apache-spark/downloads","issues_url":"https://api.github.com/repos/ueshin/apache-spark/issues{/number}","pulls_url":"https://api.github.com/repos/ueshin/apache-spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ueshin/apache-spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ueshin/apache-spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ueshin/apache-spark/labels{/name}","releases_url":"https://api.github.com/repos/ueshin/apache-spark/releases{/id}","deployments_url":"https://api.github.com/repos/ueshin/apache-spark/deployments","created_at":"2014-02-27T03:10:47Z","updated_at":"2025-02-07T02:07:18Z","pushed_at":"2025-02-07T19:29:05Z","git_url":"git://github.com/ueshin/apache-spark.git","ssh_url":"git@github.com:ueshin/apache-spark.git","clone_url":"https://github.com/ueshin/apache-spark.git","svn_url":"https://github.com/ueshin/apache-spark","homepage":null,"size":484941,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":8,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":8,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"aab0c2bf66edcfdd455168af59d91db1516a1576","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32913"},"html":{"href":"https://github.com/apache/spark/pull/32913"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32913"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32913/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32913/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32913/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/84c1b9949f83370579b952626852a4ac91401fe7"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32912","id":669903984,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5OTAzOTg0","html_url":"https://github.com/apache/spark/pull/32912","diff_url":"https://github.com/apache/spark/pull/32912.diff","patch_url":"https://github.com/apache/spark/pull/32912.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32912","number":32912,"state":"closed","locked":false,"title":"[SPARK-35429][CORE] Remove commons-httpclient from Hadoop-3.2 profile due to EOL and CVEs","user":{"login":"sumeetgajjar","id":7351922,"node_id":"MDQ6VXNlcjczNTE5MjI=","avatar_url":"https://avatars.githubusercontent.com/u/7351922?v=4","gravatar_id":"","url":"https://api.github.com/users/sumeetgajjar","html_url":"https://github.com/sumeetgajjar","followers_url":"https://api.github.com/users/sumeetgajjar/followers","following_url":"https://api.github.com/users/sumeetgajjar/following{/other_user}","gists_url":"https://api.github.com/users/sumeetgajjar/gists{/gist_id}","starred_url":"https://api.github.com/users/sumeetgajjar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sumeetgajjar/subscriptions","organizations_url":"https://api.github.com/users/sumeetgajjar/orgs","repos_url":"https://api.github.com/users/sumeetgajjar/repos","events_url":"https://api.github.com/users/sumeetgajjar/events{/privacy}","received_events_url":"https://api.github.com/users/sumeetgajjar/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nRemove commons-httpclient as a direct dependency for Hadoop-3.2 profile. \r\nHadoop-2.7 profile distribution still has it, hadoop-client has a compile dependency on commons-httpclient, thus we cannot remove it for Hadoop-2.7 profile.\r\n```\r\n[INFO] +- org.apache.hadoop:hadoop-client:jar:2.7.4:compile\r\n[INFO] |  +- org.apache.hadoop:hadoop-common:jar:2.7.4:compile\r\n[INFO] |  |  +- commons-cli:commons-cli:jar:1.2:compile\r\n[INFO] |  |  +- xmlenc:xmlenc:jar:0.52:compile\r\n[INFO] |  |  +- commons-httpclient:commons-httpclient:jar:3.1:compile\r\n```\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nSpark is pulling in commons-httpclient as a dependency directly. commons-httpclient went EOL years ago and there are most likely CVEs not being reported against it, thus we should remove it.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\n\r\n- Existing unittests\r\n- Checked the dependency tree before and after introducing the changes\r\n\r\nBefore:\r\n```\r\n./build/mvn dependency:tree -Phadoop-3.2 | grep -i \"commons-httpclient\"\r\nUsing `mvn` from path: /usr/bin/mvn\r\n[INFO] +- commons-httpclient:commons-httpclient:jar:3.1:compile\r\n[INFO] |  +- commons-httpclient:commons-httpclient:jar:3.1:provided\r\n```\r\n\r\nAfter\r\n```\r\n./build/mvn dependency:tree | grep -i \"commons-httpclient\"\r\nUsing `mvn` from path: /Users/sumeet.gajjar/cloudera/upstream-spark/build/apache-maven-3.6.3/bin/mvn\r\n```\r\n\r\nP.S. Reopening this since [spark upgraded](https://github.com/apache/spark/commit/463daabd5afd9abfb8027ebcb2e608f169ad1e40) its `hive.version` to `2.3.9` which does not have a dependency on `commons-httpclient`.","created_at":"2021-06-14T22:02:03Z","updated_at":"2021-06-16T05:26:54Z","closed_at":"2021-06-15T21:43:42Z","merged_at":null,"merge_commit_sha":"e7f17e4bba5daada38905b6f3c0dadb1d353be40","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32912/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32912/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32912/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3c0eb4763bf74a67eabb21fc02565790d9505ee0","head":{"label":"sumeetgajjar:SPARK-35429","ref":"SPARK-35429","sha":"3c0eb4763bf74a67eabb21fc02565790d9505ee0","user":{"login":"sumeetgajjar","id":7351922,"node_id":"MDQ6VXNlcjczNTE5MjI=","avatar_url":"https://avatars.githubusercontent.com/u/7351922?v=4","gravatar_id":"","url":"https://api.github.com/users/sumeetgajjar","html_url":"https://github.com/sumeetgajjar","followers_url":"https://api.github.com/users/sumeetgajjar/followers","following_url":"https://api.github.com/users/sumeetgajjar/following{/other_user}","gists_url":"https://api.github.com/users/sumeetgajjar/gists{/gist_id}","starred_url":"https://api.github.com/users/sumeetgajjar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sumeetgajjar/subscriptions","organizations_url":"https://api.github.com/users/sumeetgajjar/orgs","repos_url":"https://api.github.com/users/sumeetgajjar/repos","events_url":"https://api.github.com/users/sumeetgajjar/events{/privacy}","received_events_url":"https://api.github.com/users/sumeetgajjar/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":354211726,"node_id":"MDEwOlJlcG9zaXRvcnkzNTQyMTE3MjY=","name":"spark","full_name":"sumeetgajjar/spark","private":false,"owner":{"login":"sumeetgajjar","id":7351922,"node_id":"MDQ6VXNlcjczNTE5MjI=","avatar_url":"https://avatars.githubusercontent.com/u/7351922?v=4","gravatar_id":"","url":"https://api.github.com/users/sumeetgajjar","html_url":"https://github.com/sumeetgajjar","followers_url":"https://api.github.com/users/sumeetgajjar/followers","following_url":"https://api.github.com/users/sumeetgajjar/following{/other_user}","gists_url":"https://api.github.com/users/sumeetgajjar/gists{/gist_id}","starred_url":"https://api.github.com/users/sumeetgajjar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sumeetgajjar/subscriptions","organizations_url":"https://api.github.com/users/sumeetgajjar/orgs","repos_url":"https://api.github.com/users/sumeetgajjar/repos","events_url":"https://api.github.com/users/sumeetgajjar/events{/privacy}","received_events_url":"https://api.github.com/users/sumeetgajjar/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sumeetgajjar/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/sumeetgajjar/spark","forks_url":"https://api.github.com/repos/sumeetgajjar/spark/forks","keys_url":"https://api.github.com/repos/sumeetgajjar/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sumeetgajjar/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sumeetgajjar/spark/teams","hooks_url":"https://api.github.com/repos/sumeetgajjar/spark/hooks","issue_events_url":"https://api.github.com/repos/sumeetgajjar/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sumeetgajjar/spark/events","assignees_url":"https://api.github.com/repos/sumeetgajjar/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sumeetgajjar/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sumeetgajjar/spark/tags","blobs_url":"https://api.github.com/repos/sumeetgajjar/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sumeetgajjar/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sumeetgajjar/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sumeetgajjar/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sumeetgajjar/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sumeetgajjar/spark/languages","stargazers_url":"https://api.github.com/repos/sumeetgajjar/spark/stargazers","contributors_url":"https://api.github.com/repos/sumeetgajjar/spark/contributors","subscribers_url":"https://api.github.com/repos/sumeetgajjar/spark/subscribers","subscription_url":"https://api.github.com/repos/sumeetgajjar/spark/subscription","commits_url":"https://api.github.com/repos/sumeetgajjar/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sumeetgajjar/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sumeetgajjar/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sumeetgajjar/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sumeetgajjar/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sumeetgajjar/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sumeetgajjar/spark/merges","archive_url":"https://api.github.com/repos/sumeetgajjar/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sumeetgajjar/spark/downloads","issues_url":"https://api.github.com/repos/sumeetgajjar/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sumeetgajjar/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sumeetgajjar/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sumeetgajjar/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sumeetgajjar/spark/labels{/name}","releases_url":"https://api.github.com/repos/sumeetgajjar/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sumeetgajjar/spark/deployments","created_at":"2021-04-03T05:51:42Z","updated_at":"2021-04-11T00:11:33Z","pushed_at":"2022-08-16T05:51:58Z","git_url":"git://github.com/sumeetgajjar/spark.git","ssh_url":"git@github.com:sumeetgajjar/spark.git","clone_url":"https://github.com/sumeetgajjar/spark.git","svn_url":"https://github.com/sumeetgajjar/spark","homepage":"https://spark.apache.org/","size":423410,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"aab0c2bf66edcfdd455168af59d91db1516a1576","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32912"},"html":{"href":"https://github.com/apache/spark/pull/32912"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32912"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32912/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32912/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32912/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3c0eb4763bf74a67eabb21fc02565790d9505ee0"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32911","id":669897650,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5ODk3NjUw","html_url":"https://github.com/apache/spark/pull/32911","diff_url":"https://github.com/apache/spark/pull/32911.diff","patch_url":"https://github.com/apache/spark/pull/32911.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32911","number":32911,"state":"closed","locked":false,"title":"[SPARK-35760][SQL] Fix the max rows check for broadcast exchange","user":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis is to fix the maximal allowed number of rows check in `BroadcastExchangeExec`. After https://github.com/apache/spark/pull/27828, the max number of rows is calculated based on max capacity of `BytesToBytesMap` (previous value before the PR is 512000000). This calculation is not accurate as only `UnsafeHashedRelation` is using `BytesToBytesMap`. `LongHashedRelation` (used for broadcast join on key with long data type) has limit of [512000000](https://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/joins/HashedRelation.scala#L584), and `BroadcastNestedLoopJoinExec` is not depending on `HashedRelation` at all.\r\n\r\nThe change is to only specialize the max rows limit when needed. Keep other broadcast case with the previous limit - 512000000.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nFix code logic and avoid unexpected behavior.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nExisting unit tests.","created_at":"2021-06-14T21:47:28Z","updated_at":"2021-06-16T03:51:19Z","closed_at":"2021-06-16T00:36:36Z","merged_at":null,"merge_commit_sha":"3f9b85618a8e1f289fa495923074b986744f79c9","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32911/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32911/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32911/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/01652b5e2abe7ed6532c25f5acb43580c8043619","head":{"label":"c21:broadcast","ref":"broadcast","sha":"01652b5e2abe7ed6532c25f5acb43580c8043619","user":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":159474643,"node_id":"MDEwOlJlcG9zaXRvcnkxNTk0NzQ2NDM=","name":"spark","full_name":"c21/spark","private":false,"owner":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/c21/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/c21/spark","forks_url":"https://api.github.com/repos/c21/spark/forks","keys_url":"https://api.github.com/repos/c21/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/c21/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/c21/spark/teams","hooks_url":"https://api.github.com/repos/c21/spark/hooks","issue_events_url":"https://api.github.com/repos/c21/spark/issues/events{/number}","events_url":"https://api.github.com/repos/c21/spark/events","assignees_url":"https://api.github.com/repos/c21/spark/assignees{/user}","branches_url":"https://api.github.com/repos/c21/spark/branches{/branch}","tags_url":"https://api.github.com/repos/c21/spark/tags","blobs_url":"https://api.github.com/repos/c21/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/c21/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/c21/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/c21/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/c21/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/c21/spark/languages","stargazers_url":"https://api.github.com/repos/c21/spark/stargazers","contributors_url":"https://api.github.com/repos/c21/spark/contributors","subscribers_url":"https://api.github.com/repos/c21/spark/subscribers","subscription_url":"https://api.github.com/repos/c21/spark/subscription","commits_url":"https://api.github.com/repos/c21/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/c21/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/c21/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/c21/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/c21/spark/contents/{+path}","compare_url":"https://api.github.com/repos/c21/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/c21/spark/merges","archive_url":"https://api.github.com/repos/c21/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/c21/spark/downloads","issues_url":"https://api.github.com/repos/c21/spark/issues{/number}","pulls_url":"https://api.github.com/repos/c21/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/c21/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/c21/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/c21/spark/labels{/name}","releases_url":"https://api.github.com/repos/c21/spark/releases{/id}","deployments_url":"https://api.github.com/repos/c21/spark/deployments","created_at":"2018-11-28T09:15:08Z","updated_at":"2022-01-05T00:02:56Z","pushed_at":"2022-11-14T20:23:44Z","git_url":"git://github.com/c21/spark.git","ssh_url":"git@github.com:c21/spark.git","clone_url":"https://github.com/c21/spark.git","svn_url":"https://github.com/c21/spark","homepage":null,"size":420642,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"aab0c2bf66edcfdd455168af59d91db1516a1576","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32911"},"html":{"href":"https://github.com/apache/spark/pull/32911"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32911"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32911/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32911/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32911/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/01652b5e2abe7ed6532c25f5acb43580c8043619"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32910","id":669890400,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5ODkwNDAw","html_url":"https://github.com/apache/spark/pull/32910","diff_url":"https://github.com/apache/spark/pull/32910.diff","patch_url":"https://github.com/apache/spark/pull/32910.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32910","number":32910,"state":"closed","locked":false,"title":"[SPARK-35614][PYTHON] Make the conversion to pandas data-type-based for ExtensionDtypes","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nWe propose to\r\n- introduce the Ops class for ExtensionDtypes: `IntegralExtensionOps`, `FractionalExtensionOps`, `StringExtensionOps`\r\n- make the \"conversion to pandas\" data-type-based for ExtensionDtypes\r\n\r\nNon-goal: same arithmetic operation of ExtensionDtypes have different result dtypes between pandas and pandas API on Spark. That should be adjusted in a separated PR if needed.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nThe conversion to pandas includes logic for checking ExtensionDtypes data types and behaving accordingly.\r\nThat makes code hard to change or maintain.\r\n\r\nSince we have DataTypeOps defined, we are able to dispatch the specific conversion logic to the `ExtensionOps` classes.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit tests.\r\n\r\nKeyword: SPARK-35337","created_at":"2021-06-14T21:31:16Z","updated_at":"2021-11-01T17:28:40Z","closed_at":"2021-06-21T20:20:09Z","merged_at":null,"merge_commit_sha":"18e69d5185502f32fbeb4a1bb24398b1c79b495b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32910/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32910/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32910/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/63be4e7daa28a694a658960b498a78044b191779","head":{"label":"xinrong-meng:datatypeops_pd_ext","ref":"datatypeops_pd_ext","sha":"63be4e7daa28a694a658960b498a78044b191779","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":335786381,"node_id":"MDEwOlJlcG9zaXRvcnkzMzU3ODYzODE=","name":"spark","full_name":"xinrong-meng/spark","private":false,"owner":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xinrong-meng/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xinrong-meng/spark","forks_url":"https://api.github.com/repos/xinrong-meng/spark/forks","keys_url":"https://api.github.com/repos/xinrong-meng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xinrong-meng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xinrong-meng/spark/teams","hooks_url":"https://api.github.com/repos/xinrong-meng/spark/hooks","issue_events_url":"https://api.github.com/repos/xinrong-meng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xinrong-meng/spark/events","assignees_url":"https://api.github.com/repos/xinrong-meng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xinrong-meng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xinrong-meng/spark/tags","blobs_url":"https://api.github.com/repos/xinrong-meng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xinrong-meng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xinrong-meng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xinrong-meng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xinrong-meng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xinrong-meng/spark/languages","stargazers_url":"https://api.github.com/repos/xinrong-meng/spark/stargazers","contributors_url":"https://api.github.com/repos/xinrong-meng/spark/contributors","subscribers_url":"https://api.github.com/repos/xinrong-meng/spark/subscribers","subscription_url":"https://api.github.com/repos/xinrong-meng/spark/subscription","commits_url":"https://api.github.com/repos/xinrong-meng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xinrong-meng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xinrong-meng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xinrong-meng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xinrong-meng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xinrong-meng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xinrong-meng/spark/merges","archive_url":"https://api.github.com/repos/xinrong-meng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xinrong-meng/spark/downloads","issues_url":"https://api.github.com/repos/xinrong-meng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xinrong-meng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xinrong-meng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xinrong-meng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xinrong-meng/spark/labels{/name}","releases_url":"https://api.github.com/repos/xinrong-meng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xinrong-meng/spark/deployments","created_at":"2021-02-03T23:47:29Z","updated_at":"2024-09-27T08:09:06Z","pushed_at":"2025-02-08T02:14:33Z","git_url":"git://github.com/xinrong-meng/spark.git","ssh_url":"git@github.com:xinrong-meng/spark.git","clone_url":"https://github.com/xinrong-meng/spark.git","svn_url":"https://github.com/xinrong-meng/spark","homepage":"https://spark.apache.org/","size":469811,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":2,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2b9902d26a5b7e3aeecfed3aa21744d1d2016d26","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32910"},"html":{"href":"https://github.com/apache/spark/pull/32910"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32910"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32910/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32910/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32910/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/63be4e7daa28a694a658960b498a78044b191779"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32909","id":669871090,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5ODcxMDkw","html_url":"https://github.com/apache/spark/pull/32909","diff_url":"https://github.com/apache/spark/pull/32909.diff","patch_url":"https://github.com/apache/spark/pull/32909.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32909","number":32909,"state":"closed","locked":false,"title":"[SPARK-35680][SQL] Add fields to `YearMonthIntervalType`","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nExtend `YearMonthIntervalType` to support interval fields. Valid interval field values:\r\n- 0 (YEAR)\r\n- 1 (MONTH)\r\n\r\nAfter the changes, the following year-month interval types are supported:\r\n1. `YearMonthIntervalType(0, 0)` or `YearMonthIntervalType(YEAR, YEAR)`\r\n2. `YearMonthIntervalType(0, 1)` or `YearMonthIntervalType(YEAR, MONTH)`. **It is the default one**.\r\n3. `YearMonthIntervalType(1, 1)` or `YearMonthIntervalType(MONTH, MONTH)`\r\n\r\nCloses #32825\r\n\r\n### Why are the changes needed?\r\nIn the current implementation, Spark supports only `interval year to month` but the SQL standard allows to specify the start and end fields. The changes will allow to follow ANSI SQL standard more precisely.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes but `YearMonthIntervalType` has not been released yet.\r\n\r\n### How was this patch tested?\r\nBy existing test suites.","created_at":"2021-06-14T21:03:59Z","updated_at":"2021-06-19T12:20:12Z","closed_at":"2021-06-15T20:08:22Z","merged_at":null,"merge_commit_sha":"2bb675940e34327972861566ae21fac8a70a6ed9","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32909/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32909/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32909/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0554526e86d876de79af779f87366df24ad3bb43","head":{"label":"MaxGekk:add-fields-to-YearMonthIntervalType","ref":"add-fields-to-YearMonthIntervalType","sha":"0554526e86d876de79af779f87366df24ad3bb43","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":123690489,"node_id":"MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=","name":"spark","full_name":"MaxGekk/spark","private":false,"owner":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/MaxGekk/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/MaxGekk/spark","forks_url":"https://api.github.com/repos/MaxGekk/spark/forks","keys_url":"https://api.github.com/repos/MaxGekk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/MaxGekk/spark/teams","hooks_url":"https://api.github.com/repos/MaxGekk/spark/hooks","issue_events_url":"https://api.github.com/repos/MaxGekk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/MaxGekk/spark/events","assignees_url":"https://api.github.com/repos/MaxGekk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/MaxGekk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/MaxGekk/spark/tags","blobs_url":"https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/MaxGekk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/MaxGekk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/MaxGekk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/MaxGekk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/MaxGekk/spark/languages","stargazers_url":"https://api.github.com/repos/MaxGekk/spark/stargazers","contributors_url":"https://api.github.com/repos/MaxGekk/spark/contributors","subscribers_url":"https://api.github.com/repos/MaxGekk/spark/subscribers","subscription_url":"https://api.github.com/repos/MaxGekk/spark/subscription","commits_url":"https://api.github.com/repos/MaxGekk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/MaxGekk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/MaxGekk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/MaxGekk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/MaxGekk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/MaxGekk/spark/merges","archive_url":"https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/MaxGekk/spark/downloads","issues_url":"https://api.github.com/repos/MaxGekk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/MaxGekk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/MaxGekk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/MaxGekk/spark/labels{/name}","releases_url":"https://api.github.com/repos/MaxGekk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/MaxGekk/spark/deployments","created_at":"2018-03-03T12:37:00Z","updated_at":"2025-02-07T09:44:52Z","pushed_at":"2025-02-07T09:44:24Z","git_url":"git://github.com/MaxGekk/spark.git","ssh_url":"git@github.com:MaxGekk/spark.git","clone_url":"https://github.com/MaxGekk/spark.git","svn_url":"https://github.com/MaxGekk/spark","homepage":null,"size":486456,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"8a02f3a413e7163f8d29216de5a49ac77d9319e0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32909"},"html":{"href":"https://github.com/apache/spark/pull/32909"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32909"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32909/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32909/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32909/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0554526e86d876de79af779f87366df24ad3bb43"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32908","id":669789159,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5Nzg5MTU5","html_url":"https://github.com/apache/spark/pull/32908","diff_url":"https://github.com/apache/spark/pull/32908.diff","patch_url":"https://github.com/apache/spark/pull/32908.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32908","number":32908,"state":"closed","locked":false,"title":"[SPARK-35759][PYTHON] Remove the upperbound for numpy for pandas-on-Spark","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nRemoves the upperbound for numpy for pandas-on-Spark.\r\n\r\n### Why are the changes needed?\r\n\r\nWe can remove the upper-bound for numpy for pandas-on-Spark because currently it works well on the CI with numpy 1.20.3.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests.","created_at":"2021-06-14T18:36:40Z","updated_at":"2021-06-15T00:59:12Z","closed_at":"2021-06-15T00:59:12Z","merged_at":null,"merge_commit_sha":"09341c09f1b8e6f8fc3ea683408fe98ab071975a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32908/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32908/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32908/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/cb86ec3f13331878fd27d3ab9db840707f339287","head":{"label":"ueshin:issues/SPARK-35759/numpy","ref":"issues/SPARK-35759/numpy","sha":"cb86ec3f13331878fd27d3ab9db840707f339287","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":17234665,"node_id":"MDEwOlJlcG9zaXRvcnkxNzIzNDY2NQ==","name":"apache-spark","full_name":"ueshin/apache-spark","private":false,"owner":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ueshin/apache-spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/ueshin/apache-spark","forks_url":"https://api.github.com/repos/ueshin/apache-spark/forks","keys_url":"https://api.github.com/repos/ueshin/apache-spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ueshin/apache-spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ueshin/apache-spark/teams","hooks_url":"https://api.github.com/repos/ueshin/apache-spark/hooks","issue_events_url":"https://api.github.com/repos/ueshin/apache-spark/issues/events{/number}","events_url":"https://api.github.com/repos/ueshin/apache-spark/events","assignees_url":"https://api.github.com/repos/ueshin/apache-spark/assignees{/user}","branches_url":"https://api.github.com/repos/ueshin/apache-spark/branches{/branch}","tags_url":"https://api.github.com/repos/ueshin/apache-spark/tags","blobs_url":"https://api.github.com/repos/ueshin/apache-spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ueshin/apache-spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ueshin/apache-spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ueshin/apache-spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ueshin/apache-spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ueshin/apache-spark/languages","stargazers_url":"https://api.github.com/repos/ueshin/apache-spark/stargazers","contributors_url":"https://api.github.com/repos/ueshin/apache-spark/contributors","subscribers_url":"https://api.github.com/repos/ueshin/apache-spark/subscribers","subscription_url":"https://api.github.com/repos/ueshin/apache-spark/subscription","commits_url":"https://api.github.com/repos/ueshin/apache-spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ueshin/apache-spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ueshin/apache-spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ueshin/apache-spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ueshin/apache-spark/contents/{+path}","compare_url":"https://api.github.com/repos/ueshin/apache-spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ueshin/apache-spark/merges","archive_url":"https://api.github.com/repos/ueshin/apache-spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ueshin/apache-spark/downloads","issues_url":"https://api.github.com/repos/ueshin/apache-spark/issues{/number}","pulls_url":"https://api.github.com/repos/ueshin/apache-spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ueshin/apache-spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ueshin/apache-spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ueshin/apache-spark/labels{/name}","releases_url":"https://api.github.com/repos/ueshin/apache-spark/releases{/id}","deployments_url":"https://api.github.com/repos/ueshin/apache-spark/deployments","created_at":"2014-02-27T03:10:47Z","updated_at":"2025-02-07T02:07:18Z","pushed_at":"2025-02-07T19:29:05Z","git_url":"git://github.com/ueshin/apache-spark.git","ssh_url":"git@github.com:ueshin/apache-spark.git","clone_url":"https://github.com/ueshin/apache-spark.git","svn_url":"https://github.com/ueshin/apache-spark","homepage":null,"size":484941,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":8,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":8,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"aab0c2bf66edcfdd455168af59d91db1516a1576","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32908"},"html":{"href":"https://github.com/apache/spark/pull/32908"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32908"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32908/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32908/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32908/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/cb86ec3f13331878fd27d3ab9db840707f339287"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32907","id":669678414,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5Njc4NDE0","html_url":"https://github.com/apache/spark/pull/32907","diff_url":"https://github.com/apache/spark/pull/32907.diff","patch_url":"https://github.com/apache/spark/pull/32907.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32907","number":32907,"state":"closed","locked":false,"title":"[SPARK-35757][CORE] Add bitwise AND operation and functionality for intersecting bloom filters","user":{"login":"kudhru","id":13262810,"node_id":"MDQ6VXNlcjEzMjYyODEw","avatar_url":"https://avatars.githubusercontent.com/u/13262810?v=4","gravatar_id":"","url":"https://api.github.com/users/kudhru","html_url":"https://github.com/kudhru","followers_url":"https://api.github.com/users/kudhru/followers","following_url":"https://api.github.com/users/kudhru/following{/other_user}","gists_url":"https://api.github.com/users/kudhru/gists{/gist_id}","starred_url":"https://api.github.com/users/kudhru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kudhru/subscriptions","organizations_url":"https://api.github.com/users/kudhru/orgs","repos_url":"https://api.github.com/users/kudhru/repos","events_url":"https://api.github.com/users/kudhru/events{/privacy}","received_events_url":"https://api.github.com/users/kudhru/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nThis change is for [SPARK-35757](https://issues.apache.org/jira/browse/SPARK-35757) and does the following:\r\n\r\n1. adds bitwise AND operation to BitArray (similar to existing `putAll` method)\r\n2. adds an intersect operation for combining bloom filters using bitwise AND operation (similar to existing `mergeInPlace` method). \r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\nThe current bloom filter library only allows combining two bloom filters using OR operation. It is useful to have AND operation as well.\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo, just adds new methods.\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\nJust the existing tests.\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\n","created_at":"2021-06-14T15:45:57Z","updated_at":"2021-06-17T06:29:44Z","closed_at":"2021-06-17T06:29:44Z","merged_at":null,"merge_commit_sha":"3a79db6b9982139744d115255fd1f10af86d7291","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32907/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32907/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32907/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/78b0d873f8e6bccd68edccf965857a25b12d76e5","head":{"label":"kudhru:master","ref":"master","sha":"78b0d873f8e6bccd68edccf965857a25b12d76e5","user":{"login":"kudhru","id":13262810,"node_id":"MDQ6VXNlcjEzMjYyODEw","avatar_url":"https://avatars.githubusercontent.com/u/13262810?v=4","gravatar_id":"","url":"https://api.github.com/users/kudhru","html_url":"https://github.com/kudhru","followers_url":"https://api.github.com/users/kudhru/followers","following_url":"https://api.github.com/users/kudhru/following{/other_user}","gists_url":"https://api.github.com/users/kudhru/gists{/gist_id}","starred_url":"https://api.github.com/users/kudhru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kudhru/subscriptions","organizations_url":"https://api.github.com/users/kudhru/orgs","repos_url":"https://api.github.com/users/kudhru/repos","events_url":"https://api.github.com/users/kudhru/events{/privacy}","received_events_url":"https://api.github.com/users/kudhru/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"8e594f084a9f307cefcad13ccf439b0b608228c9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32907"},"html":{"href":"https://github.com/apache/spark/pull/32907"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32907"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32907/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32907/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32907/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/78b0d873f8e6bccd68edccf965857a25b12d76e5"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32906","id":669627290,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5NjI3Mjkw","html_url":"https://github.com/apache/spark/pull/32906","diff_url":"https://github.com/apache/spark/pull/32906.diff","patch_url":"https://github.com/apache/spark/pull/32906.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32906","number":32906,"state":"closed","locked":false,"title":"[SPARK-35755][PYTHON][INFRA] Use higher PyArrow versions in GitHub Actions build","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to use higher versions of PyArrow which more users use in general.\r\n\r\nWithout this PR, the testing matrix as follows:\r\n\r\n- (Python 3.8) Use PyArrow **2.x** in [pandas UDF tests in SQL side](https://github.com/apache/spark/blob/master/sql/core/src/test/scala/org/apache/spark/sql/IntegratedUDFTestUtils.scala)\r\n- (Python 3.6) Use PyArrow **2.x** in PySpark tests\r\n- (Python 3.9) Use PyArrow 4.x in PySpark tests (no change)\r\n- (Python 3.6) Use PyArrow **2.x** in PySpark documentation generation (it runs Spark jobs to generate images to use in PySpark API docs)\r\n\r\n\r\nAfter this PR, the testing matrix as follows:\r\n\r\n- (Python 3.8) Use PyArrow **4.x** in [pandas UDF tests in SQL side](https://github.com/apache/spark/blob/master/sql/core/src/test/scala/org/apache/spark/sql/IntegratedUDFTestUtils.scala)\r\n- (Python 3.6) Use PyArrow **3.x** in PySpark tests\r\n- (Python 3.9) Use PyArrow 4.x in PySpark tests (no change)\r\n- (Python 3.6) Use PyArrow **4.x** in PySpark documentation generation (it runs Spark jobs to generate images to use in PySpark API docs)\r\n\r\n\r\n### Why are the changes needed?\r\n\r\nTest matrix which more people use.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo, dev and testing only.\r\n\r\n### How was this patch tested?\r\n\r\nGitHub Actions in this PR should test it out.\r\n","created_at":"2021-06-14T14:41:50Z","updated_at":"2022-01-04T00:53:39Z","closed_at":"2021-06-15T00:59:46Z","merged_at":null,"merge_commit_sha":"0788d3a8ccfd62a465a0b1cb0d28720f7eb2b33d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1982110661,"node_id":"MDU6TGFiZWwxOTgyMTEwNjYx","url":"https://api.github.com/repos/apache/spark/labels/INFRA","name":"INFRA","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32906/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32906/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32906/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e357f98e84b52bc5ae7420434b842cd9df653ea1","head":{"label":"HyukjinKwon:SPARK-35755","ref":"SPARK-35755","sha":"e357f98e84b52bc5ae7420434b842cd9df653ea1","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"82af318c315d20541bd5f0f714cf746ca295b724","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32906"},"html":{"href":"https://github.com/apache/spark/pull/32906"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32906"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32906/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32906/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32906/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e357f98e84b52bc5ae7420434b842cd9df653ea1"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32905","id":669575316,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5NTc1MzE2","html_url":"https://github.com/apache/spark/pull/32905","diff_url":"https://github.com/apache/spark/pull/32905.diff","patch_url":"https://github.com/apache/spark/pull/32905.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32905","number":32905,"state":"closed","locked":false,"title":"[SPARK-35736][SPARK-35737][SQL][FOLLOWUP] Move a common logic to DayTimeIntervalType","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis is a followup PR for SPARK-35736(#32893) and SPARK-35737(#32892).\r\nThis PR moves a common logic to `object DayTimeIntervalType`.\r\nThat logic is like `val strToFieldIndex = DayTimeIntervalType.dayTimeFields.map(i => DayTimeIntervalType.fieldToString(i) -> (i).toMap`, a `Map` which maps each time unit to the corresponding day-time field index.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nThat logic appeared in the change in SPARK-35736 and SPARK-35737 so it can be a common logic and it's better to avoid the similar logic scattered.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nExisting tests.","created_at":"2021-06-14T13:38:47Z","updated_at":"2021-06-14T17:51:42Z","closed_at":"2021-06-14T17:51:42Z","merged_at":null,"merge_commit_sha":"be534a31445e6f80b5e72b4470db423bb20abe4a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32905/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32905/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32905/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/191ee09d101166e2e8a2bd0e6df3b10730f76617","head":{"label":"sarutak:followup-SPARK-35736-35737","ref":"followup-SPARK-35736-35737","sha":"191ee09d101166e2e8a2bd0e6df3b10730f76617","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19300892,"node_id":"MDEwOlJlcG9zaXRvcnkxOTMwMDg5Mg==","name":"spark","full_name":"sarutak/spark","private":false,"owner":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sarutak/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sarutak/spark","forks_url":"https://api.github.com/repos/sarutak/spark/forks","keys_url":"https://api.github.com/repos/sarutak/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sarutak/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sarutak/spark/teams","hooks_url":"https://api.github.com/repos/sarutak/spark/hooks","issue_events_url":"https://api.github.com/repos/sarutak/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sarutak/spark/events","assignees_url":"https://api.github.com/repos/sarutak/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sarutak/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sarutak/spark/tags","blobs_url":"https://api.github.com/repos/sarutak/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sarutak/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sarutak/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sarutak/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sarutak/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sarutak/spark/languages","stargazers_url":"https://api.github.com/repos/sarutak/spark/stargazers","contributors_url":"https://api.github.com/repos/sarutak/spark/contributors","subscribers_url":"https://api.github.com/repos/sarutak/spark/subscribers","subscription_url":"https://api.github.com/repos/sarutak/spark/subscription","commits_url":"https://api.github.com/repos/sarutak/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sarutak/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sarutak/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sarutak/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sarutak/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sarutak/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sarutak/spark/merges","archive_url":"https://api.github.com/repos/sarutak/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sarutak/spark/downloads","issues_url":"https://api.github.com/repos/sarutak/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sarutak/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sarutak/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sarutak/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sarutak/spark/labels{/name}","releases_url":"https://api.github.com/repos/sarutak/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sarutak/spark/deployments","created_at":"2014-04-30T04:35:03Z","updated_at":"2021-11-06T06:43:35Z","pushed_at":"2025-01-23T16:33:44Z","git_url":"git://github.com/sarutak/spark.git","ssh_url":"git@github.com:sarutak/spark.git","clone_url":"https://github.com/sarutak/spark.git","svn_url":"https://github.com/sarutak/spark","homepage":null,"size":467531,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"82af318c315d20541bd5f0f714cf746ca295b724","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32905"},"html":{"href":"https://github.com/apache/spark/pull/32905"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32905"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32905/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32905/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32905/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/191ee09d101166e2e8a2bd0e6df3b10730f76617"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32904","id":669468231,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5NDY4MjMx","html_url":"https://github.com/apache/spark/pull/32904","diff_url":"https://github.com/apache/spark/pull/32904.diff","patch_url":"https://github.com/apache/spark/pull/32904.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32904","number":32904,"state":"closed","locked":false,"title":"[SPARK-35765][SQL] Distinct aggs are not duplicate sensitive","user":{"login":"tanelk","id":3342974,"node_id":"MDQ6VXNlcjMzNDI5NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3342974?v=4","gravatar_id":"","url":"https://api.github.com/users/tanelk","html_url":"https://github.com/tanelk","followers_url":"https://api.github.com/users/tanelk/followers","following_url":"https://api.github.com/users/tanelk/following{/other_user}","gists_url":"https://api.github.com/users/tanelk/gists{/gist_id}","starred_url":"https://api.github.com/users/tanelk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanelk/subscriptions","organizations_url":"https://api.github.com/users/tanelk/orgs","repos_url":"https://api.github.com/users/tanelk/repos","events_url":"https://api.github.com/users/tanelk/events{/privacy}","received_events_url":"https://api.github.com/users/tanelk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nExtended `RemoveRedundantAggregates` to remove deduplicating aggregations before aggregations that ignore duplicates.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nPerformance imporovement.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nExtending existing UT","created_at":"2021-06-14T11:03:04Z","updated_at":"2021-06-16T01:02:15Z","closed_at":"2021-06-15T13:25:17Z","merged_at":null,"merge_commit_sha":"e0edbe9f748176b0474ffafbcb0d61fda1301361","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32904/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32904/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32904/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3f0cdae64db7a3a5dafd628f890e936cf743d16d","head":{"label":"tanelk:SPARK-33122_followup2_distinct_agg","ref":"SPARK-33122_followup2_distinct_agg","sha":"3f0cdae64db7a3a5dafd628f890e936cf743d16d","user":{"login":"tanelk","id":3342974,"node_id":"MDQ6VXNlcjMzNDI5NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3342974?v=4","gravatar_id":"","url":"https://api.github.com/users/tanelk","html_url":"https://github.com/tanelk","followers_url":"https://api.github.com/users/tanelk/followers","following_url":"https://api.github.com/users/tanelk/following{/other_user}","gists_url":"https://api.github.com/users/tanelk/gists{/gist_id}","starred_url":"https://api.github.com/users/tanelk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanelk/subscriptions","organizations_url":"https://api.github.com/users/tanelk/orgs","repos_url":"https://api.github.com/users/tanelk/repos","events_url":"https://api.github.com/users/tanelk/events{/privacy}","received_events_url":"https://api.github.com/users/tanelk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":279394019,"node_id":"MDEwOlJlcG9zaXRvcnkyNzkzOTQwMTk=","name":"spark","full_name":"tanelk/spark","private":false,"owner":{"login":"tanelk","id":3342974,"node_id":"MDQ6VXNlcjMzNDI5NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3342974?v=4","gravatar_id":"","url":"https://api.github.com/users/tanelk","html_url":"https://github.com/tanelk","followers_url":"https://api.github.com/users/tanelk/followers","following_url":"https://api.github.com/users/tanelk/following{/other_user}","gists_url":"https://api.github.com/users/tanelk/gists{/gist_id}","starred_url":"https://api.github.com/users/tanelk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanelk/subscriptions","organizations_url":"https://api.github.com/users/tanelk/orgs","repos_url":"https://api.github.com/users/tanelk/repos","events_url":"https://api.github.com/users/tanelk/events{/privacy}","received_events_url":"https://api.github.com/users/tanelk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/tanelk/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/tanelk/spark","forks_url":"https://api.github.com/repos/tanelk/spark/forks","keys_url":"https://api.github.com/repos/tanelk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/tanelk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/tanelk/spark/teams","hooks_url":"https://api.github.com/repos/tanelk/spark/hooks","issue_events_url":"https://api.github.com/repos/tanelk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/tanelk/spark/events","assignees_url":"https://api.github.com/repos/tanelk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/tanelk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/tanelk/spark/tags","blobs_url":"https://api.github.com/repos/tanelk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/tanelk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/tanelk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/tanelk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/tanelk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/tanelk/spark/languages","stargazers_url":"https://api.github.com/repos/tanelk/spark/stargazers","contributors_url":"https://api.github.com/repos/tanelk/spark/contributors","subscribers_url":"https://api.github.com/repos/tanelk/spark/subscribers","subscription_url":"https://api.github.com/repos/tanelk/spark/subscription","commits_url":"https://api.github.com/repos/tanelk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/tanelk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/tanelk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/tanelk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/tanelk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/tanelk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/tanelk/spark/merges","archive_url":"https://api.github.com/repos/tanelk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/tanelk/spark/downloads","issues_url":"https://api.github.com/repos/tanelk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/tanelk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/tanelk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/tanelk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/tanelk/spark/labels{/name}","releases_url":"https://api.github.com/repos/tanelk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/tanelk/spark/deployments","created_at":"2020-07-13T19:30:44Z","updated_at":"2021-12-03T13:34:30Z","pushed_at":"2024-04-12T13:31:59Z","git_url":"git://github.com/tanelk/spark.git","ssh_url":"git@github.com:tanelk/spark.git","clone_url":"https://github.com/tanelk/spark.git","svn_url":"https://github.com/tanelk/spark","homepage":"https://spark.apache.org/","size":409425,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"439e94c1712366ff267183d3946f2507ebf3a98e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32904"},"html":{"href":"https://github.com/apache/spark/pull/32904"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32904"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32904/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32904/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32904/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3f0cdae64db7a3a5dafd628f890e936cf743d16d"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32903","id":669445902,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5NDQ1OTAy","html_url":"https://github.com/apache/spark/pull/32903","diff_url":"https://github.com/apache/spark/pull/32903.diff","patch_url":"https://github.com/apache/spark/pull/32903.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32903","number":32903,"state":"closed","locked":false,"title":"[SPARK-35750][PYTHON][DOCS] Rename \"pandas APIs on Spark\" to \"pandas API on Spark\"","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to rename \"pandas APIs on Spark\" to \"pandas API on Spark\" which is more natural (since API stands for Application Program Interface).\r\n\r\n### Why are the changes needed?\r\n\r\nTo make it sound more natural.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nIt fixes a typo in the unreleased changes.\r\n\r\n### How was this patch tested?\r\n\r\nN/A","created_at":"2021-06-14T10:28:53Z","updated_at":"2022-01-04T00:53:38Z","closed_at":"2021-06-15T01:01:11Z","merged_at":null,"merge_commit_sha":"69acf1eb024c4d1f6cfbc7ed565811dece48291d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32903/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32903/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32903/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e082da69b4e60ab439314e5481d8e60f007fb75a","head":{"label":"HyukjinKwon:SPARK-34885","ref":"SPARK-34885","sha":"e082da69b4e60ab439314e5481d8e60f007fb75a","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2d47fb7683cdc01d0f4e6656c41ad54258ca4809","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32903"},"html":{"href":"https://github.com/apache/spark/pull/32903"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32903"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32903/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32903/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32903/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e082da69b4e60ab439314e5481d8e60f007fb75a"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32902","id":669440629,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5NDQwNjI5","html_url":"https://github.com/apache/spark/pull/32902","diff_url":"https://github.com/apache/spark/pull/32902.diff","patch_url":"https://github.com/apache/spark/pull/32902.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32902","number":32902,"state":"closed","locked":false,"title":"[SPARK-35754][CORE] Add config to put migrating blocks on disk only","user":{"login":"q2w","id":12875634,"node_id":"MDQ6VXNlcjEyODc1NjM0","avatar_url":"https://avatars.githubusercontent.com/u/12875634?v=4","gravatar_id":"","url":"https://api.github.com/users/q2w","html_url":"https://github.com/q2w","followers_url":"https://api.github.com/users/q2w/followers","following_url":"https://api.github.com/users/q2w/following{/other_user}","gists_url":"https://api.github.com/users/q2w/gists{/gist_id}","starred_url":"https://api.github.com/users/q2w/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/q2w/subscriptions","organizations_url":"https://api.github.com/users/q2w/orgs","repos_url":"https://api.github.com/users/q2w/repos","events_url":"https://api.github.com/users/q2w/events{/privacy}","received_events_url":"https://api.github.com/users/q2w/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR adds a config which makes block manager decommissioner to migrate block data on disk only. \r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nWhile migrating block data, if enough memory is not available on peer block managers existing blocks are dropped. After this PR migrating blocks won't drop any existing blocks. \r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUT in BlockManagerSuite","created_at":"2021-06-14T10:20:48Z","updated_at":"2021-10-11T00:09:47Z","closed_at":"2021-10-11T00:09:47Z","merged_at":null,"merge_commit_sha":"357a32b66ab9e0ba72fea9255a5f1fe6043eaf47","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32902/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32902/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32902/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c462df9035aaec6624fc90219a1ab7946e743ca5","head":{"label":"q2w:q2w/putMigratingBlocksOnDiskOnly","ref":"q2w/putMigratingBlocksOnDiskOnly","sha":"c462df9035aaec6624fc90219a1ab7946e743ca5","user":{"login":"q2w","id":12875634,"node_id":"MDQ6VXNlcjEyODc1NjM0","avatar_url":"https://avatars.githubusercontent.com/u/12875634?v=4","gravatar_id":"","url":"https://api.github.com/users/q2w","html_url":"https://github.com/q2w","followers_url":"https://api.github.com/users/q2w/followers","following_url":"https://api.github.com/users/q2w/following{/other_user}","gists_url":"https://api.github.com/users/q2w/gists{/gist_id}","starred_url":"https://api.github.com/users/q2w/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/q2w/subscriptions","organizations_url":"https://api.github.com/users/q2w/orgs","repos_url":"https://api.github.com/users/q2w/repos","events_url":"https://api.github.com/users/q2w/events{/privacy}","received_events_url":"https://api.github.com/users/q2w/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":225349651,"node_id":"MDEwOlJlcG9zaXRvcnkyMjUzNDk2NTE=","name":"spark","full_name":"q2w/spark","private":false,"owner":{"login":"q2w","id":12875634,"node_id":"MDQ6VXNlcjEyODc1NjM0","avatar_url":"https://avatars.githubusercontent.com/u/12875634?v=4","gravatar_id":"","url":"https://api.github.com/users/q2w","html_url":"https://github.com/q2w","followers_url":"https://api.github.com/users/q2w/followers","following_url":"https://api.github.com/users/q2w/following{/other_user}","gists_url":"https://api.github.com/users/q2w/gists{/gist_id}","starred_url":"https://api.github.com/users/q2w/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/q2w/subscriptions","organizations_url":"https://api.github.com/users/q2w/orgs","repos_url":"https://api.github.com/users/q2w/repos","events_url":"https://api.github.com/users/q2w/events{/privacy}","received_events_url":"https://api.github.com/users/q2w/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/q2w/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/q2w/spark","forks_url":"https://api.github.com/repos/q2w/spark/forks","keys_url":"https://api.github.com/repos/q2w/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/q2w/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/q2w/spark/teams","hooks_url":"https://api.github.com/repos/q2w/spark/hooks","issue_events_url":"https://api.github.com/repos/q2w/spark/issues/events{/number}","events_url":"https://api.github.com/repos/q2w/spark/events","assignees_url":"https://api.github.com/repos/q2w/spark/assignees{/user}","branches_url":"https://api.github.com/repos/q2w/spark/branches{/branch}","tags_url":"https://api.github.com/repos/q2w/spark/tags","blobs_url":"https://api.github.com/repos/q2w/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/q2w/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/q2w/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/q2w/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/q2w/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/q2w/spark/languages","stargazers_url":"https://api.github.com/repos/q2w/spark/stargazers","contributors_url":"https://api.github.com/repos/q2w/spark/contributors","subscribers_url":"https://api.github.com/repos/q2w/spark/subscribers","subscription_url":"https://api.github.com/repos/q2w/spark/subscription","commits_url":"https://api.github.com/repos/q2w/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/q2w/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/q2w/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/q2w/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/q2w/spark/contents/{+path}","compare_url":"https://api.github.com/repos/q2w/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/q2w/spark/merges","archive_url":"https://api.github.com/repos/q2w/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/q2w/spark/downloads","issues_url":"https://api.github.com/repos/q2w/spark/issues{/number}","pulls_url":"https://api.github.com/repos/q2w/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/q2w/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/q2w/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/q2w/spark/labels{/name}","releases_url":"https://api.github.com/repos/q2w/spark/releases{/id}","deployments_url":"https://api.github.com/repos/q2w/spark/deployments","created_at":"2019-12-02T10:40:14Z","updated_at":"2019-12-02T10:40:18Z","pushed_at":"2021-06-28T03:46:04Z","git_url":"git://github.com/q2w/spark.git","ssh_url":"git@github.com:q2w/spark.git","clone_url":"https://github.com/q2w/spark.git","svn_url":"https://github.com/q2w/spark","homepage":"","size":365826,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"439e94c1712366ff267183d3946f2507ebf3a98e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32902"},"html":{"href":"https://github.com/apache/spark/pull/32902"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32902"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32902/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32902/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32902/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c462df9035aaec6624fc90219a1ab7946e743ca5"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32901","id":669354447,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5MzU0NDQ3","html_url":"https://github.com/apache/spark/pull/32901","diff_url":"https://github.com/apache/spark/pull/32901.diff","patch_url":"https://github.com/apache/spark/pull/32901.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32901","number":32901,"state":"closed","locked":false,"title":"[SPARK-35753][R][INFRA] Increase stacksize in Maven for AppVeyor build","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to increase the stacksize in AppVeyor build. Currently, AppVeyor build is flaky:\r\n\r\n```\r\njava.lang.StackOverflowError\r\nscala.tools.nsc.transform.ExtensionMethods$Extender.transform(ExtensionMethods.scala:275)\r\nscala.tools.nsc.transform.ExtensionMethods$Extender.transform(ExtensionMethods.scala:133)\r\nscala.reflect.internal.Trees.$anonfun$itransform$1(Trees.scala:1421)\r\nscala.tools.nsc.transform.TypingTransformers$TypingTransformer.atOwner(TypingTransformers.scala:43)\r\nrmer.transform(TypingTransformers.scala:57)\r\n\tat scala.tools.nsc.transform.ExtensionMethods$Extender.transform(ExtensionMethods.scala:275)\r\n\tat scala.tools.nsc.transform.ExtensionMethods$Extender.transform(ExtensionMethods.scala:133)\r\n\tat scala.reflect.internal.Trees.itransform(Trees.scala:1409)\r\n\tat scala.reflect.internal.Trees.itransform$(Trees.scala:1400)\r\n\tat scala.reflect.internal.SymbolTable.itransform(SymbolTable.scala:28)\r\n\tat scala.reflect.internal.SymbolTable.itransform(SymbolTable.scala:28)\r\n\tat scala.reflect.api.Trees$Transformer.transform(Trees.scala:2563)\r\n\tat scala.tools.nsc.transform.TypingTransformers$TypingTransformer.transform(TypingTransformers.scala:57)\r\n\tat scala.tools.nsc.transform.ExtensionMethods$Extender.transform(ExtensionMethods.scala:275)\r\n```\r\n\r\nhttps://ci.appveyor.com/project/ApacheSoftwareFoundation/spark\r\n\r\n### Why are the changes needed?\r\n\r\nTo make the tests not flaky.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo, dev-only.\r\n\r\n### How was this patch tested?\r\nIt will be tested via AppVeyor CI in this PR build.","created_at":"2021-06-14T08:26:26Z","updated_at":"2022-01-04T00:53:37Z","closed_at":"2021-06-15T13:24:15Z","merged_at":null,"merge_commit_sha":"0ae2fe2e606b77e6643041155a13d5d0825a64c2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1982110661,"node_id":"MDU6TGFiZWwxOTgyMTEwNjYx","url":"https://api.github.com/repos/apache/spark/labels/INFRA","name":"INFRA","color":"ededed","default":false,"description":null}],"milestone":null,"draft":true,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32901/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32901/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32901/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2e5d1befb1de0e3facdca8e803f4c094f8ea0dfa","head":{"label":"HyukjinKwon:SPARK-35753","ref":"SPARK-35753","sha":"2e5d1befb1de0e3facdca8e803f4c094f8ea0dfa","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"439e94c1712366ff267183d3946f2507ebf3a98e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32901"},"html":{"href":"https://github.com/apache/spark/pull/32901"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32901"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32901/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32901/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32901/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2e5d1befb1de0e3facdca8e803f4c094f8ea0dfa"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32900","id":669262633,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5MjYyNjMz","html_url":"https://github.com/apache/spark/pull/32900","diff_url":"https://github.com/apache/spark/pull/32900.diff","patch_url":"https://github.com/apache/spark/pull/32900.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32900","number":32900,"state":"closed","locked":false,"title":"[SPARK-35751]Support Joint eviction strategies for cached RDD partitions","user":{"login":"qfoxzjd","id":4484833,"node_id":"MDQ6VXNlcjQ0ODQ4MzM=","avatar_url":"https://avatars.githubusercontent.com/u/4484833?v=4","gravatar_id":"","url":"https://api.github.com/users/qfoxzjd","html_url":"https://github.com/qfoxzjd","followers_url":"https://api.github.com/users/qfoxzjd/followers","following_url":"https://api.github.com/users/qfoxzjd/following{/other_user}","gists_url":"https://api.github.com/users/qfoxzjd/gists{/gist_id}","starred_url":"https://api.github.com/users/qfoxzjd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qfoxzjd/subscriptions","organizations_url":"https://api.github.com/users/qfoxzjd/orgs","repos_url":"https://api.github.com/users/qfoxzjd/repos","events_url":"https://api.github.com/users/qfoxzjd/events{/privacy}","received_events_url":"https://api.github.com/users/qfoxzjd/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nCurrently, there is only eviction strategy for cached RDD partition in Spark.\r\n\r\nThe default RDD eviction strategy is LRU (with an additional rule that do not replacing another block that belongs to the same RDD like current creating partition).\r\n\r\nWhen memory space not sufficient for RDD caching, several partitions will be evicted, if these partitions are used again latterly, they will be reproduced by the Lineage information and cached in memory again. The reproduce phase will bring in additional cost. However, LRU has no guarantee for the lowest reproduce cost.\r\nThe first RDD that needed to be cached is usually generated by reading from HDFS and doing several transformations. The reading operation usually cost longer time than other Spark transformations.\r\n\r\nFor example, in one stage we having the following DAG structure: hdfs -> [A] -> B -> [C] -> D - > [E] -> [F], RDD A, C, E, F needed to be cached in memory, F is creating during this stage while A, B and E had already been created in previous. When using the LRU eviction strategy, partition of A will be evicted first. However, the time cost in\\ [A] -> B -> [C] may be much less than hdfs ->\\ [A], so evict [C] may be better than evict [A].\r\n\r\nA eviction strategy based on the creation cost may be better than LRU, by statisticing each transformation's time during the creation of cached RDD partition (e.g. [E] only need to statistic time cost in [C] -> D and D -> [E]) and time cost in needed shuffle reading. When memory for RDD storage not sufficient, partition with the least creation cost may be evicted first. So this strategy for be called as LCS. My current demo show better performance gain than default LRU.\r\n\r\nThis strategy needs to consider the following situation:\r\n1. Unified Memory Management is provided after Spark 1.6, memory for execution during recomputing a partition may be pretty different than the first time the partition created. So before better thought, LCS may not be allowed in UMM mode. (Though my demo also show improvement in LCS than LRU in UMM mode).\r\n\r\n2. MEMORY_AND_DISK_SER or other similar storage level may serialize RDD partition. By estimating ser/deserialize cost and compare to creation cost, if the ser/deserialize cost even larger than recreation, not serialize but directly removed from memory. As existing storage level only allowed for the whole RDD, so a new storage level may be needed for RDD partition to directly determine whether to serialize or just remove from memory.\r\n\r\nBesides LCS, FIFO or LFU is easy to be implemented.","created_at":"2021-06-14T06:31:24Z","updated_at":"2021-09-13T18:05:48Z","closed_at":"2021-09-13T18:05:48Z","merged_at":null,"merge_commit_sha":null,"assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1405801475,"node_id":"MDU6TGFiZWwxNDA1ODAxNDc1","url":"https://api.github.com/repos/apache/spark/labels/ML","name":"ML","color":"ededed","default":false,"description":null},{"id":1405803268,"node_id":"MDU6TGFiZWwxNDA1ODAzMjY4","url":"https://api.github.com/repos/apache/spark/labels/MLLIB","name":"MLLIB","color":"ededed","default":false,"description":null},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1406605057,"node_id":"MDU6TGFiZWwxNDA2NjA1MDU3","url":"https://api.github.com/repos/apache/spark/labels/KUBERNETES","name":"KUBERNETES","color":"ededed","default":false,"description":null},{"id":1406605079,"node_id":"MDU6TGFiZWwxNDA2NjA1MDc5","url":"https://api.github.com/repos/apache/spark/labels/WEB%20UI","name":"WEB UI","color":"ededed","default":false,"description":null},{"id":1406606351,"node_id":"MDU6TGFiZWwxNDA2NjA2MzUx","url":"https://api.github.com/repos/apache/spark/labels/DEPLOY","name":"DEPLOY","color":"ededed","default":false,"description":null},{"id":1406607243,"node_id":"MDU6TGFiZWwxNDA2NjA3MjQz","url":"https://api.github.com/repos/apache/spark/labels/GRAPHX","name":"GRAPHX","color":"ededed","default":false,"description":null},{"id":1406625202,"node_id":"MDU6TGFiZWwxNDA2NjI1MjAy","url":"https://api.github.com/repos/apache/spark/labels/MESOS","name":"MESOS","color":"ededed","default":false,"description":null},{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1406628559,"node_id":"MDU6TGFiZWwxNDA2NjI4NTU5","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20SHELL","name":"SPARK SHELL","color":"ededed","default":false,"description":null},{"id":1427970157,"node_id":"MDU6TGFiZWwxNDI3OTcwMTU3","url":"https://api.github.com/repos/apache/spark/labels/YARN","name":"YARN","color":"ededed","default":false,"description":null},{"id":1496047285,"node_id":"MDU6TGFiZWwxNDk2MDQ3Mjg1","url":"https://api.github.com/repos/apache/spark/labels/EXAMPLES","name":"EXAMPLES","color":"ededed","default":false,"description":""},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982015569,"node_id":"MDU6TGFiZWwxOTgyMDE1NTY5","url":"https://api.github.com/repos/apache/spark/labels/WINDOWS","name":"WINDOWS","color":"ededed","default":false,"description":null},{"id":1982110661,"node_id":"MDU6TGFiZWwxOTgyMTEwNjYx","url":"https://api.github.com/repos/apache/spark/labels/INFRA","name":"INFRA","color":"ededed","default":false,"description":null},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":1984361638,"node_id":"MDU6TGFiZWwxOTg0MzYxNjM4","url":"https://api.github.com/repos/apache/spark/labels/R","name":"R","color":"ededed","default":false,"description":null},{"id":1984378631,"node_id":"MDU6TGFiZWwxOTg0Mzc4NjMx","url":"https://api.github.com/repos/apache/spark/labels/DSTREAM","name":"DSTREAM","color":"ededed","default":false,"description":null},{"id":1988040187,"node_id":"MDU6TGFiZWwxOTg4MDQwMTg3","url":"https://api.github.com/repos/apache/spark/labels/AVRO","name":"AVRO","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32900/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32900/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32900/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/540937f193a8ce6a04ac6b3183cd4586114491f1","head":{"label":"apache:branch-3.0","ref":"branch-3.0","sha":"540937f193a8ce6a04ac6b3183cd4586114491f1","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7978fdc97b92c20bc23675dee6941af5f7be8805","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32900"},"html":{"href":"https://github.com/apache/spark/pull/32900"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32900"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32900/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32900/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32900/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/540937f193a8ce6a04ac6b3183cd4586114491f1"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32899","id":669158888,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5MTU4ODg4","html_url":"https://github.com/apache/spark/pull/32899","diff_url":"https://github.com/apache/spark/pull/32899.diff","patch_url":"https://github.com/apache/spark/pull/32899.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32899","number":32899,"state":"closed","locked":false,"title":"[SPARK-35652][SQL][3.0] joinWith on two table generated from same one","user":{"login":"dgd-contributor","id":84778052,"node_id":"MDQ6VXNlcjg0Nzc4MDUy","avatar_url":"https://avatars.githubusercontent.com/u/84778052?v=4","gravatar_id":"","url":"https://api.github.com/users/dgd-contributor","html_url":"https://github.com/dgd-contributor","followers_url":"https://api.github.com/users/dgd-contributor/followers","following_url":"https://api.github.com/users/dgd-contributor/following{/other_user}","gists_url":"https://api.github.com/users/dgd-contributor/gists{/gist_id}","starred_url":"https://api.github.com/users/dgd-contributor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgd-contributor/subscriptions","organizations_url":"https://api.github.com/users/dgd-contributor/orgs","repos_url":"https://api.github.com/users/dgd-contributor/repos","events_url":"https://api.github.com/users/dgd-contributor/events{/privacy}","received_events_url":"https://api.github.com/users/dgd-contributor/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"It seems like spark inner join is performing a cartesian join in self joining using `joinWith`\r\n\r\nTo produce this issues:\r\n```\r\nval df = spark.range(0,3)\r\ndf.joinWith(df, df(\"id\") === df(\"id\")).show()\r\n```\r\n\r\nBefore this pull request, the result is\r\n+---+---+\r\n | _1 |  _2 |\r\n+---+---+\r\n|    0 |   0 |\r\n|    0 |   1 |\r\n|    0 |   2 |\r\n|    1 |   0 |\r\n|    1 |   1 |\r\n|    1 |   2 |\r\n|    2 |   0 |\r\n|    2 |   1 |\r\n|    2 |   2 |\r\n+---+---+\r\n\r\nThe expected result is\r\n+---+---+\r\n | _1 |  _2 |\r\n+---+---+\r\n|    0 |   0 |\r\n|    1 |   1 |\r\n|    2 |   2 |\r\n+---+---+\r\ncorrectness\r\n\r\nno\r\n\r\nadd test\r\n\r\nCloses #32863 from dgd-contributor/SPARK-35652_join_and_joinWith_in_seft_joining.\r\n\r\nAuthored-by: dgd-contributor <dgd_contributor@viettel.com.vn>\r\nSigned-off-by: Wenchen Fan <wenchen@databricks.com>\r\n\r\n<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\n","created_at":"2021-06-14T01:56:22Z","updated_at":"2021-06-17T06:11:15Z","closed_at":"2021-06-17T06:11:15Z","merged_at":null,"merge_commit_sha":"73561a019c2f0a78eff1e28f988aca3d3fe6c3a3","assignee":null,"assignees":[],"requested_reviewers":[{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32899/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32899/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32899/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b5c77069001fc64cb01628554ab2ac7e4bc42c7c","head":{"label":"dgd-contributor:branch-3.0","ref":"branch-3.0","sha":"b5c77069001fc64cb01628554ab2ac7e4bc42c7c","user":{"login":"dgd-contributor","id":84778052,"node_id":"MDQ6VXNlcjg0Nzc4MDUy","avatar_url":"https://avatars.githubusercontent.com/u/84778052?v=4","gravatar_id":"","url":"https://api.github.com/users/dgd-contributor","html_url":"https://github.com/dgd-contributor","followers_url":"https://api.github.com/users/dgd-contributor/followers","following_url":"https://api.github.com/users/dgd-contributor/following{/other_user}","gists_url":"https://api.github.com/users/dgd-contributor/gists{/gist_id}","starred_url":"https://api.github.com/users/dgd-contributor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgd-contributor/subscriptions","organizations_url":"https://api.github.com/users/dgd-contributor/orgs","repos_url":"https://api.github.com/users/dgd-contributor/repos","events_url":"https://api.github.com/users/dgd-contributor/events{/privacy}","received_events_url":"https://api.github.com/users/dgd-contributor/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":370663608,"node_id":"MDEwOlJlcG9zaXRvcnkzNzA2NjM2MDg=","name":"spark","full_name":"dgd-contributor/spark","private":false,"owner":{"login":"dgd-contributor","id":84778052,"node_id":"MDQ6VXNlcjg0Nzc4MDUy","avatar_url":"https://avatars.githubusercontent.com/u/84778052?v=4","gravatar_id":"","url":"https://api.github.com/users/dgd-contributor","html_url":"https://github.com/dgd-contributor","followers_url":"https://api.github.com/users/dgd-contributor/followers","following_url":"https://api.github.com/users/dgd-contributor/following{/other_user}","gists_url":"https://api.github.com/users/dgd-contributor/gists{/gist_id}","starred_url":"https://api.github.com/users/dgd-contributor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgd-contributor/subscriptions","organizations_url":"https://api.github.com/users/dgd-contributor/orgs","repos_url":"https://api.github.com/users/dgd-contributor/repos","events_url":"https://api.github.com/users/dgd-contributor/events{/privacy}","received_events_url":"https://api.github.com/users/dgd-contributor/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dgd-contributor/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/dgd-contributor/spark","forks_url":"https://api.github.com/repos/dgd-contributor/spark/forks","keys_url":"https://api.github.com/repos/dgd-contributor/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dgd-contributor/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dgd-contributor/spark/teams","hooks_url":"https://api.github.com/repos/dgd-contributor/spark/hooks","issue_events_url":"https://api.github.com/repos/dgd-contributor/spark/issues/events{/number}","events_url":"https://api.github.com/repos/dgd-contributor/spark/events","assignees_url":"https://api.github.com/repos/dgd-contributor/spark/assignees{/user}","branches_url":"https://api.github.com/repos/dgd-contributor/spark/branches{/branch}","tags_url":"https://api.github.com/repos/dgd-contributor/spark/tags","blobs_url":"https://api.github.com/repos/dgd-contributor/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dgd-contributor/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dgd-contributor/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/dgd-contributor/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dgd-contributor/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/dgd-contributor/spark/languages","stargazers_url":"https://api.github.com/repos/dgd-contributor/spark/stargazers","contributors_url":"https://api.github.com/repos/dgd-contributor/spark/contributors","subscribers_url":"https://api.github.com/repos/dgd-contributor/spark/subscribers","subscription_url":"https://api.github.com/repos/dgd-contributor/spark/subscription","commits_url":"https://api.github.com/repos/dgd-contributor/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/dgd-contributor/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/dgd-contributor/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/dgd-contributor/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/dgd-contributor/spark/contents/{+path}","compare_url":"https://api.github.com/repos/dgd-contributor/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dgd-contributor/spark/merges","archive_url":"https://api.github.com/repos/dgd-contributor/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dgd-contributor/spark/downloads","issues_url":"https://api.github.com/repos/dgd-contributor/spark/issues{/number}","pulls_url":"https://api.github.com/repos/dgd-contributor/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/dgd-contributor/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/dgd-contributor/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dgd-contributor/spark/labels{/name}","releases_url":"https://api.github.com/repos/dgd-contributor/spark/releases{/id}","deployments_url":"https://api.github.com/repos/dgd-contributor/spark/deployments","created_at":"2021-05-25T11:08:20Z","updated_at":"2021-10-06T01:57:55Z","pushed_at":"2021-10-06T01:57:45Z","git_url":"git://github.com/dgd-contributor/spark.git","ssh_url":"git@github.com:dgd-contributor/spark.git","clone_url":"https://github.com/dgd-contributor/spark.git","svn_url":"https://github.com/dgd-contributor/spark","homepage":"https://spark.apache.org/","size":390391,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:branch-3.0","ref":"branch-3.0","sha":"673654b27a5fca800974b43495c6c0d0db9b1479","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32899"},"html":{"href":"https://github.com/apache/spark/pull/32899"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32899"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32899/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32899/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32899/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b5c77069001fc64cb01628554ab2ac7e4bc42c7c"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32898","id":669100139,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5MTAwMTM5","html_url":"https://github.com/apache/spark/pull/32898","diff_url":"https://github.com/apache/spark/pull/32898.diff","patch_url":"https://github.com/apache/spark/pull/32898.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32898","number":32898,"state":"closed","locked":false,"title":"[SPARK-35720][SQL] Support casting of String to timestamp without time zone type","user":{"login":"pingsutw","id":37936015,"node_id":"MDQ6VXNlcjM3OTM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/37936015?v=4","gravatar_id":"","url":"https://api.github.com/users/pingsutw","html_url":"https://github.com/pingsutw","followers_url":"https://api.github.com/users/pingsutw/followers","following_url":"https://api.github.com/users/pingsutw/following{/other_user}","gists_url":"https://api.github.com/users/pingsutw/gists{/gist_id}","starred_url":"https://api.github.com/users/pingsutw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pingsutw/subscriptions","organizations_url":"https://api.github.com/users/pingsutw/orgs","repos_url":"https://api.github.com/users/pingsutw/repos","events_url":"https://api.github.com/users/pingsutw/events{/privacy}","received_events_url":"https://api.github.com/users/pingsutw/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nExtend the Cast expression and  support casting of String to timestamp without time zone type\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo conform the ANSI SQL standard which requires to support such casting.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo, the new timestamp type is not released yet.\r\n\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit test","created_at":"2021-06-13T19:03:20Z","updated_at":"2021-06-18T09:27:18Z","closed_at":"2021-06-17T18:02:34Z","merged_at":null,"merge_commit_sha":"08ca6c971fd3a05cd3b473ada00a16fd47a7ec2c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32898/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32898/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32898/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b17975f024fb0dd66ab60912aa4b63f5008ccea2","head":{"label":"pingsutw:SPARK-35720","ref":"SPARK-35720","sha":"b17975f024fb0dd66ab60912aa4b63f5008ccea2","user":{"login":"pingsutw","id":37936015,"node_id":"MDQ6VXNlcjM3OTM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/37936015?v=4","gravatar_id":"","url":"https://api.github.com/users/pingsutw","html_url":"https://github.com/pingsutw","followers_url":"https://api.github.com/users/pingsutw/followers","following_url":"https://api.github.com/users/pingsutw/following{/other_user}","gists_url":"https://api.github.com/users/pingsutw/gists{/gist_id}","starred_url":"https://api.github.com/users/pingsutw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pingsutw/subscriptions","organizations_url":"https://api.github.com/users/pingsutw/orgs","repos_url":"https://api.github.com/users/pingsutw/repos","events_url":"https://api.github.com/users/pingsutw/events{/privacy}","received_events_url":"https://api.github.com/users/pingsutw/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":273827179,"node_id":"MDEwOlJlcG9zaXRvcnkyNzM4MjcxNzk=","name":"spark","full_name":"pingsutw/spark","private":false,"owner":{"login":"pingsutw","id":37936015,"node_id":"MDQ6VXNlcjM3OTM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/37936015?v=4","gravatar_id":"","url":"https://api.github.com/users/pingsutw","html_url":"https://github.com/pingsutw","followers_url":"https://api.github.com/users/pingsutw/followers","following_url":"https://api.github.com/users/pingsutw/following{/other_user}","gists_url":"https://api.github.com/users/pingsutw/gists{/gist_id}","starred_url":"https://api.github.com/users/pingsutw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pingsutw/subscriptions","organizations_url":"https://api.github.com/users/pingsutw/orgs","repos_url":"https://api.github.com/users/pingsutw/repos","events_url":"https://api.github.com/users/pingsutw/events{/privacy}","received_events_url":"https://api.github.com/users/pingsutw/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pingsutw/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/pingsutw/spark","forks_url":"https://api.github.com/repos/pingsutw/spark/forks","keys_url":"https://api.github.com/repos/pingsutw/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pingsutw/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pingsutw/spark/teams","hooks_url":"https://api.github.com/repos/pingsutw/spark/hooks","issue_events_url":"https://api.github.com/repos/pingsutw/spark/issues/events{/number}","events_url":"https://api.github.com/repos/pingsutw/spark/events","assignees_url":"https://api.github.com/repos/pingsutw/spark/assignees{/user}","branches_url":"https://api.github.com/repos/pingsutw/spark/branches{/branch}","tags_url":"https://api.github.com/repos/pingsutw/spark/tags","blobs_url":"https://api.github.com/repos/pingsutw/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pingsutw/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pingsutw/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/pingsutw/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pingsutw/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/pingsutw/spark/languages","stargazers_url":"https://api.github.com/repos/pingsutw/spark/stargazers","contributors_url":"https://api.github.com/repos/pingsutw/spark/contributors","subscribers_url":"https://api.github.com/repos/pingsutw/spark/subscribers","subscription_url":"https://api.github.com/repos/pingsutw/spark/subscription","commits_url":"https://api.github.com/repos/pingsutw/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/pingsutw/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/pingsutw/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/pingsutw/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/pingsutw/spark/contents/{+path}","compare_url":"https://api.github.com/repos/pingsutw/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pingsutw/spark/merges","archive_url":"https://api.github.com/repos/pingsutw/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pingsutw/spark/downloads","issues_url":"https://api.github.com/repos/pingsutw/spark/issues{/number}","pulls_url":"https://api.github.com/repos/pingsutw/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/pingsutw/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/pingsutw/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pingsutw/spark/labels{/name}","releases_url":"https://api.github.com/repos/pingsutw/spark/releases{/id}","deployments_url":"https://api.github.com/repos/pingsutw/spark/deployments","created_at":"2020-06-21T03:29:25Z","updated_at":"2021-07-04T16:32:57Z","pushed_at":"2021-09-14T11:39:26Z","git_url":"git://github.com/pingsutw/spark.git","ssh_url":"git@github.com:pingsutw/spark.git","clone_url":"https://github.com/pingsutw/spark.git","svn_url":"https://github.com/pingsutw/spark","homepage":"https://spark.apache.org/","size":381328,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1125afd4622e6d3f7f14fca1ebcfebdfba6d9529","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32898"},"html":{"href":"https://github.com/apache/spark/pull/32898"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32898"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32898/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32898/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32898/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b17975f024fb0dd66ab60912aa4b63f5008ccea2"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32897","id":669048204,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5MDQ4MjA0","html_url":"https://github.com/apache/spark/pull/32897","diff_url":"https://github.com/apache/spark/pull/32897.diff","patch_url":"https://github.com/apache/spark/pull/32897.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32897","number":32897,"state":"closed","locked":false,"title":"[SPARK-35415][SQL] Change information to struct type for SHOW TABLE EXTENDED command","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nChange information column to struct type for SHOW TABLE EXTENDED command.\r\n\r\n### Why are the changes needed?\r\nUsually not all information is what we need and it has poor readability. After SPARK-35283 and this PR. We can get the need information by key:\r\n\r\n```\r\nWITH s AS (SHOW TABLE EXTENDED LIKE '*') SELECT tableName, information.storage.Provider FROM s\r\n+------------+---------------------+\r\n|tableName   |information[Provider]|\r\n+------------+---------------------+\r\n|test_delta  |delta                |\r\n|test_parquet|parquet              |\r\n+------------+---------------------+\r\n```\r\n\r\n### Does this PR introduce any user-facing change?\r\nYes. The information column type changed.\r\n\r\n### How was this patch tested?\r\nUnit test.","created_at":"2021-06-13T12:49:47Z","updated_at":"2021-09-30T00:10:18Z","closed_at":"2021-09-30T00:10:18Z","merged_at":null,"merge_commit_sha":"964aed1fdf6ba9a3ff6c59228f9522558d50a8b5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32897/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32897/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32897/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/868d3b6e7f8688ad7ff031e02159ff55aaf76601","head":{"label":"AngersZhuuuu:SPARK-35415-angerszhuuuu","ref":"SPARK-35415-angerszhuuuu","sha":"868d3b6e7f8688ad7ff031e02159ff55aaf76601","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":176224753,"node_id":"MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=","name":"spark","full_name":"AngersZhuuuu/spark","private":false,"owner":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/AngersZhuuuu/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/AngersZhuuuu/spark","forks_url":"https://api.github.com/repos/AngersZhuuuu/spark/forks","keys_url":"https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/AngersZhuuuu/spark/teams","hooks_url":"https://api.github.com/repos/AngersZhuuuu/spark/hooks","issue_events_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/AngersZhuuuu/spark/events","assignees_url":"https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/tags","blobs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/AngersZhuuuu/spark/languages","stargazers_url":"https://api.github.com/repos/AngersZhuuuu/spark/stargazers","contributors_url":"https://api.github.com/repos/AngersZhuuuu/spark/contributors","subscribers_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscribers","subscription_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscription","commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/AngersZhuuuu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/AngersZhuuuu/spark/merges","archive_url":"https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/AngersZhuuuu/spark/downloads","issues_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/AngersZhuuuu/spark/labels{/name}","releases_url":"https://api.github.com/repos/AngersZhuuuu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/AngersZhuuuu/spark/deployments","created_at":"2019-03-18T07:13:25Z","updated_at":"2024-12-31T06:48:27Z","pushed_at":"2024-12-31T06:45:23Z","git_url":"git://github.com/AngersZhuuuu/spark.git","ssh_url":"git@github.com:AngersZhuuuu/spark.git","clone_url":"https://github.com/AngersZhuuuu/spark.git","svn_url":"https://github.com/AngersZhuuuu/spark","homepage":"","size":446399,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"0ba1d3852b3e6f89128403e988d6ca8772d1706c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32897"},"html":{"href":"https://github.com/apache/spark/pull/32897"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32897"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32897/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32897/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32897/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/868d3b6e7f8688ad7ff031e02159ff55aaf76601"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32896","id":669032333,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5MDMyMzMz","html_url":"https://github.com/apache/spark/pull/32896","diff_url":"https://github.com/apache/spark/pull/32896.diff","patch_url":"https://github.com/apache/spark/pull/32896.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32896","number":32896,"state":"closed","locked":false,"title":"[SPARK-35748][SS][SQL] Fix StreamingJoinHelper to be able to handle day-time interval","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR fixes `StreamingJoinHelper` to be able to handle day-time interval.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nIn the current master, `StreamingJoinHelper.getStateValueWatermark` can't handle conditions which contain day-time interval literals.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nNew assertions added to `StreamingJoinHlelperSuite`.","created_at":"2021-06-13T10:53:11Z","updated_at":"2021-06-14T12:45:56Z","closed_at":"2021-06-14T12:45:56Z","merged_at":null,"merge_commit_sha":"d6b8a261f92241d773459e5ccd77b9a7f09cceff","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32896/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32896/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32896/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e2ab9bf6f9ff8bb240d2dba50874bbba7447310b","head":{"label":"sarutak:streamingjoinhelper-daytime","ref":"streamingjoinhelper-daytime","sha":"e2ab9bf6f9ff8bb240d2dba50874bbba7447310b","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19300892,"node_id":"MDEwOlJlcG9zaXRvcnkxOTMwMDg5Mg==","name":"spark","full_name":"sarutak/spark","private":false,"owner":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sarutak/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sarutak/spark","forks_url":"https://api.github.com/repos/sarutak/spark/forks","keys_url":"https://api.github.com/repos/sarutak/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sarutak/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sarutak/spark/teams","hooks_url":"https://api.github.com/repos/sarutak/spark/hooks","issue_events_url":"https://api.github.com/repos/sarutak/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sarutak/spark/events","assignees_url":"https://api.github.com/repos/sarutak/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sarutak/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sarutak/spark/tags","blobs_url":"https://api.github.com/repos/sarutak/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sarutak/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sarutak/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sarutak/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sarutak/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sarutak/spark/languages","stargazers_url":"https://api.github.com/repos/sarutak/spark/stargazers","contributors_url":"https://api.github.com/repos/sarutak/spark/contributors","subscribers_url":"https://api.github.com/repos/sarutak/spark/subscribers","subscription_url":"https://api.github.com/repos/sarutak/spark/subscription","commits_url":"https://api.github.com/repos/sarutak/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sarutak/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sarutak/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sarutak/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sarutak/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sarutak/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sarutak/spark/merges","archive_url":"https://api.github.com/repos/sarutak/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sarutak/spark/downloads","issues_url":"https://api.github.com/repos/sarutak/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sarutak/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sarutak/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sarutak/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sarutak/spark/labels{/name}","releases_url":"https://api.github.com/repos/sarutak/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sarutak/spark/deployments","created_at":"2014-04-30T04:35:03Z","updated_at":"2021-11-06T06:43:35Z","pushed_at":"2025-01-23T16:33:44Z","git_url":"git://github.com/sarutak/spark.git","ssh_url":"git@github.com:sarutak/spark.git","clone_url":"https://github.com/sarutak/spark.git","svn_url":"https://github.com/sarutak/spark","homepage":null,"size":467531,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"0ba1d3852b3e6f89128403e988d6ca8772d1706c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32896"},"html":{"href":"https://github.com/apache/spark/pull/32896"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32896"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32896/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32896/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32896/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e2ab9bf6f9ff8bb240d2dba50874bbba7447310b"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32895","id":669014614,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY5MDE0NjE0","html_url":"https://github.com/apache/spark/pull/32895","diff_url":"https://github.com/apache/spark/pull/32895.diff","patch_url":"https://github.com/apache/spark/pull/32895.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32895","number":32895,"state":"closed","locked":false,"title":"[SPARK-35658][DOCS] Document Parquet encryption feature in Spark SQL","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nSpark 3.2.0 will use parquet-mr.1.12.0 version (or higher), that contains the column encryption feature which can be called from Spark SQL. The aim of this PR is to document the use of Parquet encryption in Spark.\r\n\r\n### Why are the changes needed?\r\n\r\n- To provide information on how to use Parquet column encryption\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, documents a new feature.\r\n\r\n### How was this patch tested?\r\n\r\nbundle exec jekyll build\r\n","created_at":"2021-06-13T08:32:08Z","updated_at":"2021-07-21T11:53:25Z","closed_at":"2021-07-21T02:35:55Z","merged_at":null,"merge_commit_sha":"b53bf653ab46597f9238a769935797ba7c807c8b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32895/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32895/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32895/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c3d840e3a2db65c306064485c83efa04d294371f","head":{"label":"ggershinsky:parquet-encryption-doc","ref":"parquet-encryption-doc","sha":"c3d840e3a2db65c306064485c83efa04d294371f","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":376473226,"node_id":"MDEwOlJlcG9zaXRvcnkzNzY0NzMyMjY=","name":"spark","full_name":"ggershinsky/spark","private":false,"owner":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ggershinsky/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/ggershinsky/spark","forks_url":"https://api.github.com/repos/ggershinsky/spark/forks","keys_url":"https://api.github.com/repos/ggershinsky/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ggershinsky/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ggershinsky/spark/teams","hooks_url":"https://api.github.com/repos/ggershinsky/spark/hooks","issue_events_url":"https://api.github.com/repos/ggershinsky/spark/issues/events{/number}","events_url":"https://api.github.com/repos/ggershinsky/spark/events","assignees_url":"https://api.github.com/repos/ggershinsky/spark/assignees{/user}","branches_url":"https://api.github.com/repos/ggershinsky/spark/branches{/branch}","tags_url":"https://api.github.com/repos/ggershinsky/spark/tags","blobs_url":"https://api.github.com/repos/ggershinsky/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ggershinsky/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ggershinsky/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ggershinsky/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ggershinsky/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ggershinsky/spark/languages","stargazers_url":"https://api.github.com/repos/ggershinsky/spark/stargazers","contributors_url":"https://api.github.com/repos/ggershinsky/spark/contributors","subscribers_url":"https://api.github.com/repos/ggershinsky/spark/subscribers","subscription_url":"https://api.github.com/repos/ggershinsky/spark/subscription","commits_url":"https://api.github.com/repos/ggershinsky/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ggershinsky/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ggershinsky/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ggershinsky/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ggershinsky/spark/contents/{+path}","compare_url":"https://api.github.com/repos/ggershinsky/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ggershinsky/spark/merges","archive_url":"https://api.github.com/repos/ggershinsky/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ggershinsky/spark/downloads","issues_url":"https://api.github.com/repos/ggershinsky/spark/issues{/number}","pulls_url":"https://api.github.com/repos/ggershinsky/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ggershinsky/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ggershinsky/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ggershinsky/spark/labels{/name}","releases_url":"https://api.github.com/repos/ggershinsky/spark/releases{/id}","deployments_url":"https://api.github.com/repos/ggershinsky/spark/deployments","created_at":"2021-06-13T07:47:09Z","updated_at":"2021-10-28T06:16:17Z","pushed_at":"2023-01-20T07:54:08Z","git_url":"git://github.com/ggershinsky/spark.git","ssh_url":"git@github.com:ggershinsky/spark.git","clone_url":"https://github.com/ggershinsky/spark.git","svn_url":"https://github.com/ggershinsky/spark","homepage":"https://spark.apache.org/","size":442868,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"0ba1d3852b3e6f89128403e988d6ca8772d1706c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32895"},"html":{"href":"https://github.com/apache/spark/pull/32895"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32895"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32895/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32895/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32895/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c3d840e3a2db65c306064485c83efa04d294371f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32894","id":668984916,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY4OTg0OTE2","html_url":"https://github.com/apache/spark/pull/32894","diff_url":"https://github.com/apache/spark/pull/32894.diff","patch_url":"https://github.com/apache/spark/pull/32894.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32894","number":32894,"state":"closed","locked":false,"title":"[SPARK-35747][CORE] Avoid printing full Exception stack trace, if Hbase/Kafka/Hive services are not running in a secure cluster","user":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nIn a secure Yarn cluster, even though HBase or Kafka, or Hive services are not used in the user application, yarn client unnecessarily trying to generate  Delegations token from these services. This will add additional delays while submitting spark application in a yarn cluster\r\n\r\n Also during HBase delegation token generation step in the application submit stage,  HBaseDelegationTokenProvider prints a full Exception Stack trace and it causes a noisy warning. \r\n Apart from printing exception stack trace, Application submission taking more time as it retries connection to HBase master multiple times before it gives up. So, if HBase is not used in the user Applications, it is better to suggest User disable HBase Delegation Token generation.\r\n\r\n This PR aims to avoid printing full Exception Stack by just printing just Exception name and also add a suggestion message to disable `Delegation Token generation` if service is not used in the Spark Application. \r\n \r\n eg: `If HBase is not used, set spark.security.credentials.hbase.enabled to false`\r\n\r\n### Why are the changes needed?\r\n\r\nTo avoid printing full Exception stack trace in WARN log \r\n#### Before the fix\r\n----------------\r\n```\r\nspark-shell --master yarn\r\n.......\r\n.......\r\n21/06/12 14:29:41 WARN security.HBaseDelegationTokenProvider: Failed to get token from service hbase\r\njava.lang.reflect.InvocationTargetException\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.spark.deploy.security.HBaseDelegationTokenProvider.obtainDelegationTokensWithHBaseConn(HBaseDelegationT\r\nokenProvider.scala:93)\r\n        at org.apache.spark.deploy.security.HBaseDelegationTokenProvider.obtainDelegationTokens(HBaseDelegationTokenProvider.\r\nscala:60)\r\n        at org.apache.spark.deploy.security.HadoopDelegationTokenManager$$anonfun$6.apply(HadoopDelegationTokenManager.scala:\r\n166)\r\n        at org.apache.spark.deploy.security.HadoopDelegationTokenManager$$anonfun$6.apply(HadoopDelegationTokenManager.scala:\r\n164)\r\n        at scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:241)\r\n        at scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:241)\r\n        at scala.collection.Iterator$class.foreach(Iterator.scala:891)\r\n        at scala.collection.AbstractIterator.foreach(Iterator.scala:1334)\r\n        at scala.collection.MapLike$DefaultValuesIterable.foreach(MapLike.scala:206)\r\n        at scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:241)\r\n        at scala.collection.AbstractTraversable.flatMap(Traversable.scala:104)\r\n        at org.apache.spark.deploy.security.HadoopDelegationTokenManager.obtainDelegationTokens(HadoopDelegationTokenManager.\r\nscala:164)\r\n```\r\n\r\n#### After  the fix\r\n------------\r\n```\r\n spark-shell --master yarn\r\n\r\nSetting default log level to \"WARN\".\r\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\r\n21/06/13 02:10:02 WARN security.HBaseDelegationTokenProvider: Failed to get token from service hbase due to  java.lang.reflect.InvocationTargetException Retrying to fetch HBase security token with hbase connection parameter.\r\n21/06/13 02:10:40 WARN security.HBaseDelegationTokenProvider: Failed to get token from service hbase java.lang.reflect.InvocationTargetException. If HBase is not used, set spark.security.credentials.hbase.enabled to false\r\n21/06/13 02:10:47 WARN cluster.YarnSchedulerBackend$YarnSchedulerEndpoint: Attempted to request executors before the AM has registered!\r\n```\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, in the log, it avoids printing full Exception stack trace. \r\nInstread prints this.\r\n**WARN security.HBaseDelegationTokenProvider: Failed to get token from service hbase java.lang.reflect.InvocationTargetException. If HBase is not used, set spark.security.credentials.hbase.enabled to false**\r\n\r\n### How was this patch tested?\r\n\r\nTested manually as it can be verified only in a secure cluster \r\n","created_at":"2021-06-13T03:40:42Z","updated_at":"2021-06-24T06:12:10Z","closed_at":"2021-06-24T06:12:10Z","merged_at":null,"merge_commit_sha":"15afb5767f8377f8f8454ffeac43140f4ac68209","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32894/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32894/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32894/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7bad9e4903e76d59139510ca89b63916dd69fb4b","head":{"label":"vinodkc:br_fix_Hbase_DT_Exception_stack_printing","ref":"br_fix_Hbase_DT_Exception_stack_printing","sha":"7bad9e4903e76d59139510ca89b63916dd69fb4b","user":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":86780265,"node_id":"MDEwOlJlcG9zaXRvcnk4Njc4MDI2NQ==","name":"spark","full_name":"vinodkc/spark","private":false,"owner":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vinodkc/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/vinodkc/spark","forks_url":"https://api.github.com/repos/vinodkc/spark/forks","keys_url":"https://api.github.com/repos/vinodkc/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vinodkc/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vinodkc/spark/teams","hooks_url":"https://api.github.com/repos/vinodkc/spark/hooks","issue_events_url":"https://api.github.com/repos/vinodkc/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vinodkc/spark/events","assignees_url":"https://api.github.com/repos/vinodkc/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vinodkc/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vinodkc/spark/tags","blobs_url":"https://api.github.com/repos/vinodkc/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vinodkc/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vinodkc/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vinodkc/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vinodkc/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vinodkc/spark/languages","stargazers_url":"https://api.github.com/repos/vinodkc/spark/stargazers","contributors_url":"https://api.github.com/repos/vinodkc/spark/contributors","subscribers_url":"https://api.github.com/repos/vinodkc/spark/subscribers","subscription_url":"https://api.github.com/repos/vinodkc/spark/subscription","commits_url":"https://api.github.com/repos/vinodkc/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vinodkc/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vinodkc/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vinodkc/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vinodkc/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vinodkc/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vinodkc/spark/merges","archive_url":"https://api.github.com/repos/vinodkc/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vinodkc/spark/downloads","issues_url":"https://api.github.com/repos/vinodkc/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vinodkc/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vinodkc/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vinodkc/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vinodkc/spark/labels{/name}","releases_url":"https://api.github.com/repos/vinodkc/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vinodkc/spark/deployments","created_at":"2017-03-31T05:10:58Z","updated_at":"2025-01-24T19:30:18Z","pushed_at":"2025-01-24T19:26:51Z","git_url":"git://github.com/vinodkc/spark.git","ssh_url":"git@github.com:vinodkc/spark.git","clone_url":"https://github.com/vinodkc/spark.git","svn_url":"https://github.com/vinodkc/spark","homepage":null,"size":464015,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":3,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"41af409b7bcfe1b3960274c0b3085bcc1f9d1c98","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32894"},"html":{"href":"https://github.com/apache/spark/pull/32894"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32894"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32894/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32894/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32894/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7bad9e4903e76d59139510ca89b63916dd69fb4b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32893","id":668929710,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY4OTI5NzEw","html_url":"https://github.com/apache/spark/pull/32893","diff_url":"https://github.com/apache/spark/pull/32893.diff","patch_url":"https://github.com/apache/spark/pull/32893.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32893","number":32893,"state":"closed","locked":false,"title":"[SPARK-35736][SQL] Parse any day-time interval types in SQL","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR adda a feature which allow the parser parse any day-time interval types in SQL.\r\n\r\n### Why are the changes needed?\r\nTo comply with ANSI standard, we additionally need to support the following types.\r\n\r\n* INTERVAL DAY\r\n* INTERVAL DAY TO HOUR\r\n* INTERVAL DAY TO MINUTE\r\n* INTERVAL HOUR\r\n* INTERVAL HOUR TO MINUTE\r\n* INTERVAL HOUR TO SECOND\r\n* INTERVAL MINUTE\r\n* INTERVAL MINUTE TO SECOND\r\n* INTERVAL SECOND\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nNew tests.","created_at":"2021-06-12T18:31:56Z","updated_at":"2021-06-13T21:13:59Z","closed_at":"2021-06-13T21:13:59Z","merged_at":null,"merge_commit_sha":"07e6f8b277f04fe900b870c3bac8e4f5ebaf0099","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32893/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32893/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32893/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/cec3c0e4951c533ee1d927cfe36ae5ba62a77669","head":{"label":"sarutak:parse-any-day-time","ref":"parse-any-day-time","sha":"cec3c0e4951c533ee1d927cfe36ae5ba62a77669","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19300892,"node_id":"MDEwOlJlcG9zaXRvcnkxOTMwMDg5Mg==","name":"spark","full_name":"sarutak/spark","private":false,"owner":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sarutak/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sarutak/spark","forks_url":"https://api.github.com/repos/sarutak/spark/forks","keys_url":"https://api.github.com/repos/sarutak/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sarutak/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sarutak/spark/teams","hooks_url":"https://api.github.com/repos/sarutak/spark/hooks","issue_events_url":"https://api.github.com/repos/sarutak/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sarutak/spark/events","assignees_url":"https://api.github.com/repos/sarutak/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sarutak/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sarutak/spark/tags","blobs_url":"https://api.github.com/repos/sarutak/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sarutak/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sarutak/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sarutak/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sarutak/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sarutak/spark/languages","stargazers_url":"https://api.github.com/repos/sarutak/spark/stargazers","contributors_url":"https://api.github.com/repos/sarutak/spark/contributors","subscribers_url":"https://api.github.com/repos/sarutak/spark/subscribers","subscription_url":"https://api.github.com/repos/sarutak/spark/subscription","commits_url":"https://api.github.com/repos/sarutak/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sarutak/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sarutak/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sarutak/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sarutak/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sarutak/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sarutak/spark/merges","archive_url":"https://api.github.com/repos/sarutak/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sarutak/spark/downloads","issues_url":"https://api.github.com/repos/sarutak/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sarutak/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sarutak/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sarutak/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sarutak/spark/labels{/name}","releases_url":"https://api.github.com/repos/sarutak/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sarutak/spark/deployments","created_at":"2014-04-30T04:35:03Z","updated_at":"2021-11-06T06:43:35Z","pushed_at":"2025-01-23T16:33:44Z","git_url":"git://github.com/sarutak/spark.git","ssh_url":"git@github.com:sarutak/spark.git","clone_url":"https://github.com/sarutak/spark.git","svn_url":"https://github.com/sarutak/spark","homepage":null,"size":467531,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"450b415028c3b00f3a002126cd11318d3932e28f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32893"},"html":{"href":"https://github.com/apache/spark/pull/32893"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32893"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32893/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32893/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32893/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/cec3c0e4951c533ee1d927cfe36ae5ba62a77669"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32892","id":668923792,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY4OTIzNzky","html_url":"https://github.com/apache/spark/pull/32892","diff_url":"https://github.com/apache/spark/pull/32892.diff","patch_url":"https://github.com/apache/spark/pull/32892.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32892","number":32892,"state":"closed","locked":false,"title":"[SPARK-35737][SQL] Parse day-time interval literals to tightest types","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR add a feature which parse day-time interval literals to tightest type.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo comply with the ANSI behavior.\r\nFor example, `INTERVAL '10 20:30' DAY TO MINUTE` should be parsed as `DayTimeIntervalType(DAY, MINUTE)` but not as `DayTimeIntervalType(DAY, SECOND)`.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo because `DayTimeIntervalType` will be introduced in `3.2.0`.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nNew tests.","created_at":"2021-06-12T17:58:07Z","updated_at":"2021-06-14T07:06:41Z","closed_at":"2021-06-14T07:06:41Z","merged_at":null,"merge_commit_sha":"d8d23ae966af935febc9401d788bc75b78b8b818","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32892/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32892/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32892/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/eef88fcbe7770d942fd8cf1177791eebf0ad79e7","head":{"label":"sarutak:tight-daytime-interval","ref":"tight-daytime-interval","sha":"eef88fcbe7770d942fd8cf1177791eebf0ad79e7","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19300892,"node_id":"MDEwOlJlcG9zaXRvcnkxOTMwMDg5Mg==","name":"spark","full_name":"sarutak/spark","private":false,"owner":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sarutak/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sarutak/spark","forks_url":"https://api.github.com/repos/sarutak/spark/forks","keys_url":"https://api.github.com/repos/sarutak/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sarutak/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sarutak/spark/teams","hooks_url":"https://api.github.com/repos/sarutak/spark/hooks","issue_events_url":"https://api.github.com/repos/sarutak/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sarutak/spark/events","assignees_url":"https://api.github.com/repos/sarutak/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sarutak/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sarutak/spark/tags","blobs_url":"https://api.github.com/repos/sarutak/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sarutak/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sarutak/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sarutak/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sarutak/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sarutak/spark/languages","stargazers_url":"https://api.github.com/repos/sarutak/spark/stargazers","contributors_url":"https://api.github.com/repos/sarutak/spark/contributors","subscribers_url":"https://api.github.com/repos/sarutak/spark/subscribers","subscription_url":"https://api.github.com/repos/sarutak/spark/subscription","commits_url":"https://api.github.com/repos/sarutak/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sarutak/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sarutak/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sarutak/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sarutak/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sarutak/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sarutak/spark/merges","archive_url":"https://api.github.com/repos/sarutak/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sarutak/spark/downloads","issues_url":"https://api.github.com/repos/sarutak/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sarutak/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sarutak/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sarutak/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sarutak/spark/labels{/name}","releases_url":"https://api.github.com/repos/sarutak/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sarutak/spark/deployments","created_at":"2014-04-30T04:35:03Z","updated_at":"2021-11-06T06:43:35Z","pushed_at":"2025-01-23T16:33:44Z","git_url":"git://github.com/sarutak/spark.git","ssh_url":"git@github.com:sarutak/spark.git","clone_url":"https://github.com/sarutak/spark.git","svn_url":"https://github.com/sarutak/spark","homepage":null,"size":467531,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1125afd4622e6d3f7f14fca1ebcfebdfba6d9529","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32892"},"html":{"href":"https://github.com/apache/spark/pull/32892"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32892"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32892/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32892/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32892/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/eef88fcbe7770d942fd8cf1177791eebf0ad79e7"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32891","id":668843953,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY4ODQzOTUz","html_url":"https://github.com/apache/spark/pull/32891","diff_url":"https://github.com/apache/spark/pull/32891.diff","patch_url":"https://github.com/apache/spark/pull/32891.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32891","number":32891,"state":"closed","locked":false,"title":"[SPARK-35734][SQL] Format day-time intervals using type fields","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR add a feature which formats day-time interval to strings using the start and end fields of `DayTimeIntervalType`.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCurrently, they are ignored, and any `DayTimeIntervalType` is formatted as `INTERVAL DAY TO SECOND.`\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nYes. The format of day-time intervals is determined the start and end fields.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nNew test.","created_at":"2021-06-12T11:15:33Z","updated_at":"2021-06-12T18:45:24Z","closed_at":"2021-06-12T18:45:24Z","merged_at":null,"merge_commit_sha":"6de71c49d393ca592639ddb39b8bc65c4c955dd7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32891/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32891/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32891/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/89a36e9ef69a83e234958717b8b9827ddf011a0e","head":{"label":"sarutak:interval-format","ref":"interval-format","sha":"89a36e9ef69a83e234958717b8b9827ddf011a0e","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19300892,"node_id":"MDEwOlJlcG9zaXRvcnkxOTMwMDg5Mg==","name":"spark","full_name":"sarutak/spark","private":false,"owner":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sarutak/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sarutak/spark","forks_url":"https://api.github.com/repos/sarutak/spark/forks","keys_url":"https://api.github.com/repos/sarutak/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sarutak/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sarutak/spark/teams","hooks_url":"https://api.github.com/repos/sarutak/spark/hooks","issue_events_url":"https://api.github.com/repos/sarutak/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sarutak/spark/events","assignees_url":"https://api.github.com/repos/sarutak/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sarutak/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sarutak/spark/tags","blobs_url":"https://api.github.com/repos/sarutak/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sarutak/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sarutak/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sarutak/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sarutak/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sarutak/spark/languages","stargazers_url":"https://api.github.com/repos/sarutak/spark/stargazers","contributors_url":"https://api.github.com/repos/sarutak/spark/contributors","subscribers_url":"https://api.github.com/repos/sarutak/spark/subscribers","subscription_url":"https://api.github.com/repos/sarutak/spark/subscription","commits_url":"https://api.github.com/repos/sarutak/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sarutak/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sarutak/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sarutak/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sarutak/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sarutak/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sarutak/spark/merges","archive_url":"https://api.github.com/repos/sarutak/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sarutak/spark/downloads","issues_url":"https://api.github.com/repos/sarutak/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sarutak/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sarutak/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sarutak/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sarutak/spark/labels{/name}","releases_url":"https://api.github.com/repos/sarutak/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sarutak/spark/deployments","created_at":"2014-04-30T04:35:03Z","updated_at":"2021-11-06T06:43:35Z","pushed_at":"2025-01-23T16:33:44Z","git_url":"git://github.com/sarutak/spark.git","ssh_url":"git@github.com:sarutak/spark.git","clone_url":"https://github.com/sarutak/spark.git","svn_url":"https://github.com/sarutak/spark","homepage":null,"size":467531,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"450b415028c3b00f3a002126cd11318d3932e28f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32891"},"html":{"href":"https://github.com/apache/spark/pull/32891"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32891"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32891/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32891/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32891/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/89a36e9ef69a83e234958717b8b9827ddf011a0e"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32890","id":668738361,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY4NzM4MzYx","html_url":"https://github.com/apache/spark/pull/32890","diff_url":"https://github.com/apache/spark/pull/32890.diff","patch_url":"https://github.com/apache/spark/pull/32890.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32890","number":32890,"state":"closed","locked":false,"title":"[SPARK-35689][SS][3.0] Add log warn when keyWithIndexToValue returns null value","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nThis patch adds log warn when `keyWithIndexToValue` returns null value in `SymmetricHashJoinStateManager`.\r\n\r\nThis is the backport of #32828 to branch-3.0.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nOnce we get null from state store in SymmetricHashJoinStateManager, it is better to add meaningful logging for the case. It is better for debugging.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\n\r\nExisting tests.\r\n","created_at":"2021-06-12T03:45:22Z","updated_at":"2021-06-12T16:52:18Z","closed_at":"2021-06-12T16:52:16Z","merged_at":null,"merge_commit_sha":"ade290497ac599294b6b768d2e1ac38c038c7dd0","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32890/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32890/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32890/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/dbbe568f9cdd5601177e3cf1b55a4f9fcd2faa42","head":{"label":"viirya:fix-ss-joinstatemanager-followup-3.0","ref":"fix-ss-joinstatemanager-followup-3.0","sha":"dbbe568f9cdd5601177e3cf1b55a4f9fcd2faa42","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:branch-3.0","ref":"branch-3.0","sha":"763e5126a8efff559c86d5b61a4f340c493c3dcb","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32890"},"html":{"href":"https://github.com/apache/spark/pull/32890"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32890"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32890/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32890/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32890/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/dbbe568f9cdd5601177e3cf1b55a4f9fcd2faa42"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32889","id":668733276,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY4NzMzMjc2","html_url":"https://github.com/apache/spark/pull/32889","diff_url":"https://github.com/apache/spark/pull/32889.diff","patch_url":"https://github.com/apache/spark/pull/32889.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32889","number":32889,"state":"closed","locked":false,"title":"[MINOR][K8S] Print the driver pod name instead of Some(name) if absent","user":{"login":"yaooqinn","id":8326978,"node_id":"MDQ6VXNlcjgzMjY5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/8326978?v=4","gravatar_id":"","url":"https://api.github.com/users/yaooqinn","html_url":"https://github.com/yaooqinn","followers_url":"https://api.github.com/users/yaooqinn/followers","following_url":"https://api.github.com/users/yaooqinn/following{/other_user}","gists_url":"https://api.github.com/users/yaooqinn/gists{/gist_id}","starred_url":"https://api.github.com/users/yaooqinn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yaooqinn/subscriptions","organizations_url":"https://api.github.com/users/yaooqinn/orgs","repos_url":"https://api.github.com/users/yaooqinn/repos","events_url":"https://api.github.com/users/yaooqinn/events{/privacy}","received_events_url":"https://api.github.com/users/yaooqinn/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\nPrint the driver pod name instead of Some(name) if absent\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nfix error hint\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nno\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nnew test","created_at":"2021-06-12T03:31:15Z","updated_at":"2024-10-25T05:21:56Z","closed_at":"2021-06-13T16:11:23Z","merged_at":null,"merge_commit_sha":"199cb2579fb2bf87ec36c8088822a42c6c524109","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406605057,"node_id":"MDU6TGFiZWwxNDA2NjA1MDU3","url":"https://api.github.com/repos/apache/spark/labels/KUBERNETES","name":"KUBERNETES","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32889/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32889/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32889/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0f23311bbf5681b612f19c47fc488b53f0d04ace","head":{"label":"yaooqinn:minork8s","ref":"minork8s","sha":"0f23311bbf5681b612f19c47fc488b53f0d04ace","user":{"login":"yaooqinn","id":8326978,"node_id":"MDQ6VXNlcjgzMjY5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/8326978?v=4","gravatar_id":"","url":"https://api.github.com/users/yaooqinn","html_url":"https://github.com/yaooqinn","followers_url":"https://api.github.com/users/yaooqinn/followers","following_url":"https://api.github.com/users/yaooqinn/following{/other_user}","gists_url":"https://api.github.com/users/yaooqinn/gists{/gist_id}","starred_url":"https://api.github.com/users/yaooqinn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yaooqinn/subscriptions","organizations_url":"https://api.github.com/users/yaooqinn/orgs","repos_url":"https://api.github.com/users/yaooqinn/repos","events_url":"https://api.github.com/users/yaooqinn/events{/privacy}","received_events_url":"https://api.github.com/users/yaooqinn/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":357976080,"node_id":"MDEwOlJlcG9zaXRvcnkzNTc5NzYwODA=","name":"spark","full_name":"yaooqinn/spark","private":false,"owner":{"login":"yaooqinn","id":8326978,"node_id":"MDQ6VXNlcjgzMjY5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/8326978?v=4","gravatar_id":"","url":"https://api.github.com/users/yaooqinn","html_url":"https://github.com/yaooqinn","followers_url":"https://api.github.com/users/yaooqinn/followers","following_url":"https://api.github.com/users/yaooqinn/following{/other_user}","gists_url":"https://api.github.com/users/yaooqinn/gists{/gist_id}","starred_url":"https://api.github.com/users/yaooqinn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yaooqinn/subscriptions","organizations_url":"https://api.github.com/users/yaooqinn/orgs","repos_url":"https://api.github.com/users/yaooqinn/repos","events_url":"https://api.github.com/users/yaooqinn/events{/privacy}","received_events_url":"https://api.github.com/users/yaooqinn/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yaooqinn/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/yaooqinn/spark","forks_url":"https://api.github.com/repos/yaooqinn/spark/forks","keys_url":"https://api.github.com/repos/yaooqinn/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yaooqinn/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yaooqinn/spark/teams","hooks_url":"https://api.github.com/repos/yaooqinn/spark/hooks","issue_events_url":"https://api.github.com/repos/yaooqinn/spark/issues/events{/number}","events_url":"https://api.github.com/repos/yaooqinn/spark/events","assignees_url":"https://api.github.com/repos/yaooqinn/spark/assignees{/user}","branches_url":"https://api.github.com/repos/yaooqinn/spark/branches{/branch}","tags_url":"https://api.github.com/repos/yaooqinn/spark/tags","blobs_url":"https://api.github.com/repos/yaooqinn/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yaooqinn/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yaooqinn/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/yaooqinn/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yaooqinn/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/yaooqinn/spark/languages","stargazers_url":"https://api.github.com/repos/yaooqinn/spark/stargazers","contributors_url":"https://api.github.com/repos/yaooqinn/spark/contributors","subscribers_url":"https://api.github.com/repos/yaooqinn/spark/subscribers","subscription_url":"https://api.github.com/repos/yaooqinn/spark/subscription","commits_url":"https://api.github.com/repos/yaooqinn/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/yaooqinn/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/yaooqinn/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/yaooqinn/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/yaooqinn/spark/contents/{+path}","compare_url":"https://api.github.com/repos/yaooqinn/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yaooqinn/spark/merges","archive_url":"https://api.github.com/repos/yaooqinn/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yaooqinn/spark/downloads","issues_url":"https://api.github.com/repos/yaooqinn/spark/issues{/number}","pulls_url":"https://api.github.com/repos/yaooqinn/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/yaooqinn/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/yaooqinn/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yaooqinn/spark/labels{/name}","releases_url":"https://api.github.com/repos/yaooqinn/spark/releases{/id}","deployments_url":"https://api.github.com/repos/yaooqinn/spark/deployments","created_at":"2021-04-14T16:44:36Z","updated_at":"2024-11-05T08:03:33Z","pushed_at":"2025-01-24T02:12:30Z","git_url":"git://github.com/yaooqinn/spark.git","ssh_url":"git@github.com:yaooqinn/spark.git","clone_url":"https://github.com/yaooqinn/spark.git","svn_url":"https://github.com/yaooqinn/spark","homepage":"https://spark.apache.org/","size":468287,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"9c7250fa736b29714a30ec515ceb48fd14e33e24","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32889"},"html":{"href":"https://github.com/apache/spark/pull/32889"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32889"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32889/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32889/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32889/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0f23311bbf5681b612f19c47fc488b53f0d04ace"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32888","id":668690005,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY4NjkwMDA1","html_url":"https://github.com/apache/spark/pull/32888","diff_url":"https://github.com/apache/spark/pull/32888.diff","patch_url":"https://github.com/apache/spark/pull/32888.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32888","number":32888,"state":"closed","locked":false,"title":"[SPARK-35746][UI] Fix taskid in the stage page task event timeline","user":{"login":"shahidki31","id":23054875,"node_id":"MDQ6VXNlcjIzMDU0ODc1","avatar_url":"https://avatars.githubusercontent.com/u/23054875?v=4","gravatar_id":"","url":"https://api.github.com/users/shahidki31","html_url":"https://github.com/shahidki31","followers_url":"https://api.github.com/users/shahidki31/followers","following_url":"https://api.github.com/users/shahidki31/following{/other_user}","gists_url":"https://api.github.com/users/shahidki31/gists{/gist_id}","starred_url":"https://api.github.com/users/shahidki31/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shahidki31/subscriptions","organizations_url":"https://api.github.com/users/shahidki31/orgs","repos_url":"https://api.github.com/users/shahidki31/repos","events_url":"https://api.github.com/users/shahidki31/events{/privacy}","received_events_url":"https://api.github.com/users/shahidki31/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nTask id is given incorrect in the timeline plot in Stage Page\r\n\r\n\r\n### Why are the changes needed?\r\nMap event timeline plots to correct task\r\n**Before:**\r\n![image](https://user-images.githubusercontent.com/23054875/121761077-81775800-cb4b-11eb-8ec6-ee71926a6549.png)\r\n\r\n**After**\r\n![image](https://user-images.githubusercontent.com/23054875/121761195-02ceea80-cb4c-11eb-8ce6-07bb1cca190e.png)\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nManually tested","created_at":"2021-06-12T01:29:09Z","updated_at":"2022-01-10T10:00:01Z","closed_at":"2021-06-12T06:38:57Z","merged_at":null,"merge_commit_sha":"39e5f780d32fdf7f39275c2a3db3f590d42241c3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406605079,"node_id":"MDU6TGFiZWwxNDA2NjA1MDc5","url":"https://api.github.com/repos/apache/spark/labels/WEB%20UI","name":"WEB UI","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32888/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32888/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32888/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1c39d4469b66103e52f2d4ee68699b45f4de9572","head":{"label":"shahidki31:shahid/fixtaskid","ref":"shahid/fixtaskid","sha":"1c39d4469b66103e52f2d4ee68699b45f4de9572","user":{"login":"shahidki31","id":23054875,"node_id":"MDQ6VXNlcjIzMDU0ODc1","avatar_url":"https://avatars.githubusercontent.com/u/23054875?v=4","gravatar_id":"","url":"https://api.github.com/users/shahidki31","html_url":"https://github.com/shahidki31","followers_url":"https://api.github.com/users/shahidki31/followers","following_url":"https://api.github.com/users/shahidki31/following{/other_user}","gists_url":"https://api.github.com/users/shahidki31/gists{/gist_id}","starred_url":"https://api.github.com/users/shahidki31/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shahidki31/subscriptions","organizations_url":"https://api.github.com/users/shahidki31/orgs","repos_url":"https://api.github.com/users/shahidki31/repos","events_url":"https://api.github.com/users/shahidki31/events{/privacy}","received_events_url":"https://api.github.com/users/shahidki31/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104183844,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQxODM4NDQ=","name":"spark","full_name":"shahidki31/spark","private":false,"owner":{"login":"shahidki31","id":23054875,"node_id":"MDQ6VXNlcjIzMDU0ODc1","avatar_url":"https://avatars.githubusercontent.com/u/23054875?v=4","gravatar_id":"","url":"https://api.github.com/users/shahidki31","html_url":"https://github.com/shahidki31","followers_url":"https://api.github.com/users/shahidki31/followers","following_url":"https://api.github.com/users/shahidki31/following{/other_user}","gists_url":"https://api.github.com/users/shahidki31/gists{/gist_id}","starred_url":"https://api.github.com/users/shahidki31/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shahidki31/subscriptions","organizations_url":"https://api.github.com/users/shahidki31/orgs","repos_url":"https://api.github.com/users/shahidki31/repos","events_url":"https://api.github.com/users/shahidki31/events{/privacy}","received_events_url":"https://api.github.com/users/shahidki31/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/shahidki31/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/shahidki31/spark","forks_url":"https://api.github.com/repos/shahidki31/spark/forks","keys_url":"https://api.github.com/repos/shahidki31/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/shahidki31/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/shahidki31/spark/teams","hooks_url":"https://api.github.com/repos/shahidki31/spark/hooks","issue_events_url":"https://api.github.com/repos/shahidki31/spark/issues/events{/number}","events_url":"https://api.github.com/repos/shahidki31/spark/events","assignees_url":"https://api.github.com/repos/shahidki31/spark/assignees{/user}","branches_url":"https://api.github.com/repos/shahidki31/spark/branches{/branch}","tags_url":"https://api.github.com/repos/shahidki31/spark/tags","blobs_url":"https://api.github.com/repos/shahidki31/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/shahidki31/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/shahidki31/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/shahidki31/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/shahidki31/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/shahidki31/spark/languages","stargazers_url":"https://api.github.com/repos/shahidki31/spark/stargazers","contributors_url":"https://api.github.com/repos/shahidki31/spark/contributors","subscribers_url":"https://api.github.com/repos/shahidki31/spark/subscribers","subscription_url":"https://api.github.com/repos/shahidki31/spark/subscription","commits_url":"https://api.github.com/repos/shahidki31/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/shahidki31/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/shahidki31/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/shahidki31/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/shahidki31/spark/contents/{+path}","compare_url":"https://api.github.com/repos/shahidki31/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/shahidki31/spark/merges","archive_url":"https://api.github.com/repos/shahidki31/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/shahidki31/spark/downloads","issues_url":"https://api.github.com/repos/shahidki31/spark/issues{/number}","pulls_url":"https://api.github.com/repos/shahidki31/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/shahidki31/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/shahidki31/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/shahidki31/spark/labels{/name}","releases_url":"https://api.github.com/repos/shahidki31/spark/releases{/id}","deployments_url":"https://api.github.com/repos/shahidki31/spark/deployments","created_at":"2017-09-20T07:51:04Z","updated_at":"2021-05-12T06:24:13Z","pushed_at":"2021-06-12T09:58:15Z","git_url":"git://github.com/shahidki31/spark.git","ssh_url":"git@github.com:shahidki31/spark.git","clone_url":"https://github.com/shahidki31/spark.git","svn_url":"https://github.com/shahidki31/spark","homepage":null,"size":361578,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"703376e8a98b07326cef196962628d806cfdd9cf","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32888"},"html":{"href":"https://github.com/apache/spark/pull/32888"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32888"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32888/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32888/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32888/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1c39d4469b66103e52f2d4ee68699b45f4de9572"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32887","id":668562929,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY4NTYyOTI5","html_url":"https://github.com/apache/spark/pull/32887","diff_url":"https://github.com/apache/spark/pull/32887.diff","patch_url":"https://github.com/apache/spark/pull/32887.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32887","number":32887,"state":"closed","locked":false,"title":"[SPARK-35321][SQL] Don't register Hive permanent functions when creating Hive client","user":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nInstantiate a new Hive client through `Hive.getWithoutRegisterFns(conf, false)` instead of `Hive.get(conf)`, if `Hive` version is >= '2.3.9' (the built-in version).\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n[HIVE-10319](https://issues.apache.org/jira/browse/HIVE-10319) introduced a new API `get_all_functions` which is only supported in Hive 1.3.0/2.0.0 and up. As result, when Spark 3.x talks to a HMS service of version 1.2 or lower, the following error will occur:\r\n```\r\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: org.apache.thrift.TApplicationException: Invalid method name: 'get_all_functions'\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3897)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        ... 96 more\r\nCaused by: org.apache.thrift.TApplicationException: Invalid method name: 'get_all_functions'\r\n        at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:79)\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_get_all_functions(ThriftHiveMetastore.java:3845)\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.get_all_functions(ThriftHiveMetastore.java:3833)\r\n```\r\n\r\nThe `get_all_functions` is called only when `doRegisterAllFns` is set to true:\r\n```java\r\n  private Hive(HiveConf c, boolean doRegisterAllFns) throws HiveException {\r\n    conf = c;\r\n    if (doRegisterAllFns) {\r\n      registerAllFunctionsOnce();\r\n    }\r\n  }\r\n```\r\n\r\nwhat this does is to register all Hive permanent functions defined in HMS in Hive's `FunctionRegistry` class, via iterating through results from `get_all_functions`. To Spark, this seems unnecessary as it loads Hive permanent (not built-in) UDF via directly calling the HMS API, i.e., `get_function`. The `FunctionRegistry` is only used in loading Hive's built-in function that is not supported by Spark. At this time, it only applies to `histogram_numeric`.\r\n\r\n[HIVE-21563](https://issues.apache.org/jira/browse/HIVE-21563) introduced a new API `getWithoutRegisterFns` which skips the above registration and is available in Hive 2.3.9. Therefore, Spark should adopt it to avoid the cost.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nYes with this fix Spark now should be able to talk to HMS server with Hive 1.2.x and lower.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\n\r\nManually started a HMS server of Hive version 1.2.2. Without the PR it failed with the above exception. With the PR the error disappeared and I can successfully perform common operations such as create table, create database, list tables, etc.","created_at":"2021-06-11T21:08:30Z","updated_at":"2021-06-12T02:33:50Z","closed_at":"2021-06-12T02:32:46Z","merged_at":null,"merge_commit_sha":"9e8196febe88792656d2b1c5bcc387d444932c39","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32887/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32887/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32887/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/79bbc2c89a55e829114850cc879996cbcf82a7ab","head":{"label":"sunchao:SPARK-35321-new","ref":"SPARK-35321-new","sha":"79bbc2c89a55e829114850cc879996cbcf82a7ab","user":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":29795757,"node_id":"MDEwOlJlcG9zaXRvcnkyOTc5NTc1Nw==","name":"spark","full_name":"sunchao/spark","private":false,"owner":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sunchao/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sunchao/spark","forks_url":"https://api.github.com/repos/sunchao/spark/forks","keys_url":"https://api.github.com/repos/sunchao/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sunchao/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sunchao/spark/teams","hooks_url":"https://api.github.com/repos/sunchao/spark/hooks","issue_events_url":"https://api.github.com/repos/sunchao/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sunchao/spark/events","assignees_url":"https://api.github.com/repos/sunchao/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sunchao/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sunchao/spark/tags","blobs_url":"https://api.github.com/repos/sunchao/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sunchao/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sunchao/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sunchao/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sunchao/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sunchao/spark/languages","stargazers_url":"https://api.github.com/repos/sunchao/spark/stargazers","contributors_url":"https://api.github.com/repos/sunchao/spark/contributors","subscribers_url":"https://api.github.com/repos/sunchao/spark/subscribers","subscription_url":"https://api.github.com/repos/sunchao/spark/subscription","commits_url":"https://api.github.com/repos/sunchao/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sunchao/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sunchao/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sunchao/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sunchao/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sunchao/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sunchao/spark/merges","archive_url":"https://api.github.com/repos/sunchao/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sunchao/spark/downloads","issues_url":"https://api.github.com/repos/sunchao/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sunchao/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sunchao/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sunchao/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sunchao/spark/labels{/name}","releases_url":"https://api.github.com/repos/sunchao/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sunchao/spark/deployments","created_at":"2015-01-24T23:30:38Z","updated_at":"2021-11-19T02:19:32Z","pushed_at":"2024-06-01T22:17:50Z","git_url":"git://github.com/sunchao/spark.git","ssh_url":"git@github.com:sunchao/spark.git","clone_url":"https://github.com/sunchao/spark.git","svn_url":"https://github.com/sunchao/spark","homepage":null,"size":426441,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4d21b94d13daf958edf6bbf49c4aa17f5cb012b5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32887"},"html":{"href":"https://github.com/apache/spark/pull/32887"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32887"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32887/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32887/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32887/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/79bbc2c89a55e829114850cc879996cbcf82a7ab"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32886","id":668458296,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY4NDU4Mjk2","html_url":"https://github.com/apache/spark/pull/32886","diff_url":"https://github.com/apache/spark/pull/32886.diff","patch_url":"https://github.com/apache/spark/pull/32886.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32886","number":32886,"state":"closed","locked":false,"title":"[SPARK-35478][PYTHON] Enable disallow_untyped_defs mypy check for pyspark.pandas.window.","user":{"login":"pingsutw","id":37936015,"node_id":"MDQ6VXNlcjM3OTM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/37936015?v=4","gravatar_id":"","url":"https://api.github.com/users/pingsutw","html_url":"https://github.com/pingsutw","followers_url":"https://api.github.com/users/pingsutw/followers","following_url":"https://api.github.com/users/pingsutw/following{/other_user}","gists_url":"https://api.github.com/users/pingsutw/gists{/gist_id}","starred_url":"https://api.github.com/users/pingsutw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pingsutw/subscriptions","organizations_url":"https://api.github.com/users/pingsutw/orgs","repos_url":"https://api.github.com/users/pingsutw/repos","events_url":"https://api.github.com/users/pingsutw/events{/privacy}","received_events_url":"https://api.github.com/users/pingsutw/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nAdds more type annotations in the file `python/pyspark/pandas/window.py` and fixes the mypy check failures.\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nWe should enable more disallow_untyped_defs mypy checks.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nYes.\r\nThis PR adds more type annotations in pandas APIs on the Spark module, which can impact interaction with development tools for users.\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nThe mypy check with a new configuration and existing tests should pass.\r\n","created_at":"2021-06-11T18:54:46Z","updated_at":"2021-06-18T23:42:08Z","closed_at":"2021-06-18T18:21:43Z","merged_at":null,"merge_commit_sha":"366bdc8d2ea21a82afb6b0df928441f483753946","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32886/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32886/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32886/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/be0df237b08811fb4ef3bdd5dc7f12e91e9cdbe6","head":{"label":"pingsutw:SPARK-35478","ref":"SPARK-35478","sha":"be0df237b08811fb4ef3bdd5dc7f12e91e9cdbe6","user":{"login":"pingsutw","id":37936015,"node_id":"MDQ6VXNlcjM3OTM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/37936015?v=4","gravatar_id":"","url":"https://api.github.com/users/pingsutw","html_url":"https://github.com/pingsutw","followers_url":"https://api.github.com/users/pingsutw/followers","following_url":"https://api.github.com/users/pingsutw/following{/other_user}","gists_url":"https://api.github.com/users/pingsutw/gists{/gist_id}","starred_url":"https://api.github.com/users/pingsutw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pingsutw/subscriptions","organizations_url":"https://api.github.com/users/pingsutw/orgs","repos_url":"https://api.github.com/users/pingsutw/repos","events_url":"https://api.github.com/users/pingsutw/events{/privacy}","received_events_url":"https://api.github.com/users/pingsutw/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":273827179,"node_id":"MDEwOlJlcG9zaXRvcnkyNzM4MjcxNzk=","name":"spark","full_name":"pingsutw/spark","private":false,"owner":{"login":"pingsutw","id":37936015,"node_id":"MDQ6VXNlcjM3OTM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/37936015?v=4","gravatar_id":"","url":"https://api.github.com/users/pingsutw","html_url":"https://github.com/pingsutw","followers_url":"https://api.github.com/users/pingsutw/followers","following_url":"https://api.github.com/users/pingsutw/following{/other_user}","gists_url":"https://api.github.com/users/pingsutw/gists{/gist_id}","starred_url":"https://api.github.com/users/pingsutw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pingsutw/subscriptions","organizations_url":"https://api.github.com/users/pingsutw/orgs","repos_url":"https://api.github.com/users/pingsutw/repos","events_url":"https://api.github.com/users/pingsutw/events{/privacy}","received_events_url":"https://api.github.com/users/pingsutw/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pingsutw/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/pingsutw/spark","forks_url":"https://api.github.com/repos/pingsutw/spark/forks","keys_url":"https://api.github.com/repos/pingsutw/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pingsutw/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pingsutw/spark/teams","hooks_url":"https://api.github.com/repos/pingsutw/spark/hooks","issue_events_url":"https://api.github.com/repos/pingsutw/spark/issues/events{/number}","events_url":"https://api.github.com/repos/pingsutw/spark/events","assignees_url":"https://api.github.com/repos/pingsutw/spark/assignees{/user}","branches_url":"https://api.github.com/repos/pingsutw/spark/branches{/branch}","tags_url":"https://api.github.com/repos/pingsutw/spark/tags","blobs_url":"https://api.github.com/repos/pingsutw/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pingsutw/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pingsutw/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/pingsutw/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pingsutw/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/pingsutw/spark/languages","stargazers_url":"https://api.github.com/repos/pingsutw/spark/stargazers","contributors_url":"https://api.github.com/repos/pingsutw/spark/contributors","subscribers_url":"https://api.github.com/repos/pingsutw/spark/subscribers","subscription_url":"https://api.github.com/repos/pingsutw/spark/subscription","commits_url":"https://api.github.com/repos/pingsutw/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/pingsutw/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/pingsutw/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/pingsutw/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/pingsutw/spark/contents/{+path}","compare_url":"https://api.github.com/repos/pingsutw/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pingsutw/spark/merges","archive_url":"https://api.github.com/repos/pingsutw/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pingsutw/spark/downloads","issues_url":"https://api.github.com/repos/pingsutw/spark/issues{/number}","pulls_url":"https://api.github.com/repos/pingsutw/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/pingsutw/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/pingsutw/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pingsutw/spark/labels{/name}","releases_url":"https://api.github.com/repos/pingsutw/spark/releases{/id}","deployments_url":"https://api.github.com/repos/pingsutw/spark/deployments","created_at":"2020-06-21T03:29:25Z","updated_at":"2021-07-04T16:32:57Z","pushed_at":"2021-09-14T11:39:26Z","git_url":"git://github.com/pingsutw/spark.git","ssh_url":"git@github.com:pingsutw/spark.git","clone_url":"https://github.com/pingsutw/spark.git","svn_url":"https://github.com/pingsutw/spark","homepage":"https://spark.apache.org/","size":381328,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4d21b94d13daf958edf6bbf49c4aa17f5cb012b5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32886"},"html":{"href":"https://github.com/apache/spark/pull/32886"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32886"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32886/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32886/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32886/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/be0df237b08811fb4ef3bdd5dc7f12e91e9cdbe6"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32885","id":668357791,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY4MzU3Nzkx","html_url":"https://github.com/apache/spark/pull/32885","diff_url":"https://github.com/apache/spark/pull/32885.diff","patch_url":"https://github.com/apache/spark/pull/32885.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32885","number":32885,"state":"closed","locked":false,"title":"[SPARK-35742][SQL] Expression.semanticEquals should be symmetrical","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nCurrently, there are some expressions that overwrite `semanticEquals`, which makes it not symmetrical. Ideally, expressions should overwrite `canonicalized` instead of `semanticEquals`.\r\n\r\nThis PR marks `semanticEquals` as final, and implement `canonicalized` for the few expressions that overwrote `semanticEquals` before.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo avoid subtle bugs (I haven't found a real bug yet).\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nno\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\na new test","created_at":"2021-06-11T17:01:00Z","updated_at":"2021-06-17T11:59:49Z","closed_at":"2021-06-15T08:53:12Z","merged_at":null,"merge_commit_sha":"152e03baee40e570f96781a1b0ea327140c04b07","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32885/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32885/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32885/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5095fffcd0cd76548eadef802cdb81261029ff12","head":{"label":"cloud-fan:attr","ref":"attr","sha":"5095fffcd0cd76548eadef802cdb81261029ff12","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"82af318c315d20541bd5f0f714cf746ca295b724","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32885"},"html":{"href":"https://github.com/apache/spark/pull/32885"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32885"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32885/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32885/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32885/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5095fffcd0cd76548eadef802cdb81261029ff12"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32884","id":668111606,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY4MTExNjA2","html_url":"https://github.com/apache/spark/pull/32884","diff_url":"https://github.com/apache/spark/pull/32884.diff","patch_url":"https://github.com/apache/spark/pull/32884.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32884","number":32884,"state":"closed","locked":false,"title":"[SPARK-35738][PYTHON] Support 'y' properly in DataFrame with non-numeric columns with plots","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to port the fix https://github.com/databricks/koalas/pull/2172.\r\n\r\n```python\r\nks.DataFrame({'a': [1, 2, 3], 'b':[\"a\", \"b\", \"c\"], 'c': [4, 5, 6]}).plot(kind='hist', x='a', y='c', bins=200)\r\n```\r\n\r\n**Before:**\r\n\r\n```\r\npyspark.sql.utils.AnalysisException: cannot resolve 'least(min(a), min(b), min(c))' due to data type mismatch: The expressions should all have the same type, got LEAST(bigint, string, bigint).;\r\n'Aggregate [unresolvedalias(least(min(a#1L), min(b#2), min(c#3L)), Some(org.apache.spark.sql.Column$$Lambda$1556/0x0000000800d94840@42fb0cc1)), unresolvedalias(greatest(max(a#1L), max(b#2), max(c#3L)), Some(org.apache.spark.sql.Column$$Lambda$1556/0x0000000800d94840@42fb0cc1))]\r\n+- Project [a#1L, b#2, c#3L]\r\n   +- Project [__index_level_0__#0L, a#1L, b#2, c#3L, monotonically_increasing_id() AS __natural_order__#8L]\r\n      +- LogicalRDD [__index_level_0__#0L, a#1L, b#2, c#3L], false\r\n```\r\n\r\n**After:**\r\n\r\n```python\r\nFigure({\r\n    'data': [{'hovertemplate': 'variable=a<br>value=%{text}<br>count=%{y}',\r\n              'name': 'a',\r\n...\r\n```\r\n\r\n### Why are the changes needed?\r\n\r\nTo match the behaviour with panadas' and allow users to set `x` and `y` in the DataFrame with non-numeric columns.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo to end users since the changes is not released yet. Yes to dev as described before.\r\n\r\n### How was this patch tested?\r\n\r\nManually tested, added a test and tested in notebooks:\r\n\r\n\r\n![Screen Shot 2021-06-11 at 9 11 25 PM](https://user-images.githubusercontent.com/6477701/121686038-a47a1b80-cafb-11eb-8f8e-8d968db7ebef.png)\r\n\r\n![Screen Shot 2021-06-11 at 9 48 58 PM](https://user-images.githubusercontent.com/6477701/121688858-e22c7380-cafe-11eb-9d0a-adcbe560030f.png)","created_at":"2021-06-11T12:49:59Z","updated_at":"2022-01-04T00:53:40Z","closed_at":"2021-06-12T05:36:57Z","merged_at":null,"merge_commit_sha":"db80a4b1b0deb17e02b6d088cc4a6e6327a27eb6","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32884/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32884/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32884/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/de8401786135b88676aa46dea14d06cf28baf5b8","head":{"label":"HyukjinKwon:fix-hist-plot","ref":"fix-hist-plot","sha":"de8401786135b88676aa46dea14d06cf28baf5b8","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"6e1aa15679b5fed249c62b2340151a0299401b18","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32884"},"html":{"href":"https://github.com/apache/spark/pull/32884"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32884"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32884/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32884/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32884/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/de8401786135b88676aa46dea14d06cf28baf5b8"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32883","id":667913537,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3OTEzNTM3","html_url":"https://github.com/apache/spark/pull/32883","diff_url":"https://github.com/apache/spark/pull/32883.diff","patch_url":"https://github.com/apache/spark/pull/32883.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32883","number":32883,"state":"closed","locked":false,"title":"[SPARK-35725][SQL] Support optimize skewed partitions in RebalancePartitions","user":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n* Add a new rule `OptimizeSkewInRebalancePartitions` in AQE `queryStageOptimizerRules`\r\n* Add a new config `spark.sql.adaptive.optimizeSkewsInRebalancePartitions.enabled` to decide if should enable the new rule\r\n\r\nThe new rule `OptimizeSkewInRebalancePartitions` only handle two shuffle origin `REBALANCE_PARTITIONS_BY_NONE` and `REBALANCE_PARTITIONS_BY_COL` for data skew issue. And re-use the exists config `ADVISORY_PARTITION_SIZE_IN_BYTES` to decide what partition size should be.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCurrently, we don't support expand partition dynamically in AQE which is not friendly for some data skew job.\r\n\r\nLet's say if we have a simple query:\r\n```\r\nSELECT /*+ REBALANCE(col) */ * FROM table\r\n```\r\n\r\nThe column of `col` is skewed, then some shuffle partitions would handle too much data than others.\r\n\r\nIf we haven't inroduced extra shuffle, we can optimize this case by expanding partitions in AQE.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nYes, a new config\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nAdd test","created_at":"2021-06-11T09:20:32Z","updated_at":"2022-02-23T04:15:38Z","closed_at":"2021-06-30T18:05:02Z","merged_at":null,"merge_commit_sha":"82afe4087eb161579214d861f6f2da2318d19435","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32883/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32883/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32883/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8e706ae5f289ce9d4f6a7ca624f1d58516a8a177","head":{"label":"ulysses-you:expand-partition","ref":"expand-partition","sha":"8e706ae5f289ce9d4f6a7ca624f1d58516a8a177","user":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":195747855,"node_id":"MDEwOlJlcG9zaXRvcnkxOTU3NDc4NTU=","name":"spark","full_name":"ulysses-you/spark","private":false,"owner":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ulysses-you/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/ulysses-you/spark","forks_url":"https://api.github.com/repos/ulysses-you/spark/forks","keys_url":"https://api.github.com/repos/ulysses-you/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ulysses-you/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ulysses-you/spark/teams","hooks_url":"https://api.github.com/repos/ulysses-you/spark/hooks","issue_events_url":"https://api.github.com/repos/ulysses-you/spark/issues/events{/number}","events_url":"https://api.github.com/repos/ulysses-you/spark/events","assignees_url":"https://api.github.com/repos/ulysses-you/spark/assignees{/user}","branches_url":"https://api.github.com/repos/ulysses-you/spark/branches{/branch}","tags_url":"https://api.github.com/repos/ulysses-you/spark/tags","blobs_url":"https://api.github.com/repos/ulysses-you/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ulysses-you/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ulysses-you/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ulysses-you/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ulysses-you/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ulysses-you/spark/languages","stargazers_url":"https://api.github.com/repos/ulysses-you/spark/stargazers","contributors_url":"https://api.github.com/repos/ulysses-you/spark/contributors","subscribers_url":"https://api.github.com/repos/ulysses-you/spark/subscribers","subscription_url":"https://api.github.com/repos/ulysses-you/spark/subscription","commits_url":"https://api.github.com/repos/ulysses-you/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ulysses-you/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ulysses-you/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ulysses-you/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ulysses-you/spark/contents/{+path}","compare_url":"https://api.github.com/repos/ulysses-you/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ulysses-you/spark/merges","archive_url":"https://api.github.com/repos/ulysses-you/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ulysses-you/spark/downloads","issues_url":"https://api.github.com/repos/ulysses-you/spark/issues{/number}","pulls_url":"https://api.github.com/repos/ulysses-you/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ulysses-you/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ulysses-you/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ulysses-you/spark/labels{/name}","releases_url":"https://api.github.com/repos/ulysses-you/spark/releases{/id}","deployments_url":"https://api.github.com/repos/ulysses-you/spark/deployments","created_at":"2019-07-08T06:11:57Z","updated_at":"2022-01-10T01:34:59Z","pushed_at":"2024-08-13T23:12:37Z","git_url":"git://github.com/ulysses-you/spark.git","ssh_url":"git@github.com:ulysses-you/spark.git","clone_url":"https://github.com/ulysses-you/spark.git","svn_url":"https://github.com/ulysses-you/spark","homepage":"","size":399300,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"28a201a442812a1d4b35887ef0e89e4e470ae969","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32883"},"html":{"href":"https://github.com/apache/spark/pull/32883"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32883"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32883/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32883/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32883/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8e706ae5f289ce9d4f6a7ca624f1d58516a8a177"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32882","id":667884542,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3ODg0NTQy","html_url":"https://github.com/apache/spark/pull/32882","diff_url":"https://github.com/apache/spark/pull/32882.diff","patch_url":"https://github.com/apache/spark/pull/32882.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32882","number":32882,"state":"closed","locked":false,"title":"[WIP][SPARK-35724][SQL] Support traversal pruning in extendedResolutionRules and postHocResolutionRules","user":{"login":"sigmod","id":384788,"node_id":"MDQ6VXNlcjM4NDc4OA==","avatar_url":"https://avatars.githubusercontent.com/u/384788?v=4","gravatar_id":"","url":"https://api.github.com/users/sigmod","html_url":"https://github.com/sigmod","followers_url":"https://api.github.com/users/sigmod/followers","following_url":"https://api.github.com/users/sigmod/following{/other_user}","gists_url":"https://api.github.com/users/sigmod/gists{/gist_id}","starred_url":"https://api.github.com/users/sigmod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sigmod/subscriptions","organizations_url":"https://api.github.com/users/sigmod/orgs","repos_url":"https://api.github.com/users/sigmod/repos","events_url":"https://api.github.com/users/sigmod/events{/privacy}","received_events_url":"https://api.github.com/users/sigmod/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests.\r\nPerformance diff (org.apache.spark.sql.TPCDSQuerySuite):\r\n<google-sheets-html-origin><style type=\"text/css\"><!--td {border: 1px solid #ccc;}br {mso-data-placement:same-cell;}--></style>\r\n&nbsp; | Baseline | Experiment | Experiment/Baseline\r\n-- | -- | -- | --\r\norg.apache.spark.sql.execution.aggregate.ResolveEncodersInScalaAgg | 61864479 | 2072405 | 0.03\r\norg.apache.spark.sql.execution.datasources.DataSourceAnalysis | 4186305 | 3876249 | 0.93\r\norg.apache.spark.sql.execution.datasources.FallBackFileSourceV2 | 7665256 | 3190492 | 0.42\r\norg.apache.spark.sql.execution.datasources.FindDataSourceTable | 145262307 | 139461170 | 0.96\r\norg.apache.spark.sql.execution.datasources.PreprocessTableInsertion | 2248277 | 1424614 | 0.63\r\norg.apache.spark.sql.execution.datasources.ResolveSQLOnFile | 8633729 | 8849599 | 1.03\r\norg.apache.spark.sql.execution.datasources.SchemaPruning | 200094008 | 5550433 | 0.03\r\norg.apache.spark.sql.execution.dynamicpruning.PartitionPruning | 70860220 | 66498442 | 0.94\r\norg.apache.spark.sql.execution.OptimizeMetadataOnlyQuery | 1489644 | 1632468 | 1.10\r\norg.apache.spark.sql.execution.streaming.ResolveWriteToStream | 9494697 | 3030265 | 0.32\r\n\r\n</google-sheets-html-origin>\r\n","created_at":"2021-06-11T08:51:58Z","updated_at":"2023-07-28T14:25:43Z","closed_at":"2021-09-15T16:57:25Z","merged_at":null,"merge_commit_sha":"b51d26287d05f74e8c572840d2e5440f3a6646e4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32882/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32882/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32882/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f7f71bad3e31e96b3d098c9eb7415e6d12307642","head":{"label":"sigmod:extended","ref":"extended","sha":"f7f71bad3e31e96b3d098c9eb7415e6d12307642","user":{"login":"sigmod","id":384788,"node_id":"MDQ6VXNlcjM4NDc4OA==","avatar_url":"https://avatars.githubusercontent.com/u/384788?v=4","gravatar_id":"","url":"https://api.github.com/users/sigmod","html_url":"https://github.com/sigmod","followers_url":"https://api.github.com/users/sigmod/followers","following_url":"https://api.github.com/users/sigmod/following{/other_user}","gists_url":"https://api.github.com/users/sigmod/gists{/gist_id}","starred_url":"https://api.github.com/users/sigmod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sigmod/subscriptions","organizations_url":"https://api.github.com/users/sigmod/orgs","repos_url":"https://api.github.com/users/sigmod/repos","events_url":"https://api.github.com/users/sigmod/events{/privacy}","received_events_url":"https://api.github.com/users/sigmod/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":355067050,"node_id":"MDEwOlJlcG9zaXRvcnkzNTUwNjcwNTA=","name":"spark","full_name":"sigmod/spark","private":false,"owner":{"login":"sigmod","id":384788,"node_id":"MDQ6VXNlcjM4NDc4OA==","avatar_url":"https://avatars.githubusercontent.com/u/384788?v=4","gravatar_id":"","url":"https://api.github.com/users/sigmod","html_url":"https://github.com/sigmod","followers_url":"https://api.github.com/users/sigmod/followers","following_url":"https://api.github.com/users/sigmod/following{/other_user}","gists_url":"https://api.github.com/users/sigmod/gists{/gist_id}","starred_url":"https://api.github.com/users/sigmod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sigmod/subscriptions","organizations_url":"https://api.github.com/users/sigmod/orgs","repos_url":"https://api.github.com/users/sigmod/repos","events_url":"https://api.github.com/users/sigmod/events{/privacy}","received_events_url":"https://api.github.com/users/sigmod/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sigmod/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/sigmod/spark","forks_url":"https://api.github.com/repos/sigmod/spark/forks","keys_url":"https://api.github.com/repos/sigmod/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sigmod/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sigmod/spark/teams","hooks_url":"https://api.github.com/repos/sigmod/spark/hooks","issue_events_url":"https://api.github.com/repos/sigmod/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sigmod/spark/events","assignees_url":"https://api.github.com/repos/sigmod/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sigmod/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sigmod/spark/tags","blobs_url":"https://api.github.com/repos/sigmod/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sigmod/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sigmod/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sigmod/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sigmod/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sigmod/spark/languages","stargazers_url":"https://api.github.com/repos/sigmod/spark/stargazers","contributors_url":"https://api.github.com/repos/sigmod/spark/contributors","subscribers_url":"https://api.github.com/repos/sigmod/spark/subscribers","subscription_url":"https://api.github.com/repos/sigmod/spark/subscription","commits_url":"https://api.github.com/repos/sigmod/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sigmod/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sigmod/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sigmod/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sigmod/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sigmod/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sigmod/spark/merges","archive_url":"https://api.github.com/repos/sigmod/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sigmod/spark/downloads","issues_url":"https://api.github.com/repos/sigmod/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sigmod/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sigmod/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sigmod/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sigmod/spark/labels{/name}","releases_url":"https://api.github.com/repos/sigmod/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sigmod/spark/deployments","created_at":"2021-04-06T05:25:56Z","updated_at":"2022-02-28T09:29:28Z","pushed_at":"2022-02-28T16:57:08Z","git_url":"git://github.com/sigmod/spark.git","ssh_url":"git@github.com:sigmod/spark.git","clone_url":"https://github.com/sigmod/spark.git","svn_url":"https://github.com/sigmod/spark","homepage":"https://spark.apache.org/","size":405636,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"aaa8a80c9d3426107de5873b4391600701121385","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32882"},"html":{"href":"https://github.com/apache/spark/pull/32882"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32882"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32882/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32882/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32882/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f7f71bad3e31e96b3d098c9eb7415e6d12307642"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32881","id":667807183,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3ODA3MTgz","html_url":"https://github.com/apache/spark/pull/32881","diff_url":"https://github.com/apache/spark/pull/32881.diff","patch_url":"https://github.com/apache/spark/pull/32881.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32881","number":32881,"state":"closed","locked":false,"title":"[SPARK-33298][CORE] Decouple file naming from FileCommitProtocol","user":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR is to propose to decouple file naming functionality from `FileCommitProtocol`. Currently `FileCommitProtocol` mainly does three things:\r\n* commit task output by renaming from stage file name to final file name\r\n* commit job output by renaming directory for dynamic partitions query or writing to custom location\r\n* specify task staging output file name, and final output file name if needed\r\n\r\nA `FileCommitProtocol` should cover first two functionalities, but not the 3rd (naming output file). The file commit protocol (by its name and design) should take care of committing output (e.g. rename file and directory), but it should not control what's the file name as well. It should leave caller the flexibility to specify file names (e.g. Hive/Presto/Trino compatible bucket file name is different from what Spark has now - https://github.com/apache/spark/pull/30003). So here the PR is to decouple the file naming from `FileCommitProtocol`.\r\n\r\nThe changes are:\r\n\r\n* Introduce an interface `FileNamingProtocol` to specify how to do output file naming. Add implementation `BatchFileNamingProtocol` for batch queries and `StreamingFileNamingProtocol` for streaming queries.\r\n* Modify existing method `newTaskTempFile` and `newTaskTempFileAbsPath` in `FileCommitProtocol` to allow commit protocol to be notified when a new task output file is added. The input is relative file name/path, and output is the full file path.\r\n* Change `FileFormatDataWriter` to call `FileNamingProtocol` to get relative file path and `FileCommitProtocol` to get full file path.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo make commit protocol clearer and allow future flexibility to specify Spark output file name.\r\nPre-requisite of https://github.com/apache/spark/pull/30003.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nExisting unit test e.g. `DataFrameReaderWriterSuite.scala` and `InsertSuite.scala`\r\nWill add more unit tests if required. This PR anyway is a code refactoring.","created_at":"2021-06-11T07:54:42Z","updated_at":"2021-07-06T20:07:32Z","closed_at":"2021-06-27T00:20:35Z","merged_at":null,"merge_commit_sha":"882c1473476c71bd199e6a56f7a13d5783e85d08","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32881/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32881/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32881/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0f3df0f45dc12768c7b9843e84e28a50b279443e","head":{"label":"c21:commit-protocol","ref":"commit-protocol","sha":"0f3df0f45dc12768c7b9843e84e28a50b279443e","user":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":159474643,"node_id":"MDEwOlJlcG9zaXRvcnkxNTk0NzQ2NDM=","name":"spark","full_name":"c21/spark","private":false,"owner":{"login":"c21","id":4629931,"node_id":"MDQ6VXNlcjQ2Mjk5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4629931?v=4","gravatar_id":"","url":"https://api.github.com/users/c21","html_url":"https://github.com/c21","followers_url":"https://api.github.com/users/c21/followers","following_url":"https://api.github.com/users/c21/following{/other_user}","gists_url":"https://api.github.com/users/c21/gists{/gist_id}","starred_url":"https://api.github.com/users/c21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c21/subscriptions","organizations_url":"https://api.github.com/users/c21/orgs","repos_url":"https://api.github.com/users/c21/repos","events_url":"https://api.github.com/users/c21/events{/privacy}","received_events_url":"https://api.github.com/users/c21/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/c21/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/c21/spark","forks_url":"https://api.github.com/repos/c21/spark/forks","keys_url":"https://api.github.com/repos/c21/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/c21/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/c21/spark/teams","hooks_url":"https://api.github.com/repos/c21/spark/hooks","issue_events_url":"https://api.github.com/repos/c21/spark/issues/events{/number}","events_url":"https://api.github.com/repos/c21/spark/events","assignees_url":"https://api.github.com/repos/c21/spark/assignees{/user}","branches_url":"https://api.github.com/repos/c21/spark/branches{/branch}","tags_url":"https://api.github.com/repos/c21/spark/tags","blobs_url":"https://api.github.com/repos/c21/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/c21/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/c21/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/c21/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/c21/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/c21/spark/languages","stargazers_url":"https://api.github.com/repos/c21/spark/stargazers","contributors_url":"https://api.github.com/repos/c21/spark/contributors","subscribers_url":"https://api.github.com/repos/c21/spark/subscribers","subscription_url":"https://api.github.com/repos/c21/spark/subscription","commits_url":"https://api.github.com/repos/c21/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/c21/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/c21/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/c21/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/c21/spark/contents/{+path}","compare_url":"https://api.github.com/repos/c21/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/c21/spark/merges","archive_url":"https://api.github.com/repos/c21/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/c21/spark/downloads","issues_url":"https://api.github.com/repos/c21/spark/issues{/number}","pulls_url":"https://api.github.com/repos/c21/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/c21/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/c21/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/c21/spark/labels{/name}","releases_url":"https://api.github.com/repos/c21/spark/releases{/id}","deployments_url":"https://api.github.com/repos/c21/spark/deployments","created_at":"2018-11-28T09:15:08Z","updated_at":"2022-01-05T00:02:56Z","pushed_at":"2022-11-14T20:23:44Z","git_url":"git://github.com/c21/spark.git","ssh_url":"git@github.com:c21/spark.git","clone_url":"https://github.com/c21/spark.git","svn_url":"https://github.com/c21/spark","homepage":null,"size":420642,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"41af409b7bcfe1b3960274c0b3085bcc1f9d1c98","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32881"},"html":{"href":"https://github.com/apache/spark/pull/32881"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32881"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32881/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32881/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32881/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0f3df0f45dc12768c7b9843e84e28a50b279443e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32880","id":667776645,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3Nzc2NjQ1","html_url":"https://github.com/apache/spark/pull/32880","diff_url":"https://github.com/apache/spark/pull/32880.diff","patch_url":"https://github.com/apache/spark/pull/32880.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32880","number":32880,"state":"closed","locked":false,"title":"[SPARK-35056][SQL] Group exception messages in execution/streaming","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR group exception messages in `sql/core/src/main/scala/org/apache/spark/sql/execution/streaming`.\r\n\r\n\r\n### Why are the changes needed?\r\nIt will largely help with standardization of error messages and its maintenance.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo. Error messages remain unchanged.\r\n\r\n\r\n### How was this patch tested?\r\nNo new tests - pass all original tests to make sure it doesn't break any existing behavior.\r\n","created_at":"2021-06-11T07:29:10Z","updated_at":"2021-06-15T09:22:07Z","closed_at":"2021-06-15T09:20:08Z","merged_at":null,"merge_commit_sha":"552cb278d5ad3011ff9d96ca4f49b8960885b326","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32880/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32880/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32880/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7c8d275364b1ccf83492e55f0a63f357ec7fb8ad","head":{"label":"beliefer:SPARK-35056","ref":"SPARK-35056","sha":"7c8d275364b1ccf83492e55f0a63f357ec7fb8ad","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":237617513,"node_id":"MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=","name":"spark","full_name":"beliefer/spark","private":false,"owner":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/beliefer/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/beliefer/spark","forks_url":"https://api.github.com/repos/beliefer/spark/forks","keys_url":"https://api.github.com/repos/beliefer/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/beliefer/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/beliefer/spark/teams","hooks_url":"https://api.github.com/repos/beliefer/spark/hooks","issue_events_url":"https://api.github.com/repos/beliefer/spark/issues/events{/number}","events_url":"https://api.github.com/repos/beliefer/spark/events","assignees_url":"https://api.github.com/repos/beliefer/spark/assignees{/user}","branches_url":"https://api.github.com/repos/beliefer/spark/branches{/branch}","tags_url":"https://api.github.com/repos/beliefer/spark/tags","blobs_url":"https://api.github.com/repos/beliefer/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/beliefer/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/beliefer/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/beliefer/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/beliefer/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/beliefer/spark/languages","stargazers_url":"https://api.github.com/repos/beliefer/spark/stargazers","contributors_url":"https://api.github.com/repos/beliefer/spark/contributors","subscribers_url":"https://api.github.com/repos/beliefer/spark/subscribers","subscription_url":"https://api.github.com/repos/beliefer/spark/subscription","commits_url":"https://api.github.com/repos/beliefer/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/beliefer/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/beliefer/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/beliefer/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/beliefer/spark/contents/{+path}","compare_url":"https://api.github.com/repos/beliefer/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/beliefer/spark/merges","archive_url":"https://api.github.com/repos/beliefer/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/beliefer/spark/downloads","issues_url":"https://api.github.com/repos/beliefer/spark/issues{/number}","pulls_url":"https://api.github.com/repos/beliefer/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/beliefer/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/beliefer/spark/labels{/name}","releases_url":"https://api.github.com/repos/beliefer/spark/releases{/id}","deployments_url":"https://api.github.com/repos/beliefer/spark/deployments","created_at":"2020-02-01T13:17:08Z","updated_at":"2025-01-28T09:45:49Z","pushed_at":"2025-01-28T11:57:29Z","git_url":"git://github.com/beliefer/spark.git","ssh_url":"git@github.com:beliefer/spark.git","clone_url":"https://github.com/beliefer/spark.git","svn_url":"https://github.com/beliefer/spark","homepage":"","size":488033,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"c463472e850ecb9401dc1ddecd015c01a4def2a4","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32880"},"html":{"href":"https://github.com/apache/spark/pull/32880"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32880"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32880/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32880/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32880/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7c8d275364b1ccf83492e55f0a63f357ec7fb8ad"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32879","id":667768010,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3NzY4MDEw","html_url":"https://github.com/apache/spark/pull/32879","diff_url":"https://github.com/apache/spark/pull/32879.diff","patch_url":"https://github.com/apache/spark/pull/32879.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32879","number":32879,"state":"closed","locked":false,"title":"[SPARK-35694][INFRA][FollowUp] Increase the default JVM stack size of SBT/Maven","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nIn https://github.com/apache/spark/pull/32838, we set the default JVM stack size to 16M from 4M.\r\nHowever, there are still stackoverflow error in builds: \r\nhttps://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/139672/console\r\n\r\nLet's update the value to 64M\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nMake test build stable.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nManual trigger test builds.","created_at":"2021-06-11T07:21:03Z","updated_at":"2021-06-18T03:16:51Z","closed_at":"2021-06-11T09:51:18Z","merged_at":null,"merge_commit_sha":"163f2100e189b46ee84fa15d4aaa8c636fc38f2b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1982110661,"node_id":"MDU6TGFiZWwxOTgyMTEwNjYx","url":"https://api.github.com/repos/apache/spark/labels/INFRA","name":"INFRA","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32879/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32879/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32879/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/42e8ad7bc8218945e1a71e2b65c4240ad78c3500","head":{"label":"gengliangwang:increaseStackAgain","ref":"increaseStackAgain","sha":"42e8ad7bc8218945e1a71e2b65c4240ad78c3500","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"c463472e850ecb9401dc1ddecd015c01a4def2a4","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32879"},"html":{"href":"https://github.com/apache/spark/pull/32879"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32879"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32879/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32879/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32879/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/42e8ad7bc8218945e1a71e2b65c4240ad78c3500"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32878","id":667761929,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3NzYxOTI5","html_url":"https://github.com/apache/spark/pull/32878","diff_url":"https://github.com/apache/spark/pull/32878.diff","patch_url":"https://github.com/apache/spark/pull/32878.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32878","number":32878,"state":"closed","locked":false,"title":"[SPARK-35719][SQL] Support type conversion between timestamp and timestamp without time zone type","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n1. Extend the Cast expression and support TimestampType in casting to TimestampWithoutTZType.\r\n2. There was a mistake in casting TimestampWithoutTZType as TimestampType in https://github.com/apache/spark/pull/32864. The target value should be `sourceValue - timeZoneOffset` instead of being the same value.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo conform the ANSI SQL standard which requires to support such casting.\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo, the new timestamp type is not released yet.\r\n\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit test","created_at":"2021-06-11T07:14:27Z","updated_at":"2021-06-13T15:44:38Z","closed_at":"2021-06-13T15:44:38Z","merged_at":null,"merge_commit_sha":"dcb227f933c907891bff0189ad512772982c142a","assignee":null,"assignees":[],"requested_reviewers":[{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32878/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32878/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32878/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e0e4596a03a2691975732b16e192396c96a1c6dd","head":{"label":"gengliangwang:timestampToTimestampWithoutTZ","ref":"timestampToTimestampWithoutTZ","sha":"e0e4596a03a2691975732b16e192396c96a1c6dd","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"c463472e850ecb9401dc1ddecd015c01a4def2a4","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32878"},"html":{"href":"https://github.com/apache/spark/pull/32878"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32878"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32878/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32878/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32878/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e0e4596a03a2691975732b16e192396c96a1c6dd"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32877","id":667711116,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3NzExMTE2","html_url":"https://github.com/apache/spark/pull/32877","diff_url":"https://github.com/apache/spark/pull/32877.diff","patch_url":"https://github.com/apache/spark/pull/32877.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32877","number":32877,"state":"closed","locked":false,"title":"[SPARK-35722][CORE] wait until something does get queued.","user":{"login":"yikf","id":51110188,"node_id":"MDQ6VXNlcjUxMTEwMTg4","avatar_url":"https://avatars.githubusercontent.com/u/51110188?v=4","gravatar_id":"","url":"https://api.github.com/users/yikf","html_url":"https://github.com/yikf","followers_url":"https://api.github.com/users/yikf/followers","following_url":"https://api.github.com/users/yikf/following{/other_user}","gists_url":"https://api.github.com/users/yikf/gists{/gist_id}","starred_url":"https://api.github.com/users/yikf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yikf/subscriptions","organizations_url":"https://api.github.com/users/yikf/orgs","repos_url":"https://api.github.com/users/yikf/repos","events_url":"https://api.github.com/users/yikf/events{/privacy}","received_events_url":"https://api.github.com/users/yikf/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nCurrently, we continue the loop after wait timeout when `ContextCleaner` cleanUp if the queue is empty, It is an ineffective loop because the queue is empty.\r\n\r\nIn the PR, it prevent ineffective loop, if the queue is empty, we wait until something does get queued instead of ineffective loop after wait timeout .\r\n\r\n### Why are the changes needed?\r\navoid inefeective loop\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nExist test\r\n","created_at":"2021-06-11T05:58:15Z","updated_at":"2021-06-15T13:44:49Z","closed_at":"2021-06-15T13:44:49Z","merged_at":null,"merge_commit_sha":"662cb1e39821a6d3771202f9b609b8acbae62c72","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32877/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32877/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32877/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/303fcfcd50c40bc54473cb6bb8423ab6403be1c0","head":{"label":"yikf:SPARK-35722","ref":"SPARK-35722","sha":"303fcfcd50c40bc54473cb6bb8423ab6403be1c0","user":{"login":"yikf","id":51110188,"node_id":"MDQ6VXNlcjUxMTEwMTg4","avatar_url":"https://avatars.githubusercontent.com/u/51110188?v=4","gravatar_id":"","url":"https://api.github.com/users/yikf","html_url":"https://github.com/yikf","followers_url":"https://api.github.com/users/yikf/followers","following_url":"https://api.github.com/users/yikf/following{/other_user}","gists_url":"https://api.github.com/users/yikf/gists{/gist_id}","starred_url":"https://api.github.com/users/yikf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yikf/subscriptions","organizations_url":"https://api.github.com/users/yikf/orgs","repos_url":"https://api.github.com/users/yikf/repos","events_url":"https://api.github.com/users/yikf/events{/privacy}","received_events_url":"https://api.github.com/users/yikf/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"e9af4576d5463f53fd431d2d59e49991f3c9b287","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32877"},"html":{"href":"https://github.com/apache/spark/pull/32877"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32877"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32877/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32877/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32877/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/303fcfcd50c40bc54473cb6bb8423ab6403be1c0"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32876","id":667702291,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3NzAyMjkx","html_url":"https://github.com/apache/spark/pull/32876","diff_url":"https://github.com/apache/spark/pull/32876.diff","patch_url":"https://github.com/apache/spark/pull/32876.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32876","number":32876,"state":"closed","locked":false,"title":"[SPARK-35722][CORE] wait until something does get queued","user":{"login":"yikf","id":51110188,"node_id":"MDQ6VXNlcjUxMTEwMTg4","avatar_url":"https://avatars.githubusercontent.com/u/51110188?v=4","gravatar_id":"","url":"https://api.github.com/users/yikf","html_url":"https://github.com/yikf","followers_url":"https://api.github.com/users/yikf/followers","following_url":"https://api.github.com/users/yikf/following{/other_user}","gists_url":"https://api.github.com/users/yikf/gists{/gist_id}","starred_url":"https://api.github.com/users/yikf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yikf/subscriptions","organizations_url":"https://api.github.com/users/yikf/orgs","repos_url":"https://api.github.com/users/yikf/repos","events_url":"https://api.github.com/users/yikf/events{/privacy}","received_events_url":"https://api.github.com/users/yikf/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nCurrently, we continue the loop after wait timeout when `ContextCleaner` cleanUp if the queue is empty, It is an ineffective loop because the queue is empty.\r\n\r\nIn the PR, it prevent ineffective loop, if the queue is empty, we wait until something does get queued instead of ineffective loop after wait timeout .\r\n\r\n### Why are the changes needed?\r\navoid inefeective loop\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nExist test\r\n","created_at":"2021-06-11T05:42:27Z","updated_at":"2021-06-11T05:59:53Z","closed_at":"2021-06-11T05:57:20Z","merged_at":null,"merge_commit_sha":"1094cf1517351cff9c33c811339bf483ded0e63f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32876/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32876/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32876/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/01b15a3232affe9cf4db670b847e25c431f3d239","head":{"label":"yikf:SPARK-35722","ref":"SPARK-35722","sha":"01b15a3232affe9cf4db670b847e25c431f3d239","user":{"login":"yikf","id":51110188,"node_id":"MDQ6VXNlcjUxMTEwMTg4","avatar_url":"https://avatars.githubusercontent.com/u/51110188?v=4","gravatar_id":"","url":"https://api.github.com/users/yikf","html_url":"https://github.com/yikf","followers_url":"https://api.github.com/users/yikf/followers","following_url":"https://api.github.com/users/yikf/following{/other_user}","gists_url":"https://api.github.com/users/yikf/gists{/gist_id}","starred_url":"https://api.github.com/users/yikf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yikf/subscriptions","organizations_url":"https://api.github.com/users/yikf/orgs","repos_url":"https://api.github.com/users/yikf/repos","events_url":"https://api.github.com/users/yikf/events{/privacy}","received_events_url":"https://api.github.com/users/yikf/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"e9af4576d5463f53fd431d2d59e49991f3c9b287","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32876"},"html":{"href":"https://github.com/apache/spark/pull/32876"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32876"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32876/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32876/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32876/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/01b15a3232affe9cf4db670b847e25c431f3d239"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32875","id":667636217,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3NjM2MjE3","html_url":"https://github.com/apache/spark/pull/32875","diff_url":"https://github.com/apache/spark/pull/32875.diff","patch_url":"https://github.com/apache/spark/pull/32875.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32875","number":32875,"state":"closed","locked":false,"title":"[SPARK-35703][SQL] Relax constraint for bucket join and remove HashClusteredDistribution","user":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nThis PR proposes the following:\r\n1. Introducing a new trait `ShuffleSpec` which is used in `EnsureRequirements` when the node has more than one children and serves two purposes: 1) compare all children and check if they are compatible w.r.t partitioning & distribution, 2) create a new partitioning to re-shuffle the other side in case they are not compatible.\r\n2. Remove `HashClusteredDistribution` and replace its usages with `ClusteredDistribution`.\r\n\r\nUnder the new mechanism, when `EnsureRequirements` check whether shuffles are required for a plan node with >1 children, it does the following:\r\n1. check each child of the node and see if it can satisfy the corresponding required distribution.\r\n2. check if all children of the node are compatible with each other w.r.t their partitioning and distribution\r\n3. if 2) fails, choose the best shuffle spec (in terms of shuffle parallelism) that can be used to repartition the other children, so that they will all have compatible partitioning\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nSpark currently only allow bucket join when the set of cluster keys from output partitioning _exactly match_ the set of join keys from the required distribution. For instance, in the following:\r\n```sql\r\nSELECT * FROM A JOIN B ON A.c1 = B.c1 AND A.c2 = B.c2\r\n```\r\nbucket join will only be triggered if both `A` and `B` are bucketed on columns `c1` and `c2`, in which case Spark will avoid shuffling both sides of the join.\r\n\r\nThe above requirement, however, is too strict, as shuffle can also be avoided if both `A` and `B` are bucketed on either column `c1` or `c2`. That is, if all rows that have the same value in column `c1` are clustered into the same partition, then all rows have the same values in column `c1` and `c2` are also clustered into the same partition. \r\n\r\nIn order to allow this, we'll need to change the logic of deciding whether two sides of a join operator are \"co-partitioned\". Currently, this is done by checking each side's output partitioning against its required distribution separately, using `Partitioning.satisfies` method. Since `HashClusteredDistribution` requires a `HashPartitioning` to have the exact match on the cluster keys, this can be done in isolation without looking at the other side's output partitioning and required distribution.\r\n\r\nHowever, the approach is no longer valid if we are going to relax the above constraint, as we need to compare the output partitioning and required distribution **on both sides**. For instance, in the above example, if `A` is bucketed on `c1` while `B` is bucketed on `c2`, we may need to do the following check:\r\n1. identify where `A.c1` and `B.c2` is used in the join keys (e.g., position 0 and 1 respectively)\r\n2. check if the positions derived from both sides exactly match each other (this becomes more complicated if a key appears in multiple positions within the join keys.)\r\n\r\nIn order to achieve the above, this proposes the following:\r\n```scala\r\ntrait ShuffleSpec {\r\n  // Used as a cost indicator to shuffle children\r\n  def numPartitions: Int\r\n\r\n  // Used to check whether this spec is compatible with `other`\r\n  def isCompatibleWith(other: ShuffleSpec): Boolean\r\n\r\n  // Used to create a new partitioning for the other `distribution` in case `isCompatibleWith` failed.\r\n  def createPartitioning(distribution: Distribution): Partitioning\r\n}\r\n```\r\n\r\nA similar API is also required if we are going to support DSv2 `DataSourcePartitioning` as output partitioning in bucket join scenario, or support custom hash functions such as `HiveHash` for bucketing. With the former, even if both `A` and `B` are partitioned on columns `c1` and `c2` in the above example, they could be partitioned via different transform expressions, e.g., `A` is on `(bucket(32, c1), day(c2)` while `B` is on `(bucket(32, c1), hour(c2)`. This means we'll need to compare the partitioning from both sides of the join which makes the current approach with `Partitioning.satisfies` insufficient. The same API `isCompatibleWith` can potentially be reused for the purpose.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nYes, now bucket join will be enabled for more cases as mentioned above.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\n\r\n1. Added a new test suite `ShuffleSpecSuite`\r\n2. Added additional tests in `EnsureRequirementsSuite`.","created_at":"2021-06-11T03:42:49Z","updated_at":"2022-02-07T09:16:20Z","closed_at":"2021-12-27T11:21:45Z","merged_at":null,"merge_commit_sha":"2ace85dfb46a597fe7c3ddbb8edd6580dd3ca79b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32875/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32875/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32875/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/112b110a5099c6a2e16979f695f06b47671a2e0a","head":{"label":"sunchao:SPARK-35703","ref":"SPARK-35703","sha":"112b110a5099c6a2e16979f695f06b47671a2e0a","user":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":29795757,"node_id":"MDEwOlJlcG9zaXRvcnkyOTc5NTc1Nw==","name":"spark","full_name":"sunchao/spark","private":false,"owner":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sunchao/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sunchao/spark","forks_url":"https://api.github.com/repos/sunchao/spark/forks","keys_url":"https://api.github.com/repos/sunchao/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sunchao/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sunchao/spark/teams","hooks_url":"https://api.github.com/repos/sunchao/spark/hooks","issue_events_url":"https://api.github.com/repos/sunchao/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sunchao/spark/events","assignees_url":"https://api.github.com/repos/sunchao/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sunchao/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sunchao/spark/tags","blobs_url":"https://api.github.com/repos/sunchao/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sunchao/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sunchao/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sunchao/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sunchao/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sunchao/spark/languages","stargazers_url":"https://api.github.com/repos/sunchao/spark/stargazers","contributors_url":"https://api.github.com/repos/sunchao/spark/contributors","subscribers_url":"https://api.github.com/repos/sunchao/spark/subscribers","subscription_url":"https://api.github.com/repos/sunchao/spark/subscription","commits_url":"https://api.github.com/repos/sunchao/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sunchao/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sunchao/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sunchao/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sunchao/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sunchao/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sunchao/spark/merges","archive_url":"https://api.github.com/repos/sunchao/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sunchao/spark/downloads","issues_url":"https://api.github.com/repos/sunchao/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sunchao/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sunchao/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sunchao/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sunchao/spark/labels{/name}","releases_url":"https://api.github.com/repos/sunchao/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sunchao/spark/deployments","created_at":"2015-01-24T23:30:38Z","updated_at":"2021-11-19T02:19:32Z","pushed_at":"2024-06-01T22:17:50Z","git_url":"git://github.com/sunchao/spark.git","ssh_url":"git@github.com:sunchao/spark.git","clone_url":"https://github.com/sunchao/spark.git","svn_url":"https://github.com/sunchao/spark","homepage":null,"size":426441,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"66c2d1ff74de998c3aaf3a4c48bdb31d4b47fcb1","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32875"},"html":{"href":"https://github.com/apache/spark/pull/32875"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32875"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32875/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32875/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32875/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/112b110a5099c6a2e16979f695f06b47671a2e0a"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32874","id":667631909,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3NjMxOTA5","html_url":"https://github.com/apache/spark/pull/32874","diff_url":"https://github.com/apache/spark/pull/32874.diff","patch_url":"https://github.com/apache/spark/pull/32874.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32874","number":32874,"state":"closed","locked":false,"title":"[SPARK-35699][K8S] Improve error message when creating k8s pod failed.","user":{"login":"pingsutw","id":37936015,"node_id":"MDQ6VXNlcjM3OTM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/37936015?v=4","gravatar_id":"","url":"https://api.github.com/users/pingsutw","html_url":"https://github.com/pingsutw","followers_url":"https://api.github.com/users/pingsutw/followers","following_url":"https://api.github.com/users/pingsutw/following{/other_user}","gists_url":"https://api.github.com/users/pingsutw/gists{/gist_id}","starred_url":"https://api.github.com/users/pingsutw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pingsutw/subscriptions","organizations_url":"https://api.github.com/users/pingsutw/orgs","repos_url":"https://api.github.com/users/pingsutw/repos","events_url":"https://api.github.com/users/pingsutw/events{/privacy}","received_events_url":"https://api.github.com/users/pingsutw/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nImprove error message when clients use wrong master URL to submit a job to k8s.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCurrent error messages are not clear for users.\r\n```\r\n(base) ➜ spark git:(master) ./bin/spark-submit \\\r\n--master k8s://https://192.168.49.3:8443 \\\r\n--name spark-pi \\\r\n--class org.apache.spark.examples.SparkPi \\\r\n--conf spark.executor.instances=3 \\\r\n--conf spark.kubernetes.authenticate.driver.serviceAccountName=spark \\\r\n--conf spark.kubernetes.container.image=pingsutw/spark:testing \\\r\nlocal:///opt/spark/examples/jars/spark-examples_2.12-3.2.0-SNAPSHOT.jar\r\n21/06/09 20:50:37 WARN Utils: Your hostname, kobe-pc resolves to a loopback address: 127.0.1.1; using 192.168.103.20 instead (on interface ens160)\r\n21/06/09 20:50:37 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address\r\n21/06/09 20:50:38 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\r\nUsing Spark's default log4j profile: org/apache/spark/log4j-defaults.properties\r\n21/06/09 20:50:38 INFO SparkKubernetesClientFactory: Auto-configuring K8S client using current context from users K8S config file\r\n21/06/09 20:50:39 INFO KerberosConfDriverFeatureStep: You have not specified a krb5.conf file locally or via a ConfigMap. Make sure that you have the krb5.conf locally on the driver image.\r\nException in thread \"main\" io.fabric8.kubernetes.client.KubernetesClientException: Operation: [create] for kind: [Pod] with name: [null] in namespace: [default] failed.\r\nat io.fabric8.kubernetes.client.KubernetesClientException.launderThrowable(KubernetesClientException.java:64) at io.fabric8.kubernetes.client.KubernetesClientException.launderThrowable(KubernetesClientException.java:64)\r\nat io.fabric8.kubernetes.client.KubernetesClientException.launderThrowable(KubernetesClientException.java:72) at io.fabric8.kubernetes.client.KubernetesClientException.launderThrowable(KubernetesClientException.java:72)\r\nat io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:380) at io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:380)\r\nat io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:86) at io.fabric8.kubernetes.client.dsl.base.BaseOperation.create(BaseOperation.java:86)\r\n```\r\nBelow command to reproduce;\r\n```\r\n./bin/spark-submit \\\r\n  --master k8s://https://192.168.49.2:8443 \\\r\n  --deploy-mode cluster \\\r\n  --name spark-pi \\\r\n  --class org.apache.spark.examples.SparkPi \\\r\n  --conf spark.executor.instances=3 \\\r\n  --conf spark.kubernetes.authenticate.driver.serviceAccountName=spark \\\r\n  --conf spark.kubernetes.container.image=pingsutw/spark:testing \\\r\n  local:///opt/spark/examples/jars/spark-examples_2.12-3.2.0-SNAPSHOT.jar\r\n```\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nYes, users will see more clear error messages.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nPass the CIs.","created_at":"2021-06-11T03:32:27Z","updated_at":"2021-06-22T02:10:31Z","closed_at":"2021-06-22T02:10:31Z","merged_at":null,"merge_commit_sha":"0ebaff2ce0b450effd806a16c2623b1e7af7b63f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406605057,"node_id":"MDU6TGFiZWwxNDA2NjA1MDU3","url":"https://api.github.com/repos/apache/spark/labels/KUBERNETES","name":"KUBERNETES","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32874/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32874/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32874/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c6813797156353eab001cf291257d41bbe773797","head":{"label":"pingsutw:SPARK-35699","ref":"SPARK-35699","sha":"c6813797156353eab001cf291257d41bbe773797","user":{"login":"pingsutw","id":37936015,"node_id":"MDQ6VXNlcjM3OTM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/37936015?v=4","gravatar_id":"","url":"https://api.github.com/users/pingsutw","html_url":"https://github.com/pingsutw","followers_url":"https://api.github.com/users/pingsutw/followers","following_url":"https://api.github.com/users/pingsutw/following{/other_user}","gists_url":"https://api.github.com/users/pingsutw/gists{/gist_id}","starred_url":"https://api.github.com/users/pingsutw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pingsutw/subscriptions","organizations_url":"https://api.github.com/users/pingsutw/orgs","repos_url":"https://api.github.com/users/pingsutw/repos","events_url":"https://api.github.com/users/pingsutw/events{/privacy}","received_events_url":"https://api.github.com/users/pingsutw/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":273827179,"node_id":"MDEwOlJlcG9zaXRvcnkyNzM4MjcxNzk=","name":"spark","full_name":"pingsutw/spark","private":false,"owner":{"login":"pingsutw","id":37936015,"node_id":"MDQ6VXNlcjM3OTM2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/37936015?v=4","gravatar_id":"","url":"https://api.github.com/users/pingsutw","html_url":"https://github.com/pingsutw","followers_url":"https://api.github.com/users/pingsutw/followers","following_url":"https://api.github.com/users/pingsutw/following{/other_user}","gists_url":"https://api.github.com/users/pingsutw/gists{/gist_id}","starred_url":"https://api.github.com/users/pingsutw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pingsutw/subscriptions","organizations_url":"https://api.github.com/users/pingsutw/orgs","repos_url":"https://api.github.com/users/pingsutw/repos","events_url":"https://api.github.com/users/pingsutw/events{/privacy}","received_events_url":"https://api.github.com/users/pingsutw/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pingsutw/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/pingsutw/spark","forks_url":"https://api.github.com/repos/pingsutw/spark/forks","keys_url":"https://api.github.com/repos/pingsutw/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pingsutw/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pingsutw/spark/teams","hooks_url":"https://api.github.com/repos/pingsutw/spark/hooks","issue_events_url":"https://api.github.com/repos/pingsutw/spark/issues/events{/number}","events_url":"https://api.github.com/repos/pingsutw/spark/events","assignees_url":"https://api.github.com/repos/pingsutw/spark/assignees{/user}","branches_url":"https://api.github.com/repos/pingsutw/spark/branches{/branch}","tags_url":"https://api.github.com/repos/pingsutw/spark/tags","blobs_url":"https://api.github.com/repos/pingsutw/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pingsutw/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pingsutw/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/pingsutw/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pingsutw/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/pingsutw/spark/languages","stargazers_url":"https://api.github.com/repos/pingsutw/spark/stargazers","contributors_url":"https://api.github.com/repos/pingsutw/spark/contributors","subscribers_url":"https://api.github.com/repos/pingsutw/spark/subscribers","subscription_url":"https://api.github.com/repos/pingsutw/spark/subscription","commits_url":"https://api.github.com/repos/pingsutw/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/pingsutw/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/pingsutw/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/pingsutw/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/pingsutw/spark/contents/{+path}","compare_url":"https://api.github.com/repos/pingsutw/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pingsutw/spark/merges","archive_url":"https://api.github.com/repos/pingsutw/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pingsutw/spark/downloads","issues_url":"https://api.github.com/repos/pingsutw/spark/issues{/number}","pulls_url":"https://api.github.com/repos/pingsutw/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/pingsutw/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/pingsutw/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pingsutw/spark/labels{/name}","releases_url":"https://api.github.com/repos/pingsutw/spark/releases{/id}","deployments_url":"https://api.github.com/repos/pingsutw/spark/deployments","created_at":"2020-06-21T03:29:25Z","updated_at":"2021-07-04T16:32:57Z","pushed_at":"2021-09-14T11:39:26Z","git_url":"git://github.com/pingsutw/spark.git","ssh_url":"git@github.com:pingsutw/spark.git","clone_url":"https://github.com/pingsutw/spark.git","svn_url":"https://github.com/pingsutw/spark","homepage":"https://spark.apache.org/","size":381328,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"62be22e929a741fc47e319f4323c0c5afddcf56a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32874"},"html":{"href":"https://github.com/apache/spark/pull/32874"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32874"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32874/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32874/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32874/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c6813797156353eab001cf291257d41bbe773797"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32873","id":667612836,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3NjEyODM2","html_url":"https://github.com/apache/spark/pull/32873","diff_url":"https://github.com/apache/spark/pull/32873.diff","patch_url":"https://github.com/apache/spark/pull/32873.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32873","number":32873,"state":"closed","locked":false,"title":"[SPARK-35718][SQL] Support casting of Date to timestamp without time zone type","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nExtend the Cast expression and support DateType in casting to TimestampWithoutTZType.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo conform the ANSI SQL standard which requires to support such casting.\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo, the new timestamp type is not released yet.\r\n\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit test","created_at":"2021-06-11T02:51:27Z","updated_at":"2021-06-11T06:09:08Z","closed_at":"2021-06-11T05:41:35Z","merged_at":null,"merge_commit_sha":"6237e4d6dde8a747a25276cb472f415e63f14970","assignee":null,"assignees":[],"requested_reviewers":[{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32873/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32873/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32873/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e4f06d8bf218441d264882babd34a12de78822f1","head":{"label":"gengliangwang:dateToTswtz","ref":"dateToTswtz","sha":"e4f06d8bf218441d264882babd34a12de78822f1","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"912d60b6dd2aa434fcde59e61fbe3adadd6c4975","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32873"},"html":{"href":"https://github.com/apache/spark/pull/32873"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32873"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32873/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32873/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32873/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e4f06d8bf218441d264882babd34a12de78822f1"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32872","id":667612045,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3NjEyMDQ1","html_url":"https://github.com/apache/spark/pull/32872","diff_url":"https://github.com/apache/spark/pull/32872.diff","patch_url":"https://github.com/apache/spark/pull/32872.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32872","number":32872,"state":"closed","locked":false,"title":"[SPARK-35639][SQL] Make hasCoalescedPartition return true if something was actually coalesced","user":{"login":"ekoifman","id":4297661,"node_id":"MDQ6VXNlcjQyOTc2NjE=","avatar_url":"https://avatars.githubusercontent.com/u/4297661?v=4","gravatar_id":"","url":"https://api.github.com/users/ekoifman","html_url":"https://github.com/ekoifman","followers_url":"https://api.github.com/users/ekoifman/followers","following_url":"https://api.github.com/users/ekoifman/following{/other_user}","gists_url":"https://api.github.com/users/ekoifman/gists{/gist_id}","starred_url":"https://api.github.com/users/ekoifman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ekoifman/subscriptions","organizations_url":"https://api.github.com/users/ekoifman/orgs","repos_url":"https://api.github.com/users/ekoifman/repos","events_url":"https://api.github.com/users/ekoifman/events{/privacy}","received_events_url":"https://api.github.com/users/ekoifman/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nFix `CustomShuffleReaderExec.hasCoalescedPartition` so that it returns true only if some original partitions got combined\r\n\r\n### Why are the changes needed?\r\nW/o this change `CustomShuffleReaderExec` description can report `coalesced` even though partitions are unchanged\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes, the `Arguments` in the node description is now accurate:\r\n```\r\n(16) CustomShuffleReader\r\nInput [3]: [registration#4, sum#85, count#86L]\r\nArguments: coalesced\r\n```\r\n\r\n### How was this patch tested?\r\nExisting tests\r\n\r\n","created_at":"2021-06-11T02:49:27Z","updated_at":"2021-07-14T09:09:09Z","closed_at":"2021-07-14T07:48:16Z","merged_at":null,"merge_commit_sha":"b64457a997edc47f1107cd939b4454ee1e2ba2b8","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32872/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32872/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32872/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/4bed38168439d9afb83be89f16bcc20f817eaa45","head":{"label":"ekoifman:PRISM-77023-fix-hasCoalescedPartition","ref":"PRISM-77023-fix-hasCoalescedPartition","sha":"4bed38168439d9afb83be89f16bcc20f817eaa45","user":{"login":"ekoifman","id":4297661,"node_id":"MDQ6VXNlcjQyOTc2NjE=","avatar_url":"https://avatars.githubusercontent.com/u/4297661?v=4","gravatar_id":"","url":"https://api.github.com/users/ekoifman","html_url":"https://github.com/ekoifman","followers_url":"https://api.github.com/users/ekoifman/followers","following_url":"https://api.github.com/users/ekoifman/following{/other_user}","gists_url":"https://api.github.com/users/ekoifman/gists{/gist_id}","starred_url":"https://api.github.com/users/ekoifman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ekoifman/subscriptions","organizations_url":"https://api.github.com/users/ekoifman/orgs","repos_url":"https://api.github.com/users/ekoifman/repos","events_url":"https://api.github.com/users/ekoifman/events{/privacy}","received_events_url":"https://api.github.com/users/ekoifman/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":313738951,"node_id":"MDEwOlJlcG9zaXRvcnkzMTM3Mzg5NTE=","name":"spark","full_name":"ekoifman/spark","private":false,"owner":{"login":"ekoifman","id":4297661,"node_id":"MDQ6VXNlcjQyOTc2NjE=","avatar_url":"https://avatars.githubusercontent.com/u/4297661?v=4","gravatar_id":"","url":"https://api.github.com/users/ekoifman","html_url":"https://github.com/ekoifman","followers_url":"https://api.github.com/users/ekoifman/followers","following_url":"https://api.github.com/users/ekoifman/following{/other_user}","gists_url":"https://api.github.com/users/ekoifman/gists{/gist_id}","starred_url":"https://api.github.com/users/ekoifman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ekoifman/subscriptions","organizations_url":"https://api.github.com/users/ekoifman/orgs","repos_url":"https://api.github.com/users/ekoifman/repos","events_url":"https://api.github.com/users/ekoifman/events{/privacy}","received_events_url":"https://api.github.com/users/ekoifman/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ekoifman/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/ekoifman/spark","forks_url":"https://api.github.com/repos/ekoifman/spark/forks","keys_url":"https://api.github.com/repos/ekoifman/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ekoifman/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ekoifman/spark/teams","hooks_url":"https://api.github.com/repos/ekoifman/spark/hooks","issue_events_url":"https://api.github.com/repos/ekoifman/spark/issues/events{/number}","events_url":"https://api.github.com/repos/ekoifman/spark/events","assignees_url":"https://api.github.com/repos/ekoifman/spark/assignees{/user}","branches_url":"https://api.github.com/repos/ekoifman/spark/branches{/branch}","tags_url":"https://api.github.com/repos/ekoifman/spark/tags","blobs_url":"https://api.github.com/repos/ekoifman/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ekoifman/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ekoifman/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ekoifman/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ekoifman/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ekoifman/spark/languages","stargazers_url":"https://api.github.com/repos/ekoifman/spark/stargazers","contributors_url":"https://api.github.com/repos/ekoifman/spark/contributors","subscribers_url":"https://api.github.com/repos/ekoifman/spark/subscribers","subscription_url":"https://api.github.com/repos/ekoifman/spark/subscription","commits_url":"https://api.github.com/repos/ekoifman/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ekoifman/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ekoifman/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ekoifman/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ekoifman/spark/contents/{+path}","compare_url":"https://api.github.com/repos/ekoifman/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ekoifman/spark/merges","archive_url":"https://api.github.com/repos/ekoifman/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ekoifman/spark/downloads","issues_url":"https://api.github.com/repos/ekoifman/spark/issues{/number}","pulls_url":"https://api.github.com/repos/ekoifman/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ekoifman/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ekoifman/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ekoifman/spark/labels{/name}","releases_url":"https://api.github.com/repos/ekoifman/spark/releases{/id}","deployments_url":"https://api.github.com/repos/ekoifman/spark/deployments","created_at":"2020-11-17T20:46:22Z","updated_at":"2021-06-03T21:33:34Z","pushed_at":"2022-03-08T02:22:59Z","git_url":"git://github.com/ekoifman/spark.git","ssh_url":"git@github.com:ekoifman/spark.git","clone_url":"https://github.com/ekoifman/spark.git","svn_url":"https://github.com/ekoifman/spark","homepage":"https://spark.apache.org/","size":400340,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"0fe2d809d6c76a8a33b67f059a8ab73276d76992","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32872"},"html":{"href":"https://github.com/apache/spark/pull/32872"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32872"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32872/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32872/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32872/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/4bed38168439d9afb83be89f16bcc20f817eaa45"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32871","id":667553904,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3NTUzOTA0","html_url":"https://github.com/apache/spark/pull/32871","diff_url":"https://github.com/apache/spark/pull/32871.diff","patch_url":"https://github.com/apache/spark/pull/32871.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32871","number":32871,"state":"closed","locked":false,"title":"[SPARK-35475][PYTHON] Fix disallow_untyped_defs mypy checks.","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nAdds more type annotations in the file `python/pyspark/pandas/namespace.py` and fixes the mypy check failures.\r\n\r\n### Why are the changes needed?\r\n\r\nWe should enable more disallow_untyped_defs mypy checks.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes.\r\nThis PR adds more type annotations in pandas APIs on Spark module, which can impact interaction with development tools for users.\r\n\r\n### How was this patch tested?\r\n\r\nThe mypy check with a new configuration and existing tests should pass.","created_at":"2021-06-11T00:35:41Z","updated_at":"2021-06-14T16:10:07Z","closed_at":"2021-06-11T18:07:23Z","merged_at":null,"merge_commit_sha":"0c0bc92bf0d2fc06755b466306a4b5411a7d20d4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32871/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32871/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32871/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/81a10425a0d4feaa08532e0138c293e9a013337e","head":{"label":"ueshin:issues/SPARK-35475/disallow_untyped_defs","ref":"issues/SPARK-35475/disallow_untyped_defs","sha":"81a10425a0d4feaa08532e0138c293e9a013337e","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":17234665,"node_id":"MDEwOlJlcG9zaXRvcnkxNzIzNDY2NQ==","name":"apache-spark","full_name":"ueshin/apache-spark","private":false,"owner":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ueshin/apache-spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/ueshin/apache-spark","forks_url":"https://api.github.com/repos/ueshin/apache-spark/forks","keys_url":"https://api.github.com/repos/ueshin/apache-spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ueshin/apache-spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ueshin/apache-spark/teams","hooks_url":"https://api.github.com/repos/ueshin/apache-spark/hooks","issue_events_url":"https://api.github.com/repos/ueshin/apache-spark/issues/events{/number}","events_url":"https://api.github.com/repos/ueshin/apache-spark/events","assignees_url":"https://api.github.com/repos/ueshin/apache-spark/assignees{/user}","branches_url":"https://api.github.com/repos/ueshin/apache-spark/branches{/branch}","tags_url":"https://api.github.com/repos/ueshin/apache-spark/tags","blobs_url":"https://api.github.com/repos/ueshin/apache-spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ueshin/apache-spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ueshin/apache-spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ueshin/apache-spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ueshin/apache-spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ueshin/apache-spark/languages","stargazers_url":"https://api.github.com/repos/ueshin/apache-spark/stargazers","contributors_url":"https://api.github.com/repos/ueshin/apache-spark/contributors","subscribers_url":"https://api.github.com/repos/ueshin/apache-spark/subscribers","subscription_url":"https://api.github.com/repos/ueshin/apache-spark/subscription","commits_url":"https://api.github.com/repos/ueshin/apache-spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ueshin/apache-spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ueshin/apache-spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ueshin/apache-spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ueshin/apache-spark/contents/{+path}","compare_url":"https://api.github.com/repos/ueshin/apache-spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ueshin/apache-spark/merges","archive_url":"https://api.github.com/repos/ueshin/apache-spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ueshin/apache-spark/downloads","issues_url":"https://api.github.com/repos/ueshin/apache-spark/issues{/number}","pulls_url":"https://api.github.com/repos/ueshin/apache-spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ueshin/apache-spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ueshin/apache-spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ueshin/apache-spark/labels{/name}","releases_url":"https://api.github.com/repos/ueshin/apache-spark/releases{/id}","deployments_url":"https://api.github.com/repos/ueshin/apache-spark/deployments","created_at":"2014-02-27T03:10:47Z","updated_at":"2025-02-07T02:07:18Z","pushed_at":"2025-02-07T19:29:05Z","git_url":"git://github.com/ueshin/apache-spark.git","ssh_url":"git@github.com:ueshin/apache-spark.git","clone_url":"https://github.com/ueshin/apache-spark.git","svn_url":"https://github.com/ueshin/apache-spark","homepage":null,"size":484941,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":8,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":8,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"912d60b6dd2aa434fcde59e61fbe3adadd6c4975","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32871"},"html":{"href":"https://github.com/apache/spark/pull/32871"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32871"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32871/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32871/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32871/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/81a10425a0d4feaa08532e0138c293e9a013337e"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32870","id":667513871,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3NTEzODcx","html_url":"https://github.com/apache/spark/pull/32870","diff_url":"https://github.com/apache/spark/pull/32870.diff","patch_url":"https://github.com/apache/spark/pull/32870.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32870","number":32870,"state":"closed","locked":false,"title":"[SPARK-35439][SQL][FOLLOWUP] ExpressionContainmentOrdering should not sort unrelated expressions","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nThis is a followup of #32586. We introduced `ExpressionContainmentOrdering` to sort common expressions according to their parent-child relations. For unrelated expressions, previously the ordering returns -1 which is not correct and can possibly lead to transitivity issue.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nTo fix the possible transitivity issue of `ExpressionContainmentOrdering`.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\n\r\nUnit test.\r\n","created_at":"2021-06-10T23:15:40Z","updated_at":"2023-12-27T18:25:14Z","closed_at":"2021-06-11T07:13:53Z","merged_at":null,"merge_commit_sha":"c9b8cbad03447b8631cf04bd48f4781f8708c76d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32870/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32870/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32870/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/019fababe0cd4f6630fcec56c4b08f9254d71269","head":{"label":"viirya:SPARK-35439-followup","ref":"SPARK-35439-followup","sha":"019fababe0cd4f6630fcec56c4b08f9254d71269","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"912d60b6dd2aa434fcde59e61fbe3adadd6c4975","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32870"},"html":{"href":"https://github.com/apache/spark/pull/32870"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32870"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32870/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32870/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32870/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/019fababe0cd4f6630fcec56c4b08f9254d71269"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32869","id":667118929,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY3MTE4OTI5","html_url":"https://github.com/apache/spark/pull/32869","diff_url":"https://github.com/apache/spark/pull/32869.diff","patch_url":"https://github.com/apache/spark/pull/32869.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32869","number":32869,"state":"closed","locked":false,"title":"[SPARK-35716][SQL] Support casting of timestamp without time zone to date type","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nExtend the Cast expression and support TimestampWithoutTZType in casting to DateType.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo conform the ANSI SQL standard which requires to support such casting.\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo, the new timestamp type is not released yet.\r\n\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit test","created_at":"2021-06-10T17:28:44Z","updated_at":"2021-06-10T22:32:10Z","closed_at":"2021-06-10T20:37:16Z","merged_at":null,"merge_commit_sha":"d528af86f9346b4d7f66b2436fec1dfda4d106e7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32869/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32869/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32869/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/dde4cd800a3d2e9aac55d05b5d99cc00fba0a2e6","head":{"label":"gengliangwang:castToDate","ref":"castToDate","sha":"dde4cd800a3d2e9aac55d05b5d99cc00fba0a2e6","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"44b695fbb06b0d89783b4838941c68543c5a5c8b","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32869"},"html":{"href":"https://github.com/apache/spark/pull/32869"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32869"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32869/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32869/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32869/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/dde4cd800a3d2e9aac55d05b5d99cc00fba0a2e6"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32868","id":666959754,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2OTU5NzU0","html_url":"https://github.com/apache/spark/pull/32868","diff_url":"https://github.com/apache/spark/pull/32868.diff","patch_url":"https://github.com/apache/spark/pull/32868.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32868","number":32868,"state":"closed","locked":false,"title":"[SPARK-35714][CORE] Bug fix for deadlock during the executor shutdown","user":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nBug fix for deadlock during the executor shutdown\r\n\r\n### Why are the changes needed?\r\n\r\nWhen a executor received a TERM signal, it (the second TERM signal) will lock java.lang.Shutdown class and then call Shutdown.exit() method to exit the JVM.\r\nShutdown will call SparkShutdownHook to shutdown the executor.\r\nDuring the executor shutdown phase, RemoteProcessDisconnected event will be send to the RPC inbox, and then WorkerWatcher will try to call System.exit(-1) again.\r\nBecause java.lang.Shutdown has already locked, a deadlock has occurred.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo\r\n\r\n### How was this patch tested?\r\n\r\nTest case \"task reaper kills JVM if killed tasks keep running for too long\" in JobCancellationSuite\r\n","created_at":"2021-06-10T14:42:21Z","updated_at":"2021-06-22T16:07:03Z","closed_at":"2021-06-13T21:01:07Z","merged_at":null,"merge_commit_sha":"72d0486fdc42bbd3d324f23143328d3a0cd00104","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32868/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32868/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32868/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3b38ae861b0bf8127a2f8c621630932affb49b03","head":{"label":"wankunde:SPARK-35714","ref":"SPARK-35714","sha":"3b38ae861b0bf8127a2f8c621630932affb49b03","user":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":260172941,"node_id":"MDEwOlJlcG9zaXRvcnkyNjAxNzI5NDE=","name":"spark","full_name":"wankunde/spark","private":false,"owner":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/wankunde/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/wankunde/spark","forks_url":"https://api.github.com/repos/wankunde/spark/forks","keys_url":"https://api.github.com/repos/wankunde/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/wankunde/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/wankunde/spark/teams","hooks_url":"https://api.github.com/repos/wankunde/spark/hooks","issue_events_url":"https://api.github.com/repos/wankunde/spark/issues/events{/number}","events_url":"https://api.github.com/repos/wankunde/spark/events","assignees_url":"https://api.github.com/repos/wankunde/spark/assignees{/user}","branches_url":"https://api.github.com/repos/wankunde/spark/branches{/branch}","tags_url":"https://api.github.com/repos/wankunde/spark/tags","blobs_url":"https://api.github.com/repos/wankunde/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/wankunde/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/wankunde/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/wankunde/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/wankunde/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/wankunde/spark/languages","stargazers_url":"https://api.github.com/repos/wankunde/spark/stargazers","contributors_url":"https://api.github.com/repos/wankunde/spark/contributors","subscribers_url":"https://api.github.com/repos/wankunde/spark/subscribers","subscription_url":"https://api.github.com/repos/wankunde/spark/subscription","commits_url":"https://api.github.com/repos/wankunde/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/wankunde/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/wankunde/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/wankunde/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/wankunde/spark/contents/{+path}","compare_url":"https://api.github.com/repos/wankunde/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/wankunde/spark/merges","archive_url":"https://api.github.com/repos/wankunde/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/wankunde/spark/downloads","issues_url":"https://api.github.com/repos/wankunde/spark/issues{/number}","pulls_url":"https://api.github.com/repos/wankunde/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/wankunde/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/wankunde/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/wankunde/spark/labels{/name}","releases_url":"https://api.github.com/repos/wankunde/spark/releases{/id}","deployments_url":"https://api.github.com/repos/wankunde/spark/deployments","created_at":"2020-04-30T09:47:54Z","updated_at":"2024-09-04T10:05:04Z","pushed_at":"2024-09-04T10:03:10Z","git_url":"git://github.com/wankunde/spark.git","ssh_url":"git@github.com:wankunde/spark.git","clone_url":"https://github.com/wankunde/spark.git","svn_url":"https://github.com/wankunde/spark","homepage":"https://spark.apache.org/","size":438528,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"88f1d82a467ca8cc366caaa59e2c8c8523cc5378","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32868"},"html":{"href":"https://github.com/apache/spark/pull/32868"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32868"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32868/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32868/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32868/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3b38ae861b0bf8127a2f8c621630932affb49b03"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32867","id":666941672,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2OTQxNjcy","html_url":"https://github.com/apache/spark/pull/32867","diff_url":"https://github.com/apache/spark/pull/32867.diff","patch_url":"https://github.com/apache/spark/pull/32867.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32867","number":32867,"state":"closed","locked":false,"title":"[SPARK-35721][PYTHON] Path level discover for python unittests","user":{"login":"Yikun","id":1736354,"node_id":"MDQ6VXNlcjE3MzYzNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1736354?v=4","gravatar_id":"","url":"https://api.github.com/users/Yikun","html_url":"https://github.com/Yikun","followers_url":"https://api.github.com/users/Yikun/followers","following_url":"https://api.github.com/users/Yikun/following{/other_user}","gists_url":"https://api.github.com/users/Yikun/gists{/gist_id}","starred_url":"https://api.github.com/users/Yikun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Yikun/subscriptions","organizations_url":"https://api.github.com/users/Yikun/orgs","repos_url":"https://api.github.com/users/Yikun/repos","events_url":"https://api.github.com/users/Yikun/events{/privacy}","received_events_url":"https://api.github.com/users/Yikun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nAdd path level discover for python unittests.\r\n\r\n### Why are the changes needed?\r\nNow we need to specify the python test cases by manually when we add a new testcase. Sometime, we forgot to add the testcase to module list, the testcase would not be executed.\r\n\r\nSuch as:\r\n- pyspark-core pyspark.tests.test_pin_thread\r\n\r\nThus we need some auto-discover way to find all testcase rather than specified every case by manually.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nAdd below code in end of `dev/sparktestsupport/modules.py`\r\n```python\r\nfor m in sorted(all_modules):\r\n    for g in sorted(m.python_test_goals):\r\n        print(m.name, g)\r\n```\r\nCompare the result before and after:\r\nhttps://www.diffchecker.com/iO3FvhKL","created_at":"2021-06-10T14:22:06Z","updated_at":"2021-07-01T09:14:35Z","closed_at":"2021-06-29T08:56:30Z","merged_at":null,"merge_commit_sha":"440fcbc4144f05e463e9828cacea065cb8b3cf4e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32867/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32867/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32867/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9f6b08f3d9ddaf1087c74d4a9f808697063922db","head":{"label":"Yikun:SPARK_DISCOVER_TEST","ref":"SPARK_DISCOVER_TEST","sha":"9f6b08f3d9ddaf1087c74d4a9f808697063922db","user":{"login":"Yikun","id":1736354,"node_id":"MDQ6VXNlcjE3MzYzNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1736354?v=4","gravatar_id":"","url":"https://api.github.com/users/Yikun","html_url":"https://github.com/Yikun","followers_url":"https://api.github.com/users/Yikun/followers","following_url":"https://api.github.com/users/Yikun/following{/other_user}","gists_url":"https://api.github.com/users/Yikun/gists{/gist_id}","starred_url":"https://api.github.com/users/Yikun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Yikun/subscriptions","organizations_url":"https://api.github.com/users/Yikun/orgs","repos_url":"https://api.github.com/users/Yikun/repos","events_url":"https://api.github.com/users/Yikun/events{/privacy}","received_events_url":"https://api.github.com/users/Yikun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":335541670,"node_id":"MDEwOlJlcG9zaXRvcnkzMzU1NDE2NzA=","name":"spark","full_name":"Yikun/spark","private":false,"owner":{"login":"Yikun","id":1736354,"node_id":"MDQ6VXNlcjE3MzYzNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1736354?v=4","gravatar_id":"","url":"https://api.github.com/users/Yikun","html_url":"https://github.com/Yikun","followers_url":"https://api.github.com/users/Yikun/followers","following_url":"https://api.github.com/users/Yikun/following{/other_user}","gists_url":"https://api.github.com/users/Yikun/gists{/gist_id}","starred_url":"https://api.github.com/users/Yikun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Yikun/subscriptions","organizations_url":"https://api.github.com/users/Yikun/orgs","repos_url":"https://api.github.com/users/Yikun/repos","events_url":"https://api.github.com/users/Yikun/events{/privacy}","received_events_url":"https://api.github.com/users/Yikun/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Yikun/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/Yikun/spark","forks_url":"https://api.github.com/repos/Yikun/spark/forks","keys_url":"https://api.github.com/repos/Yikun/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Yikun/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Yikun/spark/teams","hooks_url":"https://api.github.com/repos/Yikun/spark/hooks","issue_events_url":"https://api.github.com/repos/Yikun/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Yikun/spark/events","assignees_url":"https://api.github.com/repos/Yikun/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Yikun/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Yikun/spark/tags","blobs_url":"https://api.github.com/repos/Yikun/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Yikun/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Yikun/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Yikun/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Yikun/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Yikun/spark/languages","stargazers_url":"https://api.github.com/repos/Yikun/spark/stargazers","contributors_url":"https://api.github.com/repos/Yikun/spark/contributors","subscribers_url":"https://api.github.com/repos/Yikun/spark/subscribers","subscription_url":"https://api.github.com/repos/Yikun/spark/subscription","commits_url":"https://api.github.com/repos/Yikun/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Yikun/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Yikun/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Yikun/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Yikun/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Yikun/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Yikun/spark/merges","archive_url":"https://api.github.com/repos/Yikun/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Yikun/spark/downloads","issues_url":"https://api.github.com/repos/Yikun/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Yikun/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Yikun/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Yikun/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Yikun/spark/labels{/name}","releases_url":"https://api.github.com/repos/Yikun/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Yikun/spark/deployments","created_at":"2021-02-03T07:25:58Z","updated_at":"2022-01-13T12:26:18Z","pushed_at":"2023-01-28T06:50:14Z","git_url":"git://github.com/Yikun/spark.git","ssh_url":"git@github.com:Yikun/spark.git","clone_url":"https://github.com/Yikun/spark.git","svn_url":"https://github.com/Yikun/spark","homepage":"https://spark.apache.org/","size":452564,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":1,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"0a7a6f750c021a7fea10e3862898edf03a75c212","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32867"},"html":{"href":"https://github.com/apache/spark/pull/32867"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32867"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32867/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32867/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32867/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9f6b08f3d9ddaf1087c74d4a9f808697063922db"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32866","id":666930630,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2OTMwNjMw","html_url":"https://github.com/apache/spark/pull/32866","diff_url":"https://github.com/apache/spark/pull/32866.diff","patch_url":"https://github.com/apache/spark/pull/32866.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32866","number":32866,"state":"closed","locked":false,"title":"[SPARK-35713]Bug fix for thread leak in JobCancellationSuite","user":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nBug fix for thread leak in JobCancellationSuite UT\r\n\r\n### Why are the changes needed?\r\n\r\nWhen we call Thread.interrupt() method, that thread's interrupt status will be set but it may not really interrupt.\r\nSo when spark task runs in an infinite loop, spark context may fail to interrupt the task thread, and resulting in thread leak. \r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo\r\n\r\n### How was this patch tested?\r\n\r\nTest case \"task reaper kills JVM if killed tasks keep running for too long\" in JobCancellationSuite\r\n","created_at":"2021-06-10T14:09:35Z","updated_at":"2021-10-03T15:42:09Z","closed_at":"2021-09-26T00:51:45Z","merged_at":null,"merge_commit_sha":"49ca337e30610eb0a729382069e90911d261d852","assignee":null,"assignees":[],"requested_reviewers":[{"login":"mridulm","id":1591700,"node_id":"MDQ6VXNlcjE1OTE3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/1591700?v=4","gravatar_id":"","url":"https://api.github.com/users/mridulm","html_url":"https://github.com/mridulm","followers_url":"https://api.github.com/users/mridulm/followers","following_url":"https://api.github.com/users/mridulm/following{/other_user}","gists_url":"https://api.github.com/users/mridulm/gists{/gist_id}","starred_url":"https://api.github.com/users/mridulm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mridulm/subscriptions","organizations_url":"https://api.github.com/users/mridulm/orgs","repos_url":"https://api.github.com/users/mridulm/repos","events_url":"https://api.github.com/users/mridulm/events{/privacy}","received_events_url":"https://api.github.com/users/mridulm/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32866/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32866/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32866/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7f823ae04db1cbc70577e04a827699191c7b3bf9","head":{"label":"wankunde:SPARK-35713","ref":"SPARK-35713","sha":"7f823ae04db1cbc70577e04a827699191c7b3bf9","user":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":260172941,"node_id":"MDEwOlJlcG9zaXRvcnkyNjAxNzI5NDE=","name":"spark","full_name":"wankunde/spark","private":false,"owner":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/wankunde/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/wankunde/spark","forks_url":"https://api.github.com/repos/wankunde/spark/forks","keys_url":"https://api.github.com/repos/wankunde/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/wankunde/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/wankunde/spark/teams","hooks_url":"https://api.github.com/repos/wankunde/spark/hooks","issue_events_url":"https://api.github.com/repos/wankunde/spark/issues/events{/number}","events_url":"https://api.github.com/repos/wankunde/spark/events","assignees_url":"https://api.github.com/repos/wankunde/spark/assignees{/user}","branches_url":"https://api.github.com/repos/wankunde/spark/branches{/branch}","tags_url":"https://api.github.com/repos/wankunde/spark/tags","blobs_url":"https://api.github.com/repos/wankunde/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/wankunde/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/wankunde/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/wankunde/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/wankunde/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/wankunde/spark/languages","stargazers_url":"https://api.github.com/repos/wankunde/spark/stargazers","contributors_url":"https://api.github.com/repos/wankunde/spark/contributors","subscribers_url":"https://api.github.com/repos/wankunde/spark/subscribers","subscription_url":"https://api.github.com/repos/wankunde/spark/subscription","commits_url":"https://api.github.com/repos/wankunde/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/wankunde/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/wankunde/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/wankunde/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/wankunde/spark/contents/{+path}","compare_url":"https://api.github.com/repos/wankunde/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/wankunde/spark/merges","archive_url":"https://api.github.com/repos/wankunde/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/wankunde/spark/downloads","issues_url":"https://api.github.com/repos/wankunde/spark/issues{/number}","pulls_url":"https://api.github.com/repos/wankunde/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/wankunde/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/wankunde/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/wankunde/spark/labels{/name}","releases_url":"https://api.github.com/repos/wankunde/spark/releases{/id}","deployments_url":"https://api.github.com/repos/wankunde/spark/deployments","created_at":"2020-04-30T09:47:54Z","updated_at":"2024-09-04T10:05:04Z","pushed_at":"2024-09-04T10:03:10Z","git_url":"git://github.com/wankunde/spark.git","ssh_url":"git@github.com:wankunde/spark.git","clone_url":"https://github.com/wankunde/spark.git","svn_url":"https://github.com/wankunde/spark","homepage":"https://spark.apache.org/","size":438528,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"88f1d82a467ca8cc366caaa59e2c8c8523cc5378","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32866"},"html":{"href":"https://github.com/apache/spark/pull/32866"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32866"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32866/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32866/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32866/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7f823ae04db1cbc70577e04a827699191c7b3bf9"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32865","id":666875918,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2ODc1OTE4","html_url":"https://github.com/apache/spark/pull/32865","diff_url":"https://github.com/apache/spark/pull/32865.diff","patch_url":"https://github.com/apache/spark/pull/32865.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32865","number":32865,"state":"closed","locked":false,"title":"[SPARK-35701][SQL] Use copy-on-write semantics for SQLConf registered configurations.","user":{"login":"haiyangsun-db","id":75672016,"node_id":"MDQ6VXNlcjc1NjcyMDE2","avatar_url":"https://avatars.githubusercontent.com/u/75672016?v=4","gravatar_id":"","url":"https://api.github.com/users/haiyangsun-db","html_url":"https://github.com/haiyangsun-db","followers_url":"https://api.github.com/users/haiyangsun-db/followers","following_url":"https://api.github.com/users/haiyangsun-db/following{/other_user}","gists_url":"https://api.github.com/users/haiyangsun-db/gists{/gist_id}","starred_url":"https://api.github.com/users/haiyangsun-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haiyangsun-db/subscriptions","organizations_url":"https://api.github.com/users/haiyangsun-db/orgs","repos_url":"https://api.github.com/users/haiyangsun-db/repos","events_url":"https://api.github.com/users/haiyangsun-db/events{/privacy}","received_events_url":"https://api.github.com/users/haiyangsun-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nUsing copy-on-write for `SQLConf.sqlConfEntries` and `SQLConf.staticConfKeys` to reduce contention in concurrent workloads.\r\n\r\n### Why are the changes needed?\r\n\r\nThe global locks used to protect `SQLConf.sqlConfEntries` map and the `SQLConf.staticConfKeys` set can cause significant contention on the `SQLConf` instance in a concurrent setting. \r\n\r\nUsing copy-on-write versions should reduce the contention given that modifications to the configs are relatively rare.\r\n","created_at":"2021-06-10T13:09:30Z","updated_at":"2021-06-12T22:00:09Z","closed_at":"2021-06-12T22:00:09Z","merged_at":null,"merge_commit_sha":"782ea7134d012aa6d1b33b23ba6fca3fb6d91932","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32865/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32865/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32865/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/994cab24f91d681f187b3062da0de62a45b0ba6a","head":{"label":"haiyangsun-db:SPARK-35701","ref":"SPARK-35701","sha":"994cab24f91d681f187b3062da0de62a45b0ba6a","user":{"login":"haiyangsun-db","id":75672016,"node_id":"MDQ6VXNlcjc1NjcyMDE2","avatar_url":"https://avatars.githubusercontent.com/u/75672016?v=4","gravatar_id":"","url":"https://api.github.com/users/haiyangsun-db","html_url":"https://github.com/haiyangsun-db","followers_url":"https://api.github.com/users/haiyangsun-db/followers","following_url":"https://api.github.com/users/haiyangsun-db/following{/other_user}","gists_url":"https://api.github.com/users/haiyangsun-db/gists{/gist_id}","starred_url":"https://api.github.com/users/haiyangsun-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haiyangsun-db/subscriptions","organizations_url":"https://api.github.com/users/haiyangsun-db/orgs","repos_url":"https://api.github.com/users/haiyangsun-db/repos","events_url":"https://api.github.com/users/haiyangsun-db/events{/privacy}","received_events_url":"https://api.github.com/users/haiyangsun-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":374987428,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ5ODc0Mjg=","name":"spark","full_name":"haiyangsun-db/spark","private":false,"owner":{"login":"haiyangsun-db","id":75672016,"node_id":"MDQ6VXNlcjc1NjcyMDE2","avatar_url":"https://avatars.githubusercontent.com/u/75672016?v=4","gravatar_id":"","url":"https://api.github.com/users/haiyangsun-db","html_url":"https://github.com/haiyangsun-db","followers_url":"https://api.github.com/users/haiyangsun-db/followers","following_url":"https://api.github.com/users/haiyangsun-db/following{/other_user}","gists_url":"https://api.github.com/users/haiyangsun-db/gists{/gist_id}","starred_url":"https://api.github.com/users/haiyangsun-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haiyangsun-db/subscriptions","organizations_url":"https://api.github.com/users/haiyangsun-db/orgs","repos_url":"https://api.github.com/users/haiyangsun-db/repos","events_url":"https://api.github.com/users/haiyangsun-db/events{/privacy}","received_events_url":"https://api.github.com/users/haiyangsun-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/haiyangsun-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/haiyangsun-db/spark","forks_url":"https://api.github.com/repos/haiyangsun-db/spark/forks","keys_url":"https://api.github.com/repos/haiyangsun-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/haiyangsun-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/haiyangsun-db/spark/teams","hooks_url":"https://api.github.com/repos/haiyangsun-db/spark/hooks","issue_events_url":"https://api.github.com/repos/haiyangsun-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/haiyangsun-db/spark/events","assignees_url":"https://api.github.com/repos/haiyangsun-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/haiyangsun-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/haiyangsun-db/spark/tags","blobs_url":"https://api.github.com/repos/haiyangsun-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/haiyangsun-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/haiyangsun-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/haiyangsun-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/haiyangsun-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/haiyangsun-db/spark/languages","stargazers_url":"https://api.github.com/repos/haiyangsun-db/spark/stargazers","contributors_url":"https://api.github.com/repos/haiyangsun-db/spark/contributors","subscribers_url":"https://api.github.com/repos/haiyangsun-db/spark/subscribers","subscription_url":"https://api.github.com/repos/haiyangsun-db/spark/subscription","commits_url":"https://api.github.com/repos/haiyangsun-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/haiyangsun-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/haiyangsun-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/haiyangsun-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/haiyangsun-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/haiyangsun-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/haiyangsun-db/spark/merges","archive_url":"https://api.github.com/repos/haiyangsun-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/haiyangsun-db/spark/downloads","issues_url":"https://api.github.com/repos/haiyangsun-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/haiyangsun-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/haiyangsun-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/haiyangsun-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/haiyangsun-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/haiyangsun-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/haiyangsun-db/spark/deployments","created_at":"2021-06-08T11:39:54Z","updated_at":"2024-12-27T14:57:28Z","pushed_at":"2024-12-27T23:08:56Z","git_url":"git://github.com/haiyangsun-db/spark.git","ssh_url":"git@github.com:haiyangsun-db/spark.git","clone_url":"https://github.com/haiyangsun-db/spark.git","svn_url":"https://github.com/haiyangsun-db/spark","homepage":"https://spark.apache.org/","size":455182,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"e9af4576d5463f53fd431d2d59e49991f3c9b287","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32865"},"html":{"href":"https://github.com/apache/spark/pull/32865"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32865"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32865/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32865/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32865/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/994cab24f91d681f187b3062da0de62a45b0ba6a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32864","id":666791559,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NzkxNTU5","html_url":"https://github.com/apache/spark/pull/32864","diff_url":"https://github.com/apache/spark/pull/32864.diff","patch_url":"https://github.com/apache/spark/pull/32864.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32864","number":32864,"state":"closed","locked":false,"title":"[SPARK-35711][SQL] Support casting of timestamp without time zone to timestamp type","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nExtend the Cast expression and support TimestampWithoutTZType in casting to TimestampType.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo conform the ANSI SQL standard which requires to support such casting.\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo, the new timestamp type is not released yet.\r\n\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit test","created_at":"2021-06-10T11:20:16Z","updated_at":"2021-06-10T16:31:09Z","closed_at":"2021-06-10T15:04:08Z","merged_at":null,"merge_commit_sha":"50841a30a53b6b317fc0fe4b905ef3cc579520b1","assignee":null,"assignees":[],"requested_reviewers":[{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32864/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32864/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32864/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b47219a0498192ae217ea18582bbc37cd5969bd7","head":{"label":"gengliangwang:castToTimestamp","ref":"castToTimestamp","sha":"b47219a0498192ae217ea18582bbc37cd5969bd7","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5280f02747eed9849e4a64562d38aee11e21616f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32864"},"html":{"href":"https://github.com/apache/spark/pull/32864"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32864"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32864/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32864/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32864/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b47219a0498192ae217ea18582bbc37cd5969bd7"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32863","id":666769658,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NzY5NjU4","html_url":"https://github.com/apache/spark/pull/32863","diff_url":"https://github.com/apache/spark/pull/32863.diff","patch_url":"https://github.com/apache/spark/pull/32863.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32863","number":32863,"state":"closed","locked":false,"title":"[SPARK-35652][SQL] joinWith on two table generated from same one","user":{"login":"dgd-contributor","id":84778052,"node_id":"MDQ6VXNlcjg0Nzc4MDUy","avatar_url":"https://avatars.githubusercontent.com/u/84778052?v=4","gravatar_id":"","url":"https://api.github.com/users/dgd-contributor","html_url":"https://github.com/dgd-contributor","followers_url":"https://api.github.com/users/dgd-contributor/followers","following_url":"https://api.github.com/users/dgd-contributor/following{/other_user}","gists_url":"https://api.github.com/users/dgd-contributor/gists{/gist_id}","starred_url":"https://api.github.com/users/dgd-contributor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgd-contributor/subscriptions","organizations_url":"https://api.github.com/users/dgd-contributor/orgs","repos_url":"https://api.github.com/users/dgd-contributor/repos","events_url":"https://api.github.com/users/dgd-contributor/events{/privacy}","received_events_url":"https://api.github.com/users/dgd-contributor/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nIt seems like spark inner join is performing a cartesian join in self joining using `joinWith`\r\n\r\nTo produce this issues:\r\n```\r\nval df = spark.range(0,3)\r\ndf.joinWith(df, df(\"id\") === df(\"id\")).show()\r\n```\r\n\r\nBefore this pull request, the result is\r\n+---+---+\r\n | _1 |  _2 |\r\n+---+---+\r\n|    0 |   0 |\r\n|    0 |   1 |\r\n|    0 |   2 |\r\n|    1 |   0 |\r\n|    1 |   1 |\r\n|    1 |   2 |\r\n|    2 |   0 |\r\n|    2 |   1 |\r\n|    2 |   2 |\r\n+---+---+\r\n\r\nThe expected result is\r\n+---+---+\r\n | _1 |  _2 |\r\n+---+---+\r\n|    0 |   0 |\r\n|    1 |   1 |\r\n|    2 |   2 |\r\n+---+---+\r\n### Why are the changes needed?\r\ncorrectness\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno\r\n\r\n### How was this patch tested?\r\nadd test","created_at":"2021-06-10T10:51:21Z","updated_at":"2021-06-14T01:46:48Z","closed_at":"2021-06-11T12:37:08Z","merged_at":null,"merge_commit_sha":"9e0b45e72f661493b5d8f205db7fa3884abc45a0","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32863/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32863/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32863/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/afd327952c795d6ab639b4fb4fc50eaaa5ddeb80","head":{"label":"dgd-contributor:SPARK-35652_join_and_joinWith_in_seft_joining","ref":"SPARK-35652_join_and_joinWith_in_seft_joining","sha":"afd327952c795d6ab639b4fb4fc50eaaa5ddeb80","user":{"login":"dgd-contributor","id":84778052,"node_id":"MDQ6VXNlcjg0Nzc4MDUy","avatar_url":"https://avatars.githubusercontent.com/u/84778052?v=4","gravatar_id":"","url":"https://api.github.com/users/dgd-contributor","html_url":"https://github.com/dgd-contributor","followers_url":"https://api.github.com/users/dgd-contributor/followers","following_url":"https://api.github.com/users/dgd-contributor/following{/other_user}","gists_url":"https://api.github.com/users/dgd-contributor/gists{/gist_id}","starred_url":"https://api.github.com/users/dgd-contributor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgd-contributor/subscriptions","organizations_url":"https://api.github.com/users/dgd-contributor/orgs","repos_url":"https://api.github.com/users/dgd-contributor/repos","events_url":"https://api.github.com/users/dgd-contributor/events{/privacy}","received_events_url":"https://api.github.com/users/dgd-contributor/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":370663608,"node_id":"MDEwOlJlcG9zaXRvcnkzNzA2NjM2MDg=","name":"spark","full_name":"dgd-contributor/spark","private":false,"owner":{"login":"dgd-contributor","id":84778052,"node_id":"MDQ6VXNlcjg0Nzc4MDUy","avatar_url":"https://avatars.githubusercontent.com/u/84778052?v=4","gravatar_id":"","url":"https://api.github.com/users/dgd-contributor","html_url":"https://github.com/dgd-contributor","followers_url":"https://api.github.com/users/dgd-contributor/followers","following_url":"https://api.github.com/users/dgd-contributor/following{/other_user}","gists_url":"https://api.github.com/users/dgd-contributor/gists{/gist_id}","starred_url":"https://api.github.com/users/dgd-contributor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dgd-contributor/subscriptions","organizations_url":"https://api.github.com/users/dgd-contributor/orgs","repos_url":"https://api.github.com/users/dgd-contributor/repos","events_url":"https://api.github.com/users/dgd-contributor/events{/privacy}","received_events_url":"https://api.github.com/users/dgd-contributor/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dgd-contributor/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/dgd-contributor/spark","forks_url":"https://api.github.com/repos/dgd-contributor/spark/forks","keys_url":"https://api.github.com/repos/dgd-contributor/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dgd-contributor/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dgd-contributor/spark/teams","hooks_url":"https://api.github.com/repos/dgd-contributor/spark/hooks","issue_events_url":"https://api.github.com/repos/dgd-contributor/spark/issues/events{/number}","events_url":"https://api.github.com/repos/dgd-contributor/spark/events","assignees_url":"https://api.github.com/repos/dgd-contributor/spark/assignees{/user}","branches_url":"https://api.github.com/repos/dgd-contributor/spark/branches{/branch}","tags_url":"https://api.github.com/repos/dgd-contributor/spark/tags","blobs_url":"https://api.github.com/repos/dgd-contributor/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dgd-contributor/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dgd-contributor/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/dgd-contributor/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dgd-contributor/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/dgd-contributor/spark/languages","stargazers_url":"https://api.github.com/repos/dgd-contributor/spark/stargazers","contributors_url":"https://api.github.com/repos/dgd-contributor/spark/contributors","subscribers_url":"https://api.github.com/repos/dgd-contributor/spark/subscribers","subscription_url":"https://api.github.com/repos/dgd-contributor/spark/subscription","commits_url":"https://api.github.com/repos/dgd-contributor/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/dgd-contributor/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/dgd-contributor/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/dgd-contributor/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/dgd-contributor/spark/contents/{+path}","compare_url":"https://api.github.com/repos/dgd-contributor/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dgd-contributor/spark/merges","archive_url":"https://api.github.com/repos/dgd-contributor/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dgd-contributor/spark/downloads","issues_url":"https://api.github.com/repos/dgd-contributor/spark/issues{/number}","pulls_url":"https://api.github.com/repos/dgd-contributor/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/dgd-contributor/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/dgd-contributor/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dgd-contributor/spark/labels{/name}","releases_url":"https://api.github.com/repos/dgd-contributor/spark/releases{/id}","deployments_url":"https://api.github.com/repos/dgd-contributor/spark/deployments","created_at":"2021-05-25T11:08:20Z","updated_at":"2021-10-06T01:57:55Z","pushed_at":"2021-10-06T01:57:45Z","git_url":"git://github.com/dgd-contributor/spark.git","ssh_url":"git@github.com:dgd-contributor/spark.git","clone_url":"https://github.com/dgd-contributor/spark.git","svn_url":"https://github.com/dgd-contributor/spark","homepage":"https://spark.apache.org/","size":390391,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5280f02747eed9849e4a64562d38aee11e21616f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32863"},"html":{"href":"https://github.com/apache/spark/pull/32863"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32863"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32863/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32863/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32863/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/afd327952c795d6ab639b4fb4fc50eaaa5ddeb80"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32862","id":666735231,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NzM1MjMx","html_url":"https://github.com/apache/spark/pull/32862","diff_url":"https://github.com/apache/spark/pull/32862.diff","patch_url":"https://github.com/apache/spark/pull/32862.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32862","number":32862,"state":"closed","locked":false,"title":"[SPARK-35695][SQL] Collect observed metrics from cached and adaptive execution sub-trees","user":{"login":"tanelk","id":3342974,"node_id":"MDQ6VXNlcjMzNDI5NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3342974?v=4","gravatar_id":"","url":"https://api.github.com/users/tanelk","html_url":"https://github.com/tanelk","followers_url":"https://api.github.com/users/tanelk/followers","following_url":"https://api.github.com/users/tanelk/following{/other_user}","gists_url":"https://api.github.com/users/tanelk/gists{/gist_id}","starred_url":"https://api.github.com/users/tanelk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanelk/subscriptions","organizations_url":"https://api.github.com/users/tanelk/orgs","repos_url":"https://api.github.com/users/tanelk/repos","events_url":"https://api.github.com/users/tanelk/events{/privacy}","received_events_url":"https://api.github.com/users/tanelk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nCollect observed metrics from cached and adaptive execution sub-trees.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCurrently persisting/caching will hide all observed metrics in that sub-tree from reaching the `QueryExecutionListeners`. Adaptive query execution can also hide the metrics from reaching `QueryExecutionListeners`.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nBugfix\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nNew UTs","created_at":"2021-06-10T10:08:48Z","updated_at":"2021-06-11T14:31:09Z","closed_at":"2021-06-11T13:03:17Z","merged_at":null,"merge_commit_sha":"90a022914faed946792337d426a4b62b11ec9824","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32862/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32862/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32862/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/57ba5c9c2187a2cde4eec1ef6eadb40ba4c73208","head":{"label":"tanelk:SPARK-35695_collect_metrics_persist","ref":"SPARK-35695_collect_metrics_persist","sha":"57ba5c9c2187a2cde4eec1ef6eadb40ba4c73208","user":{"login":"tanelk","id":3342974,"node_id":"MDQ6VXNlcjMzNDI5NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3342974?v=4","gravatar_id":"","url":"https://api.github.com/users/tanelk","html_url":"https://github.com/tanelk","followers_url":"https://api.github.com/users/tanelk/followers","following_url":"https://api.github.com/users/tanelk/following{/other_user}","gists_url":"https://api.github.com/users/tanelk/gists{/gist_id}","starred_url":"https://api.github.com/users/tanelk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanelk/subscriptions","organizations_url":"https://api.github.com/users/tanelk/orgs","repos_url":"https://api.github.com/users/tanelk/repos","events_url":"https://api.github.com/users/tanelk/events{/privacy}","received_events_url":"https://api.github.com/users/tanelk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":279394019,"node_id":"MDEwOlJlcG9zaXRvcnkyNzkzOTQwMTk=","name":"spark","full_name":"tanelk/spark","private":false,"owner":{"login":"tanelk","id":3342974,"node_id":"MDQ6VXNlcjMzNDI5NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3342974?v=4","gravatar_id":"","url":"https://api.github.com/users/tanelk","html_url":"https://github.com/tanelk","followers_url":"https://api.github.com/users/tanelk/followers","following_url":"https://api.github.com/users/tanelk/following{/other_user}","gists_url":"https://api.github.com/users/tanelk/gists{/gist_id}","starred_url":"https://api.github.com/users/tanelk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanelk/subscriptions","organizations_url":"https://api.github.com/users/tanelk/orgs","repos_url":"https://api.github.com/users/tanelk/repos","events_url":"https://api.github.com/users/tanelk/events{/privacy}","received_events_url":"https://api.github.com/users/tanelk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/tanelk/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/tanelk/spark","forks_url":"https://api.github.com/repos/tanelk/spark/forks","keys_url":"https://api.github.com/repos/tanelk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/tanelk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/tanelk/spark/teams","hooks_url":"https://api.github.com/repos/tanelk/spark/hooks","issue_events_url":"https://api.github.com/repos/tanelk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/tanelk/spark/events","assignees_url":"https://api.github.com/repos/tanelk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/tanelk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/tanelk/spark/tags","blobs_url":"https://api.github.com/repos/tanelk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/tanelk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/tanelk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/tanelk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/tanelk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/tanelk/spark/languages","stargazers_url":"https://api.github.com/repos/tanelk/spark/stargazers","contributors_url":"https://api.github.com/repos/tanelk/spark/contributors","subscribers_url":"https://api.github.com/repos/tanelk/spark/subscribers","subscription_url":"https://api.github.com/repos/tanelk/spark/subscription","commits_url":"https://api.github.com/repos/tanelk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/tanelk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/tanelk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/tanelk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/tanelk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/tanelk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/tanelk/spark/merges","archive_url":"https://api.github.com/repos/tanelk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/tanelk/spark/downloads","issues_url":"https://api.github.com/repos/tanelk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/tanelk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/tanelk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/tanelk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/tanelk/spark/labels{/name}","releases_url":"https://api.github.com/repos/tanelk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/tanelk/spark/deployments","created_at":"2020-07-13T19:30:44Z","updated_at":"2021-12-03T13:34:30Z","pushed_at":"2024-04-12T13:31:59Z","git_url":"git://github.com/tanelk/spark.git","ssh_url":"git@github.com:tanelk/spark.git","clone_url":"https://github.com/tanelk/spark.git","svn_url":"https://github.com/tanelk/spark","homepage":"https://spark.apache.org/","size":409425,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"44b695fbb06b0d89783b4838941c68543c5a5c8b","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32862"},"html":{"href":"https://github.com/apache/spark/pull/32862"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32862"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32862/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32862/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32862/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/57ba5c9c2187a2cde4eec1ef6eadb40ba4c73208"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32861","id":666714029,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NzE0MDI5","html_url":"https://github.com/apache/spark/pull/32861","diff_url":"https://github.com/apache/spark/pull/32861.diff","patch_url":"https://github.com/apache/spark/pull/32861.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32861","number":32861,"state":"closed","locked":false,"title":"[SPARK-35710] [SQL] Support DPP + AQE when there is no reused broadcast exchange","user":{"login":"JkSelf","id":11972570,"node_id":"MDQ6VXNlcjExOTcyNTcw","avatar_url":"https://avatars.githubusercontent.com/u/11972570?v=4","gravatar_id":"","url":"https://api.github.com/users/JkSelf","html_url":"https://github.com/JkSelf","followers_url":"https://api.github.com/users/JkSelf/followers","following_url":"https://api.github.com/users/JkSelf/following{/other_user}","gists_url":"https://api.github.com/users/JkSelf/gists{/gist_id}","starred_url":"https://api.github.com/users/JkSelf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JkSelf/subscriptions","organizations_url":"https://api.github.com/users/JkSelf/orgs","repos_url":"https://api.github.com/users/JkSelf/repos","events_url":"https://api.github.com/users/JkSelf/events{/privacy}","received_events_url":"https://api.github.com/users/JkSelf/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n### What changes were proposed in this pull request?\r\nThis PR add the DPP + AQE support when spark can't reuse the broadcast but executing the DPP subquery is cheaper.\r\n\r\n\r\n### Why are the changes needed?\r\nImprove AQE + DPP\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nAdding new ut\r\n","created_at":"2021-06-10T09:43:38Z","updated_at":"2021-07-16T08:01:29Z","closed_at":"2021-07-16T08:01:29Z","merged_at":null,"merge_commit_sha":"8e4acafc1c83d3ca888b489e2bcd69c701d9a489","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32861/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32861/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32861/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ac56149ba63e399b4a96bb655681ea6d0dac0221","head":{"label":"JkSelf:supportDPP3","ref":"supportDPP3","sha":"ac56149ba63e399b4a96bb655681ea6d0dac0221","user":{"login":"JkSelf","id":11972570,"node_id":"MDQ6VXNlcjExOTcyNTcw","avatar_url":"https://avatars.githubusercontent.com/u/11972570?v=4","gravatar_id":"","url":"https://api.github.com/users/JkSelf","html_url":"https://github.com/JkSelf","followers_url":"https://api.github.com/users/JkSelf/followers","following_url":"https://api.github.com/users/JkSelf/following{/other_user}","gists_url":"https://api.github.com/users/JkSelf/gists{/gist_id}","starred_url":"https://api.github.com/users/JkSelf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JkSelf/subscriptions","organizations_url":"https://api.github.com/users/JkSelf/orgs","repos_url":"https://api.github.com/users/JkSelf/repos","events_url":"https://api.github.com/users/JkSelf/events{/privacy}","received_events_url":"https://api.github.com/users/JkSelf/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":159634260,"node_id":"MDEwOlJlcG9zaXRvcnkxNTk2MzQyNjA=","name":"spark","full_name":"JkSelf/spark","private":false,"owner":{"login":"JkSelf","id":11972570,"node_id":"MDQ6VXNlcjExOTcyNTcw","avatar_url":"https://avatars.githubusercontent.com/u/11972570?v=4","gravatar_id":"","url":"https://api.github.com/users/JkSelf","html_url":"https://github.com/JkSelf","followers_url":"https://api.github.com/users/JkSelf/followers","following_url":"https://api.github.com/users/JkSelf/following{/other_user}","gists_url":"https://api.github.com/users/JkSelf/gists{/gist_id}","starred_url":"https://api.github.com/users/JkSelf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JkSelf/subscriptions","organizations_url":"https://api.github.com/users/JkSelf/orgs","repos_url":"https://api.github.com/users/JkSelf/repos","events_url":"https://api.github.com/users/JkSelf/events{/privacy}","received_events_url":"https://api.github.com/users/JkSelf/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/JkSelf/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/JkSelf/spark","forks_url":"https://api.github.com/repos/JkSelf/spark/forks","keys_url":"https://api.github.com/repos/JkSelf/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/JkSelf/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/JkSelf/spark/teams","hooks_url":"https://api.github.com/repos/JkSelf/spark/hooks","issue_events_url":"https://api.github.com/repos/JkSelf/spark/issues/events{/number}","events_url":"https://api.github.com/repos/JkSelf/spark/events","assignees_url":"https://api.github.com/repos/JkSelf/spark/assignees{/user}","branches_url":"https://api.github.com/repos/JkSelf/spark/branches{/branch}","tags_url":"https://api.github.com/repos/JkSelf/spark/tags","blobs_url":"https://api.github.com/repos/JkSelf/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/JkSelf/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/JkSelf/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/JkSelf/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/JkSelf/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/JkSelf/spark/languages","stargazers_url":"https://api.github.com/repos/JkSelf/spark/stargazers","contributors_url":"https://api.github.com/repos/JkSelf/spark/contributors","subscribers_url":"https://api.github.com/repos/JkSelf/spark/subscribers","subscription_url":"https://api.github.com/repos/JkSelf/spark/subscription","commits_url":"https://api.github.com/repos/JkSelf/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/JkSelf/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/JkSelf/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/JkSelf/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/JkSelf/spark/contents/{+path}","compare_url":"https://api.github.com/repos/JkSelf/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/JkSelf/spark/merges","archive_url":"https://api.github.com/repos/JkSelf/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/JkSelf/spark/downloads","issues_url":"https://api.github.com/repos/JkSelf/spark/issues{/number}","pulls_url":"https://api.github.com/repos/JkSelf/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/JkSelf/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/JkSelf/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/JkSelf/spark/labels{/name}","releases_url":"https://api.github.com/repos/JkSelf/spark/releases{/id}","deployments_url":"https://api.github.com/repos/JkSelf/spark/deployments","created_at":"2018-11-29T08:40:39Z","updated_at":"2020-02-18T05:52:18Z","pushed_at":"2023-04-26T08:46:32Z","git_url":"git://github.com/JkSelf/spark.git","ssh_url":"git@github.com:JkSelf/spark.git","clone_url":"https://github.com/JkSelf/spark.git","svn_url":"https://github.com/JkSelf/spark","homepage":null,"size":400694,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"12a576f1759aabdcf37c5c841638428e1e33a591","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32861"},"html":{"href":"https://github.com/apache/spark/pull/32861"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32861"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32861/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32861/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32861/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ac56149ba63e399b4a96bb655681ea6d0dac0221"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32860","id":666700759,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NzAwNzU5","html_url":"https://github.com/apache/spark/pull/32860","diff_url":"https://github.com/apache/spark/pull/32860.diff","patch_url":"https://github.com/apache/spark/pull/32860.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32860","number":32860,"state":"closed","locked":false,"title":"[SPARK-35709][DOCS] Remove the reference to third party Nomad integration project","user":{"login":"pptaszynski","id":10886,"node_id":"MDQ6VXNlcjEwODg2","avatar_url":"https://avatars.githubusercontent.com/u/10886?v=4","gravatar_id":"","url":"https://api.github.com/users/pptaszynski","html_url":"https://github.com/pptaszynski","followers_url":"https://api.github.com/users/pptaszynski/followers","following_url":"https://api.github.com/users/pptaszynski/following{/other_user}","gists_url":"https://api.github.com/users/pptaszynski/gists{/gist_id}","starred_url":"https://api.github.com/users/pptaszynski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pptaszynski/subscriptions","organizations_url":"https://api.github.com/users/pptaszynski/orgs","repos_url":"https://api.github.com/users/pptaszynski/repos","events_url":"https://api.github.com/users/pptaszynski/events{/privacy}","received_events_url":"https://api.github.com/users/pptaszynski/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR updates documentation by removing reference to [hashicorp/nomad-spark](https://github.com/hashicorp/nomad-spark) which has been deprecated in April 2020, and will not be developed any longer.\r\n\r\n### Why are the changes needed?\r\nTo keep the documentation updated and remove confusion for potential users being interested in running with Nomad.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes. A change to the documentation. \r\n\r\n### How was this patch tested?\r\nGenerated to documentation, and checked everything is alright in the output. \r\n","created_at":"2021-06-10T09:28:08Z","updated_at":"2021-06-10T23:35:19Z","closed_at":"2021-06-10T23:35:13Z","merged_at":null,"merge_commit_sha":"4f101c290ff8ee1ae86753c2548d28088bd7d229","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32860/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32860/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32860/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2445f70e66c965309bcade9e20f6902e2aedb93f","head":{"label":"pptaszynski:doc/remove-spark-nomad-project-reference","ref":"doc/remove-spark-nomad-project-reference","sha":"2445f70e66c965309bcade9e20f6902e2aedb93f","user":{"login":"pptaszynski","id":10886,"node_id":"MDQ6VXNlcjEwODg2","avatar_url":"https://avatars.githubusercontent.com/u/10886?v=4","gravatar_id":"","url":"https://api.github.com/users/pptaszynski","html_url":"https://github.com/pptaszynski","followers_url":"https://api.github.com/users/pptaszynski/followers","following_url":"https://api.github.com/users/pptaszynski/following{/other_user}","gists_url":"https://api.github.com/users/pptaszynski/gists{/gist_id}","starred_url":"https://api.github.com/users/pptaszynski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pptaszynski/subscriptions","organizations_url":"https://api.github.com/users/pptaszynski/orgs","repos_url":"https://api.github.com/users/pptaszynski/repos","events_url":"https://api.github.com/users/pptaszynski/events{/privacy}","received_events_url":"https://api.github.com/users/pptaszynski/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":375621707,"node_id":"MDEwOlJlcG9zaXRvcnkzNzU2MjE3MDc=","name":"spark","full_name":"pptaszynski/spark","private":false,"owner":{"login":"pptaszynski","id":10886,"node_id":"MDQ6VXNlcjEwODg2","avatar_url":"https://avatars.githubusercontent.com/u/10886?v=4","gravatar_id":"","url":"https://api.github.com/users/pptaszynski","html_url":"https://github.com/pptaszynski","followers_url":"https://api.github.com/users/pptaszynski/followers","following_url":"https://api.github.com/users/pptaszynski/following{/other_user}","gists_url":"https://api.github.com/users/pptaszynski/gists{/gist_id}","starred_url":"https://api.github.com/users/pptaszynski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pptaszynski/subscriptions","organizations_url":"https://api.github.com/users/pptaszynski/orgs","repos_url":"https://api.github.com/users/pptaszynski/repos","events_url":"https://api.github.com/users/pptaszynski/events{/privacy}","received_events_url":"https://api.github.com/users/pptaszynski/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pptaszynski/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/pptaszynski/spark","forks_url":"https://api.github.com/repos/pptaszynski/spark/forks","keys_url":"https://api.github.com/repos/pptaszynski/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pptaszynski/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pptaszynski/spark/teams","hooks_url":"https://api.github.com/repos/pptaszynski/spark/hooks","issue_events_url":"https://api.github.com/repos/pptaszynski/spark/issues/events{/number}","events_url":"https://api.github.com/repos/pptaszynski/spark/events","assignees_url":"https://api.github.com/repos/pptaszynski/spark/assignees{/user}","branches_url":"https://api.github.com/repos/pptaszynski/spark/branches{/branch}","tags_url":"https://api.github.com/repos/pptaszynski/spark/tags","blobs_url":"https://api.github.com/repos/pptaszynski/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pptaszynski/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pptaszynski/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/pptaszynski/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pptaszynski/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/pptaszynski/spark/languages","stargazers_url":"https://api.github.com/repos/pptaszynski/spark/stargazers","contributors_url":"https://api.github.com/repos/pptaszynski/spark/contributors","subscribers_url":"https://api.github.com/repos/pptaszynski/spark/subscribers","subscription_url":"https://api.github.com/repos/pptaszynski/spark/subscription","commits_url":"https://api.github.com/repos/pptaszynski/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/pptaszynski/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/pptaszynski/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/pptaszynski/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/pptaszynski/spark/contents/{+path}","compare_url":"https://api.github.com/repos/pptaszynski/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pptaszynski/spark/merges","archive_url":"https://api.github.com/repos/pptaszynski/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pptaszynski/spark/downloads","issues_url":"https://api.github.com/repos/pptaszynski/spark/issues{/number}","pulls_url":"https://api.github.com/repos/pptaszynski/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/pptaszynski/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/pptaszynski/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pptaszynski/spark/labels{/name}","releases_url":"https://api.github.com/repos/pptaszynski/spark/releases{/id}","deployments_url":"https://api.github.com/repos/pptaszynski/spark/deployments","created_at":"2021-06-10T08:13:08Z","updated_at":"2021-06-10T08:13:10Z","pushed_at":"2021-06-10T08:30:32Z","git_url":"git://github.com/pptaszynski/spark.git","ssh_url":"git@github.com:pptaszynski/spark.git","clone_url":"https://github.com/pptaszynski/spark.git","svn_url":"https://github.com/pptaszynski/spark","homepage":"https://spark.apache.org/","size":374511,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5280f02747eed9849e4a64562d38aee11e21616f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32860"},"html":{"href":"https://github.com/apache/spark/pull/32860"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32860"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32860/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32860/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32860/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2445f70e66c965309bcade9e20f6902e2aedb93f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32859","id":666647291,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NjQ3Mjkx","html_url":"https://github.com/apache/spark/pull/32859","diff_url":"https://github.com/apache/spark/pull/32859.diff","patch_url":"https://github.com/apache/spark/pull/32859.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32859","number":32859,"state":"closed","locked":false,"title":"[SPARK-35708][PYTHON][TEST] Add BaseTest for DataTypeOps","user":{"login":"Yikun","id":1736354,"node_id":"MDQ6VXNlcjE3MzYzNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1736354?v=4","gravatar_id":"","url":"https://api.github.com/users/Yikun","html_url":"https://github.com/Yikun","followers_url":"https://api.github.com/users/Yikun/followers","following_url":"https://api.github.com/users/Yikun/following{/other_user}","gists_url":"https://api.github.com/users/Yikun/gists{/gist_id}","starred_url":"https://api.github.com/users/Yikun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Yikun/subscriptions","organizations_url":"https://api.github.com/users/Yikun/orgs","repos_url":"https://api.github.com/users/Yikun/repos","events_url":"https://api.github.com/users/Yikun/events{/privacy}","received_events_url":"https://api.github.com/users/Yikun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis patch adds DataTypeOps test to check the ops is loaded as expected. \r\n\r\n\r\n### Why are the changes needed?\r\nWhen complete https://github.com/apache/spark/pull/32821, I found there are no test for DataTypeOps. There were many logic when DataTypeOps loaded, it's better to add the test to make sure interface stable. \r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo, test only\r\n\r\n\r\n### How was this patch tested?\r\ntest passed.","created_at":"2021-06-10T08:25:20Z","updated_at":"2021-06-19T02:14:08Z","closed_at":"2021-06-19T01:54:59Z","merged_at":null,"merge_commit_sha":"3315ff9889e45ec938561619ce56f4ab32e4a538","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32859/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32859/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32859/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/22530f43ef9b4c44e141ae3349d6301d0ab4214e","head":{"label":"Yikun:SPARK-XXXXX1","ref":"SPARK-XXXXX1","sha":"22530f43ef9b4c44e141ae3349d6301d0ab4214e","user":{"login":"Yikun","id":1736354,"node_id":"MDQ6VXNlcjE3MzYzNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1736354?v=4","gravatar_id":"","url":"https://api.github.com/users/Yikun","html_url":"https://github.com/Yikun","followers_url":"https://api.github.com/users/Yikun/followers","following_url":"https://api.github.com/users/Yikun/following{/other_user}","gists_url":"https://api.github.com/users/Yikun/gists{/gist_id}","starred_url":"https://api.github.com/users/Yikun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Yikun/subscriptions","organizations_url":"https://api.github.com/users/Yikun/orgs","repos_url":"https://api.github.com/users/Yikun/repos","events_url":"https://api.github.com/users/Yikun/events{/privacy}","received_events_url":"https://api.github.com/users/Yikun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":335541670,"node_id":"MDEwOlJlcG9zaXRvcnkzMzU1NDE2NzA=","name":"spark","full_name":"Yikun/spark","private":false,"owner":{"login":"Yikun","id":1736354,"node_id":"MDQ6VXNlcjE3MzYzNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1736354?v=4","gravatar_id":"","url":"https://api.github.com/users/Yikun","html_url":"https://github.com/Yikun","followers_url":"https://api.github.com/users/Yikun/followers","following_url":"https://api.github.com/users/Yikun/following{/other_user}","gists_url":"https://api.github.com/users/Yikun/gists{/gist_id}","starred_url":"https://api.github.com/users/Yikun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Yikun/subscriptions","organizations_url":"https://api.github.com/users/Yikun/orgs","repos_url":"https://api.github.com/users/Yikun/repos","events_url":"https://api.github.com/users/Yikun/events{/privacy}","received_events_url":"https://api.github.com/users/Yikun/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Yikun/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/Yikun/spark","forks_url":"https://api.github.com/repos/Yikun/spark/forks","keys_url":"https://api.github.com/repos/Yikun/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Yikun/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Yikun/spark/teams","hooks_url":"https://api.github.com/repos/Yikun/spark/hooks","issue_events_url":"https://api.github.com/repos/Yikun/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Yikun/spark/events","assignees_url":"https://api.github.com/repos/Yikun/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Yikun/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Yikun/spark/tags","blobs_url":"https://api.github.com/repos/Yikun/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Yikun/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Yikun/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Yikun/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Yikun/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Yikun/spark/languages","stargazers_url":"https://api.github.com/repos/Yikun/spark/stargazers","contributors_url":"https://api.github.com/repos/Yikun/spark/contributors","subscribers_url":"https://api.github.com/repos/Yikun/spark/subscribers","subscription_url":"https://api.github.com/repos/Yikun/spark/subscription","commits_url":"https://api.github.com/repos/Yikun/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Yikun/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Yikun/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Yikun/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Yikun/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Yikun/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Yikun/spark/merges","archive_url":"https://api.github.com/repos/Yikun/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Yikun/spark/downloads","issues_url":"https://api.github.com/repos/Yikun/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Yikun/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Yikun/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Yikun/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Yikun/spark/labels{/name}","releases_url":"https://api.github.com/repos/Yikun/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Yikun/spark/deployments","created_at":"2021-02-03T07:25:58Z","updated_at":"2022-01-13T12:26:18Z","pushed_at":"2023-01-28T06:50:14Z","git_url":"git://github.com/Yikun/spark.git","ssh_url":"git@github.com:Yikun/spark.git","clone_url":"https://github.com/Yikun/spark.git","svn_url":"https://github.com/Yikun/spark","homepage":"https://spark.apache.org/","size":452564,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":1,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"c879510d2f66697d2e8b28554e4a6dc0782952b7","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32859"},"html":{"href":"https://github.com/apache/spark/pull/32859"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32859"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32859/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32859/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32859/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/22530f43ef9b4c44e141ae3349d6301d0ab4214e"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32858","id":666630786,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NjMwNzg2","html_url":"https://github.com/apache/spark/pull/32858","diff_url":"https://github.com/apache/spark/pull/32858.diff","patch_url":"https://github.com/apache/spark/pull/32858.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32858","number":32858,"state":"closed","locked":false,"title":"[SPARK-35706][SQL] Consider making the ':' in STRUCT data type definition optional","user":{"login":"jerqi","id":8159038,"node_id":"MDQ6VXNlcjgxNTkwMzg=","avatar_url":"https://avatars.githubusercontent.com/u/8159038?v=4","gravatar_id":"","url":"https://api.github.com/users/jerqi","html_url":"https://github.com/jerqi","followers_url":"https://api.github.com/users/jerqi/followers","following_url":"https://api.github.com/users/jerqi/following{/other_user}","gists_url":"https://api.github.com/users/jerqi/gists{/gist_id}","starred_url":"https://api.github.com/users/jerqi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerqi/subscriptions","organizations_url":"https://api.github.com/users/jerqi/orgs","repos_url":"https://api.github.com/users/jerqi/repos","events_url":"https://api.github.com/users/jerqi/events{/privacy}","received_events_url":"https://api.github.com/users/jerqi/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThe STRUCT type syntax is defined like this:\r\n\r\nSTRUCT(fieldNmae: fileType [NOT NULL][COMMENT stringLiteral][,.....])\r\n\r\nSo the field list is nearly the same as a column list\r\n\r\nif we could make ':' optional it would be so much cleaner an less proprietary\r\n\r\n\r\n### Why are the changes needed?\r\nease of use\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes, you can use Struct type list is nearly the same as a column list\r\n\r\n\r\n### How was this patch tested?\r\nunit tests\r\n","created_at":"2021-06-10T08:05:02Z","updated_at":"2021-06-11T20:08:07Z","closed_at":"2021-06-11T12:58:50Z","merged_at":null,"merge_commit_sha":"8f847e8bb2efa976a5cef33d2f22c673f78e47e3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32858/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32858/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32858/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b2aab4bee66baf1f1f17feb1a4df8334951cfccf","head":{"label":"jerqi:master","ref":"master","sha":"b2aab4bee66baf1f1f17feb1a4df8334951cfccf","user":{"login":"jerqi","id":8159038,"node_id":"MDQ6VXNlcjgxNTkwMzg=","avatar_url":"https://avatars.githubusercontent.com/u/8159038?v=4","gravatar_id":"","url":"https://api.github.com/users/jerqi","html_url":"https://github.com/jerqi","followers_url":"https://api.github.com/users/jerqi/followers","following_url":"https://api.github.com/users/jerqi/following{/other_user}","gists_url":"https://api.github.com/users/jerqi/gists{/gist_id}","starred_url":"https://api.github.com/users/jerqi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerqi/subscriptions","organizations_url":"https://api.github.com/users/jerqi/orgs","repos_url":"https://api.github.com/users/jerqi/repos","events_url":"https://api.github.com/users/jerqi/events{/privacy}","received_events_url":"https://api.github.com/users/jerqi/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":252618553,"node_id":"MDEwOlJlcG9zaXRvcnkyNTI2MTg1NTM=","name":"spark","full_name":"jerqi/spark","private":false,"owner":{"login":"jerqi","id":8159038,"node_id":"MDQ6VXNlcjgxNTkwMzg=","avatar_url":"https://avatars.githubusercontent.com/u/8159038?v=4","gravatar_id":"","url":"https://api.github.com/users/jerqi","html_url":"https://github.com/jerqi","followers_url":"https://api.github.com/users/jerqi/followers","following_url":"https://api.github.com/users/jerqi/following{/other_user}","gists_url":"https://api.github.com/users/jerqi/gists{/gist_id}","starred_url":"https://api.github.com/users/jerqi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerqi/subscriptions","organizations_url":"https://api.github.com/users/jerqi/orgs","repos_url":"https://api.github.com/users/jerqi/repos","events_url":"https://api.github.com/users/jerqi/events{/privacy}","received_events_url":"https://api.github.com/users/jerqi/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/jerqi/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/jerqi/spark","forks_url":"https://api.github.com/repos/jerqi/spark/forks","keys_url":"https://api.github.com/repos/jerqi/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/jerqi/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/jerqi/spark/teams","hooks_url":"https://api.github.com/repos/jerqi/spark/hooks","issue_events_url":"https://api.github.com/repos/jerqi/spark/issues/events{/number}","events_url":"https://api.github.com/repos/jerqi/spark/events","assignees_url":"https://api.github.com/repos/jerqi/spark/assignees{/user}","branches_url":"https://api.github.com/repos/jerqi/spark/branches{/branch}","tags_url":"https://api.github.com/repos/jerqi/spark/tags","blobs_url":"https://api.github.com/repos/jerqi/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/jerqi/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/jerqi/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/jerqi/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/jerqi/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/jerqi/spark/languages","stargazers_url":"https://api.github.com/repos/jerqi/spark/stargazers","contributors_url":"https://api.github.com/repos/jerqi/spark/contributors","subscribers_url":"https://api.github.com/repos/jerqi/spark/subscribers","subscription_url":"https://api.github.com/repos/jerqi/spark/subscription","commits_url":"https://api.github.com/repos/jerqi/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/jerqi/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/jerqi/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/jerqi/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/jerqi/spark/contents/{+path}","compare_url":"https://api.github.com/repos/jerqi/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/jerqi/spark/merges","archive_url":"https://api.github.com/repos/jerqi/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/jerqi/spark/downloads","issues_url":"https://api.github.com/repos/jerqi/spark/issues{/number}","pulls_url":"https://api.github.com/repos/jerqi/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/jerqi/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/jerqi/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/jerqi/spark/labels{/name}","releases_url":"https://api.github.com/repos/jerqi/spark/releases{/id}","deployments_url":"https://api.github.com/repos/jerqi/spark/deployments","created_at":"2020-04-03T02:56:42Z","updated_at":"2021-11-09T06:33:00Z","pushed_at":"2023-03-10T04:15:11Z","git_url":"git://github.com/jerqi/spark.git","ssh_url":"git@github.com:jerqi/spark.git","clone_url":"https://github.com/jerqi/spark.git","svn_url":"https://github.com/jerqi/spark","homepage":"","size":409706,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"e9af4576d5463f53fd431d2d59e49991f3c9b287","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32858"},"html":{"href":"https://github.com/apache/spark/pull/32858"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32858"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32858/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32858/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32858/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b2aab4bee66baf1f1f17feb1a4df8334951cfccf"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32857","id":666580679,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NTgwNjc5","html_url":"https://github.com/apache/spark/pull/32857","diff_url":"https://github.com/apache/spark/pull/32857.diff","patch_url":"https://github.com/apache/spark/pull/32857.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32857","number":32857,"state":"closed","locked":false,"title":"[SPARK-35707][ML] optimize sparse GEMM by skipping bound checking","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nSparse gemm use mothod `DenseMatrix.apply` to access the values, which can be optimized by skipping checking the bound and `isTransposed`\r\n\r\n```\r\n  override def apply(i: Int, j: Int): Double = values(index(i, j))\r\n\r\n  private[ml] def index(i: Int, j: Int): Int = {\r\n    require(i >= 0 && i < numRows, s\"Expected 0 <= i < $numRows, got i = $i.\")\r\n    require(j >= 0 && j < numCols, s\"Expected 0 <= j < $numCols, got j = $j.\")\r\n    if (!isTransposed) i + numRows * j else j + numCols * i\r\n  }\r\n\r\n```\r\n\r\n\r\n### Why are the changes needed?\r\nto improve performance, about 15% faster in the designed case\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nexisting testsuite and additional performance test\r\n","created_at":"2021-06-10T06:56:07Z","updated_at":"2021-06-16T00:58:17Z","closed_at":"2021-06-16T00:57:48Z","merged_at":null,"merge_commit_sha":"19afd3af1707bb7447b2c9e0ea3c2abe01306250","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801475,"node_id":"MDU6TGFiZWwxNDA1ODAxNDc1","url":"https://api.github.com/repos/apache/spark/labels/ML","name":"ML","color":"ededed","default":false,"description":null},{"id":1405803268,"node_id":"MDU6TGFiZWwxNDA1ODAzMjY4","url":"https://api.github.com/repos/apache/spark/labels/MLLIB","name":"MLLIB","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32857/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32857/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32857/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7e8f195fc056ce39b5032fb85706615ada1f66c4","head":{"label":"zhengruifeng:gemm_opt_index","ref":"gemm_opt_index","sha":"7e8f195fc056ce39b5032fb85706615ada1f66c4","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"cadd3a0588eeed42c6742ae1b7a2eaa85bd8a3af","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32857"},"html":{"href":"https://github.com/apache/spark/pull/32857"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32857"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32857/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32857/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32857/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7e8f195fc056ce39b5032fb85706615ada1f66c4"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32856","id":666562137,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NTYyMTM3","html_url":"https://github.com/apache/spark/pull/32856","diff_url":"https://github.com/apache/spark/pull/32856.diff","patch_url":"https://github.com/apache/spark/pull/32856.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32856","number":32856,"state":"closed","locked":false,"title":"[SPARK-35706][SQL]Consider making the ':' in STRUCT data type definition optional","user":{"login":"jerqi","id":8159038,"node_id":"MDQ6VXNlcjgxNTkwMzg=","avatar_url":"https://avatars.githubusercontent.com/u/8159038?v=4","gravatar_id":"","url":"https://api.github.com/users/jerqi","html_url":"https://github.com/jerqi","followers_url":"https://api.github.com/users/jerqi/followers","following_url":"https://api.github.com/users/jerqi/following{/other_user}","gists_url":"https://api.github.com/users/jerqi/gists{/gist_id}","starred_url":"https://api.github.com/users/jerqi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerqi/subscriptions","organizations_url":"https://api.github.com/users/jerqi/orgs","repos_url":"https://api.github.com/users/jerqi/repos","events_url":"https://api.github.com/users/jerqi/events{/privacy}","received_events_url":"https://api.github.com/users/jerqi/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThe STRUCT type syntax is defined like this:\r\n\r\nSTRUCT(fieldNmae: fileType [NOT NULL][COMMENT stringLiteral][,.....])\r\n\r\nSo the field list is NEARLY the same as a column list\r\n\r\nif we could make ':' optional it would be so much cleaner an less proprietary\r\n\r\n\r\n### Why are the changes needed?\r\nease of use\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nunit tests\r\n","created_at":"2021-06-10T06:31:01Z","updated_at":"2021-06-10T06:32:43Z","closed_at":"2021-06-10T06:32:43Z","merged_at":null,"merge_commit_sha":"5d2a177d974ba0051add496faec8fbc38e51a97a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32856/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32856/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32856/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e212995d392f3f76f20882e6d5bd187f0e4bad67","head":{"label":"jerqi:master","ref":"master","sha":"e212995d392f3f76f20882e6d5bd187f0e4bad67","user":{"login":"jerqi","id":8159038,"node_id":"MDQ6VXNlcjgxNTkwMzg=","avatar_url":"https://avatars.githubusercontent.com/u/8159038?v=4","gravatar_id":"","url":"https://api.github.com/users/jerqi","html_url":"https://github.com/jerqi","followers_url":"https://api.github.com/users/jerqi/followers","following_url":"https://api.github.com/users/jerqi/following{/other_user}","gists_url":"https://api.github.com/users/jerqi/gists{/gist_id}","starred_url":"https://api.github.com/users/jerqi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerqi/subscriptions","organizations_url":"https://api.github.com/users/jerqi/orgs","repos_url":"https://api.github.com/users/jerqi/repos","events_url":"https://api.github.com/users/jerqi/events{/privacy}","received_events_url":"https://api.github.com/users/jerqi/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":252618553,"node_id":"MDEwOlJlcG9zaXRvcnkyNTI2MTg1NTM=","name":"spark","full_name":"jerqi/spark","private":false,"owner":{"login":"jerqi","id":8159038,"node_id":"MDQ6VXNlcjgxNTkwMzg=","avatar_url":"https://avatars.githubusercontent.com/u/8159038?v=4","gravatar_id":"","url":"https://api.github.com/users/jerqi","html_url":"https://github.com/jerqi","followers_url":"https://api.github.com/users/jerqi/followers","following_url":"https://api.github.com/users/jerqi/following{/other_user}","gists_url":"https://api.github.com/users/jerqi/gists{/gist_id}","starred_url":"https://api.github.com/users/jerqi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerqi/subscriptions","organizations_url":"https://api.github.com/users/jerqi/orgs","repos_url":"https://api.github.com/users/jerqi/repos","events_url":"https://api.github.com/users/jerqi/events{/privacy}","received_events_url":"https://api.github.com/users/jerqi/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/jerqi/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/jerqi/spark","forks_url":"https://api.github.com/repos/jerqi/spark/forks","keys_url":"https://api.github.com/repos/jerqi/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/jerqi/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/jerqi/spark/teams","hooks_url":"https://api.github.com/repos/jerqi/spark/hooks","issue_events_url":"https://api.github.com/repos/jerqi/spark/issues/events{/number}","events_url":"https://api.github.com/repos/jerqi/spark/events","assignees_url":"https://api.github.com/repos/jerqi/spark/assignees{/user}","branches_url":"https://api.github.com/repos/jerqi/spark/branches{/branch}","tags_url":"https://api.github.com/repos/jerqi/spark/tags","blobs_url":"https://api.github.com/repos/jerqi/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/jerqi/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/jerqi/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/jerqi/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/jerqi/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/jerqi/spark/languages","stargazers_url":"https://api.github.com/repos/jerqi/spark/stargazers","contributors_url":"https://api.github.com/repos/jerqi/spark/contributors","subscribers_url":"https://api.github.com/repos/jerqi/spark/subscribers","subscription_url":"https://api.github.com/repos/jerqi/spark/subscription","commits_url":"https://api.github.com/repos/jerqi/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/jerqi/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/jerqi/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/jerqi/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/jerqi/spark/contents/{+path}","compare_url":"https://api.github.com/repos/jerqi/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/jerqi/spark/merges","archive_url":"https://api.github.com/repos/jerqi/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/jerqi/spark/downloads","issues_url":"https://api.github.com/repos/jerqi/spark/issues{/number}","pulls_url":"https://api.github.com/repos/jerqi/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/jerqi/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/jerqi/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/jerqi/spark/labels{/name}","releases_url":"https://api.github.com/repos/jerqi/spark/releases{/id}","deployments_url":"https://api.github.com/repos/jerqi/spark/deployments","created_at":"2020-04-03T02:56:42Z","updated_at":"2021-11-09T06:33:00Z","pushed_at":"2023-03-10T04:15:11Z","git_url":"git://github.com/jerqi/spark.git","ssh_url":"git@github.com:jerqi/spark.git","clone_url":"https://github.com/jerqi/spark.git","svn_url":"https://github.com/jerqi/spark","homepage":"","size":409706,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"cadd3a0588eeed42c6742ae1b7a2eaa85bd8a3af","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32856"},"html":{"href":"https://github.com/apache/spark/pull/32856"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32856"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32856/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32856/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32856/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e212995d392f3f76f20882e6d5bd187f0e4bad67"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32855","id":666556701,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NTU2NzAx","html_url":"https://github.com/apache/spark/pull/32855","diff_url":"https://github.com/apache/spark/pull/32855.diff","patch_url":"https://github.com/apache/spark/pull/32855.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32855","number":32855,"state":"closed","locked":false,"title":"[SPARK-34524][SQL][FOLLOWUP] Remove unused checkAlterTablePartition in CheckAnalysis.scala","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n#31637 removed the usage of `CheckAnalysis.checkAlterTablePartition` but didn't remove the function.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo removed an unused function.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nExisting tests.","created_at":"2021-06-10T06:23:57Z","updated_at":"2021-06-10T12:43:32Z","closed_at":"2021-06-10T12:43:32Z","merged_at":null,"merge_commit_sha":"0b2a897e7dfbe2997363075bc93ea2cdeeffd6a8","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32855/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32855/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32855/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/470ff350f42707f3061d9bfb23e0649fe78f6506","head":{"label":"imback82:SPARK-34524-followup","ref":"SPARK-34524-followup","sha":"470ff350f42707f3061d9bfb23e0649fe78f6506","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":190453549,"node_id":"MDEwOlJlcG9zaXRvcnkxOTA0NTM1NDk=","name":"spark-4","full_name":"imback82/spark-4","private":false,"owner":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/imback82/spark-4","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/imback82/spark-4","forks_url":"https://api.github.com/repos/imback82/spark-4/forks","keys_url":"https://api.github.com/repos/imback82/spark-4/keys{/key_id}","collaborators_url":"https://api.github.com/repos/imback82/spark-4/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/imback82/spark-4/teams","hooks_url":"https://api.github.com/repos/imback82/spark-4/hooks","issue_events_url":"https://api.github.com/repos/imback82/spark-4/issues/events{/number}","events_url":"https://api.github.com/repos/imback82/spark-4/events","assignees_url":"https://api.github.com/repos/imback82/spark-4/assignees{/user}","branches_url":"https://api.github.com/repos/imback82/spark-4/branches{/branch}","tags_url":"https://api.github.com/repos/imback82/spark-4/tags","blobs_url":"https://api.github.com/repos/imback82/spark-4/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/imback82/spark-4/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/imback82/spark-4/git/refs{/sha}","trees_url":"https://api.github.com/repos/imback82/spark-4/git/trees{/sha}","statuses_url":"https://api.github.com/repos/imback82/spark-4/statuses/{sha}","languages_url":"https://api.github.com/repos/imback82/spark-4/languages","stargazers_url":"https://api.github.com/repos/imback82/spark-4/stargazers","contributors_url":"https://api.github.com/repos/imback82/spark-4/contributors","subscribers_url":"https://api.github.com/repos/imback82/spark-4/subscribers","subscription_url":"https://api.github.com/repos/imback82/spark-4/subscription","commits_url":"https://api.github.com/repos/imback82/spark-4/commits{/sha}","git_commits_url":"https://api.github.com/repos/imback82/spark-4/git/commits{/sha}","comments_url":"https://api.github.com/repos/imback82/spark-4/comments{/number}","issue_comment_url":"https://api.github.com/repos/imback82/spark-4/issues/comments{/number}","contents_url":"https://api.github.com/repos/imback82/spark-4/contents/{+path}","compare_url":"https://api.github.com/repos/imback82/spark-4/compare/{base}...{head}","merges_url":"https://api.github.com/repos/imback82/spark-4/merges","archive_url":"https://api.github.com/repos/imback82/spark-4/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/imback82/spark-4/downloads","issues_url":"https://api.github.com/repos/imback82/spark-4/issues{/number}","pulls_url":"https://api.github.com/repos/imback82/spark-4/pulls{/number}","milestones_url":"https://api.github.com/repos/imback82/spark-4/milestones{/number}","notifications_url":"https://api.github.com/repos/imback82/spark-4/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/imback82/spark-4/labels{/name}","releases_url":"https://api.github.com/repos/imback82/spark-4/releases{/id}","deployments_url":"https://api.github.com/repos/imback82/spark-4/deployments","created_at":"2019-06-05T19:09:03Z","updated_at":"2022-01-05T16:28:23Z","pushed_at":"2024-02-20T02:09:15Z","git_url":"git://github.com/imback82/spark-4.git","ssh_url":"git@github.com:imback82/spark-4.git","clone_url":"https://github.com/imback82/spark-4.git","svn_url":"https://github.com/imback82/spark-4","homepage":"","size":412962,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"cadd3a0588eeed42c6742ae1b7a2eaa85bd8a3af","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32855"},"html":{"href":"https://github.com/apache/spark/pull/32855"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32855"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32855/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32855/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32855/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/470ff350f42707f3061d9bfb23e0649fe78f6506"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32854","id":666544550,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NTQ0NTUw","html_url":"https://github.com/apache/spark/pull/32854","diff_url":"https://github.com/apache/spark/pull/32854.diff","patch_url":"https://github.com/apache/spark/pull/32854.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32854","number":32854,"state":"closed","locked":false,"title":"[SPARK-34320][SQL] Migrate ALTER TABLE DROP COLUMNS commands to use UnresolvedTable to resolve the identifier","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR proposes to migrate the following `ALTER TABLE ... DROP COLUMNS` command to use `UnresolvedTable` as a `child` to resolve the table identifier. This allows consistent resolution rules (temp view first, etc.) to be applied for both v1/v2 commands. More info about the consistent resolution rule proposal can be found in [JIRA](https://issues.apache.org/jira/browse/SPARK-29900) or [proposal doc](https://docs.google.com/document/d/1hvLjGA8y_W_hhilpngXVub1Ebv8RsMap986nENCFnrg/edit?usp=sharing).\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nThis is a part of effort to make the relation lookup behavior consistent: [SPARK-29900](https://issues.apache.org/jira/browse/SPARK-29900).\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nAfter this PR, the above `ALTER TABLE ... DROP COLUMNS` commands will have a consistent resolution behavior.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUpdated existing tests.\r\n","created_at":"2021-06-10T06:06:15Z","updated_at":"2021-06-24T14:59:38Z","closed_at":"2021-06-24T14:59:38Z","merged_at":null,"merge_commit_sha":"4ac6017454831db24e77b0edcd98798d4545c948","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32854/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32854/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32854/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c9c545b559c69c3ddee408588b1ada341f7b3ae9","head":{"label":"imback82:alter_alternative","ref":"alter_alternative","sha":"c9c545b559c69c3ddee408588b1ada341f7b3ae9","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":190453549,"node_id":"MDEwOlJlcG9zaXRvcnkxOTA0NTM1NDk=","name":"spark-4","full_name":"imback82/spark-4","private":false,"owner":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/imback82/spark-4","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/imback82/spark-4","forks_url":"https://api.github.com/repos/imback82/spark-4/forks","keys_url":"https://api.github.com/repos/imback82/spark-4/keys{/key_id}","collaborators_url":"https://api.github.com/repos/imback82/spark-4/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/imback82/spark-4/teams","hooks_url":"https://api.github.com/repos/imback82/spark-4/hooks","issue_events_url":"https://api.github.com/repos/imback82/spark-4/issues/events{/number}","events_url":"https://api.github.com/repos/imback82/spark-4/events","assignees_url":"https://api.github.com/repos/imback82/spark-4/assignees{/user}","branches_url":"https://api.github.com/repos/imback82/spark-4/branches{/branch}","tags_url":"https://api.github.com/repos/imback82/spark-4/tags","blobs_url":"https://api.github.com/repos/imback82/spark-4/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/imback82/spark-4/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/imback82/spark-4/git/refs{/sha}","trees_url":"https://api.github.com/repos/imback82/spark-4/git/trees{/sha}","statuses_url":"https://api.github.com/repos/imback82/spark-4/statuses/{sha}","languages_url":"https://api.github.com/repos/imback82/spark-4/languages","stargazers_url":"https://api.github.com/repos/imback82/spark-4/stargazers","contributors_url":"https://api.github.com/repos/imback82/spark-4/contributors","subscribers_url":"https://api.github.com/repos/imback82/spark-4/subscribers","subscription_url":"https://api.github.com/repos/imback82/spark-4/subscription","commits_url":"https://api.github.com/repos/imback82/spark-4/commits{/sha}","git_commits_url":"https://api.github.com/repos/imback82/spark-4/git/commits{/sha}","comments_url":"https://api.github.com/repos/imback82/spark-4/comments{/number}","issue_comment_url":"https://api.github.com/repos/imback82/spark-4/issues/comments{/number}","contents_url":"https://api.github.com/repos/imback82/spark-4/contents/{+path}","compare_url":"https://api.github.com/repos/imback82/spark-4/compare/{base}...{head}","merges_url":"https://api.github.com/repos/imback82/spark-4/merges","archive_url":"https://api.github.com/repos/imback82/spark-4/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/imback82/spark-4/downloads","issues_url":"https://api.github.com/repos/imback82/spark-4/issues{/number}","pulls_url":"https://api.github.com/repos/imback82/spark-4/pulls{/number}","milestones_url":"https://api.github.com/repos/imback82/spark-4/milestones{/number}","notifications_url":"https://api.github.com/repos/imback82/spark-4/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/imback82/spark-4/labels{/name}","releases_url":"https://api.github.com/repos/imback82/spark-4/releases{/id}","deployments_url":"https://api.github.com/repos/imback82/spark-4/deployments","created_at":"2019-06-05T19:09:03Z","updated_at":"2022-01-05T16:28:23Z","pushed_at":"2024-02-20T02:09:15Z","git_url":"git://github.com/imback82/spark-4.git","ssh_url":"git@github.com:imback82/spark-4.git","clone_url":"https://github.com/imback82/spark-4.git","svn_url":"https://github.com/imback82/spark-4","homepage":"","size":412962,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"077cf2acdbeaf24081972142c1b9bc23d2f45b01","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32854"},"html":{"href":"https://github.com/apache/spark/pull/32854"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32854"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32854/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32854/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32854/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c9c545b559c69c3ddee408588b1ada341f7b3ae9"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32853","id":666511563,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NTExNTYz","html_url":"https://github.com/apache/spark/pull/32853","diff_url":"https://github.com/apache/spark/pull/32853.diff","patch_url":"https://github.com/apache/spark/pull/32853.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32853","number":32853,"state":"closed","locked":false,"title":"[SPARK-35683][PYTHON] Fix Index.difference to avoid collect 'other' to driver side","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR fix the wrong behavior of `Index.difference` in pandas APIs on Spark, based on the comment https://github.com/databricks/koalas/pull/1325#discussion_r647889901 and https://github.com/databricks/koalas/pull/1325#discussion_r647890007\r\n- it couldn't handle the case properly when `self` is `Index` or `MultiIndex` and `other` is `MultiIndex` or `Index`.\r\n```python\r\n>>> midx1 = ps.MultiIndex.from_tuples([('a', 'x', 1), ('b', 'z', 2), ('k', 'z', 3)])\r\n>>> idx1 = ps.Index([1, 2, 3])\r\n>>> midx1 = ps.MultiIndex.from_tuples([('a', 'x', 1), ('b', 'z', 2), ('k', 'z', 3)])\r\n>>> midx1.difference(idx1)\r\npyspark.pandas.exceptions.PandasNotImplementedError: The method `pd.Index.__iter__()` is not implemented. If you want to collect your data as an NumPy array, use 'to_numpy()' instead.\r\n```\r\n- it's collecting the all data into the driver side when the other is list-like objects, especially when the `other` is distributed object such as Series which is very dangerous.\r\n\r\nAnd added the related test cases.\r\n\r\n### Why are the changes needed?\r\n\r\nTo correct the incompatible behavior with pandas, and to prevent the case which potentially cause the OOM easily.\r\n\r\n```python\r\n>>> midx1 = ps.MultiIndex.from_tuples([('a', 'x', 1), ('b', 'z', 2), ('k', 'z', 3)])\r\n>>> idx1 = ps.Index([1, 2, 3])\r\n>>> midx1 = ps.MultiIndex.from_tuples([('a', 'x', 1), ('b', 'z', 2), ('k', 'z', 3)])\r\n>>> midx1.difference(idx1)\r\nMultiIndex([('a', 'x', 1),\r\n            ('b', 'z', 2),\r\n            ('k', 'z', 3)],\r\n           )\r\n```\r\n\r\nAnd now it only using the for loop when the `other` is only the case `list`, `set` or `dict`.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, the previous bug is fixed as described in the above code examples.\r\n\r\n\r\n### How was this patch tested?\r\n\r\nManually tested with linter and unittest in local, and it might be passed on CI.\r\n","created_at":"2021-06-10T05:08:25Z","updated_at":"2021-06-15T05:59:09Z","closed_at":"2021-06-15T05:19:01Z","merged_at":null,"merge_commit_sha":"c9eb915784607e3989fa353217dc24ef6e2c676a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32853/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32853/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32853/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/831ceb7974dafed8ca549d551cae6b4bdfed79fe","head":{"label":"itholic:SPARK-35683","ref":"SPARK-35683","sha":"831ceb7974dafed8ca549d551cae6b4bdfed79fe","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"8dde20a993c895a5960f66a066684f224116958b","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32853"},"html":{"href":"https://github.com/apache/spark/pull/32853"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32853"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32853/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32853/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32853/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/831ceb7974dafed8ca549d551cae6b4bdfed79fe"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32852","id":666451652,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2NDUxNjUy","html_url":"https://github.com/apache/spark/pull/32852","diff_url":"https://github.com/apache/spark/pull/32852.diff","patch_url":"https://github.com/apache/spark/pull/32852.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32852","number":32852,"state":"closed","locked":false,"title":"[SPARK-35283][SQL] Support query some DDL with CTES","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nSome command used to display metadata, such as: `SHOW TABLES`, `SHOW TABLE EXTENDED`,`SHOW TBLPROPERTIES` and so no.\r\nIf the output rows much than screen height, the output very unfriendly to developers.\r\nSo we should have a way to filter the output like the behavior of\r\n`WITH s AS (SHOW NAMESPACES) SELECT * FROM s WHERE namespace = 'query_ddl_namespace';`\r\n\r\nhttps://github.com/apache/spark/pull/32513 replace commands with something like local relation that produces unsafe rows, so can be more plan nodes above commands.\r\n\r\n\r\n### Why are the changes needed?\r\nThis PR provides a better way to display DDL when output rows much than screen height.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n'Yes'. A new syntax.\r\n\r\n\r\n### How was this patch tested?\r\nNew tests.\r\n","created_at":"2021-06-10T02:52:43Z","updated_at":"2021-09-28T00:09:43Z","closed_at":"2021-09-28T00:09:43Z","merged_at":null,"merge_commit_sha":"646a7f6a2cf0e1e1959bfdbb17f4b7422356b97a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32852/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32852/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32852/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f5dd0330eb3b918e076dfd2a1022c93b47b52861","head":{"label":"beliefer:SPARK-35283-new","ref":"SPARK-35283-new","sha":"f5dd0330eb3b918e076dfd2a1022c93b47b52861","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":237617513,"node_id":"MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=","name":"spark","full_name":"beliefer/spark","private":false,"owner":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/beliefer/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/beliefer/spark","forks_url":"https://api.github.com/repos/beliefer/spark/forks","keys_url":"https://api.github.com/repos/beliefer/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/beliefer/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/beliefer/spark/teams","hooks_url":"https://api.github.com/repos/beliefer/spark/hooks","issue_events_url":"https://api.github.com/repos/beliefer/spark/issues/events{/number}","events_url":"https://api.github.com/repos/beliefer/spark/events","assignees_url":"https://api.github.com/repos/beliefer/spark/assignees{/user}","branches_url":"https://api.github.com/repos/beliefer/spark/branches{/branch}","tags_url":"https://api.github.com/repos/beliefer/spark/tags","blobs_url":"https://api.github.com/repos/beliefer/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/beliefer/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/beliefer/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/beliefer/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/beliefer/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/beliefer/spark/languages","stargazers_url":"https://api.github.com/repos/beliefer/spark/stargazers","contributors_url":"https://api.github.com/repos/beliefer/spark/contributors","subscribers_url":"https://api.github.com/repos/beliefer/spark/subscribers","subscription_url":"https://api.github.com/repos/beliefer/spark/subscription","commits_url":"https://api.github.com/repos/beliefer/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/beliefer/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/beliefer/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/beliefer/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/beliefer/spark/contents/{+path}","compare_url":"https://api.github.com/repos/beliefer/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/beliefer/spark/merges","archive_url":"https://api.github.com/repos/beliefer/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/beliefer/spark/downloads","issues_url":"https://api.github.com/repos/beliefer/spark/issues{/number}","pulls_url":"https://api.github.com/repos/beliefer/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/beliefer/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/beliefer/spark/labels{/name}","releases_url":"https://api.github.com/repos/beliefer/spark/releases{/id}","deployments_url":"https://api.github.com/repos/beliefer/spark/deployments","created_at":"2020-02-01T13:17:08Z","updated_at":"2025-01-28T09:45:49Z","pushed_at":"2025-01-28T11:57:29Z","git_url":"git://github.com/beliefer/spark.git","ssh_url":"git@github.com:beliefer/spark.git","clone_url":"https://github.com/beliefer/spark.git","svn_url":"https://github.com/beliefer/spark","homepage":"","size":488033,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7e99b65295ec0234d463fcd5e858a8d1a4dd5c36","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32852"},"html":{"href":"https://github.com/apache/spark/pull/32852"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32852"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32852/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32852/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32852/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f5dd0330eb3b918e076dfd2a1022c93b47b52861"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32851","id":666364174,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2MzY0MTc0","html_url":"https://github.com/apache/spark/pull/32851","diff_url":"https://github.com/apache/spark/pull/32851.diff","patch_url":"https://github.com/apache/spark/pull/32851.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32851","number":32851,"state":"closed","locked":false,"title":"[SPARK-35705][PYTHON] Adjust pandas-on-spark `test_groupby_multiindex_columns` test for different pandas versions","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nAdjust pandas-on-spark test_groupby_multiindex_columns test in order to pass with different pandas versions.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\npandas had introduced bugs as below:\r\n\r\n- For pandas 1.1.3 and 1.1.4\r\nType error: only integer scalar arrays can be converted to a scalar index\r\n\r\n- For pandas < 1.0.4\r\nType error: Can only tuple-index with a MultiIndex\r\n\r\nWe ought to adjust `test_groupby_multiindex_columns` tests by comparing with a predefined return value, rather than comparing with the pandas return value in the pandas versions above.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit tests.","created_at":"2021-06-09T22:56:56Z","updated_at":"2021-06-10T01:44:08Z","closed_at":"2021-06-10T01:36:30Z","merged_at":null,"merge_commit_sha":"57951baf0084f38fba3ca61940ff733d88009e60","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32851/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32851/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32851/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/43b30bd76b16a496cb8f05e395d452c5c4b0735c","head":{"label":"xinrong-meng:SPARK-35705","ref":"SPARK-35705","sha":"43b30bd76b16a496cb8f05e395d452c5c4b0735c","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":335786381,"node_id":"MDEwOlJlcG9zaXRvcnkzMzU3ODYzODE=","name":"spark","full_name":"xinrong-meng/spark","private":false,"owner":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xinrong-meng/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xinrong-meng/spark","forks_url":"https://api.github.com/repos/xinrong-meng/spark/forks","keys_url":"https://api.github.com/repos/xinrong-meng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xinrong-meng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xinrong-meng/spark/teams","hooks_url":"https://api.github.com/repos/xinrong-meng/spark/hooks","issue_events_url":"https://api.github.com/repos/xinrong-meng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xinrong-meng/spark/events","assignees_url":"https://api.github.com/repos/xinrong-meng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xinrong-meng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xinrong-meng/spark/tags","blobs_url":"https://api.github.com/repos/xinrong-meng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xinrong-meng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xinrong-meng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xinrong-meng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xinrong-meng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xinrong-meng/spark/languages","stargazers_url":"https://api.github.com/repos/xinrong-meng/spark/stargazers","contributors_url":"https://api.github.com/repos/xinrong-meng/spark/contributors","subscribers_url":"https://api.github.com/repos/xinrong-meng/spark/subscribers","subscription_url":"https://api.github.com/repos/xinrong-meng/spark/subscription","commits_url":"https://api.github.com/repos/xinrong-meng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xinrong-meng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xinrong-meng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xinrong-meng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xinrong-meng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xinrong-meng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xinrong-meng/spark/merges","archive_url":"https://api.github.com/repos/xinrong-meng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xinrong-meng/spark/downloads","issues_url":"https://api.github.com/repos/xinrong-meng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xinrong-meng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xinrong-meng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xinrong-meng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xinrong-meng/spark/labels{/name}","releases_url":"https://api.github.com/repos/xinrong-meng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xinrong-meng/spark/deployments","created_at":"2021-02-03T23:47:29Z","updated_at":"2024-09-27T08:09:06Z","pushed_at":"2025-02-08T02:14:33Z","git_url":"git://github.com/xinrong-meng/spark.git","ssh_url":"git@github.com:xinrong-meng/spark.git","clone_url":"https://github.com/xinrong-meng/spark.git","svn_url":"https://github.com/xinrong-meng/spark","homepage":"https://spark.apache.org/","size":469811,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":2,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"3c66c11aa60f43f2cdfed221c55bc99e66653695","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32851"},"html":{"href":"https://github.com/apache/spark/pull/32851"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32851"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32851/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32851/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32851/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/43b30bd76b16a496cb8f05e395d452c5c4b0735c"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32850","id":666296879,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2Mjk2ODc5","html_url":"https://github.com/apache/spark/pull/32850","diff_url":"https://github.com/apache/spark/pull/32850.diff","patch_url":"https://github.com/apache/spark/pull/32850.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32850","number":32850,"state":"closed","locked":false,"title":"[SPARK-34920][CORE][SQL] Add error classes with SQLSTATE","user":{"login":"karenfeng","id":4754931,"node_id":"MDQ6VXNlcjQ3NTQ5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4754931?v=4","gravatar_id":"","url":"https://api.github.com/users/karenfeng","html_url":"https://github.com/karenfeng","followers_url":"https://api.github.com/users/karenfeng/followers","following_url":"https://api.github.com/users/karenfeng/following{/other_user}","gists_url":"https://api.github.com/users/karenfeng/gists{/gist_id}","starred_url":"https://api.github.com/users/karenfeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karenfeng/subscriptions","organizations_url":"https://api.github.com/users/karenfeng/orgs","repos_url":"https://api.github.com/users/karenfeng/repos","events_url":"https://api.github.com/users/karenfeng/events{/privacy}","received_events_url":"https://api.github.com/users/karenfeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nUnifies exceptions thrown from Spark under a single base trait `SparkError`, which unifies:\r\n- Error classes\r\n- Parametrized error messages\r\n- SQLSTATE, as discussed in http://apache-spark-developers-list.1001551.n3.nabble.com/DISCUSS-Add-error-IDs-td31126.html.\r\n\r\n### Why are the changes needed?\r\n\r\n- Adding error classes creates a consistent label for exceptions, even as error messages change\r\n- Creating a single, centralized source-of-truth for parametrized error messages improves auditing for error message quality\r\n- Adding SQLSTATE helps ODBC/JDBC users receive standardized error codes\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, changes ODBC experience by:\r\n- Adding error classes to error messages\r\n- Adding SQLSTATE to TStatus\r\n\r\n### How was this patch tested?\r\n\r\nUnit tests, as well as local tests with PyODBC.\r\n","created_at":"2021-06-09T20:34:32Z","updated_at":"2021-06-30T09:22:18Z","closed_at":"2021-06-30T09:22:18Z","merged_at":null,"merge_commit_sha":"971f64aa372e5e809eb4db1f85b2c48a20d5ca81","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32850/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32850/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32850/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6d8e915ca62806f511588134a57bbeca99361d86","head":{"label":"karenfeng:SPARK-34920","ref":"SPARK-34920","sha":"6d8e915ca62806f511588134a57bbeca99361d86","user":{"login":"karenfeng","id":4754931,"node_id":"MDQ6VXNlcjQ3NTQ5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4754931?v=4","gravatar_id":"","url":"https://api.github.com/users/karenfeng","html_url":"https://github.com/karenfeng","followers_url":"https://api.github.com/users/karenfeng/followers","following_url":"https://api.github.com/users/karenfeng/following{/other_user}","gists_url":"https://api.github.com/users/karenfeng/gists{/gist_id}","starred_url":"https://api.github.com/users/karenfeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karenfeng/subscriptions","organizations_url":"https://api.github.com/users/karenfeng/orgs","repos_url":"https://api.github.com/users/karenfeng/repos","events_url":"https://api.github.com/users/karenfeng/events{/privacy}","received_events_url":"https://api.github.com/users/karenfeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":263201423,"node_id":"MDEwOlJlcG9zaXRvcnkyNjMyMDE0MjM=","name":"spark-1","full_name":"karenfeng/spark-1","private":false,"owner":{"login":"karenfeng","id":4754931,"node_id":"MDQ6VXNlcjQ3NTQ5MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4754931?v=4","gravatar_id":"","url":"https://api.github.com/users/karenfeng","html_url":"https://github.com/karenfeng","followers_url":"https://api.github.com/users/karenfeng/followers","following_url":"https://api.github.com/users/karenfeng/following{/other_user}","gists_url":"https://api.github.com/users/karenfeng/gists{/gist_id}","starred_url":"https://api.github.com/users/karenfeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karenfeng/subscriptions","organizations_url":"https://api.github.com/users/karenfeng/orgs","repos_url":"https://api.github.com/users/karenfeng/repos","events_url":"https://api.github.com/users/karenfeng/events{/privacy}","received_events_url":"https://api.github.com/users/karenfeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/karenfeng/spark-1","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/karenfeng/spark-1","forks_url":"https://api.github.com/repos/karenfeng/spark-1/forks","keys_url":"https://api.github.com/repos/karenfeng/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/karenfeng/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/karenfeng/spark-1/teams","hooks_url":"https://api.github.com/repos/karenfeng/spark-1/hooks","issue_events_url":"https://api.github.com/repos/karenfeng/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/karenfeng/spark-1/events","assignees_url":"https://api.github.com/repos/karenfeng/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/karenfeng/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/karenfeng/spark-1/tags","blobs_url":"https://api.github.com/repos/karenfeng/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/karenfeng/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/karenfeng/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/karenfeng/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/karenfeng/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/karenfeng/spark-1/languages","stargazers_url":"https://api.github.com/repos/karenfeng/spark-1/stargazers","contributors_url":"https://api.github.com/repos/karenfeng/spark-1/contributors","subscribers_url":"https://api.github.com/repos/karenfeng/spark-1/subscribers","subscription_url":"https://api.github.com/repos/karenfeng/spark-1/subscription","commits_url":"https://api.github.com/repos/karenfeng/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/karenfeng/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/karenfeng/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/karenfeng/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/karenfeng/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/karenfeng/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/karenfeng/spark-1/merges","archive_url":"https://api.github.com/repos/karenfeng/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/karenfeng/spark-1/downloads","issues_url":"https://api.github.com/repos/karenfeng/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/karenfeng/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/karenfeng/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/karenfeng/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/karenfeng/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/karenfeng/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/karenfeng/spark-1/deployments","created_at":"2020-05-12T01:32:38Z","updated_at":"2020-10-05T19:55:59Z","pushed_at":"2022-06-03T18:21:34Z","git_url":"git://github.com/karenfeng/spark-1.git","ssh_url":"git@github.com:karenfeng/spark-1.git","clone_url":"https://github.com/karenfeng/spark-1.git","svn_url":"https://github.com/karenfeng/spark-1","homepage":"https://spark.apache.org/","size":411859,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"74b3df86f347ed6279bf127153a2c8c4927af21e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32850"},"html":{"href":"https://github.com/apache/spark/pull/32850"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32850"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32850/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32850/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32850/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6d8e915ca62806f511588134a57bbeca99361d86"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32849","id":666275262,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2Mjc1MjYy","html_url":"https://github.com/apache/spark/pull/32849","diff_url":"https://github.com/apache/spark/pull/32849.diff","patch_url":"https://github.com/apache/spark/pull/32849.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32849","number":32849,"state":"closed","locked":false,"title":"[SPARK-35704][SQL] Add fields to `DayTimeIntervalType`","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nExtend DayTimeIntervalType to support interval fields. Valid interval field values:\r\n- 0 (DAY)\r\n- 1 (HOUR)\r\n- 2 (MINUTE)\r\n- 3 (SECOND)\r\n\r\nAfter the changes, the following day-time interval types are supported:\r\n1. `DayTimeIntervalType(0, 0)` or `DayTimeIntervalType(DAY, DAY)`\r\n2. `DayTimeIntervalType(0, 1)` or `DayTimeIntervalType(DAY, HOUR)`\r\n3. `DayTimeIntervalType(0, 2)` or `DayTimeIntervalType(DAY, MINUTE)`\r\n4. `DayTimeIntervalType(0, 3)` or `DayTimeIntervalType(DAY, SECOND)`. **It is the default one**. The second fraction precision is microseconds. \r\n5. `DayTimeIntervalType(1, 1)` or `DayTimeIntervalType(HOUR, HOUR)`\r\n6. `DayTimeIntervalType(1, 2)` or `DayTimeIntervalType(HOUR, MINUTE)`\r\n7. `DayTimeIntervalType(1, 3)` or `DayTimeIntervalType(HOUR, SECOND)`\r\n8. `DayTimeIntervalType(2, 2)` or `DayTimeIntervalType(MINUTE, MINUTE)`\r\n9. `DayTimeIntervalType(2, 3)` or `DayTimeIntervalType(MINUTE, SECOND)`\r\n10. `DayTimeIntervalType(3, 3)` or `DayTimeIntervalType(SECOND, SECOND)`\r\n\r\n### Why are the changes needed?\r\nIn the current implementation, Spark supports only `interval day to second` but the SQL standard allows to specify the start and end fields. The changes will allow to follow ANSI SQL standard more precisely.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes but `DayTimeIntervalType` has not been released yet.\r\n\r\n### How was this patch tested?\r\nBy existing test suites.","created_at":"2021-06-09T19:58:20Z","updated_at":"2021-06-11T21:44:09Z","closed_at":"2021-06-11T13:16:47Z","merged_at":null,"merge_commit_sha":"4425a156a1f80e053d92329d682fecbf971bf08b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32849/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32849/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32849/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/fa00741c5319ae91dfcc3cf30beb2d2fbb427c64","head":{"label":"MaxGekk:day-time-interval-type-units","ref":"day-time-interval-type-units","sha":"fa00741c5319ae91dfcc3cf30beb2d2fbb427c64","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":123690489,"node_id":"MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=","name":"spark","full_name":"MaxGekk/spark","private":false,"owner":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/MaxGekk/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/MaxGekk/spark","forks_url":"https://api.github.com/repos/MaxGekk/spark/forks","keys_url":"https://api.github.com/repos/MaxGekk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/MaxGekk/spark/teams","hooks_url":"https://api.github.com/repos/MaxGekk/spark/hooks","issue_events_url":"https://api.github.com/repos/MaxGekk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/MaxGekk/spark/events","assignees_url":"https://api.github.com/repos/MaxGekk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/MaxGekk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/MaxGekk/spark/tags","blobs_url":"https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/MaxGekk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/MaxGekk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/MaxGekk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/MaxGekk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/MaxGekk/spark/languages","stargazers_url":"https://api.github.com/repos/MaxGekk/spark/stargazers","contributors_url":"https://api.github.com/repos/MaxGekk/spark/contributors","subscribers_url":"https://api.github.com/repos/MaxGekk/spark/subscribers","subscription_url":"https://api.github.com/repos/MaxGekk/spark/subscription","commits_url":"https://api.github.com/repos/MaxGekk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/MaxGekk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/MaxGekk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/MaxGekk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/MaxGekk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/MaxGekk/spark/merges","archive_url":"https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/MaxGekk/spark/downloads","issues_url":"https://api.github.com/repos/MaxGekk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/MaxGekk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/MaxGekk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/MaxGekk/spark/labels{/name}","releases_url":"https://api.github.com/repos/MaxGekk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/MaxGekk/spark/deployments","created_at":"2018-03-03T12:37:00Z","updated_at":"2025-02-07T09:44:52Z","pushed_at":"2025-02-07T09:44:24Z","git_url":"git://github.com/MaxGekk/spark.git","ssh_url":"git@github.com:MaxGekk/spark.git","clone_url":"https://github.com/MaxGekk/spark.git","svn_url":"https://github.com/MaxGekk/spark","homepage":null,"size":486456,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"74b3df86f347ed6279bf127153a2c8c4927af21e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32849"},"html":{"href":"https://github.com/apache/spark/pull/32849"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32849"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32849/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32849/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32849/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/fa00741c5319ae91dfcc3cf30beb2d2fbb427c64"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32848","id":666232215,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2MjMyMjE1","html_url":"https://github.com/apache/spark/pull/32848","diff_url":"https://github.com/apache/spark/pull/32848.diff","patch_url":"https://github.com/apache/spark/pull/32848.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32848","number":32848,"state":"closed","locked":false,"title":"[SPARK-35194][SQL][FOLLOWUP] Change Seq to collections.Seq in NestedColumnAliasing to work with Scala 2.13","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR changes an occurrence of `Seq` to `collections.Seq` in `NestedColumnAliasing`.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nIn the current master, `NestedColumnAliasing` doesn't work with Scala 2.13 and the relevant tests fail.\r\nThe following are examples.\r\n\r\n* `NestedColumnAliasingSuite`\r\n* Subclasses of `SchemaPruningSuite`\r\n* `ColumnPruningSuite`\r\n\r\n```\r\nNestedColumnAliasingSuite:\r\n[info] - Pushing a single nested field projection *** FAILED *** (14 milliseconds)\r\n[info]   scala.MatchError: (none#211451,ArrayBuffer(name#211451.middle)) (of class scala.Tuple2)\r\n[info]   at org.apache.spark.sql.catalyst.optimizer.NestedColumnAliasing$.$anonfun$getAttributeToExtractValues$5(NestedColumnAliasing.scala:258)\r\n[info]   at scala.collection.StrictOptimizedMapOps.flatMap(StrictOptimizedMapOps.scala:31)\r\n[info]   at scala.collection.StrictOptimizedMapOps.flatMap$(StrictOptimizedMapOps.scala:30)\r\n[info]   at scala.collection.immutable.HashMap.flatMap(HashMap.scala:39)\r\n[info]   at org.apache.spark.sql.catalyst.optimizer.NestedColumnAliasing$.getAttributeToExtractValues(NestedColumnAliasing.scala:258)\r\n```\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nRan tests mentioned above and all passed with Scala 2.13.","created_at":"2021-06-09T19:08:38Z","updated_at":"2021-06-10T02:14:47Z","closed_at":"2021-06-10T02:14:47Z","merged_at":null,"merge_commit_sha":"84ccf5488af5edda5dd600a61f9f43e8809e6db4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32848/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32848/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32848/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c17925fb2923f5e705e64e0ab9bd02f18fb76f24","head":{"label":"sarutak:followup-SPARK-35194-2","ref":"followup-SPARK-35194-2","sha":"c17925fb2923f5e705e64e0ab9bd02f18fb76f24","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19300892,"node_id":"MDEwOlJlcG9zaXRvcnkxOTMwMDg5Mg==","name":"spark","full_name":"sarutak/spark","private":false,"owner":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sarutak/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sarutak/spark","forks_url":"https://api.github.com/repos/sarutak/spark/forks","keys_url":"https://api.github.com/repos/sarutak/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sarutak/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sarutak/spark/teams","hooks_url":"https://api.github.com/repos/sarutak/spark/hooks","issue_events_url":"https://api.github.com/repos/sarutak/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sarutak/spark/events","assignees_url":"https://api.github.com/repos/sarutak/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sarutak/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sarutak/spark/tags","blobs_url":"https://api.github.com/repos/sarutak/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sarutak/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sarutak/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sarutak/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sarutak/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sarutak/spark/languages","stargazers_url":"https://api.github.com/repos/sarutak/spark/stargazers","contributors_url":"https://api.github.com/repos/sarutak/spark/contributors","subscribers_url":"https://api.github.com/repos/sarutak/spark/subscribers","subscription_url":"https://api.github.com/repos/sarutak/spark/subscription","commits_url":"https://api.github.com/repos/sarutak/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sarutak/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sarutak/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sarutak/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sarutak/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sarutak/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sarutak/spark/merges","archive_url":"https://api.github.com/repos/sarutak/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sarutak/spark/downloads","issues_url":"https://api.github.com/repos/sarutak/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sarutak/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sarutak/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sarutak/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sarutak/spark/labels{/name}","releases_url":"https://api.github.com/repos/sarutak/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sarutak/spark/deployments","created_at":"2014-04-30T04:35:03Z","updated_at":"2021-11-06T06:43:35Z","pushed_at":"2025-01-23T16:33:44Z","git_url":"git://github.com/sarutak/spark.git","ssh_url":"git@github.com:sarutak/spark.git","clone_url":"https://github.com/sarutak/spark.git","svn_url":"https://github.com/sarutak/spark","homepage":null,"size":467531,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"74b3df86f347ed6279bf127153a2c8c4927af21e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32848"},"html":{"href":"https://github.com/apache/spark/pull/32848"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32848"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32848/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32848/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32848/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c17925fb2923f5e705e64e0ab9bd02f18fb76f24"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32847","id":666174778,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2MTc0Nzc4","html_url":"https://github.com/apache/spark/pull/32847","diff_url":"https://github.com/apache/spark/pull/32847.diff","patch_url":"https://github.com/apache/spark/pull/32847.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32847","number":32847,"state":"closed","locked":false,"title":"[SPARK-35616][PYTHON] Make `astype` method data-type-based","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nMake `astype` method data-type-based.\r\n\r\n**Non-goal: Match pandas' `astype` TypeErrors.**\r\nCurrently, `astype` throws TypeError error messages only when the destination type is not recognized. However, for some destination types that don't make sense to the specific type of  Series/Index, for example, `numeric Series/Index → bytes`, we don't have proper TypeError error messages.\r\nSince the goal of the PR is refactoring mainly, the above issue might be resolved later if needed.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nThere are many type checks in the `astype` method. Since `DataTypeOps` and its subclasses are introduced, we should refactor `astype` to make it data-type-based. In this way, code is cleaner, more maintainable, and more flexible.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit tests.\r\n\r\nKeyword: SPARK-35337","created_at":"2021-06-09T18:21:45Z","updated_at":"2021-11-01T17:28:33Z","closed_at":"2021-06-14T23:33:31Z","merged_at":null,"merge_commit_sha":"3635030abab80b887316d6eaa74c2545dd9410b2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32847/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32847/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32847/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/15516f6f04f282a8b3d14a6de824a9b9b7aac619","head":{"label":"xinrong-meng:datatypeops_astype","ref":"datatypeops_astype","sha":"15516f6f04f282a8b3d14a6de824a9b9b7aac619","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":335786381,"node_id":"MDEwOlJlcG9zaXRvcnkzMzU3ODYzODE=","name":"spark","full_name":"xinrong-meng/spark","private":false,"owner":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xinrong-meng/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xinrong-meng/spark","forks_url":"https://api.github.com/repos/xinrong-meng/spark/forks","keys_url":"https://api.github.com/repos/xinrong-meng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xinrong-meng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xinrong-meng/spark/teams","hooks_url":"https://api.github.com/repos/xinrong-meng/spark/hooks","issue_events_url":"https://api.github.com/repos/xinrong-meng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xinrong-meng/spark/events","assignees_url":"https://api.github.com/repos/xinrong-meng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xinrong-meng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xinrong-meng/spark/tags","blobs_url":"https://api.github.com/repos/xinrong-meng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xinrong-meng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xinrong-meng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xinrong-meng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xinrong-meng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xinrong-meng/spark/languages","stargazers_url":"https://api.github.com/repos/xinrong-meng/spark/stargazers","contributors_url":"https://api.github.com/repos/xinrong-meng/spark/contributors","subscribers_url":"https://api.github.com/repos/xinrong-meng/spark/subscribers","subscription_url":"https://api.github.com/repos/xinrong-meng/spark/subscription","commits_url":"https://api.github.com/repos/xinrong-meng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xinrong-meng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xinrong-meng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xinrong-meng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xinrong-meng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xinrong-meng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xinrong-meng/spark/merges","archive_url":"https://api.github.com/repos/xinrong-meng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xinrong-meng/spark/downloads","issues_url":"https://api.github.com/repos/xinrong-meng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xinrong-meng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xinrong-meng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xinrong-meng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xinrong-meng/spark/labels{/name}","releases_url":"https://api.github.com/repos/xinrong-meng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xinrong-meng/spark/deployments","created_at":"2021-02-03T23:47:29Z","updated_at":"2024-09-27T08:09:06Z","pushed_at":"2025-02-08T02:14:33Z","git_url":"git://github.com/xinrong-meng/spark.git","ssh_url":"git@github.com:xinrong-meng/spark.git","clone_url":"https://github.com/xinrong-meng/spark.git","svn_url":"https://github.com/xinrong-meng/spark","homepage":"https://spark.apache.org/","size":469811,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":2,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4d21b94d13daf958edf6bbf49c4aa17f5cb012b5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32847"},"html":{"href":"https://github.com/apache/spark/pull/32847"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32847"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32847/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32847/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32847/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/15516f6f04f282a8b3d14a6de824a9b9b7aac619"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/32846","id":666053637,"node_id":"MDExOlB1bGxSZXF1ZXN0NjY2MDUzNjM3","html_url":"https://github.com/apache/spark/pull/32846","diff_url":"https://github.com/apache/spark/pull/32846.diff","patch_url":"https://github.com/apache/spark/pull/32846.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/32846","number":32846,"state":"closed","locked":false,"title":"[SPARK-35698][SQL] Support casting of timestamp without time zone to strings","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error message, please read the guideline first:\r\n     https://spark.apache.org/error-message-guidelines.html\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nExtend the Cast expression and support TimestampWithoutTZType in casting to StringType.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo conform the ANSI SQL standard which requires to support such casting.\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo, the new timestamp type is not released yet.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\n-->\r\nUnit test ","created_at":"2021-06-09T16:07:05Z","updated_at":"2021-06-09T21:28:08Z","closed_at":"2021-06-09T18:29:49Z","merged_at":null,"merge_commit_sha":"26f63aec751e1a5e6c96ed27a79e3bc396396a1b","assignee":null,"assignees":[],"requested_reviewers":[{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/32846/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/32846/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/32846/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ec0b133846ea0cdabb14a30de1e77709053e9347","head":{"label":"gengliangwang:tswtzToString","ref":"tswtzToString","sha":"ec0b133846ea0cdabb14a30de1e77709053e9347","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"519be238be3d6c02c06f8c5b967e6e3ce108c653","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/32846"},"html":{"href":"https://github.com/apache/spark/pull/32846"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/32846"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/32846/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/32846/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/32846/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ec0b133846ea0cdabb14a30de1e77709053e9347"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null}]