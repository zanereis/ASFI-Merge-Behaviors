[{"url":"https://api.github.com/repos/apache/spark/pulls/25243","id":300626663,"node_id":"MDExOlB1bGxSZXF1ZXN0MzAwNjI2NjYz","html_url":"https://github.com/apache/spark/pull/25243","diff_url":"https://github.com/apache/spark/pull/25243.diff","patch_url":"https://github.com/apache/spark/pull/25243.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25243","number":25243,"state":"closed","locked":false,"title":"[SPARK-28498][SQL][TEST] clear the states of SparkSession after each test","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nWhen I write tests, it's tedious to remember to clear all the temporary states and write a lot of `withTempView`, `withSQLConf`, etc.\r\n\r\nWhen I review PRs, I also need to keep an eye on the tests and make sure the temporary states are cleared, which is extra overhead for me.\r\n\r\nI think it can make our life easier if the test framework can clear the states of SparkSession after each test.\r\n\r\nI tried it with `DataSourceV2SQLSuite` and `DataFrameSuite`, and it does simplify the test suite.\r\n\r\nThe existing tests still work, we shouldn't encourage people to send test-only PRs to remove the `withSQLConf`, `withTempView`, etc. But we can omit them when writing new tests.\r\n\r\n## How was this patch tested?\r\n\r\ntest only patch","created_at":"2019-07-24T09:01:32Z","updated_at":"2019-08-15T12:57:53Z","closed_at":"2019-08-15T12:57:52Z","merged_at":null,"merge_commit_sha":"d4e024a4c4cc51629fbc13e84784ee0e72108657","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25243/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25243/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25243/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5ac310b7feeef2a7a092e5e0e7f6ea973dceb2ba","head":{"label":"cloud-fan:test","ref":"test","sha":"5ac310b7feeef2a7a092e5e0e7f6ea973dceb2ba","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"ee41001949af43d25dc6962ab6ca277e53c64299","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25243"},"html":{"href":"https://github.com/apache/spark/pull/25243"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25243"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25243/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25243/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25243/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5ac310b7feeef2a7a092e5e0e7f6ea973dceb2ba"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25242","id":300607404,"node_id":"MDExOlB1bGxSZXF1ZXN0MzAwNjA3NDA0","html_url":"https://github.com/apache/spark/pull/25242","diff_url":"https://github.com/apache/spark/pull/25242.diff","patch_url":"https://github.com/apache/spark/pull/25242.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25242","number":25242,"state":"closed","locked":false,"title":"[SPARK-28497][SQL] Disallow upcasting complex data types to string type","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nIn the current implementation. complex types like Array/Map/StructType are allowed to upcast as StringType.\r\nThis is not safe casting. We should disallow it.\r\n\r\n## How was this patch tested?\r\n\r\nUpdate the existing test case \r\n","created_at":"2019-07-24T08:07:39Z","updated_at":"2019-07-25T11:59:44Z","closed_at":"2019-07-25T11:59:44Z","merged_at":null,"merge_commit_sha":"9771585b8c42663e695a153dc5890f3355a5ea08","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25242/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25242/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25242/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6c590a0ea0a83bf39825e345341fc8815ed32f3f","head":{"label":"gengliangwang:fixUpCastStringType","ref":"fixUpCastStringType","sha":"6c590a0ea0a83bf39825e345341fc8815ed32f3f","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"167fa0402dab0800e9762d63d29bd6d9892fa9a8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25242"},"html":{"href":"https://github.com/apache/spark/pull/25242"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25242"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25242/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25242/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25242/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6c590a0ea0a83bf39825e345341fc8815ed32f3f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25241","id":300599842,"node_id":"MDExOlB1bGxSZXF1ZXN0MzAwNTk5ODQy","html_url":"https://github.com/apache/spark/pull/25241","diff_url":"https://github.com/apache/spark/pull/25241.diff","patch_url":"https://github.com/apache/spark/pull/25241.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25241","number":25241,"state":"closed","locked":false,"title":"[SPARK-28424][SQL] Support typed interval expression","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR add support typed `interval` expression:\r\n```sql\r\nspark-sql> select interval 'interval 3 year 1 hour';\r\ninterval 3 years 1 hours\r\nspark-sql>\r\n```\r\n\r\nPlease note that this pr did not add a cast alias for `interval` type like [other types](https://github.com/apache/spark/blob/2d74f14d74e7b24109f347822600ebf9819b04c1/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/analysis/FunctionRegistry.scala#L529-L541) because neither PostgreSQL nor Hive supports this syntax.\r\n\r\n## How was this patch tested?\r\n\r\nunit tests\r\n","created_at":"2019-07-24T07:44:01Z","updated_at":"2019-07-28T01:06:25Z","closed_at":"2019-07-27T21:30:38Z","merged_at":null,"merge_commit_sha":"a542d3341182775bc4c0fec4c9b293244cfe21de","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25241/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25241/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25241/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/586ef495d57095bbcbc0c4f666017c6843c4b0cd","head":{"label":"wangyum:SPARK-28424","ref":"SPARK-28424","sha":"586ef495d57095bbcbc0c4f666017c6843c4b0cd","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"167fa0402dab0800e9762d63d29bd6d9892fa9a8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25241"},"html":{"href":"https://github.com/apache/spark/pull/25241"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25241"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25241/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25241/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25241/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/586ef495d57095bbcbc0c4f666017c6843c4b0cd"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25240","id":300597180,"node_id":"MDExOlB1bGxSZXF1ZXN0MzAwNTk3MTgw","html_url":"https://github.com/apache/spark/pull/25240","diff_url":"https://github.com/apache/spark/pull/25240.diff","patch_url":"https://github.com/apache/spark/pull/25240.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25240","number":25240,"state":"closed","locked":false,"title":"[SPARK-28496][INFRA] Use branch name instead of tag during dry-run","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThere are two cases when we use `dry run`.\r\n\r\nFirst, when the tag already exists, we can ask `confirmation` on the existing tag name.\r\n```\r\n$ dev/create-release/do-release-docker.sh -d /tmp/spark-2.4.4 -n -s docs\r\nOutput directory already exists. Overwrite and continue? [y/n] y\r\nBranch [branch-2.4]:\r\nCurrent branch version is 2.4.4-SNAPSHOT.\r\nRelease [2.4.4]: 2.4.3\r\nRC # [1]:\r\nv2.4.3-rc1 already exists. Continue anyway [y/n]? y\r\nThis is a dry run. Please confirm the ref that will be built for testing.\r\nRef [v2.4.3-rc1]:\r\n```\r\n\r\nSecond, when the tag doesn't exist, we had better ask `confirmation` on the branch name. If we do not change the default value, it will fail eventually.\r\n```\r\n$ dev/create-release/do-release-docker.sh -d /tmp/spark-2.4.4 -n -s docs\r\nBranch [branch-2.4]:\r\nCurrent branch version is 2.4.4-SNAPSHOT.\r\nRelease [2.4.4]:\r\nRC # [1]:\r\nThis is a dry run. Please confirm the ref that will be built for testing.\r\nRef [v2.4.4-rc1]:\r\n```\r\n\r\nThis PR improves the second case by providing the branch name instead. This helps the release testing before tagging.\r\n\r\n## How was this patch tested?\r\n\r\nManually do the following and check the default value of `Ref` field.\r\n```\r\n$ dev/create-release/do-release-docker.sh -d /tmp/spark-2.4.4 -n -s docs\r\nBranch [branch-2.4]:\r\nCurrent branch version is 2.4.4-SNAPSHOT.\r\nRelease [2.4.4]:\r\nRC # [1]:\r\nThis is a dry run. Please confirm the ref that will be built for testing.\r\nRef [branch-2.4]:\r\n...\r\n```","created_at":"2019-07-24T07:35:26Z","updated_at":"2019-07-24T22:08:22Z","closed_at":"2019-07-24T21:25:26Z","merged_at":null,"merge_commit_sha":"08a7f18f753d804c8cdedadb0d731962a388e03b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587336,"node_id":"MDU6TGFiZWwxNDA2NTg3MzM2","url":"https://api.github.com/repos/apache/spark/labels/PROJECT%20INFRA","name":"PROJECT INFRA","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25240/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25240/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25240/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b96000a7ed193159b8e3981612b1ed3f330d611a","head":{"label":"dongjoon-hyun:SPARK-28496","ref":"SPARK-28496","sha":"b96000a7ed193159b8e3981612b1ed3f330d611a","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"167fa0402dab0800e9762d63d29bd6d9892fa9a8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25240"},"html":{"href":"https://github.com/apache/spark/pull/25240"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25240"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25240/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25240/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25240/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b96000a7ed193159b8e3981612b1ed3f330d611a"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25239","id":300592209,"node_id":"MDExOlB1bGxSZXF1ZXN0MzAwNTkyMjA5","html_url":"https://github.com/apache/spark/pull/25239","diff_url":"https://github.com/apache/spark/pull/25239.diff","patch_url":"https://github.com/apache/spark/pull/25239.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25239","number":25239,"state":"closed","locked":false,"title":"[WIP][SPARK-28495][SQL] Table insertion: follow store assignment rules of ANSI SQL","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nIn Spark version 2.4 and earlier, when inserting into a table, Spark will cast the data type of input query to the data type of target table by coercion. This can be super confusing, e.g. users make a mistake and write string values to an int column.\r\n\r\nIn data source V2, by default, only upcasting is allowed when inserting data into a table. E.g. int -> long and int -> string are allowed, while decimal -> double or long -> int are not allowed. The rules of UpCast was originally created for Dataset type coercion. They are quite strict and different from the behavior of all existing popular DBMS. Making it the default behavior of the table insertion is breaking change. It is possible that it would hurt some Spark users after 3.0 releases.\r\n\r\nThis PR proposes that we can follow the rules of store assignment(section 9.2) in ANSI SQL. Two significant differences from Up-Cast:\r\n1. Any numeric type can be assigned to another numeric type.\r\n2. TimestampType can be assigned DateType\r\n\r\nThe new behavior is consistent with PostgreSQL. It is more explainable and acceptable than using UpCast .\r\n**The change will be applied in Data Source V2 first.** If it is merged, we can apply it into data source V1.\r\n\r\n## How was this patch tested?\r\n\r\nUnit test\r\n","created_at":"2019-07-24T07:18:30Z","updated_at":"2019-08-26T11:40:47Z","closed_at":"2019-08-26T11:40:47Z","merged_at":null,"merge_commit_sha":"da7c9da7d7f1ae0032ce63b1a29f90738cfcc37b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25239/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25239/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25239/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1abcc9d8a228fbceaabb24de9deb0c92c6298087","head":{"label":"gengliangwang:assignCast","ref":"assignCast","sha":"1abcc9d8a228fbceaabb24de9deb0c92c6298087","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"167fa0402dab0800e9762d63d29bd6d9892fa9a8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25239"},"html":{"href":"https://github.com/apache/spark/pull/25239"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25239"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25239/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25239/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25239/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1abcc9d8a228fbceaabb24de9deb0c92c6298087"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25238","id":300525300,"node_id":"MDExOlB1bGxSZXF1ZXN0MzAwNTI1MzAw","html_url":"https://github.com/apache/spark/pull/25238","diff_url":"https://github.com/apache/spark/pull/25238.diff","patch_url":"https://github.com/apache/spark/pull/25238.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25238","number":25238,"state":"closed","locked":false,"title":"[WIP][SPARK-28152][SQL][2.4] Mapped ShortType to SMALLINT and FloatType to REAL for MsSqlServerDialect","user":{"login":"shivsood","id":1579057,"node_id":"MDQ6VXNlcjE1NzkwNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1579057?v=4","gravatar_id":"","url":"https://api.github.com/users/shivsood","html_url":"https://github.com/shivsood","followers_url":"https://api.github.com/users/shivsood/followers","following_url":"https://api.github.com/users/shivsood/following{/other_user}","gists_url":"https://api.github.com/users/shivsood/gists{/gist_id}","starred_url":"https://api.github.com/users/shivsood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivsood/subscriptions","organizations_url":"https://api.github.com/users/shivsood/orgs","repos_url":"https://api.github.com/users/shivsood/repos","events_url":"https://api.github.com/users/shivsood/events{/privacy}","received_events_url":"https://api.github.com/users/shivsood/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nThis is a backport of SPARK-28152 to Spark 2.4. Because the fix in 3.0 was based on different base files, following relevant fixes have also been cherry-picked as part of this fix. \r\n- [SPARK-27159][SQL] update mssql server dialect to support binary type \r\n- SPARK-27168 [SQL][TEST] Add docker integration test for MsSql server\r\n\r\nSPARK-28152  corrects mappings in `MsSqlServerDialect`. Post fix `ShortType` is mapped to `SMALLINT` and `FloatType` is mapped to `REAL` per [JBDC mapping]( https://docs.microsoft.com/en-us/sql/connect/jdbc/using-basic-data-types?view=sql-server-2017) respectively.\r\n\r\nShortType and FloatTypes are not correctly mapped to right JDBC types when using JDBC connector. This results in tables and spark data frame being created with unintended types. The issue was observed when validating against SQLServer.\r\n\r\nRefer [JBDC mapping]( https://docs.microsoft.com/en-us/sql/connect/jdbc/using-basic-data-types?view=sql-server-2017  ) for guidance on mappings between SQLServer, JDBC and Java. Note that java \"Short\" type should be mapped to JDBC \"SMALLINT\" and java Float should be mapped to JDBC \"REAL\".\r\n\r\nSome example issue that can happen because of wrong mappings\r\n    - Write from df with column type results in a SQL table of with column type as INTEGER as opposed to SMALLINT.Thus a larger table that expected.\r\n    - Read results in a dataframe with type INTEGER as opposed to ShortType\r\n\r\n- ShortType has a problem in both the the write and read path\r\n- FloatTypes only have an issue with read path. In the write path Spark data type 'FloatType' is correctly mapped to JDBC equivalent data type 'Real'. But in the read path when JDBC data types need to be converted to Catalyst data types ( getCatalystType) 'Real' gets incorrectly gets mapped to 'DoubleType' rather than 'FloatType'.\r\n\r\n## How was this patch tested?\r\nIntegration test using : ./build/mvn test -Pdocker-integration-tests -pl :spark-docker-integration-tests_2.11 -Dtest=none -DwildcardSuites=org.apache.spark.sql.jdbc.MsSqlServerIntegrationSuite\r\n\r\n(Please explain how this patch was tested. E.g. unit tests, integration tests, manual tests)\r\n(If this patch involves UI changes, please attach a screenshot; otherwise, remove this)\r\n\r\nPlease review https://spark.apache.org/contributing.html before opening a pull request.\r\n","created_at":"2019-07-24T01:17:18Z","updated_at":"2019-07-24T19:10:16Z","closed_at":"2019-07-24T17:10:36Z","merged_at":null,"merge_commit_sha":"d38880667d90ed376bf5b2f57c3ee899c1ec4ee2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25238/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25238/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25238/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7f7adc13a5bf616e41070996e43481df60d233dd","head":{"label":"shivsood:float_byte_type_fix_24","ref":"float_byte_type_fix_24","sha":"7f7adc13a5bf616e41070996e43481df60d233dd","user":{"login":"shivsood","id":1579057,"node_id":"MDQ6VXNlcjE1NzkwNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1579057?v=4","gravatar_id":"","url":"https://api.github.com/users/shivsood","html_url":"https://github.com/shivsood","followers_url":"https://api.github.com/users/shivsood/followers","following_url":"https://api.github.com/users/shivsood/following{/other_user}","gists_url":"https://api.github.com/users/shivsood/gists{/gist_id}","starred_url":"https://api.github.com/users/shivsood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivsood/subscriptions","organizations_url":"https://api.github.com/users/shivsood/orgs","repos_url":"https://api.github.com/users/shivsood/repos","events_url":"https://api.github.com/users/shivsood/events{/privacy}","received_events_url":"https://api.github.com/users/shivsood/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":192983938,"node_id":"MDEwOlJlcG9zaXRvcnkxOTI5ODM5Mzg=","name":"spark","full_name":"shivsood/spark","private":false,"owner":{"login":"shivsood","id":1579057,"node_id":"MDQ6VXNlcjE1NzkwNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1579057?v=4","gravatar_id":"","url":"https://api.github.com/users/shivsood","html_url":"https://github.com/shivsood","followers_url":"https://api.github.com/users/shivsood/followers","following_url":"https://api.github.com/users/shivsood/following{/other_user}","gists_url":"https://api.github.com/users/shivsood/gists{/gist_id}","starred_url":"https://api.github.com/users/shivsood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivsood/subscriptions","organizations_url":"https://api.github.com/users/shivsood/orgs","repos_url":"https://api.github.com/users/shivsood/repos","events_url":"https://api.github.com/users/shivsood/events{/privacy}","received_events_url":"https://api.github.com/users/shivsood/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/shivsood/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/shivsood/spark","forks_url":"https://api.github.com/repos/shivsood/spark/forks","keys_url":"https://api.github.com/repos/shivsood/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/shivsood/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/shivsood/spark/teams","hooks_url":"https://api.github.com/repos/shivsood/spark/hooks","issue_events_url":"https://api.github.com/repos/shivsood/spark/issues/events{/number}","events_url":"https://api.github.com/repos/shivsood/spark/events","assignees_url":"https://api.github.com/repos/shivsood/spark/assignees{/user}","branches_url":"https://api.github.com/repos/shivsood/spark/branches{/branch}","tags_url":"https://api.github.com/repos/shivsood/spark/tags","blobs_url":"https://api.github.com/repos/shivsood/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/shivsood/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/shivsood/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/shivsood/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/shivsood/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/shivsood/spark/languages","stargazers_url":"https://api.github.com/repos/shivsood/spark/stargazers","contributors_url":"https://api.github.com/repos/shivsood/spark/contributors","subscribers_url":"https://api.github.com/repos/shivsood/spark/subscribers","subscription_url":"https://api.github.com/repos/shivsood/spark/subscription","commits_url":"https://api.github.com/repos/shivsood/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/shivsood/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/shivsood/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/shivsood/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/shivsood/spark/contents/{+path}","compare_url":"https://api.github.com/repos/shivsood/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/shivsood/spark/merges","archive_url":"https://api.github.com/repos/shivsood/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/shivsood/spark/downloads","issues_url":"https://api.github.com/repos/shivsood/spark/issues{/number}","pulls_url":"https://api.github.com/repos/shivsood/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/shivsood/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/shivsood/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/shivsood/spark/labels{/name}","releases_url":"https://api.github.com/repos/shivsood/spark/releases{/id}","deployments_url":"https://api.github.com/repos/shivsood/spark/deployments","created_at":"2019-06-20T20:32:39Z","updated_at":"2019-07-20T16:13:38Z","pushed_at":"2020-01-10T23:29:29Z","git_url":"git://github.com/shivsood/spark.git","ssh_url":"git@github.com:shivsood/spark.git","clone_url":"https://github.com/shivsood/spark.git","svn_url":"https://github.com/shivsood/spark","homepage":"","size":321701,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:branch-2.4","ref":"branch-2.4","sha":"c01c294effd6fe98d528e2c317b37249ae1c3572","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25238"},"html":{"href":"https://github.com/apache/spark/pull/25238"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25238"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25238/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25238/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25238/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7f7adc13a5bf616e41070996e43481df60d233dd"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25237","id":300515291,"node_id":"MDExOlB1bGxSZXF1ZXN0MzAwNTE1Mjkx","html_url":"https://github.com/apache/spark/pull/25237","diff_url":"https://github.com/apache/spark/pull/25237.diff","patch_url":"https://github.com/apache/spark/pull/25237.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25237","number":25237,"state":"closed","locked":false,"title":"[SPARK-28489][SS] Fix a bug that KafkaOffsetRangeCalculator.getRanges may drop offsets","user":{"login":"zsxwing","id":1000778,"node_id":"MDQ6VXNlcjEwMDA3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/1000778?v=4","gravatar_id":"","url":"https://api.github.com/users/zsxwing","html_url":"https://github.com/zsxwing","followers_url":"https://api.github.com/users/zsxwing/followers","following_url":"https://api.github.com/users/zsxwing/following{/other_user}","gists_url":"https://api.github.com/users/zsxwing/gists{/gist_id}","starred_url":"https://api.github.com/users/zsxwing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zsxwing/subscriptions","organizations_url":"https://api.github.com/users/zsxwing/orgs","repos_url":"https://api.github.com/users/zsxwing/repos","events_url":"https://api.github.com/users/zsxwing/events{/privacy}","received_events_url":"https://api.github.com/users/zsxwing/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n`KafkaOffsetRangeCalculator.getRanges` may drop offsets due to round off errors. The test added in this PR is one example.\r\n\r\nThis PR rewrites the logic in `KafkaOffsetRangeCalculator.getRanges` to ensure it never drops offsets.\r\n\r\n## How was this patch tested?\r\n\r\nThe regression test.","created_at":"2019-07-24T00:11:42Z","updated_at":"2019-08-02T16:16:30Z","closed_at":"2019-07-26T07:15:21Z","merged_at":null,"merge_commit_sha":"cea36c26ed51ce5fb88d1114ee1a7ec1868260a1","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25237/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25237/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25237/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c4010a25a7311d58c06880c00ad85bfb7f583b90","head":{"label":"zsxwing:fix-range","ref":"fix-range","sha":"c4010a25a7311d58c06880c00ad85bfb7f583b90","user":{"login":"zsxwing","id":1000778,"node_id":"MDQ6VXNlcjEwMDA3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/1000778?v=4","gravatar_id":"","url":"https://api.github.com/users/zsxwing","html_url":"https://github.com/zsxwing","followers_url":"https://api.github.com/users/zsxwing/followers","following_url":"https://api.github.com/users/zsxwing/following{/other_user}","gists_url":"https://api.github.com/users/zsxwing/gists{/gist_id}","starred_url":"https://api.github.com/users/zsxwing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zsxwing/subscriptions","organizations_url":"https://api.github.com/users/zsxwing/orgs","repos_url":"https://api.github.com/users/zsxwing/repos","events_url":"https://api.github.com/users/zsxwing/events{/privacy}","received_events_url":"https://api.github.com/users/zsxwing/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":88661206,"node_id":"MDEwOlJlcG9zaXRvcnk4ODY2MTIwNg==","name":"spark","full_name":"zsxwing/spark","private":false,"owner":{"login":"zsxwing","id":1000778,"node_id":"MDQ6VXNlcjEwMDA3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/1000778?v=4","gravatar_id":"","url":"https://api.github.com/users/zsxwing","html_url":"https://github.com/zsxwing","followers_url":"https://api.github.com/users/zsxwing/followers","following_url":"https://api.github.com/users/zsxwing/following{/other_user}","gists_url":"https://api.github.com/users/zsxwing/gists{/gist_id}","starred_url":"https://api.github.com/users/zsxwing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zsxwing/subscriptions","organizations_url":"https://api.github.com/users/zsxwing/orgs","repos_url":"https://api.github.com/users/zsxwing/repos","events_url":"https://api.github.com/users/zsxwing/events{/privacy}","received_events_url":"https://api.github.com/users/zsxwing/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zsxwing/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zsxwing/spark","forks_url":"https://api.github.com/repos/zsxwing/spark/forks","keys_url":"https://api.github.com/repos/zsxwing/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zsxwing/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zsxwing/spark/teams","hooks_url":"https://api.github.com/repos/zsxwing/spark/hooks","issue_events_url":"https://api.github.com/repos/zsxwing/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zsxwing/spark/events","assignees_url":"https://api.github.com/repos/zsxwing/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zsxwing/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zsxwing/spark/tags","blobs_url":"https://api.github.com/repos/zsxwing/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zsxwing/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zsxwing/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zsxwing/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zsxwing/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zsxwing/spark/languages","stargazers_url":"https://api.github.com/repos/zsxwing/spark/stargazers","contributors_url":"https://api.github.com/repos/zsxwing/spark/contributors","subscribers_url":"https://api.github.com/repos/zsxwing/spark/subscribers","subscription_url":"https://api.github.com/repos/zsxwing/spark/subscription","commits_url":"https://api.github.com/repos/zsxwing/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zsxwing/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zsxwing/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zsxwing/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zsxwing/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zsxwing/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zsxwing/spark/merges","archive_url":"https://api.github.com/repos/zsxwing/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zsxwing/spark/downloads","issues_url":"https://api.github.com/repos/zsxwing/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zsxwing/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zsxwing/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zsxwing/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zsxwing/spark/labels{/name}","releases_url":"https://api.github.com/repos/zsxwing/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zsxwing/spark/deployments","created_at":"2017-04-18T19:11:28Z","updated_at":"2017-04-18T19:11:55Z","pushed_at":"2022-11-08T16:33:20Z","git_url":"git://github.com/zsxwing/spark.git","ssh_url":"git@github.com:zsxwing/spark.git","clone_url":"https://github.com/zsxwing/spark.git","svn_url":"https://github.com/zsxwing/spark","homepage":null,"size":376188,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"8fc5cb628564be94af7eda6051f8ec594de8ed70","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25237"},"html":{"href":"https://github.com/apache/spark/pull/25237"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25237"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25237/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25237/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25237/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c4010a25a7311d58c06880c00ad85bfb7f583b90"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25236","id":300480207,"node_id":"MDExOlB1bGxSZXF1ZXN0MzAwNDgwMjA3","html_url":"https://github.com/apache/spark/pull/25236","diff_url":"https://github.com/apache/spark/pull/25236.diff","patch_url":"https://github.com/apache/spark/pull/25236.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25236","number":25236,"state":"closed","locked":false,"title":"[SPARK-28487][k8s] More responsive dynamic allocation with K8S.","user":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"This change implements a few changes to the k8s pod allocator so\r\nthat it behaves a little better when dynamic allocation is on.\r\n\r\n(i) Allow the application to ramp up immediately when there's a\r\nchange in the target number of executors. Without this change,\r\nscaling would only trigger when a change happened in the state of\r\nthe cluster, e.g. an executor going down, or when the periodical\r\nsnapshot was taken (default every 30s).\r\n\r\n(ii) Get rid of pending pod requests, both acknowledged (i.e. Spark\r\nknows that a pod is pending resource allocation) and unacknowledged\r\n(i.e. Spark has requested the pod but the API server hasn't created it\r\nyet), when they're not needed anymore. This avoids starting those\r\nexecutors to just remove them after the idle timeout, wasting resources\r\nin the meantime.\r\n\r\n(iii) Re-work some of the code to avoid unnecessary logging. While not\r\nbad without dynamic allocation, the existing logging was very chatty\r\nwhen dynamic allocation was on. With the changes, all the useful\r\ninformation is still there, but only when interesting changes happen.\r\n\r\n(iv) Gracefully shut down executors when they become idle. Just deleting\r\nthe pod causes a lot of ugly logs to show up, so it's better to ask pods\r\nto exit nicely. That also allows Spark to respect the \"don't delete\r\npods\" option when dynamic allocation is on.\r\n\r\nTested on a small k8s cluster running different TPC-DS workloads.","created_at":"2019-07-23T21:34:07Z","updated_at":"2022-02-15T05:05:26Z","closed_at":"2019-08-14T00:34:42Z","merged_at":null,"merge_commit_sha":"346259d8a1421356a6d907bcf3f65405acedc7c3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406605057,"node_id":"MDU6TGFiZWwxNDA2NjA1MDU3","url":"https://api.github.com/repos/apache/spark/labels/KUBERNETES","name":"KUBERNETES","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25236/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25236/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25236/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/635326a88a19e21f7644dbc8a149aa2dd1cb917c","head":{"label":"vanzin:SPARK-28487","ref":"SPARK-28487","sha":"635326a88a19e21f7644dbc8a149aa2dd1cb917c","user":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":18302272,"node_id":"MDEwOlJlcG9zaXRvcnkxODMwMjI3Mg==","name":"spark","full_name":"vanzin/spark","private":false,"owner":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vanzin/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/vanzin/spark","forks_url":"https://api.github.com/repos/vanzin/spark/forks","keys_url":"https://api.github.com/repos/vanzin/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vanzin/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vanzin/spark/teams","hooks_url":"https://api.github.com/repos/vanzin/spark/hooks","issue_events_url":"https://api.github.com/repos/vanzin/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vanzin/spark/events","assignees_url":"https://api.github.com/repos/vanzin/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vanzin/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vanzin/spark/tags","blobs_url":"https://api.github.com/repos/vanzin/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vanzin/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vanzin/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vanzin/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vanzin/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vanzin/spark/languages","stargazers_url":"https://api.github.com/repos/vanzin/spark/stargazers","contributors_url":"https://api.github.com/repos/vanzin/spark/contributors","subscribers_url":"https://api.github.com/repos/vanzin/spark/subscribers","subscription_url":"https://api.github.com/repos/vanzin/spark/subscription","commits_url":"https://api.github.com/repos/vanzin/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vanzin/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vanzin/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vanzin/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vanzin/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vanzin/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vanzin/spark/merges","archive_url":"https://api.github.com/repos/vanzin/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vanzin/spark/downloads","issues_url":"https://api.github.com/repos/vanzin/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vanzin/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vanzin/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vanzin/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vanzin/spark/labels{/name}","releases_url":"https://api.github.com/repos/vanzin/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vanzin/spark/deployments","created_at":"2014-03-31T17:49:25Z","updated_at":"2018-01-06T03:57:54Z","pushed_at":"2020-01-24T16:55:58Z","git_url":"git://github.com/vanzin/spark.git","ssh_url":"git@github.com:vanzin/spark.git","clone_url":"https://github.com/vanzin/spark.git","svn_url":"https://github.com/vanzin/spark","homepage":null,"size":287134,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"94499af6f00b2eb06983f25057a9cb73fb8ce088","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25236"},"html":{"href":"https://github.com/apache/spark/pull/25236"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25236"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25236/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25236/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25236/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/635326a88a19e21f7644dbc8a149aa2dd1cb917c"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25235","id":300302293,"node_id":"MDExOlB1bGxSZXF1ZXN0MzAwMzAyMjkz","html_url":"https://github.com/apache/spark/pull/25235","diff_url":"https://github.com/apache/spark/pull/25235.diff","patch_url":"https://github.com/apache/spark/pull/25235.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25235","number":25235,"state":"closed","locked":false,"title":"[SPARK-28483][Core] Fix canceling a spark job using barrier mode but barrier tasks blocking on BarrierTaskContext.barrier()","user":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe barrier tasks might not exit when a spark job is canceled. `BarrierTaskContext.barrier()` is not killed, since it is blocked on RPC requests. This PR is to fix it. \r\n\r\nIn my PR I implement an interface for RPC which support `abort` in class `RpcEndpointRef`\r\n```\r\n  def askAbortable[T: ClassTag](\r\n      message: Any,\r\n      timeout: RpcTimeout): AbortableRpcFuture[T]\r\n```\r\n\r\nThe returned `AbortableRpcFuture` instance include an `abort` method so that we can abort the RPC before it timeout.\r\n\r\n## How was this patch tested?\r\n\r\nUnit test added.\r\n\r\nManually test:\r\n\r\n### Test code\r\nlaunch spark-shell via `spark-shell --master local[4]`\r\nand run following code:\r\n```\r\nsc.setLogLevel(\"INFO\")\r\nimport org.apache.spark.BarrierTaskContext\r\nval n = 4\r\ndef taskf(iter: Iterator[Int]): Iterator[Int] = {\r\n  val context = BarrierTaskContext.get()\r\n  val x = iter.next()\r\n  if (x % 2 == 0) {\r\n    // sleep 6000000 seconds with task killed checking\r\n    for (i <- 0 until 6000000) {\r\n      Thread.sleep(1000)\r\n      if (context.isInterrupted()) {\r\n        throw new org.apache.spark.TaskKilledException()\r\n      }\r\n    }\r\n  }\r\n  context.barrier()\r\n  return Iterator.empty\r\n}\r\n\r\n// launch spark job, including 4 tasks, tasks 1/3 will enter `barrier()`, and tasks 0/2 will enter `sleep`\r\nsc.parallelize((0 to n), n).barrier().mapPartitions(taskf).collect()\r\n```\r\nAnd then press Ctrl+C to exit the running job.\r\n\r\n### Before\r\npress Ctrl+C to exit the running job, then open spark UI we can see 2 tasks (task 1/3) are not killed. They are blocking.\r\n\r\n### After\r\npress Ctrl+C to exit the running job,  we can see in spark UI all tasks killed successfully.\r\n\r\nPlease review https://spark.apache.org/contributing.html before opening a pull request.\r\n","created_at":"2019-07-23T13:40:29Z","updated_at":"2019-08-26T05:03:51Z","closed_at":"2019-08-20T06:22:27Z","merged_at":null,"merge_commit_sha":"92abe690623077bb8b6903b070f6950beff16b4b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25235/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25235/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25235/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/86da5a60fde4420dd750bf0c195044b8568f631c","head":{"label":"WeichenXu123:sc_14848","ref":"sc_14848","sha":"86da5a60fde4420dd750bf0c195044b8568f631c","user":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":58255485,"node_id":"MDEwOlJlcG9zaXRvcnk1ODI1NTQ4NQ==","name":"spark","full_name":"WeichenXu123/spark","private":false,"owner":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/WeichenXu123/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/WeichenXu123/spark","forks_url":"https://api.github.com/repos/WeichenXu123/spark/forks","keys_url":"https://api.github.com/repos/WeichenXu123/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/WeichenXu123/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/WeichenXu123/spark/teams","hooks_url":"https://api.github.com/repos/WeichenXu123/spark/hooks","issue_events_url":"https://api.github.com/repos/WeichenXu123/spark/issues/events{/number}","events_url":"https://api.github.com/repos/WeichenXu123/spark/events","assignees_url":"https://api.github.com/repos/WeichenXu123/spark/assignees{/user}","branches_url":"https://api.github.com/repos/WeichenXu123/spark/branches{/branch}","tags_url":"https://api.github.com/repos/WeichenXu123/spark/tags","blobs_url":"https://api.github.com/repos/WeichenXu123/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/WeichenXu123/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/WeichenXu123/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/WeichenXu123/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/WeichenXu123/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/WeichenXu123/spark/languages","stargazers_url":"https://api.github.com/repos/WeichenXu123/spark/stargazers","contributors_url":"https://api.github.com/repos/WeichenXu123/spark/contributors","subscribers_url":"https://api.github.com/repos/WeichenXu123/spark/subscribers","subscription_url":"https://api.github.com/repos/WeichenXu123/spark/subscription","commits_url":"https://api.github.com/repos/WeichenXu123/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/WeichenXu123/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/WeichenXu123/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/WeichenXu123/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/WeichenXu123/spark/contents/{+path}","compare_url":"https://api.github.com/repos/WeichenXu123/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/WeichenXu123/spark/merges","archive_url":"https://api.github.com/repos/WeichenXu123/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/WeichenXu123/spark/downloads","issues_url":"https://api.github.com/repos/WeichenXu123/spark/issues{/number}","pulls_url":"https://api.github.com/repos/WeichenXu123/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/WeichenXu123/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/WeichenXu123/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/WeichenXu123/spark/labels{/name}","releases_url":"https://api.github.com/repos/WeichenXu123/spark/releases{/id}","deployments_url":"https://api.github.com/repos/WeichenXu123/spark/deployments","created_at":"2016-05-07T07:45:37Z","updated_at":"2022-01-25T15:06:54Z","pushed_at":"2024-11-04T12:27:24Z","git_url":"git://github.com/WeichenXu123/spark.git","ssh_url":"git@github.com:WeichenXu123/spark.git","clone_url":"https://github.com/WeichenXu123/spark.git","svn_url":"https://github.com/WeichenXu123/spark","homepage":null,"size":436946,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a133175ffaf8f45d0f2ca731fc0eda8d8f397726","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25235"},"html":{"href":"https://github.com/apache/spark/pull/25235"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25235"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25235/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25235/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25235/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/86da5a60fde4420dd750bf0c195044b8568f631c"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25234","id":300176053,"node_id":"MDExOlB1bGxSZXF1ZXN0MzAwMTc2MDUz","html_url":"https://github.com/apache/spark/pull/25234","diff_url":"https://github.com/apache/spark/pull/25234.diff","patch_url":"https://github.com/apache/spark/pull/25234.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25234","number":25234,"state":"closed","locked":false,"title":"[SPARK-28054][SQL][followup] move the bug fix closer to where causes the issue","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe bug fixed by https://github.com/apache/spark/pull/24886 is caused by Hive's `loadDynamicPartitions`. It's better to keep the fix surgical and put it right before we call `loadDynamicPartitions`.\r\n\r\nThis also makes the fix safer, instead of analyzing all the callers of `saveAsHiveFile` and proving that they are safe.\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-23T08:11:01Z","updated_at":"2020-02-05T18:26:36Z","closed_at":"2019-07-23T18:22:13Z","merged_at":null,"merge_commit_sha":"f627e8c36540c47abaeead1a4a20db863bcfa0c3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25234/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25234/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25234/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/673fef6b6e77d461ed2299d25f279889bb74f423","head":{"label":"cloud-fan:minor","ref":"minor","sha":"673fef6b6e77d461ed2299d25f279889bb74f423","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"022667cea666190bea651a3873234700a472326c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25234"},"html":{"href":"https://github.com/apache/spark/pull/25234"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25234"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25234/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25234/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25234/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/673fef6b6e77d461ed2299d25f279889bb74f423"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25233","id":300135612,"node_id":"MDExOlB1bGxSZXF1ZXN0MzAwMTM1NjEy","html_url":"https://github.com/apache/spark/pull/25233","diff_url":"https://github.com/apache/spark/pull/25233.diff","patch_url":"https://github.com/apache/spark/pull/25233.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25233","number":25233,"state":"closed","locked":false,"title":"[SPARK-28391][SQL][PYTHON][TESTS] Convert and port 'pgSQL/select_implicit.sql' into UDF test base","user":{"login":"Udbhav30","id":44489863,"node_id":"MDQ6VXNlcjQ0NDg5ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44489863?v=4","gravatar_id":"","url":"https://api.github.com/users/Udbhav30","html_url":"https://github.com/Udbhav30","followers_url":"https://api.github.com/users/Udbhav30/followers","following_url":"https://api.github.com/users/Udbhav30/following{/other_user}","gists_url":"https://api.github.com/users/Udbhav30/gists{/gist_id}","starred_url":"https://api.github.com/users/Udbhav30/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Udbhav30/subscriptions","organizations_url":"https://api.github.com/users/Udbhav30/orgs","repos_url":"https://api.github.com/users/Udbhav30/repos","events_url":"https://api.github.com/users/Udbhav30/events{/privacy}","received_events_url":"https://api.github.com/users/Udbhav30/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nThis PR adds some tests converted from 'pgSQL/select_implicit.sql' to test UDFs\r\n<details><summary>Diff comparing to 'pgSQL/select_implicit.sql'</summary>\r\n<p>\r\n\r\n```diff\r\n... diff --git a/sql/core/src/test/resources/sql-tests/results/pgSQL/select_implicit.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-select_implicit.sql.out\r\nindex 0675820..e6a5995 100755\r\n--- a/sql/core/src/test/resources/sql-tests/results/pgSQL/select_implicit.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-select_implicit.sql.out\r\n@@ -91,9 +91,11 @@ struct<>\r\n \r\n \r\n -- !query 11\r\n-SELECT c, count(*) FROM test_missing_target GROUP BY test_missing_target.c ORDER BY c\r\n+SELECT udf(c), udf(count(*)) FROM test_missing_target GROUP BY\r\n+test_missing_target.c\r\n+ORDER BY udf(c)\r\n -- !query 11 schema\r\n-struct<c:string,count(1):bigint>\r\n+struct<CAST(udf(cast(c as string)) AS STRING):string,CAST(udf(cast(count(1) as string)) AS BIGINT):bigint>\r\n -- !query 11 output\r\n ABAB\t2\r\n BBBB\t2\r\n@@ -104,9 +106,10 @@ cccc\t2\r\n \r\n \r\n -- !query 12\r\n-SELECT count(*) FROM test_missing_target GROUP BY test_missing_target.c ORDER BY c\r\n+SELECT udf(count(*)) FROM test_missing_target GROUP BY test_missing_target.c\r\n+ORDER BY udf(c)\r\n -- !query 12 schema\r\n-struct<count(1):bigint>\r\n+struct<CAST(udf(cast(count(1) as string)) AS BIGINT):bigint>\r\n -- !query 12 output\r\n 2\r\n 2\r\n@@ -117,18 +120,18 @@ struct<count(1):bigint>\r\n \r\n \r\n -- !query 13\r\n-SELECT count(*) FROM test_missing_target GROUP BY a ORDER BY b\r\n+SELECT udf(count(*)) FROM test_missing_target GROUP BY a ORDER BY udf(b)\r\n -- !query 13 schema\r\n struct<>\r\n -- !query 13 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve '`b`' given input columns: [count(1)]; line 1 pos 61\r\n+cannot resolve '`b`' given input columns: [CAST(udf(cast(count(1) as string)) AS BIGINT)]; line 1 pos 70\r\n \r\n \r\n -- !query 14\r\n-SELECT count(*) FROM test_missing_target GROUP BY b ORDER BY b\r\n+SELECT udf(count(*)) FROM test_missing_target GROUP BY b ORDER BY udf(b)\r\n -- !query 14 schema\r\n-struct<count(1):bigint>\r\n+struct<CAST(udf(cast(count(1) as string)) AS BIGINT):bigint>\r\n -- !query 14 output\r\n 1\r\n 2\r\n@@ -137,10 +140,10 @@ struct<count(1):bigint>\r\n \r\n \r\n -- !query 15\r\n-SELECT test_missing_target.b, count(*)\r\n-  FROM test_missing_target GROUP BY b ORDER BY b\r\n+SELECT udf(test_missing_target.b), udf(count(*))\r\n+  FROM test_missing_target GROUP BY b ORDER BY udf(b)\r\n -- !query 15 schema\r\n-struct<b:int,count(1):bigint>\r\n+struct<CAST(udf(cast(b as string)) AS INT):int,CAST(udf(cast(count(1) as string)) AS BIGINT):bigint>\r\n -- !query 15 output\r\n 1\t1\r\n 2\t2\r\n@@ -149,9 +152,9 @@ struct<b:int,count(1):bigint>\r\n \r\n \r\n -- !query 16\r\n-SELECT c FROM test_missing_target ORDER BY a\r\n+SELECT udf(c) FROM test_missing_target ORDER BY udf(a)\r\n -- !query 16 schema\r\n-struct<c:string>\r\n+struct<CAST(udf(cast(c as string)) AS STRING):string>\r\n -- !query 16 output\r\n XXXX\r\n ABAB\r\n@@ -166,9 +169,9 @@ CCCC\r\n \r\n \r\n -- !query 17\r\n-SELECT count(*) FROM test_missing_target GROUP BY b ORDER BY b desc\r\n+SELECT udf(count(*)) FROM test_missing_target GROUP BY b ORDER BY udf(b) desc\r\n -- !query 17 schema\r\n-struct<count(1):bigint>\r\n+struct<CAST(udf(cast(count(1) as string)) AS BIGINT):bigint>\r\n -- !query 17 output\r\n 4\r\n 3\r\n@@ -177,17 +180,17 @@ struct<count(1):bigint>\r\n \r\n \r\n -- !query 18\r\n-SELECT count(*) FROM test_missing_target ORDER BY 1 desc\r\n+SELECT udf(count(*)) FROM test_missing_target ORDER BY udf(1) desc\r\n -- !query 18 schema\r\n-struct<count(1):bigint>\r\n+struct<CAST(udf(cast(count(1) as string)) AS BIGINT):bigint>\r\n -- !query 18 output\r\n 10\r\n \r\n \r\n -- !query 19\r\n-SELECT c, count(*) FROM test_missing_target GROUP BY 1 ORDER BY 1\r\n+SELECT udf(c), udf(count(*)) FROM test_missing_target GROUP BY 1 ORDER BY 1\r\n -- !query 19 schema\r\n-struct<c:string,count(1):bigint>\r\n+struct<CAST(udf(cast(c as string)) AS STRING):string,CAST(udf(cast(count(1) as string)) AS BIGINT):bigint>\r\n -- !query 19 output\r\n ABAB\t2\r\n BBBB\t2\r\n@@ -198,18 +201,18 @@ cccc\t2\r\n \r\n \r\n -- !query 20\r\n-SELECT c, count(*) FROM test_missing_target GROUP BY 3\r\n+SELECT udf(c), udf(count(*)) FROM test_missing_target GROUP BY 3\r\n -- !query 20 schema\r\n struct<>\r\n -- !query 20 output\r\n org.apache.spark.sql.AnalysisException\r\n-GROUP BY position 3 is not in select list (valid range is [1, 2]); line 1 pos 53\r\n+GROUP BY position 3 is not in select list (valid range is [1, 2]); line 1 pos 63\r\n \r\n \r\n -- !query 21\r\n-SELECT count(*) FROM test_missing_target x, test_missing_target y\r\n-\tWHERE x.a = y.a\r\n-\tGROUP BY b ORDER BY b\r\n+SELECT udf(count(*)) FROM test_missing_target x, test_missing_target y\r\n+\tWHERE udf(x.a) = udf(y.a)\r\n+\tGROUP BY b ORDER BY udf(b)\r\n -- !query 21 schema\r\n struct<>\r\n -- !query 21 output\r\n@@ -218,10 +221,10 @@ Reference 'b' is ambiguous, could be: x.b, y.b.; line 3 pos 10\r\n \r\n \r\n -- !query 22\r\n-SELECT a, a FROM test_missing_target\r\n-\tORDER BY a\r\n+SELECT udf(a), udf(a) FROM test_missing_target\r\n+\tORDER BY udf(a)\r\n -- !query 22 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int,CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 22 output\r\n 0\t0\r\n 1\t1\r\n@@ -236,10 +239,10 @@ struct<a:int,a:int>\r\n \r\n \r\n -- !query 23\r\n-SELECT a/2, a/2 FROM test_missing_target\r\n-\tORDER BY a/2\r\n+SELECT udf(udf(a)/2), udf(udf(a)/2) FROM test_missing_target\r\n+\tORDER BY udf(udf(a)/2)\r\n -- !query 23 schema\r\n-struct<(a div 2):int,(a div 2):int>\r\n+struct<CAST(udf(cast((cast(udf(cast(a as string)) as int) div 2) as string)) AS INT):int,CAST(udf(cast((cast(udf(cast(a as string)) as int) div 2) as string)) AS INT):int>\r\n -- !query 23 output\r\n 0\t0\r\n 0\t0\r\n@@ -254,10 +257,10 @@ struct<(a div 2):int,(a div 2):int>\r\n \r\n \r\n -- !query 24\r\n-SELECT a/2, a/2 FROM test_missing_target\r\n-\tGROUP BY a/2 ORDER BY a/2\r\n+SELECT udf(a/2), udf(a/2) FROM test_missing_target\r\n+\tGROUP BY a/2 ORDER BY udf(a/2)\r\n -- !query 24 schema\r\n-struct<(a div 2):int,(a div 2):int>\r\n+struct<CAST(udf(cast((a div 2) as string)) AS INT):int,CAST(udf(cast((a div 2) as string)) AS INT):int>\r\n -- !query 24 output\r\n 0\t0\r\n 1\t1\r\n@@ -267,11 +270,11 @@ struct<(a div 2):int,(a div 2):int>\r\n \r\n \r\n -- !query 25\r\n-SELECT x.b, count(*) FROM test_missing_target x, test_missing_target y\r\n-\tWHERE x.a = y.a\r\n-\tGROUP BY x.b ORDER BY x.b\r\n+SELECT udf(x.b), udf(count(*)) FROM test_missing_target x, test_missing_target y\r\n+\tWHERE udf(x.a) = udf(y.a)\r\n+\tGROUP BY x.b ORDER BY udf(x.b)\r\n -- !query 25 schema\r\n-struct<b:int,count(1):bigint>\r\n+struct<CAST(udf(cast(b as string)) AS INT):int,CAST(udf(cast(count(1) as string)) AS BIGINT):bigint>\r\n -- !query 25 output\r\n 1\t1\r\n 2\t2\r\n@@ -280,11 +283,11 @@ struct<b:int,count(1):bigint>\r\n \r\n \r\n -- !query 26\r\n-SELECT count(*) FROM test_missing_target x, test_missing_target y\r\n-\tWHERE x.a = y.a\r\n-\tGROUP BY x.b ORDER BY x.b\r\n+SELECT udf(count(*)) FROM test_missing_target x, test_missing_target y\r\n+\tWHERE udf(x.a) = udf(y.a)\r\n+\tGROUP BY x.b ORDER BY udf(x.b)\r\n -- !query 26 schema\r\n-struct<count(1):bigint>\r\n+struct<CAST(udf(cast(count(1) as string)) AS BIGINT):bigint>\r\n -- !query 26 output\r\n 1\r\n 2\r\n@@ -293,22 +296,22 @@ struct<count(1):bigint>\r\n \r\n \r\n -- !query 27\r\n-SELECT a%2, count(b) FROM test_missing_target\r\n+SELECT a%2, udf(count(udf(b))) FROM test_missing_target\r\n GROUP BY test_missing_target.a%2\r\n-ORDER BY test_missing_target.a%2\r\n+ORDER BY udf(test_missing_target.a%2)\r\n -- !query 27 schema\r\n-struct<(a % 2):int,count(b):bigint>\r\n+struct<(a % 2):int,CAST(udf(cast(count(cast(udf(cast(b as string)) as int)) as string)) AS BIGINT):bigint>\r\n -- !query 27 output\r\n 0\t5\r\n 1\t5\r\n \r\n \r\n -- !query 28\r\n-SELECT count(c) FROM test_missing_target\r\n+SELECT udf(count(c)) FROM test_missing_target\r\n GROUP BY lower(test_missing_target.c)\r\n-ORDER BY lower(test_missing_target.c)\r\n+ORDER BY udf(lower(test_missing_target.c))\r\n -- !query 28 schema\r\n-struct<count(c):bigint>\r\n+struct<CAST(udf(cast(count(c) as string)) AS BIGINT):bigint>\r\n -- !query 28 output\r\n 2\r\n 3\r\n@@ -317,18 +320,18 @@ struct<count(c):bigint>\r\n \r\n \r\n -- !query 29\r\n-SELECT count(a) FROM test_missing_target GROUP BY a ORDER BY b\r\n+SELECT udf(count(udf(a))) FROM test_missing_target GROUP BY a ORDER BY udf(b)\r\n -- !query 29 schema\r\n struct<>\r\n -- !query 29 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve '`b`' given input columns: [count(a)]; line 1 pos 61\r\n+cannot resolve '`b`' given input columns: [CAST(udf(cast(count(cast(udf(cast(a as string)) as int)) as string)) AS BIGINT)]; line 1 pos 75\r\n \r\n \r\n -- !query 30\r\n-SELECT count(b) FROM test_missing_target GROUP BY b/2 ORDER BY b/2\r\n+SELECT udf(count(b)) FROM test_missing_target GROUP BY b/2 ORDER BY udf(b/2)\r\n -- !query 30 schema\r\n-struct<count(b):bigint>\r\n+struct<CAST(udf(cast(count(b) as string)) AS BIGINT):bigint>\r\n -- !query 30 output\r\n 1\r\n 5\r\n@@ -336,10 +339,10 @@ struct<count(b):bigint>\r\n \r\n \r\n -- !query 31\r\n-SELECT lower(test_missing_target.c), count(c)\r\n-  FROM test_missing_target GROUP BY lower(c) ORDER BY lower(c)\r\n+SELECT udf(lower(test_missing_target.c)), udf(count(udf(c)))\r\n+  FROM test_missing_target GROUP BY lower(c) ORDER BY udf(lower(c))\r\n -- !query 31 schema\r\n-struct<lower(c):string,count(c):bigint>\r\n+struct<CAST(udf(cast(lower(c) as string)) AS STRING):string,CAST(udf(cast(count(cast(udf(cast(c as string)) as string)) as string)) AS BIGINT):bigint>\r\n -- !query 31 output\r\n abab\t2\r\n bbbb\t3\r\n@@ -348,9 +351,9 @@ xxxx\t1\r\n \r\n \r\n -- !query 32\r\n-SELECT a FROM test_missing_target ORDER BY upper(d)\r\n+SELECT udf(a) FROM test_missing_target ORDER BY udf(upper(udf(d)))\r\n -- !query 32 schema\r\n-struct<a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 32 output\r\n 0\r\n 1\r\n@@ -365,19 +368,19 @@ struct<a:int>\r\n \r\n \r\n -- !query 33\r\n-SELECT count(b) FROM test_missing_target\r\n-\tGROUP BY (b + 1) / 2 ORDER BY (b + 1) / 2 desc\r\n+SELECT udf(count(b)) FROM test_missing_target\r\n+\tGROUP BY (b + 1) / 2 ORDER BY udf((b + 1) / 2) desc\r\n -- !query 33 schema\r\n-struct<count(b):bigint>\r\n+struct<CAST(udf(cast(count(b) as string)) AS BIGINT):bigint>\r\n -- !query 33 output\r\n 7\r\n 3\r\n \r\n \r\n -- !query 34\r\n-SELECT count(x.a) FROM test_missing_target x, test_missing_target y\r\n-\tWHERE x.a = y.a\r\n-\tGROUP BY b/2 ORDER BY b/2\r\n+SELECT udf(count(udf(x.a))) FROM test_missing_target x, test_missing_target y\r\n+\tWHERE udf(x.a) = udf(y.a)\r\n+\tGROUP BY b/2 ORDER BY udf(b/2)\r\n -- !query 34 schema\r\n struct<>\r\n -- !query 34 output\r\n@@ -386,11 +389,12 @@ Reference 'b' is ambiguous, could be: x.b, y.b.; line 3 pos 10\r\n \r\n \r\n -- !query 35\r\n-SELECT x.b/2, count(x.b) FROM test_missing_target x, test_missing_target y\r\n-\tWHERE x.a = y.a\r\n-\tGROUP BY x.b/2 ORDER BY x.b/2\r\n+SELECT udf(x.b/2), udf(count(udf(x.b))) FROM test_missing_target x,\r\n+test_missing_target y\r\n+\tWHERE udf(x.a) = udf(y.a)\r\n+\tGROUP BY x.b/2 ORDER BY udf(x.b/2)\r\n -- !query 35 schema\r\n-struct<(b div 2):int,count(b):bigint>\r\n+struct<CAST(udf(cast((b div 2) as string)) AS INT):int,CAST(udf(cast(count(cast(udf(cast(b as string)) as int)) as string)) AS BIGINT):bigint>\r\n -- !query 35 output\r\n 0\t1\r\n 1\t5\r\n@@ -398,14 +402,14 @@ struct<(b div 2):int,count(b):bigint>\r\n \r\n \r\n -- !query 36\r\n-SELECT count(b) FROM test_missing_target x, test_missing_target y\r\n-\tWHERE x.a = y.a\r\n+SELECT udf(count(udf(b))) FROM test_missing_target x, test_missing_target y\r\n+\tWHERE udf(x.a) = udf(y.a)\r\n \tGROUP BY x.b/2\r\n -- !query 36 schema\r\n struct<>\r\n -- !query 36 output\r\n org.apache.spark.sql.AnalysisException\r\n-Reference 'b' is ambiguous, could be: x.b, y.b.; line 1 pos 13\r\n+Reference 'b' is ambiguous, could be: x.b, y.b.; line 1 pos 21\r\n \r\n \r\n -- !query 37\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\nTested as Guided in SPARK-27921","created_at":"2019-07-23T05:42:02Z","updated_at":"2020-02-05T18:26:35Z","closed_at":"2019-07-24T00:51:52Z","merged_at":null,"merge_commit_sha":"f1de5c4f3c8dd1ec13bcc37755398f955850a036","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25233/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25233/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25233/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6a983f80b07a0c6ff22aa9bde5117c488e775c2e","head":{"label":"Udbhav30:master","ref":"master","sha":"6a983f80b07a0c6ff22aa9bde5117c488e775c2e","user":{"login":"Udbhav30","id":44489863,"node_id":"MDQ6VXNlcjQ0NDg5ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44489863?v=4","gravatar_id":"","url":"https://api.github.com/users/Udbhav30","html_url":"https://github.com/Udbhav30","followers_url":"https://api.github.com/users/Udbhav30/followers","following_url":"https://api.github.com/users/Udbhav30/following{/other_user}","gists_url":"https://api.github.com/users/Udbhav30/gists{/gist_id}","starred_url":"https://api.github.com/users/Udbhav30/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Udbhav30/subscriptions","organizations_url":"https://api.github.com/users/Udbhav30/orgs","repos_url":"https://api.github.com/users/Udbhav30/repos","events_url":"https://api.github.com/users/Udbhav30/events{/privacy}","received_events_url":"https://api.github.com/users/Udbhav30/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":155533105,"node_id":"MDEwOlJlcG9zaXRvcnkxNTU1MzMxMDU=","name":"spark","full_name":"Udbhav30/spark","private":false,"owner":{"login":"Udbhav30","id":44489863,"node_id":"MDQ6VXNlcjQ0NDg5ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44489863?v=4","gravatar_id":"","url":"https://api.github.com/users/Udbhav30","html_url":"https://github.com/Udbhav30","followers_url":"https://api.github.com/users/Udbhav30/followers","following_url":"https://api.github.com/users/Udbhav30/following{/other_user}","gists_url":"https://api.github.com/users/Udbhav30/gists{/gist_id}","starred_url":"https://api.github.com/users/Udbhav30/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Udbhav30/subscriptions","organizations_url":"https://api.github.com/users/Udbhav30/orgs","repos_url":"https://api.github.com/users/Udbhav30/repos","events_url":"https://api.github.com/users/Udbhav30/events{/privacy}","received_events_url":"https://api.github.com/users/Udbhav30/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Udbhav30/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/Udbhav30/spark","forks_url":"https://api.github.com/repos/Udbhav30/spark/forks","keys_url":"https://api.github.com/repos/Udbhav30/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Udbhav30/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Udbhav30/spark/teams","hooks_url":"https://api.github.com/repos/Udbhav30/spark/hooks","issue_events_url":"https://api.github.com/repos/Udbhav30/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Udbhav30/spark/events","assignees_url":"https://api.github.com/repos/Udbhav30/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Udbhav30/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Udbhav30/spark/tags","blobs_url":"https://api.github.com/repos/Udbhav30/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Udbhav30/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Udbhav30/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Udbhav30/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Udbhav30/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Udbhav30/spark/languages","stargazers_url":"https://api.github.com/repos/Udbhav30/spark/stargazers","contributors_url":"https://api.github.com/repos/Udbhav30/spark/contributors","subscribers_url":"https://api.github.com/repos/Udbhav30/spark/subscribers","subscription_url":"https://api.github.com/repos/Udbhav30/spark/subscription","commits_url":"https://api.github.com/repos/Udbhav30/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Udbhav30/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Udbhav30/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Udbhav30/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Udbhav30/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Udbhav30/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Udbhav30/spark/merges","archive_url":"https://api.github.com/repos/Udbhav30/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Udbhav30/spark/downloads","issues_url":"https://api.github.com/repos/Udbhav30/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Udbhav30/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Udbhav30/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Udbhav30/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Udbhav30/spark/labels{/name}","releases_url":"https://api.github.com/repos/Udbhav30/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Udbhav30/spark/deployments","created_at":"2018-10-31T09:42:39Z","updated_at":"2019-08-12T13:11:57Z","pushed_at":"2020-09-17T16:03:55Z","git_url":"git://github.com/Udbhav30/spark.git","ssh_url":"git@github.com:Udbhav30/spark.git","clone_url":"https://github.com/Udbhav30/spark.git","svn_url":"https://github.com/Udbhav30/spark","homepage":null,"size":334866,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"022667cea666190bea651a3873234700a472326c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25233"},"html":{"href":"https://github.com/apache/spark/pull/25233"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25233"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25233/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25233/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25233/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6a983f80b07a0c6ff22aa9bde5117c488e775c2e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25232","id":299970260,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5OTcwMjYw","html_url":"https://github.com/apache/spark/pull/25232","diff_url":"https://github.com/apache/spark/pull/25232.diff","patch_url":"https://github.com/apache/spark/pull/25232.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25232","number":25232,"state":"closed","locked":false,"title":"[SPARK-28475][CORE] Add regex MetricFilter to GraphiteSink","user":{"login":"nkarpov","id":1390267,"node_id":"MDQ6VXNlcjEzOTAyNjc=","avatar_url":"https://avatars.githubusercontent.com/u/1390267?v=4","gravatar_id":"","url":"https://api.github.com/users/nkarpov","html_url":"https://github.com/nkarpov","followers_url":"https://api.github.com/users/nkarpov/followers","following_url":"https://api.github.com/users/nkarpov/following{/other_user}","gists_url":"https://api.github.com/users/nkarpov/gists{/gist_id}","starred_url":"https://api.github.com/users/nkarpov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nkarpov/subscriptions","organizations_url":"https://api.github.com/users/nkarpov/orgs","repos_url":"https://api.github.com/users/nkarpov/repos","events_url":"https://api.github.com/users/nkarpov/events{/privacy}","received_events_url":"https://api.github.com/users/nkarpov/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nToday all registered metric sources are reported to GraphiteSink with no filtering mechanism, although the codahale project does support it.\r\n\r\nGraphiteReporter (ScheduledReporter) from the codahale project requires you implement and supply the MetricFilter interface (there is only a single implementation by default in the codahale project, MetricFilter.ALL).\r\n\r\nPropose to add an additional regex config to match and filter metrics to the GraphiteSink\r\n\r\n## How was this patch tested?\r\n\r\nIncluded a GraphiteSinkSuite that tests:\r\n\r\n1. Absence of regex filter (existing default behavior maintained)\r\n2. Presence of `regex=<regexexpr>` correctly filters metric keys\r\n","created_at":"2019-07-22T17:41:07Z","updated_at":"2019-08-02T16:18:58Z","closed_at":"2019-08-02T09:55:38Z","merged_at":null,"merge_commit_sha":"8fb6c021f1ff22bb288389355dc4adce0515c1fd","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25232/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25232/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25232/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/768777aefb588b52b227d7254c6f46a5e55a1d5f","head":{"label":"nkarpov:graphite_regex","ref":"graphite_regex","sha":"768777aefb588b52b227d7254c6f46a5e55a1d5f","user":{"login":"nkarpov","id":1390267,"node_id":"MDQ6VXNlcjEzOTAyNjc=","avatar_url":"https://avatars.githubusercontent.com/u/1390267?v=4","gravatar_id":"","url":"https://api.github.com/users/nkarpov","html_url":"https://github.com/nkarpov","followers_url":"https://api.github.com/users/nkarpov/followers","following_url":"https://api.github.com/users/nkarpov/following{/other_user}","gists_url":"https://api.github.com/users/nkarpov/gists{/gist_id}","starred_url":"https://api.github.com/users/nkarpov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nkarpov/subscriptions","organizations_url":"https://api.github.com/users/nkarpov/orgs","repos_url":"https://api.github.com/users/nkarpov/repos","events_url":"https://api.github.com/users/nkarpov/events{/privacy}","received_events_url":"https://api.github.com/users/nkarpov/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"5b378e6efc43753965e97e319770c9832b1e8e58","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25232"},"html":{"href":"https://github.com/apache/spark/pull/25232"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25232"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25232/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25232/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25232/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/768777aefb588b52b227d7254c6f46a5e55a1d5f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25231","id":299908079,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5OTA4MDc5","html_url":"https://github.com/apache/spark/pull/25231","diff_url":"https://github.com/apache/spark/pull/25231.diff","patch_url":"https://github.com/apache/spark/pull/25231.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25231","number":25231,"state":"closed","locked":false,"title":"[SPARK-28473][DOC] Stylistic consistency of build command in README","user":{"login":"Mister-Meeseeks","id":18204987,"node_id":"MDQ6VXNlcjE4MjA0OTg3","avatar_url":"https://avatars.githubusercontent.com/u/18204987?v=4","gravatar_id":"","url":"https://api.github.com/users/Mister-Meeseeks","html_url":"https://github.com/Mister-Meeseeks","followers_url":"https://api.github.com/users/Mister-Meeseeks/followers","following_url":"https://api.github.com/users/Mister-Meeseeks/following{/other_user}","gists_url":"https://api.github.com/users/Mister-Meeseeks/gists{/gist_id}","starred_url":"https://api.github.com/users/Mister-Meeseeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mister-Meeseeks/subscriptions","organizations_url":"https://api.github.com/users/Mister-Meeseeks/orgs","repos_url":"https://api.github.com/users/Mister-Meeseeks/repos","events_url":"https://api.github.com/users/Mister-Meeseeks/events{/privacy}","received_events_url":"https://api.github.com/users/Mister-Meeseeks/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nChange the format of the build command in the README to start with a `./` prefix\r\n\r\n    ./build/mvn -DskipTests clean package\r\n\r\nThis increases stylistic consistency across the README- all the other commands have a `./` prefix. Having a visible `./` prefix also makes it clear to the user that the shell command requires the current working directory to be at the repository root. \r\n\r\n## How was this patch tested?\r\n\r\nREADME.md was reviewed both in raw markdown and in the Github rendered landing page for stylistic consistency. ","created_at":"2019-07-22T14:34:11Z","updated_at":"2019-07-23T23:34:18Z","closed_at":"2019-07-23T23:34:18Z","merged_at":null,"merge_commit_sha":"6a55ea88c938b96eb9de113e1ffabeb9ed68a365","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627011,"node_id":"MDU6TGFiZWwxNDA2NjI3MDEx","url":"https://api.github.com/repos/apache/spark/labels/DOCUMENTATION","name":"DOCUMENTATION","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25231/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25231/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25231/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/53d59fcd82c77775390bb8142342c7f048893d82","head":{"label":"Mister-Meeseeks:master","ref":"master","sha":"53d59fcd82c77775390bb8142342c7f048893d82","user":{"login":"Mister-Meeseeks","id":18204987,"node_id":"MDQ6VXNlcjE4MjA0OTg3","avatar_url":"https://avatars.githubusercontent.com/u/18204987?v=4","gravatar_id":"","url":"https://api.github.com/users/Mister-Meeseeks","html_url":"https://github.com/Mister-Meeseeks","followers_url":"https://api.github.com/users/Mister-Meeseeks/followers","following_url":"https://api.github.com/users/Mister-Meeseeks/following{/other_user}","gists_url":"https://api.github.com/users/Mister-Meeseeks/gists{/gist_id}","starred_url":"https://api.github.com/users/Mister-Meeseeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mister-Meeseeks/subscriptions","organizations_url":"https://api.github.com/users/Mister-Meeseeks/orgs","repos_url":"https://api.github.com/users/Mister-Meeseeks/repos","events_url":"https://api.github.com/users/Mister-Meeseeks/events{/privacy}","received_events_url":"https://api.github.com/users/Mister-Meeseeks/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":198236116,"node_id":"MDEwOlJlcG9zaXRvcnkxOTgyMzYxMTY=","name":"spark","full_name":"Mister-Meeseeks/spark","private":false,"owner":{"login":"Mister-Meeseeks","id":18204987,"node_id":"MDQ6VXNlcjE4MjA0OTg3","avatar_url":"https://avatars.githubusercontent.com/u/18204987?v=4","gravatar_id":"","url":"https://api.github.com/users/Mister-Meeseeks","html_url":"https://github.com/Mister-Meeseeks","followers_url":"https://api.github.com/users/Mister-Meeseeks/followers","following_url":"https://api.github.com/users/Mister-Meeseeks/following{/other_user}","gists_url":"https://api.github.com/users/Mister-Meeseeks/gists{/gist_id}","starred_url":"https://api.github.com/users/Mister-Meeseeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mister-Meeseeks/subscriptions","organizations_url":"https://api.github.com/users/Mister-Meeseeks/orgs","repos_url":"https://api.github.com/users/Mister-Meeseeks/repos","events_url":"https://api.github.com/users/Mister-Meeseeks/events{/privacy}","received_events_url":"https://api.github.com/users/Mister-Meeseeks/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Mister-Meeseeks/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/Mister-Meeseeks/spark","forks_url":"https://api.github.com/repos/Mister-Meeseeks/spark/forks","keys_url":"https://api.github.com/repos/Mister-Meeseeks/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Mister-Meeseeks/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Mister-Meeseeks/spark/teams","hooks_url":"https://api.github.com/repos/Mister-Meeseeks/spark/hooks","issue_events_url":"https://api.github.com/repos/Mister-Meeseeks/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Mister-Meeseeks/spark/events","assignees_url":"https://api.github.com/repos/Mister-Meeseeks/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Mister-Meeseeks/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Mister-Meeseeks/spark/tags","blobs_url":"https://api.github.com/repos/Mister-Meeseeks/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Mister-Meeseeks/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Mister-Meeseeks/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Mister-Meeseeks/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Mister-Meeseeks/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Mister-Meeseeks/spark/languages","stargazers_url":"https://api.github.com/repos/Mister-Meeseeks/spark/stargazers","contributors_url":"https://api.github.com/repos/Mister-Meeseeks/spark/contributors","subscribers_url":"https://api.github.com/repos/Mister-Meeseeks/spark/subscribers","subscription_url":"https://api.github.com/repos/Mister-Meeseeks/spark/subscription","commits_url":"https://api.github.com/repos/Mister-Meeseeks/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Mister-Meeseeks/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Mister-Meeseeks/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Mister-Meeseeks/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Mister-Meeseeks/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Mister-Meeseeks/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Mister-Meeseeks/spark/merges","archive_url":"https://api.github.com/repos/Mister-Meeseeks/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Mister-Meeseeks/spark/downloads","issues_url":"https://api.github.com/repos/Mister-Meeseeks/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Mister-Meeseeks/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Mister-Meeseeks/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Mister-Meeseeks/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Mister-Meeseeks/spark/labels{/name}","releases_url":"https://api.github.com/repos/Mister-Meeseeks/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Mister-Meeseeks/spark/deployments","created_at":"2019-07-22T14:09:00Z","updated_at":"2019-07-23T16:12:41Z","pushed_at":"2019-07-23T16:12:34Z","git_url":"git://github.com/Mister-Meeseeks/spark.git","ssh_url":"git@github.com:Mister-Meeseeks/spark.git","clone_url":"https://github.com/Mister-Meeseeks/spark.git","svn_url":"https://github.com/Mister-Meeseeks/spark","homepage":"","size":300798,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5b378e6efc43753965e97e319770c9832b1e8e58","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25231"},"html":{"href":"https://github.com/apache/spark/pull/25231"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25231"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25231/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25231/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25231/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/53d59fcd82c77775390bb8142342c7f048893d82"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25230","id":299903278,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5OTAzMjc4","html_url":"https://github.com/apache/spark/pull/25230","diff_url":"https://github.com/apache/spark/pull/25230.diff","patch_url":"https://github.com/apache/spark/pull/25230.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25230","number":25230,"state":"closed","locked":false,"title":"[SPARK-28471][SQL] Replace `yyyy` by `uuuu` in date-timestamp patterns without era","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nIn the PR, I propose to use `uuuu` for years instead of `yyyy` in date/timestamp patterns without the era pattern `G` (https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html). **Parsing/formatting of positive years (current era) will be the same.** The difference is in formatting negative years belong to previous era - BC (Before Christ).\r\n\r\nI replaced the `yyyy` pattern by `uuuu` everywhere except:\r\n1. Test, Suite & Benchmark. Existing tests must work as is.\r\n2. `SimpleDateFormat` because it doesn't support the `uuuu` pattern.\r\n3. Comments and examples (except comments related to already replaced patterns).\r\n\r\nBefore the changes, the year of common era `100` and the year of BC era `-99`, showed similarly as `100`.  After the changes negative years will be formatted with the `-` sign.\r\n\r\nBefore:\r\n```Scala\r\nscala> Seq(java.time.LocalDate.of(-99, 1, 1)).toDF().show\r\n+----------+\r\n|     value|\r\n+----------+\r\n|0100-01-01|\r\n+----------+\r\n``` \r\n\r\nAfter:\r\n```Scala\r\nscala> Seq(java.time.LocalDate.of(-99, 1, 1)).toDF().show\r\n+-----------+\r\n|      value|\r\n+-----------+\r\n|-0099-01-01|\r\n+-----------+\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nBy existing test suites, and added tests for negative years to `DateFormatterSuite` and `TimestampFormatterSuite`.","created_at":"2019-07-22T14:23:25Z","updated_at":"2019-09-18T15:58:21Z","closed_at":"2019-07-29T03:41:07Z","merged_at":null,"merge_commit_sha":"e1631c69208e7d7698488b699c6c4d7fce9c3bf6","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25230/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25230/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25230/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b47d6d574d9b2fb32a56301c0c6a1b01fd935b80","head":{"label":"MaxGekk:year-pattern-uuuu","ref":"year-pattern-uuuu","sha":"b47d6d574d9b2fb32a56301c0c6a1b01fd935b80","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":123690489,"node_id":"MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=","name":"spark","full_name":"MaxGekk/spark","private":false,"owner":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/MaxGekk/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/MaxGekk/spark","forks_url":"https://api.github.com/repos/MaxGekk/spark/forks","keys_url":"https://api.github.com/repos/MaxGekk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/MaxGekk/spark/teams","hooks_url":"https://api.github.com/repos/MaxGekk/spark/hooks","issue_events_url":"https://api.github.com/repos/MaxGekk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/MaxGekk/spark/events","assignees_url":"https://api.github.com/repos/MaxGekk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/MaxGekk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/MaxGekk/spark/tags","blobs_url":"https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/MaxGekk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/MaxGekk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/MaxGekk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/MaxGekk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/MaxGekk/spark/languages","stargazers_url":"https://api.github.com/repos/MaxGekk/spark/stargazers","contributors_url":"https://api.github.com/repos/MaxGekk/spark/contributors","subscribers_url":"https://api.github.com/repos/MaxGekk/spark/subscribers","subscription_url":"https://api.github.com/repos/MaxGekk/spark/subscription","commits_url":"https://api.github.com/repos/MaxGekk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/MaxGekk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/MaxGekk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/MaxGekk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/MaxGekk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/MaxGekk/spark/merges","archive_url":"https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/MaxGekk/spark/downloads","issues_url":"https://api.github.com/repos/MaxGekk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/MaxGekk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/MaxGekk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/MaxGekk/spark/labels{/name}","releases_url":"https://api.github.com/repos/MaxGekk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/MaxGekk/spark/deployments","created_at":"2018-03-03T12:37:00Z","updated_at":"2025-02-07T09:44:52Z","pushed_at":"2025-02-07T09:44:24Z","git_url":"git://github.com/MaxGekk/spark.git","ssh_url":"git@github.com:MaxGekk/spark.git","clone_url":"https://github.com/MaxGekk/spark.git","svn_url":"https://github.com/MaxGekk/spark","homepage":null,"size":486456,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"022667cea666190bea651a3873234700a472326c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25230"},"html":{"href":"https://github.com/apache/spark/pull/25230"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25230"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25230/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25230/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25230/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b47d6d574d9b2fb32a56301c0c6a1b01fd935b80"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25229","id":299861577,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5ODYxNTc3","html_url":"https://github.com/apache/spark/pull/25229","diff_url":"https://github.com/apache/spark/pull/25229.diff","patch_url":"https://github.com/apache/spark/pull/25229.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25229","number":25229,"state":"closed","locked":false,"title":"[SPARK-27900][K8s] Add jvm oom flag","user":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n- Adds a flag to make the driver exit in case of an oom error in the entrypoint script. \r\n- Adds integration tests for supporting de-activation of the flag if the user wishes.\r\n- adds verbose flag support within the driver's container.\r\nNote: This follows the discussion here: https://github.com/apache/spark/pull/24796. Without this pods on K8s will keep running although Spark has failed. In addition current behavior creates a problem to the Spark Operator and any other operator as it cannot detect failure at the K8s level.\r\n\r\n## How was this patch tested?\r\n\r\nManually by launching SparkPi with a large number `100000000` which leads to an oom due to the large number of tasks allocated.\r\n```\r\n $kubectl logs spark-pi-a59f4d6c44b525a9-driver -n spark\r\n\r\n19/07/30 21:07:08 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, spark-pi-a59f4d6c44b525a9-driver-svc.spark.svc, 7079, None)\r\n19/07/30 21:07:08 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, spark-pi-a59f4d6c44b525a9-driver-svc.spark.svc, 7079, None)\r\n19/07/30 21:07:14 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.17.0.5:55032) with ID 1\r\n19/07/30 21:07:14 INFO BlockManagerMasterEndpoint: Registering block manager 172.17.0.5:43067 with 413.9 MiB RAM, BlockManagerId(1, 172.17.0.5, 43067, None)\r\n19/07/30 21:07:15 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.17.0.6:37344) with ID 2\r\n19/07/30 21:07:15 INFO KubernetesClusterSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.8\r\n19/07/30 21:07:16 INFO BlockManagerMasterEndpoint: Registering block manager 172.17.0.6:46213 with 413.9 MiB RAM, BlockManagerId(2, 172.17.0.6, 46213, None)\r\n#\r\n# java.lang.OutOfMemoryError: Java heap space\r\n# -XX:OnOutOfMemoryError=\"kill -9 %p\"\r\n#   Executing /bin/sh -c \"kill -9 19\"...\r\n```\r\n```\r\n$ kubectl get pods spark-pi-8387506c19ad344d-driver  -n spark -o yaml\r\n....\r\n    state:\r\n      terminated:\r\n        containerID: docker://b3410c57d0e7424ec0af6cac4108669222210d80184d690ebeeb9494cf25e6f2\r\n        exitCode: 137\r\n        finishedAt: \"2019-07-30T21:08:29Z\"\r\n        reason: Error\r\n        startedAt: \"2019-07-30T21:07:04Z\"\r\n```\r\n\r\n","created_at":"2019-07-22T12:43:51Z","updated_at":"2019-10-18T09:59:39Z","closed_at":"2019-10-18T09:59:39Z","merged_at":null,"merge_commit_sha":"e9f7d5f1f3ab084562ba129d62057882ef9d2171","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406605057,"node_id":"MDU6TGFiZWwxNDA2NjA1MDU3","url":"https://api.github.com/repos/apache/spark/labels/KUBERNETES","name":"KUBERNETES","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25229/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25229/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25229/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7cfcefc59a4a2c9c99b737ac4cb559885c8d9489","head":{"label":"skonto:add_oom_flag","ref":"add_oom_flag","sha":"7cfcefc59a4a2c9c99b737ac4cb559885c8d9489","user":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":48892104,"node_id":"MDEwOlJlcG9zaXRvcnk0ODg5MjEwNA==","name":"spark","full_name":"skonto/spark","private":false,"owner":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/skonto/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/skonto/spark","forks_url":"https://api.github.com/repos/skonto/spark/forks","keys_url":"https://api.github.com/repos/skonto/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/skonto/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/skonto/spark/teams","hooks_url":"https://api.github.com/repos/skonto/spark/hooks","issue_events_url":"https://api.github.com/repos/skonto/spark/issues/events{/number}","events_url":"https://api.github.com/repos/skonto/spark/events","assignees_url":"https://api.github.com/repos/skonto/spark/assignees{/user}","branches_url":"https://api.github.com/repos/skonto/spark/branches{/branch}","tags_url":"https://api.github.com/repos/skonto/spark/tags","blobs_url":"https://api.github.com/repos/skonto/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/skonto/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/skonto/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/skonto/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/skonto/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/skonto/spark/languages","stargazers_url":"https://api.github.com/repos/skonto/spark/stargazers","contributors_url":"https://api.github.com/repos/skonto/spark/contributors","subscribers_url":"https://api.github.com/repos/skonto/spark/subscribers","subscription_url":"https://api.github.com/repos/skonto/spark/subscription","commits_url":"https://api.github.com/repos/skonto/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/skonto/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/skonto/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/skonto/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/skonto/spark/contents/{+path}","compare_url":"https://api.github.com/repos/skonto/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/skonto/spark/merges","archive_url":"https://api.github.com/repos/skonto/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/skonto/spark/downloads","issues_url":"https://api.github.com/repos/skonto/spark/issues{/number}","pulls_url":"https://api.github.com/repos/skonto/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/skonto/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/skonto/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/skonto/spark/labels{/name}","releases_url":"https://api.github.com/repos/skonto/spark/releases{/id}","deployments_url":"https://api.github.com/repos/skonto/spark/deployments","created_at":"2016-01-01T23:02:52Z","updated_at":"2023-10-13T14:17:45Z","pushed_at":"2023-10-13T14:15:23Z","git_url":"git://github.com/skonto/spark.git","ssh_url":"git@github.com:skonto/spark.git","clone_url":"https://github.com/skonto/spark.git","svn_url":"https://github.com/skonto/spark","homepage":null,"size":395104,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"121f9338cefbb1c800fabfea5152899a58176b00","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25229"},"html":{"href":"https://github.com/apache/spark/pull/25229"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25229"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25229/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25229/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25229/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7cfcefc59a4a2c9c99b737ac4cb559885c8d9489"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25228","id":299833527,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5ODMzNTI3","html_url":"https://github.com/apache/spark/pull/25228","diff_url":"https://github.com/apache/spark/pull/25228.diff","patch_url":"https://github.com/apache/spark/pull/25228.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25228","number":25228,"state":"closed","locked":false,"title":"[SPARK-28472][SQL][TEST] Add test for thriftserver protocol versions","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis pr adds a test(`SparkThriftServerProtocolVersionsSuite`) to test different versions of the thrift protocol because we use different logic to handle the `RowSet`:\r\nhttps://github.com/apache/spark/blob/02c33694c8254f69cb36c71c0876194dccdbc014/sql/hive-thriftserver/v1.2.1/src/main/java/org/apache/hive/service/cli/RowSetFactory.java#L28-L40\r\n\r\nWhen adding this test cases, found three bugs:\r\n[SPARK-26969](https://issues.apache.org/jira/browse/SPARK-26969): Using ODBC not able to see the data in table when datatype is decimal\r\n[SPARK-28463](https://issues.apache.org/jira/browse/SPARK-28463): Thriftserver throws BigDecimal incompatible with HiveDecimal\r\n[SPARK-28474](https://issues.apache.org/jira/browse/SPARK-28474): Lower JDBC client version(Hive 0.12) cannot read binary type\r\n\r\n\r\n## How was this patch tested?\r\n\r\nN/A\r\n","created_at":"2019-07-22T11:23:09Z","updated_at":"2019-08-07T15:57:45Z","closed_at":"2019-08-07T15:56:58Z","merged_at":null,"merge_commit_sha":"ecc1a7eb436051e4a5b2995d6aedea8ec5a2a27a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25228/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25228/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25228/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1c9afae88de80a69c872488d520574f37ff95ec3","head":{"label":"wangyum:SPARK-28472","ref":"SPARK-28472","sha":"1c9afae88de80a69c872488d520574f37ff95ec3","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"128ea37bda3dbc1d6ba2af762c7453ab7605d430","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25228"},"html":{"href":"https://github.com/apache/spark/pull/25228"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25228"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25228/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25228/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25228/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1c9afae88de80a69c872488d520574f37ff95ec3"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25227","id":299737233,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NzM3MjMz","html_url":"https://github.com/apache/spark/pull/25227","diff_url":"https://github.com/apache/spark/pull/25227.diff","patch_url":"https://github.com/apache/spark/pull/25227.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25227","number":25227,"state":"closed","locked":false,"title":"[SPARK-28467][CORE][TEST] Increase timeout to up executors for tests","user":{"login":"huangtianhua","id":5117792,"node_id":"MDQ6VXNlcjUxMTc3OTI=","avatar_url":"https://avatars.githubusercontent.com/u/5117792?v=4","gravatar_id":"","url":"https://api.github.com/users/huangtianhua","html_url":"https://github.com/huangtianhua","followers_url":"https://api.github.com/users/huangtianhua/followers","following_url":"https://api.github.com/users/huangtianhua/following{/other_user}","gists_url":"https://api.github.com/users/huangtianhua/gists{/gist_id}","starred_url":"https://api.github.com/users/huangtianhua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huangtianhua/subscriptions","organizations_url":"https://api.github.com/users/huangtianhua/orgs","repos_url":"https://api.github.com/users/huangtianhua/repos","events_url":"https://api.github.com/users/huangtianhua/events{/privacy}","received_events_url":"https://api.github.com/users/huangtianhua/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"[SPARK-28467][CORE] Increase timeout to up executors for tests\r\n\r\nWe use arm instance of vexxhost cloud to run the test, the flavor of the arm instance is 8C8G. And we ran the tests for several times(everytime the instance is new created) and the executor(2 required in test) can't up under 10000ms. The two tests mentioned in [SPARK-28467] is always failed due to timeout(now only these two tests failed due this reason):\r\ntest driver discovery under local-cluster mode *** FAILED ***\r\njava.util.concurrent.TimeoutException: Can't find 1 executors before 10000 milliseconds elapsed\r\n......\r\ntest gpu driver resource files and discovery under local-cluster mode *** FAILED ***\r\njava.util.concurrent.TimeoutException: Can't find 1 executors before 10000 milliseconds elapsed\r\n......\r\n\r\nAnd the environment is: Linux ubuntu 4.15.0-46-generic #4916.04.1-Ubuntu SMP Tue Feb 12 17:45:52 UTC 2019 aarch64 aarch64 aarch64 GNU/Linux\r\nThe timeout doen't work well before, see [SPARK-7989] and [SPARK-10651]. I can't find the principle of the timeout setting, we set it to 20000, because we found the time is about 13000ms then the second executor(2 required in test) can up on our arm testing instances.\r\n\r\nThis fixes following the solution of [SPARK-7989] and [SPARK-10651].\r\n\r\n","created_at":"2019-07-22T06:40:39Z","updated_at":"2019-09-11T03:26:21Z","closed_at":"2019-07-24T02:35:05Z","merged_at":null,"merge_commit_sha":"e9e2571fe7bebdb0b79a6d3e628d9fc413de48b7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25227/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25227/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25227/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c0878d65cfd62a41bb5be8f9ed18302b50db9996","head":{"label":"theopenlab:increase-executor-up-timeout","ref":"increase-executor-up-timeout","sha":"c0878d65cfd62a41bb5be8f9ed18302b50db9996","user":{"login":"theopenlab","id":30709601,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMwNzA5NjAx","avatar_url":"https://avatars.githubusercontent.com/u/30709601?v=4","gravatar_id":"","url":"https://api.github.com/users/theopenlab","html_url":"https://github.com/theopenlab","followers_url":"https://api.github.com/users/theopenlab/followers","following_url":"https://api.github.com/users/theopenlab/following{/other_user}","gists_url":"https://api.github.com/users/theopenlab/gists{/gist_id}","starred_url":"https://api.github.com/users/theopenlab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theopenlab/subscriptions","organizations_url":"https://api.github.com/users/theopenlab/orgs","repos_url":"https://api.github.com/users/theopenlab/repos","events_url":"https://api.github.com/users/theopenlab/events{/privacy}","received_events_url":"https://api.github.com/users/theopenlab/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":192834223,"node_id":"MDEwOlJlcG9zaXRvcnkxOTI4MzQyMjM=","name":"spark","full_name":"theopenlab/spark","private":false,"owner":{"login":"theopenlab","id":30709601,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMwNzA5NjAx","avatar_url":"https://avatars.githubusercontent.com/u/30709601?v=4","gravatar_id":"","url":"https://api.github.com/users/theopenlab","html_url":"https://github.com/theopenlab","followers_url":"https://api.github.com/users/theopenlab/followers","following_url":"https://api.github.com/users/theopenlab/following{/other_user}","gists_url":"https://api.github.com/users/theopenlab/gists{/gist_id}","starred_url":"https://api.github.com/users/theopenlab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theopenlab/subscriptions","organizations_url":"https://api.github.com/users/theopenlab/orgs","repos_url":"https://api.github.com/users/theopenlab/repos","events_url":"https://api.github.com/users/theopenlab/events{/privacy}","received_events_url":"https://api.github.com/users/theopenlab/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/theopenlab/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/theopenlab/spark","forks_url":"https://api.github.com/repos/theopenlab/spark/forks","keys_url":"https://api.github.com/repos/theopenlab/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/theopenlab/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/theopenlab/spark/teams","hooks_url":"https://api.github.com/repos/theopenlab/spark/hooks","issue_events_url":"https://api.github.com/repos/theopenlab/spark/issues/events{/number}","events_url":"https://api.github.com/repos/theopenlab/spark/events","assignees_url":"https://api.github.com/repos/theopenlab/spark/assignees{/user}","branches_url":"https://api.github.com/repos/theopenlab/spark/branches{/branch}","tags_url":"https://api.github.com/repos/theopenlab/spark/tags","blobs_url":"https://api.github.com/repos/theopenlab/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/theopenlab/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/theopenlab/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/theopenlab/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/theopenlab/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/theopenlab/spark/languages","stargazers_url":"https://api.github.com/repos/theopenlab/spark/stargazers","contributors_url":"https://api.github.com/repos/theopenlab/spark/contributors","subscribers_url":"https://api.github.com/repos/theopenlab/spark/subscribers","subscription_url":"https://api.github.com/repos/theopenlab/spark/subscription","commits_url":"https://api.github.com/repos/theopenlab/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/theopenlab/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/theopenlab/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/theopenlab/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/theopenlab/spark/contents/{+path}","compare_url":"https://api.github.com/repos/theopenlab/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/theopenlab/spark/merges","archive_url":"https://api.github.com/repos/theopenlab/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/theopenlab/spark/downloads","issues_url":"https://api.github.com/repos/theopenlab/spark/issues{/number}","pulls_url":"https://api.github.com/repos/theopenlab/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/theopenlab/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/theopenlab/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/theopenlab/spark/labels{/name}","releases_url":"https://api.github.com/repos/theopenlab/spark/releases{/id}","deployments_url":"https://api.github.com/repos/theopenlab/spark/deployments","created_at":"2019-06-20T02:25:49Z","updated_at":"2020-06-24T07:10:19Z","pushed_at":"2020-06-24T07:07:39Z","git_url":"git://github.com/theopenlab/spark.git","ssh_url":"git@github.com:theopenlab/spark.git","clone_url":"https://github.com/theopenlab/spark.git","svn_url":"https://github.com/theopenlab/spark","homepage":"","size":328623,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"62e28248f12026fbfbb6469a70031d1580a5de9f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25227"},"html":{"href":"https://github.com/apache/spark/pull/25227"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25227"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25227/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25227/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25227/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c0878d65cfd62a41bb5be8f9ed18302b50db9996"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25226","id":299732228,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NzMyMjI4","html_url":"https://github.com/apache/spark/pull/25226","diff_url":"https://github.com/apache/spark/pull/25226.diff","patch_url":"https://github.com/apache/spark/pull/25226.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25226","number":25226,"state":"closed","locked":false,"title":"[SPARK-28468][INFRA][2.4] Upgrade pip to fix `sphinx` install error","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nSpark 2.4.x should be a LTS version and we should use the release script in `branch-2.4` to avoid the previous mistakes. Currently, `do-release-docker.sh` fails at `sphinx` installation to `Python 2.7` at `branch-2.4` only. This PR aims to upgrade `pip` to handle this.\r\n```\r\n$ dev/create-release/do-release-docker.sh -d /tmp/spark-2.4.4 -n\r\n...\r\n= Building spark-rm image with tag latest...\r\nCommand: docker build -t spark-rm:latest --build-arg UID=501 /Users/dhyun/APACHE/spark-2.4/dev/create-release/spark-rm\r\nLog file: docker-build.log\r\n// Terminated.\r\n```\r\n```\r\n$ tail /tmp/spark-2.4.4/docker-build.log\r\nCollecting sphinx\r\n  Downloading https://files.pythonhosted.org/packages/89/1e/64c77163706556b647f99d67b42fced9d39ae6b1b86673965a2cd28037b5/Sphinx-2.1.2.tar.gz (6.3MB)\r\n    Complete output from command python setup.py egg_info:\r\n    ERROR: Sphinx requires at least Python 3.5 to run.\r\n\r\n    ----------------------------------------\r\nCommand \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-build-2tylGA/sphinx/\r\nYou are using pip version 8.1.1, however version 19.1.1 is available.\r\nYou should consider upgrading via the 'pip install --upgrade pip' command.\r\n```\r\n\r\nThe following is the short reproducible step.\r\n```\r\n$ docker build -t spark-rm-test2 --build-arg UID=501 dev/create-release/spark-rm\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nManual. \r\n```\r\n$ docker build -t spark-rm-test2 --build-arg UID=501 dev/create-release/spark-rm\r\n```\r\n","created_at":"2019-07-22T06:20:31Z","updated_at":"2019-07-22T17:46:49Z","closed_at":"2019-07-22T17:46:45Z","merged_at":null,"merge_commit_sha":"80f257074ac2f8e3d20cd69d619817a781322b5f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587336,"node_id":"MDU6TGFiZWwxNDA2NTg3MzM2","url":"https://api.github.com/repos/apache/spark/labels/PROJECT%20INFRA","name":"PROJECT INFRA","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25226/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25226/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25226/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e4ae98cb8ea51815a9e9c0f2ee470ed2ebc55718","head":{"label":"dongjoon-hyun:SPARK-28468","ref":"SPARK-28468","sha":"e4ae98cb8ea51815a9e9c0f2ee470ed2ebc55718","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:branch-2.4","ref":"branch-2.4","sha":"b26e82f7e1f8084e244530005968d126544b48b2","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25226"},"html":{"href":"https://github.com/apache/spark/pull/25226"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25226"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25226/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25226/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25226/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e4ae98cb8ea51815a9e9c0f2ee470ed2ebc55718"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25225","id":299729629,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NzI5NjI5","html_url":"https://github.com/apache/spark/pull/25225","diff_url":"https://github.com/apache/spark/pull/25225.diff","patch_url":"https://github.com/apache/spark/pull/25225.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25225","number":25225,"state":"closed","locked":false,"title":"[SPARK-28469][SQL] Change CalendarIntervalType's readable string representation from calendarinterval to interval","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR change `CalendarIntervalType`'s readable string representation from `calendarinterval` to `interval`.\r\n\r\n## How was this patch tested?\r\n\r\nExisting UT","created_at":"2019-07-22T06:09:31Z","updated_at":"2019-07-23T04:44:38Z","closed_at":"2019-07-23T03:58:46Z","merged_at":null,"merge_commit_sha":"4d528c7f4de0b7d8fe765cfa01a18bb31ba3f234","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25225/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25225/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25225/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e84fce8f4709c2430f3837345d149a87e9376bf0","head":{"label":"wangyum:SPARK-28469","ref":"SPARK-28469","sha":"e84fce8f4709c2430f3837345d149a87e9376bf0","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"62e28248f12026fbfbb6469a70031d1580a5de9f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25225"},"html":{"href":"https://github.com/apache/spark/pull/25225"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25225"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25225/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25225/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25225/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e84fce8f4709c2430f3837345d149a87e9376bf0"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25224","id":299709158,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NzA5MTU4","html_url":"https://github.com/apache/spark/pull/25224","diff_url":"https://github.com/apache/spark/pull/25224.diff","patch_url":"https://github.com/apache/spark/pull/25224.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25224","number":25224,"state":"closed","locked":false,"title":"[SPARK-28321][DOCS][FOLLOW-UP] Update migration guide by 0-args Java UDF's internal behaviour change","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR proposes to add a note in the migration guide. See https://github.com/apache/spark/pull/25108#issuecomment-513526585\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-22T04:19:34Z","updated_at":"2020-03-03T01:18:25Z","closed_at":"2019-07-22T08:38:35Z","merged_at":null,"merge_commit_sha":"ecd8cbc6236a7e0ba41bfc012f072cb4e584d1dd","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627011,"node_id":"MDU6TGFiZWwxNDA2NjI3MDEx","url":"https://api.github.com/repos/apache/spark/labels/DOCUMENTATION","name":"DOCUMENTATION","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25224/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25224/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25224/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/be8ae4071e7057ea189679f1ae9f8459ba3ad88c","head":{"label":"HyukjinKwon:SPARK-28321-doc","ref":"SPARK-28321-doc","sha":"be8ae4071e7057ea189679f1ae9f8459ba3ad88c","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7ed008853933d0227cce9e00538a6cf3732d1937","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25224"},"html":{"href":"https://github.com/apache/spark/pull/25224"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25224"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25224/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25224/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25224/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/be8ae4071e7057ea189679f1ae9f8459ba3ad88c"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25223","id":299678930,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5Njc4OTMw","html_url":"https://github.com/apache/spark/pull/25223","diff_url":"https://github.com/apache/spark/pull/25223.diff","patch_url":"https://github.com/apache/spark/pull/25223.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25223","number":25223,"state":"closed","locked":false,"title":"[SPARK-27416][SQL][BRANCH-2.4] UnsafeMapData & UnsafeArrayData Kryo serialization …","user":{"login":"JoshRosen","id":50748,"node_id":"MDQ6VXNlcjUwNzQ4","avatar_url":"https://avatars.githubusercontent.com/u/50748?v=4","gravatar_id":"","url":"https://api.github.com/users/JoshRosen","html_url":"https://github.com/JoshRosen","followers_url":"https://api.github.com/users/JoshRosen/followers","following_url":"https://api.github.com/users/JoshRosen/following{/other_user}","gists_url":"https://api.github.com/users/JoshRosen/gists{/gist_id}","starred_url":"https://api.github.com/users/JoshRosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JoshRosen/subscriptions","organizations_url":"https://api.github.com/users/JoshRosen/orgs","repos_url":"https://api.github.com/users/JoshRosen/repos","events_url":"https://api.github.com/users/JoshRosen/events{/privacy}","received_events_url":"https://api.github.com/users/JoshRosen/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"This is a Spark 2.4.x backport of #24357 by @pengbo. Original description follows below:\r\n\r\n---\r\n\r\n## What changes were proposed in this pull request?\r\nFinish the rest work of https://github.com/apache/spark/pull/24317, https://github.com/apache/spark/pull/9030\r\na. Implement Kryo serialization for UnsafeArrayData\r\nb. fix UnsafeMapData Java/Kryo Serialization issue when two machines have different Oops size\r\nc. Move the duplicate code \"getBytes()\" to Utils.\r\n\r\n## How was this patch tested?\r\nAccording Units has been added & tested","created_at":"2019-07-22T00:28:00Z","updated_at":"2019-07-22T05:20:37Z","closed_at":"2019-07-22T05:20:37Z","merged_at":null,"merge_commit_sha":"adcb825fc9d748c513eea9345c408899cc358903","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25223/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25223/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25223/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d187ae3c90cc126b6da53e9a8b23f9ac52b09500","head":{"label":"JoshRosen:SPARK-27416-2.4","ref":"SPARK-27416-2.4","sha":"d187ae3c90cc126b6da53e9a8b23f9ac52b09500","user":{"login":"JoshRosen","id":50748,"node_id":"MDQ6VXNlcjUwNzQ4","avatar_url":"https://avatars.githubusercontent.com/u/50748?v=4","gravatar_id":"","url":"https://api.github.com/users/JoshRosen","html_url":"https://github.com/JoshRosen","followers_url":"https://api.github.com/users/JoshRosen/followers","following_url":"https://api.github.com/users/JoshRosen/following{/other_user}","gists_url":"https://api.github.com/users/JoshRosen/gists{/gist_id}","starred_url":"https://api.github.com/users/JoshRosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JoshRosen/subscriptions","organizations_url":"https://api.github.com/users/JoshRosen/orgs","repos_url":"https://api.github.com/users/JoshRosen/repos","events_url":"https://api.github.com/users/JoshRosen/events{/privacy}","received_events_url":"https://api.github.com/users/JoshRosen/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":22238710,"node_id":"MDEwOlJlcG9zaXRvcnkyMjIzODcxMA==","name":"spark","full_name":"JoshRosen/spark","private":false,"owner":{"login":"JoshRosen","id":50748,"node_id":"MDQ6VXNlcjUwNzQ4","avatar_url":"https://avatars.githubusercontent.com/u/50748?v=4","gravatar_id":"","url":"https://api.github.com/users/JoshRosen","html_url":"https://github.com/JoshRosen","followers_url":"https://api.github.com/users/JoshRosen/followers","following_url":"https://api.github.com/users/JoshRosen/following{/other_user}","gists_url":"https://api.github.com/users/JoshRosen/gists{/gist_id}","starred_url":"https://api.github.com/users/JoshRosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JoshRosen/subscriptions","organizations_url":"https://api.github.com/users/JoshRosen/orgs","repos_url":"https://api.github.com/users/JoshRosen/repos","events_url":"https://api.github.com/users/JoshRosen/events{/privacy}","received_events_url":"https://api.github.com/users/JoshRosen/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/JoshRosen/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/JoshRosen/spark","forks_url":"https://api.github.com/repos/JoshRosen/spark/forks","keys_url":"https://api.github.com/repos/JoshRosen/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/JoshRosen/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/JoshRosen/spark/teams","hooks_url":"https://api.github.com/repos/JoshRosen/spark/hooks","issue_events_url":"https://api.github.com/repos/JoshRosen/spark/issues/events{/number}","events_url":"https://api.github.com/repos/JoshRosen/spark/events","assignees_url":"https://api.github.com/repos/JoshRosen/spark/assignees{/user}","branches_url":"https://api.github.com/repos/JoshRosen/spark/branches{/branch}","tags_url":"https://api.github.com/repos/JoshRosen/spark/tags","blobs_url":"https://api.github.com/repos/JoshRosen/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/JoshRosen/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/JoshRosen/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/JoshRosen/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/JoshRosen/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/JoshRosen/spark/languages","stargazers_url":"https://api.github.com/repos/JoshRosen/spark/stargazers","contributors_url":"https://api.github.com/repos/JoshRosen/spark/contributors","subscribers_url":"https://api.github.com/repos/JoshRosen/spark/subscribers","subscription_url":"https://api.github.com/repos/JoshRosen/spark/subscription","commits_url":"https://api.github.com/repos/JoshRosen/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/JoshRosen/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/JoshRosen/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/JoshRosen/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/JoshRosen/spark/contents/{+path}","compare_url":"https://api.github.com/repos/JoshRosen/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/JoshRosen/spark/merges","archive_url":"https://api.github.com/repos/JoshRosen/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/JoshRosen/spark/downloads","issues_url":"https://api.github.com/repos/JoshRosen/spark/issues{/number}","pulls_url":"https://api.github.com/repos/JoshRosen/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/JoshRosen/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/JoshRosen/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/JoshRosen/spark/labels{/name}","releases_url":"https://api.github.com/repos/JoshRosen/spark/releases{/id}","deployments_url":"https://api.github.com/repos/JoshRosen/spark/deployments","created_at":"2014-07-25T00:47:52Z","updated_at":"2022-06-21T17:37:17Z","pushed_at":"2025-01-09T00:48:30Z","git_url":"git://github.com/JoshRosen/spark.git","ssh_url":"git@github.com:JoshRosen/spark.git","clone_url":"https://github.com/JoshRosen/spark.git","svn_url":"https://github.com/JoshRosen/spark","homepage":null,"size":446401,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:branch-2.4","ref":"branch-2.4","sha":"a7e2de86e0f133a2c76b221baefc1a590b2b1a39","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25223"},"html":{"href":"https://github.com/apache/spark/pull/25223"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25223"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25223/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25223/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25223/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d187ae3c90cc126b6da53e9a8b23f9ac52b09500"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25222","id":299676820,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5Njc2ODIw","html_url":"https://github.com/apache/spark/pull/25222","diff_url":"https://github.com/apache/spark/pull/25222.diff","patch_url":"https://github.com/apache/spark/pull/25222.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25222","number":25222,"state":"closed","locked":false,"title":"[SPARK-28465][K8s] Fix integration tests which fail due to missing ceph-nano image","user":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nFixes the tests. Follows instructions here: https://github.com/ceph/cn/issues/115#issuecomment-497384369\r\n## How was this patch tested?\r\n\r\nManually by running the tests with minikube.","created_at":"2019-07-22T00:07:42Z","updated_at":"2019-07-24T22:03:01Z","closed_at":"2019-07-24T22:03:01Z","merged_at":null,"merge_commit_sha":"3b209e029376e2cee9b45969ef81aadc87b95117","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406605057,"node_id":"MDU6TGFiZWwxNDA2NjA1MDU3","url":"https://api.github.com/repos/apache/spark/labels/KUBERNETES","name":"KUBERNETES","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25222/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25222/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25222/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b7c330604eb7640efa820412cf22a81d9f2a0813","head":{"label":"skonto:fix-ceph","ref":"fix-ceph","sha":"b7c330604eb7640efa820412cf22a81d9f2a0813","user":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":48892104,"node_id":"MDEwOlJlcG9zaXRvcnk0ODg5MjEwNA==","name":"spark","full_name":"skonto/spark","private":false,"owner":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/skonto/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/skonto/spark","forks_url":"https://api.github.com/repos/skonto/spark/forks","keys_url":"https://api.github.com/repos/skonto/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/skonto/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/skonto/spark/teams","hooks_url":"https://api.github.com/repos/skonto/spark/hooks","issue_events_url":"https://api.github.com/repos/skonto/spark/issues/events{/number}","events_url":"https://api.github.com/repos/skonto/spark/events","assignees_url":"https://api.github.com/repos/skonto/spark/assignees{/user}","branches_url":"https://api.github.com/repos/skonto/spark/branches{/branch}","tags_url":"https://api.github.com/repos/skonto/spark/tags","blobs_url":"https://api.github.com/repos/skonto/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/skonto/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/skonto/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/skonto/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/skonto/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/skonto/spark/languages","stargazers_url":"https://api.github.com/repos/skonto/spark/stargazers","contributors_url":"https://api.github.com/repos/skonto/spark/contributors","subscribers_url":"https://api.github.com/repos/skonto/spark/subscribers","subscription_url":"https://api.github.com/repos/skonto/spark/subscription","commits_url":"https://api.github.com/repos/skonto/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/skonto/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/skonto/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/skonto/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/skonto/spark/contents/{+path}","compare_url":"https://api.github.com/repos/skonto/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/skonto/spark/merges","archive_url":"https://api.github.com/repos/skonto/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/skonto/spark/downloads","issues_url":"https://api.github.com/repos/skonto/spark/issues{/number}","pulls_url":"https://api.github.com/repos/skonto/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/skonto/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/skonto/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/skonto/spark/labels{/name}","releases_url":"https://api.github.com/repos/skonto/spark/releases{/id}","deployments_url":"https://api.github.com/repos/skonto/spark/deployments","created_at":"2016-01-01T23:02:52Z","updated_at":"2023-10-13T14:17:45Z","pushed_at":"2023-10-13T14:15:23Z","git_url":"git://github.com/skonto/spark.git","ssh_url":"git@github.com:skonto/spark.git","clone_url":"https://github.com/skonto/spark.git","svn_url":"https://github.com/skonto/spark","homepage":null,"size":395104,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fced6696a7713a5dc117860faef43db6b81d07b3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25222"},"html":{"href":"https://github.com/apache/spark/pull/25222"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25222"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25222/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25222/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25222/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b7c330604eb7640efa820412cf22a81d9f2a0813"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25221","id":299665341,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NjY1MzQx","html_url":"https://github.com/apache/spark/pull/25221","diff_url":"https://github.com/apache/spark/pull/25221.diff","patch_url":"https://github.com/apache/spark/pull/25221.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25221","number":25221,"state":"closed","locked":false,"title":"[SPARK-25705][DOC][FOLLOWUP] Recover links to structured-streaming-kafka-integration","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR is a follow-up PR to recover three links from [the previous commit](https://github.com/apache/spark/pull/22703/files#diff-21245da8f8dbfef6401c5500f559f0bc).\r\n\r\nCurrently, those three are broken.\r\n```\r\n$ git grep structured-streaming-kafka-0-10-integration\r\nstructured-streaming-programming-guide.md:  - **Kafka source** - Reads data from Kafka. It's compatible with Kafka broker versions 0.10.0 or higher. See the [Kafka Integration Guide](structured-streaming-kafka-0-10-integration.html) for more details.\r\nstructured-streaming-programming-guide.md:        See the <a href=\"structured-streaming-kafka-0-10-integration.html\">Kafka Integration Guide</a>.\r\nstructured-streaming-programming-guide.md:    <td>See the <a href=\"structured-streaming-kafka-0-10-integration.html\">Kafka Integration Guide</a></td>\r\n```\r\n\r\nIt's because we have `structured-streaming-kafka-integration.html` instead of `structured-streaming-kafka-0-10-integration.html`.\r\n```\r\n$ find . -name structured-streaming-kafka-0-10-integration.md\r\n\r\n$ find . -name structured-streaming-kafka-integration.md\r\n./structured-streaming-kafka-integration.md\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nManual.","created_at":"2019-07-21T21:09:05Z","updated_at":"2019-07-25T08:55:47Z","closed_at":"2019-07-22T02:26:38Z","merged_at":null,"merge_commit_sha":"294b111ec51bc130546ac3921a4728b294da202d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627011,"node_id":"MDU6TGFiZWwxNDA2NjI3MDEx","url":"https://api.github.com/repos/apache/spark/labels/DOCUMENTATION","name":"DOCUMENTATION","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25221/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25221/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25221/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/502841b1e0310180f21b62ca1af56b01afcbc23f","head":{"label":"dongjoon-hyun:SPARK-25705","ref":"SPARK-25705","sha":"502841b1e0310180f21b62ca1af56b01afcbc23f","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"fced6696a7713a5dc117860faef43db6b81d07b3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25221"},"html":{"href":"https://github.com/apache/spark/pull/25221"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25221"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25221/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25221/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25221/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/502841b1e0310180f21b62ca1af56b01afcbc23f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25220","id":299660589,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NjYwNTg5","html_url":"https://github.com/apache/spark/pull/25220","diff_url":"https://github.com/apache/spark/pull/25220.diff","patch_url":"https://github.com/apache/spark/pull/25220.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25220","number":25220,"state":"closed","locked":false,"title":"[SPARK-28459][SQL] Add `make_timestamp` function","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nNew function `make_timestamp()` takes 6 columns `year`, `month`, `day`, `hour`, `min`, `sec` + optionally `timezone`, and makes new column of the `TIMESTAMP` type. If values in the input columns are `null` or out of valid ranges, the function returns `null`. Valid ranges are:\r\n- `year` - `[1, 9999]`\r\n- `month` - `[1, 12]`\r\n- `day` - `[1, 31]`\r\n- `hour` - `[0, 23]`\r\n- `min` - `[0, 59]`\r\n- `sec` - `[0, 60]`. If the `sec` argument equals to 60, the seconds field is set to 0 and 1 minute is added to the final timestamp.\r\n- `timezone` - an identifier of timezone. Actual database of timezones can be found there: https://www.iana.org/time-zones.\r\n\r\nAlso constructed timestamp must be valid otherwise `make_timestamp` returns `null`.\r\n\r\nThe function is implemented similarly to `make_timestamp` in PostgreSQL: https://www.postgresql.org/docs/11/functions-datetime.html to maintain feature parity with it.\r\n\r\nHere are examples:\r\n```sql\r\nselect make_timestamp(2014, 12, 28, 6, 30, 45.887);\r\n  2014-12-28 06:30:45.887\r\nselect make_timestamp(2014, 12, 28, 6, 30, 45.887, 'CET');\r\n  2014-12-28 10:30:45.887\r\nselect make_timestamp(2019, 6, 30, 23, 59, 60)\r\n  2019-07-01 00:00:00\r\n```\r\n\r\nReturned value has Spark Catalyst type `TIMESTAMP` which is similar to Oracle's `TIMESTAMP WITH LOCAL TIME ZONE` (see https://docs.oracle.com/cd/B28359_01/server.111/b28298/ch4datetime.htm#i1006169) where data is stored in the session time zone, and the time zone offset is not stored as part of the column data. When users retrieve the data, Spark returns it in the session time zone specified by the SQL config `spark.sql.session.timeZone`.\r\n\r\n## How was this patch tested?\r\n\r\nAdded new tests to `DateExpressionsSuite`, and uncommented a test for `make_timestamp` in `pgSQL/timestamp.sql`.\r\n","created_at":"2019-07-21T19:50:21Z","updated_at":"2019-10-05T19:17:03Z","closed_at":"2019-07-29T18:04:46Z","merged_at":null,"merge_commit_sha":"aa01933750db69ff20e4e409b69b1b8190c8248c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25220/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25220/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25220/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/cfb8ce168675524231c3c413d4854cf840b46414","head":{"label":"MaxGekk:make_timestamp","ref":"make_timestamp","sha":"cfb8ce168675524231c3c413d4854cf840b46414","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":123690489,"node_id":"MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=","name":"spark","full_name":"MaxGekk/spark","private":false,"owner":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/MaxGekk/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/MaxGekk/spark","forks_url":"https://api.github.com/repos/MaxGekk/spark/forks","keys_url":"https://api.github.com/repos/MaxGekk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/MaxGekk/spark/teams","hooks_url":"https://api.github.com/repos/MaxGekk/spark/hooks","issue_events_url":"https://api.github.com/repos/MaxGekk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/MaxGekk/spark/events","assignees_url":"https://api.github.com/repos/MaxGekk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/MaxGekk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/MaxGekk/spark/tags","blobs_url":"https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/MaxGekk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/MaxGekk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/MaxGekk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/MaxGekk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/MaxGekk/spark/languages","stargazers_url":"https://api.github.com/repos/MaxGekk/spark/stargazers","contributors_url":"https://api.github.com/repos/MaxGekk/spark/contributors","subscribers_url":"https://api.github.com/repos/MaxGekk/spark/subscribers","subscription_url":"https://api.github.com/repos/MaxGekk/spark/subscription","commits_url":"https://api.github.com/repos/MaxGekk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/MaxGekk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/MaxGekk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/MaxGekk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/MaxGekk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/MaxGekk/spark/merges","archive_url":"https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/MaxGekk/spark/downloads","issues_url":"https://api.github.com/repos/MaxGekk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/MaxGekk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/MaxGekk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/MaxGekk/spark/labels{/name}","releases_url":"https://api.github.com/repos/MaxGekk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/MaxGekk/spark/deployments","created_at":"2018-03-03T12:37:00Z","updated_at":"2025-02-07T09:44:52Z","pushed_at":"2025-02-07T09:44:24Z","git_url":"git://github.com/MaxGekk/spark.git","ssh_url":"git@github.com:MaxGekk/spark.git","clone_url":"https://github.com/MaxGekk/spark.git","svn_url":"https://github.com/MaxGekk/spark","homepage":null,"size":486456,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"022667cea666190bea651a3873234700a472326c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25220"},"html":{"href":"https://github.com/apache/spark/pull/25220"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25220"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25220/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25220/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25220/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/cfb8ce168675524231c3c413d4854cf840b46414"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25219","id":299610038,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NjEwMDM4","html_url":"https://github.com/apache/spark/pull/25219","diff_url":"https://github.com/apache/spark/pull/25219.diff","patch_url":"https://github.com/apache/spark/pull/25219.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25219","number":25219,"state":"closed","locked":false,"title":"[SPARK-28464][Doc][SS] Document Kafka source minPartitions option","user":{"login":"arunpandianp","id":1829112,"node_id":"MDQ6VXNlcjE4MjkxMTI=","avatar_url":"https://avatars.githubusercontent.com/u/1829112?v=4","gravatar_id":"","url":"https://api.github.com/users/arunpandianp","html_url":"https://github.com/arunpandianp","followers_url":"https://api.github.com/users/arunpandianp/followers","following_url":"https://api.github.com/users/arunpandianp/following{/other_user}","gists_url":"https://api.github.com/users/arunpandianp/gists{/gist_id}","starred_url":"https://api.github.com/users/arunpandianp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arunpandianp/subscriptions","organizations_url":"https://api.github.com/users/arunpandianp/orgs","repos_url":"https://api.github.com/users/arunpandianp/repos","events_url":"https://api.github.com/users/arunpandianp/events{/privacy}","received_events_url":"https://api.github.com/users/arunpandianp/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nAdding doc for the kafka source minPartitions option to \"Structured Streaming + Kafka Integration Guide\" \r\n\r\n<img width=\"915\" alt=\"screenshot_doc\" src=\"https://user-images.githubusercontent.com/9700541/61596548-fd640200-abb9-11e9-94b0-86dfc7f86414.png\">\r\n","created_at":"2019-07-21T04:46:29Z","updated_at":"2019-07-22T04:44:52Z","closed_at":"2019-07-21T20:23:26Z","merged_at":null,"merge_commit_sha":"5d89b4181346065dd8403633182a9325ef1e19a9","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1406627011,"node_id":"MDU6TGFiZWwxNDA2NjI3MDEx","url":"https://api.github.com/repos/apache/spark/labels/DOCUMENTATION","name":"DOCUMENTATION","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25219/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25219/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25219/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7c0e448a356a379f362b2bdb7c8b22a5ffcb9a46","head":{"label":"arunpandianp:SPARK-28464","ref":"SPARK-28464","sha":"7c0e448a356a379f362b2bdb7c8b22a5ffcb9a46","user":{"login":"arunpandianp","id":1829112,"node_id":"MDQ6VXNlcjE4MjkxMTI=","avatar_url":"https://avatars.githubusercontent.com/u/1829112?v=4","gravatar_id":"","url":"https://api.github.com/users/arunpandianp","html_url":"https://github.com/arunpandianp","followers_url":"https://api.github.com/users/arunpandianp/followers","following_url":"https://api.github.com/users/arunpandianp/following{/other_user}","gists_url":"https://api.github.com/users/arunpandianp/gists{/gist_id}","starred_url":"https://api.github.com/users/arunpandianp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arunpandianp/subscriptions","organizations_url":"https://api.github.com/users/arunpandianp/orgs","repos_url":"https://api.github.com/users/arunpandianp/repos","events_url":"https://api.github.com/users/arunpandianp/events{/privacy}","received_events_url":"https://api.github.com/users/arunpandianp/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":189333127,"node_id":"MDEwOlJlcG9zaXRvcnkxODkzMzMxMjc=","name":"spark","full_name":"arunpandianp/spark","private":false,"owner":{"login":"arunpandianp","id":1829112,"node_id":"MDQ6VXNlcjE4MjkxMTI=","avatar_url":"https://avatars.githubusercontent.com/u/1829112?v=4","gravatar_id":"","url":"https://api.github.com/users/arunpandianp","html_url":"https://github.com/arunpandianp","followers_url":"https://api.github.com/users/arunpandianp/followers","following_url":"https://api.github.com/users/arunpandianp/following{/other_user}","gists_url":"https://api.github.com/users/arunpandianp/gists{/gist_id}","starred_url":"https://api.github.com/users/arunpandianp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arunpandianp/subscriptions","organizations_url":"https://api.github.com/users/arunpandianp/orgs","repos_url":"https://api.github.com/users/arunpandianp/repos","events_url":"https://api.github.com/users/arunpandianp/events{/privacy}","received_events_url":"https://api.github.com/users/arunpandianp/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/arunpandianp/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/arunpandianp/spark","forks_url":"https://api.github.com/repos/arunpandianp/spark/forks","keys_url":"https://api.github.com/repos/arunpandianp/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/arunpandianp/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/arunpandianp/spark/teams","hooks_url":"https://api.github.com/repos/arunpandianp/spark/hooks","issue_events_url":"https://api.github.com/repos/arunpandianp/spark/issues/events{/number}","events_url":"https://api.github.com/repos/arunpandianp/spark/events","assignees_url":"https://api.github.com/repos/arunpandianp/spark/assignees{/user}","branches_url":"https://api.github.com/repos/arunpandianp/spark/branches{/branch}","tags_url":"https://api.github.com/repos/arunpandianp/spark/tags","blobs_url":"https://api.github.com/repos/arunpandianp/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/arunpandianp/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/arunpandianp/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/arunpandianp/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/arunpandianp/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/arunpandianp/spark/languages","stargazers_url":"https://api.github.com/repos/arunpandianp/spark/stargazers","contributors_url":"https://api.github.com/repos/arunpandianp/spark/contributors","subscribers_url":"https://api.github.com/repos/arunpandianp/spark/subscribers","subscription_url":"https://api.github.com/repos/arunpandianp/spark/subscription","commits_url":"https://api.github.com/repos/arunpandianp/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/arunpandianp/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/arunpandianp/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/arunpandianp/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/arunpandianp/spark/contents/{+path}","compare_url":"https://api.github.com/repos/arunpandianp/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/arunpandianp/spark/merges","archive_url":"https://api.github.com/repos/arunpandianp/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/arunpandianp/spark/downloads","issues_url":"https://api.github.com/repos/arunpandianp/spark/issues{/number}","pulls_url":"https://api.github.com/repos/arunpandianp/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/arunpandianp/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/arunpandianp/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/arunpandianp/spark/labels{/name}","releases_url":"https://api.github.com/repos/arunpandianp/spark/releases{/id}","deployments_url":"https://api.github.com/repos/arunpandianp/spark/deployments","created_at":"2019-05-30T02:41:29Z","updated_at":"2019-11-24T08:13:28Z","pushed_at":"2019-11-24T09:06:30Z","git_url":"git://github.com/arunpandianp/spark.git","ssh_url":"git@github.com:arunpandianp/spark.git","clone_url":"https://github.com/arunpandianp/spark.git","svn_url":"https://github.com/arunpandianp/spark","homepage":"","size":317716,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"72c80ee81ca4c3c9569749b54e2db0ec91b128a5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25219"},"html":{"href":"https://github.com/apache/spark/pull/25219"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25219"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25219/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25219/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25219/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7c0e448a356a379f362b2bdb7c8b22a5ffcb9a46"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25218","id":299609920,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NjA5OTIw","html_url":"https://github.com/apache/spark/pull/25218","diff_url":"https://github.com/apache/spark/pull/25218.diff","patch_url":"https://github.com/apache/spark/pull/25218.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25218","number":25218,"state":"closed","locked":false,"title":"[SPARK-28466][SQL] fix sts FileSystem closed error when to call Hive.moveFile","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nWhen we close a session of STS, if this session has done some SQL about insert, then other session do CTAS/INSERT and trigger Hive.moveFile, DFSClient will do checkOpen and throw java.io.IOException: Filesystem closed.\r\n\r\n**Root cause** :\r\nWhen we first execut SQL like CTAS/INSERT,  it will call Hive.moveFile, during this method, it will initialize this field SessionState.hdfsEncryptionShim , when initialize this field, it will initialize a FS.\r\n![image](https://user-images.githubusercontent.com/46485123/61587025-45802600-abb4-11e9-9926-6817f52490a3.png)\r\n\r\nBut this FS is under current HiveSessionImpleWithUgi.sessionUgi, so when we close this session, it will call `FileSystem.closeForUgi()`, above FileSystem will be closed, then during other session execute SQL like CTAS/INSERT,  such error will happen since FS has been close. \r\n\r\nSome one may be confused why HiveServer2 won't appear this problem : \r\n\r\n- In HiveServer2, each session has it's own SessionState, so close current session's FS is ok.\r\n- In SparkThriftServer, all session interact with hive through one HiveClientImpl, it has only one SessionState, when we call method with HiveClientImpl, it will call **withHiveState** first to set HiveClientImpl's sessionState to current Thread.\r\n\r\n## How was this patch tested?\r\n\r\nmanual tested ","created_at":"2019-07-21T04:43:14Z","updated_at":"2019-08-25T01:43:37Z","closed_at":"2019-08-23T15:48:58Z","merged_at":null,"merge_commit_sha":"be02284b57a6b8270f797aae7e842c117107aca8","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25218/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25218/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25218/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/dd21832417a2a5ae44704332795a04fce721b80f","head":{"label":"AngersZhuuuu:fix_sts_fs_close","ref":"fix_sts_fs_close","sha":"dd21832417a2a5ae44704332795a04fce721b80f","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":176224753,"node_id":"MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=","name":"spark","full_name":"AngersZhuuuu/spark","private":false,"owner":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/AngersZhuuuu/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/AngersZhuuuu/spark","forks_url":"https://api.github.com/repos/AngersZhuuuu/spark/forks","keys_url":"https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/AngersZhuuuu/spark/teams","hooks_url":"https://api.github.com/repos/AngersZhuuuu/spark/hooks","issue_events_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/AngersZhuuuu/spark/events","assignees_url":"https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/tags","blobs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/AngersZhuuuu/spark/languages","stargazers_url":"https://api.github.com/repos/AngersZhuuuu/spark/stargazers","contributors_url":"https://api.github.com/repos/AngersZhuuuu/spark/contributors","subscribers_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscribers","subscription_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscription","commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/AngersZhuuuu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/AngersZhuuuu/spark/merges","archive_url":"https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/AngersZhuuuu/spark/downloads","issues_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/AngersZhuuuu/spark/labels{/name}","releases_url":"https://api.github.com/repos/AngersZhuuuu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/AngersZhuuuu/spark/deployments","created_at":"2019-03-18T07:13:25Z","updated_at":"2024-12-31T06:48:27Z","pushed_at":"2024-12-31T06:45:23Z","git_url":"git://github.com/AngersZhuuuu/spark.git","ssh_url":"git@github.com:AngersZhuuuu/spark.git","clone_url":"https://github.com/AngersZhuuuu/spark.git","svn_url":"https://github.com/AngersZhuuuu/spark","homepage":"","size":446399,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"72c80ee81ca4c3c9569749b54e2db0ec91b128a5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25218"},"html":{"href":"https://github.com/apache/spark/pull/25218"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25218"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25218/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25218/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25218/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/dd21832417a2a5ae44704332795a04fce721b80f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25217","id":299608962,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NjA4OTYy","html_url":"https://github.com/apache/spark/pull/25217","diff_url":"https://github.com/apache/spark/pull/25217.diff","patch_url":"https://github.com/apache/spark/pull/25217.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25217","number":25217,"state":"closed","locked":false,"title":"[SPARK-28463][SQL] Thriftserver throws BigDecimal incompatible with HiveDecimal","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nHow to reproduce this issue:\r\n```shell\r\nbuild/sbt clean package -Phive -Phive-thriftserver -Phadoop-3.2\r\nexport SPARK_PREPEND_CLASSES=true\r\nsbin/start-thriftserver.sh\r\n\r\n[root@spark-3267648 spark]# bin/beeline -u jdbc:hive2://localhost:10000/default -e \"select cast(1 as decimal(38, 18));\"\r\nConnecting to jdbc:hive2://localhost:10000/default\r\nConnected to: Spark SQL (version 3.0.0-SNAPSHOT)\r\nDriver: Hive JDBC (version 2.3.5)\r\nTransaction isolation: TRANSACTION_REPEATABLE_READ\r\nError: java.lang.ClassCastException: java.math.BigDecimal incompatible with org.apache.hadoop.hive.common.type.HiveDecimal (state=,code=0)\r\nClosing: 0: jdbc:hive2://localhost:10000/default\r\n```\r\n\r\nThis pr fix this issue.\r\n\r\n## How was this patch tested?\r\n\r\nunit tests\r\n","created_at":"2019-07-21T04:21:02Z","updated_at":"2019-07-26T23:31:47Z","closed_at":"2019-07-26T17:34:23Z","merged_at":null,"merge_commit_sha":"829df17d40627e1257de84ebbbd0c5bf869c02d8","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25217/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25217/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25217/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/93a083c334a9a6808dca03f32bd76e497e614f00","head":{"label":"wangyum:SPARK-28463","ref":"SPARK-28463","sha":"93a083c334a9a6808dca03f32bd76e497e614f00","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"72c80ee81ca4c3c9569749b54e2db0ec91b128a5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25217"},"html":{"href":"https://github.com/apache/spark/pull/25217"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25217"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25217/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25217/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25217/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/93a083c334a9a6808dca03f32bd76e497e614f00"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25216","id":299606080,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NjA2MDgw","html_url":"https://github.com/apache/spark/pull/25216","diff_url":"https://github.com/apache/spark/pull/25216.diff","patch_url":"https://github.com/apache/spark/pull/25216.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25216","number":25216,"state":"closed","locked":false,"title":"[SPARK-28189][SQL][FOLLOW-UP] Remove the unnecessary test in DataFrameSuite","user":{"login":"maropu","id":692303,"node_id":"MDQ6VXNlcjY5MjMwMw==","avatar_url":"https://avatars.githubusercontent.com/u/692303?v=4","gravatar_id":"","url":"https://api.github.com/users/maropu","html_url":"https://github.com/maropu","followers_url":"https://api.github.com/users/maropu/followers","following_url":"https://api.github.com/users/maropu/following{/other_user}","gists_url":"https://api.github.com/users/maropu/gists{/gist_id}","starred_url":"https://api.github.com/users/maropu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maropu/subscriptions","organizations_url":"https://api.github.com/users/maropu/orgs","repos_url":"https://api.github.com/users/maropu/repos","events_url":"https://api.github.com/users/maropu/events{/privacy}","received_events_url":"https://api.github.com/users/maropu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nThis pr is to remove the unnecessary test  in DataFrameSuite.\r\n\r\n## How was this patch tested?\r\nN/A","created_at":"2019-07-21T03:17:32Z","updated_at":"2019-07-21T07:12:28Z","closed_at":"2019-07-21T07:12:28Z","merged_at":null,"merge_commit_sha":"71e76690c4c89524e12db4c8b1b8d6578337bda8","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25216/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25216/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25216/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a036161edf2fa70ded367a9ac0a15d0213b32619","head":{"label":"maropu:SPARK-28189-FOLLOWUP","ref":"SPARK-28189-FOLLOWUP","sha":"a036161edf2fa70ded367a9ac0a15d0213b32619","user":{"login":"maropu","id":692303,"node_id":"MDQ6VXNlcjY5MjMwMw==","avatar_url":"https://avatars.githubusercontent.com/u/692303?v=4","gravatar_id":"","url":"https://api.github.com/users/maropu","html_url":"https://github.com/maropu","followers_url":"https://api.github.com/users/maropu/followers","following_url":"https://api.github.com/users/maropu/following{/other_user}","gists_url":"https://api.github.com/users/maropu/gists{/gist_id}","starred_url":"https://api.github.com/users/maropu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maropu/subscriptions","organizations_url":"https://api.github.com/users/maropu/orgs","repos_url":"https://api.github.com/users/maropu/repos","events_url":"https://api.github.com/users/maropu/events{/privacy}","received_events_url":"https://api.github.com/users/maropu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":27115199,"node_id":"MDEwOlJlcG9zaXRvcnkyNzExNTE5OQ==","name":"spark","full_name":"maropu/spark","private":false,"owner":{"login":"maropu","id":692303,"node_id":"MDQ6VXNlcjY5MjMwMw==","avatar_url":"https://avatars.githubusercontent.com/u/692303?v=4","gravatar_id":"","url":"https://api.github.com/users/maropu","html_url":"https://github.com/maropu","followers_url":"https://api.github.com/users/maropu/followers","following_url":"https://api.github.com/users/maropu/following{/other_user}","gists_url":"https://api.github.com/users/maropu/gists{/gist_id}","starred_url":"https://api.github.com/users/maropu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maropu/subscriptions","organizations_url":"https://api.github.com/users/maropu/orgs","repos_url":"https://api.github.com/users/maropu/repos","events_url":"https://api.github.com/users/maropu/events{/privacy}","received_events_url":"https://api.github.com/users/maropu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/maropu/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/maropu/spark","forks_url":"https://api.github.com/repos/maropu/spark/forks","keys_url":"https://api.github.com/repos/maropu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/maropu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/maropu/spark/teams","hooks_url":"https://api.github.com/repos/maropu/spark/hooks","issue_events_url":"https://api.github.com/repos/maropu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/maropu/spark/events","assignees_url":"https://api.github.com/repos/maropu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/maropu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/maropu/spark/tags","blobs_url":"https://api.github.com/repos/maropu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/maropu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/maropu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/maropu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/maropu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/maropu/spark/languages","stargazers_url":"https://api.github.com/repos/maropu/spark/stargazers","contributors_url":"https://api.github.com/repos/maropu/spark/contributors","subscribers_url":"https://api.github.com/repos/maropu/spark/subscribers","subscription_url":"https://api.github.com/repos/maropu/spark/subscription","commits_url":"https://api.github.com/repos/maropu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/maropu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/maropu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/maropu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/maropu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/maropu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/maropu/spark/merges","archive_url":"https://api.github.com/repos/maropu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/maropu/spark/downloads","issues_url":"https://api.github.com/repos/maropu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/maropu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/maropu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/maropu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/maropu/spark/labels{/name}","releases_url":"https://api.github.com/repos/maropu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/maropu/spark/deployments","created_at":"2014-11-25T08:00:37Z","updated_at":"2021-06-22T15:34:47Z","pushed_at":"2021-07-16T02:22:28Z","git_url":"git://github.com/maropu/spark.git","ssh_url":"git@github.com:maropu/spark.git","clone_url":"https://github.com/maropu/spark.git","svn_url":"https://github.com/maropu/spark","homepage":null,"size":365163,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"72c80ee81ca4c3c9569749b54e2db0ec91b128a5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25216"},"html":{"href":"https://github.com/apache/spark/pull/25216"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25216"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25216/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25216/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25216/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a036161edf2fa70ded367a9ac0a15d0213b32619"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25215","id":299605798,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NjA1Nzk4","html_url":"https://github.com/apache/spark/pull/25215","diff_url":"https://github.com/apache/spark/pull/25215.diff","patch_url":"https://github.com/apache/spark/pull/25215.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25215","number":25215,"state":"closed","locked":false,"title":"[SPARK-28445][SQL][PYTHON] Fix error when PythonUDF is used in both group by and aggregate expression","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nWhen PythonUDF is used in group by, and it is also in aggregate expression, like\r\n\r\n```\r\nSELECT pyUDF(a + 1), COUNT(b) FROM testData GROUP BY pyUDF(a + 1)\r\n```\r\n\r\nIt causes analysis exception in `CheckAnalysis`, like\r\n```\r\norg.apache.spark.sql.AnalysisException: expression 'testdata.`a`' is neither present in the group by, nor is it an aggregate function.\r\n```\r\n\r\nFirst, `CheckAnalysis` can't check semantic equality between PythonUDFs.\r\nSecond, even we make it possible, runtime exception will be thrown\r\n\r\n```\r\norg.apache.spark.sql.catalyst.errors.package$TreeNodeException: Binding attribute, tree: pythonUDF1#8615\r\n...\r\nCause: java.lang.RuntimeException: Couldn't find pythonUDF1#8615 in [cast(pythonUDF0#8614 as int)#8617,count(b#8599)#8607L]\r\n```\r\n\r\nThe cause is, `ExtractPythonUDFs` extracts both PythonUDFs in group by and aggregate expression. The PythonUDFs are two different aliases now in the logical aggregate. In runtime, we can't bind the resulting expression in aggregate to its grouping and aggregate attributes.\r\n\r\nThis patch proposes a rule `ExtractGroupingPythonUDFFromAggregate` to extract PythonUDFs in group by and evaluate them before aggregate. We replace the group by PythonUDF in aggregate expression with aliased result.\r\n\r\nThe query plan of query `SELECT pyUDF(a + 1), pyUDF(COUNT(b)) FROM testData GROUP BY pyUDF(a + 1)`, like\r\n\r\n```\r\n== Optimized Logical Plan ==\r\nProject [CAST(pyUDF(cast((a + 1) as string)) AS INT)#8608, cast(pythonUDF0#8616 as bigint) AS CAST(pyUDF(cast(count(b) as string)) AS BIGINT)#8610L]\r\n+- BatchEvalPython [pyUDF(cast(agg#8613L as string))], [pythonUDF0#8616]\r\n   +- Aggregate [cast(groupingPythonUDF#8614 as int)], [cast(groupingPythonUDF#8614 as int) AS CAST(pyUDF(cast((a + 1) as string)) AS INT)#8608, count(b#8599) AS agg#8613L]\r\n      +- Project [pythonUDF0#8615 AS groupingPythonUDF#8614, b#8599]\r\n         +- BatchEvalPython [pyUDF(cast((a#8598 + 1) as string))], [pythonUDF0#8615]\r\n            +- LocalRelation [a#8598, b#8599]\r\n\r\n== Physical Plan ==\r\n*(3) Project [CAST(pyUDF(cast((a + 1) as string)) AS INT)#8608, cast(pythonUDF0#8616 as bigint) AS CAST(pyUDF(cast(count(b) as string)) AS BIGINT)#8610L]\r\n+- BatchEvalPython [pyUDF(cast(agg#8613L as string))], [pythonUDF0#8616]\r\n   +- *(2) HashAggregate(keys=[cast(groupingPythonUDF#8614 as int)#8617], functions=[count(b#8599)], output=[CAST(pyUDF(cast((a + 1) as string)) AS INT)#8608, agg#8613L])\r\n      +- Exchange hashpartitioning(cast(groupingPythonUDF#8614 as int)#8617, 5), true\r\n         +- *(1) HashAggregate(keys=[cast(groupingPythonUDF#8614 as int) AS cast(groupingPythonUDF#8614 as int)#8617], functions=[partial_count(b#8599)], output=[cast(groupingPythonUDF#8614 as int)#8617, count#8619L])\r\n            +- *(1) Project [pythonUDF0#8615 AS groupingPythonUDF#8614, b#8599]\r\n               +- BatchEvalPython [pyUDF(cast((a#8598 + 1) as string))], [pythonUDF0#8615]\r\n                  +- LocalTableScan [a#8598, b#8599]\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nAdded tests.","created_at":"2019-07-21T03:09:10Z","updated_at":"2023-12-27T18:22:45Z","closed_at":"2019-08-02T10:52:12Z","merged_at":null,"merge_commit_sha":"aa2dde58649ba54b84f99cadc203a9872c06d25b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25215/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25215/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25215/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/24c674408708cfa961055102f5483af0c78e0e43","head":{"label":"viirya:SPARK-28445","ref":"SPARK-28445","sha":"24c674408708cfa961055102f5483af0c78e0e43","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"72c80ee81ca4c3c9569749b54e2db0ec91b128a5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25215"},"html":{"href":"https://github.com/apache/spark/pull/25215"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25215"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25215/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25215/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25215/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/24c674408708cfa961055102f5483af0c78e0e43"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25214","id":299601147,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NjAxMTQ3","html_url":"https://github.com/apache/spark/pull/25214","diff_url":"https://github.com/apache/spark/pull/25214.diff","patch_url":"https://github.com/apache/spark/pull/25214.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25214","number":25214,"state":"closed","locked":false,"title":"[SPARK-28461][SQL] Pad Decimal numbers with trailing zeros to the scale of the column","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n[HIVE-12063](https://issues.apache.org/jira/browse/HIVE-12063) improved pad decimal numbers with trailing zeros to the scale of the column. The following description is copied from the description of HIVE-12063.\r\n\r\n> HIVE-7373 was to address the problems of trimming tailing zeros by Hive, which caused many problems including treating 0.0, 0.00 and so on as 0, which has different precision/scale. Please refer to HIVE-7373 description. However, HIVE-7373 was reverted by HIVE-8745 while the underlying problems remained. HIVE-11835 was resolved recently to address one of the problems, where 0.0, 0.00, and so on cannot be read into decimal(1,1).\r\n However, HIVE-11835 didn't address the problem of showing as 0 in query result for any decimal values such as 0.0, 0.00, etc. This causes confusion as 0 and 0.0 have different precision/scale than 0.\r\nThe proposal here is to pad zeros for query result to the type's scale. This not only removes the confusion described above, but also aligns with many other DBs. Internal decimal number representation doesn't change, however.\r\n\r\n**Spark SQL**:\r\n```sql\r\n// bin/spark-sql\r\nspark-sql> select cast(1 as decimal(38, 18));\r\n1\r\nspark-sql>\r\n\r\n// bin/beeline\r\n0: jdbc:hive2://localhost:10000/default> select cast(1 as decimal(38, 18));\r\n+----------------------------+--+\r\n| CAST(1 AS DECIMAL(38,18))  |\r\n+----------------------------+--+\r\n| 1.000000000000000000       |\r\n+----------------------------+--+\r\n\r\n// bin/spark-shell\r\nscala> spark.sql(\"select cast(1 as decimal(38, 18))\").show(false)\r\n+-------------------------+\r\n|CAST(1 AS DECIMAL(38,18))|\r\n+-------------------------+\r\n|1.000000000000000000     |\r\n+-------------------------+\r\n\r\n// bin/pyspark\r\n>>> spark.sql(\"select cast(1 as decimal(38, 18))\").show()\r\n+-------------------------+\r\n|CAST(1 AS DECIMAL(38,18))|\r\n+-------------------------+\r\n|     1.000000000000000000|\r\n+-------------------------+\r\n\r\n// bin/sparkR\r\n> showDF(sql(\"SELECT cast(1 as decimal(38, 18))\"))\r\n+-------------------------+\r\n|CAST(1 AS DECIMAL(38,18))|\r\n+-------------------------+\r\n|     1.000000000000000000|\r\n+-------------------------+\r\n```\r\n\r\n**PostgreSQL**:\r\n```sql\r\npostgres=# select cast(1 as decimal(38, 18));\r\n       numeric\r\n----------------------\r\n 1.000000000000000000\r\n(1 row)\r\n```\r\n**Presto**:\r\n```sql\r\npresto> select cast(1 as decimal(38, 18));\r\n        _col0\r\n----------------------\r\n 1.000000000000000000\r\n(1 row)\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nunit tests and manual test:\r\n```sql\r\nspark-sql> select cast(1 as decimal(38, 18));\r\n1.000000000000000000\r\n```\r\nSpark SQL Upgrading Guide:\r\n![image](https://user-images.githubusercontent.com/5399861/69649620-4405c380-10a8-11ea-84b1-6ee675663b98.png)\r\n\r\n\r\n","created_at":"2019-07-21T00:54:58Z","updated_at":"2019-11-29T01:30:41Z","closed_at":"2019-11-27T09:13:42Z","merged_at":null,"merge_commit_sha":"7710277176d9574e88ade165139766467b937bfa","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25214/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25214/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25214/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/564c79926c8d51a4086c7171c957a0dbb62ee8e2","head":{"label":"wangyum:SPARK-28461","ref":"SPARK-28461","sha":"564c79926c8d51a4086c7171c957a0dbb62ee8e2","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"de21f28f8a0a41dd7eb8ed1ff8b35a6d7538958b","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25214"},"html":{"href":"https://github.com/apache/spark/pull/25214"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25214"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25214/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25214/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25214/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/564c79926c8d51a4086c7171c957a0dbb62ee8e2"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25213","id":299598766,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NTk4NzY2","html_url":"https://github.com/apache/spark/pull/25213","diff_url":"https://github.com/apache/spark/pull/25213.diff","patch_url":"https://github.com/apache/spark/pull/25213.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25213","number":25213,"state":"closed","locked":false,"title":"[SPARK-28462][SQL][TEST] Add a prefix '*' to non-nullable attribute names in PlanTestBase.comparePlans failures","user":{"login":"maropu","id":692303,"node_id":"MDQ6VXNlcjY5MjMwMw==","avatar_url":"https://avatars.githubusercontent.com/u/692303?v=4","gravatar_id":"","url":"https://api.github.com/users/maropu","html_url":"https://github.com/maropu","followers_url":"https://api.github.com/users/maropu/followers","following_url":"https://api.github.com/users/maropu/following{/other_user}","gists_url":"https://api.github.com/users/maropu/gists{/gist_id}","starred_url":"https://api.github.com/users/maropu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maropu/subscriptions","organizations_url":"https://api.github.com/users/maropu/orgs","repos_url":"https://api.github.com/users/maropu/repos","events_url":"https://api.github.com/users/maropu/events{/privacy}","received_events_url":"https://api.github.com/users/maropu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nThis pr proposes to add a prefix '*' to non-nullable attribute names in PlanTestBase.comparePlans failures. In the current master, nullability mismatches might generate the same error message for left/right logical plans like this;\r\n```\r\n// This failure message was extracted from #24765\r\n- constraints should be inferred from aliased literals *** FAILED ***\r\n  == FAIL: Plans do not match ===\r\n  !'Join Inner, (two#0 = a#0)                    'Join Inner, (two#0 = a#0)\r\n   :- Filter (isnotnull(a#0) AND (2 <=> a#0))     :- Filter (isnotnull(a#0) AND (2 <=> a#0))\r\n   :  +- LocalRelation <empty>, [a#0, b#0, c#0]   :  +- LocalRelation <empty>, [a#0, b#0, c#0]\r\n   +- Project [2 AS two#0]                        +- Project [2 AS two#0]\r\n      +- LocalRelation <empty>, [a#0, b#0, c#0]      +- LocalRelation <empty>, [a#0, b#0, c#0] (PlanTest.scala:145)\r\n```\r\nWith this pr, this error message is changed to one below;\r\n```\r\n- constraints should be inferred from aliased literals *** FAILED ***\r\n  == FAIL: Plans do not match ===\r\n  !'Join Inner, (*two#0 = a#0)                    'Join Inner, (*two#0 = *a#0)\r\n   :- Filter (isnotnull(a#0) AND (2 <=> a#0))     :- Filter (isnotnull(a#0) AND (2 <=> a#0))\r\n   :  +- LocalRelation <empty>, [a#0, b#0, c#0]   :  +- LocalRelation <empty>, [a#0, b#0, c#0]\r\n   +- Project [2 AS two#0]                        +- Project [2 AS two#0]\r\n      +- LocalRelation <empty>, [a#0, b#0, c#0]      +- LocalRelation <empty>, [a#0, b#0, c#0] (PlanTest.scala:145)\r\n```\r\n\r\n## How was this patch tested?\r\nN/A","created_at":"2019-07-21T00:01:47Z","updated_at":"2019-07-21T20:39:05Z","closed_at":"2019-07-21T20:39:05Z","merged_at":null,"merge_commit_sha":"5cce107d34a6299488a38688b8345b18b8581b57","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25213/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25213/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25213/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0ae5dadafed72d65566585c059c7f767db36bb2f","head":{"label":"maropu:MarkForNullability","ref":"MarkForNullability","sha":"0ae5dadafed72d65566585c059c7f767db36bb2f","user":{"login":"maropu","id":692303,"node_id":"MDQ6VXNlcjY5MjMwMw==","avatar_url":"https://avatars.githubusercontent.com/u/692303?v=4","gravatar_id":"","url":"https://api.github.com/users/maropu","html_url":"https://github.com/maropu","followers_url":"https://api.github.com/users/maropu/followers","following_url":"https://api.github.com/users/maropu/following{/other_user}","gists_url":"https://api.github.com/users/maropu/gists{/gist_id}","starred_url":"https://api.github.com/users/maropu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maropu/subscriptions","organizations_url":"https://api.github.com/users/maropu/orgs","repos_url":"https://api.github.com/users/maropu/repos","events_url":"https://api.github.com/users/maropu/events{/privacy}","received_events_url":"https://api.github.com/users/maropu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":27115199,"node_id":"MDEwOlJlcG9zaXRvcnkyNzExNTE5OQ==","name":"spark","full_name":"maropu/spark","private":false,"owner":{"login":"maropu","id":692303,"node_id":"MDQ6VXNlcjY5MjMwMw==","avatar_url":"https://avatars.githubusercontent.com/u/692303?v=4","gravatar_id":"","url":"https://api.github.com/users/maropu","html_url":"https://github.com/maropu","followers_url":"https://api.github.com/users/maropu/followers","following_url":"https://api.github.com/users/maropu/following{/other_user}","gists_url":"https://api.github.com/users/maropu/gists{/gist_id}","starred_url":"https://api.github.com/users/maropu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maropu/subscriptions","organizations_url":"https://api.github.com/users/maropu/orgs","repos_url":"https://api.github.com/users/maropu/repos","events_url":"https://api.github.com/users/maropu/events{/privacy}","received_events_url":"https://api.github.com/users/maropu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/maropu/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/maropu/spark","forks_url":"https://api.github.com/repos/maropu/spark/forks","keys_url":"https://api.github.com/repos/maropu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/maropu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/maropu/spark/teams","hooks_url":"https://api.github.com/repos/maropu/spark/hooks","issue_events_url":"https://api.github.com/repos/maropu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/maropu/spark/events","assignees_url":"https://api.github.com/repos/maropu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/maropu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/maropu/spark/tags","blobs_url":"https://api.github.com/repos/maropu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/maropu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/maropu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/maropu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/maropu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/maropu/spark/languages","stargazers_url":"https://api.github.com/repos/maropu/spark/stargazers","contributors_url":"https://api.github.com/repos/maropu/spark/contributors","subscribers_url":"https://api.github.com/repos/maropu/spark/subscribers","subscription_url":"https://api.github.com/repos/maropu/spark/subscription","commits_url":"https://api.github.com/repos/maropu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/maropu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/maropu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/maropu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/maropu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/maropu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/maropu/spark/merges","archive_url":"https://api.github.com/repos/maropu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/maropu/spark/downloads","issues_url":"https://api.github.com/repos/maropu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/maropu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/maropu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/maropu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/maropu/spark/labels{/name}","releases_url":"https://api.github.com/repos/maropu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/maropu/spark/deployments","created_at":"2014-11-25T08:00:37Z","updated_at":"2021-06-22T15:34:47Z","pushed_at":"2021-07-16T02:22:28Z","git_url":"git://github.com/maropu/spark.git","ssh_url":"git@github.com:maropu/spark.git","clone_url":"https://github.com/maropu/spark.git","svn_url":"https://github.com/maropu/spark","homepage":null,"size":365163,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"72c80ee81ca4c3c9569749b54e2db0ec91b128a5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25213"},"html":{"href":"https://github.com/apache/spark/pull/25213"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25213"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25213/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25213/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25213/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0ae5dadafed72d65566585c059c7f767db36bb2f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25212","id":299578669,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NTc4NjY5","html_url":"https://github.com/apache/spark/pull/25212","diff_url":"https://github.com/apache/spark/pull/25212.diff","patch_url":"https://github.com/apache/spark/pull/25212.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25212","number":25212,"state":"closed","locked":false,"title":"[SPARK-28460][SQL][TEST][test-hadoop3.2] Port test from HIVE-11835","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n[HIVE-11835](https://issues.apache.org/jira/browse/HIVE-11835) fixed type `decimal(1,1)` reads 0.0, 0.00, etc from text file as NULL. We fixed this issue after upgrade the build-in Hive to 2.3.5. This PR port the test from [HIVE-11835](https://issues.apache.org/jira/browse/HIVE-11835).\r\n\r\nHive test result:\r\nhttps://github.com/apache/hive/blob/release-2.3.5-rc0/ql/src/test/results/clientpositive/decimal_1_1.q.out#L67-L96\r\n\r\n## How was this patch tested?\r\n\r\nN/A\r\n","created_at":"2019-07-20T17:22:07Z","updated_at":"2019-07-28T00:45:51Z","closed_at":"2019-07-28T00:09:11Z","merged_at":null,"merge_commit_sha":"f19f727a581d576ef37c0969adb4a93930ad022b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25212/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25212/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25212/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0589c8941f6adc070070e02c42675e48c15e93f5","head":{"label":"wangyum:SPARK-28460","ref":"SPARK-28460","sha":"0589c8941f6adc070070e02c42675e48c15e93f5","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"72c80ee81ca4c3c9569749b54e2db0ec91b128a5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25212"},"html":{"href":"https://github.com/apache/spark/pull/25212"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25212"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25212/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25212/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25212/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0589c8941f6adc070070e02c42675e48c15e93f5"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25211","id":299575926,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NTc1OTI2","html_url":"https://github.com/apache/spark/pull/25211","diff_url":"https://github.com/apache/spark/pull/25211.diff","patch_url":"https://github.com/apache/spark/pull/25211.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25211","number":25211,"state":"closed","locked":false,"title":"[WIP][SPARK-24907][SQL] DataSourceV2 based connector for JDBC","user":{"login":"shivsood","id":1579057,"node_id":"MDQ6VXNlcjE1NzkwNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1579057?v=4","gravatar_id":"","url":"https://api.github.com/users/shivsood","html_url":"https://github.com/shivsood","followers_url":"https://api.github.com/users/shivsood/followers","following_url":"https://api.github.com/users/shivsood/following{/other_user}","gists_url":"https://api.github.com/users/shivsood/gists{/gist_id}","starred_url":"https://api.github.com/users/shivsood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivsood/subscriptions","organizations_url":"https://api.github.com/users/shivsood/orgs","repos_url":"https://api.github.com/users/shivsood/repos","events_url":"https://api.github.com/users/shivsood/events{/privacy}","received_events_url":"https://api.github.com/users/shivsood/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nThis is a Work in Progress PR for DataSourceV2 based connector for JDBC. The goal is a MVP for both read and write path based on latest data source V2 apis. As of now the PR is *not* complete, but provided here for visibility on this work and comments to set us in the right direction. \r\n\r\nAnother PR on related work is https://github.com/apache/spark/pull/21861. That uses older V2 apis, but some of the work there may be still relevant. Have requested author to consider merge if possible. \r\n@tengpeng @xianyin as FYI as they volunteered for contribution to the work going forward.\r\n\r\nReadme.md added for high level work items. Find it at org/apache/spark/sql/execution/datasources/v2/jdbc/Readme.md\r\n\r\n(Please fill in changes proposed in this fix)\r\nThe current PR implements the following ( will keep this updated we make progress on this)\r\n- Scaffolding for read/write paths.\r\n- First draft implementation of dataframe write(append) flow. Connector name is \"jdbcv2\". df.write.format(\"jdbcv2\").mode(\"append\") appends to Table if table exists. Create table not supported as of now.\r\n- E2E test cases added in MsSqlServerIntegrationSuite.scala\r\n- JDBCUtils is reused as and when easiliy possible, but further scope of refactoring to make it work for both V1 and V2 flows.\r\n\r\n## How was this patch tested?\r\n- Validation with SQLServer 2017 only.\r\n- No unit test cases added for now.\r\n\r\n(Please explain how this patch was tested. E.g. unit tests, integration tests, manual tests)\r\n(If this patch involves UI changes, please attach a screenshot; otherwise, remove this)\r\nThe path was mainly integration tested for write ( append) path.\r\n\r\nPlease review https://spark.apache.org/contributing.html before opening a pull request.\r\n","created_at":"2019-07-20T16:36:48Z","updated_at":"2020-12-25T09:46:35Z","closed_at":"2019-12-27T00:07:38Z","merged_at":null,"merge_commit_sha":"245ed314e1fbff11fda16285137367e7c26b20ad","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25211/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25211/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25211/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/38b80e20b46135bf8ce6f227022736e2799fa2fc","head":{"label":"shivsood:dsv2_jdbc","ref":"dsv2_jdbc","sha":"38b80e20b46135bf8ce6f227022736e2799fa2fc","user":{"login":"shivsood","id":1579057,"node_id":"MDQ6VXNlcjE1NzkwNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1579057?v=4","gravatar_id":"","url":"https://api.github.com/users/shivsood","html_url":"https://github.com/shivsood","followers_url":"https://api.github.com/users/shivsood/followers","following_url":"https://api.github.com/users/shivsood/following{/other_user}","gists_url":"https://api.github.com/users/shivsood/gists{/gist_id}","starred_url":"https://api.github.com/users/shivsood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivsood/subscriptions","organizations_url":"https://api.github.com/users/shivsood/orgs","repos_url":"https://api.github.com/users/shivsood/repos","events_url":"https://api.github.com/users/shivsood/events{/privacy}","received_events_url":"https://api.github.com/users/shivsood/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":192983938,"node_id":"MDEwOlJlcG9zaXRvcnkxOTI5ODM5Mzg=","name":"spark","full_name":"shivsood/spark","private":false,"owner":{"login":"shivsood","id":1579057,"node_id":"MDQ6VXNlcjE1NzkwNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1579057?v=4","gravatar_id":"","url":"https://api.github.com/users/shivsood","html_url":"https://github.com/shivsood","followers_url":"https://api.github.com/users/shivsood/followers","following_url":"https://api.github.com/users/shivsood/following{/other_user}","gists_url":"https://api.github.com/users/shivsood/gists{/gist_id}","starred_url":"https://api.github.com/users/shivsood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivsood/subscriptions","organizations_url":"https://api.github.com/users/shivsood/orgs","repos_url":"https://api.github.com/users/shivsood/repos","events_url":"https://api.github.com/users/shivsood/events{/privacy}","received_events_url":"https://api.github.com/users/shivsood/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/shivsood/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/shivsood/spark","forks_url":"https://api.github.com/repos/shivsood/spark/forks","keys_url":"https://api.github.com/repos/shivsood/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/shivsood/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/shivsood/spark/teams","hooks_url":"https://api.github.com/repos/shivsood/spark/hooks","issue_events_url":"https://api.github.com/repos/shivsood/spark/issues/events{/number}","events_url":"https://api.github.com/repos/shivsood/spark/events","assignees_url":"https://api.github.com/repos/shivsood/spark/assignees{/user}","branches_url":"https://api.github.com/repos/shivsood/spark/branches{/branch}","tags_url":"https://api.github.com/repos/shivsood/spark/tags","blobs_url":"https://api.github.com/repos/shivsood/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/shivsood/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/shivsood/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/shivsood/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/shivsood/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/shivsood/spark/languages","stargazers_url":"https://api.github.com/repos/shivsood/spark/stargazers","contributors_url":"https://api.github.com/repos/shivsood/spark/contributors","subscribers_url":"https://api.github.com/repos/shivsood/spark/subscribers","subscription_url":"https://api.github.com/repos/shivsood/spark/subscription","commits_url":"https://api.github.com/repos/shivsood/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/shivsood/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/shivsood/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/shivsood/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/shivsood/spark/contents/{+path}","compare_url":"https://api.github.com/repos/shivsood/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/shivsood/spark/merges","archive_url":"https://api.github.com/repos/shivsood/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/shivsood/spark/downloads","issues_url":"https://api.github.com/repos/shivsood/spark/issues{/number}","pulls_url":"https://api.github.com/repos/shivsood/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/shivsood/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/shivsood/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/shivsood/spark/labels{/name}","releases_url":"https://api.github.com/repos/shivsood/spark/releases{/id}","deployments_url":"https://api.github.com/repos/shivsood/spark/deployments","created_at":"2019-06-20T20:32:39Z","updated_at":"2019-07-20T16:13:38Z","pushed_at":"2020-01-10T23:29:29Z","git_url":"git://github.com/shivsood/spark.git","ssh_url":"git@github.com:shivsood/spark.git","clone_url":"https://github.com/shivsood/spark.git","svn_url":"https://github.com/shivsood/spark","homepage":"","size":321701,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"8ae032d78d63f95c1100bc826ae246e4d4fdd34a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25211"},"html":{"href":"https://github.com/apache/spark/pull/25211"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25211"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25211/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25211/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25211/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/38b80e20b46135bf8ce6f227022736e2799fa2fc"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25210","id":299559856,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NTU5ODU2","html_url":"https://github.com/apache/spark/pull/25210","diff_url":"https://github.com/apache/spark/pull/25210.diff","patch_url":"https://github.com/apache/spark/pull/25210.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25210","number":25210,"state":"closed","locked":false,"title":"[SPARK-28432][SQL] Add `make_date` function","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nNew function `make_date()` takes 3 columns `year`, `month` and `day`, and makes new column of the `DATE` type. If values in the input columns are `null` or out of valid ranges, the function returns `null`. Valid ranges are:\r\n- `year` - `[1, 9999]`\r\n- `month` - `[1, 12]`\r\n- `day` - `[1, 31]`\r\n\r\nAlso constructed date must be valid otherwise `make_date` returns `null`.\r\n\r\nThe function is implemented similarly to `make_date` in PostgreSQL: https://www.postgresql.org/docs/11/functions-datetime.html to maintain feature parity with it.\r\n\r\nHere is an example:\r\n```sql\r\nselect make_date(2013, 7, 15);\r\n2013-07-15\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nAdded new tests to `DateExpressionsSuite`.\r\n","created_at":"2019-07-20T12:19:35Z","updated_at":"2019-09-18T15:58:20Z","closed_at":"2019-07-22T22:21:46Z","merged_at":null,"merge_commit_sha":"9a7cfc567db486e13ccf0701ddbc3de0f3fbb9c3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25210/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25210/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25210/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/15c64d2dfcb616334e1d054f9fdb485f1870ed81","head":{"label":"MaxGekk:make_date-timestamp","ref":"make_date-timestamp","sha":"15c64d2dfcb616334e1d054f9fdb485f1870ed81","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":123690489,"node_id":"MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=","name":"spark","full_name":"MaxGekk/spark","private":false,"owner":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/MaxGekk/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/MaxGekk/spark","forks_url":"https://api.github.com/repos/MaxGekk/spark/forks","keys_url":"https://api.github.com/repos/MaxGekk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/MaxGekk/spark/teams","hooks_url":"https://api.github.com/repos/MaxGekk/spark/hooks","issue_events_url":"https://api.github.com/repos/MaxGekk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/MaxGekk/spark/events","assignees_url":"https://api.github.com/repos/MaxGekk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/MaxGekk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/MaxGekk/spark/tags","blobs_url":"https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/MaxGekk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/MaxGekk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/MaxGekk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/MaxGekk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/MaxGekk/spark/languages","stargazers_url":"https://api.github.com/repos/MaxGekk/spark/stargazers","contributors_url":"https://api.github.com/repos/MaxGekk/spark/contributors","subscribers_url":"https://api.github.com/repos/MaxGekk/spark/subscribers","subscription_url":"https://api.github.com/repos/MaxGekk/spark/subscription","commits_url":"https://api.github.com/repos/MaxGekk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/MaxGekk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/MaxGekk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/MaxGekk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/MaxGekk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/MaxGekk/spark/merges","archive_url":"https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/MaxGekk/spark/downloads","issues_url":"https://api.github.com/repos/MaxGekk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/MaxGekk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/MaxGekk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/MaxGekk/spark/labels{/name}","releases_url":"https://api.github.com/repos/MaxGekk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/MaxGekk/spark/deployments","created_at":"2018-03-03T12:37:00Z","updated_at":"2025-02-07T09:44:52Z","pushed_at":"2025-02-07T09:44:24Z","git_url":"git://github.com/MaxGekk/spark.git","ssh_url":"git@github.com:MaxGekk/spark.git","clone_url":"https://github.com/MaxGekk/spark.git","svn_url":"https://github.com/MaxGekk/spark","homepage":null,"size":486456,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"36d7d81d23a5c59f75aa9586ce740b30f7e5ae59","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25210"},"html":{"href":"https://github.com/apache/spark/pull/25210"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25210"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25210/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25210/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25210/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/15c64d2dfcb616334e1d054f9fdb485f1870ed81"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25209","id":299509917,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NTA5OTE3","html_url":"https://github.com/apache/spark/pull/25209","diff_url":"https://github.com/apache/spark/pull/25209.diff","patch_url":"https://github.com/apache/spark/pull/25209.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25209","number":25209,"state":"closed","locked":false,"title":"[SPARK-28456][SQL] Add a public API `Encoder.makeCopy` to allow creating Encoder without touching Scala Reflection","user":{"login":"zsxwing","id":1000778,"node_id":"MDQ6VXNlcjEwMDA3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/1000778?v=4","gravatar_id":"","url":"https://api.github.com/users/zsxwing","html_url":"https://github.com/zsxwing","followers_url":"https://api.github.com/users/zsxwing/followers","following_url":"https://api.github.com/users/zsxwing/following{/other_user}","gists_url":"https://api.github.com/users/zsxwing/gists{/gist_id}","starred_url":"https://api.github.com/users/zsxwing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zsxwing/subscriptions","organizations_url":"https://api.github.com/users/zsxwing/orgs","repos_url":"https://api.github.com/users/zsxwing/repos","events_url":"https://api.github.com/users/zsxwing/events{/privacy}","received_events_url":"https://api.github.com/users/zsxwing/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nBecause `Encoder` is not thread safe, the user cannot reuse an `Encoder` in multiple `Dataset`s. However, creating an `Encoder` for a complicated class is slow due to Scala Reflection. To eliminate the cost of Scala Reflection, right now I usually use the private API `ExpressionEncoder.copy` as follows:\r\n\r\n```scala\r\nobject FooEncoder {\r\n  private lazy val _encoder: ExpressionEncoder[Foo] = ExpressionEncoder[Foo]()\r\n  implicit def encoder: ExpressionEncoder[Foo] = _encoder.copy()\r\n}\r\n```\r\n\r\nThis PR proposes a new method `makeCopy` in `Encoder` so that the above codes can be rewritten using public APIs.\r\n\r\n```scala\r\nobject FooEncoder {\r\n  private lazy val _encoder: Encoder[Foo] = Encoders.product[Foo]()\r\n  implicit def encoder: Encoder[Foo] = _encoder.makeCopy\r\n}\r\n```\r\n\r\nThe method name is consistent with `TreeNode.makeCopy`.\r\n\r\n## How was this patch tested?\r\n\r\nJenkins","created_at":"2019-07-19T22:56:30Z","updated_at":"2019-07-22T17:54:40Z","closed_at":"2019-07-22T04:36:29Z","merged_at":null,"merge_commit_sha":"ef28b5b7a4e25f7a62c319309539d63b689318eb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25209/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25209/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25209/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3f18ceb877ffb0e7e75af6a20173a4fc5919e831","head":{"label":"zsxwing:encoder-copy","ref":"encoder-copy","sha":"3f18ceb877ffb0e7e75af6a20173a4fc5919e831","user":{"login":"zsxwing","id":1000778,"node_id":"MDQ6VXNlcjEwMDA3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/1000778?v=4","gravatar_id":"","url":"https://api.github.com/users/zsxwing","html_url":"https://github.com/zsxwing","followers_url":"https://api.github.com/users/zsxwing/followers","following_url":"https://api.github.com/users/zsxwing/following{/other_user}","gists_url":"https://api.github.com/users/zsxwing/gists{/gist_id}","starred_url":"https://api.github.com/users/zsxwing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zsxwing/subscriptions","organizations_url":"https://api.github.com/users/zsxwing/orgs","repos_url":"https://api.github.com/users/zsxwing/repos","events_url":"https://api.github.com/users/zsxwing/events{/privacy}","received_events_url":"https://api.github.com/users/zsxwing/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":88661206,"node_id":"MDEwOlJlcG9zaXRvcnk4ODY2MTIwNg==","name":"spark","full_name":"zsxwing/spark","private":false,"owner":{"login":"zsxwing","id":1000778,"node_id":"MDQ6VXNlcjEwMDA3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/1000778?v=4","gravatar_id":"","url":"https://api.github.com/users/zsxwing","html_url":"https://github.com/zsxwing","followers_url":"https://api.github.com/users/zsxwing/followers","following_url":"https://api.github.com/users/zsxwing/following{/other_user}","gists_url":"https://api.github.com/users/zsxwing/gists{/gist_id}","starred_url":"https://api.github.com/users/zsxwing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zsxwing/subscriptions","organizations_url":"https://api.github.com/users/zsxwing/orgs","repos_url":"https://api.github.com/users/zsxwing/repos","events_url":"https://api.github.com/users/zsxwing/events{/privacy}","received_events_url":"https://api.github.com/users/zsxwing/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zsxwing/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zsxwing/spark","forks_url":"https://api.github.com/repos/zsxwing/spark/forks","keys_url":"https://api.github.com/repos/zsxwing/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zsxwing/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zsxwing/spark/teams","hooks_url":"https://api.github.com/repos/zsxwing/spark/hooks","issue_events_url":"https://api.github.com/repos/zsxwing/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zsxwing/spark/events","assignees_url":"https://api.github.com/repos/zsxwing/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zsxwing/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zsxwing/spark/tags","blobs_url":"https://api.github.com/repos/zsxwing/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zsxwing/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zsxwing/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zsxwing/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zsxwing/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zsxwing/spark/languages","stargazers_url":"https://api.github.com/repos/zsxwing/spark/stargazers","contributors_url":"https://api.github.com/repos/zsxwing/spark/contributors","subscribers_url":"https://api.github.com/repos/zsxwing/spark/subscribers","subscription_url":"https://api.github.com/repos/zsxwing/spark/subscription","commits_url":"https://api.github.com/repos/zsxwing/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zsxwing/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zsxwing/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zsxwing/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zsxwing/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zsxwing/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zsxwing/spark/merges","archive_url":"https://api.github.com/repos/zsxwing/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zsxwing/spark/downloads","issues_url":"https://api.github.com/repos/zsxwing/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zsxwing/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zsxwing/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zsxwing/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zsxwing/spark/labels{/name}","releases_url":"https://api.github.com/repos/zsxwing/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zsxwing/spark/deployments","created_at":"2017-04-18T19:11:28Z","updated_at":"2017-04-18T19:11:55Z","pushed_at":"2022-11-08T16:33:20Z","git_url":"git://github.com/zsxwing/spark.git","ssh_url":"git@github.com:zsxwing/spark.git","clone_url":"https://github.com/zsxwing/spark.git","svn_url":"https://github.com/zsxwing/spark","homepage":null,"size":376188,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4196d7bd349f6220b2796597253a4124c6a50769","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25209"},"html":{"href":"https://github.com/apache/spark/pull/25209"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25209"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25209/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25209/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25209/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3f18ceb877ffb0e7e75af6a20173a4fc5919e831"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25208","id":299504192,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NTA0MTky","html_url":"https://github.com/apache/spark/pull/25208","diff_url":"https://github.com/apache/spark/pull/25208.diff","patch_url":"https://github.com/apache/spark/pull/25208.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25208","number":25208,"state":"closed","locked":false,"title":"[SPARK-28455][core] Avoid overflow when calculating executor timeout time","user":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"This would cause the timeout time to be negative, so executors would be\r\ntimed out immediately (instead of never).\r\n\r\nI also tweaked a couple of log messages that could get pretty long when\r\nlots of executors were active.\r\n\r\nAdded unit test (which failed without the fix).","created_at":"2019-07-19T22:22:45Z","updated_at":"2019-07-24T19:01:51Z","closed_at":"2019-07-22T21:36:40Z","merged_at":null,"merge_commit_sha":"26e7532b07d1619e228c89259d7046dbdf0fa9e6","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25208/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25208/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25208/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/392e5858c9029dc2e4d81198e241b2fadc5335eb","head":{"label":"vanzin:SPARK-28455","ref":"SPARK-28455","sha":"392e5858c9029dc2e4d81198e241b2fadc5335eb","user":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":18302272,"node_id":"MDEwOlJlcG9zaXRvcnkxODMwMjI3Mg==","name":"spark","full_name":"vanzin/spark","private":false,"owner":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vanzin/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/vanzin/spark","forks_url":"https://api.github.com/repos/vanzin/spark/forks","keys_url":"https://api.github.com/repos/vanzin/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vanzin/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vanzin/spark/teams","hooks_url":"https://api.github.com/repos/vanzin/spark/hooks","issue_events_url":"https://api.github.com/repos/vanzin/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vanzin/spark/events","assignees_url":"https://api.github.com/repos/vanzin/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vanzin/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vanzin/spark/tags","blobs_url":"https://api.github.com/repos/vanzin/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vanzin/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vanzin/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vanzin/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vanzin/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vanzin/spark/languages","stargazers_url":"https://api.github.com/repos/vanzin/spark/stargazers","contributors_url":"https://api.github.com/repos/vanzin/spark/contributors","subscribers_url":"https://api.github.com/repos/vanzin/spark/subscribers","subscription_url":"https://api.github.com/repos/vanzin/spark/subscription","commits_url":"https://api.github.com/repos/vanzin/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vanzin/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vanzin/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vanzin/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vanzin/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vanzin/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vanzin/spark/merges","archive_url":"https://api.github.com/repos/vanzin/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vanzin/spark/downloads","issues_url":"https://api.github.com/repos/vanzin/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vanzin/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vanzin/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vanzin/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vanzin/spark/labels{/name}","releases_url":"https://api.github.com/repos/vanzin/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vanzin/spark/deployments","created_at":"2014-03-31T17:49:25Z","updated_at":"2018-01-06T03:57:54Z","pushed_at":"2020-01-24T16:55:58Z","git_url":"git://github.com/vanzin/spark.git","ssh_url":"git@github.com:vanzin/spark.git","clone_url":"https://github.com/vanzin/spark.git","svn_url":"https://github.com/vanzin/spark","homepage":null,"size":287134,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4196d7bd349f6220b2796597253a4124c6a50769","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25208"},"html":{"href":"https://github.com/apache/spark/pull/25208"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25208"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25208/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25208/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25208/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/392e5858c9029dc2e4d81198e241b2fadc5335eb"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25207","id":299493750,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NDkzNzUw","html_url":"https://github.com/apache/spark/pull/25207","diff_url":"https://github.com/apache/spark/pull/25207.diff","patch_url":"https://github.com/apache/spark/pull/25207.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25207","number":25207,"state":"closed","locked":false,"title":"[SPARK-27815][SQL][FOLLOWUP][DOC] Update comment that references `PushDownPredicate`","user":{"login":"jiangxb1987","id":4784782,"node_id":"MDQ6VXNlcjQ3ODQ3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/4784782?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangxb1987","html_url":"https://github.com/jiangxb1987","followers_url":"https://api.github.com/users/jiangxb1987/followers","following_url":"https://api.github.com/users/jiangxb1987/following{/other_user}","gists_url":"https://api.github.com/users/jiangxb1987/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangxb1987/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangxb1987/subscriptions","organizations_url":"https://api.github.com/users/jiangxb1987/orgs","repos_url":"https://api.github.com/users/jiangxb1987/repos","events_url":"https://api.github.com/users/jiangxb1987/events{/privacy}","received_events_url":"https://api.github.com/users/jiangxb1987/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe optimize rule `PushDownPredicate` has been combined into `PushDownPredicates`, update the comment that references the old rule.\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-19T21:34:52Z","updated_at":"2019-07-20T16:14:34Z","closed_at":"2019-07-20T07:49:03Z","merged_at":null,"merge_commit_sha":"5f58a7fdc8b62f02e8eba77ec947679595177b2d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627011,"node_id":"MDU6TGFiZWwxNDA2NjI3MDEx","url":"https://api.github.com/repos/apache/spark/labels/DOCUMENTATION","name":"DOCUMENTATION","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25207/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25207/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25207/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2c67b840504155e71030448ec8d34291b0292c93","head":{"label":"jiangxb1987:comment","ref":"comment","sha":"2c67b840504155e71030448ec8d34291b0292c93","user":{"login":"jiangxb1987","id":4784782,"node_id":"MDQ6VXNlcjQ3ODQ3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/4784782?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangxb1987","html_url":"https://github.com/jiangxb1987","followers_url":"https://api.github.com/users/jiangxb1987/followers","following_url":"https://api.github.com/users/jiangxb1987/following{/other_user}","gists_url":"https://api.github.com/users/jiangxb1987/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangxb1987/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangxb1987/subscriptions","organizations_url":"https://api.github.com/users/jiangxb1987/orgs","repos_url":"https://api.github.com/users/jiangxb1987/repos","events_url":"https://api.github.com/users/jiangxb1987/events{/privacy}","received_events_url":"https://api.github.com/users/jiangxb1987/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":35214686,"node_id":"MDEwOlJlcG9zaXRvcnkzNTIxNDY4Ng==","name":"spark","full_name":"jiangxb1987/spark","private":false,"owner":{"login":"jiangxb1987","id":4784782,"node_id":"MDQ6VXNlcjQ3ODQ3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/4784782?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangxb1987","html_url":"https://github.com/jiangxb1987","followers_url":"https://api.github.com/users/jiangxb1987/followers","following_url":"https://api.github.com/users/jiangxb1987/following{/other_user}","gists_url":"https://api.github.com/users/jiangxb1987/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangxb1987/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangxb1987/subscriptions","organizations_url":"https://api.github.com/users/jiangxb1987/orgs","repos_url":"https://api.github.com/users/jiangxb1987/repos","events_url":"https://api.github.com/users/jiangxb1987/events{/privacy}","received_events_url":"https://api.github.com/users/jiangxb1987/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/jiangxb1987/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/jiangxb1987/spark","forks_url":"https://api.github.com/repos/jiangxb1987/spark/forks","keys_url":"https://api.github.com/repos/jiangxb1987/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/jiangxb1987/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/jiangxb1987/spark/teams","hooks_url":"https://api.github.com/repos/jiangxb1987/spark/hooks","issue_events_url":"https://api.github.com/repos/jiangxb1987/spark/issues/events{/number}","events_url":"https://api.github.com/repos/jiangxb1987/spark/events","assignees_url":"https://api.github.com/repos/jiangxb1987/spark/assignees{/user}","branches_url":"https://api.github.com/repos/jiangxb1987/spark/branches{/branch}","tags_url":"https://api.github.com/repos/jiangxb1987/spark/tags","blobs_url":"https://api.github.com/repos/jiangxb1987/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/jiangxb1987/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/jiangxb1987/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/jiangxb1987/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/jiangxb1987/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/jiangxb1987/spark/languages","stargazers_url":"https://api.github.com/repos/jiangxb1987/spark/stargazers","contributors_url":"https://api.github.com/repos/jiangxb1987/spark/contributors","subscribers_url":"https://api.github.com/repos/jiangxb1987/spark/subscribers","subscription_url":"https://api.github.com/repos/jiangxb1987/spark/subscription","commits_url":"https://api.github.com/repos/jiangxb1987/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/jiangxb1987/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/jiangxb1987/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/jiangxb1987/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/jiangxb1987/spark/contents/{+path}","compare_url":"https://api.github.com/repos/jiangxb1987/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/jiangxb1987/spark/merges","archive_url":"https://api.github.com/repos/jiangxb1987/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/jiangxb1987/spark/downloads","issues_url":"https://api.github.com/repos/jiangxb1987/spark/issues{/number}","pulls_url":"https://api.github.com/repos/jiangxb1987/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/jiangxb1987/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/jiangxb1987/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/jiangxb1987/spark/labels{/name}","releases_url":"https://api.github.com/repos/jiangxb1987/spark/releases{/id}","deployments_url":"https://api.github.com/repos/jiangxb1987/spark/deployments","created_at":"2015-05-07T10:48:35Z","updated_at":"2022-01-24T20:20:00Z","pushed_at":"2024-01-09T22:37:37Z","git_url":"git://github.com/jiangxb1987/spark.git","ssh_url":"git@github.com:jiangxb1987/spark.git","clone_url":"https://github.com/jiangxb1987/spark.git","svn_url":"https://github.com/jiangxb1987/spark","homepage":null,"size":410571,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4196d7bd349f6220b2796597253a4124c6a50769","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25207"},"html":{"href":"https://github.com/apache/spark/pull/25207"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25207"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25207/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25207/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25207/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2c67b840504155e71030448ec8d34291b0292c93"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25206","id":299486206,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5NDg2MjA2","html_url":"https://github.com/apache/spark/pull/25206","diff_url":"https://github.com/apache/spark/pull/25206.diff","patch_url":"https://github.com/apache/spark/pull/25206.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25206","number":25206,"state":"closed","locked":false,"title":"[SPARK-28265][SQL] Add renameTable to TableCatalog API","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds the `renameTable` call to the `TableCatalog` API, as described in the [Table Metadata API SPIP](https://docs.google.com/document/d/1zLFiA1VuaWeVxeTDXNg8bL6GP3BVoOZBkewFtEnjEoo/edit#heading=h.m45webtwxf2d).\r\n\r\nThis PR is related to: https://github.com/apache/spark/pull/24246\r\n\r\n## How was this patch tested?\r\n\r\nAdded  unit tests and contract tests.\r\n","created_at":"2019-07-19T21:04:18Z","updated_at":"2019-08-14T06:29:03Z","closed_at":"2019-08-14T06:29:03Z","merged_at":null,"merge_commit_sha":"15a8d3e67215e8f8c38b7490174f2b013252dbfc","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25206/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25206/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25206/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/71d9ad1b497f79fefee9a83d8f40c565288c1c9a","head":{"label":"edgarRd:SPARK-28265-add-rename-table-catalog-api","ref":"SPARK-28265-add-rename-table-catalog-api","sha":"71d9ad1b497f79fefee9a83d8f40c565288c1c9a","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":174655826,"node_id":"MDEwOlJlcG9zaXRvcnkxNzQ2NTU4MjY=","name":"spark","full_name":"edgarRd/spark","private":false,"owner":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/edgarRd/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/edgarRd/spark","forks_url":"https://api.github.com/repos/edgarRd/spark/forks","keys_url":"https://api.github.com/repos/edgarRd/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/edgarRd/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/edgarRd/spark/teams","hooks_url":"https://api.github.com/repos/edgarRd/spark/hooks","issue_events_url":"https://api.github.com/repos/edgarRd/spark/issues/events{/number}","events_url":"https://api.github.com/repos/edgarRd/spark/events","assignees_url":"https://api.github.com/repos/edgarRd/spark/assignees{/user}","branches_url":"https://api.github.com/repos/edgarRd/spark/branches{/branch}","tags_url":"https://api.github.com/repos/edgarRd/spark/tags","blobs_url":"https://api.github.com/repos/edgarRd/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/edgarRd/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/edgarRd/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/edgarRd/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/edgarRd/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/edgarRd/spark/languages","stargazers_url":"https://api.github.com/repos/edgarRd/spark/stargazers","contributors_url":"https://api.github.com/repos/edgarRd/spark/contributors","subscribers_url":"https://api.github.com/repos/edgarRd/spark/subscribers","subscription_url":"https://api.github.com/repos/edgarRd/spark/subscription","commits_url":"https://api.github.com/repos/edgarRd/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/edgarRd/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/edgarRd/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/edgarRd/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/edgarRd/spark/contents/{+path}","compare_url":"https://api.github.com/repos/edgarRd/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/edgarRd/spark/merges","archive_url":"https://api.github.com/repos/edgarRd/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/edgarRd/spark/downloads","issues_url":"https://api.github.com/repos/edgarRd/spark/issues{/number}","pulls_url":"https://api.github.com/repos/edgarRd/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/edgarRd/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/edgarRd/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/edgarRd/spark/labels{/name}","releases_url":"https://api.github.com/repos/edgarRd/spark/releases{/id}","deployments_url":"https://api.github.com/repos/edgarRd/spark/deployments","created_at":"2019-03-09T06:10:58Z","updated_at":"2020-07-14T17:32:43Z","pushed_at":"2022-06-15T19:41:38Z","git_url":"git://github.com/edgarRd/spark.git","ssh_url":"git@github.com:edgarRd/spark.git","clone_url":"https://github.com/edgarRd/spark.git","svn_url":"https://github.com/edgarRd/spark","homepage":"","size":403131,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"48d04f74ca895497b9d8bab18c7708f76f55c520","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25206"},"html":{"href":"https://github.com/apache/spark/pull/25206"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25206"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25206/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25206/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25206/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/71d9ad1b497f79fefee9a83d8f40c565288c1c9a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25205","id":299393326,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5MzkzMzI2","html_url":"https://github.com/apache/spark/pull/25205","diff_url":"https://github.com/apache/spark/pull/25205.diff","patch_url":"https://github.com/apache/spark/pull/25205.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25205","number":25205,"state":"closed","locked":false,"title":"[SPARK-28415][DSTREAMS] Add messageHandler to Kafka 10 direct stream API","user":{"login":"spektom","id":158011,"node_id":"MDQ6VXNlcjE1ODAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/158011?v=4","gravatar_id":"","url":"https://api.github.com/users/spektom","html_url":"https://github.com/spektom","followers_url":"https://api.github.com/users/spektom/followers","following_url":"https://api.github.com/users/spektom/following{/other_user}","gists_url":"https://api.github.com/users/spektom/gists{/gist_id}","starred_url":"https://api.github.com/users/spektom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spektom/subscriptions","organizations_url":"https://api.github.com/users/spektom/orgs","repos_url":"https://api.github.com/users/spektom/repos","events_url":"https://api.github.com/users/spektom/events{/privacy}","received_events_url":"https://api.github.com/users/spektom/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis patch introduces messageHandler parameter that can be provided to Kafka DStream, which allows processing events received from Kafka at an early stage.\r\n\r\nLack of messageHandler parameter to KafkaUtils.createDirectStrem(...) in the new Kafka 10 API is what prevents us from upgrading our processes to use it, and here's why:\r\n\r\n1. messageHandler() allowed parsing / filtering / projecting huge JSON files at an early stage (only a small subset of JSON fields is required for a process), without this current cluster configuration doesn't keep up with the traffic.\r\n2. Transforming Kafka events right after a stream is created prevents from using HasOffsetRanges interface later. This means that whole message must be propagated to the end of a pipeline, which is very ineffective.\r\n\r\n## How was this patch tested?\r\n\r\nUnit tests are provided.\r\n","created_at":"2019-07-19T16:01:21Z","updated_at":"2019-12-27T00:07:39Z","closed_at":"2019-12-27T00:07:39Z","merged_at":null,"merge_commit_sha":"3c380e101ff82a06ff517dca2bfb51aa868d5738","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587334,"node_id":"MDU6TGFiZWwxNDA2NTg3MzM0","url":"https://api.github.com/repos/apache/spark/labels/DSTREAMS","name":"DSTREAMS","color":"ededed","default":false,"description":null},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25205/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25205/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25205/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/fe05f1e7431b6170d3625ceb08b08d4d91e20a86","head":{"label":"spektom:SPARK-28415","ref":"SPARK-28415","sha":"fe05f1e7431b6170d3625ceb08b08d4d91e20a86","user":{"login":"spektom","id":158011,"node_id":"MDQ6VXNlcjE1ODAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/158011?v=4","gravatar_id":"","url":"https://api.github.com/users/spektom","html_url":"https://github.com/spektom","followers_url":"https://api.github.com/users/spektom/followers","following_url":"https://api.github.com/users/spektom/following{/other_user}","gists_url":"https://api.github.com/users/spektom/gists{/gist_id}","starred_url":"https://api.github.com/users/spektom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spektom/subscriptions","organizations_url":"https://api.github.com/users/spektom/orgs","repos_url":"https://api.github.com/users/spektom/repos","events_url":"https://api.github.com/users/spektom/events{/privacy}","received_events_url":"https://api.github.com/users/spektom/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"4196d7bd349f6220b2796597253a4124c6a50769","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25205"},"html":{"href":"https://github.com/apache/spark/pull/25205"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25205"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25205/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25205/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25205/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/fe05f1e7431b6170d3625ceb08b08d4d91e20a86"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25204","id":299361863,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5MzYxODYz","html_url":"https://github.com/apache/spark/pull/25204","diff_url":"https://github.com/apache/spark/pull/25204.diff","patch_url":"https://github.com/apache/spark/pull/25204.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25204","number":25204,"state":"closed","locked":false,"title":"[SPARK-28441][SQL][Python] Fix error when non-foldable expression is used in correlated scalar subquery","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nIn SPARK-15370, We checked the expression at the root of the correlated subquery, in order to fix count bug. If a `PythonUDF` in in the checking path, evaluating it causes the failure as we can't statically evaluate `PythonUDF`. The Python UDF test added at SPARK-28277 shows this issue.\r\n\r\nIf we can statically evaluate the expression, we intercept NULL values coming from the outer join and replace them with the value that the subquery's expression like before, if it is not, we replace them with the `PythonUDF` expression, with statically evaluated parameters.\r\n\r\nAfter this, the last query in `udf-except.sql` which throws `java.lang.UnsupportedOperationException` can be run:\r\n\r\n```\r\nSELECT t1.k\r\nFROM   t1\r\nWHERE  t1.v <= (SELECT   udf(max(udf(t2.v)))\r\n                FROM     t2\r\n                WHERE    udf(t2.k) = udf(t1.k))\r\nMINUS\r\nSELECT t1.k\r\nFROM   t1\r\nWHERE  udf(t1.v) >= (SELECT   min(udf(t2.v))\r\n                FROM     t2\r\n                WHERE    t2.k = t1.k)\r\n-- !query 2 schema\r\nstruct<k:string>\r\n-- !query 2 output\r\ntwo\r\n```\r\n\r\nNote that this issue is also for other non-foldable expressions, like rand. As like PythonUDF, we can't call `eval` on this kind of expressions in optimization. The evaluation needs to defer to query runtime.\r\n\r\n## How was this patch tested?\r\n\r\nAdded tests.","created_at":"2019-07-19T14:36:44Z","updated_at":"2023-12-27T18:22:44Z","closed_at":"2019-07-27T02:43:17Z","merged_at":null,"merge_commit_sha":"98afe8d1f41dbb6a907b82b12646c0b859b654c6","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25204/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25204/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25204/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/fd296776b826f6ce041a52cdc4dce4e278d3d786","head":{"label":"viirya:SPARK-28441","ref":"SPARK-28441","sha":"fd296776b826f6ce041a52cdc4dce4e278d3d786","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"022667cea666190bea651a3873234700a472326c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25204"},"html":{"href":"https://github.com/apache/spark/pull/25204"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25204"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25204/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25204/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25204/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/fd296776b826f6ce041a52cdc4dce4e278d3d786"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25203","id":299324285,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5MzI0Mjg1","html_url":"https://github.com/apache/spark/pull/25203","diff_url":"https://github.com/apache/spark/pull/25203.diff","patch_url":"https://github.com/apache/spark/pull/25203.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25203","number":25203,"state":"closed","locked":false,"title":"[SPARK-28446][DOC][SS] Document Kafka Headers support","user":{"login":"dongjinleekr","id":2375128,"node_id":"MDQ6VXNlcjIzNzUxMjg=","avatar_url":"https://avatars.githubusercontent.com/u/2375128?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjinleekr","html_url":"https://github.com/dongjinleekr","followers_url":"https://api.github.com/users/dongjinleekr/followers","following_url":"https://api.github.com/users/dongjinleekr/following{/other_user}","gists_url":"https://api.github.com/users/dongjinleekr/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjinleekr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjinleekr/subscriptions","organizations_url":"https://api.github.com/users/dongjinleekr/orgs","repos_url":"https://api.github.com/users/dongjinleekr/repos","events_url":"https://api.github.com/users/dongjinleekr/events{/privacy}","received_events_url":"https://api.github.com/users/dongjinleekr/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"This PR is a follow-up of #22282, which implements support for [Kafka's headers functionality](https://cwiki.apache.org/confluence/display/KAFKA/KIP-82+-+Add+Record+Headers).","created_at":"2019-07-19T12:59:31Z","updated_at":"2019-07-20T23:41:04Z","closed_at":"2019-07-20T23:41:04Z","merged_at":null,"merge_commit_sha":"d700c8c638c78e4d51b18a9579e8bd2b1e222042","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1406627011,"node_id":"MDU6TGFiZWwxNDA2NjI3MDEx","url":"https://api.github.com/repos/apache/spark/labels/DOCUMENTATION","name":"DOCUMENTATION","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25203/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25203/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25203/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6b1d1f97afd0246f9f47f96ce92d45999269775b","head":{"label":"dongjinleekr:feature/SPARK-28446","ref":"feature/SPARK-28446","sha":"6b1d1f97afd0246f9f47f96ce92d45999269775b","user":{"login":"dongjinleekr","id":2375128,"node_id":"MDQ6VXNlcjIzNzUxMjg=","avatar_url":"https://avatars.githubusercontent.com/u/2375128?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjinleekr","html_url":"https://github.com/dongjinleekr","followers_url":"https://api.github.com/users/dongjinleekr/followers","following_url":"https://api.github.com/users/dongjinleekr/following{/other_user}","gists_url":"https://api.github.com/users/dongjinleekr/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjinleekr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjinleekr/subscriptions","organizations_url":"https://api.github.com/users/dongjinleekr/orgs","repos_url":"https://api.github.com/users/dongjinleekr/repos","events_url":"https://api.github.com/users/dongjinleekr/events{/privacy}","received_events_url":"https://api.github.com/users/dongjinleekr/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":63324258,"node_id":"MDEwOlJlcG9zaXRvcnk2MzMyNDI1OA==","name":"spark","full_name":"dongjinleekr/spark","private":false,"owner":{"login":"dongjinleekr","id":2375128,"node_id":"MDQ6VXNlcjIzNzUxMjg=","avatar_url":"https://avatars.githubusercontent.com/u/2375128?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjinleekr","html_url":"https://github.com/dongjinleekr","followers_url":"https://api.github.com/users/dongjinleekr/followers","following_url":"https://api.github.com/users/dongjinleekr/following{/other_user}","gists_url":"https://api.github.com/users/dongjinleekr/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjinleekr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjinleekr/subscriptions","organizations_url":"https://api.github.com/users/dongjinleekr/orgs","repos_url":"https://api.github.com/users/dongjinleekr/repos","events_url":"https://api.github.com/users/dongjinleekr/events{/privacy}","received_events_url":"https://api.github.com/users/dongjinleekr/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dongjinleekr/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/dongjinleekr/spark","forks_url":"https://api.github.com/repos/dongjinleekr/spark/forks","keys_url":"https://api.github.com/repos/dongjinleekr/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dongjinleekr/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dongjinleekr/spark/teams","hooks_url":"https://api.github.com/repos/dongjinleekr/spark/hooks","issue_events_url":"https://api.github.com/repos/dongjinleekr/spark/issues/events{/number}","events_url":"https://api.github.com/repos/dongjinleekr/spark/events","assignees_url":"https://api.github.com/repos/dongjinleekr/spark/assignees{/user}","branches_url":"https://api.github.com/repos/dongjinleekr/spark/branches{/branch}","tags_url":"https://api.github.com/repos/dongjinleekr/spark/tags","blobs_url":"https://api.github.com/repos/dongjinleekr/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dongjinleekr/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dongjinleekr/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/dongjinleekr/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dongjinleekr/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/dongjinleekr/spark/languages","stargazers_url":"https://api.github.com/repos/dongjinleekr/spark/stargazers","contributors_url":"https://api.github.com/repos/dongjinleekr/spark/contributors","subscribers_url":"https://api.github.com/repos/dongjinleekr/spark/subscribers","subscription_url":"https://api.github.com/repos/dongjinleekr/spark/subscription","commits_url":"https://api.github.com/repos/dongjinleekr/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/dongjinleekr/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/dongjinleekr/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/dongjinleekr/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/dongjinleekr/spark/contents/{+path}","compare_url":"https://api.github.com/repos/dongjinleekr/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dongjinleekr/spark/merges","archive_url":"https://api.github.com/repos/dongjinleekr/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dongjinleekr/spark/downloads","issues_url":"https://api.github.com/repos/dongjinleekr/spark/issues{/number}","pulls_url":"https://api.github.com/repos/dongjinleekr/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/dongjinleekr/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/dongjinleekr/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dongjinleekr/spark/labels{/name}","releases_url":"https://api.github.com/repos/dongjinleekr/spark/releases{/id}","deployments_url":"https://api.github.com/repos/dongjinleekr/spark/deployments","created_at":"2016-07-14T09:51:57Z","updated_at":"2019-09-14T05:42:48Z","pushed_at":"2019-09-14T05:42:41Z","git_url":"git://github.com/dongjinleekr/spark.git","ssh_url":"git@github.com:dongjinleekr/spark.git","clone_url":"https://github.com/dongjinleekr/spark.git","svn_url":"https://github.com/dongjinleekr/spark","homepage":null,"size":294427,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"453cbf3dd8df5ec4da844c93eb6000610b551541","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25203"},"html":{"href":"https://github.com/apache/spark/pull/25203"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25203"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25203/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25203/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25203/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6b1d1f97afd0246f9f47f96ce92d45999269775b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25202","id":299323231,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5MzIzMjMx","html_url":"https://github.com/apache/spark/pull/25202","diff_url":"https://github.com/apache/spark/pull/25202.diff","patch_url":"https://github.com/apache/spark/pull/25202.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25202","number":25202,"state":"closed","locked":false,"title":"[SPARK-28289][SQL][PYTHON][TESTS] Convert and port 'union.sql' into UDF test base","user":{"login":"yiheng","id":1297418,"node_id":"MDQ6VXNlcjEyOTc0MTg=","avatar_url":"https://avatars.githubusercontent.com/u/1297418?v=4","gravatar_id":"","url":"https://api.github.com/users/yiheng","html_url":"https://github.com/yiheng","followers_url":"https://api.github.com/users/yiheng/followers","following_url":"https://api.github.com/users/yiheng/following{/other_user}","gists_url":"https://api.github.com/users/yiheng/gists{/gist_id}","starred_url":"https://api.github.com/users/yiheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yiheng/subscriptions","organizations_url":"https://api.github.com/users/yiheng/orgs","repos_url":"https://api.github.com/users/yiheng/repos","events_url":"https://api.github.com/users/yiheng/events{/privacy}","received_events_url":"https://api.github.com/users/yiheng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nThis PR adds some tests converted from 'union.sql' to test UDFs\r\n\r\n<details><summary>Diff comparing to 'union.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/union.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-union.sql.out\r\nindex b023df825d..84b5e10dbe 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/union.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-union.sql.out\r\n@@ -19,10 +19,10 @@ struct<>\r\n\r\n\r\n -- !query 2\r\n-SELECT *\r\n-FROM   (SELECT * FROM t1\r\n+SELECT udf(c1) as c1, udf(c2) as c2\r\n+FROM   (SELECT udf(c1) as c1, udf(c2) as c2 FROM t1\r\n         UNION ALL\r\n-        SELECT * FROM t1)\r\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t1)\r\n -- !query 2 schema\r\n struct<c1:int,c2:string>\r\n -- !query 2 output\r\n@@ -33,12 +33,12 @@ struct<c1:int,c2:string>\r\n\r\n\r\n -- !query 3\r\n-SELECT *\r\n-FROM   (SELECT * FROM t1\r\n+SELECT udf(c1) as c1, udf(c2) as c2\r\n+FROM   (SELECT udf(c1) as c1, udf(c2) as c2 FROM t1\r\n         UNION ALL\r\n-        SELECT * FROM t2\r\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t2\r\n         UNION ALL\r\n-        SELECT * FROM t2)\r\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t2)\r\n -- !query 3 schema\r\n struct<c1:decimal(11,1),c2:string>\r\n -- !query 3 output\r\n@@ -51,11 +51,11 @@ struct<c1:decimal(11,1),c2:string>\r\n\r\n\r\n -- !query 4\r\n-SELECT a\r\n-FROM (SELECT 0 a, 0 b\r\n+SELECT udf(udf(a)) as a\r\n+FROM (SELECT udf(0) a, udf(0) b\r\n       UNION ALL\r\n-      SELECT SUM(1) a, CAST(0 AS BIGINT) b\r\n-      UNION ALL SELECT 0 a, 0 b) T\r\n+      SELECT udf(SUM(1)) a, udf(CAST(0 AS BIGINT)) b\r\n+      UNION ALL SELECT udf(0) a, udf(0) b) T\r\n -- !query 4 schema\r\n struct<a:bigint>\r\n -- !query 4 output\r\n@@ -89,13 +89,13 @@ struct<>\r\n\r\n\r\n -- !query 8\r\n-SELECT 1 AS x,\r\n-       col\r\n-FROM   (SELECT col AS col\r\n-        FROM (SELECT p1.col AS col\r\n+SELECT udf(1) AS x,\r\n+       udf(col) as col\r\n+FROM   (SELECT udf(col) AS col\r\n+        FROM (SELECT udf(p1.col) AS col\r\n               FROM   p1 CROSS JOIN p2\r\n               UNION ALL\r\n-              SELECT col\r\n+              SELECT udf(col)\r\n               FROM p3) T1) T2\r\n -- !query 8 schema\r\n struct<x:int,col:int>\r\n@@ -105,9 +105,9 @@ struct<x:int,col:int>\r\n\r\n\r\n -- !query 9\r\n-SELECT map(1, 2), 'str'\r\n+SELECT map(1, 2), udf('str') as str\r\n UNION ALL\r\n-SELECT map(1, 2, 3, NULL), 1\r\n+SELECT map(1, 2, 3, NULL), udf(1)\r\n -- !query 9 schema\r\n struct<map(1, 2):map<int,int>,str:string>\r\n -- !query 9 output\r\n@@ -116,9 +116,9 @@ struct<map(1, 2):map<int,int>,str:string>\r\n\r\n\r\n -- !query 10\r\n-SELECT array(1, 2), 'str'\r\n+SELECT array(1, 2), udf('str') as str\r\n UNION ALL\r\n-SELECT array(1, 2, 3, NULL), 1\r\n+SELECT array(1, 2, 3, NULL), udf(1)\r\n -- !query 10 schema\r\n struct<array(1, 2):array<int>,str:string>\r\n -- !query 10 output\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\nTested as guided in SPARK-27921.\r\n","created_at":"2019-07-19T12:56:31Z","updated_at":"2019-07-26T03:10:09Z","closed_at":"2019-07-26T03:10:09Z","merged_at":null,"merge_commit_sha":"cffae406ecd33389df2ab06cb673c8d89b7593e4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25202/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25202/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25202/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7c87cb9d9527415adc28a97afeb4512e71e669bf","head":{"label":"yiheng:fix_28289","ref":"fix_28289","sha":"7c87cb9d9527415adc28a97afeb4512e71e669bf","user":{"login":"yiheng","id":1297418,"node_id":"MDQ6VXNlcjEyOTc0MTg=","avatar_url":"https://avatars.githubusercontent.com/u/1297418?v=4","gravatar_id":"","url":"https://api.github.com/users/yiheng","html_url":"https://github.com/yiheng","followers_url":"https://api.github.com/users/yiheng/followers","following_url":"https://api.github.com/users/yiheng/following{/other_user}","gists_url":"https://api.github.com/users/yiheng/gists{/gist_id}","starred_url":"https://api.github.com/users/yiheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yiheng/subscriptions","organizations_url":"https://api.github.com/users/yiheng/orgs","repos_url":"https://api.github.com/users/yiheng/repos","events_url":"https://api.github.com/users/yiheng/events{/privacy}","received_events_url":"https://api.github.com/users/yiheng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":31858071,"node_id":"MDEwOlJlcG9zaXRvcnkzMTg1ODA3MQ==","name":"spark","full_name":"yiheng/spark","private":false,"owner":{"login":"yiheng","id":1297418,"node_id":"MDQ6VXNlcjEyOTc0MTg=","avatar_url":"https://avatars.githubusercontent.com/u/1297418?v=4","gravatar_id":"","url":"https://api.github.com/users/yiheng","html_url":"https://github.com/yiheng","followers_url":"https://api.github.com/users/yiheng/followers","following_url":"https://api.github.com/users/yiheng/following{/other_user}","gists_url":"https://api.github.com/users/yiheng/gists{/gist_id}","starred_url":"https://api.github.com/users/yiheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yiheng/subscriptions","organizations_url":"https://api.github.com/users/yiheng/orgs","repos_url":"https://api.github.com/users/yiheng/repos","events_url":"https://api.github.com/users/yiheng/events{/privacy}","received_events_url":"https://api.github.com/users/yiheng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yiheng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/yiheng/spark","forks_url":"https://api.github.com/repos/yiheng/spark/forks","keys_url":"https://api.github.com/repos/yiheng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yiheng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yiheng/spark/teams","hooks_url":"https://api.github.com/repos/yiheng/spark/hooks","issue_events_url":"https://api.github.com/repos/yiheng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/yiheng/spark/events","assignees_url":"https://api.github.com/repos/yiheng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/yiheng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/yiheng/spark/tags","blobs_url":"https://api.github.com/repos/yiheng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yiheng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yiheng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/yiheng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yiheng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/yiheng/spark/languages","stargazers_url":"https://api.github.com/repos/yiheng/spark/stargazers","contributors_url":"https://api.github.com/repos/yiheng/spark/contributors","subscribers_url":"https://api.github.com/repos/yiheng/spark/subscribers","subscription_url":"https://api.github.com/repos/yiheng/spark/subscription","commits_url":"https://api.github.com/repos/yiheng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/yiheng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/yiheng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/yiheng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/yiheng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/yiheng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yiheng/spark/merges","archive_url":"https://api.github.com/repos/yiheng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yiheng/spark/downloads","issues_url":"https://api.github.com/repos/yiheng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/yiheng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/yiheng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/yiheng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yiheng/spark/labels{/name}","releases_url":"https://api.github.com/repos/yiheng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/yiheng/spark/deployments","created_at":"2015-03-08T17:14:39Z","updated_at":"2015-03-26T06:08:08Z","pushed_at":"2019-07-25T03:38:07Z","git_url":"git://github.com/yiheng/spark.git","ssh_url":"git@github.com:yiheng/spark.git","clone_url":"https://github.com/yiheng/spark.git","svn_url":"https://github.com/yiheng/spark","homepage":null,"size":275135,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"167fa0402dab0800e9762d63d29bd6d9892fa9a8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25202"},"html":{"href":"https://github.com/apache/spark/pull/25202"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25202"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25202/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25202/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25202/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7c87cb9d9527415adc28a97afeb4512e71e669bf"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25201","id":299316806,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5MzE2ODA2","html_url":"https://github.com/apache/spark/pull/25201","diff_url":"https://github.com/apache/spark/pull/25201.diff","patch_url":"https://github.com/apache/spark/pull/25201.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25201","number":25201,"state":"closed","locked":false,"title":"[SPARK-28419][SQL] Enable SparkThriftServer support proxy user's authentication .","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n#25179\r\nSince origin SparkThriftServer  can't proxy client user's authentication about hive and HDFS authentications.\r\nthis PR is to enable SparkThriftServer can proxy user's authorities.\r\n\r\nFor this pr, we first obtain HDFS token for current UGI, the it can truly proxy HDFS priority. Then for each proxy user, when we create hiveClient, we obtain a  Hive token for proxy user. Different user use different SparkSession.sharedState.\r\nThen pass DFS toke to each Task, to proxy user's DFS behavior in Executors.\r\n\r\n\r\n## How was this patch tested?\r\n\r\nmanual test","created_at":"2019-07-19T12:37:08Z","updated_at":"2024-03-26T13:51:36Z","closed_at":"2020-06-02T00:21:27Z","merged_at":null,"merge_commit_sha":"b1084ad5c32713a95fc44c41c8bff63a6c183392","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25201/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25201/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25201/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/424dca304aec99c7c1012197e5369c54b8700a01","head":{"label":"AngersZhuuuu:28419","ref":"28419","sha":"424dca304aec99c7c1012197e5369c54b8700a01","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":176224753,"node_id":"MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=","name":"spark","full_name":"AngersZhuuuu/spark","private":false,"owner":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/AngersZhuuuu/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/AngersZhuuuu/spark","forks_url":"https://api.github.com/repos/AngersZhuuuu/spark/forks","keys_url":"https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/AngersZhuuuu/spark/teams","hooks_url":"https://api.github.com/repos/AngersZhuuuu/spark/hooks","issue_events_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/AngersZhuuuu/spark/events","assignees_url":"https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/tags","blobs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/AngersZhuuuu/spark/languages","stargazers_url":"https://api.github.com/repos/AngersZhuuuu/spark/stargazers","contributors_url":"https://api.github.com/repos/AngersZhuuuu/spark/contributors","subscribers_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscribers","subscription_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscription","commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/AngersZhuuuu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/AngersZhuuuu/spark/merges","archive_url":"https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/AngersZhuuuu/spark/downloads","issues_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/AngersZhuuuu/spark/labels{/name}","releases_url":"https://api.github.com/repos/AngersZhuuuu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/AngersZhuuuu/spark/deployments","created_at":"2019-03-18T07:13:25Z","updated_at":"2024-12-31T06:48:27Z","pushed_at":"2024-12-31T06:45:23Z","git_url":"git://github.com/AngersZhuuuu/spark.git","ssh_url":"git@github.com:AngersZhuuuu/spark.git","clone_url":"https://github.com/AngersZhuuuu/spark.git","svn_url":"https://github.com/AngersZhuuuu/spark","homepage":"","size":446399,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"453cbf3dd8df5ec4da844c93eb6000610b551541","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25201"},"html":{"href":"https://github.com/apache/spark/pull/25201"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25201"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25201/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25201/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25201/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/424dca304aec99c7c1012197e5369c54b8700a01"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25200","id":299296517,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5Mjk2NTE3","html_url":"https://github.com/apache/spark/pull/25200","diff_url":"https://github.com/apache/spark/pull/25200.diff","patch_url":"https://github.com/apache/spark/pull/25200.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25200","number":25200,"state":"closed","locked":false,"title":"[SPARK-28199][SS][FOLLOWUP] Remove unnecessary annotations for private API","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nSPARK-28199 (#24996) hid implementations of Triggers into `private[sql]` and encourage end users to use `Trigger.xxx` methods instead.\r\n\r\nAs I got some post review comment on https://github.com/apache/spark/commit/7548a8826d6113121b6bda1ea99ca835374220b6#r34366934 we could remove annotations which are meant to be used with public API.\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-19T11:30:35Z","updated_at":"2019-07-25T08:56:24Z","closed_at":"2019-07-19T15:31:24Z","merged_at":null,"merge_commit_sha":"1e290bf2ca119c285dec1b91102869ba94315f52","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25200/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25200/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25200/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a5902aff6727f89529f2cb61e368fc7ce6f4c9a8","head":{"label":"HeartSaVioR:SPARK-28199-FOLLOWUP","ref":"SPARK-28199-FOLLOWUP","sha":"a5902aff6727f89529f2cb61e368fc7ce6f4c9a8","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":27994296,"node_id":"MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==","name":"spark","full_name":"HeartSaVioR/spark","private":false,"owner":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HeartSaVioR/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HeartSaVioR/spark","forks_url":"https://api.github.com/repos/HeartSaVioR/spark/forks","keys_url":"https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HeartSaVioR/spark/teams","hooks_url":"https://api.github.com/repos/HeartSaVioR/spark/hooks","issue_events_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HeartSaVioR/spark/events","assignees_url":"https://api.github.com/repos/HeartSaVioR/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HeartSaVioR/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HeartSaVioR/spark/tags","blobs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HeartSaVioR/spark/languages","stargazers_url":"https://api.github.com/repos/HeartSaVioR/spark/stargazers","contributors_url":"https://api.github.com/repos/HeartSaVioR/spark/contributors","subscribers_url":"https://api.github.com/repos/HeartSaVioR/spark/subscribers","subscription_url":"https://api.github.com/repos/HeartSaVioR/spark/subscription","commits_url":"https://api.github.com/repos/HeartSaVioR/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HeartSaVioR/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HeartSaVioR/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HeartSaVioR/spark/merges","archive_url":"https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HeartSaVioR/spark/downloads","issues_url":"https://api.github.com/repos/HeartSaVioR/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HeartSaVioR/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HeartSaVioR/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HeartSaVioR/spark/labels{/name}","releases_url":"https://api.github.com/repos/HeartSaVioR/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HeartSaVioR/spark/deployments","created_at":"2014-12-14T12:56:04Z","updated_at":"2024-10-21T04:36:36Z","pushed_at":"2025-01-08T06:13:27Z","git_url":"git://github.com/HeartSaVioR/spark.git","ssh_url":"git@github.com:HeartSaVioR/spark.git","clone_url":"https://github.com/HeartSaVioR/spark.git","svn_url":"https://github.com/HeartSaVioR/spark","homepage":null,"size":456164,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":1,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"453cbf3dd8df5ec4da844c93eb6000610b551541","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25200"},"html":{"href":"https://github.com/apache/spark/pull/25200"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25200"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25200/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25200/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25200/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a5902aff6727f89529f2cb61e368fc7ce6f4c9a8"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25199","id":299175630,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5MTc1NjMw","html_url":"https://github.com/apache/spark/pull/25199","diff_url":"https://github.com/apache/spark/pull/25199.diff","patch_url":"https://github.com/apache/spark/pull/25199.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25199","number":25199,"state":"closed","locked":false,"title":"[SPARK-28389][SQL][FOLLOW-UP] Use one example in 'add_months' behavior change at migration guide","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR proposes to add one example to describe 'add_months'  behaviour change by https://github.com/apache/spark/pull/25153.\r\n\r\n**Spark 2.4:**\r\n\r\n```sql\r\nselect add_months(DATE'2019-02-28', 1)\r\n```\r\n\r\n```\r\n+--------------------------------+\r\n|add_months(DATE '2019-02-28', 1)|\r\n+--------------------------------+\r\n|                      2019-03-31|\r\n+--------------------------------+\r\n```\r\n\r\n**Current master:**\r\n\r\n```sql\r\nselect add_months(DATE'2019-02-28', 1)\r\n```\r\n\r\n```\r\n+--------------------------------+\r\n|add_months(DATE '2019-02-28', 1)|\r\n+--------------------------------+\r\n|                      2019-03-28|\r\n+--------------------------------+\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nManually tested on Spark 2.4.1 and the current master.\r\n","created_at":"2019-07-19T04:03:00Z","updated_at":"2020-03-03T01:18:26Z","closed_at":"2019-07-19T05:33:40Z","merged_at":null,"merge_commit_sha":"e4c2030dea4db851ecd7576c8272eb90789dc601","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25199/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25199/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25199/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1f20426d9000c09c9d6329fc9b406edf0cc9d45b","head":{"label":"HyukjinKwon:SPARK-28389","ref":"SPARK-28389","sha":"1f20426d9000c09c9d6329fc9b406edf0cc9d45b","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"20578e81a734880bbde3778e017e91e9e86a14ed","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25199"},"html":{"href":"https://github.com/apache/spark/pull/25199"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25199"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25199/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25199/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25199/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1f20426d9000c09c9d6329fc9b406edf0cc9d45b"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25198","id":299157891,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5MTU3ODkx","html_url":"https://github.com/apache/spark/pull/25198","diff_url":"https://github.com/apache/spark/pull/25198.diff","patch_url":"https://github.com/apache/spark/pull/25198.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25198","number":25198,"state":"closed","locked":false,"title":"[SPARK-28443][SQL] Spark sql add exception when create field type NullType","user":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nMore detail see [25085](https://github.com/apache/spark/pull/25085).\r\nThis PR is to discuss details that `add exception when create field type NullType`\r\n\r\nNow, it's ok to create table like:\r\n```\r\nval schema = new StructType().add(\"c\", NullType)\r\nspark.catalog.createTable(\r\n          tableName = \"t\",\r\n          source = \"json\",\r\n          schema = schema,\r\n          options = Map.empty[String, String])\r\n```\r\nBut it's not the spark idea\r\n## How was this patch tested?\r\n\r\nUT\r\n","created_at":"2019-07-19T02:12:44Z","updated_at":"2020-01-10T00:06:59Z","closed_at":"2020-01-10T00:06:59Z","merged_at":null,"merge_commit_sha":"16346703d2f27cecf9f93be9dd661e66ecb8fc4d","assignee":null,"assignees":[],"requested_reviewers":[{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25198/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25198/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25198/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/358e2a225d6744274599774ca9ea9878c712a1e5","head":{"label":"ulysses-you:SPARK-28443","ref":"SPARK-28443","sha":"358e2a225d6744274599774ca9ea9878c712a1e5","user":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":195747855,"node_id":"MDEwOlJlcG9zaXRvcnkxOTU3NDc4NTU=","name":"spark","full_name":"ulysses-you/spark","private":false,"owner":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ulysses-you/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/ulysses-you/spark","forks_url":"https://api.github.com/repos/ulysses-you/spark/forks","keys_url":"https://api.github.com/repos/ulysses-you/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ulysses-you/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ulysses-you/spark/teams","hooks_url":"https://api.github.com/repos/ulysses-you/spark/hooks","issue_events_url":"https://api.github.com/repos/ulysses-you/spark/issues/events{/number}","events_url":"https://api.github.com/repos/ulysses-you/spark/events","assignees_url":"https://api.github.com/repos/ulysses-you/spark/assignees{/user}","branches_url":"https://api.github.com/repos/ulysses-you/spark/branches{/branch}","tags_url":"https://api.github.com/repos/ulysses-you/spark/tags","blobs_url":"https://api.github.com/repos/ulysses-you/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ulysses-you/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ulysses-you/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ulysses-you/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ulysses-you/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ulysses-you/spark/languages","stargazers_url":"https://api.github.com/repos/ulysses-you/spark/stargazers","contributors_url":"https://api.github.com/repos/ulysses-you/spark/contributors","subscribers_url":"https://api.github.com/repos/ulysses-you/spark/subscribers","subscription_url":"https://api.github.com/repos/ulysses-you/spark/subscription","commits_url":"https://api.github.com/repos/ulysses-you/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ulysses-you/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ulysses-you/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ulysses-you/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ulysses-you/spark/contents/{+path}","compare_url":"https://api.github.com/repos/ulysses-you/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ulysses-you/spark/merges","archive_url":"https://api.github.com/repos/ulysses-you/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ulysses-you/spark/downloads","issues_url":"https://api.github.com/repos/ulysses-you/spark/issues{/number}","pulls_url":"https://api.github.com/repos/ulysses-you/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ulysses-you/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ulysses-you/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ulysses-you/spark/labels{/name}","releases_url":"https://api.github.com/repos/ulysses-you/spark/releases{/id}","deployments_url":"https://api.github.com/repos/ulysses-you/spark/deployments","created_at":"2019-07-08T06:11:57Z","updated_at":"2022-01-10T01:34:59Z","pushed_at":"2024-08-13T23:12:37Z","git_url":"git://github.com/ulysses-you/spark.git","ssh_url":"git@github.com:ulysses-you/spark.git","clone_url":"https://github.com/ulysses-you/spark.git","svn_url":"https://github.com/ulysses-you/spark","homepage":"","size":399300,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"989b0c773f832cf827bf5e5b34609866391667b5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25198"},"html":{"href":"https://github.com/apache/spark/pull/25198"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25198"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25198/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25198/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25198/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/358e2a225d6744274599774ca9ea9878c712a1e5"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25197","id":299155321,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5MTU1MzIx","html_url":"https://github.com/apache/spark/pull/25197","diff_url":"https://github.com/apache/spark/pull/25197.diff","patch_url":"https://github.com/apache/spark/pull/25197.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25197","number":25197,"state":"closed","locked":false,"title":"[SPARK-21067][SQL] Initialize the HdfsEncryptionShim and the underlying FileSystem(FS) e…","user":{"login":"xianyinxin","id":15028683,"node_id":"MDQ6VXNlcjE1MDI4Njgz","avatar_url":"https://avatars.githubusercontent.com/u/15028683?v=4","gravatar_id":"","url":"https://api.github.com/users/xianyinxin","html_url":"https://github.com/xianyinxin","followers_url":"https://api.github.com/users/xianyinxin/followers","following_url":"https://api.github.com/users/xianyinxin/following{/other_user}","gists_url":"https://api.github.com/users/xianyinxin/gists{/gist_id}","starred_url":"https://api.github.com/users/xianyinxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xianyinxin/subscriptions","organizations_url":"https://api.github.com/users/xianyinxin/orgs","repos_url":"https://api.github.com/users/xianyinxin/repos","events_url":"https://api.github.com/users/xianyinxin/events{/privacy}","received_events_url":"https://api.github.com/users/xianyinxin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis pr fix the \"Filesystem Closed\" exception that caused by the closing of a hive session in thriftserver.\r\n\r\nA `sessionState` holds a `hdfsEncryptionShim`, which holds a `fileSystem`. When a session was closed, the fileSystem may be closed. While the fileSystem is cached, so the subsequent using of the same fileSystem may throw \"Filesystem closed\" exception if previous session closes the fileSystem.\r\n\r\nWe can move the \"holding of the `fileSystem`\" from session to thriftserver by triggering `SessionState#getHdfsEncryptionShim` eagerly at the starting phase of the thriftserver, see below,\r\n\r\n```\r\nHiveThriftServer2#main()\r\n    hiveClientImpl\r\n        val state = newState\r\n            SessionState.start(state)\r\n                SessionState.setCurrentSession(state)\r\n        **state.getHdfsEncryptionShim**\r\n```\r\n\r\nIn hive session, the new sessionState will reuse the `fileSystem` created by thriftserver,\r\n\r\n```\r\nCliService\r\n    openSession\r\n        HiveSessionImpl\r\n            init\r\n                sessionState = new SessionState\r\n                SessionState.setCurrentSession(sessionState)\r\n            executeStatementInternal\r\n                SessionState.setCurrentSession(sessionState)\r\n                operation.run()\r\n                    hiveSession.getSessionManager().submitBackgroundOperation(operation)\r\n                    **// If some code calls \"state.getHdfsEncryptionShim\", the cached `fileSystem` is reused.**\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nmanual test\r\n\r\n","created_at":"2019-07-19T01:56:21Z","updated_at":"2019-08-02T06:35:55Z","closed_at":"2019-08-02T06:35:55Z","merged_at":null,"merge_commit_sha":"30ae6af77a8a52aa9f1935033e8ad13b837318d5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25197/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25197/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25197/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/af6db068743072d79ba399f370a8e2242e24f54c","head":{"label":"xianyinxin:SPARK-21067","ref":"SPARK-21067","sha":"af6db068743072d79ba399f370a8e2242e24f54c","user":{"login":"xianyinxin","id":15028683,"node_id":"MDQ6VXNlcjE1MDI4Njgz","avatar_url":"https://avatars.githubusercontent.com/u/15028683?v=4","gravatar_id":"","url":"https://api.github.com/users/xianyinxin","html_url":"https://github.com/xianyinxin","followers_url":"https://api.github.com/users/xianyinxin/followers","following_url":"https://api.github.com/users/xianyinxin/following{/other_user}","gists_url":"https://api.github.com/users/xianyinxin/gists{/gist_id}","starred_url":"https://api.github.com/users/xianyinxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xianyinxin/subscriptions","organizations_url":"https://api.github.com/users/xianyinxin/orgs","repos_url":"https://api.github.com/users/xianyinxin/repos","events_url":"https://api.github.com/users/xianyinxin/events{/privacy}","received_events_url":"https://api.github.com/users/xianyinxin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":182274989,"node_id":"MDEwOlJlcG9zaXRvcnkxODIyNzQ5ODk=","name":"spark","full_name":"xianyinxin/spark","private":false,"owner":{"login":"xianyinxin","id":15028683,"node_id":"MDQ6VXNlcjE1MDI4Njgz","avatar_url":"https://avatars.githubusercontent.com/u/15028683?v=4","gravatar_id":"","url":"https://api.github.com/users/xianyinxin","html_url":"https://github.com/xianyinxin","followers_url":"https://api.github.com/users/xianyinxin/followers","following_url":"https://api.github.com/users/xianyinxin/following{/other_user}","gists_url":"https://api.github.com/users/xianyinxin/gists{/gist_id}","starred_url":"https://api.github.com/users/xianyinxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xianyinxin/subscriptions","organizations_url":"https://api.github.com/users/xianyinxin/orgs","repos_url":"https://api.github.com/users/xianyinxin/repos","events_url":"https://api.github.com/users/xianyinxin/events{/privacy}","received_events_url":"https://api.github.com/users/xianyinxin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xianyinxin/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/xianyinxin/spark","forks_url":"https://api.github.com/repos/xianyinxin/spark/forks","keys_url":"https://api.github.com/repos/xianyinxin/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xianyinxin/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xianyinxin/spark/teams","hooks_url":"https://api.github.com/repos/xianyinxin/spark/hooks","issue_events_url":"https://api.github.com/repos/xianyinxin/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xianyinxin/spark/events","assignees_url":"https://api.github.com/repos/xianyinxin/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xianyinxin/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xianyinxin/spark/tags","blobs_url":"https://api.github.com/repos/xianyinxin/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xianyinxin/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xianyinxin/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xianyinxin/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xianyinxin/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xianyinxin/spark/languages","stargazers_url":"https://api.github.com/repos/xianyinxin/spark/stargazers","contributors_url":"https://api.github.com/repos/xianyinxin/spark/contributors","subscribers_url":"https://api.github.com/repos/xianyinxin/spark/subscribers","subscription_url":"https://api.github.com/repos/xianyinxin/spark/subscription","commits_url":"https://api.github.com/repos/xianyinxin/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xianyinxin/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xianyinxin/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xianyinxin/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xianyinxin/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xianyinxin/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xianyinxin/spark/merges","archive_url":"https://api.github.com/repos/xianyinxin/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xianyinxin/spark/downloads","issues_url":"https://api.github.com/repos/xianyinxin/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xianyinxin/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xianyinxin/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xianyinxin/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xianyinxin/spark/labels{/name}","releases_url":"https://api.github.com/repos/xianyinxin/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xianyinxin/spark/deployments","created_at":"2019-04-19T14:13:19Z","updated_at":"2019-05-08T01:59:34Z","pushed_at":"2020-06-29T06:08:23Z","git_url":"git://github.com/xianyinxin/spark.git","ssh_url":"git@github.com:xianyinxin/spark.git","clone_url":"https://github.com/xianyinxin/spark.git","svn_url":"https://github.com/xianyinxin/spark","homepage":"","size":331024,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"d2598fee3bc192767d1dc36d58bc95324137c6f6","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25197"},"html":{"href":"https://github.com/apache/spark/pull/25197"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25197"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25197/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25197/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25197/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/af6db068743072d79ba399f370a8e2242e24f54c"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25196","id":299126985,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk5MTI2OTg1","html_url":"https://github.com/apache/spark/pull/25196","diff_url":"https://github.com/apache/spark/pull/25196.diff","patch_url":"https://github.com/apache/spark/pull/25196.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25196","number":25196,"state":"closed","locked":false,"title":"[SPARK-28279][SQL][PYTHON][TESTS] Convert and port 'group-analytics.sql' into UDF test base","user":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nThis PR adds some tests converted from group-analytics.sql to test UDFs. Please see contribution guide of this umbrella ticket - SPARK-27921.\r\n\r\n<details><summary>Diff comparing to 'group-analytics.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/udf/udf-group-analytics.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-group-analytics.sql.out\r\nindex 31e9e08e2c..3439a05727 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/udf/udf-group-analytics.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-group-analytics.sql.out\r\n@@ -13,9 +13,9 @@ struct<>\r\n \r\n \r\n -- !query 1\r\n-SELECT a + b, b, udf(SUM(a - b)) FROM testData GROUP BY a + b, b WITH CUBE\r\n+SELECT a + b, b, SUM(a - b) FROM testData GROUP BY a + b, b WITH CUBE\r\n -- !query 1 schema\r\n-struct<(a + b):int,b:int,CAST(udf(cast(sum(cast((a - b) as bigint)) as string)) AS BIGINT):bigint>\r\n+struct<(a + b):int,b:int,sum((a - b)):bigint>\r\n -- !query 1 output\r\n 2\t1\t0\r\n 2\tNULL\t0\r\n@@ -33,9 +33,9 @@ NULL\tNULL\t3\r\n \r\n \r\n -- !query 2\r\n-SELECT a, udf(b), SUM(b) FROM testData GROUP BY a, b WITH CUBE\r\n+SELECT a, b, SUM(b) FROM testData GROUP BY a, b WITH CUBE\r\n -- !query 2 schema\r\n-struct<a:int,CAST(udf(cast(b as string)) AS INT):int,sum(b):bigint>\r\n+struct<a:int,b:int,sum(b):bigint>\r\n -- !query 2 output\r\n 1\t1\t1\r\n 1\t2\t2\r\n@@ -52,9 +52,9 @@ NULL\tNULL\t9\r\n \r\n \r\n -- !query 3\r\n-SELECT udf(a + b), b, SUM(a - b) FROM testData GROUP BY a + b, b WITH ROLLUP\r\n+SELECT a + b, b, SUM(a - b) FROM testData GROUP BY a + b, b WITH ROLLUP\r\n -- !query 3 schema\r\n-struct<CAST(udf(cast((a + b) as string)) AS INT):int,b:int,sum((a - b)):bigint>\r\n+struct<(a + b):int,b:int,sum((a - b)):bigint>\r\n -- !query 3 output\r\n 2\t1\t0\r\n 2\tNULL\t0\r\n@@ -70,9 +70,9 @@ NULL\tNULL\t3\r\n \r\n \r\n -- !query 4\r\n-SELECT a, b, udf(SUM(b)) FROM testData GROUP BY a, b WITH ROLLUP\r\n+SELECT a, b, SUM(b) FROM testData GROUP BY a, b WITH ROLLUP\r\n -- !query 4 schema\r\n-struct<a:int,b:int,CAST(udf(cast(sum(cast(b as bigint)) as string)) AS BIGINT):bigint>\r\n+struct<a:int,b:int,sum(b):bigint>\r\n -- !query 4 output\r\n 1\t1\t1\r\n 1\t2\t2\r\n@@ -97,7 +97,7 @@ struct<>\r\n \r\n \r\n -- !query 6\r\n-SELECT course, year, SUM(earnings) FROM courseSales GROUP BY ROLLUP(course, year) ORDER BY udf(course), year\r\n+SELECT course, year, SUM(earnings) FROM courseSales GROUP BY ROLLUP(course, year) ORDER BY course, year\r\n -- !query 6 schema\r\n struct<course:string,year:int,sum(earnings):bigint>\r\n -- !query 6 output\r\n@@ -111,7 +111,7 @@ dotNET\t2013\t48000\r\n \r\n \r\n -- !query 7\r\n-SELECT course, year, SUM(earnings) FROM courseSales GROUP BY CUBE(course, year) ORDER BY course, udf(year)\r\n+SELECT course, year, SUM(earnings) FROM courseSales GROUP BY CUBE(course, year) ORDER BY course, year\r\n -- !query 7 schema\r\n struct<course:string,year:int,sum(earnings):bigint>\r\n -- !query 7 output\r\n@@ -127,9 +127,9 @@ dotNET\t2013\t48000\r\n \r\n \r\n -- !query 8\r\n-SELECT course, udf(year), SUM(earnings) FROM courseSales GROUP BY course, year GROUPING SETS(course, year)\r\n+SELECT course, year, SUM(earnings) FROM courseSales GROUP BY course, year GROUPING SETS(course, year)\r\n -- !query 8 schema\r\n-struct<course:string,CAST(udf(cast(year as string)) AS INT):int,sum(earnings):bigint>\r\n+struct<course:string,year:int,sum(earnings):bigint>\r\n -- !query 8 output\r\n Java\tNULL\t50000\r\n NULL\t2012\t35000\r\n@@ -138,26 +138,26 @@ dotNET\tNULL\t63000\r\n \r\n \r\n -- !query 9\r\n-SELECT course, year, udf(SUM(earnings)) FROM courseSales GROUP BY course, year GROUPING SETS(course)\r\n+SELECT course, year, SUM(earnings) FROM courseSales GROUP BY course, year GROUPING SETS(course)\r\n -- !query 9 schema\r\n-struct<course:string,year:int,CAST(udf(cast(sum(cast(earnings as bigint)) as string)) AS BIGINT):bigint>\r\n+struct<course:string,year:int,sum(earnings):bigint>\r\n -- !query 9 output\r\n Java\tNULL\t50000\r\n dotNET\tNULL\t63000\r\n \r\n \r\n -- !query 10\r\n-SELECT udf(course), year, SUM(earnings) FROM courseSales GROUP BY course, year GROUPING SETS(year)\r\n+SELECT course, year, SUM(earnings) FROM courseSales GROUP BY course, year GROUPING SETS(year)\r\n -- !query 10 schema\r\n-struct<CAST(udf(cast(course as string)) AS STRING):string,year:int,sum(earnings):bigint>\r\n+struct<course:string,year:int,sum(earnings):bigint>\r\n -- !query 10 output\r\n NULL\t2012\t35000\r\n NULL\t2013\t78000\r\n \r\n \r\n -- !query 11\r\n-SELECT course, udf(SUM(earnings)) AS sum FROM courseSales\r\n-GROUP BY course, earnings GROUPING SETS((), (course), (course, earnings)) ORDER BY course, udf(sum)\r\n+SELECT course, SUM(earnings) AS sum FROM courseSales\r\n+GROUP BY course, earnings GROUPING SETS((), (course), (course, earnings)) ORDER BY course, sum\r\n -- !query 11 schema\r\n struct<course:string,sum:bigint>\r\n -- !query 11 output\r\n@@ -173,7 +173,7 @@ dotNET\t63000\r\n \r\n -- !query 12\r\n SELECT course, SUM(earnings) AS sum, GROUPING_ID(course, earnings) FROM courseSales\r\n-GROUP BY course, earnings GROUPING SETS((), (course), (course, earnings)) ORDER BY udf(course), sum\r\n+GROUP BY course, earnings GROUPING SETS((), (course), (course, earnings)) ORDER BY course, sum\r\n -- !query 12 schema\r\n struct<course:string,sum:bigint,grouping_id(course, earnings):int>\r\n -- !query 12 output\r\n@@ -188,10 +188,10 @@ dotNET\t63000\t1\r\n \r\n \r\n -- !query 13\r\n-SELECT udf(course), udf(year), GROUPING(course), GROUPING(year), GROUPING_ID(course, year) FROM courseSales\r\n+SELECT course, year, GROUPING(course), GROUPING(year), GROUPING_ID(course, year) FROM courseSales\r\n GROUP BY CUBE(course, year)\r\n -- !query 13 schema\r\n-struct<CAST(udf(cast(course as string)) AS STRING):string,CAST(udf(cast(year as string)) AS INT):int,grouping(course):tinyint,grouping(year):tinyint,grouping_id(course, year):int>\r\n+struct<course:string,year:int,grouping(course):tinyint,grouping(year):tinyint,grouping_id(course, year):int>\r\n -- !query 13 output\r\n Java\t2012\t0\t0\t0\r\n Java\t2013\t0\t0\t0\r\n@@ -205,7 +205,7 @@ dotNET\tNULL\t0\t1\t1\r\n \r\n \r\n -- !query 14\r\n-SELECT course, udf(year), GROUPING(course) FROM courseSales GROUP BY course, year\r\n+SELECT course, year, GROUPING(course) FROM courseSales GROUP BY course, year\r\n -- !query 14 schema\r\n struct<>\r\n -- !query 14 output\r\n@@ -214,7 +214,7 @@ grouping() can only be used with GroupingSets/Cube/Rollup;\r\n \r\n \r\n -- !query 15\r\n-SELECT course, udf(year), GROUPING_ID(course, year) FROM courseSales GROUP BY course, year\r\n+SELECT course, year, GROUPING_ID(course, year) FROM courseSales GROUP BY course, year\r\n -- !query 15 schema\r\n struct<>\r\n -- !query 15 output\r\n@@ -223,7 +223,7 @@ grouping_id() can only be used with GroupingSets/Cube/Rollup;\r\n \r\n \r\n -- !query 16\r\n-SELECT course, year, grouping__id FROM courseSales GROUP BY CUBE(course, year) ORDER BY grouping__id, course, udf(year)\r\n+SELECT course, year, grouping__id FROM courseSales GROUP BY CUBE(course, year) ORDER BY grouping__id, course, year\r\n -- !query 16 schema\r\n struct<course:string,year:int,grouping__id:int>\r\n -- !query 16 output\r\n@@ -240,7 +240,7 @@ NULL\tNULL\t3\r\n \r\n -- !query 17\r\n SELECT course, year FROM courseSales GROUP BY CUBE(course, year)\r\n-HAVING GROUPING(year) = 1 AND GROUPING_ID(course, year) > 0 ORDER BY course, udf(year)\r\n+HAVING GROUPING(year) = 1 AND GROUPING_ID(course, year) > 0 ORDER BY course, year\r\n -- !query 17 schema\r\n struct<course:string,year:int>\r\n -- !query 17 output\r\n@@ -250,7 +250,7 @@ dotNET\tNULL\r\n \r\n \r\n -- !query 18\r\n-SELECT course, udf(year) FROM courseSales GROUP BY course, year HAVING GROUPING(course) > 0\r\n+SELECT course, year FROM courseSales GROUP BY course, year HAVING GROUPING(course) > 0\r\n -- !query 18 schema\r\n struct<>\r\n -- !query 18 output\r\n@@ -259,7 +259,7 @@ grouping()/grouping_id() can only be used with GroupingSets/Cube/Rollup;\r\n \r\n \r\n -- !query 19\r\n-SELECT course, udf(udf(year)) FROM courseSales GROUP BY course, year HAVING GROUPING_ID(course) > 0\r\n+SELECT course, year FROM courseSales GROUP BY course, year HAVING GROUPING_ID(course) > 0\r\n -- !query 19 schema\r\n struct<>\r\n -- !query 19 output\r\n@@ -268,9 +268,9 @@ grouping()/grouping_id() can only be used with GroupingSets/Cube/Rollup;\r\n \r\n \r\n -- !query 20\r\n-SELECT udf(course), year FROM courseSales GROUP BY CUBE(course, year) HAVING grouping__id > 0\r\n+SELECT course, year FROM courseSales GROUP BY CUBE(course, year) HAVING grouping__id > 0\r\n -- !query 20 schema\r\n-struct<CAST(udf(cast(course as string)) AS STRING):string,year:int>\r\n+struct<course:string,year:int>\r\n -- !query 20 output\r\n Java\tNULL\r\n NULL\t2012\r\n@@ -281,7 +281,7 @@ dotNET\tNULL\r\n \r\n -- !query 21\r\n SELECT course, year, GROUPING(course), GROUPING(year) FROM courseSales GROUP BY CUBE(course, year)\r\n-ORDER BY GROUPING(course), GROUPING(year), course, udf(year)\r\n+ORDER BY GROUPING(course), GROUPING(year), course, year\r\n -- !query 21 schema\r\n struct<course:string,year:int,grouping(course):tinyint,grouping(year):tinyint>\r\n -- !query 21 output\r\n@@ -298,7 +298,7 @@ NULL\tNULL\t1\t1\r\n \r\n -- !query 22\r\n SELECT course, year, GROUPING_ID(course, year) FROM courseSales GROUP BY CUBE(course, year)\r\n-ORDER BY GROUPING(course), GROUPING(year), course, udf(year)\r\n+ORDER BY GROUPING(course), GROUPING(year), course, year\r\n -- !query 22 schema\r\n struct<course:string,year:int,grouping_id(course, year):int>\r\n -- !query 22 output\r\n@@ -314,7 +314,7 @@ NULL\tNULL\t3\r\n \r\n \r\n -- !query 23\r\n-SELECT course, udf(year) FROM courseSales GROUP BY course, udf(year) ORDER BY GROUPING(course)\r\n+SELECT course, year FROM courseSales GROUP BY course, year ORDER BY GROUPING(course)\r\n -- !query 23 schema\r\n struct<>\r\n -- !query 23 output\r\n@@ -323,7 +323,7 @@ grouping()/grouping_id() can only be used with GroupingSets/Cube/Rollup;\r\n \r\n \r\n -- !query 24\r\n-SELECT course, udf(year) FROM courseSales GROUP BY course, udf(year) ORDER BY GROUPING_ID(course)\r\n+SELECT course, year FROM courseSales GROUP BY course, year ORDER BY GROUPING_ID(course)\r\n -- !query 24 schema\r\n struct<>\r\n -- !query 24 output\r\n@@ -332,7 +332,7 @@ grouping()/grouping_id() can only be used with GroupingSets/Cube/Rollup;\r\n \r\n \r\n -- !query 25\r\n-SELECT course, year FROM courseSales GROUP BY CUBE(course, year) ORDER BY grouping__id, udf(course), year\r\n+SELECT course, year FROM courseSales GROUP BY CUBE(course, year) ORDER BY grouping__id, course, year\r\n -- !query 25 schema\r\n struct<course:string,year:int>\r\n -- !query 25 output\r\n@@ -348,7 +348,7 @@ NULL\tNULL\r\n \r\n \r\n -- !query 26\r\n-SELECT udf(a + b) AS k1, udf(b) AS k2, SUM(a - b) FROM testData GROUP BY CUBE(k1, k2)\r\n+SELECT a + b AS k1, b AS k2, SUM(a - b) FROM testData GROUP BY CUBE(k1, k2)\r\n -- !query 26 schema\r\n struct<k1:int,k2:int,sum((a - b)):bigint>\r\n -- !query 26 output\r\n@@ -368,7 +368,7 @@ NULL\tNULL\t3\r\n \r\n \r\n -- !query 27\r\n-SELECT udf(udf(a + b)) AS k, b, SUM(a - b) FROM testData GROUP BY ROLLUP(k, b)\r\n+SELECT a + b AS k, b, SUM(a - b) FROM testData GROUP BY ROLLUP(k, b)\r\n -- !query 27 schema\r\n struct<k:int,b:int,sum((a - b)):bigint>\r\n -- !query 27 output\r\n@@ -386,9 +386,9 @@ NULL\tNULL\t3\r\n \r\n \r\n -- !query 28\r\n-SELECT udf(a + b), udf(udf(b)) AS k, SUM(a - b) FROM testData GROUP BY a + b, k GROUPING SETS(k)\r\n+SELECT a + b, b AS k, SUM(a - b) FROM testData GROUP BY a + b, k GROUPING SETS(k)\r\n -- !query 28 schema\r\n-struct<CAST(udf(cast((a + b) as string)) AS INT):int,k:int,sum((a - b)):bigint>\r\n+struct<(a + b):int,k:int,sum((a - b)):bigint>\r\n -- !query 28 output\r\n NULL\t1\t3\r\n NULL\t2\t0\r\n\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in SPARK-27921.\r\nVerified pandas & pyarrow versions:\r\n```$python3\r\nPython 3.6.8 (default, Jan 14 2019, 11:02:34) \r\n[GCC 8.0.1 20180414 (experimental) [trunk revision 259383]] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import pandas\r\n>>> import pyarrow\r\n>>> pyarrow.__version__\r\n'0.14.0'\r\n>>> pandas.__version__\r\n'0.24.2'\r\n```\r\nFrom the sql output it seems that sql statements are evaluated correctly given that udf returns a string and may change results as Null will be returned as None and will be counted in returned values.\r\n","created_at":"2019-07-18T23:15:49Z","updated_at":"2019-07-20T06:24:40Z","closed_at":"2019-07-20T06:24:40Z","merged_at":null,"merge_commit_sha":"4120e0a77a3c53c2b387db5e3adbcaa89cb34f99","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25196/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25196/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25196/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1ee4d36f8cc7918032200e11a87c707e6908f261","head":{"label":"skonto:group-analytics.sql","ref":"group-analytics.sql","sha":"1ee4d36f8cc7918032200e11a87c707e6908f261","user":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":48892104,"node_id":"MDEwOlJlcG9zaXRvcnk0ODg5MjEwNA==","name":"spark","full_name":"skonto/spark","private":false,"owner":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/skonto/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/skonto/spark","forks_url":"https://api.github.com/repos/skonto/spark/forks","keys_url":"https://api.github.com/repos/skonto/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/skonto/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/skonto/spark/teams","hooks_url":"https://api.github.com/repos/skonto/spark/hooks","issue_events_url":"https://api.github.com/repos/skonto/spark/issues/events{/number}","events_url":"https://api.github.com/repos/skonto/spark/events","assignees_url":"https://api.github.com/repos/skonto/spark/assignees{/user}","branches_url":"https://api.github.com/repos/skonto/spark/branches{/branch}","tags_url":"https://api.github.com/repos/skonto/spark/tags","blobs_url":"https://api.github.com/repos/skonto/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/skonto/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/skonto/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/skonto/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/skonto/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/skonto/spark/languages","stargazers_url":"https://api.github.com/repos/skonto/spark/stargazers","contributors_url":"https://api.github.com/repos/skonto/spark/contributors","subscribers_url":"https://api.github.com/repos/skonto/spark/subscribers","subscription_url":"https://api.github.com/repos/skonto/spark/subscription","commits_url":"https://api.github.com/repos/skonto/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/skonto/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/skonto/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/skonto/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/skonto/spark/contents/{+path}","compare_url":"https://api.github.com/repos/skonto/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/skonto/spark/merges","archive_url":"https://api.github.com/repos/skonto/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/skonto/spark/downloads","issues_url":"https://api.github.com/repos/skonto/spark/issues{/number}","pulls_url":"https://api.github.com/repos/skonto/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/skonto/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/skonto/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/skonto/spark/labels{/name}","releases_url":"https://api.github.com/repos/skonto/spark/releases{/id}","deployments_url":"https://api.github.com/repos/skonto/spark/deployments","created_at":"2016-01-01T23:02:52Z","updated_at":"2023-10-13T14:17:45Z","pushed_at":"2023-10-13T14:15:23Z","git_url":"git://github.com/skonto/spark.git","ssh_url":"git@github.com:skonto/spark.git","clone_url":"https://github.com/skonto/spark.git","svn_url":"https://github.com/skonto/spark","homepage":null,"size":395104,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"453cbf3dd8df5ec4da844c93eb6000610b551541","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25196"},"html":{"href":"https://github.com/apache/spark/pull/25196"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25196"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25196/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25196/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25196/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1ee4d36f8cc7918032200e11a87c707e6908f261"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25195","id":298938644,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4OTM4NjQ0","html_url":"https://github.com/apache/spark/pull/25195","diff_url":"https://github.com/apache/spark/pull/25195.diff","patch_url":"https://github.com/apache/spark/pull/25195.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25195","number":25195,"state":"closed","locked":false,"title":"[SPARK-28288][SQL][PYTHON][TESTS] Convert and port 'window.sql' into UDF test base","user":{"login":"younggyuchun","id":1910477,"node_id":"MDQ6VXNlcjE5MTA0Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/1910477?v=4","gravatar_id":"","url":"https://api.github.com/users/younggyuchun","html_url":"https://github.com/younggyuchun","followers_url":"https://api.github.com/users/younggyuchun/followers","following_url":"https://api.github.com/users/younggyuchun/following{/other_user}","gists_url":"https://api.github.com/users/younggyuchun/gists{/gist_id}","starred_url":"https://api.github.com/users/younggyuchun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/younggyuchun/subscriptions","organizations_url":"https://api.github.com/users/younggyuchun/orgs","repos_url":"https://api.github.com/users/younggyuchun/repos","events_url":"https://api.github.com/users/younggyuchun/events{/privacy}","received_events_url":"https://api.github.com/users/younggyuchun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nThis PR adds some tests converted from window.sql to test UDFs. Please see the contribution guide of this umbrella ticket - [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n\r\n<details><summary>Diff comparing to 'xxx.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/window.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-window.sql.out\r\nindex 367dc4f513..9354d5e311 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/window.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-window.sql.out\r\n@@ -21,10 +21,10 @@ struct<>\r\n\r\n\r\n -- !query 1\r\n-SELECT val, cate, count(val) OVER(PARTITION BY cate ORDER BY val ROWS CURRENT ROW) FROM testData\r\n-ORDER BY cate, val\r\n+SELECT udf(val), cate, count(val) OVER(PARTITION BY cate ORDER BY udf(val) ROWS CURRENT ROW) FROM testData\r\n+ORDER BY cate, udf(val)\r\n -- !query 1 schema\r\n-struct<val:int,cate:string,count(val) OVER (PARTITION BY cate ORDER BY val ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND CURRENT ROW):bigint>\r\n+struct<CAST(udf(cast(val as string)) AS INT):int,cate:string,count(val) OVER (PARTITION BY cate ORDER BY CAST(udf(cast(val as string)) AS INT) ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND CURRENT ROW):bigint>\r\n -- !query 1 output\r\n NULL   NULL    0\r\n 3      NULL    1\r\n@@ -38,10 +38,10 @@ NULL        a       0\r\n\r\n\r\n -- !query 2\r\n-SELECT val, cate, sum(val) OVER(PARTITION BY cate ORDER BY val\r\n-ROWS BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) FROM testData ORDER BY cate, val\r\n+SELECT udf(val), cate, sum(val) OVER(PARTITION BY cate ORDER BY udf(val)\r\n+ROWS BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) FROM testData ORDER BY cate, udf(val)\r\n -- !query 2 schema\r\n-struct<val:int,cate:string,sum(val) OVER (PARTITION BY cate ORDER BY val ASC NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING):bigint>\r\n+struct<CAST(udf(cast(val as string)) AS INT):int,cate:string,sum(val) OVER (PARTITION BY cate ORDER BY CAST(udf(cast(val as string)) AS INT) ASC NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING):bigint>\r\n -- !query 2 output\r\n NULL   NULL    3\r\n 3      NULL    3\r\n@@ -55,20 +55,20 @@ NULL        a       1\r\n\r\n\r\n -- !query 3\r\n-SELECT val_long, cate, sum(val_long) OVER(PARTITION BY cate ORDER BY val_long\r\n-ROWS BETWEEN CURRENT ROW AND 2147483648 FOLLOWING) FROM testData ORDER BY cate, val_long\r\n+SELECT val_long, udf(cate), sum(val_long) OVER(PARTITION BY cate ORDER BY udf(val_long)\r\n+ROWS BETWEEN CURRENT ROW AND 2147483648 FOLLOWING) FROM testData ORDER BY udf(cate), val_long\r\n -- !query 3 schema\r\n struct<>\r\n -- !query 3 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve 'ROWS BETWEEN CURRENT ROW AND 2147483648L FOLLOWING' due to data type mismatch: The data type of the upper bound 'bigint' does not match the expected data type 'int'.; line 1 pos 41\r\n+cannot resolve 'ROWS BETWEEN CURRENT ROW AND 2147483648L FOLLOWING' due to data type mismatch: The data type of the upper bound 'bigint' does not match the expected data type 'int'.; line 1 pos 46\r\n\r\n\r\n -- !query 4\r\n-SELECT val, cate, count(val) OVER(PARTITION BY cate ORDER BY val RANGE 1 PRECEDING) FROM testData\r\n-ORDER BY cate, val\r\n+SELECT udf(val), cate, count(val) OVER(PARTITION BY udf(cate) ORDER BY val RANGE 1 PRECEDING) FROM testData\r\n+ORDER BY cate, udf(val)\r\n -- !query 4 schema\r\n-struct<val:int,cate:string,count(val) OVER (PARTITION BY cate ORDER BY val ASC NULLS FIRST RANGE BETWEEN 1 PRECEDING AND CURRENT ROW):bigint>\r\n+struct<CAST(udf(cast(val as string)) AS INT):int,cate:string,count(val) OVER (PARTITION BY CAST(udf(cast(cate as string)) AS STRING) ORDER BY val ASC NULLS FIRST RANGE BETWEEN 1 PRECEDING AND CURRENT ROW):bigint>\r\n -- !query 4 output\r\n NULL   NULL    0\r\n 3      NULL    1\r\n@@ -82,10 +82,10 @@ NULL        a       0\r\n\r\n\r\n -- !query 5\r\n-SELECT val, cate, sum(val) OVER(PARTITION BY cate ORDER BY val\r\n-RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING) FROM testData ORDER BY cate, val\r\n+SELECT val, udf(cate), sum(val) OVER(PARTITION BY udf(cate) ORDER BY val\r\n+RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING) FROM testData ORDER BY udf(cate), val\r\n -- !query 5 schema\r\n-struct<val:int,cate:string,sum(val) OVER (PARTITION BY cate ORDER BY val ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING):bigint>\r\n+struct<val:int,CAST(udf(cast(cate as string)) AS STRING):string,sum(val) OVER (PARTITION BY CAST(udf(cast(cate as string)) AS STRING) ORDER BY val ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING):bigint>\r\n -- !query 5 output\r\n NULL   NULL    NULL\r\n 3      NULL    3\r\n@@ -99,10 +99,10 @@ NULL        a       NULL\r\n\r\n\r\n -- !query 6\r\n-SELECT val_long, cate, sum(val_long) OVER(PARTITION BY cate ORDER BY val_long\r\n-RANGE BETWEEN CURRENT ROW AND 2147483648 FOLLOWING) FROM testData ORDER BY cate, val_long\r\n+SELECT val_long, udf(cate), sum(val_long) OVER(PARTITION BY udf(cate) ORDER BY val_long\r\n+RANGE BETWEEN CURRENT ROW AND 2147483648 FOLLOWING) FROM testData ORDER BY udf(cate), val_long\r\n -- !query 6 schema\r\n-struct<val_long:bigint,cate:string,sum(val_long) OVER (PARTITION BY cate ORDER BY val_long ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND 2147483648 FOLLOWING):bigint>\r\n+struct<val_long:bigint,CAST(udf(cast(cate as string)) AS STRING):string,sum(val_long) OVER (PARTITION BY CAST(udf(cast(cate as string)) AS STRING) ORDER BY val_long ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND 2147483648 FOLLOWING):bigint>\r\n -- !query 6 output\r\n NULL   NULL    NULL\r\n 1      NULL    1\r\n@@ -116,10 +116,10 @@ NULL      b       NULL\r\n\r\n\r\n -- !query 7\r\n-SELECT val_double, cate, sum(val_double) OVER(PARTITION BY cate ORDER BY val_double\r\n-RANGE BETWEEN CURRENT ROW AND 2.5 FOLLOWING) FROM testData ORDER BY cate, val_double\r\n+SELECT val_double, udf(cate), sum(val_double) OVER(PARTITION BY udf(cate) ORDER BY val_double\r\n+RANGE BETWEEN CURRENT ROW AND 2.5 FOLLOWING) FROM testData ORDER BY udf(cate), val_double\r\n -- !query 7 schema\r\n-struct<val_double:double,cate:string,sum(val_double) OVER (PARTITION BY cate ORDER BY val_double ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND CAST(2.5 AS DOUBLE) FOLLOWING):double>\r\n+struct<val_double:double,CAST(udf(cast(cate as string)) AS STRING):string,sum(val_double) OVER (PARTITION BY CAST(udf(cast(cate as string)) AS STRING) ORDER BY val_double ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND CAST(2.5 AS DOUBLE) FOLLOWING):double>\r\n -- !query 7 output\r\n NULL   NULL    NULL\r\n 1.0    NULL    1.0\r\n@@ -133,10 +133,10 @@ NULL      NULL    NULL\r\n\r\n\r\n -- !query 8\r\n-SELECT val_date, cate, max(val_date) OVER(PARTITION BY cate ORDER BY val_date\r\n-RANGE BETWEEN CURRENT ROW AND 2 FOLLOWING) FROM testData ORDER BY cate, val_date\r\n+SELECT val_date, udf(cate), max(val_date) OVER(PARTITION BY udf(cate) ORDER BY val_date\r\n+RANGE BETWEEN CURRENT ROW AND 2 FOLLOWING) FROM testData ORDER BY udf(cate), val_date\r\n -- !query 8 schema\r\n-struct<val_date:date,cate:string,max(val_date) OVER (PARTITION BY cate ORDER BY val_date ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND 2 FOLLOWING):date>\r\n+struct<val_date:date,CAST(udf(cast(cate as string)) AS STRING):string,max(val_date) OVER (PARTITION BY CAST(udf(cast(cate as string)) AS STRING) ORDER BY val_date ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND 2 FOLLOWING):date>\r\n -- !query 8 output\r\n NULL   NULL    NULL\r\n 2017-08-01     NULL    2017-08-01\r\n@@ -150,11 +150,11 @@ NULL      NULL    NULL\r\n\r\n\r\n -- !query 9\r\n-SELECT val_timestamp, cate, avg(val_timestamp) OVER(PARTITION BY cate ORDER BY val_timestamp\r\n+SELECT val_timestamp, udf(cate), avg(val_timestamp) OVER(PARTITION BY udf(cate) ORDER BY val_timestamp\r\n RANGE BETWEEN CURRENT ROW AND interval 23 days 4 hours FOLLOWING) FROM testData\r\n-ORDER BY cate, val_timestamp\r\n+ORDER BY udf(cate), val_timestamp\r\n -- !query 9 schema\r\n-struct<val_timestamp:timestamp,cate:string,avg(CAST(val_timestamp AS DOUBLE)) OVER (PARTITION BY cate ORDER BY val_timestamp ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND interval 3 weeks 2 days 4 hours FOLLOWING):double>\r\n+struct<val_timestamp:timestamp,CAST(udf(cast(cate as string)) AS STRING):string,avg(CAST(val_timestamp AS DOUBLE)) OVER (PARTITION BY CAST(udf(cast(cate as string)) AS STRING) ORDER BY val_timestamp ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND interval 3 weeks 2 days 4 hours FOLLOWING):double>\r\n -- !query 9 output\r\n NULL   NULL    NULL\r\n 2017-07-31 17:00:00    NULL    1.5015456E9\r\n@@ -168,10 +168,10 @@ NULL      NULL    NULL\r\n\r\n\r\n -- !query 10\r\n-SELECT val, cate, sum(val) OVER(PARTITION BY cate ORDER BY val DESC\r\n+SELECT val, udf(cate), sum(val) OVER(PARTITION BY cate ORDER BY val DESC\r\n RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING) FROM testData ORDER BY cate, val\r\n -- !query 10 schema\r\n-struct<val:int,cate:string,sum(val) OVER (PARTITION BY cate ORDER BY val DESC NULLS LAST RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING):bigint>\r\n+struct<val:int,CAST(udf(cast(cate as string)) AS STRING):string,sum(val) OVER (PARTITION BY cate ORDER BY val DESC NULLS LAST RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING):bigint>\r\n -- !query 10 output\r\n NULL   NULL    NULL\r\n 3      NULL    3\r\n@@ -185,58 +185,58 @@ NULL      a       NULL\r\n\r\n\r\n -- !query 11\r\n-SELECT val, cate, count(val) OVER(PARTITION BY cate\r\n-ROWS BETWEEN UNBOUNDED FOLLOWING AND 1 FOLLOWING) FROM testData ORDER BY cate, val\r\n+SELECT udf(val), cate, count(val) OVER(PARTITION BY udf(cate)\r\n+ROWS BETWEEN UNBOUNDED FOLLOWING AND 1 FOLLOWING) FROM testData ORDER BY cate, udf(val)\r\n -- !query 11 schema\r\n struct<>\r\n -- !query 11 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve 'ROWS BETWEEN UNBOUNDED FOLLOWING AND 1 FOLLOWING' due to data type mismatch: Window frame upper bound '1' does not follow the lower bound 'unboundedfollowing$()'.; line 1 pos 33\r\n+cannot resolve 'ROWS BETWEEN UNBOUNDED FOLLOWING AND 1 FOLLOWING' due to data type mismatch: Window frame upper bound '1' does not follow the lower bound 'unboundedfollowing$()'.; line 1 pos 38\r\n\r\n\r\n -- !query 12\r\n-SELECT val, cate, count(val) OVER(PARTITION BY cate\r\n-RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING) FROM testData ORDER BY cate, val\r\n+SELECT udf(val), cate, count(val) OVER(PARTITION BY udf(cate)\r\n+RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING) FROM testData ORDER BY cate, udf(val)\r\n -- !query 12 schema\r\n struct<>\r\n -- !query 12 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve '(PARTITION BY testdata.`cate` RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING)' due to data type mismatch: A range window frame cannot be used in an unordered window specification.; line 1 pos 33\r\n+cannot resolve '(PARTITION BY CAST(udf(cast(cate as string)) AS STRING) RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING)' due to data type mismatch: A range window frame cannot be used in an unordered window specification.; line 1 pos 38\r\n\r\n\r\n -- !query 13\r\n-SELECT val, cate, count(val) OVER(PARTITION BY cate ORDER BY val, cate\r\n-RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING) FROM testData ORDER BY cate, val\r\n+SELECT udf(val), cate, count(val) OVER(PARTITION BY udf(cate) ORDER BY udf(val), cate\r\n+RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING) FROM testData ORDER BY cate, udf(val)\r\n -- !query 13 schema\r\n struct<>\r\n -- !query 13 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve '(PARTITION BY testdata.`cate` ORDER BY testdata.`val` ASC NULLS FIRST, testdata.`cate` ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING)' due to data type mismatch: A range window frame with value boundaries cannot be used in a window specification with multiple order by expressions: val#x ASC NULLS FIRST,cate#x ASC NULLS FIRST; line 1 pos 33\r\n+cannot resolve '(PARTITION BY CAST(udf(cast(cate as string)) AS STRING) ORDER BY CAST(udf(cast(val as string)) AS INT) ASC NULLS FIRST, testdata.`cate` ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING)' due to data type mismatch: A range window frame with value boundaries cannot be used in a window specification with multiple order by expressions: cast(udf(cast(val#x as string)) as int) ASC NULLS FIRST,cate#x ASC NULLS FIRST; line 1 pos 38\r\n\r\n\r\n -- !query 14\r\n-SELECT val, cate, count(val) OVER(PARTITION BY cate ORDER BY current_timestamp\r\n-RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING) FROM testData ORDER BY cate, val\r\n+SELECT udf(val), cate, count(val) OVER(PARTITION BY udf(cate) ORDER BY current_timestamp\r\n+RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING) FROM testData ORDER BY cate, udf(val)\r\n -- !query 14 schema\r\n struct<>\r\n -- !query 14 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve '(PARTITION BY testdata.`cate` ORDER BY current_timestamp() ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING)' due to data type mismatch: The data type 'timestamp' used in the order specification does not match the data type 'int' which is used in the range frame.; line 1 pos 33\r\n+cannot resolve '(PARTITION BY CAST(udf(cast(cate as string)) AS STRING) ORDER BY current_timestamp() ASC NULLS FIRST RANGE BETWEEN CURRENT ROW AND 1 FOLLOWING)' due to data type mismatch: The data type 'timestamp' used in the order specification does not match the data type 'int' which is used in the range frame.; line 1 pos 38\r\n\r\n\r\n -- !query 15\r\n-SELECT val, cate, count(val) OVER(PARTITION BY cate ORDER BY val\r\n-RANGE BETWEEN 1 FOLLOWING AND 1 PRECEDING) FROM testData ORDER BY cate, val\r\n+SELECT udf(val), cate, count(val) OVER(PARTITION BY udf(cate) ORDER BY val\r\n+RANGE BETWEEN 1 FOLLOWING AND 1 PRECEDING) FROM testData ORDER BY udf(cate), val\r\n -- !query 15 schema\r\n struct<>\r\n -- !query 15 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve 'RANGE BETWEEN 1 FOLLOWING AND 1 PRECEDING' due to data type mismatch: The lower bound of a window frame must be less than or equal to the upper bound; line 1 pos 33\r\n+cannot resolve 'RANGE BETWEEN 1 FOLLOWING AND 1 PRECEDING' due to data type mismatch: The lower bound of a window frame must be less than or equal to the upper bound; line 1 pos 38\r\n\r\n\r\n -- !query 16\r\n-SELECT val, cate, count(val) OVER(PARTITION BY cate ORDER BY val\r\n-RANGE BETWEEN CURRENT ROW AND current_date PRECEDING) FROM testData ORDER BY cate, val\r\n+SELECT udf(val), cate, count(val) OVER(PARTITION BY udf(cate) ORDER BY udf(val)\r\n+RANGE BETWEEN CURRENT ROW AND current_date PRECEDING) FROM testData ORDER BY cate, val(val)\r\n -- !query 16 schema\r\n struct<>\r\n -- !query 16 output\r\n@@ -245,48 +245,48 @@ org.apache.spark.sql.catalyst.parser.ParseException\r\n Frame bound value must be a literal.(line 2, pos 30)\r\n\r\n == SQL ==\r\n-SELECT val, cate, count(val) OVER(PARTITION BY cate ORDER BY val\r\n-RANGE BETWEEN CURRENT ROW AND current_date PRECEDING) FROM testData ORDER BY cate, val\r\n+SELECT udf(val), cate, count(val) OVER(PARTITION BY udf(cate) ORDER BY udf(val)\r\n+RANGE BETWEEN CURRENT ROW AND current_date PRECEDING) FROM testData ORDER BY cate, val(val)\r\n ------------------------------^^^\r\n\r\n\r\n -- !query 17\r\n-SELECT val, cate,\r\n-max(val) OVER w AS max,\r\n-min(val) OVER w AS min,\r\n-min(val) OVER w AS min,\r\n-count(val) OVER w AS count,\r\n-sum(val) OVER w AS sum,\r\n-avg(val) OVER w AS avg,\r\n-stddev(val) OVER w AS stddev,\r\n-first_value(val) OVER w AS first_value,\r\n-first_value(val, true) OVER w AS first_value_ignore_null,\r\n-first_value(val, false) OVER w AS first_value_contain_null,\r\n-last_value(val) OVER w AS last_value,\r\n-last_value(val, true) OVER w AS last_value_ignore_null,\r\n-last_value(val, false) OVER w AS last_value_contain_null,\r\n+SELECT udf(val), cate,\r\n+max(udf(val)) OVER w AS max,\r\n+min(udf(val)) OVER w AS min,\r\n+min(udf(val)) OVER w AS min,\r\n+count(udf(val)) OVER w AS count,\r\n+sum(udf(val)) OVER w AS sum,\r\n+avg(udf(val)) OVER w AS avg,\r\n+stddev(udf(val)) OVER w AS stddev,\r\n+first_value(udf(val)) OVER w AS first_value,\r\n+first_value(udf(val), true) OVER w AS first_value_ignore_null,\r\n+first_value(udf(val), false) OVER w AS first_value_contain_null,\r\n+last_value(udf(val)) OVER w AS last_value,\r\n+last_value(udf(val), true) OVER w AS last_value_ignore_null,\r\n+last_value(udf(val), false) OVER w AS last_value_contain_null,\r\n rank() OVER w AS rank,\r\n dense_rank() OVER w AS dense_rank,\r\n cume_dist() OVER w AS cume_dist,\r\n percent_rank() OVER w AS percent_rank,\r\n ntile(2) OVER w AS ntile,\r\n row_number() OVER w AS row_number,\r\n-var_pop(val) OVER w AS var_pop,\r\n-var_samp(val) OVER w AS var_samp,\r\n-approx_count_distinct(val) OVER w AS approx_count_distinct,\r\n-covar_pop(val, val_long) OVER w AS covar_pop,\r\n-corr(val, val_long) OVER w AS corr,\r\n-stddev_samp(val) OVER w AS stddev_samp,\r\n-stddev_pop(val) OVER w AS stddev_pop,\r\n-collect_list(val) OVER w AS collect_list,\r\n-collect_set(val) OVER w AS collect_set,\r\n-skewness(val_double) OVER w AS skewness,\r\n-kurtosis(val_double) OVER w AS kurtosis\r\n+var_pop(udf(val)) OVER w AS var_pop,\r\n+var_samp(udf(val)) OVER w AS var_samp,\r\n+approx_count_distinct(udf(val)) OVER w AS approx_count_distinct,\r\n+covar_pop(udf(val), udf(val_long)) OVER w AS covar_pop,\r\n+corr(udf(val), udf(val_long)) OVER w AS corr,\r\n+stddev_samp(udf(val)) OVER w AS stddev_samp,\r\n+stddev_pop(udf(val)) OVER w AS stddev_pop,\r\n+collect_list(udf(val)) OVER w AS collect_list,\r\n+collect_set(udf(val)) OVER w AS collect_set,\r\n+skewness(udf(val_double)) OVER w AS skewness,\r\n+kurtosis(udf(val_double)) OVER w AS kurtosis\r\n FROM testData\r\n-WINDOW w AS (PARTITION BY cate ORDER BY val)\r\n-ORDER BY cate, val\r\n+WINDOW w AS (PARTITION BY udf(cate) ORDER BY udf(val))\r\n+ORDER BY cate, udf(val)\r\n -- !query 17 schema\r\n-struct<val:int,cate:string,max:int,min:int,min:int,count:bigint,sum:bigint,avg:double,stddev:double,first_value:int,first_value_ignore_null:int,first_value_contain_null:int,last_value:int,last_value_ignore_null:int,last_value_contain_null:int,rank:int,dense_rank:int,cume_dist:double,percent_rank:double,ntile:int,row_number:int,var_pop:double,var_samp:double,approx_count_distinct:bigint,covar_pop:double,corr:double,stddev_samp:double,stddev_pop:double,collect_list:array<int>,collect_set:array<int>,skewness:double,kurtosis:double>\r\n+struct<CAST(udf(cast(val as string)) AS INT):int,cate:string,max:int,min:int,min:int,count:bigint,sum:bigint,avg:double,stddev:double,first_value:int,first_value_ignore_null:int,first_value_contain_null:int,last_value:int,last_value_ignore_null:int,last_value_contain_null:int,rank:int,dense_rank:int,cume_dist:double,percent_rank:double,ntile:int,row_number:int,var_pop:double,var_samp:double,approx_count_distinct:bigint,covar_pop:double,corr:double,stddev_samp:double,stddev_pop:double,collect_list:array<int>,collect_set:array<int>,skewness:double,kurtosis:double>\r\n -- !query 17 output\r\n NULL   NULL    NULL    NULL    NULL    0       NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    1       1       0.5     0.0     1       1       NULL    NULL    0       NULL    NULL\r\n    NULL    NULL    []      []      NULL    NULL\r\n 3      NULL    3       3       3       1       3       3.0     NaN     NULL    3       NULL    3       3       3       2       2       1.0     1.0     2       2       0.0     NaN     1       0.0     NaN\r\n     NaN     0.0     [3]     [3]     NaN     NaN\r\n@@ -300,9 +300,9 @@ NULL        a       NULL    NULL    NULL    0       NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    1       1       0.25    0.\r\n\r\n\r\n -- !query 18\r\n-SELECT val, cate, avg(null) OVER(PARTITION BY cate ORDER BY val) FROM testData ORDER BY cate, val\r\n+SELECT udf(val), cate, avg(null) OVER(PARTITION BY cate ORDER BY val) FROM testData ORDER BY cate, val\r\n -- !query 18 schema\r\n-struct<val:int,cate:string,avg(CAST(NULL AS DOUBLE)) OVER (PARTITION BY cate ORDER BY val ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW):double>\r\n+struct<CAST(udf(cast(val as string)) AS INT):int,cate:string,avg(CAST(NULL AS DOUBLE)) OVER (PARTITION BY cate ORDER BY val ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW):double>\r\n -- !query 18 output\r\n NULL   NULL    NULL\r\n 3      NULL    NULL\r\n@@ -316,7 +316,7 @@ NULL        a       NULL\r\n\r\n\r\n -- !query 19\r\n-SELECT val, cate, row_number() OVER(PARTITION BY cate) FROM testData ORDER BY cate, val\r\n+SELECT udf(val), cate, row_number() OVER(PARTITION BY cate) FROM testData ORDER BY cate, udf(val)\r\n -- !query 19 schema\r\n struct<>\r\n -- !query 19 output\r\n@@ -325,9 +325,9 @@ Window function row_number() requires window to be ordered, please add ORDER BY\r\n\r\n\r\n -- !query 20\r\n-SELECT val, cate, sum(val) OVER(), avg(val) OVER() FROM testData ORDER BY cate, val\r\n+SELECT udf(val), cate, sum(val) OVER(), avg(val) OVER() FROM testData ORDER BY cate, val\r\n -- !query 20 schema\r\n-struct<val:int,cate:string,sum(CAST(val AS BIGINT)) OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING):bigint,avg(CAST(val AS BIGINT)) OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING):double>\r\n+struct<CAST(udf(cast(val as string)) AS INT):int,cate:string,sum(CAST(val AS BIGINT)) OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING):bigint,avg(CAST(val AS BIGINT)) OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING):double>\r\n -- !query 20 output\r\n NULL   NULL    13      1.8571428571428572\r\n 3      NULL    13      1.8571428571428572\r\n@@ -341,7 +341,7 @@ NULL        a       13      1.8571428571428572\r\n\r\n\r\n -- !query 21\r\n-SELECT val, cate,\r\n+SELECT udf(val), cate,\r\n first_value(false) OVER w AS first_value,\r\n first_value(true, true) OVER w AS first_value_ignore_null,\r\n first_value(false, false) OVER w AS first_value_contain_null,\r\n@@ -352,7 +352,7 @@ FROM testData\r\n WINDOW w AS ()\r\n ORDER BY cate, val\r\n -- !query 21 schema\r\n-struct<val:int,cate:string,first_value:boolean,first_value_ignore_null:boolean,first_value_contain_null:boolean,last_value:boolean,last_value_ignore_null:boolean,last_value_contain_null:boolean>\r\n+struct<CAST(udf(cast(val as string)) AS INT):int,cate:string,first_value:boolean,first_value_ignore_null:boolean,first_value_contain_null:boolean,last_value:boolean,last_value_ignore_null:boolean,last_value_contain_null:boolean>\r\n -- !query 21 output\r\n NULL   NULL    false   true    false   false   true    false\r\n 3      NULL    false   true    false   false   true    false\r\n@@ -366,12 +366,12 @@ NULL      a       false   true    false   false   true    false\r\n\r\n\r\n -- !query 22\r\n-SELECT cate, sum(val) OVER (w)\r\n+SELECT udf(cate), sum(val) OVER (w)\r\n FROM testData\r\n WHERE val is not null\r\n WINDOW w AS (PARTITION BY cate ORDER BY val)\r\n -- !query 22 schema\r\n-struct<cate:string,sum(CAST(val AS BIGINT)) OVER (PARTITION BY cate ORDER BY val ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW):bigint>\r\n+struct<CAST(udf(cast(cate as string)) AS STRING):string,sum(CAST(val AS BIGINT)) OVER (PARTITION BY cate ORDER BY val ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW):bigint>\r\n -- !query 22 output\r\n NULL   3\r\n a      2\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).","created_at":"2019-07-18T14:24:22Z","updated_at":"2019-07-25T13:53:34Z","closed_at":"2019-07-25T13:37:16Z","merged_at":null,"merge_commit_sha":"10ba07c935665755bf99786738b39df395f007ac","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25195/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25195/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25195/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e6ce51a7a8039b14326605adb4b3c57fad9557ef","head":{"label":"younggyuchun:master","ref":"master","sha":"e6ce51a7a8039b14326605adb4b3c57fad9557ef","user":{"login":"younggyuchun","id":1910477,"node_id":"MDQ6VXNlcjE5MTA0Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/1910477?v=4","gravatar_id":"","url":"https://api.github.com/users/younggyuchun","html_url":"https://github.com/younggyuchun","followers_url":"https://api.github.com/users/younggyuchun/followers","following_url":"https://api.github.com/users/younggyuchun/following{/other_user}","gists_url":"https://api.github.com/users/younggyuchun/gists{/gist_id}","starred_url":"https://api.github.com/users/younggyuchun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/younggyuchun/subscriptions","organizations_url":"https://api.github.com/users/younggyuchun/orgs","repos_url":"https://api.github.com/users/younggyuchun/repos","events_url":"https://api.github.com/users/younggyuchun/events{/privacy}","received_events_url":"https://api.github.com/users/younggyuchun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"045191e6102258dd7217f5796d9544e6659d2155","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25195"},"html":{"href":"https://github.com/apache/spark/pull/25195"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25195"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25195/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25195/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25195/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e6ce51a7a8039b14326605adb4b3c57fad9557ef"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25194","id":298883230,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4ODgzMjMw","html_url":"https://github.com/apache/spark/pull/25194","diff_url":"https://github.com/apache/spark/pull/25194.diff","patch_url":"https://github.com/apache/spark/pull/25194.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25194","number":25194,"state":"closed","locked":false,"title":"[SPARK-28287][SQL][PYTHON][TESTS] Convert and port 'udaf.sql' into UDF test base","user":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from 'udaf.sql' to test UDFs\r\n\r\n\r\n<details><summary>Diff comparing to 'udaf.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/udaf.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-udaf.sql.out\r\nindex f4455bb717..e1747f4667 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/udaf.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-udaf.sql.out\r\n@@ -3,6 +3,8 @@\r\n\r\n\r\n -- !query 0\r\n+-- This test file was converted from udaf.sql.\r\n+\r\n CREATE OR REPLACE TEMPORARY VIEW t1 AS SELECT * FROM VALUES\r\n (1), (2), (3), (4)\r\n as t1(int_col1)\r\n@@ -21,15 +23,15 @@ struct<>\r\n\r\n\r\n -- !query 2\r\n-SELECT default.myDoubleAvg(int_col1) as my_avg from t1\r\n+SELECT default.myDoubleAvg(udf(int_col1)) as my_avg, udf(default.myDoubleAvg(udf(int_col1))) as my_avg2, udf(default.myDoubleAvg(int_col1)) as my_avg3 from t1\r\n -- !query 2 schema\r\n-struct<my_avg:double>\r\n+struct<my_avg:double,my_avg2:double,my_avg3:double>\r\n -- !query 2 output\r\n-102.5\r\n+102.5  102.5   102.5\r\n\r\n\r\n -- !query 3\r\n-SELECT default.myDoubleAvg(int_col1, 3) as my_avg from t1\r\n+SELECT default.myDoubleAvg(udf(int_col1), udf(3)) as my_avg from t1\r\n -- !query 3 schema\r\n struct<>\r\n -- !query 3 output\r\n@@ -46,12 +48,12 @@ struct<>\r\n\r\n\r\n -- !query 5\r\n-SELECT default.udaf1(int_col1) as udaf1 from t1\r\n+SELECT default.udaf1(udf(int_col1)) as udaf1, udf(default.udaf1(udf(int_col1))) as udaf2, udf(default.udaf1(int_col1)) as udaf3 from t1\r\n -- !query 5 schema\r\n struct<>\r\n -- !query 5 output\r\n org.apache.spark.sql.AnalysisException\r\n-Can not load class 'test.non.existent.udaf' when registering the function 'default.udaf1', please make sure it is on the classpath; line 1 pos 7\r\n+Can not load class 'test.non.existent.udaf' when registering the function 'default.udaf1', please make sure it is on the classpath; line 1 pos 94\r\n\r\n\r\n -- !query 6\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in SPARK-27921.","created_at":"2019-07-18T12:07:03Z","updated_at":"2021-05-25T07:58:21Z","closed_at":"2019-07-19T01:52:42Z","merged_at":null,"merge_commit_sha":"050b1a0fbcd0477695bbfbd54ce47cd5d1354705","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25194/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25194/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25194/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d8bec8032fbfd92453f4c38cbabde427897a3cde","head":{"label":"vinodkc:br_Fix_SPARK-27921_3","ref":"br_Fix_SPARK-27921_3","sha":"d8bec8032fbfd92453f4c38cbabde427897a3cde","user":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":86780265,"node_id":"MDEwOlJlcG9zaXRvcnk4Njc4MDI2NQ==","name":"spark","full_name":"vinodkc/spark","private":false,"owner":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vinodkc/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/vinodkc/spark","forks_url":"https://api.github.com/repos/vinodkc/spark/forks","keys_url":"https://api.github.com/repos/vinodkc/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vinodkc/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vinodkc/spark/teams","hooks_url":"https://api.github.com/repos/vinodkc/spark/hooks","issue_events_url":"https://api.github.com/repos/vinodkc/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vinodkc/spark/events","assignees_url":"https://api.github.com/repos/vinodkc/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vinodkc/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vinodkc/spark/tags","blobs_url":"https://api.github.com/repos/vinodkc/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vinodkc/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vinodkc/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vinodkc/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vinodkc/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vinodkc/spark/languages","stargazers_url":"https://api.github.com/repos/vinodkc/spark/stargazers","contributors_url":"https://api.github.com/repos/vinodkc/spark/contributors","subscribers_url":"https://api.github.com/repos/vinodkc/spark/subscribers","subscription_url":"https://api.github.com/repos/vinodkc/spark/subscription","commits_url":"https://api.github.com/repos/vinodkc/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vinodkc/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vinodkc/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vinodkc/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vinodkc/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vinodkc/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vinodkc/spark/merges","archive_url":"https://api.github.com/repos/vinodkc/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vinodkc/spark/downloads","issues_url":"https://api.github.com/repos/vinodkc/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vinodkc/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vinodkc/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vinodkc/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vinodkc/spark/labels{/name}","releases_url":"https://api.github.com/repos/vinodkc/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vinodkc/spark/deployments","created_at":"2017-03-31T05:10:58Z","updated_at":"2025-01-24T19:30:18Z","pushed_at":"2025-01-24T19:26:51Z","git_url":"git://github.com/vinodkc/spark.git","ssh_url":"git@github.com:vinodkc/spark.git","clone_url":"https://github.com/vinodkc/spark.git","svn_url":"https://github.com/vinodkc/spark","homepage":null,"size":464015,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":3,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"eaaf1aa2ac157abb00981a5449f112bed4715f18","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25194"},"html":{"href":"https://github.com/apache/spark/pull/25194"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25194"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25194/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25194/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25194/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d8bec8032fbfd92453f4c38cbabde427897a3cde"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25193","id":298877534,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4ODc3NTM0","html_url":"https://github.com/apache/spark/pull/25193","diff_url":"https://github.com/apache/spark/pull/25193.diff","patch_url":"https://github.com/apache/spark/pull/25193.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25193","number":25193,"state":"closed","locked":false,"title":"[SPARK-28439][PYTHON][SQL] Add support for count: Column in array_repeat","user":{"login":"zero323","id":1554276,"node_id":"MDQ6VXNlcjE1NTQyNzY=","avatar_url":"https://avatars.githubusercontent.com/u/1554276?v=4","gravatar_id":"","url":"https://api.github.com/users/zero323","html_url":"https://github.com/zero323","followers_url":"https://api.github.com/users/zero323/followers","following_url":"https://api.github.com/users/zero323/following{/other_user}","gists_url":"https://api.github.com/users/zero323/gists{/gist_id}","starred_url":"https://api.github.com/users/zero323/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zero323/subscriptions","organizations_url":"https://api.github.com/users/zero323/orgs","repos_url":"https://api.github.com/users/zero323/repos","events_url":"https://api.github.com/users/zero323/events{/privacy}","received_events_url":"https://api.github.com/users/zero323/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis adds simple check for `count` argument:\r\n\r\n- If it is a `Column` we apply `_to_java_column` before invoking JVM counterpart\r\n- Otherwise we proceed as before.\r\n\r\n## How was this patch tested?\r\n\r\nManual testing.","created_at":"2019-07-18T11:49:56Z","updated_at":"2020-04-23T22:56:53Z","closed_at":"2019-07-18T20:03:16Z","merged_at":null,"merge_commit_sha":"2840ac2fe56bbbb21d734b0383cfee9ed94e882b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25193/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25193/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25193/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6fedb9dbc16274db21720a90883fac6b79489d7e","head":{"label":"zero323:SPARK-28278","ref":"SPARK-28278","sha":"6fedb9dbc16274db21720a90883fac6b79489d7e","user":{"login":"zero323","id":1554276,"node_id":"MDQ6VXNlcjE1NTQyNzY=","avatar_url":"https://avatars.githubusercontent.com/u/1554276?v=4","gravatar_id":"","url":"https://api.github.com/users/zero323","html_url":"https://github.com/zero323","followers_url":"https://api.github.com/users/zero323/followers","following_url":"https://api.github.com/users/zero323/following{/other_user}","gists_url":"https://api.github.com/users/zero323/gists{/gist_id}","starred_url":"https://api.github.com/users/zero323/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zero323/subscriptions","organizations_url":"https://api.github.com/users/zero323/orgs","repos_url":"https://api.github.com/users/zero323/repos","events_url":"https://api.github.com/users/zero323/events{/privacy}","received_events_url":"https://api.github.com/users/zero323/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":43824676,"node_id":"MDEwOlJlcG9zaXRvcnk0MzgyNDY3Ng==","name":"spark","full_name":"zero323/spark","private":false,"owner":{"login":"zero323","id":1554276,"node_id":"MDQ6VXNlcjE1NTQyNzY=","avatar_url":"https://avatars.githubusercontent.com/u/1554276?v=4","gravatar_id":"","url":"https://api.github.com/users/zero323","html_url":"https://github.com/zero323","followers_url":"https://api.github.com/users/zero323/followers","following_url":"https://api.github.com/users/zero323/following{/other_user}","gists_url":"https://api.github.com/users/zero323/gists{/gist_id}","starred_url":"https://api.github.com/users/zero323/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zero323/subscriptions","organizations_url":"https://api.github.com/users/zero323/orgs","repos_url":"https://api.github.com/users/zero323/repos","events_url":"https://api.github.com/users/zero323/events{/privacy}","received_events_url":"https://api.github.com/users/zero323/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zero323/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zero323/spark","forks_url":"https://api.github.com/repos/zero323/spark/forks","keys_url":"https://api.github.com/repos/zero323/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zero323/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zero323/spark/teams","hooks_url":"https://api.github.com/repos/zero323/spark/hooks","issue_events_url":"https://api.github.com/repos/zero323/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zero323/spark/events","assignees_url":"https://api.github.com/repos/zero323/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zero323/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zero323/spark/tags","blobs_url":"https://api.github.com/repos/zero323/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zero323/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zero323/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zero323/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zero323/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zero323/spark/languages","stargazers_url":"https://api.github.com/repos/zero323/spark/stargazers","contributors_url":"https://api.github.com/repos/zero323/spark/contributors","subscribers_url":"https://api.github.com/repos/zero323/spark/subscribers","subscription_url":"https://api.github.com/repos/zero323/spark/subscription","commits_url":"https://api.github.com/repos/zero323/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zero323/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zero323/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zero323/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zero323/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zero323/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zero323/spark/merges","archive_url":"https://api.github.com/repos/zero323/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zero323/spark/downloads","issues_url":"https://api.github.com/repos/zero323/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zero323/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zero323/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zero323/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zero323/spark/labels{/name}","releases_url":"https://api.github.com/repos/zero323/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zero323/spark/deployments","created_at":"2015-10-07T15:16:38Z","updated_at":"2025-02-05T16:45:39Z","pushed_at":"2025-02-05T16:44:26Z","git_url":"git://github.com/zero323/spark.git","ssh_url":"git@github.com:zero323/spark.git","clone_url":"https://github.com/zero323/spark.git","svn_url":"https://github.com/zero323/spark","homepage":null,"size":438263,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"eaaf1aa2ac157abb00981a5449f112bed4715f18","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25193"},"html":{"href":"https://github.com/apache/spark/pull/25193"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25193"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25193/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25193/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25193/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6fedb9dbc16274db21720a90883fac6b79489d7e"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25192","id":298860122,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4ODYwMTIy","html_url":"https://github.com/apache/spark/pull/25192","diff_url":"https://github.com/apache/spark/pull/25192.diff","patch_url":"https://github.com/apache/spark/pull/25192.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25192","number":25192,"state":"closed","locked":false,"title":"[SPARK-28436][SQL] Throw better exception when datasource's schema is not equal to user-specific schema","user":{"login":"LiShuMing","id":5104975,"node_id":"MDQ6VXNlcjUxMDQ5NzU=","avatar_url":"https://avatars.githubusercontent.com/u/5104975?v=4","gravatar_id":"","url":"https://api.github.com/users/LiShuMing","html_url":"https://github.com/LiShuMing","followers_url":"https://api.github.com/users/LiShuMing/followers","following_url":"https://api.github.com/users/LiShuMing/following{/other_user}","gists_url":"https://api.github.com/users/LiShuMing/gists{/gist_id}","starred_url":"https://api.github.com/users/LiShuMing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LiShuMing/subscriptions","organizations_url":"https://api.github.com/users/LiShuMing/orgs","repos_url":"https://api.github.com/users/LiShuMing/repos","events_url":"https://api.github.com/users/LiShuMing/events{/privacy}","received_events_url":"https://api.github.com/users/LiShuMing/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"When this exception is thrown, users cannot find what's the difference between datasource's original schema and user-specific schema, and maybe very confused when meet the exception below.\r\n\r\n```\r\norg.apache.spark.sql.AnalysisException: org.apache.spark.odps.datasource does not allow user-specified schemas.\r\n    at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:347)\r\n    at org.apache.spark.sql.execution.command.CreateDataSourceTableCommand.run(createDataSourceTables.scala:78)\r\n    at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n    at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n    at org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:79)\r\n    at org.apache.spark.sql.Dataset$$anonfun$6.apply(Dataset.scala:190)\r\n    at org.apache.spark.sql.Dataset$$anonfun$6.apply(Dataset.scala:190)\r\n    at org.apache.spark.sql.Dataset$$anonfun$52.apply(Dataset.scala:3270)\r\n    at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:83)\r\n    at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3269)\r\n    at org.apache.spark.sql.Dataset.<init>(Dataset.scala:190)\r\n    at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:75)\r\n    at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:653)\r\n    at org.apache.spark.sql.SQLContext.sql(SQLContext.scala:714)\r\n```","created_at":"2019-07-18T10:56:46Z","updated_at":"2019-08-25T05:39:28Z","closed_at":"2019-08-25T05:39:28Z","merged_at":null,"merge_commit_sha":"eeb4b025c8d4a5722e1e6a93e4ab9439f40356ee","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25192/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25192/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25192/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a0aa5f54276290bb70bffcfff8539c4781af0956","head":{"label":"LiShuMing:SPARK-28436","ref":"SPARK-28436","sha":"a0aa5f54276290bb70bffcfff8539c4781af0956","user":{"login":"LiShuMing","id":5104975,"node_id":"MDQ6VXNlcjUxMDQ5NzU=","avatar_url":"https://avatars.githubusercontent.com/u/5104975?v=4","gravatar_id":"","url":"https://api.github.com/users/LiShuMing","html_url":"https://github.com/LiShuMing","followers_url":"https://api.github.com/users/LiShuMing/followers","following_url":"https://api.github.com/users/LiShuMing/following{/other_user}","gists_url":"https://api.github.com/users/LiShuMing/gists{/gist_id}","starred_url":"https://api.github.com/users/LiShuMing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LiShuMing/subscriptions","organizations_url":"https://api.github.com/users/LiShuMing/orgs","repos_url":"https://api.github.com/users/LiShuMing/repos","events_url":"https://api.github.com/users/LiShuMing/events{/privacy}","received_events_url":"https://api.github.com/users/LiShuMing/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":99665097,"node_id":"MDEwOlJlcG9zaXRvcnk5OTY2NTA5Nw==","name":"spark","full_name":"LiShuMing/spark","private":false,"owner":{"login":"LiShuMing","id":5104975,"node_id":"MDQ6VXNlcjUxMDQ5NzU=","avatar_url":"https://avatars.githubusercontent.com/u/5104975?v=4","gravatar_id":"","url":"https://api.github.com/users/LiShuMing","html_url":"https://github.com/LiShuMing","followers_url":"https://api.github.com/users/LiShuMing/followers","following_url":"https://api.github.com/users/LiShuMing/following{/other_user}","gists_url":"https://api.github.com/users/LiShuMing/gists{/gist_id}","starred_url":"https://api.github.com/users/LiShuMing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LiShuMing/subscriptions","organizations_url":"https://api.github.com/users/LiShuMing/orgs","repos_url":"https://api.github.com/users/LiShuMing/repos","events_url":"https://api.github.com/users/LiShuMing/events{/privacy}","received_events_url":"https://api.github.com/users/LiShuMing/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LiShuMing/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LiShuMing/spark","forks_url":"https://api.github.com/repos/LiShuMing/spark/forks","keys_url":"https://api.github.com/repos/LiShuMing/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LiShuMing/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LiShuMing/spark/teams","hooks_url":"https://api.github.com/repos/LiShuMing/spark/hooks","issue_events_url":"https://api.github.com/repos/LiShuMing/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LiShuMing/spark/events","assignees_url":"https://api.github.com/repos/LiShuMing/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LiShuMing/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LiShuMing/spark/tags","blobs_url":"https://api.github.com/repos/LiShuMing/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LiShuMing/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LiShuMing/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LiShuMing/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LiShuMing/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LiShuMing/spark/languages","stargazers_url":"https://api.github.com/repos/LiShuMing/spark/stargazers","contributors_url":"https://api.github.com/repos/LiShuMing/spark/contributors","subscribers_url":"https://api.github.com/repos/LiShuMing/spark/subscribers","subscription_url":"https://api.github.com/repos/LiShuMing/spark/subscription","commits_url":"https://api.github.com/repos/LiShuMing/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LiShuMing/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LiShuMing/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LiShuMing/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LiShuMing/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LiShuMing/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LiShuMing/spark/merges","archive_url":"https://api.github.com/repos/LiShuMing/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LiShuMing/spark/downloads","issues_url":"https://api.github.com/repos/LiShuMing/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LiShuMing/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LiShuMing/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LiShuMing/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LiShuMing/spark/labels{/name}","releases_url":"https://api.github.com/repos/LiShuMing/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LiShuMing/spark/deployments","created_at":"2017-08-08T07:44:03Z","updated_at":"2017-08-08T07:44:33Z","pushed_at":"2019-08-14T05:19:32Z","git_url":"git://github.com/LiShuMing/spark.git","ssh_url":"git@github.com:LiShuMing/spark.git","clone_url":"https://github.com/LiShuMing/spark.git","svn_url":"https://github.com/LiShuMing/spark","homepage":null,"size":296203,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"70f82fd2985c0153958063652dc412f56e95d1e6","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25192"},"html":{"href":"https://github.com/apache/spark/pull/25192"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25192"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25192/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25192/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25192/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a0aa5f54276290bb70bffcfff8539c4781af0956"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25191","id":298791931,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NzkxOTMx","html_url":"https://github.com/apache/spark/pull/25191","diff_url":"https://github.com/apache/spark/pull/25191.diff","patch_url":"https://github.com/apache/spark/pull/25191.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25191","number":25191,"state":"closed","locked":false,"title":"[SPARK-28440][MLLIB][TEST] Use TestingUtils to compare floating point values","user":{"login":"eugen-natucci","id":2123664,"node_id":"MDQ6VXNlcjIxMjM2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/2123664?v=4","gravatar_id":"","url":"https://api.github.com/users/eugen-natucci","html_url":"https://github.com/eugen-natucci","followers_url":"https://api.github.com/users/eugen-natucci/followers","following_url":"https://api.github.com/users/eugen-natucci/following{/other_user}","gists_url":"https://api.github.com/users/eugen-natucci/gists{/gist_id}","starred_url":"https://api.github.com/users/eugen-natucci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eugen-natucci/subscriptions","organizations_url":"https://api.github.com/users/eugen-natucci/orgs","repos_url":"https://api.github.com/users/eugen-natucci/repos","events_url":"https://api.github.com/users/eugen-natucci/events{/privacy}","received_events_url":"https://api.github.com/users/eugen-natucci/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nUse `org.apache.spark.mllib.util.TestingUtils` object across `MLLIB` component to compare floating point values in tests.\r\n\r\n## How was this patch tested?\r\n\r\n`build/mvn test` - existing tests against updated code.","created_at":"2019-07-18T07:44:07Z","updated_at":"2019-07-19T15:33:33Z","closed_at":"2019-07-19T06:52:35Z","merged_at":null,"merge_commit_sha":"f2d82ce3ffe08f4031367686f953c35fec29c3b2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405803268,"node_id":"MDU6TGFiZWwxNDA1ODAzMjY4","url":"https://api.github.com/repos/apache/spark/labels/MLLIB","name":"MLLIB","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25191/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25191/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25191/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/49a7efb1aca16491931a65e195ea403de290e280","head":{"label":"eugen-natucci:mllib-testingutils-double-comparison","ref":"mllib-testingutils-double-comparison","sha":"49a7efb1aca16491931a65e195ea403de290e280","user":{"login":"eugen-natucci","id":2123664,"node_id":"MDQ6VXNlcjIxMjM2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/2123664?v=4","gravatar_id":"","url":"https://api.github.com/users/eugen-natucci","html_url":"https://github.com/eugen-natucci","followers_url":"https://api.github.com/users/eugen-natucci/followers","following_url":"https://api.github.com/users/eugen-natucci/following{/other_user}","gists_url":"https://api.github.com/users/eugen-natucci/gists{/gist_id}","starred_url":"https://api.github.com/users/eugen-natucci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eugen-natucci/subscriptions","organizations_url":"https://api.github.com/users/eugen-natucci/orgs","repos_url":"https://api.github.com/users/eugen-natucci/repos","events_url":"https://api.github.com/users/eugen-natucci/events{/privacy}","received_events_url":"https://api.github.com/users/eugen-natucci/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"2cf0491a97c17762c36321c28279b28f7510f722","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25191"},"html":{"href":"https://github.com/apache/spark/pull/25191"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25191"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25191/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25191/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25191/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/49a7efb1aca16491931a65e195ea403de290e280"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25190","id":298787322,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4Nzg3MzIy","html_url":"https://github.com/apache/spark/pull/25190","diff_url":"https://github.com/apache/spark/pull/25190.diff","patch_url":"https://github.com/apache/spark/pull/25190.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25190","number":25190,"state":"closed","locked":false,"title":"[SPARK-28429][SQL] Support implicit cast string type to interval type in PromoteStrings","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nPostgreSQL support implicit cast string type to interval type when adding timestamp type with string type:\r\n\r\n```sql\r\npostgres=# explain verbose select now() + '100 days', '100 days' + now();\r\n                                QUERY PLAN\r\n--------------------------------------------------------------------------\r\n Result  (cost=0.00..0.02 rows=1 width=16)\r\n   Output: (now() + '100 days'::interval), (now() + '100 days'::interval)\r\n(2 rows)\r\n```\r\nThis pr add this feature.\r\n\r\nTeradata, Oracle, DB2, Presto, MariaDB and MySQL does not support this syntax, PostgreSQL and Vertica support this syntax:\r\n```sql\r\ndbadmin=> select version(), current_timestamp + cast(interval '1' year as varchar(255)), cast(interval '2' year as varchar(255)) + current_timestamp, current_timestamp - cast(interval '3' year as varchar(255));\r\n              version               |           ?column?            |           ?column?            |           ?column?\r\n------------------------------------+-------------------------------+-------------------------------+-------------------------------\r\n Vertica Analytic Database v9.1.1-0 | 2019-07-24 13:14:03.003878+00 | 2019-07-25 13:14:03.003878+00 | 2019-07-20 13:14:03.003878+00\r\n(1 row)\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nunit tests\r\n","created_at":"2019-07-18T07:28:30Z","updated_at":"2019-10-18T15:58:29Z","closed_at":"2019-09-02T14:03:53Z","merged_at":null,"merge_commit_sha":"415179d7ca18ab9b51204ef5eee79c06a87bcfd4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25190/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25190/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25190/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a227143989b3906e5bfce9c8351c0eccf5a4d65e","head":{"label":"wangyum:SPARK-28429","ref":"SPARK-28429","sha":"a227143989b3906e5bfce9c8351c0eccf5a4d65e","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"18156d5503489fe5f9efdd4b0e2bfb1faa13e67d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25190"},"html":{"href":"https://github.com/apache/spark/pull/25190"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25190"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25190/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25190/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25190/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a227143989b3906e5bfce9c8351c0eccf5a4d65e"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25189","id":298769620,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NzY5NjIw","html_url":"https://github.com/apache/spark/pull/25189","diff_url":"https://github.com/apache/spark/pull/25189.diff","patch_url":"https://github.com/apache/spark/pull/25189.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25189","number":25189,"state":"closed","locked":false,"title":"[SPARK-28435][SQL] Support accepting the interval keyword in the schema string","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nhttps://github.com/apache/spark/pull/7355 add support casting between IntervalType and StringType for scala interface:\r\n```scala\r\nimport org.apache.spark.sql.types._\r\nimport org.apache.spark.sql.catalyst.expressions._\r\n\r\nCast(Literal(\"interval 3 month 1 hours\"), CalendarIntervalType).eval()\r\nres0: Any = interval 3 months 1 hours\r\n```\r\nBut SQL interface does not support it:\r\n```sql\r\nscala> spark.sql(\"SELECT CAST('interval 3 month 1 hour' AS interval)\").show\r\norg.apache.spark.sql.catalyst.parser.ParseException:\r\nDataType interval is not supported.(line 1, pos 41)\r\n\r\n== SQL ==\r\nSELECT CAST('interval 3 month 1 hour' AS interval)\r\n-----------------------------------------^^^\r\n\r\n  at org.apache.spark.sql.catalyst.parser.AstBuilder.$anonfun$visitPrimitiveDataType$1(AstBuilder.scala:1931)\r\n  at org.apache.spark.sql.catalyst.parser.ParserUtils$.withOrigin(ParserUtils.scala:108)\r\n  at org.apache.spark.sql.catalyst.parser.AstBuilder.visitPrimitiveDataType(AstBuilder.scala:1909)\r\n  at org.apache.spark.sql.catalyst.parser.AstBuilder.visitPrimitiveDataType(AstBuilder.scala:52)\r\n...\r\n```\r\n\r\nThis PR add supports accepting the `interval` keyword in the schema string. So that SQL interface can support this feature.\r\n\r\n## How was this patch tested?\r\n\r\nunit tests\r\n","created_at":"2019-07-18T06:18:42Z","updated_at":"2020-01-19T08:04:44Z","closed_at":"2019-07-24T02:45:29Z","merged_at":null,"merge_commit_sha":"ac1a04edd8bf144b9c7b2d2094feeaabe1cc209e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25189/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25189/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25189/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ca111a4150155900f70d36381432ca3191bca07f","head":{"label":"wangyum:SPARK-28435","ref":"SPARK-28435","sha":"ca111a4150155900f70d36381432ca3191bca07f","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"022667cea666190bea651a3873234700a472326c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25189"},"html":{"href":"https://github.com/apache/spark/pull/25189"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25189"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25189/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25189/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25189/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ca111a4150155900f70d36381432ca3191bca07f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25188","id":298764996,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NzY0OTk2","html_url":"https://github.com/apache/spark/pull/25188","diff_url":"https://github.com/apache/spark/pull/25188.diff","patch_url":"https://github.com/apache/spark/pull/25188.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25188","number":25188,"state":"closed","locked":false,"title":"spark1","user":{"login":"talendinbox","id":53033004,"node_id":"MDQ6VXNlcjUzMDMzMDA0","avatar_url":"https://avatars.githubusercontent.com/u/53033004?v=4","gravatar_id":"","url":"https://api.github.com/users/talendinbox","html_url":"https://github.com/talendinbox","followers_url":"https://api.github.com/users/talendinbox/followers","following_url":"https://api.github.com/users/talendinbox/following{/other_user}","gists_url":"https://api.github.com/users/talendinbox/gists{/gist_id}","starred_url":"https://api.github.com/users/talendinbox/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talendinbox/subscriptions","organizations_url":"https://api.github.com/users/talendinbox/orgs","repos_url":"https://api.github.com/users/talendinbox/repos","events_url":"https://api.github.com/users/talendinbox/events{/privacy}","received_events_url":"https://api.github.com/users/talendinbox/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n(Please fill in changes proposed in this fix)\r\n\r\n## How was this patch tested?\r\n\r\n(Please explain how this patch was tested. E.g. unit tests, integration tests, manual tests)\r\n(If this patch involves UI changes, please attach a screenshot; otherwise, remove this)\r\n\r\nPlease review https://spark.apache.org/contributing.html before opening a pull request.\r\n","created_at":"2019-07-18T05:55:23Z","updated_at":"2019-07-18T06:44:55Z","closed_at":"2019-07-18T06:44:55Z","merged_at":null,"merge_commit_sha":null,"assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25188/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25188/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25188/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/76251c3e97dfeb9080de21ee3ab5188b6889f6e9","head":{"label":"apache:branch-2.4","ref":"branch-2.4","sha":"76251c3e97dfeb9080de21ee3ab5188b6889f6e9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"971e832e0eb720e346e9863ccfd41304d0f8f3dc","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25188"},"html":{"href":"https://github.com/apache/spark/pull/25188"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25188"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25188/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25188/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25188/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/76251c3e97dfeb9080de21ee3ab5188b6889f6e9"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25187","id":298747883,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NzQ3ODgz","html_url":"https://github.com/apache/spark/pull/25187","diff_url":"https://github.com/apache/spark/pull/25187.diff","patch_url":"https://github.com/apache/spark/pull/25187.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25187","number":25187,"state":"closed","locked":false,"title":"[SPARK-28434][MLlib] Decision Tree model isn't equal after save and load","user":{"login":"eugen-natucci","id":2123664,"node_id":"MDQ6VXNlcjIxMjM2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/2123664?v=4","gravatar_id":"","url":"https://api.github.com/users/eugen-natucci","html_url":"https://github.com/eugen-natucci","followers_url":"https://api.github.com/users/eugen-natucci/followers","following_url":"https://api.github.com/users/eugen-natucci/following{/other_user}","gists_url":"https://api.github.com/users/eugen-natucci/gists{/gist_id}","starred_url":"https://api.github.com/users/eugen-natucci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eugen-natucci/subscriptions","organizations_url":"https://api.github.com/users/eugen-natucci/orgs","repos_url":"https://api.github.com/users/eugen-natucci/repos","events_url":"https://api.github.com/users/eugen-natucci/events{/privacy}","received_events_url":"https://api.github.com/users/eugen-natucci/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nCheck other `DecisionTreeModel`'s node's `stats` fields by using `InformationGainStats`'s overridden `equals` method.\r\n\r\nThe issue is that if we compare more fields of the `InformationGainStats` object, we'll see that they are different, unlike the only checked before `gain` field.\r\n\r\n## How was this patch tested?\r\n\r\n`build/mvn -e -Dtest=none -DwildcardSuites=org.apache.spark.mllib.tree.DecisionTreeSuite test` against `master` branch\r\n","created_at":"2019-07-18T04:03:17Z","updated_at":"2019-08-18T00:04:21Z","closed_at":"2019-08-18T00:04:21Z","merged_at":null,"merge_commit_sha":"7261b4c55d3b6b2514ceda518306eb6c625458fc","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405803268,"node_id":"MDU6TGFiZWwxNDA1ODAzMjY4","url":"https://api.github.com/repos/apache/spark/labels/MLLIB","name":"MLLIB","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25187/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25187/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25187/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3ab599b7f1a9ee1c5ca917f643389eb00258994c","head":{"label":"eugen-natucci:SPARK-28434","ref":"SPARK-28434","sha":"3ab599b7f1a9ee1c5ca917f643389eb00258994c","user":{"login":"eugen-natucci","id":2123664,"node_id":"MDQ6VXNlcjIxMjM2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/2123664?v=4","gravatar_id":"","url":"https://api.github.com/users/eugen-natucci","html_url":"https://github.com/eugen-natucci","followers_url":"https://api.github.com/users/eugen-natucci/followers","following_url":"https://api.github.com/users/eugen-natucci/following{/other_user}","gists_url":"https://api.github.com/users/eugen-natucci/gists{/gist_id}","starred_url":"https://api.github.com/users/eugen-natucci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eugen-natucci/subscriptions","organizations_url":"https://api.github.com/users/eugen-natucci/orgs","repos_url":"https://api.github.com/users/eugen-natucci/repos","events_url":"https://api.github.com/users/eugen-natucci/events{/privacy}","received_events_url":"https://api.github.com/users/eugen-natucci/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"eb5dc746c250d614d7ebf9b310fe531f154c0fee","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25187"},"html":{"href":"https://github.com/apache/spark/pull/25187"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25187"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25187/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25187/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25187/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3ab599b7f1a9ee1c5ca917f643389eb00258994c"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25186","id":298737657,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NzM3NjU3","html_url":"https://github.com/apache/spark/pull/25186","diff_url":"https://github.com/apache/spark/pull/25186.diff","patch_url":"https://github.com/apache/spark/pull/25186.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25186","number":25186,"state":"closed","locked":false,"title":"[SPARK-28433][SQL][TEST] Remove hardware-dependent `0.0/0.0` and NaN comparison assertions","user":{"login":"huangtianhua","id":5117792,"node_id":"MDQ6VXNlcjUxMTc3OTI=","avatar_url":"https://avatars.githubusercontent.com/u/5117792?v=4","gravatar_id":"","url":"https://api.github.com/users/huangtianhua","html_url":"https://github.com/huangtianhua","followers_url":"https://api.github.com/users/huangtianhua/followers","following_url":"https://api.github.com/users/huangtianhua/following{/other_user}","gists_url":"https://api.github.com/users/huangtianhua/gists{/gist_id}","starred_url":"https://api.github.com/users/huangtianhua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huangtianhua/subscriptions","organizations_url":"https://api.github.com/users/huangtianhua/orgs","repos_url":"https://api.github.com/users/huangtianhua/repos","events_url":"https://api.github.com/users/huangtianhua/events{/privacy}","received_events_url":"https://api.github.com/users/huangtianhua/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR removes a few hardware-dependent assertions which can cause a failure in `aarch64`.\r\n\r\n**x86_64**\r\n```\r\nroot@donotdel-openlab-allinone-l00242678:/home/ubuntu# uname -a\r\nLinux donotdel-openlab-allinone-l00242678 4.4.0-154-generic #181-Ubuntu SMP Tue Jun 25 05:29:03 UTC\r\n2019 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\nscala> import java.lang.Float.floatToRawIntBits\r\nimport java.lang.Float.floatToRawIntBits\r\nscala> floatToRawIntBits(0.0f/0.0f)\r\nres0: Int = -4194304\r\nscala> floatToRawIntBits(Float.NaN)\r\nres1: Int = 2143289344\r\n```\r\n\r\n**aarch64**\r\n```\r\n[root@arm-huangtianhua spark]# uname -a\r\nLinux arm-huangtianhua 4.14.0-49.el7a.aarch64 #1 SMP Tue Apr 10 17:22:26 UTC 2018 aarch64 aarch64 aarch64 GNU/Linux\r\n\r\nscala> import java.lang.Float.floatToRawIntBits\r\nimport java.lang.Float.floatToRawIntBits\r\nscala> floatToRawIntBits(0.0f/0.0f)\r\nres1: Int = 2143289344\r\nscala> floatToRawIntBits(Float.NaN)\r\nres2: Int = 2143289344 \r\n```\r\n\r\n## How was this patch tested?\r\n\r\nPass the Jenkins (This removes the test coverage).","created_at":"2019-07-18T02:54:43Z","updated_at":"2019-09-11T03:26:37Z","closed_at":"2019-07-19T23:06:41Z","merged_at":null,"merge_commit_sha":"fc2458cb9f7520431836e03b8c9c6d80826a5325","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25186/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25186/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25186/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/cd5cf0c2482976d25fb60638a796aaccabb821b5","head":{"label":"theopenlab:special-test-case-for-aarch64","ref":"special-test-case-for-aarch64","sha":"cd5cf0c2482976d25fb60638a796aaccabb821b5","user":{"login":"theopenlab","id":30709601,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMwNzA5NjAx","avatar_url":"https://avatars.githubusercontent.com/u/30709601?v=4","gravatar_id":"","url":"https://api.github.com/users/theopenlab","html_url":"https://github.com/theopenlab","followers_url":"https://api.github.com/users/theopenlab/followers","following_url":"https://api.github.com/users/theopenlab/following{/other_user}","gists_url":"https://api.github.com/users/theopenlab/gists{/gist_id}","starred_url":"https://api.github.com/users/theopenlab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theopenlab/subscriptions","organizations_url":"https://api.github.com/users/theopenlab/orgs","repos_url":"https://api.github.com/users/theopenlab/repos","events_url":"https://api.github.com/users/theopenlab/events{/privacy}","received_events_url":"https://api.github.com/users/theopenlab/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":192834223,"node_id":"MDEwOlJlcG9zaXRvcnkxOTI4MzQyMjM=","name":"spark","full_name":"theopenlab/spark","private":false,"owner":{"login":"theopenlab","id":30709601,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMwNzA5NjAx","avatar_url":"https://avatars.githubusercontent.com/u/30709601?v=4","gravatar_id":"","url":"https://api.github.com/users/theopenlab","html_url":"https://github.com/theopenlab","followers_url":"https://api.github.com/users/theopenlab/followers","following_url":"https://api.github.com/users/theopenlab/following{/other_user}","gists_url":"https://api.github.com/users/theopenlab/gists{/gist_id}","starred_url":"https://api.github.com/users/theopenlab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theopenlab/subscriptions","organizations_url":"https://api.github.com/users/theopenlab/orgs","repos_url":"https://api.github.com/users/theopenlab/repos","events_url":"https://api.github.com/users/theopenlab/events{/privacy}","received_events_url":"https://api.github.com/users/theopenlab/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/theopenlab/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/theopenlab/spark","forks_url":"https://api.github.com/repos/theopenlab/spark/forks","keys_url":"https://api.github.com/repos/theopenlab/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/theopenlab/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/theopenlab/spark/teams","hooks_url":"https://api.github.com/repos/theopenlab/spark/hooks","issue_events_url":"https://api.github.com/repos/theopenlab/spark/issues/events{/number}","events_url":"https://api.github.com/repos/theopenlab/spark/events","assignees_url":"https://api.github.com/repos/theopenlab/spark/assignees{/user}","branches_url":"https://api.github.com/repos/theopenlab/spark/branches{/branch}","tags_url":"https://api.github.com/repos/theopenlab/spark/tags","blobs_url":"https://api.github.com/repos/theopenlab/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/theopenlab/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/theopenlab/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/theopenlab/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/theopenlab/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/theopenlab/spark/languages","stargazers_url":"https://api.github.com/repos/theopenlab/spark/stargazers","contributors_url":"https://api.github.com/repos/theopenlab/spark/contributors","subscribers_url":"https://api.github.com/repos/theopenlab/spark/subscribers","subscription_url":"https://api.github.com/repos/theopenlab/spark/subscription","commits_url":"https://api.github.com/repos/theopenlab/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/theopenlab/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/theopenlab/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/theopenlab/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/theopenlab/spark/contents/{+path}","compare_url":"https://api.github.com/repos/theopenlab/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/theopenlab/spark/merges","archive_url":"https://api.github.com/repos/theopenlab/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/theopenlab/spark/downloads","issues_url":"https://api.github.com/repos/theopenlab/spark/issues{/number}","pulls_url":"https://api.github.com/repos/theopenlab/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/theopenlab/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/theopenlab/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/theopenlab/spark/labels{/name}","releases_url":"https://api.github.com/repos/theopenlab/spark/releases{/id}","deployments_url":"https://api.github.com/repos/theopenlab/spark/deployments","created_at":"2019-06-20T02:25:49Z","updated_at":"2020-06-24T07:10:19Z","pushed_at":"2020-06-24T07:07:39Z","git_url":"git://github.com/theopenlab/spark.git","ssh_url":"git@github.com:theopenlab/spark.git","clone_url":"https://github.com/theopenlab/spark.git","svn_url":"https://github.com/theopenlab/spark","homepage":"","size":328623,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"127bc899ae78d73332a87f0972b5db3c9936c1f1","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25186"},"html":{"href":"https://github.com/apache/spark/pull/25186"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25186"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25186/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25186/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25186/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/cd5cf0c2482976d25fb60638a796aaccabb821b5"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25185","id":298737039,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NzM3MDM5","html_url":"https://github.com/apache/spark/pull/25185","diff_url":"https://github.com/apache/spark/pull/25185.diff","patch_url":"https://github.com/apache/spark/pull/25185.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25185","number":25185,"state":"closed","locked":false,"title":"Special test case for aarch64","user":{"login":"huangtianhua","id":5117792,"node_id":"MDQ6VXNlcjUxMTc3OTI=","avatar_url":"https://avatars.githubusercontent.com/u/5117792?v=4","gravatar_id":"","url":"https://api.github.com/users/huangtianhua","html_url":"https://github.com/huangtianhua","followers_url":"https://api.github.com/users/huangtianhua/followers","following_url":"https://api.github.com/users/huangtianhua/following{/other_user}","gists_url":"https://api.github.com/users/huangtianhua/gists{/gist_id}","starred_url":"https://api.github.com/users/huangtianhua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huangtianhua/subscriptions","organizations_url":"https://api.github.com/users/huangtianhua/orgs","repos_url":"https://api.github.com/users/huangtianhua/repos","events_url":"https://api.github.com/users/huangtianhua/events{/privacy}","received_events_url":"https://api.github.com/users/huangtianhua/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"Special scala test case for aarch64\r\n\r\nWe ran unit tests of spark on aarch64 server,\r\nthen found the values of floatToRawIntBits(0.0f / 0.0f)\r\nand floatToRawIntBits(Float.NaN) on aarch64 are same,\r\nafter discuss with jdk-dev and scala community, we believe\r\nthe value should depend on the architecture.\r\n\r\nThis adds special scala test case for aarc64.","created_at":"2019-07-18T02:50:56Z","updated_at":"2019-07-25T08:57:43Z","closed_at":"2019-07-18T02:51:12Z","merged_at":null,"merge_commit_sha":"b0bda5c9a1301c51454fa032c07943c5e9c304df","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25185/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25185/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25185/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a2940c272ec7d106b155441ddd25ecc8639ad489","head":{"label":"theopenlab:special-test-case-for-aarch64","ref":"special-test-case-for-aarch64","sha":"a2940c272ec7d106b155441ddd25ecc8639ad489","user":{"login":"theopenlab","id":30709601,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMwNzA5NjAx","avatar_url":"https://avatars.githubusercontent.com/u/30709601?v=4","gravatar_id":"","url":"https://api.github.com/users/theopenlab","html_url":"https://github.com/theopenlab","followers_url":"https://api.github.com/users/theopenlab/followers","following_url":"https://api.github.com/users/theopenlab/following{/other_user}","gists_url":"https://api.github.com/users/theopenlab/gists{/gist_id}","starred_url":"https://api.github.com/users/theopenlab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theopenlab/subscriptions","organizations_url":"https://api.github.com/users/theopenlab/orgs","repos_url":"https://api.github.com/users/theopenlab/repos","events_url":"https://api.github.com/users/theopenlab/events{/privacy}","received_events_url":"https://api.github.com/users/theopenlab/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":192834223,"node_id":"MDEwOlJlcG9zaXRvcnkxOTI4MzQyMjM=","name":"spark","full_name":"theopenlab/spark","private":false,"owner":{"login":"theopenlab","id":30709601,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMwNzA5NjAx","avatar_url":"https://avatars.githubusercontent.com/u/30709601?v=4","gravatar_id":"","url":"https://api.github.com/users/theopenlab","html_url":"https://github.com/theopenlab","followers_url":"https://api.github.com/users/theopenlab/followers","following_url":"https://api.github.com/users/theopenlab/following{/other_user}","gists_url":"https://api.github.com/users/theopenlab/gists{/gist_id}","starred_url":"https://api.github.com/users/theopenlab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theopenlab/subscriptions","organizations_url":"https://api.github.com/users/theopenlab/orgs","repos_url":"https://api.github.com/users/theopenlab/repos","events_url":"https://api.github.com/users/theopenlab/events{/privacy}","received_events_url":"https://api.github.com/users/theopenlab/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/theopenlab/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/theopenlab/spark","forks_url":"https://api.github.com/repos/theopenlab/spark/forks","keys_url":"https://api.github.com/repos/theopenlab/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/theopenlab/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/theopenlab/spark/teams","hooks_url":"https://api.github.com/repos/theopenlab/spark/hooks","issue_events_url":"https://api.github.com/repos/theopenlab/spark/issues/events{/number}","events_url":"https://api.github.com/repos/theopenlab/spark/events","assignees_url":"https://api.github.com/repos/theopenlab/spark/assignees{/user}","branches_url":"https://api.github.com/repos/theopenlab/spark/branches{/branch}","tags_url":"https://api.github.com/repos/theopenlab/spark/tags","blobs_url":"https://api.github.com/repos/theopenlab/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/theopenlab/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/theopenlab/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/theopenlab/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/theopenlab/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/theopenlab/spark/languages","stargazers_url":"https://api.github.com/repos/theopenlab/spark/stargazers","contributors_url":"https://api.github.com/repos/theopenlab/spark/contributors","subscribers_url":"https://api.github.com/repos/theopenlab/spark/subscribers","subscription_url":"https://api.github.com/repos/theopenlab/spark/subscription","commits_url":"https://api.github.com/repos/theopenlab/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/theopenlab/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/theopenlab/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/theopenlab/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/theopenlab/spark/contents/{+path}","compare_url":"https://api.github.com/repos/theopenlab/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/theopenlab/spark/merges","archive_url":"https://api.github.com/repos/theopenlab/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/theopenlab/spark/downloads","issues_url":"https://api.github.com/repos/theopenlab/spark/issues{/number}","pulls_url":"https://api.github.com/repos/theopenlab/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/theopenlab/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/theopenlab/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/theopenlab/spark/labels{/name}","releases_url":"https://api.github.com/repos/theopenlab/spark/releases{/id}","deployments_url":"https://api.github.com/repos/theopenlab/spark/deployments","created_at":"2019-06-20T02:25:49Z","updated_at":"2020-06-24T07:10:19Z","pushed_at":"2020-06-24T07:07:39Z","git_url":"git://github.com/theopenlab/spark.git","ssh_url":"git@github.com:theopenlab/spark.git","clone_url":"https://github.com/theopenlab/spark.git","svn_url":"https://github.com/theopenlab/spark","homepage":"","size":328623,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"eb5dc746c250d614d7ebf9b310fe531f154c0fee","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25185"},"html":{"href":"https://github.com/apache/spark/pull/25185"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25185"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25185/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25185/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25185/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a2940c272ec7d106b155441ddd25ecc8639ad489"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25184","id":298725291,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NzI1Mjkx","html_url":"https://github.com/apache/spark/pull/25184","diff_url":"https://github.com/apache/spark/pull/25184.diff","patch_url":"https://github.com/apache/spark/pull/25184.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25184","number":25184,"state":"closed","locked":false,"title":"[SPARK-28431][SQL] Set maximum error message length in CSV datasource's parsing and writing","user":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nFix CSV datasource to throw `com.univocity.parsers.common.TextParsingException` with large size message, which will make log output consume large disk space.\r\nThis issue is troublesome when sometimes we need parse CSV with large size column.\r\n\r\nThis PR proposes to set CSV parser/writer settings by `setErrorContentLength(1000)` to limit the error message length.\r\n\r\n## How was this patch tested?\r\n\r\nManually.\r\n\r\n```\r\nval s = \"a\" * 40 * 1000000\r\nSeq(s).toDF.write.mode(\"overwrite\").csv(\"/tmp/bogdan/es4196.csv\")\r\n\r\nspark.read .option(\"maxCharsPerColumn\", 30000000) .csv(\"/tmp/bogdan/es4196.csv\").count\r\n```\r\n\r\n**Before:**\r\nThe thrown message will include error content of about 30MB size (The column size exceed the max value 30MB, so the error content include the whole parsed content, so it is 30MB).\r\n\r\n**After:**\r\nThe thrown message will include error content like \"...aaa...aa\" (the number of 'a' is 1024), i.e. limit the content size to be 1024.\r\n","created_at":"2019-07-18T01:32:56Z","updated_at":"2019-07-23T01:49:31Z","closed_at":"2019-07-23T01:49:31Z","merged_at":null,"merge_commit_sha":"3c5e40586f0e69c519aebf54bd5024d31f4ab8fe","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25184/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25184/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25184/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9e8fccabf1effa76b58527f6f061a2c8e525ab07","head":{"label":"WeichenXu123:limit_csv_exception_size","ref":"limit_csv_exception_size","sha":"9e8fccabf1effa76b58527f6f061a2c8e525ab07","user":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":58255485,"node_id":"MDEwOlJlcG9zaXRvcnk1ODI1NTQ4NQ==","name":"spark","full_name":"WeichenXu123/spark","private":false,"owner":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/WeichenXu123/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/WeichenXu123/spark","forks_url":"https://api.github.com/repos/WeichenXu123/spark/forks","keys_url":"https://api.github.com/repos/WeichenXu123/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/WeichenXu123/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/WeichenXu123/spark/teams","hooks_url":"https://api.github.com/repos/WeichenXu123/spark/hooks","issue_events_url":"https://api.github.com/repos/WeichenXu123/spark/issues/events{/number}","events_url":"https://api.github.com/repos/WeichenXu123/spark/events","assignees_url":"https://api.github.com/repos/WeichenXu123/spark/assignees{/user}","branches_url":"https://api.github.com/repos/WeichenXu123/spark/branches{/branch}","tags_url":"https://api.github.com/repos/WeichenXu123/spark/tags","blobs_url":"https://api.github.com/repos/WeichenXu123/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/WeichenXu123/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/WeichenXu123/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/WeichenXu123/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/WeichenXu123/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/WeichenXu123/spark/languages","stargazers_url":"https://api.github.com/repos/WeichenXu123/spark/stargazers","contributors_url":"https://api.github.com/repos/WeichenXu123/spark/contributors","subscribers_url":"https://api.github.com/repos/WeichenXu123/spark/subscribers","subscription_url":"https://api.github.com/repos/WeichenXu123/spark/subscription","commits_url":"https://api.github.com/repos/WeichenXu123/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/WeichenXu123/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/WeichenXu123/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/WeichenXu123/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/WeichenXu123/spark/contents/{+path}","compare_url":"https://api.github.com/repos/WeichenXu123/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/WeichenXu123/spark/merges","archive_url":"https://api.github.com/repos/WeichenXu123/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/WeichenXu123/spark/downloads","issues_url":"https://api.github.com/repos/WeichenXu123/spark/issues{/number}","pulls_url":"https://api.github.com/repos/WeichenXu123/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/WeichenXu123/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/WeichenXu123/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/WeichenXu123/spark/labels{/name}","releases_url":"https://api.github.com/repos/WeichenXu123/spark/releases{/id}","deployments_url":"https://api.github.com/repos/WeichenXu123/spark/deployments","created_at":"2016-05-07T07:45:37Z","updated_at":"2022-01-25T15:06:54Z","pushed_at":"2024-11-04T12:27:24Z","git_url":"git://github.com/WeichenXu123/spark.git","ssh_url":"git@github.com:WeichenXu123/spark.git","clone_url":"https://github.com/WeichenXu123/spark.git","svn_url":"https://github.com/WeichenXu123/spark","homepage":null,"size":436946,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a783690d8a50fe42ae2ed66269814b16f0ec8d1c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25184"},"html":{"href":"https://github.com/apache/spark/pull/25184"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25184"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25184/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25184/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25184/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9e8fccabf1effa76b58527f6f061a2c8e525ab07"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25183","id":298713584,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NzEzNTg0","html_url":"https://github.com/apache/spark/pull/25183","diff_url":"https://github.com/apache/spark/pull/25183.diff","patch_url":"https://github.com/apache/spark/pull/25183.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25183","number":25183,"state":"closed","locked":false,"title":"[SPARK-28430][UI] Fix stage table rendering when some tasks' metrics are missing","user":{"login":"JoshRosen","id":50748,"node_id":"MDQ6VXNlcjUwNzQ4","avatar_url":"https://avatars.githubusercontent.com/u/50748?v=4","gravatar_id":"","url":"https://api.github.com/users/JoshRosen","html_url":"https://github.com/JoshRosen","followers_url":"https://api.github.com/users/JoshRosen/followers","following_url":"https://api.github.com/users/JoshRosen/following{/other_user}","gists_url":"https://api.github.com/users/JoshRosen/gists{/gist_id}","starred_url":"https://api.github.com/users/JoshRosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JoshRosen/subscriptions","organizations_url":"https://api.github.com/users/JoshRosen/orgs","repos_url":"https://api.github.com/users/JoshRosen/repos","events_url":"https://api.github.com/users/JoshRosen/events{/privacy}","received_events_url":"https://api.github.com/users/JoshRosen/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe Spark UI's stages table misrenders the input/output metrics columns when some tasks are missing input metrics. See the screenshot below for an example of the problem:\r\n\r\n![image](https://user-images.githubusercontent.com/50748/61420042-a3abc100-a8b5-11e9-8a92-7986563ee712.png)\r\n\r\nThis is because those columns' are defined as \r\n\r\n```scala\r\n {if (hasInput(stage)) {\r\n  metricInfo(task) { m =>\r\n    ...\r\n   <td>....</td>\r\n  }\r\n}\r\n```\r\n\r\nwhere `metricInfo` renders the node returned by the closure in case metrics are defined or returns `Nil` in case metrics are not defined. If metrics are undefined then we'll fail to render the empty `<td></td>` tag, causing columns to become misaligned as shown in the screenshot.\r\n\r\nTo fix this, this patch changes this to\r\n\r\n```scala\r\n {if (hasInput(stage)) {\r\n  <td>{\r\n    metricInfo(task) { m =>\r\n      ...\r\n     Unparsed(...)\r\n    }\r\n  }</td>\r\n}\r\n```\r\n\r\nwhich is an idiom that's already in use for the shuffle read / write columns.\r\n\r\n## How was this patch tested?\r\n\r\nIt isn't. I'm arguing for correctness because the modifications are consistent with rendering methods that work correctly for other columns.","created_at":"2019-07-18T00:14:37Z","updated_at":"2019-07-18T20:20:03Z","closed_at":"2019-07-18T20:20:03Z","merged_at":null,"merge_commit_sha":"a47d6681e04a25d0319fa9d20b0e93777bbcec33","assignee":null,"assignees":[],"requested_reviewers":[{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1406605079,"node_id":"MDU6TGFiZWwxNDA2NjA1MDc5","url":"https://api.github.com/repos/apache/spark/labels/WEB%20UI","name":"WEB UI","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25183/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25183/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25183/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7d8ae67e1d79e3fe4fbfdb2bfbcfc32bc258a3cc","head":{"label":"JoshRosen:joshrosen/fix-task-table-with-partial-io-metrics","ref":"joshrosen/fix-task-table-with-partial-io-metrics","sha":"7d8ae67e1d79e3fe4fbfdb2bfbcfc32bc258a3cc","user":{"login":"JoshRosen","id":50748,"node_id":"MDQ6VXNlcjUwNzQ4","avatar_url":"https://avatars.githubusercontent.com/u/50748?v=4","gravatar_id":"","url":"https://api.github.com/users/JoshRosen","html_url":"https://github.com/JoshRosen","followers_url":"https://api.github.com/users/JoshRosen/followers","following_url":"https://api.github.com/users/JoshRosen/following{/other_user}","gists_url":"https://api.github.com/users/JoshRosen/gists{/gist_id}","starred_url":"https://api.github.com/users/JoshRosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JoshRosen/subscriptions","organizations_url":"https://api.github.com/users/JoshRosen/orgs","repos_url":"https://api.github.com/users/JoshRosen/repos","events_url":"https://api.github.com/users/JoshRosen/events{/privacy}","received_events_url":"https://api.github.com/users/JoshRosen/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":22238710,"node_id":"MDEwOlJlcG9zaXRvcnkyMjIzODcxMA==","name":"spark","full_name":"JoshRosen/spark","private":false,"owner":{"login":"JoshRosen","id":50748,"node_id":"MDQ6VXNlcjUwNzQ4","avatar_url":"https://avatars.githubusercontent.com/u/50748?v=4","gravatar_id":"","url":"https://api.github.com/users/JoshRosen","html_url":"https://github.com/JoshRosen","followers_url":"https://api.github.com/users/JoshRosen/followers","following_url":"https://api.github.com/users/JoshRosen/following{/other_user}","gists_url":"https://api.github.com/users/JoshRosen/gists{/gist_id}","starred_url":"https://api.github.com/users/JoshRosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JoshRosen/subscriptions","organizations_url":"https://api.github.com/users/JoshRosen/orgs","repos_url":"https://api.github.com/users/JoshRosen/repos","events_url":"https://api.github.com/users/JoshRosen/events{/privacy}","received_events_url":"https://api.github.com/users/JoshRosen/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/JoshRosen/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/JoshRosen/spark","forks_url":"https://api.github.com/repos/JoshRosen/spark/forks","keys_url":"https://api.github.com/repos/JoshRosen/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/JoshRosen/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/JoshRosen/spark/teams","hooks_url":"https://api.github.com/repos/JoshRosen/spark/hooks","issue_events_url":"https://api.github.com/repos/JoshRosen/spark/issues/events{/number}","events_url":"https://api.github.com/repos/JoshRosen/spark/events","assignees_url":"https://api.github.com/repos/JoshRosen/spark/assignees{/user}","branches_url":"https://api.github.com/repos/JoshRosen/spark/branches{/branch}","tags_url":"https://api.github.com/repos/JoshRosen/spark/tags","blobs_url":"https://api.github.com/repos/JoshRosen/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/JoshRosen/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/JoshRosen/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/JoshRosen/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/JoshRosen/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/JoshRosen/spark/languages","stargazers_url":"https://api.github.com/repos/JoshRosen/spark/stargazers","contributors_url":"https://api.github.com/repos/JoshRosen/spark/contributors","subscribers_url":"https://api.github.com/repos/JoshRosen/spark/subscribers","subscription_url":"https://api.github.com/repos/JoshRosen/spark/subscription","commits_url":"https://api.github.com/repos/JoshRosen/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/JoshRosen/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/JoshRosen/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/JoshRosen/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/JoshRosen/spark/contents/{+path}","compare_url":"https://api.github.com/repos/JoshRosen/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/JoshRosen/spark/merges","archive_url":"https://api.github.com/repos/JoshRosen/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/JoshRosen/spark/downloads","issues_url":"https://api.github.com/repos/JoshRosen/spark/issues{/number}","pulls_url":"https://api.github.com/repos/JoshRosen/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/JoshRosen/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/JoshRosen/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/JoshRosen/spark/labels{/name}","releases_url":"https://api.github.com/repos/JoshRosen/spark/releases{/id}","deployments_url":"https://api.github.com/repos/JoshRosen/spark/deployments","created_at":"2014-07-25T00:47:52Z","updated_at":"2022-06-21T17:37:17Z","pushed_at":"2025-01-09T00:48:30Z","git_url":"git://github.com/JoshRosen/spark.git","ssh_url":"git@github.com:JoshRosen/spark.git","clone_url":"https://github.com/JoshRosen/spark.git","svn_url":"https://github.com/JoshRosen/spark","homepage":null,"size":446401,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"eb5dc746c250d614d7ebf9b310fe531f154c0fee","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25183"},"html":{"href":"https://github.com/apache/spark/pull/25183"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25183"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25183/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25183/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25183/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7d8ae67e1d79e3fe4fbfdb2bfbcfc32bc258a3cc"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25182","id":298626794,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NjI2Nzk0","html_url":"https://github.com/apache/spark/pull/25182","diff_url":"https://github.com/apache/spark/pull/25182.diff","patch_url":"https://github.com/apache/spark/pull/25182.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25182","number":25182,"state":"closed","locked":false,"title":"[SPARK-27609][PYTHON] Convert values of function options to strings","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nIn the PR, I propose to convert options values to strings by using `to_str()` for the following functions:  `from_csv()`, `to_csv()`, `from_json()`, `to_json()`, `schema_of_csv()` and `schema_of_json()`. This will make handling of function options consistent to option handling in `DataFrameReader`/`DataFrameWriter`.\r\n\r\nFor example:\r\n```Python\r\ndf.select(from_csv(df.value, \"s string\", {'ignoreLeadingWhiteSpace': True})\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nAdded an example for `from_csv()` which was tested by:\r\n```Shell\r\n./python/run-tests --testnames pyspark.sql.functions\r\n```","created_at":"2019-07-17T18:56:26Z","updated_at":"2019-09-18T15:58:19Z","closed_at":"2019-07-18T04:41:30Z","merged_at":null,"merge_commit_sha":"684e390c1f6c704f6b8bcc5cccce838700bc4529","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25182/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25182/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25182/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8e6dc27a525395510b7e91af64ce185c2a774d40","head":{"label":"MaxGekk:options_to_str","ref":"options_to_str","sha":"8e6dc27a525395510b7e91af64ce185c2a774d40","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":123690489,"node_id":"MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=","name":"spark","full_name":"MaxGekk/spark","private":false,"owner":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/MaxGekk/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/MaxGekk/spark","forks_url":"https://api.github.com/repos/MaxGekk/spark/forks","keys_url":"https://api.github.com/repos/MaxGekk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/MaxGekk/spark/teams","hooks_url":"https://api.github.com/repos/MaxGekk/spark/hooks","issue_events_url":"https://api.github.com/repos/MaxGekk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/MaxGekk/spark/events","assignees_url":"https://api.github.com/repos/MaxGekk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/MaxGekk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/MaxGekk/spark/tags","blobs_url":"https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/MaxGekk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/MaxGekk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/MaxGekk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/MaxGekk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/MaxGekk/spark/languages","stargazers_url":"https://api.github.com/repos/MaxGekk/spark/stargazers","contributors_url":"https://api.github.com/repos/MaxGekk/spark/contributors","subscribers_url":"https://api.github.com/repos/MaxGekk/spark/subscribers","subscription_url":"https://api.github.com/repos/MaxGekk/spark/subscription","commits_url":"https://api.github.com/repos/MaxGekk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/MaxGekk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/MaxGekk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/MaxGekk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/MaxGekk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/MaxGekk/spark/merges","archive_url":"https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/MaxGekk/spark/downloads","issues_url":"https://api.github.com/repos/MaxGekk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/MaxGekk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/MaxGekk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/MaxGekk/spark/labels{/name}","releases_url":"https://api.github.com/repos/MaxGekk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/MaxGekk/spark/deployments","created_at":"2018-03-03T12:37:00Z","updated_at":"2025-02-07T09:44:52Z","pushed_at":"2025-02-07T09:44:24Z","git_url":"git://github.com/MaxGekk/spark.git","ssh_url":"git@github.com:MaxGekk/spark.git","clone_url":"https://github.com/MaxGekk/spark.git","svn_url":"https://github.com/MaxGekk/spark","homepage":null,"size":486456,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"28774cd2ea001f2270f3a5097c552e99dcd8fbe3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25182"},"html":{"href":"https://github.com/apache/spark/pull/25182"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25182"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25182/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25182/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25182/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8e6dc27a525395510b7e91af64ce185c2a774d40"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25181","id":298565499,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NTY1NDk5","html_url":"https://github.com/apache/spark/pull/25181","diff_url":"https://github.com/apache/spark/pull/25181.diff","patch_url":"https://github.com/apache/spark/pull/25181.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25181","number":25181,"state":"closed","locked":false,"title":"[SPARK-28138][SQL][TEST] Port timestamp.sql","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR is to port timestamp.sql from PostgreSQL regression tests. https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/sql/timestamp.sql\r\n\r\nThe expected results can be found in the link: https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/expected/timestamp.out\r\n\r\nWhen porting the test cases, found five PostgreSQL specific features that do not exist in Spark SQL:\r\n[SPARK-28141](https://issues.apache.org/jira/browse/SPARK-28141): Timestamp type can not accept special values\r\n[SPARK-28259](https://issues.apache.org/jira/browse/SPARK-28259): Date/Time Output Styles and Date Order Conventions\r\n[SPARK-28425](https://issues.apache.org/jira/browse/SPARK-28425): Add more Date/Time Operators\r\n[SPARK-28420](https://issues.apache.org/jira/browse/SPARK-28420): Date/Time Functions: date_part\r\n[SPARK-28137](https://issues.apache.org/jira/browse/SPARK-28137): Data Type Formatting Functions\r\n[SPARK-28432](https://issues.apache.org/jira/browse/SPARK-28432): Date/Time Functions: make_date/make_timestamp\r\n\r\nAlso, found one inconsistent behavior:\r\n[SPARK-27923](https://issues.apache.org/jira/browse/SPARK-27923): Spark SQL insert bad inputs to NULL\r\n\r\n## How was this patch tested?\r\n\r\nN/A\r\n","created_at":"2019-07-17T16:00:44Z","updated_at":"2019-07-18T15:55:41Z","closed_at":"2019-07-18T15:55:34Z","merged_at":null,"merge_commit_sha":"78fecb184b15f671228bd55ceccb9b9c97b71cdc","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25181/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25181/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25181/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1c507e5ddae2ac9c3084e7642908083858c8cf7d","head":{"label":"wangyum:SPARK-28138","ref":"SPARK-28138","sha":"1c507e5ddae2ac9c3084e7642908083858c8cf7d","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"28774cd2ea001f2270f3a5097c552e99dcd8fbe3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25181"},"html":{"href":"https://github.com/apache/spark/pull/25181"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25181"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25181/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25181/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25181/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1c507e5ddae2ac9c3084e7642908083858c8cf7d"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25180","id":298550105,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NTUwMTA1","html_url":"https://github.com/apache/spark/pull/25180","diff_url":"https://github.com/apache/spark/pull/25180.diff","patch_url":"https://github.com/apache/spark/pull/25180.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25180","number":25180,"state":"closed","locked":false,"title":"[SPARK-28423][SQL] Merge Scan and Batch/Stream","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nBy design, `Scan` represents a logical data scan, `Batch`/`Stream` represents a physical data scan.\r\n\r\nHowever, this doesn't match reality. The logical plan(`DataSourceV2Relation`) contains `Table` and the phyiscal plan(`BatchScanExec` and friends) contains `Scan`. The operator pushdown happens at planning time, so `Scan` and `Batch`/`Stream` are always created together in the planner rules. That said, `Table` is the actual logical data scan.\r\n\r\nSince there is not much can be separated from `Scan` and `Batch`/`Stream`, almost all the existing DS v2 implementations either implement `Scan` and `Batch`/`Stream` together, or use anonymous class to implement `Scan`.\r\n\r\nIn addition, the write side API has no such separation either: it's just `WriterBuilder` -> `BatchWrite`/`StreamingWrite`.\r\n\r\nThis PR proposes to merge `Scan` and `Batch`/`Stream`, to match the write side API: `ScanBuilder` -> `BatchScan`/`MicroBatchScan`/`ContinuousScan`.\r\n\r\n## How was this patch tested?\r\n\r\nexisting tests\r\n","created_at":"2019-07-17T15:27:03Z","updated_at":"2019-12-27T03:24:58Z","closed_at":"2019-12-27T03:24:58Z","merged_at":null,"merge_commit_sha":"9ce1672b0b6daaf675238ce8f363dee0683de739","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25180/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25180/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25180/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a7d0c55677d519843086f54ef9502e5482ea2765","head":{"label":"cloud-fan:merge","ref":"merge","sha":"a7d0c55677d519843086f54ef9502e5482ea2765","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"bab88c48b1432249571aae90bc56b40d74f2fa88","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25180"},"html":{"href":"https://github.com/apache/spark/pull/25180"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25180"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25180/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25180/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25180/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a7d0c55677d519843086f54ef9502e5482ea2765"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25179","id":298454394,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NDU0Mzk0","html_url":"https://github.com/apache/spark/pull/25179","diff_url":"https://github.com/apache/spark/pull/25179.diff","patch_url":"https://github.com/apache/spark/pull/25179.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25179","number":25179,"state":"closed","locked":false,"title":"[SPARK-28419][SQL] A patch for SparkThriftServer to support multi-tenant authentication for spark-2.4.0","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR is about a patch to improve spark-2.4.0 to support  multi-tenant authentication.\r\n\r\nIn this PR, hope to discuss with Spark SQL developers about how to enable SparkThriftServer proxy user. And accept suggestions about this method and improve code structure.(ps: there are some unsightly or crude code.)\r\n\r\n## How was this patch tested?\r\n\r\nI have test it in our enviorment, it can read and write with proxy user in Kerberos.\r\nHope some one can test it in different enviorment.\r\nNeed more  concurrency  test.","created_at":"2019-07-17T12:50:26Z","updated_at":"2020-02-05T18:26:35Z","closed_at":"2019-07-17T16:39:04Z","merged_at":null,"merge_commit_sha":"872863c9a55028f72bb2732afb3d3c4ecbca79d5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25179/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25179/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25179/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5ecb8a761bfbe87cfc67934d773a33cc3a172580","head":{"label":"AngersZhuuuu:SPARK-28419/spark-2.4.0","ref":"SPARK-28419/spark-2.4.0","sha":"5ecb8a761bfbe87cfc67934d773a33cc3a172580","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":176224753,"node_id":"MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=","name":"spark","full_name":"AngersZhuuuu/spark","private":false,"owner":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/AngersZhuuuu/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/AngersZhuuuu/spark","forks_url":"https://api.github.com/repos/AngersZhuuuu/spark/forks","keys_url":"https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/AngersZhuuuu/spark/teams","hooks_url":"https://api.github.com/repos/AngersZhuuuu/spark/hooks","issue_events_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/AngersZhuuuu/spark/events","assignees_url":"https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/tags","blobs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/AngersZhuuuu/spark/languages","stargazers_url":"https://api.github.com/repos/AngersZhuuuu/spark/stargazers","contributors_url":"https://api.github.com/repos/AngersZhuuuu/spark/contributors","subscribers_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscribers","subscription_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscription","commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/AngersZhuuuu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/AngersZhuuuu/spark/merges","archive_url":"https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/AngersZhuuuu/spark/downloads","issues_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/AngersZhuuuu/spark/labels{/name}","releases_url":"https://api.github.com/repos/AngersZhuuuu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/AngersZhuuuu/spark/deployments","created_at":"2019-03-18T07:13:25Z","updated_at":"2024-12-31T06:48:27Z","pushed_at":"2024-12-31T06:45:23Z","git_url":"git://github.com/AngersZhuuuu/spark.git","ssh_url":"git@github.com:AngersZhuuuu/spark.git","clone_url":"https://github.com/AngersZhuuuu/spark.git","svn_url":"https://github.com/AngersZhuuuu/spark","homepage":"","size":446399,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:branch-2.4","ref":"branch-2.4","sha":"76251c3e97dfeb9080de21ee3ab5188b6889f6e9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25179"},"html":{"href":"https://github.com/apache/spark/pull/25179"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25179"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25179/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25179/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25179/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5ecb8a761bfbe87cfc67934d773a33cc3a172580"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25178","id":298415232,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4NDE1MjMy","html_url":"https://github.com/apache/spark/pull/25178","diff_url":"https://github.com/apache/spark/pull/25178.diff","patch_url":"https://github.com/apache/spark/pull/25178.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25178","number":25178,"state":"closed","locked":false,"title":"[SPARK-28421][ML] SparseVector.apply performance optimization","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\noptimize the `SparseVector.apply` by avoiding internal conversion\r\nSince the speed up is significant (2.5X ~ 5X), and this method is widely used in ml, I suggest back porting.\r\n\r\n| size|  nnz | apply(old) | apply2(new impl) | apply3(new impl with extra range check)|\r\n|------|----------|------------|----------|----------|\r\n|10000000|100|75294|12208|18682|\r\n|10000000|10000|75616|23132|32932|\r\n|10000000|1000000|92949|42529|48821|\r\n\r\n## How was this patch tested?\r\nexisting tests\r\n\r\nusing following code to test performance (here the new impl is named `apply2`, and another impl with extra range check is named `apply3`):\r\n```\r\nimport scala.util.Random\r\nimport org.apache.spark.ml.linalg._\r\n\r\nval size = 10000000\r\nfor (nnz <- Seq(100, 10000, 1000000)) {\r\n\tval rng = new Random(123)\r\n\tval indices = Array.fill(nnz + nnz)(rng.nextInt.abs % size).distinct.take(nnz).sorted\r\n\tval values = Array.fill(nnz)(rng.nextDouble)\r\n\tval vec = Vectors.sparse(size, indices, values).toSparse\r\n\r\n\tval tic1 = System.currentTimeMillis;\r\n\t(0 until 100).foreach{ round => var i = 0; var sum = 0.0; while(i < size) {sum+=vec(i); i+=1} };\r\n\tval toc1 = System.currentTimeMillis;\r\n\r\n\tval tic2 = System.currentTimeMillis;\r\n\t(0 until 100).foreach{ round => var i = 0; var sum = 0.0; while(i < size) {sum+=vec.apply2(i); i+=1} };\r\n\tval toc2 = System.currentTimeMillis;\r\n\r\n\tval tic3 = System.currentTimeMillis;\r\n\t(0 until 100).foreach{ round => var i = 0; var sum = 0.0; while(i < size) {sum+=vec.apply3(i); i+=1} };\r\n\tval toc3 = System.currentTimeMillis;\r\n\t\r\n\tprintln((size, nnz, toc1 - tic1, toc2 - tic2, toc3 - tic3))\r\n}\r\n```","created_at":"2019-07-17T10:57:10Z","updated_at":"2019-07-26T01:32:53Z","closed_at":"2019-07-24T01:24:48Z","merged_at":null,"merge_commit_sha":"bd19a53a7f0014fbb74c82f9cb6af98974892809","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801475,"node_id":"MDU6TGFiZWwxNDA1ODAxNDc1","url":"https://api.github.com/repos/apache/spark/labels/ML","name":"ML","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25178/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25178/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25178/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/99dfe7e5639f30143fe8e164d80377c583cf4b33","head":{"label":"zhengruifeng:sparse_vec_apply","ref":"sparse_vec_apply","sha":"99dfe7e5639f30143fe8e164d80377c583cf4b33","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"66179fa8426324e11819e04af4cf3eabf9f2627f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25178"},"html":{"href":"https://github.com/apache/spark/pull/25178"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25178"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25178/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25178/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25178/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/99dfe7e5639f30143fe8e164d80377c583cf4b33"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25177","id":298328595,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4MzI4NTk1","html_url":"https://github.com/apache/spark/pull/25177","diff_url":"https://github.com/apache/spark/pull/25177.diff","patch_url":"https://github.com/apache/spark/pull/25177.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25177","number":25177,"state":"closed","locked":false,"title":"[SPARK-28418][PYTHON][SQL] Wait for event process in 'test_query_execution_listener_on_collect'","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nIt fixes a flaky test:\r\n\r\n```\r\nERROR [0.164s]: test_query_execution_listener_on_collect (pyspark.sql.tests.test_dataframe.QueryExecutionListenerTests)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/jenkins/python/pyspark/sql/tests/test_dataframe.py\", line 758, in test_query_execution_listener_on_collect\r\n    \"The callback from the query execution listener should be called after 'collect'\")\r\nAssertionError: The callback from the query execution listener should be called after 'collect'\r\n```\r\n\r\nSeems it can be failed because the event was somehow delayed but checked first.\r\n\r\n## How was this patch tested?\r\n\r\nManually.","created_at":"2019-07-17T06:44:18Z","updated_at":"2020-03-03T01:18:26Z","closed_at":"2019-07-17T09:49:13Z","merged_at":null,"merge_commit_sha":"f567572823b8925a3e918a1f8766fe6ad65e7925","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25177/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25177/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25177/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/74394ce254c1cf53ebe6192bfb560c328857dec3","head":{"label":"HyukjinKwon:SPARK-28418","ref":"SPARK-28418","sha":"74394ce254c1cf53ebe6192bfb560c328857dec3","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2ddeff97d7329942a98ef363991eeabc3fa71a76","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25177"},"html":{"href":"https://github.com/apache/spark/pull/25177"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25177"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25177/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25177/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25177/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/74394ce254c1cf53ebe6192bfb560c328857dec3"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25176","id":298230817,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4MjMwODE3","html_url":"https://github.com/apache/spark/pull/25176","diff_url":"https://github.com/apache/spark/pull/25176.diff","patch_url":"https://github.com/apache/spark/pull/25176.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25176","number":25176,"state":"closed","locked":false,"title":"[SPARK-28417][CORE] Wrap File Glob Resolution in DoAs to use ProxyUser Credentials","user":{"login":"modi95","id":6784567,"node_id":"MDQ6VXNlcjY3ODQ1Njc=","avatar_url":"https://avatars.githubusercontent.com/u/6784567?v=4","gravatar_id":"","url":"https://api.github.com/users/modi95","html_url":"https://github.com/modi95","followers_url":"https://api.github.com/users/modi95/followers","following_url":"https://api.github.com/users/modi95/following{/other_user}","gists_url":"https://api.github.com/users/modi95/gists{/gist_id}","starred_url":"https://api.github.com/users/modi95/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/modi95/subscriptions","organizations_url":"https://api.github.com/users/modi95/orgs","repos_url":"https://api.github.com/users/modi95/repos","events_url":"https://api.github.com/users/modi95/events{/privacy}","received_events_url":"https://api.github.com/users/modi95/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR addresses SPARK-28417 by wrapping the Glob file path resolution in a DoAs so that ProxyUser credentials are used for the glob resolution.\r\n\r\n## How was this patch tested?\r\n\r\nThis patch was tested using the existing unit tests and via manual testing. This was a bug encountered by Spark users at Uber. The bug was patched and is currently being used in prod at Uber. \r\n\r\n### Manual testing steps:\r\n\r\nI have two directories in HDFS - one containing sensitive data (persmissions: `700`) and one containing non sensitive data (permissions `755`):\r\n\r\n```\r\nmodi:~ hdfs dfs -ls -R /user/modi/testData\r\n\r\ndrwxr-xr-x   - modi modi          0 2019-07-17 02:43 /user/modi/testData/nonSensitiveData\r\n-rwxr-xr-x   3 modi modi          0 2019-07-17 02:43 /user/modi/testData/nonSensitiveData/file1.json\r\n-rwxr-xr-x   3 modi modi          0 2019-07-17 02:43 /user/modi/testData/nonSensitiveData/file2.json\r\n\r\ndrwx------   - modi modi          0 2019-07-17 02:44 /user/modi/testData/sensitiveData\r\n-rwx------   3 modi modi          0 2019-07-17 02:44 /user/modi/testData/sensitiveData/file1.json\r\n-rwx------   3 modi modi          0 2019-07-17 02:44 /user/modi/testData/sensitiveData/file2.json\r\n```\r\n\r\n1. Unpatched build with non sensitive data - executes as epected\r\n```\r\nservice_user:~ unpatched/bin/spark-submit --master yarn --deploy-mode cluster --proxy-user modi --files \"viewfs:///user/modi/testData/nonSensitiveData/file1.json,viewfs:///user/modi/testData/nonSensitiveData/file2.json\" viewfs:///user/modi/test-app.py\r\n```\r\n\r\n2. Unpatched build with sensitive data - fails with exception `Caused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=service_user, access=EXECUTE, inode=\"/user/modi/testData/sensitiveData\":modi:modi:drwx------`\r\n```\r\nservice_user:~ unpatched/bin/spark-submit --master yarn --deploy-mode cluster --proxy-user modi --files \"viewfs:///user/modi/testData/sensitiveData/file1.json,viewfs:///user/modi/testData/sensitiveData/file2.json\" viewfs:///user/modi/test-app.py\r\n```\r\n\r\n3. Patched build with nonn sensitive data - executes as epected.\r\n```\r\nservice_user:~ patched/bin/spark-submit --master yarn --deploy-mode cluster --proxy-user modi --files \"viewfs:///user/modi/testData/nonSensitiveData/file1.json,viewfs:///user/modi/testData/nonSensitiveData/file2.json\" viewfs:///user/modi/test-app.py\r\n```\r\n\r\n4. Patched build with sensitive data - executes as epected\r\n```\r\nservice_user:~ patched/bin/spark-submit --master yarn --deploy-mode cluster --proxy-user modi --files \"viewfs:///user/modi/testData/sensitiveData/file1.json,viewfs:///user/modi/testData/sensitiveData/file2.json\" viewfs:///user/modi/test-app.py\r\n```","created_at":"2019-07-16T22:01:49Z","updated_at":"2019-07-17T22:24:59Z","closed_at":"2019-07-17T22:24:59Z","merged_at":null,"merge_commit_sha":"c8343dcaa8c10719605818a305256b143b82ae14","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25176/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25176/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25176/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/770a733bc66c8ac681f373ede94574dabc1d4cfe","head":{"label":"modi95:SPARK-28417","ref":"SPARK-28417","sha":"770a733bc66c8ac681f373ede94574dabc1d4cfe","user":{"login":"modi95","id":6784567,"node_id":"MDQ6VXNlcjY3ODQ1Njc=","avatar_url":"https://avatars.githubusercontent.com/u/6784567?v=4","gravatar_id":"","url":"https://api.github.com/users/modi95","html_url":"https://github.com/modi95","followers_url":"https://api.github.com/users/modi95/followers","following_url":"https://api.github.com/users/modi95/following{/other_user}","gists_url":"https://api.github.com/users/modi95/gists{/gist_id}","starred_url":"https://api.github.com/users/modi95/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/modi95/subscriptions","organizations_url":"https://api.github.com/users/modi95/orgs","repos_url":"https://api.github.com/users/modi95/repos","events_url":"https://api.github.com/users/modi95/events{/privacy}","received_events_url":"https://api.github.com/users/modi95/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":197062746,"node_id":"MDEwOlJlcG9zaXRvcnkxOTcwNjI3NDY=","name":"spark","full_name":"modi95/spark","private":false,"owner":{"login":"modi95","id":6784567,"node_id":"MDQ6VXNlcjY3ODQ1Njc=","avatar_url":"https://avatars.githubusercontent.com/u/6784567?v=4","gravatar_id":"","url":"https://api.github.com/users/modi95","html_url":"https://github.com/modi95","followers_url":"https://api.github.com/users/modi95/followers","following_url":"https://api.github.com/users/modi95/following{/other_user}","gists_url":"https://api.github.com/users/modi95/gists{/gist_id}","starred_url":"https://api.github.com/users/modi95/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/modi95/subscriptions","organizations_url":"https://api.github.com/users/modi95/orgs","repos_url":"https://api.github.com/users/modi95/repos","events_url":"https://api.github.com/users/modi95/events{/privacy}","received_events_url":"https://api.github.com/users/modi95/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/modi95/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/modi95/spark","forks_url":"https://api.github.com/repos/modi95/spark/forks","keys_url":"https://api.github.com/repos/modi95/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/modi95/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/modi95/spark/teams","hooks_url":"https://api.github.com/repos/modi95/spark/hooks","issue_events_url":"https://api.github.com/repos/modi95/spark/issues/events{/number}","events_url":"https://api.github.com/repos/modi95/spark/events","assignees_url":"https://api.github.com/repos/modi95/spark/assignees{/user}","branches_url":"https://api.github.com/repos/modi95/spark/branches{/branch}","tags_url":"https://api.github.com/repos/modi95/spark/tags","blobs_url":"https://api.github.com/repos/modi95/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/modi95/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/modi95/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/modi95/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/modi95/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/modi95/spark/languages","stargazers_url":"https://api.github.com/repos/modi95/spark/stargazers","contributors_url":"https://api.github.com/repos/modi95/spark/contributors","subscribers_url":"https://api.github.com/repos/modi95/spark/subscribers","subscription_url":"https://api.github.com/repos/modi95/spark/subscription","commits_url":"https://api.github.com/repos/modi95/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/modi95/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/modi95/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/modi95/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/modi95/spark/contents/{+path}","compare_url":"https://api.github.com/repos/modi95/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/modi95/spark/merges","archive_url":"https://api.github.com/repos/modi95/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/modi95/spark/downloads","issues_url":"https://api.github.com/repos/modi95/spark/issues{/number}","pulls_url":"https://api.github.com/repos/modi95/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/modi95/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/modi95/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/modi95/spark/labels{/name}","releases_url":"https://api.github.com/repos/modi95/spark/releases{/id}","deployments_url":"https://api.github.com/repos/modi95/spark/deployments","created_at":"2019-07-15T19:51:01Z","updated_at":"2019-10-15T00:39:58Z","pushed_at":"2019-10-15T01:54:23Z","git_url":"git://github.com/modi95/spark.git","ssh_url":"git@github.com:modi95/spark.git","clone_url":"https://github.com/modi95/spark.git","svn_url":"https://github.com/modi95/spark","homepage":"","size":312818,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"43d68cd4ff84530c3d597f07352984225ab1db7c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25176"},"html":{"href":"https://github.com/apache/spark/pull/25176"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25176"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25176/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25176/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25176/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/770a733bc66c8ac681f373ede94574dabc1d4cfe"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25175","id":298217585,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4MjE3NTg1","html_url":"https://github.com/apache/spark/pull/25175","diff_url":"https://github.com/apache/spark/pull/25175.diff","patch_url":"https://github.com/apache/spark/pull/25175.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25175","number":25175,"state":"closed","locked":false,"title":"[SPARK-28411][PYTHON][SQL] InsertInto with overwrite is not honored","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nIn the following python code\r\n```\r\ndf.write.mode(\"overwrite\").insertInto(\"table\") \r\n```\r\n```insertInto``` ignores ```mode(\"overwrite\")```  and appends by default.\r\n\r\n\r\n## How was this patch tested?\r\n\r\nAdd Unit test.\r\n","created_at":"2019-07-16T21:26:54Z","updated_at":"2019-07-18T04:41:30Z","closed_at":"2019-07-18T04:41:30Z","merged_at":null,"merge_commit_sha":"5ab4cf233d8869bb87391010ba50977f94da8fc1","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25175/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25175/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25175/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9b167e10ce83df809af838e82bf6112595f65f17","head":{"label":"huaxingao:spark-28411","ref":"spark-28411","sha":"9b167e10ce83df809af838e82bf6112595f65f17","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":50813048,"node_id":"MDEwOlJlcG9zaXRvcnk1MDgxMzA0OA==","name":"spark","full_name":"huaxingao/spark","private":false,"owner":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/huaxingao/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/huaxingao/spark","forks_url":"https://api.github.com/repos/huaxingao/spark/forks","keys_url":"https://api.github.com/repos/huaxingao/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/huaxingao/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/huaxingao/spark/teams","hooks_url":"https://api.github.com/repos/huaxingao/spark/hooks","issue_events_url":"https://api.github.com/repos/huaxingao/spark/issues/events{/number}","events_url":"https://api.github.com/repos/huaxingao/spark/events","assignees_url":"https://api.github.com/repos/huaxingao/spark/assignees{/user}","branches_url":"https://api.github.com/repos/huaxingao/spark/branches{/branch}","tags_url":"https://api.github.com/repos/huaxingao/spark/tags","blobs_url":"https://api.github.com/repos/huaxingao/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/huaxingao/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/huaxingao/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/huaxingao/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/huaxingao/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/huaxingao/spark/languages","stargazers_url":"https://api.github.com/repos/huaxingao/spark/stargazers","contributors_url":"https://api.github.com/repos/huaxingao/spark/contributors","subscribers_url":"https://api.github.com/repos/huaxingao/spark/subscribers","subscription_url":"https://api.github.com/repos/huaxingao/spark/subscription","commits_url":"https://api.github.com/repos/huaxingao/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/huaxingao/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/huaxingao/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/huaxingao/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/huaxingao/spark/contents/{+path}","compare_url":"https://api.github.com/repos/huaxingao/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/huaxingao/spark/merges","archive_url":"https://api.github.com/repos/huaxingao/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/huaxingao/spark/downloads","issues_url":"https://api.github.com/repos/huaxingao/spark/issues{/number}","pulls_url":"https://api.github.com/repos/huaxingao/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/huaxingao/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/huaxingao/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/huaxingao/spark/labels{/name}","releases_url":"https://api.github.com/repos/huaxingao/spark/releases{/id}","deployments_url":"https://api.github.com/repos/huaxingao/spark/deployments","created_at":"2016-02-01T04:09:11Z","updated_at":"2022-01-06T22:35:11Z","pushed_at":"2023-12-21T02:21:07Z","git_url":"git://github.com/huaxingao/spark.git","ssh_url":"git@github.com:huaxingao/spark.git","clone_url":"https://github.com/huaxingao/spark.git","svn_url":"https://github.com/huaxingao/spark","homepage":null,"size":376946,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"43d68cd4ff84530c3d597f07352984225ab1db7c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25175"},"html":{"href":"https://github.com/apache/spark/pull/25175"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25175"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25175/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25175/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25175/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9b167e10ce83df809af838e82bf6112595f65f17"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25174","id":298213940,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4MjEzOTQw","html_url":"https://github.com/apache/spark/pull/25174","diff_url":"https://github.com/apache/spark/pull/25174.diff","patch_url":"https://github.com/apache/spark/pull/25174.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25174","number":25174,"state":"closed","locked":false,"title":"[SPARK-27485][BRANCH-2.4] EnsureRequirements.reorder should handle duplicate expressions gracefully","user":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"Backport of 421d9d56efd447d31787e77316ce0eafb5fe45a5\r\n\r\n## What changes were proposed in this pull request?\r\nWhen reordering joins EnsureRequirements only checks if all the join keys are present in the partitioning expression seq. This is problematic when the joins keys and and partitioning expressions both contain duplicates but not the same number of duplicates for each expression, e.g. `Seq(a, a, b)` vs `Seq(a, b, b)`. This fails with an index lookup failure in the `reorder` function.\r\n\r\nThis PR fixes this removing the equality checking logic from the `reorderJoinKeys` function, and by doing the multiset equality in the `reorder` function while building the reordered key sequences.\r\n\r\n## How was this patch tested?\r\nAdded a unit test to the `PlannerSuite` and added an integration test to `JoinSuite`","created_at":"2019-07-16T21:14:50Z","updated_at":"2019-07-17T01:02:27Z","closed_at":"2019-07-17T01:02:27Z","merged_at":null,"merge_commit_sha":"9fe7c89a591200266401997f78a47e6476d19455","assignee":null,"assignees":[],"requested_reviewers":[{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25174/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25174/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25174/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c3ae8c82e345d31320a1b754985d685259375861","head":{"label":"hvanhovell:SPARK-27485-2.4","ref":"SPARK-27485-2.4","sha":"c3ae8c82e345d31320a1b754985d685259375861","user":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":35900688,"node_id":"MDEwOlJlcG9zaXRvcnkzNTkwMDY4OA==","name":"spark","full_name":"hvanhovell/spark","private":false,"owner":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/hvanhovell/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/hvanhovell/spark","forks_url":"https://api.github.com/repos/hvanhovell/spark/forks","keys_url":"https://api.github.com/repos/hvanhovell/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/hvanhovell/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/hvanhovell/spark/teams","hooks_url":"https://api.github.com/repos/hvanhovell/spark/hooks","issue_events_url":"https://api.github.com/repos/hvanhovell/spark/issues/events{/number}","events_url":"https://api.github.com/repos/hvanhovell/spark/events","assignees_url":"https://api.github.com/repos/hvanhovell/spark/assignees{/user}","branches_url":"https://api.github.com/repos/hvanhovell/spark/branches{/branch}","tags_url":"https://api.github.com/repos/hvanhovell/spark/tags","blobs_url":"https://api.github.com/repos/hvanhovell/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/hvanhovell/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/hvanhovell/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/hvanhovell/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/hvanhovell/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/hvanhovell/spark/languages","stargazers_url":"https://api.github.com/repos/hvanhovell/spark/stargazers","contributors_url":"https://api.github.com/repos/hvanhovell/spark/contributors","subscribers_url":"https://api.github.com/repos/hvanhovell/spark/subscribers","subscription_url":"https://api.github.com/repos/hvanhovell/spark/subscription","commits_url":"https://api.github.com/repos/hvanhovell/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/hvanhovell/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/hvanhovell/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/hvanhovell/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/hvanhovell/spark/contents/{+path}","compare_url":"https://api.github.com/repos/hvanhovell/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/hvanhovell/spark/merges","archive_url":"https://api.github.com/repos/hvanhovell/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/hvanhovell/spark/downloads","issues_url":"https://api.github.com/repos/hvanhovell/spark/issues{/number}","pulls_url":"https://api.github.com/repos/hvanhovell/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/hvanhovell/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/hvanhovell/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/hvanhovell/spark/labels{/name}","releases_url":"https://api.github.com/repos/hvanhovell/spark/releases{/id}","deployments_url":"https://api.github.com/repos/hvanhovell/spark/deployments","created_at":"2015-05-19T18:29:31Z","updated_at":"2024-11-14T19:45:14Z","pushed_at":"2025-02-06T16:48:48Z","git_url":"git://github.com/hvanhovell/spark.git","ssh_url":"git@github.com:hvanhovell/spark.git","clone_url":"https://github.com/hvanhovell/spark.git","svn_url":"https://github.com/hvanhovell/spark","homepage":null,"size":447542,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:branch-2.4","ref":"branch-2.4","sha":"63898cbc1db46be8bcbb46d21fe01340bc883520","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25174"},"html":{"href":"https://github.com/apache/spark/pull/25174"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25174"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25174/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25174/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25174/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c3ae8c82e345d31320a1b754985d685259375861"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25173","id":298188436,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4MTg4NDM2","html_url":"https://github.com/apache/spark/pull/25173","diff_url":"https://github.com/apache/spark/pull/25173.diff","patch_url":"https://github.com/apache/spark/pull/25173.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25173","number":25173,"state":"closed","locked":false,"title":"[SPARK-28416][SQL] Use java.time API in timestampAddInterval","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe `DateTimeUtils.timestampAddInterval` method was rewritten by using Java 8 time API. To add months and microseconds, I used the `plusMonths()` and `plus()` methods of `ZonedDateTime`. Also the signature of `timestampAddInterval()` was changed to accept an `ZoneId` instance instead of `TimeZone`. Using `ZoneId` allows to avoid the conversion `TimeZone` -> `ZoneId` on every invoke of `timestampAddInterval()`.\r\n\r\n## How was this patch tested?\r\n\r\nBy existing test suites `DateExpressionsSuite`, `TypeCoercionSuite` and `CollectionExpressionsSuite`.","created_at":"2019-07-16T19:56:19Z","updated_at":"2019-09-18T15:58:17Z","closed_at":"2019-07-18T23:21:53Z","merged_at":null,"merge_commit_sha":"d19b1c7e9478b9558c18a11c18fa53781671fac5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25173/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25173/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25173/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9eaffa70bad926fb595e8b89f19b1649ae245477","head":{"label":"MaxGekk:timestamp-add-interval","ref":"timestamp-add-interval","sha":"9eaffa70bad926fb595e8b89f19b1649ae245477","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":123690489,"node_id":"MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=","name":"spark","full_name":"MaxGekk/spark","private":false,"owner":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/MaxGekk/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/MaxGekk/spark","forks_url":"https://api.github.com/repos/MaxGekk/spark/forks","keys_url":"https://api.github.com/repos/MaxGekk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/MaxGekk/spark/teams","hooks_url":"https://api.github.com/repos/MaxGekk/spark/hooks","issue_events_url":"https://api.github.com/repos/MaxGekk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/MaxGekk/spark/events","assignees_url":"https://api.github.com/repos/MaxGekk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/MaxGekk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/MaxGekk/spark/tags","blobs_url":"https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/MaxGekk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/MaxGekk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/MaxGekk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/MaxGekk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/MaxGekk/spark/languages","stargazers_url":"https://api.github.com/repos/MaxGekk/spark/stargazers","contributors_url":"https://api.github.com/repos/MaxGekk/spark/contributors","subscribers_url":"https://api.github.com/repos/MaxGekk/spark/subscribers","subscription_url":"https://api.github.com/repos/MaxGekk/spark/subscription","commits_url":"https://api.github.com/repos/MaxGekk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/MaxGekk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/MaxGekk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/MaxGekk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/MaxGekk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/MaxGekk/spark/merges","archive_url":"https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/MaxGekk/spark/downloads","issues_url":"https://api.github.com/repos/MaxGekk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/MaxGekk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/MaxGekk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/MaxGekk/spark/labels{/name}","releases_url":"https://api.github.com/repos/MaxGekk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/MaxGekk/spark/deployments","created_at":"2018-03-03T12:37:00Z","updated_at":"2025-02-07T09:44:52Z","pushed_at":"2025-02-07T09:44:24Z","git_url":"git://github.com/MaxGekk/spark.git","ssh_url":"git@github.com:MaxGekk/spark.git","clone_url":"https://github.com/MaxGekk/spark.git","svn_url":"https://github.com/MaxGekk/spark","homepage":null,"size":486456,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"43d68cd4ff84530c3d597f07352984225ab1db7c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25173"},"html":{"href":"https://github.com/apache/spark/pull/25173"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25173"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25173/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25173/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25173/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9eaffa70bad926fb595e8b89f19b1649ae245477"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25172","id":298001503,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk4MDAxNTAz","html_url":"https://github.com/apache/spark/pull/25172","diff_url":"https://github.com/apache/spark/pull/25172.diff","patch_url":"https://github.com/apache/spark/pull/25172.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25172","number":25172,"state":"closed","locked":false,"title":"[SPARK-28412][SQL] ANSI SQL: OVERLAY function support byte array","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis is a ANSI SQL and feature id is `T312`\r\n\r\n```\r\n<binary overlay function> ::=\r\nOVERLAY <left paren> <binary value expression> PLACING <binary value expression>\r\nFROM <start position> [ FOR <string length> ] <right paren>\r\n```\r\n\r\nThis PR related to https://github.com/apache/spark/pull/24918 and support treat byte array.\r\n\r\nref: https://www.postgresql.org/docs/11/functions-binarystring.html\r\n\r\n## How was this patch tested?\r\n\r\nnew UT.\r\nThere are some show of the PR on my production environment.\r\n```\r\nspark-sql> select overlay(encode('Spark SQL', 'utf-8') PLACING encode('_', 'utf-8') FROM 6);\r\nSpark_SQL\r\nTime taken: 0.285 s\r\nspark-sql> select overlay(encode('Spark SQL', 'utf-8') PLACING encode('CORE', 'utf-8') FROM 7);\r\nSpark CORE\r\nTime taken: 0.202 s\r\nspark-sql> select overlay(encode('Spark SQL', 'utf-8') PLACING encode('ANSI ', 'utf-8') FROM 7 FOR 0);\r\nSpark ANSI SQL\r\nTime taken: 0.165 s\r\nspark-sql> select overlay(encode('Spark SQL', 'utf-8') PLACING encode('tructured', 'utf-8') FROM 2 FOR 4);\r\nStructured SQL\r\nTime taken: 0.141 s\r\n```","created_at":"2019-07-16T11:42:28Z","updated_at":"2019-09-10T02:11:52Z","closed_at":"2019-09-09T23:18:38Z","merged_at":null,"merge_commit_sha":"2315c1545386f3b526faa47ec3ccb3137af4a1dd","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25172/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25172/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25172/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6201a3725036ee860f0d5c6d8b3053b79dbb1a62","head":{"label":"beliefer:ansi-overlay-byte-array","ref":"ansi-overlay-byte-array","sha":"6201a3725036ee860f0d5c6d8b3053b79dbb1a62","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"113f62dd8c6fb8e6f5c39a18c95af4cf95e334eb","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25172"},"html":{"href":"https://github.com/apache/spark/pull/25172"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25172"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25172/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25172/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25172/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6201a3725036ee860f0d5c6d8b3053b79dbb1a62"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25171","id":297971648,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3OTcxNjQ4","html_url":"https://github.com/apache/spark/pull/25171","diff_url":"https://github.com/apache/spark/pull/25171.diff","patch_url":"https://github.com/apache/spark/pull/25171.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25171","number":25171,"state":"closed","locked":false,"title":"[SPARK-27485][FOLLOWUP] Do not reduce the number of partitions for repartition in adaptive execution - fix compilation","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nPR builder failed with the following error:\r\n```\r\n[error] /home/jenkins/workspace/SparkPullRequestBuilder/sql/core/src/test/scala/org/apache/spark/sql/execution/PlannerSuite.scala:714: wrong number of arguments for pattern org.apache.spark.sql.execution.exchange.ShuffleExchangeExec(outputPartitioning: org.apache.spark.sql.catalyst.plans.physical.Partitioning,child: org.apache.spark.sql.execution.SparkPlan,canChangeNumPartitions: Boolean)\r\n[error]                ShuffleExchangeExec(HashPartitioning(leftPartitioningExpressions, _), _), _),\r\n[error]                                   ^\r\n[error] /home/jenkins/workspace/SparkPullRequestBuilder/sql/core/src/test/scala/org/apache/spark/sql/execution/PlannerSuite.scala:716: wrong number of arguments for pattern org.apache.spark.sql.execution.exchange.ShuffleExchangeExec(outputPartitioning: org.apache.spark.sql.catalyst.plans.physical.Partitioning,child: org.apache.spark.sql.execution.SparkPlan,canChangeNumPartitions: Boolean)\r\n[error]                ShuffleExchangeExec(HashPartitioning(rightPartitioningExpressions, _), _), _)) =>\r\n[error]                                   ^\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nExisting unit test.\r\n","created_at":"2019-07-16T10:17:00Z","updated_at":"2019-07-25T08:58:55Z","closed_at":"2019-07-16T11:00:31Z","merged_at":null,"merge_commit_sha":"301a09104ffe5d33b3ee475fba38b364ec297562","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25171/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25171/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25171/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b59a8814e9f6d8b1ce55bc561a729ebc721a851e","head":{"label":"gaborgsomogyi:SPARK-27485","ref":"SPARK-27485","sha":"b59a8814e9f6d8b1ce55bc561a729ebc721a851e","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":111547097,"node_id":"MDEwOlJlcG9zaXRvcnkxMTE1NDcwOTc=","name":"spark","full_name":"gaborgsomogyi/spark","private":false,"owner":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gaborgsomogyi/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gaborgsomogyi/spark","forks_url":"https://api.github.com/repos/gaborgsomogyi/spark/forks","keys_url":"https://api.github.com/repos/gaborgsomogyi/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gaborgsomogyi/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gaborgsomogyi/spark/teams","hooks_url":"https://api.github.com/repos/gaborgsomogyi/spark/hooks","issue_events_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gaborgsomogyi/spark/events","assignees_url":"https://api.github.com/repos/gaborgsomogyi/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gaborgsomogyi/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/tags","blobs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gaborgsomogyi/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gaborgsomogyi/spark/languages","stargazers_url":"https://api.github.com/repos/gaborgsomogyi/spark/stargazers","contributors_url":"https://api.github.com/repos/gaborgsomogyi/spark/contributors","subscribers_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscribers","subscription_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscription","commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gaborgsomogyi/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gaborgsomogyi/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gaborgsomogyi/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gaborgsomogyi/spark/merges","archive_url":"https://api.github.com/repos/gaborgsomogyi/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gaborgsomogyi/spark/downloads","issues_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gaborgsomogyi/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gaborgsomogyi/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gaborgsomogyi/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gaborgsomogyi/spark/labels{/name}","releases_url":"https://api.github.com/repos/gaborgsomogyi/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gaborgsomogyi/spark/deployments","created_at":"2017-11-21T12:38:03Z","updated_at":"2024-05-06T08:51:33Z","pushed_at":"2024-05-06T08:50:41Z","git_url":"git://github.com/gaborgsomogyi/spark.git","ssh_url":"git@github.com:gaborgsomogyi/spark.git","clone_url":"https://github.com/gaborgsomogyi/spark.git","svn_url":"https://github.com/gaborgsomogyi/spark","homepage":null,"size":416015,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"d1a137602954a9c48fad8df929699eb4fd0f57ce","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25171"},"html":{"href":"https://github.com/apache/spark/pull/25171"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25171"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25171/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25171/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25171/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b59a8814e9f6d8b1ce55bc561a729ebc721a851e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25170","id":297933844,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3OTMzODQ0","html_url":"https://github.com/apache/spark/pull/25170","diff_url":"https://github.com/apache/spark/pull/25170.diff","patch_url":"https://github.com/apache/spark/pull/25170.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25170","number":25170,"state":"closed","locked":false,"title":"[SPARK-28343][FOLLOW-UP][SQL][TEST] Enable spark.sql.function.preferIntegralDivision for PostgreSQL testing","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR enables `spark.sql.function.preferIntegralDivision` for PostgreSQL testing.\r\n\r\n## How was this patch tested?\r\n\r\nN/A\r\n","created_at":"2019-07-16T08:41:13Z","updated_at":"2019-07-25T08:58:32Z","closed_at":"2019-07-16T15:51:02Z","merged_at":null,"merge_commit_sha":"75ed93ad31ef9e0192112562f491d40c73c901f9","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25170/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25170/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25170/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9ec8e4b35064b3db36a46375aaaa09618775cbfd","head":{"label":"wangyum:SPARK-28343-2","ref":"SPARK-28343-2","sha":"9ec8e4b35064b3db36a46375aaaa09618775cbfd","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"9a7f01d94457aaaa99de86c4ef2bb9ba56f76f64","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25170"},"html":{"href":"https://github.com/apache/spark/pull/25170"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25170"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25170/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25170/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25170/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9ec8e4b35064b3db36a46375aaaa09618775cbfd"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25169","id":297894749,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3ODk0NzQ5","html_url":"https://github.com/apache/spark/pull/25169","diff_url":"https://github.com/apache/spark/pull/25169.diff","patch_url":"https://github.com/apache/spark/pull/25169.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25169","number":25169,"state":"closed","locked":false,"title":"[SPARK-21067][SQL] Initialize the HdfsEncryptionShim and the underlying FileSystem eagerly.","user":{"login":"xianyinxin","id":15028683,"node_id":"MDQ6VXNlcjE1MDI4Njgz","avatar_url":"https://avatars.githubusercontent.com/u/15028683?v=4","gravatar_id":"","url":"https://api.github.com/users/xianyinxin","html_url":"https://github.com/xianyinxin","followers_url":"https://api.github.com/users/xianyinxin/followers","following_url":"https://api.github.com/users/xianyinxin/following{/other_user}","gists_url":"https://api.github.com/users/xianyinxin/gists{/gist_id}","starred_url":"https://api.github.com/users/xianyinxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xianyinxin/subscriptions","organizations_url":"https://api.github.com/users/xianyinxin/orgs","repos_url":"https://api.github.com/users/xianyinxin/repos","events_url":"https://api.github.com/users/xianyinxin/events{/privacy}","received_events_url":"https://api.github.com/users/xianyinxin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n## What changes were proposed in this pull request?\r\n\r\nThis pr fix the \"Filesystem Closed\" exception that caused by the closing of a hive session in thriftserver.\r\n\r\nA `sessionState` holds a `hdfsEncryptionShim`, which holds a `fileSystem`. When a session was closed, the fileSystem may be closed. While the fileSystem is cached, so the subsequent using of the same fileSystem may throw \"Filesystem closed\" exception if previous session closes the fileSystem.\r\n\r\nWe can move the \"holding of the `fileSystem`\" from session to thriftserver by triggering `SessionState#getHdfsEncryptionShim` eagerly at the starting phase of the thriftserver, see below,\r\n\r\n```\r\nHiveThriftServer2#main()\r\n    hiveClientImpl\r\n        val state = newState\r\n            SessionState.start(state)\r\n                SessionState.setCurrentSession(state)\r\n        **state.getHdfsEncryptionShim**\r\n```\r\n\r\nIn hive session, the new sessionState will reuse the `fileSystem` created by thriftserver,\r\n\r\n```\r\nCliService\r\n    openSession\r\n        HiveSessionImpl\r\n            init\r\n                sessionState = new SessionState\r\n                SessionState.setCurrentSession(sessionState)\r\n            executeStatementInternal\r\n                SessionState.setCurrentSession(sessionState)\r\n                operation.run()\r\n                    hiveSession.getSessionManager().submitBackgroundOperation(operation)\r\n                    **// If some code calls \"state.getHdfsEncryptionShim\", the cached `fileSystem` is reused.**\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nmanual test\r\n\r\nPlease review https://spark.apache.org/contributing.html before opening a pull request.\r\n","created_at":"2019-07-16T06:35:55Z","updated_at":"2019-07-17T02:06:47Z","closed_at":"2019-07-17T01:30:40Z","merged_at":null,"merge_commit_sha":"cc3bf992dd12768987780bc5879214e676976f9c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25169/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25169/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25169/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/73c72d99e8273d5ab625f4d53217301553797c31","head":{"label":"xianyinxin:SPARK-21067-branch-2.4","ref":"SPARK-21067-branch-2.4","sha":"73c72d99e8273d5ab625f4d53217301553797c31","user":{"login":"xianyinxin","id":15028683,"node_id":"MDQ6VXNlcjE1MDI4Njgz","avatar_url":"https://avatars.githubusercontent.com/u/15028683?v=4","gravatar_id":"","url":"https://api.github.com/users/xianyinxin","html_url":"https://github.com/xianyinxin","followers_url":"https://api.github.com/users/xianyinxin/followers","following_url":"https://api.github.com/users/xianyinxin/following{/other_user}","gists_url":"https://api.github.com/users/xianyinxin/gists{/gist_id}","starred_url":"https://api.github.com/users/xianyinxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xianyinxin/subscriptions","organizations_url":"https://api.github.com/users/xianyinxin/orgs","repos_url":"https://api.github.com/users/xianyinxin/repos","events_url":"https://api.github.com/users/xianyinxin/events{/privacy}","received_events_url":"https://api.github.com/users/xianyinxin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":182274989,"node_id":"MDEwOlJlcG9zaXRvcnkxODIyNzQ5ODk=","name":"spark","full_name":"xianyinxin/spark","private":false,"owner":{"login":"xianyinxin","id":15028683,"node_id":"MDQ6VXNlcjE1MDI4Njgz","avatar_url":"https://avatars.githubusercontent.com/u/15028683?v=4","gravatar_id":"","url":"https://api.github.com/users/xianyinxin","html_url":"https://github.com/xianyinxin","followers_url":"https://api.github.com/users/xianyinxin/followers","following_url":"https://api.github.com/users/xianyinxin/following{/other_user}","gists_url":"https://api.github.com/users/xianyinxin/gists{/gist_id}","starred_url":"https://api.github.com/users/xianyinxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xianyinxin/subscriptions","organizations_url":"https://api.github.com/users/xianyinxin/orgs","repos_url":"https://api.github.com/users/xianyinxin/repos","events_url":"https://api.github.com/users/xianyinxin/events{/privacy}","received_events_url":"https://api.github.com/users/xianyinxin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xianyinxin/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/xianyinxin/spark","forks_url":"https://api.github.com/repos/xianyinxin/spark/forks","keys_url":"https://api.github.com/repos/xianyinxin/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xianyinxin/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xianyinxin/spark/teams","hooks_url":"https://api.github.com/repos/xianyinxin/spark/hooks","issue_events_url":"https://api.github.com/repos/xianyinxin/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xianyinxin/spark/events","assignees_url":"https://api.github.com/repos/xianyinxin/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xianyinxin/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xianyinxin/spark/tags","blobs_url":"https://api.github.com/repos/xianyinxin/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xianyinxin/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xianyinxin/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xianyinxin/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xianyinxin/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xianyinxin/spark/languages","stargazers_url":"https://api.github.com/repos/xianyinxin/spark/stargazers","contributors_url":"https://api.github.com/repos/xianyinxin/spark/contributors","subscribers_url":"https://api.github.com/repos/xianyinxin/spark/subscribers","subscription_url":"https://api.github.com/repos/xianyinxin/spark/subscription","commits_url":"https://api.github.com/repos/xianyinxin/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xianyinxin/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xianyinxin/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xianyinxin/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xianyinxin/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xianyinxin/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xianyinxin/spark/merges","archive_url":"https://api.github.com/repos/xianyinxin/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xianyinxin/spark/downloads","issues_url":"https://api.github.com/repos/xianyinxin/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xianyinxin/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xianyinxin/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xianyinxin/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xianyinxin/spark/labels{/name}","releases_url":"https://api.github.com/repos/xianyinxin/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xianyinxin/spark/deployments","created_at":"2019-04-19T14:13:19Z","updated_at":"2019-05-08T01:59:34Z","pushed_at":"2020-06-29T06:08:23Z","git_url":"git://github.com/xianyinxin/spark.git","ssh_url":"git@github.com:xianyinxin/spark.git","clone_url":"https://github.com/xianyinxin/spark.git","svn_url":"https://github.com/xianyinxin/spark","homepage":"","size":331024,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:branch-2.4","ref":"branch-2.4","sha":"c9c9eac110a98a06929447204c5afced4c28a792","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25169"},"html":{"href":"https://github.com/apache/spark/pull/25169"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25169"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25169/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25169/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25169/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/73c72d99e8273d5ab625f4d53217301553797c31"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25168","id":297874019,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3ODc0MDE5","html_url":"https://github.com/apache/spark/pull/25168","diff_url":"https://github.com/apache/spark/pull/25168.diff","patch_url":"https://github.com/apache/spark/pull/25168.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25168","number":25168,"state":"closed","locked":false,"title":"[SPARK-28276][SQL][PYTHON][TEST] Convert and port 'cross-join.sql' into UDF test base","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from `cross-join.sql'` to test UDFs.\r\n\r\n<details><summary>Diff comparing to 'cross-join.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/cross-join.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-cross-join.sql.out\r\nindex 3833c42bdf..11c1e01d54 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/cross-join.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-cross-join.sql.out\r\n@@ -43,7 +43,7 @@ two   2       two     22\r\n \r\n \r\n -- !query 3\r\n-SELECT * FROM nt1 cross join nt2 where nt1.k = nt2.k\r\n+SELECT * FROM nt1 cross join nt2 where udf(nt1.k) = udf(nt2.k)\r\n -- !query 3 schema\r\n struct<k:string,v1:int,k:string,v2:int>\r\n -- !query 3 output\r\n@@ -53,7 +53,7 @@ two   2       two     22\r\n \r\n \r\n -- !query 4\r\n-SELECT * FROM nt1 cross join nt2 on (nt1.k = nt2.k)\r\n+SELECT * FROM nt1 cross join nt2 on (udf(nt1.k) = udf(nt2.k))\r\n -- !query 4 schema\r\n struct<k:string,v1:int,k:string,v2:int>\r\n -- !query 4 output\r\n@@ -63,7 +63,7 @@ two   2       two     22\r\n \r\n \r\n -- !query 5\r\n-SELECT * FROM nt1 cross join nt2 where nt1.v1 = 1 and nt2.v2 = 22\r\n+SELECT * FROM nt1 cross join nt2 where udf(nt1.v1) = \"1\" and udf(nt2.v2) = \"22\"\r\n -- !query 5 schema\r\n struct<k:string,v1:int,k:string,v2:int>\r\n -- !query 5 output\r\n@@ -71,12 +71,12 @@ one 1       two     22\r\n \r\n \r\n-- !query 6\r\n-SELECT a.key, b.key FROM\r\n-(SELECT k key FROM nt1 WHERE v1 < 2) a\r\n+SELECT udf(a.key), udf(b.key) FROM\r\n+(SELECT udf(k) key FROM nt1 WHERE v1 < 2) a\r\n CROSS JOIN\r\n-(SELECT k key FROM nt2 WHERE v2 = 22) b\r\n+(SELECT udf(k) key FROM nt2 WHERE v2 = 22) b\r\n -- !query 6 schema\r\n-struct<key:string,key:string>\r\n+struct<udf(key):string,udf(key):string>\r\n -- !query 6 output\r\n one    two\r\n \r\n@@ -114,23 +114,29 @@ struct<>\r\n \r\n \r\n-- !query 11\r\n-select * from ((A join B on (a = b)) cross join C) join D on (a = d)\r\n+select * from ((A join B on (udf(a) = udf(b))) cross join C) join D on (udf(a) = udf(d))\r\n -- !query 11 schema\r\n-struct<a:string,va:int,b:string,vb:int,c:string,vc:int,d:string,vd:int>\r\n+struct<>\r\n -- !query 11 output\r\n-one    1       one     1       one     1       one     1\r\n-one    1       one     1       three   3       one     1\r\n-one    1       one     1       two     2       one     1\r\n-three  3       three   3       one     1       three   3\r\n-three  3       three   3       three   3       three   3\r\n-three  3       three   3       two     2       three   3\r\n-two    2       two     2       one     1       two     2\r\n-two    2       two     2       three   3       two     2\r\n-two    2       two     2       two     2       two     2\r\n+org.apache.spark.sql.AnalysisException\r\n+Detected implicit cartesian product for INNER join between logical plans\r\n+Filter (udf(a#x) = udf(b#x))\r\n++- Join Inner\r\n+   :- Project [k#x AS a#x, v1#x AS va#x]\r\n+   :  +- LocalRelation [k#x, v1#x]\r\n+   +- Project [k#x AS b#x, v1#x AS vb#x]\r\n+      +- LocalRelation [k#x, v1#x]\r\n+and\r\n+Project [k#x AS d#x, v1#x AS vd#x]\r\n++- LocalRelation [k#x, v1#x]\r\n+Join condition is missing or trivial.\r\n+Either: use the CROSS JOIN syntax to allow cartesian products between these\r\n+relations, or: enable implicit cartesian products by setting the configuration\r\n+variable spark.sql.crossJoin.enabled=true;\r\n \r\n \r\n -- !query 12\r\n-SELECT * FROM nt1 CROSS JOIN nt2 ON (nt1.k > nt2.k)\r\n+SELECT * FROM nt1 CROSS JOIN nt2 ON (udf(nt1.k) > udf(nt2.k))\r\n -- !query 12 schema\r\n struct<k:string,v1:int,k:string,v2:int>\r\n -- !query 12 output\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nAdded test.","created_at":"2019-07-16T04:54:31Z","updated_at":"2023-12-27T18:22:43Z","closed_at":"2019-07-18T10:50:52Z","merged_at":null,"merge_commit_sha":"dc6b5186c22ad4e32f0f03eba334b23dbc6d45f0","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25168/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25168/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25168/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0dbc98598ce5760c7f801434497a09a0f134fdbd","head":{"label":"viirya:SPARK-28276","ref":"SPARK-28276","sha":"0dbc98598ce5760c7f801434497a09a0f134fdbd","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"971e832e0eb720e346e9863ccfd41304d0f8f3dc","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25168"},"html":{"href":"https://github.com/apache/spark/pull/25168"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25168"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25168/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25168/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25168/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0dbc98598ce5760c7f801434497a09a0f134fdbd"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25167","id":297815261,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3ODE1MjYx","html_url":"https://github.com/apache/spark/pull/25167","diff_url":"https://github.com/apache/spark/pull/25167.diff","patch_url":"https://github.com/apache/spark/pull/25167.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25167","number":25167,"state":"closed","locked":false,"title":"[SPARK-27485] EnsureRequirements.reorder should handle duplicate expressions gracefully","user":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nWhen reordering joins EnsureRequirements only checks if all the join keys are present in the partitioning expression seq. This is problematic when the joins keys and and partitioning expressions both contain duplicates but not the same number of duplicates for each expression, e.g. `Seq(a, a, b)` vs `Seq(a, b, b)`. This fails with an index lookup failure in the `reorder` function.\r\n\r\nThis PR fixes this removing the equality checking logic from the `reorderJoinKeys` function, and by doing the multiset equality in the `reorder` function while building the reordered key sequences.\r\n\r\n## How was this patch tested?\r\nAdded a unit test to the `PlannerSuite` and added an integration test to `JoinSuite`","created_at":"2019-07-15T22:53:14Z","updated_at":"2019-07-17T11:07:46Z","closed_at":"2019-07-16T09:14:21Z","merged_at":null,"merge_commit_sha":"fbacccb009ca553a2ace058fcbe4b644517d8d62","assignee":null,"assignees":[],"requested_reviewers":[{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25167/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25167/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25167/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6f7868441a0af3bdb76f9ef120042dfe1fe85a82","head":{"label":"hvanhovell:SPARK-27485","ref":"SPARK-27485","sha":"6f7868441a0af3bdb76f9ef120042dfe1fe85a82","user":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":35900688,"node_id":"MDEwOlJlcG9zaXRvcnkzNTkwMDY4OA==","name":"spark","full_name":"hvanhovell/spark","private":false,"owner":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/hvanhovell/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/hvanhovell/spark","forks_url":"https://api.github.com/repos/hvanhovell/spark/forks","keys_url":"https://api.github.com/repos/hvanhovell/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/hvanhovell/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/hvanhovell/spark/teams","hooks_url":"https://api.github.com/repos/hvanhovell/spark/hooks","issue_events_url":"https://api.github.com/repos/hvanhovell/spark/issues/events{/number}","events_url":"https://api.github.com/repos/hvanhovell/spark/events","assignees_url":"https://api.github.com/repos/hvanhovell/spark/assignees{/user}","branches_url":"https://api.github.com/repos/hvanhovell/spark/branches{/branch}","tags_url":"https://api.github.com/repos/hvanhovell/spark/tags","blobs_url":"https://api.github.com/repos/hvanhovell/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/hvanhovell/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/hvanhovell/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/hvanhovell/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/hvanhovell/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/hvanhovell/spark/languages","stargazers_url":"https://api.github.com/repos/hvanhovell/spark/stargazers","contributors_url":"https://api.github.com/repos/hvanhovell/spark/contributors","subscribers_url":"https://api.github.com/repos/hvanhovell/spark/subscribers","subscription_url":"https://api.github.com/repos/hvanhovell/spark/subscription","commits_url":"https://api.github.com/repos/hvanhovell/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/hvanhovell/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/hvanhovell/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/hvanhovell/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/hvanhovell/spark/contents/{+path}","compare_url":"https://api.github.com/repos/hvanhovell/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/hvanhovell/spark/merges","archive_url":"https://api.github.com/repos/hvanhovell/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/hvanhovell/spark/downloads","issues_url":"https://api.github.com/repos/hvanhovell/spark/issues{/number}","pulls_url":"https://api.github.com/repos/hvanhovell/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/hvanhovell/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/hvanhovell/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/hvanhovell/spark/labels{/name}","releases_url":"https://api.github.com/repos/hvanhovell/spark/releases{/id}","deployments_url":"https://api.github.com/repos/hvanhovell/spark/deployments","created_at":"2015-05-19T18:29:31Z","updated_at":"2024-11-14T19:45:14Z","pushed_at":"2025-02-06T16:48:48Z","git_url":"git://github.com/hvanhovell/spark.git","ssh_url":"git@github.com:hvanhovell/spark.git","clone_url":"https://github.com/hvanhovell/spark.git","svn_url":"https://github.com/hvanhovell/spark","homepage":null,"size":447542,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"d8996fd94056948529bd9d6fca7a36fe91e85eae","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25167"},"html":{"href":"https://github.com/apache/spark/pull/25167"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25167"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25167/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25167/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25167/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6f7868441a0af3bdb76f9ef120042dfe1fe85a82"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25166","id":297792506,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NzkyNTA2","html_url":"https://github.com/apache/spark/pull/25166","diff_url":"https://github.com/apache/spark/pull/25166.diff","patch_url":"https://github.com/apache/spark/pull/25166.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25166","number":25166,"state":"closed","locked":false,"title":"[SPARK-28408][SQL][TEST] Restrict test values for DateType, TimestampType and CalendarIntervalType","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nExisting random generators in tests produce wide ranges of values that can be out of supported ranges for:\r\n- `DateType`, the valid range is `[0001-01-01, 9999-12-31]`\r\n- `TimestampType` supports values in `[0001-01-01T00:00:00.000000Z, 9999-12-31T23:59:59.999999Z]`\r\n- `CalendarIntervalType` should define intervals for the ranges above.\r\n\r\nDates and timestamps produced by random literal generators are usually out of valid ranges for those types. And tests just check invalid values or values caused by arithmetic overflow.\r\n\r\nIn the PR, I propose to restrict tested pseudo-random values by valid ranges of `DateType`, `TimestampType` and `CalendarIntervalType`. This should allow to check valid values in test, and avoid wasting time on a priori invalid inputs. \r\n\r\n## How was this patch tested?\r\n\r\nThe changes were checked by `DateExpressionsSuite` and modified `DateTimeUtils.dateAddMonths`:\r\n```Scala\r\n  def dateAddMonths(days: SQLDate, months: Int): SQLDate = {\r\n    localDateToDays(LocalDate.ofEpochDay(days).plusMonths(months))\r\n  }\r\n```\r\n","created_at":"2019-07-15T21:22:08Z","updated_at":"2019-09-18T15:58:16Z","closed_at":"2019-07-16T03:47:11Z","merged_at":null,"merge_commit_sha":"e243efb564f61d5a19b20839b49f9233f788a45f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25166/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25166/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25166/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c4cea83a8e30507177e53dbbe164cd7b6193d3c6","head":{"label":"MaxGekk:datetime-lit-random-gen","ref":"datetime-lit-random-gen","sha":"c4cea83a8e30507177e53dbbe164cd7b6193d3c6","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":123690489,"node_id":"MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=","name":"spark","full_name":"MaxGekk/spark","private":false,"owner":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/MaxGekk/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/MaxGekk/spark","forks_url":"https://api.github.com/repos/MaxGekk/spark/forks","keys_url":"https://api.github.com/repos/MaxGekk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/MaxGekk/spark/teams","hooks_url":"https://api.github.com/repos/MaxGekk/spark/hooks","issue_events_url":"https://api.github.com/repos/MaxGekk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/MaxGekk/spark/events","assignees_url":"https://api.github.com/repos/MaxGekk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/MaxGekk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/MaxGekk/spark/tags","blobs_url":"https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/MaxGekk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/MaxGekk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/MaxGekk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/MaxGekk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/MaxGekk/spark/languages","stargazers_url":"https://api.github.com/repos/MaxGekk/spark/stargazers","contributors_url":"https://api.github.com/repos/MaxGekk/spark/contributors","subscribers_url":"https://api.github.com/repos/MaxGekk/spark/subscribers","subscription_url":"https://api.github.com/repos/MaxGekk/spark/subscription","commits_url":"https://api.github.com/repos/MaxGekk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/MaxGekk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/MaxGekk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/MaxGekk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/MaxGekk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/MaxGekk/spark/merges","archive_url":"https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/MaxGekk/spark/downloads","issues_url":"https://api.github.com/repos/MaxGekk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/MaxGekk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/MaxGekk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/MaxGekk/spark/labels{/name}","releases_url":"https://api.github.com/repos/MaxGekk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/MaxGekk/spark/deployments","created_at":"2018-03-03T12:37:00Z","updated_at":"2025-02-07T09:44:52Z","pushed_at":"2025-02-07T09:44:24Z","git_url":"git://github.com/MaxGekk/spark.git","ssh_url":"git@github.com:MaxGekk/spark.git","clone_url":"https://github.com/MaxGekk/spark.git","svn_url":"https://github.com/MaxGekk/spark","homepage":null,"size":486456,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"d8996fd94056948529bd9d6fca7a36fe91e85eae","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25166"},"html":{"href":"https://github.com/apache/spark/pull/25166"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25166"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25166/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25166/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25166/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c4cea83a8e30507177e53dbbe164cd7b6193d3c6"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25165","id":297744569,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NzQ0NTY5","html_url":"https://github.com/apache/spark/pull/25165","diff_url":"https://github.com/apache/spark/pull/25165.diff","patch_url":"https://github.com/apache/spark/pull/25165.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25165","number":25165,"state":"closed","locked":false,"title":"[SPARK-28201][SQL][TEST][FOLLOWUP] Fix Integration test suite according to the new exception message","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n#25010 breaks the integration test suite due to the changing the user-facing exception like the following. This PR fixes the integration test suite.\r\n\r\n```scala\r\n-    require(\r\n-      decimalVal.precision <= precision,\r\n-      s\"Decimal precision ${decimalVal.precision} exceeds max precision $precision\")\r\n+    if (decimalVal.precision > precision) {\r\n+      throw new ArithmeticException(\r\n+        s\"Decimal precision ${decimalVal.precision} exceeds max precision $precision\")\r\n+    }\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nManual test.\r\n```\r\n$ build/mvn install -DskipTests\r\n$ build/mvn -Pdocker-integration-tests -pl :spark-docker-integration-tests_2.12 test\r\n```","created_at":"2019-07-15T18:53:54Z","updated_at":"2019-07-16T15:41:50Z","closed_at":"2019-07-16T08:07:18Z","merged_at":null,"merge_commit_sha":"3b977f4fc2fda097d01133c1e8a5fd2b317bfc3d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25165/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25165/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25165/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a822c713f5ac9fcca9001b22ea43e3fa792cf367","head":{"label":"dongjoon-hyun:SPARK-28201","ref":"SPARK-28201","sha":"a822c713f5ac9fcca9001b22ea43e3fa792cf367","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"8f7ccc5e9c8be723947947c4130a48781bf6e355","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25165"},"html":{"href":"https://github.com/apache/spark/pull/25165"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25165"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25165/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25165/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25165/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a822c713f5ac9fcca9001b22ea43e3fa792cf367"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25164","id":297715014,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NzE1MDE0","html_url":"https://github.com/apache/spark/pull/25164","diff_url":"https://github.com/apache/spark/pull/25164.diff","patch_url":"https://github.com/apache/spark/pull/25164.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25164","number":25164,"state":"closed","locked":false,"title":"[SPARK-28375][SQL] Prevent the PullupCorrelatedPredicates optimizer rule from removing predicates if run multiple times","user":{"login":"yeshengm","id":12269969,"node_id":"MDQ6VXNlcjEyMjY5OTY5","avatar_url":"https://avatars.githubusercontent.com/u/12269969?v=4","gravatar_id":"","url":"https://api.github.com/users/yeshengm","html_url":"https://github.com/yeshengm","followers_url":"https://api.github.com/users/yeshengm/followers","following_url":"https://api.github.com/users/yeshengm/following{/other_user}","gists_url":"https://api.github.com/users/yeshengm/gists{/gist_id}","starred_url":"https://api.github.com/users/yeshengm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeshengm/subscriptions","organizations_url":"https://api.github.com/users/yeshengm/orgs","repos_url":"https://api.github.com/users/yeshengm/repos","events_url":"https://api.github.com/users/yeshengm/events{/privacy}","received_events_url":"https://api.github.com/users/yeshengm/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe original implementation of `PullupCorrelatedPredicates` can remove predicates in subqueries if the rule is run multiple times. This fix resolves this issue by appending new predicates to existing predicates from the last run.\r\n\r\n## How was this patch tested?\r\nA new UT.\r\n","created_at":"2019-07-15T17:24:11Z","updated_at":"2019-07-26T22:15:04Z","closed_at":"2019-07-17T17:37:36Z","merged_at":null,"merge_commit_sha":"8cc570070e1fd06a1b5b7b8c172c09e5c359d0bb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25164/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25164/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25164/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/4d405f62b843f84aa2ba2049df2b6a3f9b01f476","head":{"label":"yeshengm:once-pullup-correlated-expr","ref":"once-pullup-correlated-expr","sha":"4d405f62b843f84aa2ba2049df2b6a3f9b01f476","user":{"login":"yeshengm","id":12269969,"node_id":"MDQ6VXNlcjEyMjY5OTY5","avatar_url":"https://avatars.githubusercontent.com/u/12269969?v=4","gravatar_id":"","url":"https://api.github.com/users/yeshengm","html_url":"https://github.com/yeshengm","followers_url":"https://api.github.com/users/yeshengm/followers","following_url":"https://api.github.com/users/yeshengm/following{/other_user}","gists_url":"https://api.github.com/users/yeshengm/gists{/gist_id}","starred_url":"https://api.github.com/users/yeshengm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeshengm/subscriptions","organizations_url":"https://api.github.com/users/yeshengm/orgs","repos_url":"https://api.github.com/users/yeshengm/repos","events_url":"https://api.github.com/users/yeshengm/events{/privacy}","received_events_url":"https://api.github.com/users/yeshengm/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":187889692,"node_id":"MDEwOlJlcG9zaXRvcnkxODc4ODk2OTI=","name":"spark","full_name":"yeshengm/spark","private":false,"owner":{"login":"yeshengm","id":12269969,"node_id":"MDQ6VXNlcjEyMjY5OTY5","avatar_url":"https://avatars.githubusercontent.com/u/12269969?v=4","gravatar_id":"","url":"https://api.github.com/users/yeshengm","html_url":"https://github.com/yeshengm","followers_url":"https://api.github.com/users/yeshengm/followers","following_url":"https://api.github.com/users/yeshengm/following{/other_user}","gists_url":"https://api.github.com/users/yeshengm/gists{/gist_id}","starred_url":"https://api.github.com/users/yeshengm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeshengm/subscriptions","organizations_url":"https://api.github.com/users/yeshengm/orgs","repos_url":"https://api.github.com/users/yeshengm/repos","events_url":"https://api.github.com/users/yeshengm/events{/privacy}","received_events_url":"https://api.github.com/users/yeshengm/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yeshengm/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/yeshengm/spark","forks_url":"https://api.github.com/repos/yeshengm/spark/forks","keys_url":"https://api.github.com/repos/yeshengm/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yeshengm/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yeshengm/spark/teams","hooks_url":"https://api.github.com/repos/yeshengm/spark/hooks","issue_events_url":"https://api.github.com/repos/yeshengm/spark/issues/events{/number}","events_url":"https://api.github.com/repos/yeshengm/spark/events","assignees_url":"https://api.github.com/repos/yeshengm/spark/assignees{/user}","branches_url":"https://api.github.com/repos/yeshengm/spark/branches{/branch}","tags_url":"https://api.github.com/repos/yeshengm/spark/tags","blobs_url":"https://api.github.com/repos/yeshengm/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yeshengm/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yeshengm/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/yeshengm/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yeshengm/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/yeshengm/spark/languages","stargazers_url":"https://api.github.com/repos/yeshengm/spark/stargazers","contributors_url":"https://api.github.com/repos/yeshengm/spark/contributors","subscribers_url":"https://api.github.com/repos/yeshengm/spark/subscribers","subscription_url":"https://api.github.com/repos/yeshengm/spark/subscription","commits_url":"https://api.github.com/repos/yeshengm/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/yeshengm/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/yeshengm/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/yeshengm/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/yeshengm/spark/contents/{+path}","compare_url":"https://api.github.com/repos/yeshengm/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yeshengm/spark/merges","archive_url":"https://api.github.com/repos/yeshengm/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yeshengm/spark/downloads","issues_url":"https://api.github.com/repos/yeshengm/spark/issues{/number}","pulls_url":"https://api.github.com/repos/yeshengm/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/yeshengm/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/yeshengm/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yeshengm/spark/labels{/name}","releases_url":"https://api.github.com/repos/yeshengm/spark/releases{/id}","deployments_url":"https://api.github.com/repos/yeshengm/spark/deployments","created_at":"2019-05-21T18:06:45Z","updated_at":"2019-06-10T23:01:04Z","pushed_at":"2022-02-09T05:43:22Z","git_url":"git://github.com/yeshengm/spark.git","ssh_url":"git@github.com:yeshengm/spark.git","clone_url":"https://github.com/yeshengm/spark.git","svn_url":"https://github.com/yeshengm/spark","homepage":"","size":390452,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"43d68cd4ff84530c3d597f07352984225ab1db7c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25164"},"html":{"href":"https://github.com/apache/spark/pull/25164"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25164"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25164/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25164/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25164/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/4d405f62b843f84aa2ba2049df2b6a3f9b01f476"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25163","id":297683078,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NjgzMDc4","html_url":"https://github.com/apache/spark/pull/25163","diff_url":"https://github.com/apache/spark/pull/25163.diff","patch_url":"https://github.com/apache/spark/pull/25163.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25163","number":25163,"state":"closed","locked":false,"title":"[SPARK-28406][SQL][TEST] Port union.sql","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR is to port union.sql from PostgreSQL regression tests. https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/sql/union.sql\r\n\r\nThe expected results can be found in the link: https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/expected/union.out\r\n\r\nWhen porting the test cases, found four PostgreSQL specific features that do not exist in Spark SQL:\r\n[SPARK-28409](https://issues.apache.org/jira/browse/SPARK-28409): SELECT FROM syntax\r\n[SPARK-28298](https://issues.apache.org/jira/browse/SPARK-28298): Fully support char and varchar types\r\n[SPARK-28557](https://issues.apache.org/jira/browse/SPARK-28557): Support empty select list\r\n[SPARK-27767](https://issues.apache.org/jira/browse/SPARK-27767): Built-in function: generate_series\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-15T15:51:26Z","updated_at":"2019-07-30T07:20:18Z","closed_at":"2019-07-30T07:18:44Z","merged_at":null,"merge_commit_sha":"3e10a68c74013552e564c2a5042cabbe20a7ded0","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25163/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25163/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25163/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3e0dce328998fe4e29d633c662819674e230e228","head":{"label":"wangyum:SPARK-28406","ref":"SPARK-28406","sha":"3e0dce328998fe4e29d633c662819674e230e228","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"196a4d7117b122fdb1fc95241613d012e8292734","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25163"},"html":{"href":"https://github.com/apache/spark/pull/25163"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25163"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25163/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25163/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25163/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3e0dce328998fe4e29d633c662819674e230e228"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25162","id":297657167,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NjU3MTY3","html_url":"https://github.com/apache/spark/pull/25162","diff_url":"https://github.com/apache/spark/pull/25162.diff","patch_url":"https://github.com/apache/spark/pull/25162.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25162","number":25162,"state":"closed","locked":false,"title":"[SPARK-28404][SS] Fix negative timeout value in RateStreamContinuousPartitionReader","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n`System.currentTimeMillis` read two times in a loop in `RateStreamContinuousPartitionReader`. If the test machine is slow enough and it spends quite some time between the `while` condition check and the `Thread.sleep` then the timeout value is negative and throws `IllegalArgumentException`.\r\n\r\nIn this PR I've fixed this issue.\r\n\r\n## How was this patch tested?\r\n\r\nExisting unit tests.\r\n","created_at":"2019-07-15T14:50:02Z","updated_at":"2019-07-15T22:01:30Z","closed_at":"2019-07-15T18:05:26Z","merged_at":null,"merge_commit_sha":"3ef9bf75407f43c3180f95892263282de15a9862","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25162/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25162/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25162/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/28208cbb64fb1871965da79c74a81cf3ecdabcb3","head":{"label":"gaborgsomogyi:SPARK-28404","ref":"SPARK-28404","sha":"28208cbb64fb1871965da79c74a81cf3ecdabcb3","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":111547097,"node_id":"MDEwOlJlcG9zaXRvcnkxMTE1NDcwOTc=","name":"spark","full_name":"gaborgsomogyi/spark","private":false,"owner":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gaborgsomogyi/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gaborgsomogyi/spark","forks_url":"https://api.github.com/repos/gaborgsomogyi/spark/forks","keys_url":"https://api.github.com/repos/gaborgsomogyi/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gaborgsomogyi/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gaborgsomogyi/spark/teams","hooks_url":"https://api.github.com/repos/gaborgsomogyi/spark/hooks","issue_events_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gaborgsomogyi/spark/events","assignees_url":"https://api.github.com/repos/gaborgsomogyi/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gaborgsomogyi/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/tags","blobs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gaborgsomogyi/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gaborgsomogyi/spark/languages","stargazers_url":"https://api.github.com/repos/gaborgsomogyi/spark/stargazers","contributors_url":"https://api.github.com/repos/gaborgsomogyi/spark/contributors","subscribers_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscribers","subscription_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscription","commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gaborgsomogyi/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gaborgsomogyi/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gaborgsomogyi/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gaborgsomogyi/spark/merges","archive_url":"https://api.github.com/repos/gaborgsomogyi/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gaborgsomogyi/spark/downloads","issues_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gaborgsomogyi/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gaborgsomogyi/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gaborgsomogyi/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gaborgsomogyi/spark/labels{/name}","releases_url":"https://api.github.com/repos/gaborgsomogyi/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gaborgsomogyi/spark/deployments","created_at":"2017-11-21T12:38:03Z","updated_at":"2024-05-06T08:51:33Z","pushed_at":"2024-05-06T08:50:41Z","git_url":"git://github.com/gaborgsomogyi/spark.git","ssh_url":"git@github.com:gaborgsomogyi/spark.git","clone_url":"https://github.com/gaborgsomogyi/spark.git","svn_url":"https://github.com/gaborgsomogyi/spark","homepage":null,"size":416015,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"8ecbb67b3b29bb4fffa5863de3a82921ddf20bb3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25162"},"html":{"href":"https://github.com/apache/spark/pull/25162"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25162"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25162/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25162/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25162/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/28208cbb64fb1871965da79c74a81cf3ecdabcb3"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25161","id":297600593,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NjAwNTkz","html_url":"https://github.com/apache/spark/pull/25161","diff_url":"https://github.com/apache/spark/pull/25161.diff","patch_url":"https://github.com/apache/spark/pull/25161.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25161","number":25161,"state":"closed","locked":false,"title":"[SPARK-28390][SQL][PYTHON][TESTS] Convert and port 'pgSQL/select_having.sql' into UDF test base","user":{"login":"shivusondur","id":7912929,"node_id":"MDQ6VXNlcjc5MTI5Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/7912929?v=4","gravatar_id":"","url":"https://api.github.com/users/shivusondur","html_url":"https://github.com/shivusondur","followers_url":"https://api.github.com/users/shivusondur/followers","following_url":"https://api.github.com/users/shivusondur/following{/other_user}","gists_url":"https://api.github.com/users/shivusondur/gists{/gist_id}","starred_url":"https://api.github.com/users/shivusondur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivusondur/subscriptions","organizations_url":"https://api.github.com/users/shivusondur/orgs","repos_url":"https://api.github.com/users/shivusondur/repos","events_url":"https://api.github.com/users/shivusondur/events{/privacy}","received_events_url":"https://api.github.com/users/shivusondur/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nchanged the test according to steps mentioned in SPARK-27921\r\n\r\n<details>\r\n<summary>difference comparing to select_having.sql</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/pgSQL/select_having.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-select_having.sql.out\r\nindex 02536eb..f731d11 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/pgSQL/select_having.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-select_having.sql.out\r\n@@ -91,54 +91,54 @@ struct<>\r\n \r\n \r\n -- !query 11\r\n-SELECT b, c FROM test_having\r\n-\tGROUP BY b, c HAVING count(*) = 1 ORDER BY b, c\r\n+SELECT udf(b), udf(c) FROM test_having\r\n+\tGROUP BY b, c HAVING udf(count(*)) = 1 ORDER BY udf(b), udf(c)\r\n -- !query 11 schema\r\n-struct<b:int,c:string>\r\n+struct<CAST(udf(cast(b as string)) AS INT):int,CAST(udf(cast(c as string)) AS STRING):string>\r\n -- !query 11 output\r\n 1\tXXXX\r\n 3\tbbbb\r\n \r\n \r\n -- !query 12\r\n-SELECT b, c FROM test_having\r\n-\tGROUP BY b, c HAVING b = 3 ORDER BY b, c\r\n+SELECT udf(b), udf(c) FROM test_having\r\n+\tGROUP BY b, c HAVING udf(b) = 3 ORDER BY udf(b), udf(c)\r\n -- !query 12 schema\r\n-struct<b:int,c:string>\r\n+struct<CAST(udf(cast(b as string)) AS INT):int,CAST(udf(cast(c as string)) AS STRING):string>\r\n -- !query 12 output\r\n 3\tBBBB\r\n 3\tbbbb\r\n \r\n \r\n -- !query 13\r\n-SELECT c, max(a) FROM test_having\r\n-\tGROUP BY c HAVING count(*) > 2 OR min(a) = max(a)\r\n+SELECT udf(c), max(udf(a)) FROM test_having\r\n+\tGROUP BY c HAVING udf(count(*)) > 2 OR udf(min(a)) = udf(max(a))\r\n \tORDER BY c\r\n -- !query 13 schema\r\n-struct<c:string,max(a):int>\r\n+struct<CAST(udf(cast(c as string)) AS STRING):string,max(CAST(udf(cast(a as string)) AS INT)):int>\r\n -- !query 13 output\r\n XXXX\t0\r\n bbbb\t5\r\n \r\n \r\n -- !query 14\r\n-SELECT min(a), max(a) FROM test_having HAVING min(a) = max(a)\r\n+SELECT udf(udf(min(udf(a)))), udf(udf(max(udf(a)))) FROM test_having HAVING udf(udf(min(udf(a)))) = udf(udf(max(udf(a))))\r\n -- !query 14 schema\r\n-struct<min(a):int,max(a):int>\r\n+struct<CAST(udf(cast(cast(udf(cast(min(cast(udf(cast(a as string)) as int)) as string)) as int) as string)) AS INT):int,CAST(udf(cast(cast(udf(cast(max(cast(udf(cast(a as string)) as int)) as string)) as int) as string)) AS INT):int>\r\n -- !query 14 output\r\n \r\n \r\n \r\n -- !query 15\r\n-SELECT min(a), max(a) FROM test_having HAVING min(a) < max(a)\r\n+SELECT udf(min(udf(a))), udf(udf(max(a))) FROM test_having HAVING udf(min(a)) < udf(max(udf(a)))\r\n -- !query 15 schema\r\n-struct<min(a):int,max(a):int>\r\n+struct<CAST(udf(cast(min(cast(udf(cast(a as string)) as int)) as string)) AS INT):int,CAST(udf(cast(cast(udf(cast(max(a) as string)) as int) as string)) AS INT):int>\r\n -- !query 15 output\r\n 0\t9\r\n \r\n \r\n -- !query 16\r\n-SELECT a FROM test_having HAVING min(a) < max(a)\r\n+SELECT udf(a) FROM test_having HAVING udf(min(a)) < udf(max(a))\r\n -- !query 16 schema\r\n struct<>\r\n -- !query 16 output\r\n@@ -147,16 +147,16 @@ grouping expressions sequence is empty, and 'default.test_having.`a`' is not an\r\n \r\n \r\n -- !query 17\r\n-SELECT 1 AS one FROM test_having HAVING a > 1\r\n+SELECT 1 AS one FROM test_having HAVING udf(a) > 1\r\n -- !query 17 schema\r\n struct<>\r\n -- !query 17 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve '`a`' given input columns: [one]; line 1 pos 40\r\n+cannot resolve '`a`' given input columns: [one]; line 1 pos 44\r\n \r\n \r\n -- !query 18\r\n-SELECT 1 AS one FROM test_having HAVING 1 > 2\r\n+SELECT 1 AS one FROM test_having HAVING udf(udf(1) > udf(2))\r\n -- !query 18 schema\r\n struct<one:int>\r\n -- !query 18 output\r\n@@ -164,7 +164,7 @@ struct<one:int>\r\n \r\n \r\n -- !query 19\r\n-SELECT 1 AS one FROM test_having HAVING 1 < 2\r\n+SELECT 1 AS one FROM test_having HAVING udf(udf(1) < udf(2))\r\n -- !query 19 schema\r\n struct<one:int>\r\n -- !query 19 output\r\n@@ -172,7 +172,7 @@ struct<one:int>\r\n \r\n \r\n -- !query 20\r\n-SELECT 1 AS one FROM test_having WHERE 1/a = 1 HAVING 1 < 2\r\n+SELECT 1 AS one FROM test_having WHERE 1/udf(a) = 1 HAVING 1 < 2\r\n -- !query 20 schema\r\n struct<one:int>\r\n -- !query 20 output\r\n```\r\n</p>\r\n</details>\r\n\r\n\r\n## How was this patch tested?\r\nby:\r\n\r\n```bash\r\nsudo SPARK_GENERATE_GOLDEN_FILES=1 build/sbt \"sql/test-only *SQLQueryTestSuite -- -z udf/pgSQL/udf-select_having.sql\"\r\n```","created_at":"2019-07-15T12:37:29Z","updated_at":"2019-07-24T05:48:10Z","closed_at":"2019-07-24T05:48:10Z","merged_at":null,"merge_commit_sha":"a53ed9827f045cac8ae4b71deb3c081312240838","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25161/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25161/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25161/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8795d66b189712f54a55a3b0663273fb26126a8e","head":{"label":"shivusondur:jira28390","ref":"jira28390","sha":"8795d66b189712f54a55a3b0663273fb26126a8e","user":{"login":"shivusondur","id":7912929,"node_id":"MDQ6VXNlcjc5MTI5Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/7912929?v=4","gravatar_id":"","url":"https://api.github.com/users/shivusondur","html_url":"https://github.com/shivusondur","followers_url":"https://api.github.com/users/shivusondur/followers","following_url":"https://api.github.com/users/shivusondur/following{/other_user}","gists_url":"https://api.github.com/users/shivusondur/gists{/gist_id}","starred_url":"https://api.github.com/users/shivusondur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivusondur/subscriptions","organizations_url":"https://api.github.com/users/shivusondur/orgs","repos_url":"https://api.github.com/users/shivusondur/repos","events_url":"https://api.github.com/users/shivusondur/events{/privacy}","received_events_url":"https://api.github.com/users/shivusondur/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":38364630,"node_id":"MDEwOlJlcG9zaXRvcnkzODM2NDYzMA==","name":"spark","full_name":"shivusondur/spark","private":false,"owner":{"login":"shivusondur","id":7912929,"node_id":"MDQ6VXNlcjc5MTI5Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/7912929?v=4","gravatar_id":"","url":"https://api.github.com/users/shivusondur","html_url":"https://github.com/shivusondur","followers_url":"https://api.github.com/users/shivusondur/followers","following_url":"https://api.github.com/users/shivusondur/following{/other_user}","gists_url":"https://api.github.com/users/shivusondur/gists{/gist_id}","starred_url":"https://api.github.com/users/shivusondur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivusondur/subscriptions","organizations_url":"https://api.github.com/users/shivusondur/orgs","repos_url":"https://api.github.com/users/shivusondur/repos","events_url":"https://api.github.com/users/shivusondur/events{/privacy}","received_events_url":"https://api.github.com/users/shivusondur/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/shivusondur/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/shivusondur/spark","forks_url":"https://api.github.com/repos/shivusondur/spark/forks","keys_url":"https://api.github.com/repos/shivusondur/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/shivusondur/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/shivusondur/spark/teams","hooks_url":"https://api.github.com/repos/shivusondur/spark/hooks","issue_events_url":"https://api.github.com/repos/shivusondur/spark/issues/events{/number}","events_url":"https://api.github.com/repos/shivusondur/spark/events","assignees_url":"https://api.github.com/repos/shivusondur/spark/assignees{/user}","branches_url":"https://api.github.com/repos/shivusondur/spark/branches{/branch}","tags_url":"https://api.github.com/repos/shivusondur/spark/tags","blobs_url":"https://api.github.com/repos/shivusondur/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/shivusondur/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/shivusondur/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/shivusondur/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/shivusondur/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/shivusondur/spark/languages","stargazers_url":"https://api.github.com/repos/shivusondur/spark/stargazers","contributors_url":"https://api.github.com/repos/shivusondur/spark/contributors","subscribers_url":"https://api.github.com/repos/shivusondur/spark/subscribers","subscription_url":"https://api.github.com/repos/shivusondur/spark/subscription","commits_url":"https://api.github.com/repos/shivusondur/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/shivusondur/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/shivusondur/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/shivusondur/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/shivusondur/spark/contents/{+path}","compare_url":"https://api.github.com/repos/shivusondur/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/shivusondur/spark/merges","archive_url":"https://api.github.com/repos/shivusondur/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/shivusondur/spark/downloads","issues_url":"https://api.github.com/repos/shivusondur/spark/issues{/number}","pulls_url":"https://api.github.com/repos/shivusondur/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/shivusondur/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/shivusondur/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/shivusondur/spark/labels{/name}","releases_url":"https://api.github.com/repos/shivusondur/spark/releases{/id}","deployments_url":"https://api.github.com/repos/shivusondur/spark/deployments","created_at":"2015-07-01T10:17:41Z","updated_at":"2019-03-01T10:45:43Z","pushed_at":"2019-11-04T17:16:33Z","git_url":"git://github.com/shivusondur/spark.git","ssh_url":"git@github.com:shivusondur/spark.git","clone_url":"https://github.com/shivusondur/spark.git","svn_url":"https://github.com/shivusondur/spark","homepage":null,"size":291247,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"0512af16685aaf472eab1057858f8ba9c32f2b89","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25161"},"html":{"href":"https://github.com/apache/spark/pull/25161"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25161"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25161/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25161/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25161/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8795d66b189712f54a55a3b0663273fb26126a8e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25160","id":297574620,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NTc0NjIw","html_url":"https://github.com/apache/spark/pull/25160","diff_url":"https://github.com/apache/spark/pull/25160.diff","patch_url":"https://github.com/apache/spark/pull/25160.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25160","number":25160,"state":"closed","locked":false,"title":"[SPARK-28399][ML][PYTHON] implement RobustScaler","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nImplement `RobustScaler`\r\nSince the transformation is quite similar to `StandardScaler`, I refactor the transform function so that it can be reused in both scalers.\r\n\r\n## How was this patch tested?\r\nexisting and added tests\r\n","created_at":"2019-07-15T11:19:23Z","updated_at":"2019-07-31T01:44:25Z","closed_at":"2019-07-30T15:29:08Z","merged_at":null,"merge_commit_sha":"f6f2ae06f2da4505c2c1bb0d88bc5b018c076c9b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801475,"node_id":"MDU6TGFiZWwxNDA1ODAxNDc1","url":"https://api.github.com/repos/apache/spark/labels/ML","name":"ML","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25160/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25160/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25160/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/45aa724d3f352c265840817d1b690162865f3ec1","head":{"label":"zhengruifeng:robust_scaler","ref":"robust_scaler","sha":"45aa724d3f352c265840817d1b690162865f3ec1","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a7a02a86adafd3808051d843cf7e70176a7c4099","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25160"},"html":{"href":"https://github.com/apache/spark/pull/25160"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25160"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25160/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25160/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25160/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/45aa724d3f352c265840817d1b690162865f3ec1"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25159","id":297515677,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NTE1Njc3","html_url":"https://github.com/apache/spark/pull/25159","diff_url":"https://github.com/apache/spark/pull/25159.diff","patch_url":"https://github.com/apache/spark/pull/25159.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25159","number":25159,"state":"closed","locked":false,"title":"Branch 2.4- for learning","user":{"login":"navinroot","id":14289579,"node_id":"MDQ6VXNlcjE0Mjg5NTc5","avatar_url":"https://avatars.githubusercontent.com/u/14289579?v=4","gravatar_id":"","url":"https://api.github.com/users/navinroot","html_url":"https://github.com/navinroot","followers_url":"https://api.github.com/users/navinroot/followers","following_url":"https://api.github.com/users/navinroot/following{/other_user}","gists_url":"https://api.github.com/users/navinroot/gists{/gist_id}","starred_url":"https://api.github.com/users/navinroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/navinroot/subscriptions","organizations_url":"https://api.github.com/users/navinroot/orgs","repos_url":"https://api.github.com/users/navinroot/repos","events_url":"https://api.github.com/users/navinroot/events{/privacy}","received_events_url":"https://api.github.com/users/navinroot/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n(Please fill in changes proposed in this fix)\r\n\r\n## How was this patch tested?\r\n\r\n(Please explain how this patch was tested. E.g. unit tests, integration tests, manual tests)\r\n(If this patch involves UI changes, please attach a screenshot; otherwise, remove this)\r\n\r\nPlease review https://spark.apache.org/contributing.html before opening a pull request.\r\n","created_at":"2019-07-15T08:25:34Z","updated_at":"2019-07-15T10:01:38Z","closed_at":"2019-07-15T10:01:38Z","merged_at":null,"merge_commit_sha":null,"assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25159/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25159/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25159/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/35d5886dd4b7335f59fa92fa9993b578cfbf67d6","head":{"label":"apache:branch-2.4","ref":"branch-2.4","sha":"35d5886dd4b7335f59fa92fa9993b578cfbf67d6","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a7a02a86adafd3808051d843cf7e70176a7c4099","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25159"},"html":{"href":"https://github.com/apache/spark/pull/25159"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25159"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25159/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25159/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25159/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/35d5886dd4b7335f59fa92fa9993b578cfbf67d6"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25158","id":297500155,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NTAwMTU1","html_url":"https://github.com/apache/spark/pull/25158","diff_url":"https://github.com/apache/spark/pull/25158.diff","patch_url":"https://github.com/apache/spark/pull/25158.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25158","number":25158,"state":"closed","locked":false,"title":"[SPARK-28395][SQL] Division operator support integral division","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nPostgreSQL, Teradata, SQL Server, DB2 and Presto perform integral division with the `/` operator.\r\nBut Oracle, Vertica, Hive, MySQL and MariaDB perform fractional division with the `/` operator.\r\n\r\nThis pr add a flag(`spark.sql.function.preferIntegralDivision`) to control whether to use integral division with the `/` operator.\r\n\r\nExamples:\r\n\r\n**PostgreSQL**:\r\n```sql\r\npostgres=# select substr(version(), 0, 16), cast(10 as int) / cast(3 as int), cast(10.1 as float8) / cast(3 as int), cast(10 as int) / cast(3.1 as float8), cast(10.1 as float8)/cast(3.1 as float8);\r\n     substr      | ?column? |     ?column?     |    ?column?     |     ?column?\r\n-----------------+----------+------------------+-----------------+------------------\r\n PostgreSQL 11.3 |        3 | 3.36666666666667 | 3.2258064516129 | 3.25806451612903\r\n(1 row)\r\n```\r\n**SQL Server**:\r\n```sql\r\n1> select cast(10 as int) / cast(3 as int), cast(10.1 as float) / cast(3 as int), cast(10 as int) / cast(3.1 as float), cast(10.1 as float)/cast(3.1 as float);\r\n2> go\r\n\r\n----------- ------------------------ ------------------------ ------------------------\r\n          3       3.3666666666666667        3.225806451612903        3.258064516129032\r\n\r\n(1 rows affected)\r\n```\r\n**DB2**:\r\n```sql\r\n[db2inst1@2f3c821d36b7 ~]$ db2 \"select cast(10 as int) / cast(3 as int), cast(10.1 as double) / cast(3 as int), cast(10 as int) / cast(3.1 as double), cast(10.1 as double)/cast(3.1 as double) from table (sysproc.env_get_inst_info())\"\r\n\r\n1           2                        3                        4\r\n----------- ------------------------ ------------------------ ------------------------\r\n          3   +3.36666666666667E+000   +3.22580645161290E+000   +3.25806451612903E+000\r\n\r\n  1 record(s) selected.\r\n```\r\n**Presto**:\r\n```sql\r\npresto> select cast(10 as int) / cast(3 as int), cast(10.1 as double) / cast(3 as int), cast(10 as int) / cast(3.1 as double), cast(10.1 as double)/cast(3.1 as double);\r\n _col0 |       _col1        |       _col2       |       _col3\r\n-------+--------------------+-------------------+-------------------\r\n     3 | 3.3666666666666667 | 3.225806451612903 | 3.258064516129032\r\n(1 row)\r\n```\r\n**Teradata**:\r\n![image](https://user-images.githubusercontent.com/5399861/61200701-e97d5380-a714-11e9-9a1d-57fd99d38c8d.png)\r\n\r\n\r\n**Oracle**:\r\n```sql\r\nSQL> select 10 / 3 from dual;\r\n\r\n      10/3\r\n----------\r\n3.33333333\r\n```\r\n**Vertica**\r\n```sql\r\ndbadmin=> select version(), cast(10 as int) / cast(3 as int), cast(10.1 as float8) / cast(3 as int), cast(10 as int) / cast(3.1 as float8), cast(10.1 as float8)/cast(3.1 as float8);\r\n              version               |       ?column?       |     ?column?     |    ?column?     |     ?column?\r\n------------------------------------+----------------------+------------------+-----------------+------------------\r\n Vertica Analytic Database v9.1.1-0 | 3.333333333333333333 | 3.36666666666667 | 3.2258064516129 | 3.25806451612903\r\n(1 row)\r\n```\r\n**Hive**:\r\n```sql\r\nhive> select cast(10 as int) / cast(3 as int), cast(10.1 as double) / cast(3 as int), cast(10 as int) / cast(3.1 as double), cast(10.1 as double)/cast(3.1 as double);\r\nOK\r\n3.3333333333333335\t3.3666666666666667\t3.225806451612903\t3.258064516129032\r\nTime taken: 0.143 seconds, Fetched: 1 row(s)\r\n```\r\n**MariaDB**:\r\n```sql\r\nMariaDB [(none)]> select version(), cast(10 as int) / cast(3 as int), cast(10.1 as double) / cast(3 as int), cast(10 as int) / cast(3.1 as double), cast(10.1 as double)/cast(3.1 as double);\r\n+--------------------------------------+----------------------------------+---------------------------------------+---------------------------------------+------------------------------------------+\r\n| version()                            | cast(10 as int) / cast(3 as int) | cast(10.1 as double) / cast(3 as int) | cast(10 as int) / cast(3.1 as double) | cast(10.1 as double)/cast(3.1 as double) |\r\n+--------------------------------------+----------------------------------+---------------------------------------+---------------------------------------+------------------------------------------+\r\n| 10.4.6-MariaDB-1:10.4.6+maria~bionic |                           3.3333 |                    3.3666666666666667 |                     3.225806451612903 |                        3.258064516129032 |\r\n+--------------------------------------+----------------------------------+---------------------------------------+---------------------------------------+------------------------------------------+\r\n1 row in set (0.000 sec)\r\n```\r\n**MySQL**:\r\n```sql\r\nmysql>  select version(), 10 / 3, 10 / 3.1, 10.1 / 3, 10.1 / 3.1;\r\n+-----------+--------+----------+----------+------------+\r\n| version() | 10 / 3 | 10 / 3.1 | 10.1 / 3 | 10.1 / 3.1 |\r\n+-----------+--------+----------+----------+------------+\r\n| 8.0.16    | 3.3333 |   3.2258 |  3.36667 |    3.25806 |\r\n+-----------+--------+----------+----------+------------+\r\n1 row in set (0.00 sec)\r\n```\r\n## How was this patch tested?\r\n\r\nunit tests\r\n","created_at":"2019-07-15T07:34:07Z","updated_at":"2019-08-02T15:08:50Z","closed_at":"2019-07-16T07:47:38Z","merged_at":null,"merge_commit_sha":"54e530d3bb10e46eeb7ec8a62fca4b9ac6dd0f01","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25158/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25158/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25158/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c1990b5b0c813609ae78e2e5f9c7c651afe04c85","head":{"label":"wangyum:SPARK-28395","ref":"SPARK-28395","sha":"c1990b5b0c813609ae78e2e5f9c7c651afe04c85","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"a7a02a86adafd3808051d843cf7e70176a7c4099","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25158"},"html":{"href":"https://github.com/apache/spark/pull/25158"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25158"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25158/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25158/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25158/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c1990b5b0c813609ae78e2e5f9c7c651afe04c85"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25157","id":297487387,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NDg3Mzg3","html_url":"https://github.com/apache/spark/pull/25157","diff_url":"https://github.com/apache/spark/pull/25157.diff","patch_url":"https://github.com/apache/spark/pull/25157.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25157","number":25157,"state":"closed","locked":false,"title":"[WIP][SPARK-28396][SQL] Add PathCatalog for data source V2","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"**This is still in progress**\r\n## What changes were proposed in this pull request?\r\n\r\nAdd PathCatalog for data source V2, so that:\r\n1. We can convert SaveMode in DataFrameWriter into catalog table operations, instead of supporting SaveMode in file source V2.\r\n2. Support create-table SQL statements like \"CREATE TABLE orc.'path'\"\r\n## How was this patch tested?\r\nUnit test\r\n","created_at":"2019-07-15T06:41:33Z","updated_at":"2019-11-22T23:47:37Z","closed_at":"2019-11-22T23:47:37Z","merged_at":null,"merge_commit_sha":"5ec0f57af734f9fc0815590eba1b75d909dc2910","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25157/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25157/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25157/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9da937d290b527f24adc1eb037216ce43df8483f","head":{"label":"gengliangwang:newPathCatalog","ref":"newPathCatalog","sha":"9da937d290b527f24adc1eb037216ce43df8483f","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2ddeff97d7329942a98ef363991eeabc3fa71a76","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25157"},"html":{"href":"https://github.com/apache/spark/pull/25157"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25157"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25157/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25157/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25157/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9da937d290b527f24adc1eb037216ce43df8483f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25156","id":297467668,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NDY3NjY4","html_url":"https://github.com/apache/spark/pull/25156","diff_url":"https://github.com/apache/spark/pull/25156.diff","patch_url":"https://github.com/apache/spark/pull/25156.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25156","number":25156,"state":"closed","locked":false,"title":"[SPARK-28394][SCHEDULER]: Performance Metrics for Driver","user":{"login":"hthuynh2","id":15680678,"node_id":"MDQ6VXNlcjE1NjgwNjc4","avatar_url":"https://avatars.githubusercontent.com/u/15680678?v=4","gravatar_id":"","url":"https://api.github.com/users/hthuynh2","html_url":"https://github.com/hthuynh2","followers_url":"https://api.github.com/users/hthuynh2/followers","following_url":"https://api.github.com/users/hthuynh2/following{/other_user}","gists_url":"https://api.github.com/users/hthuynh2/gists{/gist_id}","starred_url":"https://api.github.com/users/hthuynh2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hthuynh2/subscriptions","organizations_url":"https://api.github.com/users/hthuynh2/orgs","repos_url":"https://api.github.com/users/hthuynh2/repos","events_url":"https://api.github.com/users/hthuynh2/events{/privacy}","received_events_url":"https://api.github.com/users/hthuynh2/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nDescription\r\nThis PR added the framework for monitoring the schedulers and displaying performance metrics to the UI. More specifically, for each event type that is handled by the DAGScheduler, CoarsedGrainedSchedulerBackend, and TaskResultGetter, it keeps track of the following information: number of handled events of this type, number of pending events of this type, average time to handle an event of this type, total time spending on handling all events of this type.\r\n\r\n-----------\r\nDesign and implementation:\r\nGeneral Idea: \r\nFor each event type, every time we handle an event of this type, we collect the information (e.g. the time taken to handle this event, number of pending events,...), and having a background thread that periodically collects the information and display to the UI.\r\n\r\nUI Explanation\r\n<img width=\"1422\" alt=\"Screen Shot 2019-06-18 at 11 08 39 PM\" src=\"https://user-images.githubusercontent.com/15680678/61195997-50592900-a691-11e9-8e8b-5a4faa5ecc05.png\">\r\n\r\nExplanation of columns:\r\n- Event Type: The type of event that the information in this row below to\r\n- Number of Handled Events: The number of events of this type that is handled\r\n- Number of Pending Events: The number of events of this type that is pending in the queue\r\n- Processing Speed: The average time that is used to handle an event of this type\r\n- Total time: The total time that is used to handled all events of this type\r\n- Timestamp: The time at the end of the interval that we collect the information displayed in this row.\r\n\r\nDriver Schedulers Summary Metrics table\r\n- This table contains information accumulatively collected since the application starts (e.g. the “Number of Handled Events” is the total number of events that are handled since the application starts)\r\n\r\nDriver Schedulers Busy Intervals Metrics table\r\n- This table contains the information for only some busy intervals. The purpose of this table is to pinpoint the time that the scheduler is busy. An interval is considered busy if the total time spending on handling all events of a type during this interval is greater than 70% of the interval length (This 70% is configurable). And the information displayed is the information collected during that interval only (e.g. the “Number of Handled Events” is the number of events that are handled during that interval). Note that we only keep track of top 5 busiest intervals sorted by the “total time” (This number 5 is configurable). \r\n\r\nAn example of how to read the table and how it can be useful for monitoring and debugging the application:\r\nFor an example shown in the figure below, let’s look at the first row of the “Driver Schedulers Busy Intervals Metrics” table. This row contains the information about the ReviveOffers event that is handled by the CoarseGrainedSchedulerBackend. There are 12 ReviveOffers events that is handled by the CoarseGrainedSchedulerBackend during the interval the ends at \"2019/06/19 04:03:13\". The number of ReviveOffers events that are pending is N/A (This is because getting the number of pending events that are waiting to be handled by the CoarseGrainedSchedulerBackend is difficult, so I leave it as N/A for now). The time for the CoarseGrainedSchedulerBackend to handle an ReviveOffers is 763ms. The total time spending on handling all 12 ReviveOffers events during this interval is 9s (For this example, the interval length is 10s). Finally, this interval ends at 2019/06/19 04:03:13.\r\n\r\nFrom the information above, we can easily see that it takes too long for the CoarseGrainedSchedulerBackend to handle the event ReviveOffers (for some interval, it takes up to 700ms to handle just one ReviveOffers event).  This is actually an issue that is mentioned in [SPARK-26755](https://issues.apache.org/jira/browse/SPARK-26755). And this example is the application mentioned in [PR #23677](https://github.com/apache/spark/pull/23677). We can see that having these metrics can help to identify the bottleneck for the application. \r\n\r\n-----------\r\nImplementation:\r\nIntroduce 2 new classes:\r\n- SchedulerEventHandlingMetricTracker: This is used to keep track of the information for an event type\r\n- SchedulerMetricsManager: This is used to manage all the SchedulerEventHandlingMetricTracker for all event types\r\n---------------------\r\nConfigurations:\r\nspark.scheduler.metric.compute.enabled: Indicate if this feature is enable or not (default value is false)\r\nspark.scheduler.metric.compute.interval: This is the interval length (default value is 10s)\r\nspark.scheduler.metric.compute.numTopBusiestInterval: This is the number of busiest intervals that we will keep (default value is 5)\r\nspark.scheduler.metric.compute.busyIntervalThreshold: This is the threshold (in percent) for an interval to be considered busy (default value is 70%). \r\n\r\n## How was this patch tested?\r\nThis patch was manually tested with some applications. Please let me know if there's any specific tests that are needed to be done.\r\n\r\nThank you!","created_at":"2019-07-15T04:46:13Z","updated_at":"2019-09-16T21:42:53Z","closed_at":"2019-09-16T21:42:18Z","merged_at":null,"merge_commit_sha":"097087de524067fc4f07e3884ed78acf8784a273","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406605079,"node_id":"MDU6TGFiZWwxNDA2NjA1MDc5","url":"https://api.github.com/repos/apache/spark/labels/WEB%20UI","name":"WEB UI","color":"ededed","default":false,"description":null},{"id":1406606875,"node_id":"MDU6TGFiZWwxNDA2NjA2ODc1","url":"https://api.github.com/repos/apache/spark/labels/SCHEDULER","name":"SCHEDULER","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25156/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25156/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25156/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2dd7a94dc113be976201b4d4b2c938e2ae65c7eb","head":{"label":"hthuynh2:Driver_schedulers_metric","ref":"Driver_schedulers_metric","sha":"2dd7a94dc113be976201b4d4b2c938e2ae65c7eb","user":{"login":"hthuynh2","id":15680678,"node_id":"MDQ6VXNlcjE1NjgwNjc4","avatar_url":"https://avatars.githubusercontent.com/u/15680678?v=4","gravatar_id":"","url":"https://api.github.com/users/hthuynh2","html_url":"https://github.com/hthuynh2","followers_url":"https://api.github.com/users/hthuynh2/followers","following_url":"https://api.github.com/users/hthuynh2/following{/other_user}","gists_url":"https://api.github.com/users/hthuynh2/gists{/gist_id}","starred_url":"https://api.github.com/users/hthuynh2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hthuynh2/subscriptions","organizations_url":"https://api.github.com/users/hthuynh2/orgs","repos_url":"https://api.github.com/users/hthuynh2/repos","events_url":"https://api.github.com/users/hthuynh2/events{/privacy}","received_events_url":"https://api.github.com/users/hthuynh2/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":136668094,"node_id":"MDEwOlJlcG9zaXRvcnkxMzY2NjgwOTQ=","name":"spark","full_name":"hthuynh2/spark","private":false,"owner":{"login":"hthuynh2","id":15680678,"node_id":"MDQ6VXNlcjE1NjgwNjc4","avatar_url":"https://avatars.githubusercontent.com/u/15680678?v=4","gravatar_id":"","url":"https://api.github.com/users/hthuynh2","html_url":"https://github.com/hthuynh2","followers_url":"https://api.github.com/users/hthuynh2/followers","following_url":"https://api.github.com/users/hthuynh2/following{/other_user}","gists_url":"https://api.github.com/users/hthuynh2/gists{/gist_id}","starred_url":"https://api.github.com/users/hthuynh2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hthuynh2/subscriptions","organizations_url":"https://api.github.com/users/hthuynh2/orgs","repos_url":"https://api.github.com/users/hthuynh2/repos","events_url":"https://api.github.com/users/hthuynh2/events{/privacy}","received_events_url":"https://api.github.com/users/hthuynh2/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/hthuynh2/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/hthuynh2/spark","forks_url":"https://api.github.com/repos/hthuynh2/spark/forks","keys_url":"https://api.github.com/repos/hthuynh2/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/hthuynh2/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/hthuynh2/spark/teams","hooks_url":"https://api.github.com/repos/hthuynh2/spark/hooks","issue_events_url":"https://api.github.com/repos/hthuynh2/spark/issues/events{/number}","events_url":"https://api.github.com/repos/hthuynh2/spark/events","assignees_url":"https://api.github.com/repos/hthuynh2/spark/assignees{/user}","branches_url":"https://api.github.com/repos/hthuynh2/spark/branches{/branch}","tags_url":"https://api.github.com/repos/hthuynh2/spark/tags","blobs_url":"https://api.github.com/repos/hthuynh2/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/hthuynh2/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/hthuynh2/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/hthuynh2/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/hthuynh2/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/hthuynh2/spark/languages","stargazers_url":"https://api.github.com/repos/hthuynh2/spark/stargazers","contributors_url":"https://api.github.com/repos/hthuynh2/spark/contributors","subscribers_url":"https://api.github.com/repos/hthuynh2/spark/subscribers","subscription_url":"https://api.github.com/repos/hthuynh2/spark/subscription","commits_url":"https://api.github.com/repos/hthuynh2/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/hthuynh2/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/hthuynh2/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/hthuynh2/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/hthuynh2/spark/contents/{+path}","compare_url":"https://api.github.com/repos/hthuynh2/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/hthuynh2/spark/merges","archive_url":"https://api.github.com/repos/hthuynh2/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/hthuynh2/spark/downloads","issues_url":"https://api.github.com/repos/hthuynh2/spark/issues{/number}","pulls_url":"https://api.github.com/repos/hthuynh2/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/hthuynh2/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/hthuynh2/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/hthuynh2/spark/labels{/name}","releases_url":"https://api.github.com/repos/hthuynh2/spark/releases{/id}","deployments_url":"https://api.github.com/repos/hthuynh2/spark/deployments","created_at":"2018-06-08T21:36:21Z","updated_at":"2019-06-19T14:55:45Z","pushed_at":"2019-07-11T20:08:16Z","git_url":"git://github.com/hthuynh2/spark.git","ssh_url":"git@github.com:hthuynh2/spark.git","clone_url":"https://github.com/hthuynh2/spark.git","svn_url":"https://github.com/hthuynh2/spark","homepage":null,"size":296032,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"e238ebe9b0355e871cebb8f939f1bcc879068e8d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25156"},"html":{"href":"https://github.com/apache/spark/pull/25156"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25156"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25156/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25156/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25156/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2dd7a94dc113be976201b4d4b2c938e2ae65c7eb"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25155","id":297452617,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NDUyNjE3","html_url":"https://github.com/apache/spark/pull/25155","diff_url":"https://github.com/apache/spark/pull/25155.diff","patch_url":"https://github.com/apache/spark/pull/25155.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25155","number":25155,"state":"closed","locked":false,"title":"[SPARK-28392][SQL][TESTS] Add traits for UDF and PostgreSQL tests to share initialization","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some traits so that we can deduplicate initialization stuff for each type of test case. For instance, see [SPARK-28343](https://issues.apache.org/jira/browse/SPARK-28343).\r\n\r\nIt's a little bit overkill but I think it will make adding test cases easier and cause less confusions.\r\n\r\nThis PR adds both:\r\n\r\n```\r\n  private trait PgSQLTest\r\n  private trait UDFTest\r\n```\r\n\r\nTo indicate and share the logics related to each combination of test types.\r\n\r\n## How was this patch tested?\r\n\r\nManually tested.\r\n","created_at":"2019-07-15T02:38:31Z","updated_at":"2020-03-03T01:18:28Z","closed_at":"2019-07-15T07:24:34Z","merged_at":null,"merge_commit_sha":"2677feaaef7e2a54ee610cf54375c9434f2cec00","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25155/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25155/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25155/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/feea2d9b19f0948adaed8b9705cc28b366e3f1d5","head":{"label":"HyukjinKwon:SPARK-28392","ref":"SPARK-28392","sha":"feea2d9b19f0948adaed8b9705cc28b366e3f1d5","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7548a8826d6113121b6bda1ea99ca835374220b6","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25155"},"html":{"href":"https://github.com/apache/spark/pull/25155"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25155"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25155/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25155/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25155/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/feea2d9b19f0948adaed8b9705cc28b366e3f1d5"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25154","id":297431988,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NDMxOTg4","html_url":"https://github.com/apache/spark/pull/25154","diff_url":"https://github.com/apache/spark/pull/25154.diff","patch_url":"https://github.com/apache/spark/pull/25154.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25154","number":25154,"state":"closed","locked":false,"title":"[SPARK-28247][SS][BRANCH-2.4] Fix flaky test \"query without test harness\" on ContinuousSuite","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis patch fixes the flaky test \"query without test harness\" on ContinuousSuite, via adding some more gaps on waiting query to commit the epoch which writes output rows.\r\n\r\nThe observation of this issue is below (injected some debug logs to get them):\r\n\r\n```\r\nreader creation time                                   1562225320210\r\nepoch 1 launched                                       1562225320593 (+380ms from reader creation time)\r\nepoch 13 launched                                      1562225321702 (+1.5s from reader creation time)\r\npartition reader creation time                         1562225321715 (+1.5s from reader creation time)\r\n\r\nnext read time for first next call                     1562225321210 (+1s from reader creation time)\r\nfirst next called in partition reader                  1562225321746 (immediately after creation of partition reader)\r\nwait finished in next called in partition reader       1562225321746 (no wait)\r\n\r\nsecond next called in partition reader                 1562225321747 (immediately after first next())\r\n\r\nepoch 0 commit started                                 1562225321861\r\n\r\nwriting rows (0, 1) (belong to epoch 13)               1562225321866 (+100ms after first next())\r\n\r\nwait start in waitForRateSourceTriggers(2)             1562225322059\r\n\r\nnext read time for second next call                    1562225322210 (+1s from previous \"next read time\")\r\nwait finished in next called in partition reader       1562225322211 (+450ms wait)\r\n\r\nwriting rows (2, 3) (belong to epoch 13)               1562225322211 (immediately after next())\r\n\r\nepoch 14 launched                                      1562225322246\r\n\r\ndesired wait time in waitForRateSourceTriggers(2)      1562225322510 (+2.3s from reader creation time)\r\n\r\nepoch 12 committed                                     1562225323034\r\n```\r\n\r\nThese rows were written within desired wait time, but the epoch 13 couldn't be committed within it. Interestingly, epoch 12 was lucky to be committed within a gap between finished waiting in waitForRateSourceTriggers and query.stop() - but even suppose the rows were written in epoch 12, it would be just in luck and epoch should be committed within desired wait time.\r\n\r\nThis patch modifies Rate continuous stream to track the highest committed value, so that test can wait until desired value is reported to the stream as committed.\r\n\r\nThis patch also modifies Rate continuous stream to track the timestamp at stream gets the first committed offset, and let `waitForRateSourceTriggers` use the timestamp. This also relies on waiting for specific period, but safer approach compared to current based on the observation above. Based on the change, this patch saves couple of seconds in test time.\r\n\r\n## How was this patch tested?\r\n\r\n3 sequential test runs succeeded locally.\r\n","created_at":"2019-07-14T22:14:47Z","updated_at":"2019-07-26T03:12:10Z","closed_at":"2019-07-16T13:30:08Z","merged_at":null,"merge_commit_sha":"505bc8578ab01a44db38ecc8a607ddaaeb734b80","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25154/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25154/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25154/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c3b870e70dc1fb3d806c25c41102de1eaff508c3","head":{"label":"HeartSaVioR:SPARK-28247-branch-2.4","ref":"SPARK-28247-branch-2.4","sha":"c3b870e70dc1fb3d806c25c41102de1eaff508c3","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":27994296,"node_id":"MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==","name":"spark","full_name":"HeartSaVioR/spark","private":false,"owner":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HeartSaVioR/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HeartSaVioR/spark","forks_url":"https://api.github.com/repos/HeartSaVioR/spark/forks","keys_url":"https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HeartSaVioR/spark/teams","hooks_url":"https://api.github.com/repos/HeartSaVioR/spark/hooks","issue_events_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HeartSaVioR/spark/events","assignees_url":"https://api.github.com/repos/HeartSaVioR/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HeartSaVioR/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HeartSaVioR/spark/tags","blobs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HeartSaVioR/spark/languages","stargazers_url":"https://api.github.com/repos/HeartSaVioR/spark/stargazers","contributors_url":"https://api.github.com/repos/HeartSaVioR/spark/contributors","subscribers_url":"https://api.github.com/repos/HeartSaVioR/spark/subscribers","subscription_url":"https://api.github.com/repos/HeartSaVioR/spark/subscription","commits_url":"https://api.github.com/repos/HeartSaVioR/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HeartSaVioR/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HeartSaVioR/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HeartSaVioR/spark/merges","archive_url":"https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HeartSaVioR/spark/downloads","issues_url":"https://api.github.com/repos/HeartSaVioR/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HeartSaVioR/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HeartSaVioR/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HeartSaVioR/spark/labels{/name}","releases_url":"https://api.github.com/repos/HeartSaVioR/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HeartSaVioR/spark/deployments","created_at":"2014-12-14T12:56:04Z","updated_at":"2024-10-21T04:36:36Z","pushed_at":"2025-01-08T06:13:27Z","git_url":"git://github.com/HeartSaVioR/spark.git","ssh_url":"git@github.com:HeartSaVioR/spark.git","clone_url":"https://github.com/HeartSaVioR/spark.git","svn_url":"https://github.com/HeartSaVioR/spark","homepage":null,"size":456164,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":1,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:branch-2.4","ref":"branch-2.4","sha":"35d5886dd4b7335f59fa92fa9993b578cfbf67d6","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25154"},"html":{"href":"https://github.com/apache/spark/pull/25154"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25154"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25154/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25154/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25154/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c3b870e70dc1fb3d806c25c41102de1eaff508c3"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25153","id":297417955,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NDE3OTU1","html_url":"https://github.com/apache/spark/pull/25153","diff_url":"https://github.com/apache/spark/pull/25153.diff","patch_url":"https://github.com/apache/spark/pull/25153.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25153","number":25153,"state":"closed","locked":false,"title":"[SPARK-28389][SQL] Use Java 8 API in add_months","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nIn the PR, I propose to use the `plusMonths()` method of `LocalDate` to add months to a date. This method adds the specified amount to the months field of `LocalDate` in three steps:\r\n1. Add the input months to the month-of-year field\r\n2. Check if the resulting date would be invalid\r\n3. Adjust the day-of-month to the last valid day if necessary\r\n\r\nThe difference between current behavior and propose one is in handling the last day of month in the original date. For example, adding 1 month to `2019-02-28` will produce `2019-03-28` comparing to the current implementation where the result is `2019-03-31`.\r\n\r\nThe proposed behavior is implemented in MySQL and PostgreSQL.\r\n\r\n## How was this patch tested?\r\n\r\nBy existing test suites `DateExpressionsSuite`, `DateFunctionsSuite` and `DateTimeUtilsSuite`.","created_at":"2019-07-14T18:30:41Z","updated_at":"2020-02-05T18:27:29Z","closed_at":"2019-07-15T12:54:27Z","merged_at":null,"merge_commit_sha":"af0f230785277f2a687cfa0b7a4acdb9b8cd129d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25153/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25153/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25153/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f1a4241cf9cf175648f5b314b832124dfccdce01","head":{"label":"MaxGekk:add-months","ref":"add-months","sha":"f1a4241cf9cf175648f5b314b832124dfccdce01","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":123690489,"node_id":"MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=","name":"spark","full_name":"MaxGekk/spark","private":false,"owner":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/MaxGekk/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/MaxGekk/spark","forks_url":"https://api.github.com/repos/MaxGekk/spark/forks","keys_url":"https://api.github.com/repos/MaxGekk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/MaxGekk/spark/teams","hooks_url":"https://api.github.com/repos/MaxGekk/spark/hooks","issue_events_url":"https://api.github.com/repos/MaxGekk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/MaxGekk/spark/events","assignees_url":"https://api.github.com/repos/MaxGekk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/MaxGekk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/MaxGekk/spark/tags","blobs_url":"https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/MaxGekk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/MaxGekk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/MaxGekk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/MaxGekk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/MaxGekk/spark/languages","stargazers_url":"https://api.github.com/repos/MaxGekk/spark/stargazers","contributors_url":"https://api.github.com/repos/MaxGekk/spark/contributors","subscribers_url":"https://api.github.com/repos/MaxGekk/spark/subscribers","subscription_url":"https://api.github.com/repos/MaxGekk/spark/subscription","commits_url":"https://api.github.com/repos/MaxGekk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/MaxGekk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/MaxGekk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/MaxGekk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/MaxGekk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/MaxGekk/spark/merges","archive_url":"https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/MaxGekk/spark/downloads","issues_url":"https://api.github.com/repos/MaxGekk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/MaxGekk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/MaxGekk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/MaxGekk/spark/labels{/name}","releases_url":"https://api.github.com/repos/MaxGekk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/MaxGekk/spark/deployments","created_at":"2018-03-03T12:37:00Z","updated_at":"2025-02-07T09:44:52Z","pushed_at":"2025-02-07T09:44:24Z","git_url":"git://github.com/MaxGekk/spark.git","ssh_url":"git@github.com:MaxGekk/spark.git","clone_url":"https://github.com/MaxGekk/spark.git","svn_url":"https://github.com/MaxGekk/spark","homepage":null,"size":486456,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"76079fab5c643705046badd4ea1b595bd1404454","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25153"},"html":{"href":"https://github.com/apache/spark/pull/25153"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25153"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25153/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25153/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25153/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f1a4241cf9cf175648f5b314b832124dfccdce01"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25152","id":297406643,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NDA2NjQz","html_url":"https://github.com/apache/spark/pull/25152","diff_url":"https://github.com/apache/spark/pull/25152.diff","patch_url":"https://github.com/apache/spark/pull/25152.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25152","number":25152,"state":"closed","locked":false,"title":"[SPARK-28388][SQL][TEST] Port select_implicit.sql","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR is to port numeric.sql from PostgreSQL regression tests. https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/sql/select_implicit.sql\r\n\r\nThe expected results can be found in the link: https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/expected/select_implicit.out\r\n\r\nWhen porting the test cases, found one PostgreSQL specific features that do not exist in Spark SQL:\r\n[SPARK-28329](https://issues.apache.org/jira/browse/SPARK-28329): SELECT INTO syntax\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-14T15:42:16Z","updated_at":"2019-07-18T16:05:49Z","closed_at":"2019-07-18T16:03:20Z","merged_at":null,"merge_commit_sha":"50cca953e1e12540157fdec4725871e5f413916a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25152/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25152/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25152/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c00b9d84e02bb6bd2f3d6bfa04649478ae370f0f","head":{"label":"wangyum:SPARK-28388","ref":"SPARK-28388","sha":"c00b9d84e02bb6bd2f3d6bfa04649478ae370f0f","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"71882f119e72934a02d4c177f0d52c785e2df79f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25152"},"html":{"href":"https://github.com/apache/spark/pull/25152"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25152"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25152/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25152/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25152/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c00b9d84e02bb6bd2f3d6bfa04649478ae370f0f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25151","id":297404210,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3NDA0MjEw","html_url":"https://github.com/apache/spark/pull/25151","diff_url":"https://github.com/apache/spark/pull/25151.diff","patch_url":"https://github.com/apache/spark/pull/25151.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25151","number":25151,"state":"closed","locked":false,"title":"[SPARK-28387][SQL][TEST] Port select_having.sql","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR is to port select.sql from PostgreSQL regression tests. https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/sql/select_having.sql\r\n\r\nThe expected results can be found in the link: https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/expected/select_having.out\r\n\r\nWhen porting the test cases, found one bug:\r\n[SPARK-28386](https://issues.apache.org/jira/browse/SPARK-28386): Cannot resolve ORDER BY columns with GROUP BY and HAVING\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-14T15:12:42Z","updated_at":"2019-07-15T04:29:24Z","closed_at":"2019-07-15T04:25:37Z","merged_at":null,"merge_commit_sha":"08b4ffd1d2dadbb28c3cd99ece0e135e00827f66","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25151/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25151/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25151/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d6d8d389f7a3eb1d6b977d16c6e0ace6c42289b7","head":{"label":"wangyum:SPARK-28387","ref":"SPARK-28387","sha":"d6d8d389f7a3eb1d6b977d16c6e0ace6c42289b7","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"76079fab5c643705046badd4ea1b595bd1404454","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25151"},"html":{"href":"https://github.com/apache/spark/pull/25151"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25151"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25151/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25151/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25151/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d6d8d389f7a3eb1d6b977d16c6e0ace6c42289b7"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25150","id":297398055,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3Mzk4MDU1","html_url":"https://github.com/apache/spark/pull/25150","diff_url":"https://github.com/apache/spark/pull/25150.diff","patch_url":"https://github.com/apache/spark/pull/25150.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25150","number":25150,"state":"closed","locked":false,"title":"[SPARK-28384][SQL][TEST] Port select_distinct.sql","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR is to port select.sql from PostgreSQL regression tests. https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/sql/select_distinct.sql\r\n\r\nThe expected results can be found in the link: https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/expected/select_distinct.out\r\n\r\nWhen porting the test cases, found one PostgreSQL specific features that do not exist in Spark SQL:\r\n[SPARK-28010](https://issues.apache.org/jira/browse/SPARK-28010): Support ORDER BY ... USING syntax\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-14T13:55:20Z","updated_at":"2019-07-15T07:07:05Z","closed_at":"2019-07-15T04:59:41Z","merged_at":null,"merge_commit_sha":"3547bf0d497f0773d72bc79b2ab103ff4102f231","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25150/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25150/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25150/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e06f4677606f2029f66f2264fa4d293f4ac56e52","head":{"label":"wangyum:SPARK-28384","ref":"SPARK-28384","sha":"e06f4677606f2029f66f2264fa4d293f4ac56e52","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"76079fab5c643705046badd4ea1b595bd1404454","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25150"},"html":{"href":"https://github.com/apache/spark/pull/25150"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25150"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25150/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25150/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25150/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e06f4677606f2029f66f2264fa4d293f4ac56e52"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25149","id":297377602,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3Mzc3NjAy","html_url":"https://github.com/apache/spark/pull/25149","diff_url":"https://github.com/apache/spark/pull/25149.diff","patch_url":"https://github.com/apache/spark/pull/25149.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25149","number":25149,"state":"closed","locked":false,"title":"[SPARK-28383][SQL] SHOW CREATE TABLE is not supported on a temporary view","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nIt throws `Table or view not found` when showing  temporary views:\r\n```sql\r\nspark-sql> CREATE TEMPORARY VIEW temp_view AS SELECT 1 AS a;\r\nspark-sql> show create table temp_view;\r\nError in query: Table or view 'temp_view' not found in database 'default';\r\n```\r\nIt's not easy to support temporary views. This pr changed it to throws `SHOW CREATE TABLE is not supported on a temporary view`:\r\n```sql\r\nspark-sql> CREATE TEMPORARY VIEW temp_view AS SELECT 1 AS a;\r\nspark-sql> show create table temp_view;\r\nError in query: SHOW CREATE TABLE is not supported on a temporary view: temp_view;\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nunit tests\r\n","created_at":"2019-07-14T08:33:27Z","updated_at":"2019-08-13T04:54:30Z","closed_at":"2019-08-13T04:06:26Z","merged_at":null,"merge_commit_sha":"e7e3769bacf0eb9a02a8786fd8c8d28dd120aa9e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25149/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25149/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25149/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8d8725f9aefe1fdd2676b2f22640a667c9949d16","head":{"label":"wangyum:SPARK-28383","ref":"SPARK-28383","sha":"8d8725f9aefe1fdd2676b2f22640a667c9949d16","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"37eedf6149024de8ffbdd45ad43760dbe758a116","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25149"},"html":{"href":"https://github.com/apache/spark/pull/25149"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25149"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25149/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25149/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25149/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8d8725f9aefe1fdd2676b2f22640a667c9949d16"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25148","id":297373814,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MzczODE0","html_url":"https://github.com/apache/spark/pull/25148","diff_url":"https://github.com/apache/spark/pull/25148.diff","patch_url":"https://github.com/apache/spark/pull/25148.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25148","number":25148,"state":"closed","locked":false,"title":"[SPARK-28326][SQL][TEST] Port join.sql","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR is to port join.sql from PostgreSQL regression tests. https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/sql/join.sql\r\n\r\nThe expected results can be found in the link: https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/expected/join.out\r\n\r\nWhen porting the test cases, found nine PostgreSQL specific features that do not exist in Spark SQL:\r\n[SPARK-27877](https://issues.apache.org/jira/browse/SPARK-27877): ANSI SQL: LATERAL derived table(T491)\r\n[SPARK-20856](https://issues.apache.org/jira/browse/SPARK-20856): support statement using nested joins\r\n[SPARK-27987](https://issues.apache.org/jira/browse/SPARK-27987): Support POSIX Regular Expressions\r\n[SPARK-28382](https://issues.apache.org/jira/browse/SPARK-28382): Array Functions: unnest\r\n[SPARK-25411](https://issues.apache.org/jira/browse/SPARK-25411): Implement range partition in Spark\r\n[SPARK-28377](https://issues.apache.org/jira/browse/SPARK-28377): Fully support correlation names in the FROM clause\r\n[SPARK-28330](https://issues.apache.org/jira/browse/SPARK-28330): Enhance query limit\r\n[SPARK-28379](https://issues.apache.org/jira/browse/SPARK-28379): Correlated scalar subqueries must be aggregated\r\n[SPARK-16452](https://issues.apache.org/jira/browse/SPARK-16452): basic INFORMATION_SCHEMA support\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-14T07:23:05Z","updated_at":"2019-07-30T07:15:12Z","closed_at":"2019-07-30T07:14:29Z","merged_at":null,"merge_commit_sha":"da544a65271210f43082d4fe493362f882bb25f0","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25148/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25148/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25148/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6261c875fbfa8af50bf7c3982e6f1489b7852745","head":{"label":"wangyum:SPARK-28326","ref":"SPARK-28326","sha":"6261c875fbfa8af50bf7c3982e6f1489b7852745","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"76079fab5c643705046badd4ea1b595bd1404454","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25148"},"html":{"href":"https://github.com/apache/spark/pull/25148"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25148"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25148/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25148/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25148/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6261c875fbfa8af50bf7c3982e6f1489b7852745"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25147","id":297364821,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MzY0ODIx","html_url":"https://github.com/apache/spark/pull/25147","diff_url":"https://github.com/apache/spark/pull/25147.diff","patch_url":"https://github.com/apache/spark/pull/25147.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25147","number":25147,"state":"closed","locked":false,"title":"[SPARK-28333][SQL] NULLS FIRST for DESC and NULLS LAST for ASC\t","user":{"login":"shivusondur","id":7912929,"node_id":"MDQ6VXNlcjc5MTI5Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/7912929?v=4","gravatar_id":"","url":"https://api.github.com/users/shivusondur","html_url":"https://github.com/shivusondur","followers_url":"https://api.github.com/users/shivusondur/followers","following_url":"https://api.github.com/users/shivusondur/following{/other_user}","gists_url":"https://api.github.com/users/shivusondur/gists{/gist_id}","starred_url":"https://api.github.com/users/shivusondur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivusondur/subscriptions","organizations_url":"https://api.github.com/users/shivusondur/orgs","repos_url":"https://api.github.com/users/shivusondur/repos","events_url":"https://api.github.com/users/shivusondur/events{/privacy}","received_events_url":"https://api.github.com/users/shivusondur/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nchanged the default null ordering for ACS and DESC, and updated the corresponding tests\r\n\r\n## How was this patch tested?\r\n\r\nRan sql/catalyst module UT and updated the test case\r\n\r\n\r\n","created_at":"2019-07-14T03:52:01Z","updated_at":"2019-08-02T00:27:20Z","closed_at":"2019-07-31T17:25:47Z","merged_at":null,"merge_commit_sha":"16174e45e74f2fbe2d12b69a8df0cc64dcd356e2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25147/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25147/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25147/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/475e07ab0cf263bbad5f09532ef32eb1406261c3","head":{"label":"shivusondur:jira28333","ref":"jira28333","sha":"475e07ab0cf263bbad5f09532ef32eb1406261c3","user":{"login":"shivusondur","id":7912929,"node_id":"MDQ6VXNlcjc5MTI5Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/7912929?v=4","gravatar_id":"","url":"https://api.github.com/users/shivusondur","html_url":"https://github.com/shivusondur","followers_url":"https://api.github.com/users/shivusondur/followers","following_url":"https://api.github.com/users/shivusondur/following{/other_user}","gists_url":"https://api.github.com/users/shivusondur/gists{/gist_id}","starred_url":"https://api.github.com/users/shivusondur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivusondur/subscriptions","organizations_url":"https://api.github.com/users/shivusondur/orgs","repos_url":"https://api.github.com/users/shivusondur/repos","events_url":"https://api.github.com/users/shivusondur/events{/privacy}","received_events_url":"https://api.github.com/users/shivusondur/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":38364630,"node_id":"MDEwOlJlcG9zaXRvcnkzODM2NDYzMA==","name":"spark","full_name":"shivusondur/spark","private":false,"owner":{"login":"shivusondur","id":7912929,"node_id":"MDQ6VXNlcjc5MTI5Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/7912929?v=4","gravatar_id":"","url":"https://api.github.com/users/shivusondur","html_url":"https://github.com/shivusondur","followers_url":"https://api.github.com/users/shivusondur/followers","following_url":"https://api.github.com/users/shivusondur/following{/other_user}","gists_url":"https://api.github.com/users/shivusondur/gists{/gist_id}","starred_url":"https://api.github.com/users/shivusondur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivusondur/subscriptions","organizations_url":"https://api.github.com/users/shivusondur/orgs","repos_url":"https://api.github.com/users/shivusondur/repos","events_url":"https://api.github.com/users/shivusondur/events{/privacy}","received_events_url":"https://api.github.com/users/shivusondur/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/shivusondur/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/shivusondur/spark","forks_url":"https://api.github.com/repos/shivusondur/spark/forks","keys_url":"https://api.github.com/repos/shivusondur/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/shivusondur/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/shivusondur/spark/teams","hooks_url":"https://api.github.com/repos/shivusondur/spark/hooks","issue_events_url":"https://api.github.com/repos/shivusondur/spark/issues/events{/number}","events_url":"https://api.github.com/repos/shivusondur/spark/events","assignees_url":"https://api.github.com/repos/shivusondur/spark/assignees{/user}","branches_url":"https://api.github.com/repos/shivusondur/spark/branches{/branch}","tags_url":"https://api.github.com/repos/shivusondur/spark/tags","blobs_url":"https://api.github.com/repos/shivusondur/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/shivusondur/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/shivusondur/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/shivusondur/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/shivusondur/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/shivusondur/spark/languages","stargazers_url":"https://api.github.com/repos/shivusondur/spark/stargazers","contributors_url":"https://api.github.com/repos/shivusondur/spark/contributors","subscribers_url":"https://api.github.com/repos/shivusondur/spark/subscribers","subscription_url":"https://api.github.com/repos/shivusondur/spark/subscription","commits_url":"https://api.github.com/repos/shivusondur/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/shivusondur/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/shivusondur/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/shivusondur/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/shivusondur/spark/contents/{+path}","compare_url":"https://api.github.com/repos/shivusondur/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/shivusondur/spark/merges","archive_url":"https://api.github.com/repos/shivusondur/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/shivusondur/spark/downloads","issues_url":"https://api.github.com/repos/shivusondur/spark/issues{/number}","pulls_url":"https://api.github.com/repos/shivusondur/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/shivusondur/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/shivusondur/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/shivusondur/spark/labels{/name}","releases_url":"https://api.github.com/repos/shivusondur/spark/releases{/id}","deployments_url":"https://api.github.com/repos/shivusondur/spark/deployments","created_at":"2015-07-01T10:17:41Z","updated_at":"2019-03-01T10:45:43Z","pushed_at":"2019-11-04T17:16:33Z","git_url":"git://github.com/shivusondur/spark.git","ssh_url":"git@github.com:shivusondur/spark.git","clone_url":"https://github.com/shivusondur/spark.git","svn_url":"https://github.com/shivusondur/spark","homepage":null,"size":291247,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fab75db99bd9557d4bb74eea5d2f5f9f7042bb4f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25147"},"html":{"href":"https://github.com/apache/spark/pull/25147"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25147"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25147/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25147/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25147/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/475e07ab0cf263bbad5f09532ef32eb1406261c3"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25146","id":297341879,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MzQxODc5","html_url":"https://github.com/apache/spark/pull/25146","diff_url":"https://github.com/apache/spark/pull/25146.diff","patch_url":"https://github.com/apache/spark/pull/25146.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25146","number":25146,"state":"closed","locked":false,"title":"[SPARK-28152][SQL] Mapped ShortType to SMALLINT and FloatType to REAL for MsSqlServerDialect","user":{"login":"shivsood","id":1579057,"node_id":"MDQ6VXNlcjE1NzkwNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1579057?v=4","gravatar_id":"","url":"https://api.github.com/users/shivsood","html_url":"https://github.com/shivsood","followers_url":"https://api.github.com/users/shivsood/followers","following_url":"https://api.github.com/users/shivsood/following{/other_user}","gists_url":"https://api.github.com/users/shivsood/gists{/gist_id}","starred_url":"https://api.github.com/users/shivsood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivsood/subscriptions","organizations_url":"https://api.github.com/users/shivsood/orgs","repos_url":"https://api.github.com/users/shivsood/repos","events_url":"https://api.github.com/users/shivsood/events{/privacy}","received_events_url":"https://api.github.com/users/shivsood/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nThis PR aims to correct mappings in `MsSqlServerDialect`. `ShortType` is mapped to `SMALLINT` and `FloatType` is mapped to `REAL` per [JBDC mapping]( https://docs.microsoft.com/en-us/sql/connect/jdbc/using-basic-data-types?view=sql-server-2017) respectively.\r\n\r\nShortType and FloatTypes are not correctly mapped to right JDBC types when using JDBC connector. This results in tables and spark data frame being created with unintended types. The issue was observed when validating against SQLServer.\r\n\r\nRefer [JBDC mapping]( https://docs.microsoft.com/en-us/sql/connect/jdbc/using-basic-data-types?view=sql-server-2017  ) for guidance on mappings between SQLServer, JDBC and Java. Note that java \"Short\" type should be mapped to JDBC \"SMALLINT\" and java Float should be mapped to JDBC \"REAL\".\r\n\r\nSome example issue that can happen because of wrong mappings\r\n    - Write from df with column type results in a SQL table of with column type as INTEGER as opposed to SMALLINT.Thus a larger table that expected.\r\n    - Read results in a dataframe with type INTEGER as opposed to ShortType\r\n\r\n- ShortType has a problem in both the the write and read path\r\n- FloatTypes only have an issue with read path. In the write path Spark data type 'FloatType' is correctly mapped to JDBC equivalent data type 'Real'. But in the read path when JDBC data types need to be converted to Catalyst data types ( getCatalystType) 'Real' gets incorrectly gets mapped to 'DoubleType' rather than 'FloatType'.\r\n\r\nRefer #28151 which contained this fix as one part of a larger PR.  Following PR #28151 discussion it was decided to file seperate PRs for each of the fixes.\r\n\r\n## How was this patch tested?\r\nUnitTest added in JDBCSuite.scala and these were tested.\r\nIntegration test updated and passed in MsSqlServerDialect.scala \r\nE2E test done with SQLServer","created_at":"2019-07-13T19:27:31Z","updated_at":"2019-07-22T00:27:00Z","closed_at":"2019-07-15T19:17:01Z","merged_at":null,"merge_commit_sha":"d8910718ca12fcfaf3e9c238578bfece6b4c7ef0","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25146/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25146/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25146/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b25007ea329941801cba84f196b72fe34807947b","head":{"label":"shivsood:float_short_type_fix","ref":"float_short_type_fix","sha":"b25007ea329941801cba84f196b72fe34807947b","user":{"login":"shivsood","id":1579057,"node_id":"MDQ6VXNlcjE1NzkwNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1579057?v=4","gravatar_id":"","url":"https://api.github.com/users/shivsood","html_url":"https://github.com/shivsood","followers_url":"https://api.github.com/users/shivsood/followers","following_url":"https://api.github.com/users/shivsood/following{/other_user}","gists_url":"https://api.github.com/users/shivsood/gists{/gist_id}","starred_url":"https://api.github.com/users/shivsood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivsood/subscriptions","organizations_url":"https://api.github.com/users/shivsood/orgs","repos_url":"https://api.github.com/users/shivsood/repos","events_url":"https://api.github.com/users/shivsood/events{/privacy}","received_events_url":"https://api.github.com/users/shivsood/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":192983938,"node_id":"MDEwOlJlcG9zaXRvcnkxOTI5ODM5Mzg=","name":"spark","full_name":"shivsood/spark","private":false,"owner":{"login":"shivsood","id":1579057,"node_id":"MDQ6VXNlcjE1NzkwNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1579057?v=4","gravatar_id":"","url":"https://api.github.com/users/shivsood","html_url":"https://github.com/shivsood","followers_url":"https://api.github.com/users/shivsood/followers","following_url":"https://api.github.com/users/shivsood/following{/other_user}","gists_url":"https://api.github.com/users/shivsood/gists{/gist_id}","starred_url":"https://api.github.com/users/shivsood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivsood/subscriptions","organizations_url":"https://api.github.com/users/shivsood/orgs","repos_url":"https://api.github.com/users/shivsood/repos","events_url":"https://api.github.com/users/shivsood/events{/privacy}","received_events_url":"https://api.github.com/users/shivsood/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/shivsood/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/shivsood/spark","forks_url":"https://api.github.com/repos/shivsood/spark/forks","keys_url":"https://api.github.com/repos/shivsood/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/shivsood/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/shivsood/spark/teams","hooks_url":"https://api.github.com/repos/shivsood/spark/hooks","issue_events_url":"https://api.github.com/repos/shivsood/spark/issues/events{/number}","events_url":"https://api.github.com/repos/shivsood/spark/events","assignees_url":"https://api.github.com/repos/shivsood/spark/assignees{/user}","branches_url":"https://api.github.com/repos/shivsood/spark/branches{/branch}","tags_url":"https://api.github.com/repos/shivsood/spark/tags","blobs_url":"https://api.github.com/repos/shivsood/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/shivsood/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/shivsood/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/shivsood/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/shivsood/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/shivsood/spark/languages","stargazers_url":"https://api.github.com/repos/shivsood/spark/stargazers","contributors_url":"https://api.github.com/repos/shivsood/spark/contributors","subscribers_url":"https://api.github.com/repos/shivsood/spark/subscribers","subscription_url":"https://api.github.com/repos/shivsood/spark/subscription","commits_url":"https://api.github.com/repos/shivsood/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/shivsood/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/shivsood/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/shivsood/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/shivsood/spark/contents/{+path}","compare_url":"https://api.github.com/repos/shivsood/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/shivsood/spark/merges","archive_url":"https://api.github.com/repos/shivsood/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/shivsood/spark/downloads","issues_url":"https://api.github.com/repos/shivsood/spark/issues{/number}","pulls_url":"https://api.github.com/repos/shivsood/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/shivsood/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/shivsood/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/shivsood/spark/labels{/name}","releases_url":"https://api.github.com/repos/shivsood/spark/releases{/id}","deployments_url":"https://api.github.com/repos/shivsood/spark/deployments","created_at":"2019-06-20T20:32:39Z","updated_at":"2019-07-20T16:13:38Z","pushed_at":"2020-01-10T23:29:29Z","git_url":"git://github.com/shivsood/spark.git","ssh_url":"git@github.com:shivsood/spark.git","clone_url":"https://github.com/shivsood/spark.git","svn_url":"https://github.com/shivsood/spark","homepage":"","size":321701,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7f9da2b7f8a2331ce403cd7afecfd874f8049c04","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25146"},"html":{"href":"https://github.com/apache/spark/pull/25146"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25146"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25146/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25146/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25146/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b25007ea329941801cba84f196b72fe34807947b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25145","id":297328272,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MzI4Mjcy","html_url":"https://github.com/apache/spark/pull/25145","diff_url":"https://github.com/apache/spark/pull/25145.diff","patch_url":"https://github.com/apache/spark/pull/25145.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25145","number":25145,"state":"closed","locked":false,"title":"[SPARK-28375][SQL] Make PullupCorrelatedPredicates idempotent","user":{"login":"mgaido91","id":8821783,"node_id":"MDQ6VXNlcjg4MjE3ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8821783?v=4","gravatar_id":"","url":"https://api.github.com/users/mgaido91","html_url":"https://github.com/mgaido91","followers_url":"https://api.github.com/users/mgaido91/followers","following_url":"https://api.github.com/users/mgaido91/following{/other_user}","gists_url":"https://api.github.com/users/mgaido91/gists{/gist_id}","starred_url":"https://api.github.com/users/mgaido91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgaido91/subscriptions","organizations_url":"https://api.github.com/users/mgaido91/orgs","repos_url":"https://api.github.com/users/mgaido91/repos","events_url":"https://api.github.com/users/mgaido91/events{/privacy}","received_events_url":"https://api.github.com/users/mgaido91/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nMultiple runs of `PullupCorrelatedPredicates` can produce invalid plans. Indeed, when there is a `Subquery` with a `Filter` a second run removes the conditions pulled by the previous run and overwrites them to nothing.\r\n\r\nThe PR avoids this issue and makes `PullupCorrelatedPredicates` idempotent.\r\n\r\n## How was this patch tested?\r\n\r\nadded UT","created_at":"2019-07-13T16:15:07Z","updated_at":"2019-07-15T19:52:08Z","closed_at":"2019-07-15T19:52:08Z","merged_at":null,"merge_commit_sha":"1c877add7e1c4bd4a5e46a42fdcd1b46f7f5d460","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25145/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25145/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25145/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d0a11d8c1b01ff11d3f2c69bfe7be737d6bb81c3","head":{"label":"mgaido91:SPARK-28375","ref":"SPARK-28375","sha":"d0a11d8c1b01ff11d3f2c69bfe7be737d6bb81c3","user":{"login":"mgaido91","id":8821783,"node_id":"MDQ6VXNlcjg4MjE3ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8821783?v=4","gravatar_id":"","url":"https://api.github.com/users/mgaido91","html_url":"https://github.com/mgaido91","followers_url":"https://api.github.com/users/mgaido91/followers","following_url":"https://api.github.com/users/mgaido91/following{/other_user}","gists_url":"https://api.github.com/users/mgaido91/gists{/gist_id}","starred_url":"https://api.github.com/users/mgaido91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgaido91/subscriptions","organizations_url":"https://api.github.com/users/mgaido91/orgs","repos_url":"https://api.github.com/users/mgaido91/repos","events_url":"https://api.github.com/users/mgaido91/events{/privacy}","received_events_url":"https://api.github.com/users/mgaido91/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":94518128,"node_id":"MDEwOlJlcG9zaXRvcnk5NDUxODEyOA==","name":"spark","full_name":"mgaido91/spark","private":false,"owner":{"login":"mgaido91","id":8821783,"node_id":"MDQ6VXNlcjg4MjE3ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8821783?v=4","gravatar_id":"","url":"https://api.github.com/users/mgaido91","html_url":"https://github.com/mgaido91","followers_url":"https://api.github.com/users/mgaido91/followers","following_url":"https://api.github.com/users/mgaido91/following{/other_user}","gists_url":"https://api.github.com/users/mgaido91/gists{/gist_id}","starred_url":"https://api.github.com/users/mgaido91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgaido91/subscriptions","organizations_url":"https://api.github.com/users/mgaido91/orgs","repos_url":"https://api.github.com/users/mgaido91/repos","events_url":"https://api.github.com/users/mgaido91/events{/privacy}","received_events_url":"https://api.github.com/users/mgaido91/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/mgaido91/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/mgaido91/spark","forks_url":"https://api.github.com/repos/mgaido91/spark/forks","keys_url":"https://api.github.com/repos/mgaido91/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/mgaido91/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/mgaido91/spark/teams","hooks_url":"https://api.github.com/repos/mgaido91/spark/hooks","issue_events_url":"https://api.github.com/repos/mgaido91/spark/issues/events{/number}","events_url":"https://api.github.com/repos/mgaido91/spark/events","assignees_url":"https://api.github.com/repos/mgaido91/spark/assignees{/user}","branches_url":"https://api.github.com/repos/mgaido91/spark/branches{/branch}","tags_url":"https://api.github.com/repos/mgaido91/spark/tags","blobs_url":"https://api.github.com/repos/mgaido91/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/mgaido91/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/mgaido91/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/mgaido91/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/mgaido91/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/mgaido91/spark/languages","stargazers_url":"https://api.github.com/repos/mgaido91/spark/stargazers","contributors_url":"https://api.github.com/repos/mgaido91/spark/contributors","subscribers_url":"https://api.github.com/repos/mgaido91/spark/subscribers","subscription_url":"https://api.github.com/repos/mgaido91/spark/subscription","commits_url":"https://api.github.com/repos/mgaido91/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/mgaido91/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/mgaido91/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/mgaido91/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/mgaido91/spark/contents/{+path}","compare_url":"https://api.github.com/repos/mgaido91/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/mgaido91/spark/merges","archive_url":"https://api.github.com/repos/mgaido91/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/mgaido91/spark/downloads","issues_url":"https://api.github.com/repos/mgaido91/spark/issues{/number}","pulls_url":"https://api.github.com/repos/mgaido91/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/mgaido91/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/mgaido91/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/mgaido91/spark/labels{/name}","releases_url":"https://api.github.com/repos/mgaido91/spark/releases{/id}","deployments_url":"https://api.github.com/repos/mgaido91/spark/deployments","created_at":"2017-06-16T07:34:38Z","updated_at":"2017-06-16T07:35:05Z","pushed_at":"2019-12-04T21:06:00Z","git_url":"git://github.com/mgaido91/spark.git","ssh_url":"git@github.com:mgaido91/spark.git","clone_url":"https://github.com/mgaido91/spark.git","svn_url":"https://github.com/mgaido91/spark","homepage":null,"size":320625,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"79e204770300dab4a669b9f8e2421ef905236e7b","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25145"},"html":{"href":"https://github.com/apache/spark/pull/25145"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25145"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25145/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25145/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25145/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d0a11d8c1b01ff11d3f2c69bfe7be737d6bb81c3"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25144","id":297320784,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MzIwNzg0","html_url":"https://github.com/apache/spark/pull/25144","diff_url":"https://github.com/apache/spark/pull/25144.diff","patch_url":"https://github.com/apache/spark/pull/25144.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25144","number":25144,"state":"closed","locked":false,"title":"[SPARK-28369][SQL] Honor spark.sql.decimalOperations.nullOnOverflow in ScalaUDF result","user":{"login":"mgaido91","id":8821783,"node_id":"MDQ6VXNlcjg4MjE3ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8821783?v=4","gravatar_id":"","url":"https://api.github.com/users/mgaido91","html_url":"https://github.com/mgaido91","followers_url":"https://api.github.com/users/mgaido91/followers","following_url":"https://api.github.com/users/mgaido91/following{/other_user}","gists_url":"https://api.github.com/users/mgaido91/gists{/gist_id}","starred_url":"https://api.github.com/users/mgaido91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgaido91/subscriptions","organizations_url":"https://api.github.com/users/mgaido91/orgs","repos_url":"https://api.github.com/users/mgaido91/repos","events_url":"https://api.github.com/users/mgaido91/events{/privacy}","received_events_url":"https://api.github.com/users/mgaido91/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nWhen a `ScalaUDF` returns a value which overflows, currently it returns null regardless of the value of the config `spark.sql.decimalOperations.nullOnOverflow`.\r\n\r\nThe PR makes it respect the above-mentioned config and behave accordingly.\r\n\r\n## How was this patch tested?\r\n\r\nadded UT\r\n","created_at":"2019-07-13T14:44:45Z","updated_at":"2019-07-22T07:01:00Z","closed_at":"2019-07-22T02:44:28Z","merged_at":null,"merge_commit_sha":"77411fc65a35713d81a1ae739bd28452ee878eb3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25144/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25144/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25144/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/cc95f00798be1ea70eb987a54af92bb9efbe5193","head":{"label":"mgaido91:SPARK-28369","ref":"SPARK-28369","sha":"cc95f00798be1ea70eb987a54af92bb9efbe5193","user":{"login":"mgaido91","id":8821783,"node_id":"MDQ6VXNlcjg4MjE3ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8821783?v=4","gravatar_id":"","url":"https://api.github.com/users/mgaido91","html_url":"https://github.com/mgaido91","followers_url":"https://api.github.com/users/mgaido91/followers","following_url":"https://api.github.com/users/mgaido91/following{/other_user}","gists_url":"https://api.github.com/users/mgaido91/gists{/gist_id}","starred_url":"https://api.github.com/users/mgaido91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgaido91/subscriptions","organizations_url":"https://api.github.com/users/mgaido91/orgs","repos_url":"https://api.github.com/users/mgaido91/repos","events_url":"https://api.github.com/users/mgaido91/events{/privacy}","received_events_url":"https://api.github.com/users/mgaido91/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":94518128,"node_id":"MDEwOlJlcG9zaXRvcnk5NDUxODEyOA==","name":"spark","full_name":"mgaido91/spark","private":false,"owner":{"login":"mgaido91","id":8821783,"node_id":"MDQ6VXNlcjg4MjE3ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8821783?v=4","gravatar_id":"","url":"https://api.github.com/users/mgaido91","html_url":"https://github.com/mgaido91","followers_url":"https://api.github.com/users/mgaido91/followers","following_url":"https://api.github.com/users/mgaido91/following{/other_user}","gists_url":"https://api.github.com/users/mgaido91/gists{/gist_id}","starred_url":"https://api.github.com/users/mgaido91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgaido91/subscriptions","organizations_url":"https://api.github.com/users/mgaido91/orgs","repos_url":"https://api.github.com/users/mgaido91/repos","events_url":"https://api.github.com/users/mgaido91/events{/privacy}","received_events_url":"https://api.github.com/users/mgaido91/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/mgaido91/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/mgaido91/spark","forks_url":"https://api.github.com/repos/mgaido91/spark/forks","keys_url":"https://api.github.com/repos/mgaido91/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/mgaido91/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/mgaido91/spark/teams","hooks_url":"https://api.github.com/repos/mgaido91/spark/hooks","issue_events_url":"https://api.github.com/repos/mgaido91/spark/issues/events{/number}","events_url":"https://api.github.com/repos/mgaido91/spark/events","assignees_url":"https://api.github.com/repos/mgaido91/spark/assignees{/user}","branches_url":"https://api.github.com/repos/mgaido91/spark/branches{/branch}","tags_url":"https://api.github.com/repos/mgaido91/spark/tags","blobs_url":"https://api.github.com/repos/mgaido91/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/mgaido91/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/mgaido91/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/mgaido91/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/mgaido91/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/mgaido91/spark/languages","stargazers_url":"https://api.github.com/repos/mgaido91/spark/stargazers","contributors_url":"https://api.github.com/repos/mgaido91/spark/contributors","subscribers_url":"https://api.github.com/repos/mgaido91/spark/subscribers","subscription_url":"https://api.github.com/repos/mgaido91/spark/subscription","commits_url":"https://api.github.com/repos/mgaido91/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/mgaido91/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/mgaido91/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/mgaido91/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/mgaido91/spark/contents/{+path}","compare_url":"https://api.github.com/repos/mgaido91/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/mgaido91/spark/merges","archive_url":"https://api.github.com/repos/mgaido91/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/mgaido91/spark/downloads","issues_url":"https://api.github.com/repos/mgaido91/spark/issues{/number}","pulls_url":"https://api.github.com/repos/mgaido91/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/mgaido91/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/mgaido91/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/mgaido91/spark/labels{/name}","releases_url":"https://api.github.com/repos/mgaido91/spark/releases{/id}","deployments_url":"https://api.github.com/repos/mgaido91/spark/deployments","created_at":"2017-06-16T07:34:38Z","updated_at":"2017-06-16T07:35:05Z","pushed_at":"2019-12-04T21:06:00Z","git_url":"git://github.com/mgaido91/spark.git","ssh_url":"git@github.com:mgaido91/spark.git","clone_url":"https://github.com/mgaido91/spark.git","svn_url":"https://github.com/mgaido91/spark","homepage":null,"size":320625,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"60b89cf8097ff583a29a6a19f1db4afa780f3109","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25144"},"html":{"href":"https://github.com/apache/spark/pull/25144"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25144"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25144/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25144/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25144/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/cc95f00798be1ea70eb987a54af92bb9efbe5193"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null}]