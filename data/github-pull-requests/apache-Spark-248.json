[{"url":"https://api.github.com/repos/apache/spark/pulls/25143","id":297290219,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MjkwMjE5","html_url":"https://github.com/apache/spark/pull/25143","diff_url":"https://github.com/apache/spark/pull/25143.diff","patch_url":"https://github.com/apache/spark/pull/25143.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25143","number":25143,"state":"closed","locked":false,"title":"[SPARK-28381][PYSPARK] Upgraded version of Pyrolite to 4.30","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis upgraded to a newer version of Pyrolite. Most updates [1] in the newer version are for dotnot. For java, it includes a bug fix to Unpickler regarding cleaning up Unpickler memo, and support of protocol 5.\r\n\r\nAfter upgrading, we can remove the fix at SPARK-27629 for the bug in Unpickler.\r\n\r\n[1] https://github.com/irmen/Pyrolite/compare/pyrolite-4.23...master\r\n\r\n## How was this patch tested?\r\n\r\nManually tested on Python 3.6 in local on existing tests.\r\n","created_at":"2019-07-13T07:31:50Z","updated_at":"2023-12-27T18:22:41Z","closed_at":"2019-07-15T03:34:28Z","merged_at":null,"merge_commit_sha":"f348bb77723a72e06443c48c3bcd5b35da06d0fa","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25143/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25143/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25143/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/287cfbd37b767d80f1cfc55d97decd31675fd116","head":{"label":"viirya:upgrade-pyrolite","ref":"upgrade-pyrolite","sha":"287cfbd37b767d80f1cfc55d97decd31675fd116","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"60b89cf8097ff583a29a6a19f1db4afa780f3109","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25143"},"html":{"href":"https://github.com/apache/spark/pull/25143"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25143"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25143/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25143/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25143/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/287cfbd37b767d80f1cfc55d97decd31675fd116"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25142","id":297289368,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3Mjg5MzY4","html_url":"https://github.com/apache/spark/pull/25142","diff_url":"https://github.com/apache/spark/pull/25142.diff","patch_url":"https://github.com/apache/spark/pull/25142.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25142","number":25142,"state":"closed","locked":false,"title":"[SPARK-28378][Python] Remove usage of cgi.escape","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n`cgi.escape` is deprecated [1], and removed at 3.8 [2]. We better to replace it.\r\n\r\n[1] https://docs.python.org/3/library/cgi.html#cgi.escape.\r\n[2] https://docs.python.org/3.8/whatsnew/3.8.html#api-and-feature-removals\r\n\r\n## How was this patch tested?\r\n\r\nExisting tests.","created_at":"2019-07-13T07:18:26Z","updated_at":"2023-12-27T18:37:41Z","closed_at":"2019-07-14T06:30:48Z","merged_at":null,"merge_commit_sha":"4a479128285b1268b473c16925b49ec57927029b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25142/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25142/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25142/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b924ce9718ea3c919c135f983977c4c7a972769d","head":{"label":"viirya:remove-cgi-escape","ref":"remove-cgi-escape","sha":"b924ce9718ea3c919c135f983977c4c7a972769d","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"60b89cf8097ff583a29a6a19f1db4afa780f3109","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25142"},"html":{"href":"https://github.com/apache/spark/pull/25142"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25142"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25142/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25142/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25142/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b924ce9718ea3c919c135f983977c4c7a972769d"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25141","id":297163114,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MTYzMTE0","html_url":"https://github.com/apache/spark/pull/25141","diff_url":"https://github.com/apache/spark/pull/25141.diff","patch_url":"https://github.com/apache/spark/pull/25141.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25141","number":25141,"state":"closed","locked":false,"title":"[SPARK-28150][core][follow-up] Don't try to log in when impersonating.","user":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"When fetching delegation tokens for a proxy user, don't try to log in,\r\nsince it will fail.","created_at":"2019-07-12T17:40:53Z","updated_at":"2019-07-15T17:58:06Z","closed_at":"2019-07-15T17:37:14Z","merged_at":null,"merge_commit_sha":"268ca3599742625ab9cb75a86d9c8ba57f86e8d4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25141/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25141/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25141/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b0a833de0805e3864240fc0e0dde40bc683f1293","head":{"label":"vanzin:SPARK-28150.2","ref":"SPARK-28150.2","sha":"b0a833de0805e3864240fc0e0dde40bc683f1293","user":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":18302272,"node_id":"MDEwOlJlcG9zaXRvcnkxODMwMjI3Mg==","name":"spark","full_name":"vanzin/spark","private":false,"owner":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vanzin/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/vanzin/spark","forks_url":"https://api.github.com/repos/vanzin/spark/forks","keys_url":"https://api.github.com/repos/vanzin/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vanzin/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vanzin/spark/teams","hooks_url":"https://api.github.com/repos/vanzin/spark/hooks","issue_events_url":"https://api.github.com/repos/vanzin/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vanzin/spark/events","assignees_url":"https://api.github.com/repos/vanzin/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vanzin/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vanzin/spark/tags","blobs_url":"https://api.github.com/repos/vanzin/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vanzin/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vanzin/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vanzin/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vanzin/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vanzin/spark/languages","stargazers_url":"https://api.github.com/repos/vanzin/spark/stargazers","contributors_url":"https://api.github.com/repos/vanzin/spark/contributors","subscribers_url":"https://api.github.com/repos/vanzin/spark/subscribers","subscription_url":"https://api.github.com/repos/vanzin/spark/subscription","commits_url":"https://api.github.com/repos/vanzin/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vanzin/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vanzin/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vanzin/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vanzin/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vanzin/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vanzin/spark/merges","archive_url":"https://api.github.com/repos/vanzin/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vanzin/spark/downloads","issues_url":"https://api.github.com/repos/vanzin/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vanzin/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vanzin/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vanzin/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vanzin/spark/labels{/name}","releases_url":"https://api.github.com/repos/vanzin/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vanzin/spark/deployments","created_at":"2014-03-31T17:49:25Z","updated_at":"2018-01-06T03:57:54Z","pushed_at":"2020-01-24T16:55:58Z","git_url":"git://github.com/vanzin/spark.git","ssh_url":"git@github.com:vanzin/spark.git","clone_url":"https://github.com/vanzin/spark.git","svn_url":"https://github.com/vanzin/spark","homepage":null,"size":287134,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"687dd4eb55739f802692b3c5457618fd6558e538","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25141"},"html":{"href":"https://github.com/apache/spark/pull/25141"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25141"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25141/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25141/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25141/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b0a833de0805e3864240fc0e0dde40bc683f1293"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25140","id":297161388,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MTYxMzg4","html_url":"https://github.com/apache/spark/pull/25140","diff_url":"https://github.com/apache/spark/pull/25140.diff","patch_url":"https://github.com/apache/spark/pull/25140.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25140","number":25140,"state":"closed","locked":false,"title":"[SPARK-28371][SQL] Make Parquet \"StartsWith\" filter null-safe","user":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"Parquet may call the filter with a null value to check whether nulls are\r\naccepted. While it seems Spark avoids that path in Parquet with 1.10, in\r\n1.11 that causes Spark unit tests to fail.\r\n\r\nTested with Parquet 1.11 (and new unit test).","created_at":"2019-07-12T17:35:22Z","updated_at":"2019-07-15T17:58:13Z","closed_at":"2019-07-13T18:44:12Z","merged_at":null,"merge_commit_sha":"ab31abfba735adbf6f6630ef6865e29bb965b3d5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25140/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25140/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25140/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/63c0aba3b00d87073e5965c83eaae5b80495c9aa","head":{"label":"vanzin:SPARK-28371","ref":"SPARK-28371","sha":"63c0aba3b00d87073e5965c83eaae5b80495c9aa","user":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":18302272,"node_id":"MDEwOlJlcG9zaXRvcnkxODMwMjI3Mg==","name":"spark","full_name":"vanzin/spark","private":false,"owner":{"login":"vanzin","id":1694083,"node_id":"MDQ6VXNlcjE2OTQwODM=","avatar_url":"https://avatars.githubusercontent.com/u/1694083?v=4","gravatar_id":"","url":"https://api.github.com/users/vanzin","html_url":"https://github.com/vanzin","followers_url":"https://api.github.com/users/vanzin/followers","following_url":"https://api.github.com/users/vanzin/following{/other_user}","gists_url":"https://api.github.com/users/vanzin/gists{/gist_id}","starred_url":"https://api.github.com/users/vanzin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanzin/subscriptions","organizations_url":"https://api.github.com/users/vanzin/orgs","repos_url":"https://api.github.com/users/vanzin/repos","events_url":"https://api.github.com/users/vanzin/events{/privacy}","received_events_url":"https://api.github.com/users/vanzin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vanzin/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/vanzin/spark","forks_url":"https://api.github.com/repos/vanzin/spark/forks","keys_url":"https://api.github.com/repos/vanzin/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vanzin/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vanzin/spark/teams","hooks_url":"https://api.github.com/repos/vanzin/spark/hooks","issue_events_url":"https://api.github.com/repos/vanzin/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vanzin/spark/events","assignees_url":"https://api.github.com/repos/vanzin/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vanzin/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vanzin/spark/tags","blobs_url":"https://api.github.com/repos/vanzin/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vanzin/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vanzin/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vanzin/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vanzin/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vanzin/spark/languages","stargazers_url":"https://api.github.com/repos/vanzin/spark/stargazers","contributors_url":"https://api.github.com/repos/vanzin/spark/contributors","subscribers_url":"https://api.github.com/repos/vanzin/spark/subscribers","subscription_url":"https://api.github.com/repos/vanzin/spark/subscription","commits_url":"https://api.github.com/repos/vanzin/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vanzin/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vanzin/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vanzin/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vanzin/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vanzin/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vanzin/spark/merges","archive_url":"https://api.github.com/repos/vanzin/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vanzin/spark/downloads","issues_url":"https://api.github.com/repos/vanzin/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vanzin/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vanzin/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vanzin/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vanzin/spark/labels{/name}","releases_url":"https://api.github.com/repos/vanzin/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vanzin/spark/deployments","created_at":"2014-03-31T17:49:25Z","updated_at":"2018-01-06T03:57:54Z","pushed_at":"2020-01-24T16:55:58Z","git_url":"git://github.com/vanzin/spark.git","ssh_url":"git@github.com:vanzin/spark.git","clone_url":"https://github.com/vanzin/spark.git","svn_url":"https://github.com/vanzin/spark","homepage":null,"size":287134,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"687dd4eb55739f802692b3c5457618fd6558e538","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25140"},"html":{"href":"https://github.com/apache/spark/pull/25140"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25140"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25140/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25140/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25140/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/63c0aba3b00d87073e5965c83eaae5b80495c9aa"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25139","id":297141654,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MTQxNjU0","html_url":"https://github.com/apache/spark/pull/25139","diff_url":"https://github.com/apache/spark/pull/25139.diff","patch_url":"https://github.com/apache/spark/pull/25139.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25139","number":25139,"state":"closed","locked":false,"title":"[SPARK-28370][BUILD][TEST] Upgrade Mockito to 2.28.2","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR aims to upgrade Mockito from **2.23.4** to **2.28.2** in order to bring the latest bug fixes and to be up-to-date for JDK9+ support before Apache Spark 3.0.0. There is Mockito 3.0 released 4 days ago, but we had better wait and see for the stability.\r\n\r\n**RELEASE NOTE**\r\nhttps://github.com/mockito/mockito/blob/release/2.x/doc/release-notes/official.md\r\n\r\n**NOTABLE FIXES**\r\n- Configure the MethodVisitor for Java 11+ compatibility (2.27.5)\r\n- When mock is called multiple times, and verify fails, the error message reports only the first invocation (2.27.4)\r\n- Memory leak in mockito-inline calling method on mock with at least a mock as parameter (2.25.0)\r\n- Cross-references and a single spy cause memory leak (2.25.0)\r\n- Nested spies cause memory leaks (2.25.0)\r\n- [Java 9 support] ClassCastExceptions with JDK9 javac (2.24.9, 2.24.3)\r\n- Return null instead of causing a CCE (2.24.9, 2.24.3)\r\n- Issue with mocking type in \"java.util.*\", Java 12 (2.24.2)\r\n\r\nMainly, Maven (Hadoop-2.7/Hadoop-3.2) and SBT(Hadoop-2.7) Jenkins test passed.\r\n\r\n## How was this patch tested?\r\n\r\nPass the Jenkins with the exiting UTs.","created_at":"2019-07-12T16:30:34Z","updated_at":"2019-07-13T20:04:48Z","closed_at":"2019-07-13T20:04:48Z","merged_at":null,"merge_commit_sha":"45e0946118fd5c19bf37dc2d70a1c6719496fae5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null},{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25139/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25139/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25139/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5d9758a3cbe7fd5039e01d3d3f02a230ccb51777","head":{"label":"dongjoon-hyun:SPARK-28370","ref":"SPARK-28370","sha":"5d9758a3cbe7fd5039e01d3d3f02a230ccb51777","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"1a26126d8c5e9bb647f858db236c370685f2f2da","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25139"},"html":{"href":"https://github.com/apache/spark/pull/25139"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25139"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25139/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25139/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25139/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5d9758a3cbe7fd5039e01d3d3f02a230ccb51777"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25138","id":297123641,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MTIzNjQx","html_url":"https://github.com/apache/spark/pull/25138","diff_url":"https://github.com/apache/spark/pull/25138.diff","patch_url":"https://github.com/apache/spark/pull/25138.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25138","number":25138,"state":"closed","locked":false,"title":"[SPARK-26175][PYTHON] Redirect the standard input of the forked child to devnull in daemon","user":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nPySpark worker daemon reads from stdin the worker PIDs to kill. https://github.com/apache/spark/blob/1bb60ab8392adf8b896cc04fb1d060620cf09d8a/python/pyspark/daemon.py#L127\r\n\r\nHowever, the worker process is a forked process from the worker daemon process and we didn't close stdin on the child after fork. This means the child and user program can read stdin as well, which blocks daemon from receiving the PID to kill. This can cause issues because the task reaper might detect the task was not terminated and eventually kill the JVM.\r\n\r\nThis PR fix this by redirecting the standard input of the forked child to devnull.\r\n\r\n## How was this patch tested?\r\n\r\nManually test.\r\n\r\nIn `pyspark`, run:\r\n```\r\nimport subprocess\r\ndef task(_):\r\n  subprocess.check_output([\"cat\"])\r\n\r\nsc.parallelize(range(1), 1).mapPartitions(task).count()\r\n```\r\n\r\nBefore:\r\nThe job will get stuck and press Ctrl+C to exit the job but the python worker process do not exit.\r\nAfter:\r\nThe job finish correctly. The \"cat\" print nothing (because the dummay stdin is \"/dev/null\").\r\nThe python worker process exit normally.\r\n\r\nPlease review https://spark.apache.org/contributing.html before opening a pull request.\r\n","created_at":"2019-07-12T15:37:46Z","updated_at":"2019-07-31T00:15:03Z","closed_at":"2019-07-31T00:15:03Z","merged_at":null,"merge_commit_sha":"3800a20ba07d61eea8ae513293becd2c06fbf6f8","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25138/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25138/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25138/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/51b1a660d663d5b0ae5c521072ca15563a59b9de","head":{"label":"WeichenXu123:SPARK-26175","ref":"SPARK-26175","sha":"51b1a660d663d5b0ae5c521072ca15563a59b9de","user":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":58255485,"node_id":"MDEwOlJlcG9zaXRvcnk1ODI1NTQ4NQ==","name":"spark","full_name":"WeichenXu123/spark","private":false,"owner":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/WeichenXu123/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/WeichenXu123/spark","forks_url":"https://api.github.com/repos/WeichenXu123/spark/forks","keys_url":"https://api.github.com/repos/WeichenXu123/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/WeichenXu123/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/WeichenXu123/spark/teams","hooks_url":"https://api.github.com/repos/WeichenXu123/spark/hooks","issue_events_url":"https://api.github.com/repos/WeichenXu123/spark/issues/events{/number}","events_url":"https://api.github.com/repos/WeichenXu123/spark/events","assignees_url":"https://api.github.com/repos/WeichenXu123/spark/assignees{/user}","branches_url":"https://api.github.com/repos/WeichenXu123/spark/branches{/branch}","tags_url":"https://api.github.com/repos/WeichenXu123/spark/tags","blobs_url":"https://api.github.com/repos/WeichenXu123/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/WeichenXu123/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/WeichenXu123/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/WeichenXu123/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/WeichenXu123/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/WeichenXu123/spark/languages","stargazers_url":"https://api.github.com/repos/WeichenXu123/spark/stargazers","contributors_url":"https://api.github.com/repos/WeichenXu123/spark/contributors","subscribers_url":"https://api.github.com/repos/WeichenXu123/spark/subscribers","subscription_url":"https://api.github.com/repos/WeichenXu123/spark/subscription","commits_url":"https://api.github.com/repos/WeichenXu123/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/WeichenXu123/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/WeichenXu123/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/WeichenXu123/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/WeichenXu123/spark/contents/{+path}","compare_url":"https://api.github.com/repos/WeichenXu123/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/WeichenXu123/spark/merges","archive_url":"https://api.github.com/repos/WeichenXu123/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/WeichenXu123/spark/downloads","issues_url":"https://api.github.com/repos/WeichenXu123/spark/issues{/number}","pulls_url":"https://api.github.com/repos/WeichenXu123/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/WeichenXu123/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/WeichenXu123/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/WeichenXu123/spark/labels{/name}","releases_url":"https://api.github.com/repos/WeichenXu123/spark/releases{/id}","deployments_url":"https://api.github.com/repos/WeichenXu123/spark/deployments","created_at":"2016-05-07T07:45:37Z","updated_at":"2022-01-25T15:06:54Z","pushed_at":"2024-11-04T12:27:24Z","git_url":"git://github.com/WeichenXu123/spark.git","ssh_url":"git@github.com:WeichenXu123/spark.git","clone_url":"https://github.com/WeichenXu123/spark.git","svn_url":"https://github.com/WeichenXu123/spark","homepage":null,"size":436946,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2656c9d304b59584c331b923e8536e4093d83f81","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25138"},"html":{"href":"https://github.com/apache/spark/pull/25138"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25138"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25138/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25138/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25138/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/51b1a660d663d5b0ae5c521072ca15563a59b9de"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25137","id":297103627,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MTAzNjI3","html_url":"https://github.com/apache/spark/pull/25137","diff_url":"https://github.com/apache/spark/pull/25137.diff","patch_url":"https://github.com/apache/spark/pull/25137.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25137","number":25137,"state":"closed","locked":false,"title":"[SPARK-28348][SQL] Decimal precision promotion for binary arithmetic with casted decimal type","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nHow to reproduce this issue:\r\n```sql\r\ncreate table spark_28348 using parquet as select * from values\r\n  (cast(-34338492.215397047 as decimal(38, 18)))\r\n  as v(c1);\r\n```\r\n```shell\r\nscala> spark.sql(\"select cast(c1 * cast(-34338492.215397047 as decimal(38, 18)) as decimal(38, 18)) as c1 from spark_28348\").show(false)\r\n+-----------------------------------+\r\n|c1                                 |\r\n+-----------------------------------+\r\n|1179132047626883.596862000000000000|\r\n+-----------------------------------+\r\n\r\n\r\nscala> spark.sql(\"select cast(c1 * cast(-34338492.215397047 as decimal(38, 18)) as decimal(38, 18)) as c1 from spark_28348\").explain(false);\r\n== Physical Plan ==\r\n*(1) Project [cast(CheckOverflow((promote_precision(c1#1) * -34338492.215397047000000000), DecimalType(38,6), true) as decimal(38,18)) AS c1#13]\r\n+- *(1) ColumnarToRow\r\n   +- FileScan parquet default.spark_28348[c1#1] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/user/hive/warehouse/spark_28348], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<c1:decimal(38,18)>\r\n```\r\n\r\nIt first `CheckOverflow` with `DecimalType(38,6)` and then cast to `decimal(38,18)`.\r\nWe can use `decimal(38,18)` to `CheckOverflow`. This has two benefits:\r\n1. Reduce one cast.\r\n2. Higher data precision.\r\n\r\nAfter this PR:\r\n```shell\r\nscala> spark.sql(\"select cast(c1 * cast(-34338492.215397047 as decimal(38, 18)) as decimal(38, 18)) as c1 from spark_28348\").show(false)\r\n+-----------------------------------+\r\n|c1                                 |\r\n+-----------------------------------+\r\n|1179132047626883.596862135856320209|\r\n+-----------------------------------+\r\n\r\n\r\nscala> spark.sql(\"select cast(c1 * cast(-34338492.215397047 as decimal(38, 18)) as decimal(38, 18)) as c1 from spark_28348\").explain(false);\r\n== Physical Plan ==\r\n*(1) Project [CheckOverflow((promote_precision(c1#1) * -34338492.215397047000000000), DecimalType(38,18), true) AS c1#17]\r\n+- *(1) ColumnarToRow\r\n   +- FileScan parquet default.spark_28348[c1#1] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/user/hive/warehouse/spark_28348], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<c1:decimal(38,18)>\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nunit tests\r\n\r\n","created_at":"2019-07-12T14:47:54Z","updated_at":"2019-07-31T03:23:13Z","closed_at":"2019-07-31T03:23:13Z","merged_at":null,"merge_commit_sha":"69eb09dd897c82bdd12a39241d93d0e7e558af0a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25137/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25137/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25137/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a1d21e4f99ff9933ae470eb5f3ff9e8e0db4ec22","head":{"label":"wangyum:SPARK-28348","ref":"SPARK-28348","sha":"a1d21e4f99ff9933ae470eb5f3ff9e8e0db4ec22","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"1a26126d8c5e9bb647f858db236c370685f2f2da","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25137"},"html":{"href":"https://github.com/apache/spark/pull/25137"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25137"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25137/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25137/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25137/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a1d21e4f99ff9933ae470eb5f3ff9e8e0db4ec22"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25136","id":297097224,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MDk3MjI0","html_url":"https://github.com/apache/spark/pull/25136","diff_url":"https://github.com/apache/spark/pull/25136.diff","patch_url":"https://github.com/apache/spark/pull/25136.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25136","number":25136,"state":"closed","locked":false,"title":"[SPARK-28322][SQL] Add support to Decimal type for integral divide","user":{"login":"mgaido91","id":8821783,"node_id":"MDQ6VXNlcjg4MjE3ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8821783?v=4","gravatar_id":"","url":"https://api.github.com/users/mgaido91","html_url":"https://github.com/mgaido91","followers_url":"https://api.github.com/users/mgaido91/followers","following_url":"https://api.github.com/users/mgaido91/following{/other_user}","gists_url":"https://api.github.com/users/mgaido91/gists{/gist_id}","starred_url":"https://api.github.com/users/mgaido91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgaido91/subscriptions","organizations_url":"https://api.github.com/users/mgaido91/orgs","repos_url":"https://api.github.com/users/mgaido91/repos","events_url":"https://api.github.com/users/mgaido91/events{/privacy}","received_events_url":"https://api.github.com/users/mgaido91/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe expression `IntegralDivide`, which corresponds to the `div` operator, support only integral type. Postgres, though, allows it to work also with decimals.\r\n\r\nThe PR adds the support to decimal operands for this operation in order to have feature parity with postgres.\r\n\r\n## How was this patch tested?\r\n\r\nadded UTs","created_at":"2019-07-12T14:32:00Z","updated_at":"2019-09-02T11:08:03Z","closed_at":"2019-08-20T23:43:40Z","merged_at":null,"merge_commit_sha":"ec40a86dcca4dd705a4f89908b24274f1fe834b3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25136/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25136/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25136/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8caf4a95376623bd6f1e3e999c49be69e726852e","head":{"label":"mgaido91:SPARK-28322","ref":"SPARK-28322","sha":"8caf4a95376623bd6f1e3e999c49be69e726852e","user":{"login":"mgaido91","id":8821783,"node_id":"MDQ6VXNlcjg4MjE3ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8821783?v=4","gravatar_id":"","url":"https://api.github.com/users/mgaido91","html_url":"https://github.com/mgaido91","followers_url":"https://api.github.com/users/mgaido91/followers","following_url":"https://api.github.com/users/mgaido91/following{/other_user}","gists_url":"https://api.github.com/users/mgaido91/gists{/gist_id}","starred_url":"https://api.github.com/users/mgaido91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgaido91/subscriptions","organizations_url":"https://api.github.com/users/mgaido91/orgs","repos_url":"https://api.github.com/users/mgaido91/repos","events_url":"https://api.github.com/users/mgaido91/events{/privacy}","received_events_url":"https://api.github.com/users/mgaido91/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":94518128,"node_id":"MDEwOlJlcG9zaXRvcnk5NDUxODEyOA==","name":"spark","full_name":"mgaido91/spark","private":false,"owner":{"login":"mgaido91","id":8821783,"node_id":"MDQ6VXNlcjg4MjE3ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8821783?v=4","gravatar_id":"","url":"https://api.github.com/users/mgaido91","html_url":"https://github.com/mgaido91","followers_url":"https://api.github.com/users/mgaido91/followers","following_url":"https://api.github.com/users/mgaido91/following{/other_user}","gists_url":"https://api.github.com/users/mgaido91/gists{/gist_id}","starred_url":"https://api.github.com/users/mgaido91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgaido91/subscriptions","organizations_url":"https://api.github.com/users/mgaido91/orgs","repos_url":"https://api.github.com/users/mgaido91/repos","events_url":"https://api.github.com/users/mgaido91/events{/privacy}","received_events_url":"https://api.github.com/users/mgaido91/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/mgaido91/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/mgaido91/spark","forks_url":"https://api.github.com/repos/mgaido91/spark/forks","keys_url":"https://api.github.com/repos/mgaido91/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/mgaido91/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/mgaido91/spark/teams","hooks_url":"https://api.github.com/repos/mgaido91/spark/hooks","issue_events_url":"https://api.github.com/repos/mgaido91/spark/issues/events{/number}","events_url":"https://api.github.com/repos/mgaido91/spark/events","assignees_url":"https://api.github.com/repos/mgaido91/spark/assignees{/user}","branches_url":"https://api.github.com/repos/mgaido91/spark/branches{/branch}","tags_url":"https://api.github.com/repos/mgaido91/spark/tags","blobs_url":"https://api.github.com/repos/mgaido91/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/mgaido91/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/mgaido91/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/mgaido91/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/mgaido91/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/mgaido91/spark/languages","stargazers_url":"https://api.github.com/repos/mgaido91/spark/stargazers","contributors_url":"https://api.github.com/repos/mgaido91/spark/contributors","subscribers_url":"https://api.github.com/repos/mgaido91/spark/subscribers","subscription_url":"https://api.github.com/repos/mgaido91/spark/subscription","commits_url":"https://api.github.com/repos/mgaido91/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/mgaido91/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/mgaido91/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/mgaido91/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/mgaido91/spark/contents/{+path}","compare_url":"https://api.github.com/repos/mgaido91/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/mgaido91/spark/merges","archive_url":"https://api.github.com/repos/mgaido91/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/mgaido91/spark/downloads","issues_url":"https://api.github.com/repos/mgaido91/spark/issues{/number}","pulls_url":"https://api.github.com/repos/mgaido91/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/mgaido91/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/mgaido91/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/mgaido91/spark/labels{/name}","releases_url":"https://api.github.com/repos/mgaido91/spark/releases{/id}","deployments_url":"https://api.github.com/repos/mgaido91/spark/deployments","created_at":"2017-06-16T07:34:38Z","updated_at":"2017-06-16T07:35:05Z","pushed_at":"2019-12-04T21:06:00Z","git_url":"git://github.com/mgaido91/spark.git","ssh_url":"git@github.com:mgaido91/spark.git","clone_url":"https://github.com/mgaido91/spark.git","svn_url":"https://github.com/mgaido91/spark","homepage":null,"size":320625,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"ef80c3226610cc69e04eaf800e00498c7c23c1fb","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25136"},"html":{"href":"https://github.com/apache/spark/pull/25136"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25136"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25136/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25136/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25136/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8caf4a95376623bd6f1e3e999c49be69e726852e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25135","id":297043849,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MDQzODQ5","html_url":"https://github.com/apache/spark/pull/25135","diff_url":"https://github.com/apache/spark/pull/25135.diff","patch_url":"https://github.com/apache/spark/pull/25135.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25135","number":25135,"state":"closed","locked":false,"title":"[SPARK-28367][SS] Use new KafkaConsumer.poll API in Kafka connector","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nSpark uses an old and deprecated API named `KafkaConsumer.poll(long)` which never returns and stays in live lock if metadata is not updated (for instance when broker disappears at consumer creation). Please see [Kafka documentation](https://kafka.apache.org/23/javadoc/org/apache/kafka/clients/consumer/KafkaConsumer.html#poll-long-) and [standalone test application](https://github.com/gaborgsomogyi/kafka-get-assignment) for further details.\r\n\r\nIn this PR I've applied the new `KafkaConsumer.poll(Duration)` API.\r\n\r\n## How was this patch tested?\r\n\r\nExisting unit tests + started Kafka to Kafka query on cluster.\r\n","created_at":"2019-07-12T12:08:52Z","updated_at":"2020-06-19T15:37:04Z","closed_at":"2019-08-14T08:26:37Z","merged_at":null,"merge_commit_sha":"c38678e1d67cc989219ded8cf6eddb4fe8329d04","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25135/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25135/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25135/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/82f1520246f9a3304288f7f873967635b3fbe5ee","head":{"label":"gaborgsomogyi:SPARK-28367","ref":"SPARK-28367","sha":"82f1520246f9a3304288f7f873967635b3fbe5ee","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":111547097,"node_id":"MDEwOlJlcG9zaXRvcnkxMTE1NDcwOTc=","name":"spark","full_name":"gaborgsomogyi/spark","private":false,"owner":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gaborgsomogyi/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gaborgsomogyi/spark","forks_url":"https://api.github.com/repos/gaborgsomogyi/spark/forks","keys_url":"https://api.github.com/repos/gaborgsomogyi/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gaborgsomogyi/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gaborgsomogyi/spark/teams","hooks_url":"https://api.github.com/repos/gaborgsomogyi/spark/hooks","issue_events_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gaborgsomogyi/spark/events","assignees_url":"https://api.github.com/repos/gaborgsomogyi/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gaborgsomogyi/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/tags","blobs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gaborgsomogyi/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gaborgsomogyi/spark/languages","stargazers_url":"https://api.github.com/repos/gaborgsomogyi/spark/stargazers","contributors_url":"https://api.github.com/repos/gaborgsomogyi/spark/contributors","subscribers_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscribers","subscription_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscription","commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gaborgsomogyi/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gaborgsomogyi/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gaborgsomogyi/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gaborgsomogyi/spark/merges","archive_url":"https://api.github.com/repos/gaborgsomogyi/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gaborgsomogyi/spark/downloads","issues_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gaborgsomogyi/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gaborgsomogyi/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gaborgsomogyi/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gaborgsomogyi/spark/labels{/name}","releases_url":"https://api.github.com/repos/gaborgsomogyi/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gaborgsomogyi/spark/deployments","created_at":"2017-11-21T12:38:03Z","updated_at":"2024-05-06T08:51:33Z","pushed_at":"2024-05-06T08:50:41Z","git_url":"git://github.com/gaborgsomogyi/spark.git","ssh_url":"git@github.com:gaborgsomogyi/spark.git","clone_url":"https://github.com/gaborgsomogyi/spark.git","svn_url":"https://github.com/gaborgsomogyi/spark","homepage":null,"size":416015,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"13ae9ebb38ba357aeb3f1e3fe497b322dff8eb35","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25135"},"html":{"href":"https://github.com/apache/spark/pull/25135"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25135"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25135/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25135/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25135/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/82f1520246f9a3304288f7f873967635b3fbe5ee"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25134","id":297040159,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MDQwMTU5","html_url":"https://github.com/apache/spark/pull/25134","diff_url":"https://github.com/apache/spark/pull/25134.diff","patch_url":"https://github.com/apache/spark/pull/25134.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25134","number":25134,"state":"closed","locked":false,"title":"[SPARK-28366][CORE] Logging in driver when loading single large unsplittable file","user":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nLogging in driver when loading single large unsplittable file via `sc.textFile` or csv/json datasouce.\r\nCurrent condition triggering logging is\r\n* only generate one partition\r\n* file is unsplittable, possible reason is:\r\n   - compressed by unsplittable compression algo such as gzip.\r\n   - multiLine mode in csv/json datasource\r\n   - wholeText mode in text datasource\r\n* file size exceed the config threshold `spark.io.warning.largeFileThreshold` (default value is 1GB)\r\n\r\n## How was this patch tested?\r\n\r\nManually test.\r\nGenerate one gzip file exceeding 1GB,\r\n```\r\nbase64 -b 50 /dev/urandom | head -c 2000000000 > file1.txt\r\ncat file1.txt | gzip > file1.gz\r\n```\r\nthen launch spark-shell,\r\n\r\nrun\r\n```\r\nsc.textFile(\"file:///path/to/file1.gz\").count()\r\n```\r\nWill print log like:\r\n```\r\nWARN HadoopRDD: Loading one large unsplittable file file:/.../f1.gz with only one partition, because the file is compressed by unsplittable compression codec\r\n```\r\n\r\nrun\r\n```\r\nsc.textFile(\"file:///path/to/file1.txt\").count()\r\n```\r\nWill print log like:\r\n```\r\nWARN HadoopRDD: Loading one large file file:/.../f1.gz with only one partition, we can increase partition numbers by the `minPartitions` argument in method `sc.textFile\r\n```\r\n\r\nrun\r\n```\r\nspark.read.csv(\"file:///path/to/file1.gz\").count\r\n```\r\nWill print log like:\r\n```\r\nWARN CSVScan: Loading one large unsplittable file file:/.../f1.gz with only one partition, the reason is: the file is compressed by unsplittable compression codec\r\n```\r\n\r\nrun\r\n```\r\nspark.read.option(\"multiLine\", true).csv(\"file:///path/to/file1.gz\").count\r\n```\r\nWill print log like:\r\n```\r\nWARN CSVScan: Loading one large unsplittable file file:/.../f1.gz with only one partition, the reason is: the csv datasource is set multiLine mode\r\n```\r\n\r\nJSON and Text datasource also tested with similar cases.\r\n\r\nPlease review https://spark.apache.org/contributing.html before opening a pull request.\r\n","created_at":"2019-07-12T11:57:24Z","updated_at":"2019-11-26T07:10:05Z","closed_at":"2019-08-01T12:34:17Z","merged_at":null,"merge_commit_sha":"4ca9738e94a1bd5d7584195fd328f697d4e25184","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25134/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25134/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25134/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/801c6e30d785142dd5d03716b619dc48b87d125a","head":{"label":"WeichenXu123:log_gz","ref":"log_gz","sha":"801c6e30d785142dd5d03716b619dc48b87d125a","user":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":58255485,"node_id":"MDEwOlJlcG9zaXRvcnk1ODI1NTQ4NQ==","name":"spark","full_name":"WeichenXu123/spark","private":false,"owner":{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/WeichenXu123/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/WeichenXu123/spark","forks_url":"https://api.github.com/repos/WeichenXu123/spark/forks","keys_url":"https://api.github.com/repos/WeichenXu123/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/WeichenXu123/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/WeichenXu123/spark/teams","hooks_url":"https://api.github.com/repos/WeichenXu123/spark/hooks","issue_events_url":"https://api.github.com/repos/WeichenXu123/spark/issues/events{/number}","events_url":"https://api.github.com/repos/WeichenXu123/spark/events","assignees_url":"https://api.github.com/repos/WeichenXu123/spark/assignees{/user}","branches_url":"https://api.github.com/repos/WeichenXu123/spark/branches{/branch}","tags_url":"https://api.github.com/repos/WeichenXu123/spark/tags","blobs_url":"https://api.github.com/repos/WeichenXu123/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/WeichenXu123/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/WeichenXu123/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/WeichenXu123/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/WeichenXu123/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/WeichenXu123/spark/languages","stargazers_url":"https://api.github.com/repos/WeichenXu123/spark/stargazers","contributors_url":"https://api.github.com/repos/WeichenXu123/spark/contributors","subscribers_url":"https://api.github.com/repos/WeichenXu123/spark/subscribers","subscription_url":"https://api.github.com/repos/WeichenXu123/spark/subscription","commits_url":"https://api.github.com/repos/WeichenXu123/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/WeichenXu123/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/WeichenXu123/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/WeichenXu123/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/WeichenXu123/spark/contents/{+path}","compare_url":"https://api.github.com/repos/WeichenXu123/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/WeichenXu123/spark/merges","archive_url":"https://api.github.com/repos/WeichenXu123/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/WeichenXu123/spark/downloads","issues_url":"https://api.github.com/repos/WeichenXu123/spark/issues{/number}","pulls_url":"https://api.github.com/repos/WeichenXu123/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/WeichenXu123/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/WeichenXu123/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/WeichenXu123/spark/labels{/name}","releases_url":"https://api.github.com/repos/WeichenXu123/spark/releases{/id}","deployments_url":"https://api.github.com/repos/WeichenXu123/spark/deployments","created_at":"2016-05-07T07:45:37Z","updated_at":"2022-01-25T15:06:54Z","pushed_at":"2024-11-04T12:27:24Z","git_url":"git://github.com/WeichenXu123/spark.git","ssh_url":"git@github.com:WeichenXu123/spark.git","clone_url":"https://github.com/WeichenXu123/spark.git","svn_url":"https://github.com/WeichenXu123/spark","homepage":null,"size":436946,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"b8e13b0aeae4a25e54a4c4b8a97bc2c19edd37bb","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25134"},"html":{"href":"https://github.com/apache/spark/pull/25134"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25134"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25134/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25134/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25134/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/801c6e30d785142dd5d03716b619dc48b87d125a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25133","id":297028373,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk3MDI4Mzcz","html_url":"https://github.com/apache/spark/pull/25133","diff_url":"https://github.com/apache/spark/pull/25133.diff","patch_url":"https://github.com/apache/spark/pull/25133.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25133","number":25133,"state":"closed","locked":false,"title":"[SPARK-28365][ML] Fallback locale to en_US in StopWordsRemover if system default locale isn't in available locales in JVM","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nBecause the local default locale isn't in available locales at `Locale`, when I did some tests locally with python code, `StopWordsRemover` related python test hits some errors, like:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/spark-1/python/pyspark/ml/tests/test_feature.py\", line 87, in test_stopwordsremover\r\n    stopWordRemover = StopWordsRemover(inputCol=\"input\", outputCol=\"output\")\r\n  File \"/spark-1/python/pyspark/__init__.py\", line 111, in wrapper\r\n    return func(self, **kwargs)\r\n  File \"/spark-1/python/pyspark/ml/feature.py\", line 2646, in __init__\r\n    self.uid)\r\n  File \"/spark-1/python/pyspark/ml/wrapper.py\", line 67, in _new_java_obj\r\n    return java_obj(*java_args)\r\n  File /spark-1/python/lib/py4j-0.10.8.1-src.zip/py4j/java_gateway.py\", line 1554, in __call__\r\n    answer, self._gateway_client, None, self._fqn)\r\n  File \"/spark-1/python/pyspark/sql/utils.py\", line 93, in deco\r\n    raise converted\r\npyspark.sql.utils.IllegalArgumentException: 'StopWordsRemover_4598673ee802 parameter locale given invalid value en_TW.'\r\n```\r\n\r\nAs per @HyukjinKwon's advice, instead of setting up locale to pass test, it is better to have a workable locale if system default locale can't be found in available locales in JVM. Otherwise, users have to manually change system locale or accessing a private property _jvm in PySpark.\r\n\r\n## How was this patch tested?\r\n\r\nAdded test and manual test.\r\n\r\n```\r\nscala> val remover = new StopWordsRemover().setInputCol(\"raw\").setOutputCol(\"filtered\")\r\n19/07/14 19:20:03 WARN StopWordsRemover: Default locale set was [en_TW]; however, it was not found in available locales in JVM, falling back to en_US locale. Set param `locale` in order to respect another locale.\r\n```","created_at":"2019-07-12T11:19:09Z","updated_at":"2023-12-27T18:22:42Z","closed_at":"2019-07-26T03:17:40Z","merged_at":null,"merge_commit_sha":"8119ebef9ab23c09792aaafce17bbd8658f1c9e6","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25133/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25133/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25133/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f985eba8c006327f934c254fedf91ff3987b7297","head":{"label":"viirya:pytest-default-locale","ref":"pytest-default-locale","sha":"f985eba8c006327f934c254fedf91ff3987b7297","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"13ae9ebb38ba357aeb3f1e3fe497b322dff8eb35","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25133"},"html":{"href":"https://github.com/apache/spark/pull/25133"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25133"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25133/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25133/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25133/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f985eba8c006327f934c254fedf91ff3987b7297"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25132","id":296989556,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2OTg5NTU2","html_url":"https://github.com/apache/spark/pull/25132","diff_url":"https://github.com/apache/spark/pull/25132.diff","patch_url":"https://github.com/apache/spark/pull/25132.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25132","number":25132,"state":"closed","locked":false,"title":"[SPARK-28359][SQL][PYTHON][TESTS] Make integrated UDF tests robust by making them no-op","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"**This alternative was abandoned  for two reasons below:**\r\n\r\n1. Seems Pyrolite doesn't look it guarantees floats to be corrected after the roundtrip between PVM and JVM. \r\n\r\n2. There seems a bug in Arrow conversions for decimal precision and scale:\r\n\r\n```\r\njava.lang.AssertionError: assertion failed: Invalid schema from pandas_udf: expected DecimalType(38,0), got DecimalType(10,0)\r\n\tat scala.Predef$.assert(Predef.scala:223)\r\n\tat org.apache.spark.sql.execution.python.ArrowEvalPythonExec.$anonfun$evaluate$2(ArrowEvalPythonExec.scala:92)\r\n\tat scala.collection.Iterator$$anon$11.nextCur(Iterator.scala:484)\r\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:490)\r\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:458)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.agg_doAggregateWithoutKey_0$(Unknown Source)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)\r\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\r\n```\r\n\r\n## What changes were proposed in this pull request?\r\n\r\nThis is another alternative take comparing to https://github.com/apache/spark/pull/25130.\r\nCurrent UDFs available in `IntegratedUDFTestUtils` are not exactly no-op. It converts input column to strings and outputs to strings.\r\n\r\nIt causes some issues when we convert and port the tests at SPARK-27921. Integrated UDF test cases share one output file and it should outputs the same. However,\r\n\r\n1. Special values are converted into strings differently:\r\n\r\n    | Scala      | Python |\r\n    | ---------- | ------ |\r\n    | `null`     | `None` |\r\n    | `Infinity` | `inf`  |\r\n    | `-Infinity`| `-inf` |\r\n    | `NaN`      | `nan`  |\r\n\r\n2. Due to float limitation at Python (see https://docs.python.org/3/tutorial/floatingpoint.html), if float is passed into Python and sent back to JVM, the values are potentially not exactly correct. See https://github.com/apache/spark/pull/25128 and https://github.com/apache/spark/pull/25110\r\n\r\nTo work around this, this PR targets to change the UDF that returns as are (input column to output column). In this way, we can also handle complex type like map, array or structs too; however, it's too hacky and a bit overkill.\r\n\r\n\r\n**Before:**\r\n\r\n```\r\nJVM (col1) -> (cast to string within Python) Python (string) -> (string) JVM\r\n```\r\n\r\n**After:**\r\n\r\n```\r\nJVM (col1) -> (col) Python (col's type) -> (col's type) JVM\r\n```\r\n\r\nHowever, in this way, it requires to launch an external Python process to generate Python functions for each return type everytime it evaluates. Without caching, it increases the testing time twoice. So, I had to add a cache to keep the testing time almost same. However, now it looks pretty complicated and a bit. overkill.\r\n\r\n\r\nIn this way, UDF is almost completely no-op.\r\n\r\nThere's no diff in terms of output comparing to https://github.com/apache/spark/pull/25130\r\n\r\n<details><summary>Diff comparing to the PR 25180</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part1.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part1.sql.out\r\nindex a2f64717d73..3360350f782 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part1.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part1.sql.out\r\n@@ -77,7 +77,7 @@ struct<max_324_78:float>\r\n -- !query 9\r\n SELECT stddev_pop(udf(b)) FROM aggtest\r\n -- !query 9 schema\r\n-struct<stddev_pop(CAST(CAST(udf(cast(b as string)) AS FLOAT) AS DOUBLE)):double>\r\n+struct<stddev_pop(CAST(udf(b) AS DOUBLE)):double>\r\n -- !query 9 output\r\n 131.10703231895047\r\n\r\n@@ -85,7 +85,7 @@ struct<stddev_pop(CAST(CAST(udf(cast(b as string)) AS FLOAT) AS DOUBLE)):double>\r\n -- !query 10\r\n SELECT udf(stddev_samp(b)) FROM aggtest\r\n -- !query 10 schema\r\n-struct<CAST(udf(cast(stddev_samp(cast(b as double)) as string)) AS DOUBLE):double>\r\n+struct<udf(stddev_samp(cast(b as double))):double>\r\n -- !query 10 output\r\n 151.38936080399804\r\n\r\n@@ -93,7 +93,7 @@ struct<CAST(udf(cast(stddev_samp(cast(b as double)) as string)) AS DOUBLE):doubl\r\n -- !query 11\r\n SELECT var_pop(udf(b)) FROM aggtest\r\n -- !query 11 schema\r\n-struct<var_pop(CAST(CAST(udf(cast(b as string)) AS FLOAT) AS DOUBLE)):double>\r\n+struct<var_pop(CAST(udf(b) AS DOUBLE)):double>\r\n -- !query 11 output\r\n 17189.053923482323\r\n\r\n@@ -101,7 +101,7 @@ struct<var_pop(CAST(CAST(udf(cast(b as string)) AS FLOAT) AS DOUBLE)):double>\r\n -- !query 12\r\n SELECT udf(var_samp(b)) FROM aggtest\r\n -- !query 12 schema\r\n-struct<CAST(udf(cast(var_samp(cast(b as double)) as string)) AS DOUBLE):double>\r\n+struct<udf(var_samp(cast(b as double))):double>\r\n -- !query 12 output\r\n 22918.738564643096\r\n\r\n@@ -109,7 +109,7 @@ struct<CAST(udf(cast(var_samp(cast(b as double)) as string)) AS DOUBLE):double>\r\n -- !query 13\r\n SELECT udf(stddev_pop(CAST(b AS Decimal(38,0)))) FROM aggtest\r\n -- !query 13 schema\r\n-struct<CAST(udf(cast(stddev_pop(cast(cast(b as decimal(38,0)) as double)) as string)) AS DOUBLE):double>\r\n+struct<udf(stddev_pop(cast(cast(b as decimal(38,0)) as double))):double>\r\n -- !query 13 output\r\n 131.18117242958306\r\n\r\n@@ -117,7 +117,7 @@ struct<CAST(udf(cast(stddev_pop(cast(cast(b as decimal(38,0)) as double)) as str\r\n -- !query 14\r\n SELECT stddev_samp(CAST(udf(b) AS Decimal(38,0))) FROM aggtest\r\n -- !query 14 schema\r\n-struct<stddev_samp(CAST(CAST(CAST(udf(cast(b as string)) AS FLOAT) AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<stddev_samp(CAST(CAST(udf(b) AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n -- !query 14 output\r\n 151.47497042966097\r\n\r\n@@ -125,7 +125,7 @@ struct<stddev_samp(CAST(CAST(CAST(udf(cast(b as string)) AS FLOAT) AS DECIMAL(38\r\n -- !query 15\r\n SELECT udf(var_pop(CAST(b AS Decimal(38,0)))) FROM aggtest\r\n -- !query 15 schema\r\n-struct<CAST(udf(cast(var_pop(cast(cast(b as decimal(38,0)) as double)) as string)) AS DOUBLE):double>\r\n+struct<udf(var_pop(cast(cast(b as decimal(38,0)) as double))):double>\r\n -- !query 15 output\r\n 17208.5\r\n\r\n@@ -133,7 +133,7 @@ struct<CAST(udf(cast(var_pop(cast(cast(b as decimal(38,0)) as double)) as string\r\n -- !query 16\r\n SELECT var_samp(udf(CAST(b AS Decimal(38,0)))) FROM aggtest\r\n -- !query 16 schema\r\n-struct<var_samp(CAST(CAST(udf(cast(cast(b as decimal(38,0)) as string)) AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<var_samp(CAST(udf(cast(b as decimal(38,0))) AS DOUBLE)):double>\r\n -- !query 16 output\r\n 22944.666666666668\r\n\r\n@@ -141,7 +141,7 @@ struct<var_samp(CAST(CAST(udf(cast(cast(b as decimal(38,0)) as string)) AS DECIM\r\n -- !query 17\r\n SELECT udf(var_pop(1.0)), var_samp(udf(2.0))\r\n -- !query 17 schema\r\n-struct<CAST(udf(cast(var_pop(cast(1.0 as double)) as string)) AS DOUBLE):double,var_samp(CAST(CAST(udf(cast(2.0 as string)) AS DECIMAL(2,1)) AS DOUBLE)):double>\r\n+struct<udf(var_pop(cast(1.0 as double))):double,var_samp(CAST(udf(2.0) AS DOUBLE)):double>\r\n -- !query 17 output\r\n 0.0    NaN\r\n\r\n@@ -149,7 +149,7 @@ struct<CAST(udf(cast(var_pop(cast(1.0 as double)) as string)) AS DOUBLE):double,\r\n -- !query 18\r\n SELECT stddev_pop(udf(CAST(3.0 AS Decimal(38,0)))), stddev_samp(CAST(udf(4.0) AS Decimal(38,0)))\r\n -- !query 18 schema\r\n-struct<stddev_pop(CAST(CAST(udf(cast(cast(3.0 as decimal(38,0)) as string)) AS DECIMAL(38,0)) AS DOUBLE)):double,stddev_samp(CAST(CAST(CAST(udf(cast(4.0 as string)) AS DECIMAL(2,1)) AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<stddev_pop(CAST(udf(cast(3.0 as decimal(38,0))) AS DOUBLE)):double,stddev_samp(CAST(CAST(udf(4.0) AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n -- !query 18 output\r\n 0.0    NaN\r\n\r\n@@ -157,7 +157,7 @@ struct<stddev_pop(CAST(CAST(udf(cast(cast(3.0 as decimal(38,0)) as string)) AS D\r\n -- !query 19\r\n select sum(udf(CAST(null AS int))) from range(1,4)\r\n -- !query 19 schema\r\n-struct<sum(CAST(udf(cast(cast(null as int) as string)) AS INT)):bigint>\r\n+struct<sum(udf(cast(null as int))):bigint>\r\n -- !query 19 output\r\n NULL\r\n\r\n@@ -165,7 +165,7 @@ NULL\r\n -- !query 20\r\n select sum(udf(CAST(null AS long))) from range(1,4)\r\n -- !query 20 schema\r\n-struct<sum(CAST(udf(cast(cast(null as bigint) as string)) AS BIGINT)):bigint>\r\n+struct<sum(udf(cast(null as bigint))):bigint>\r\n -- !query 20 output\r\n NULL\r\n\r\n@@ -173,7 +173,7 @@ NULL\r\n -- !query 21\r\n select sum(udf(CAST(null AS Decimal(38,0)))) from range(1,4)\r\n -- !query 21 schema\r\n-struct<sum(CAST(udf(cast(cast(null as decimal(38,0)) as string)) AS DECIMAL(38,0))):decimal(38,0)>\r\n+struct<sum(udf(cast(null as decimal(38,0)))):decimal(38,0)>\r\n -- !query 21 output\r\n NULL\r\n\r\n@@ -181,7 +181,7 @@ NULL\r\n -- !query 22\r\n select sum(udf(CAST(null AS DOUBLE))) from range(1,4)\r\n -- !query 22 schema\r\n-struct<sum(CAST(udf(cast(cast(null as double) as string)) AS DOUBLE)):double>\r\n+struct<sum(udf(cast(null as double))):double>\r\n -- !query 22 output\r\n NULL\r\n\r\n@@ -189,7 +189,7 @@ NULL\r\n -- !query 23\r\n select avg(udf(CAST(null AS int))) from range(1,4)\r\n -- !query 23 schema\r\n-struct<avg(CAST(udf(cast(cast(null as int) as string)) AS INT)):double>\r\n+struct<avg(udf(cast(null as int))):double>\r\n -- !query 23 output\r\n NULL\r\n\r\n@@ -197,7 +197,7 @@ NULL\r\n -- !query 24\r\n select avg(udf(CAST(null AS long))) from range(1,4)\r\n -- !query 24 schema\r\n-struct<avg(CAST(udf(cast(cast(null as bigint) as string)) AS BIGINT)):double>\r\n+struct<avg(udf(cast(null as bigint))):double>\r\n -- !query 24 output\r\n NULL\r\n\r\n@@ -205,7 +205,7 @@ NULL\r\n -- !query 25\r\n select avg(udf(CAST(null AS Decimal(38,0)))) from range(1,4)\r\n -- !query 25 schema\r\n-struct<avg(CAST(udf(cast(cast(null as decimal(38,0)) as string)) AS DECIMAL(38,0))):decimal(38,4)>\r\n+struct<avg(udf(cast(null as decimal(38,0)))):decimal(38,4)>\r\n -- !query 25 output\r\n NULL\r\n\r\n@@ -213,7 +213,7 @@ NULL\r\n -- !query 26\r\n select avg(udf(CAST(null AS DOUBLE))) from range(1,4)\r\n -- !query 26 schema\r\n-struct<avg(CAST(udf(cast(cast(null as double) as string)) AS DOUBLE)):double>\r\n+struct<avg(udf(cast(null as double))):double>\r\n -- !query 26 output\r\n NULL\r\n\r\n@@ -221,7 +221,7 @@ NULL\r\n -- !query 27\r\n select sum(CAST(udf('NaN') AS DOUBLE)) from range(1,4)\r\n -- !query 27 schema\r\n-struct<sum(CAST(CAST(udf(cast(NaN as string)) AS STRING) AS DOUBLE)):double>\r\n+struct<sum(CAST(udf(NaN) AS DOUBLE)):double>\r\n -- !query 27 output\r\n NaN\r\n\r\n@@ -229,7 +229,7 @@ NaN\r\n -- !query 28\r\n select avg(CAST(udf('NaN') AS DOUBLE)) from range(1,4)\r\n -- !query 28 schema\r\n-struct<avg(CAST(CAST(udf(cast(NaN as string)) AS STRING) AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(NaN) AS DOUBLE)):double>\r\n -- !query 28 output\r\n NaN\r\n\r\n@@ -238,7 +238,7 @@ NaN\r\n SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('Infinity'), ('1')) v(x)\r\n -- !query 29 schema\r\n-struct<avg(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double,var_pop(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(x) AS DOUBLE)):double,var_pop(CAST(udf(x) AS DOUBLE)):double>\r\n -- !query 29 output\r\n Infinity       NaN\r\n\r\n@@ -247,7 +247,7 @@ Infinity    NaN\r\n SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('Infinity'), ('Infinity')) v(x)\r\n -- !query 30 schema\r\n-struct<avg(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double,var_pop(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(x) AS DOUBLE)):double,var_pop(CAST(udf(x) AS DOUBLE)):double>\r\n -- !query 30 output\r\n Infinity       NaN\r\n\r\n@@ -256,7 +256,7 @@ Infinity    NaN\r\n SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('-Infinity'), ('Infinity')) v(x)\r\n -- !query 31 schema\r\n-struct<avg(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double,var_pop(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(x) AS DOUBLE)):double,var_pop(CAST(udf(x) AS DOUBLE)):double>\r\n -- !query 31 output\r\n NaN    NaN\r\n\r\n@@ -265,7 +265,7 @@ NaN NaN\r\n SELECT avg(udf(CAST(x AS DOUBLE))), udf(var_pop(CAST(x AS DOUBLE)))\r\n FROM (VALUES (100000003), (100000004), (100000006), (100000007)) v(x)\r\n -- !query 32 schema\r\n-struct<avg(CAST(udf(cast(cast(x as double) as string)) AS DOUBLE)):double,CAST(udf(cast(var_pop(cast(x as double)) as string)) AS DOUBLE):double>\r\n+struct<avg(udf(cast(x as double))):double,udf(var_pop(cast(x as double))):double>\r\n -- !query 32 output\r\n 1.00000005E8   2.5\r\n\r\n@@ -274,7 +274,7 @@ struct<avg(CAST(udf(cast(cast(x as double) as string)) AS DOUBLE)):double,CAST(u\r\n SELECT avg(udf(CAST(x AS DOUBLE))), udf(var_pop(CAST(x AS DOUBLE)))\r\n FROM (VALUES (7000000000005), (7000000000007)) v(x)\r\n -- !query 33 schema\r\n-struct<avg(CAST(udf(cast(cast(x as double) as string)) AS DOUBLE)):double,CAST(udf(cast(var_pop(cast(x as double)) as string)) AS DOUBLE):double>\r\n+struct<avg(udf(cast(x as double))):double,udf(var_pop(cast(x as double))):double>\r\n -- !query 33 output\r\n 7.000000000006E12      1.0\r\n\r\n@@ -282,7 +282,7 @@ struct<avg(CAST(udf(cast(cast(x as double) as string)) AS DOUBLE)):double,CAST(u\r\n -- !query 34\r\n SELECT udf(covar_pop(b, udf(a))), covar_samp(udf(b), a) FROM aggtest\r\n -- !query 34 schema\r\n-struct<CAST(udf(cast(covar_pop(cast(b as double), cast(cast(udf(cast(a as string)) as int) as double)) as string)) AS DOUBLE):double,covar_samp(CAST(CAST(udf(cast(b as string)) AS FLOAT) AS DOUBLE), CAST(a AS DOUBLE)):double>\r\n+struct<udf(covar_pop(cast(b as double), cast(udf(a) as double))):double,covar_samp(CAST(udf(b) AS DOUBLE), CAST(a AS DOUBLE)):double>\r\n -- !query 34 output\r\n 653.6289553875104      871.5052738500139\r\n\r\n@@ -290,7 +290,7 @@ struct<CAST(udf(cast(covar_pop(cast(b as double), cast(cast(udf(cast(a as string\r\n -- !query 35\r\n SELECT corr(b, udf(a)) FROM aggtest\r\n -- !query 35 schema\r\n-struct<corr(CAST(b AS DOUBLE), CAST(CAST(udf(cast(a as string)) AS INT) AS DOUBLE)):double>\r\n+struct<corr(CAST(b AS DOUBLE), CAST(udf(a) AS DOUBLE)):double>\r\n -- !query 35 output\r\n 0.1396345165178734\r\n\r\n@@ -315,7 +315,7 @@ struct<cnt_4:bigint>\r\n select ten, udf(count(*)), sum(udf(four)) from onek\r\n group by ten order by ten\r\n -- !query 38 schema\r\n-struct<ten:int,CAST(udf(cast(count(1) as string)) AS BIGINT):bigint,sum(CAST(udf(cast(four as string)) AS INT)):bigint>\r\n+struct<ten:int,udf(count(1)):bigint,sum(udf(four)):bigint>\r\n -- !query 38 output\r\n 0      100     100\r\n 1      100     200\r\n@@ -333,7 +333,7 @@ struct<ten:int,CAST(udf(cast(count(1) as string)) AS BIGINT):bigint,sum(CAST(udf\r\n select ten, count(udf(four)), udf(sum(DISTINCT four)) from onek\r\n group by ten order by ten\r\n -- !query 39 schema\r\n-struct<ten:int,count(CAST(udf(cast(four as string)) AS INT)):bigint,CAST(udf(cast(sum(distinct cast(four as bigint)) as string)) AS BIGINT):bigint>\r\n+struct<ten:int,count(udf(four)):bigint,udf(sum(distinct cast(four as bigint))):bigint>\r\n -- !query 39 output\r\n 0      100     2\r\n 1      100     4\r\n@@ -352,7 +352,7 @@ select ten, udf(sum(distinct four)) from onek a\r\n group by ten\r\n having exists (select 1 from onek b where udf(sum(distinct a.four)) = b.four)\r\n -- !query 40 schema\r\n-struct<ten:int,CAST(udf(cast(sum(distinct cast(four as bigint)) as string)) AS BIGINT):bigint>\r\n+struct<ten:int,udf(sum(distinct cast(four as bigint))):bigint>\r\n -- !query 40 output\r\n 0      2\r\n 2      2\r\n@@ -372,7 +372,7 @@ struct<>\r\n org.apache.spark.sql.AnalysisException\r\n\r\n Aggregate/Window/Generate expressions are not valid in where clause of the query.\r\n-Expression in where clause: [(sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT)) = CAST(CAST(udf(cast(four as string)) AS INT) AS BIGINT))]\r\n+Expression in where clause: [(sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT)) = CAST(udf(four) AS BIGINT))]\r\n Invalid expressions: [sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT))];\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nManually tested.\r\n","created_at":"2019-07-12T09:26:58Z","updated_at":"2020-03-03T01:18:29Z","closed_at":"2019-07-12T09:27:04Z","merged_at":null,"merge_commit_sha":"31c7f65dc5d7e6a433246f151ee08989c4f01685","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25132/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25132/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25132/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/af78ccf4aab283f0ad226ba86427c1bf606b1e75","head":{"label":"HyukjinKwon:SPARK-28359-1","ref":"SPARK-28359-1","sha":"af78ccf4aab283f0ad226ba86427c1bf606b1e75","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fe22faa7fa8f889f3deef1242ab1c0a4227b07c1","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25132"},"html":{"href":"https://github.com/apache/spark/pull/25132"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25132"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25132/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25132/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25132/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/af78ccf4aab283f0ad226ba86427c1bf606b1e75"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25131","id":296935738,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2OTM1NzM4","html_url":"https://github.com/apache/spark/pull/25131","diff_url":"https://github.com/apache/spark/pull/25131.diff","patch_url":"https://github.com/apache/spark/pull/25131.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25131","number":25131,"state":"closed","locked":false,"title":"[SPARK-28361][SQL][TEST] Test equality of generated code with id in class name","user":{"login":"gatorsmile","id":11567269,"node_id":"MDQ6VXNlcjExNTY3MjY5","avatar_url":"https://avatars.githubusercontent.com/u/11567269?v=4","gravatar_id":"","url":"https://api.github.com/users/gatorsmile","html_url":"https://github.com/gatorsmile","followers_url":"https://api.github.com/users/gatorsmile/followers","following_url":"https://api.github.com/users/gatorsmile/following{/other_user}","gists_url":"https://api.github.com/users/gatorsmile/gists{/gist_id}","starred_url":"https://api.github.com/users/gatorsmile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gatorsmile/subscriptions","organizations_url":"https://api.github.com/users/gatorsmile/orgs","repos_url":"https://api.github.com/users/gatorsmile/repos","events_url":"https://api.github.com/users/gatorsmile/events{/privacy}","received_events_url":"https://api.github.com/users/gatorsmile/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nA code gen test in WholeStageCodeGenSuite was flaky because it used the codegen metrics class to test if the generated code for equivalent plans was identical under a particular flag. This patch switches the test to compare the generated code directly.\r\n\r\n\r\n## How was this patch tested?\r\nN/A","created_at":"2019-07-12T06:35:21Z","updated_at":"2020-02-05T18:27:28Z","closed_at":"2019-07-12T23:18:00Z","merged_at":null,"merge_commit_sha":"68590f13f401d227db4560a1e28eb0b4bccf2cc9","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25131/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25131/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25131/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ba919665cca5e5118cf0eb90e305d7d4ad12e2d6","head":{"label":"gatorsmile:WholeStageCodegenSuite","ref":"WholeStageCodegenSuite","sha":"ba919665cca5e5118cf0eb90e305d7d4ad12e2d6","user":{"login":"gatorsmile","id":11567269,"node_id":"MDQ6VXNlcjExNTY3MjY5","avatar_url":"https://avatars.githubusercontent.com/u/11567269?v=4","gravatar_id":"","url":"https://api.github.com/users/gatorsmile","html_url":"https://github.com/gatorsmile","followers_url":"https://api.github.com/users/gatorsmile/followers","following_url":"https://api.github.com/users/gatorsmile/following{/other_user}","gists_url":"https://api.github.com/users/gatorsmile/gists{/gist_id}","starred_url":"https://api.github.com/users/gatorsmile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gatorsmile/subscriptions","organizations_url":"https://api.github.com/users/gatorsmile/orgs","repos_url":"https://api.github.com/users/gatorsmile/repos","events_url":"https://api.github.com/users/gatorsmile/events{/privacy}","received_events_url":"https://api.github.com/users/gatorsmile/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":44710950,"node_id":"MDEwOlJlcG9zaXRvcnk0NDcxMDk1MA==","name":"spark","full_name":"gatorsmile/spark","private":false,"owner":{"login":"gatorsmile","id":11567269,"node_id":"MDQ6VXNlcjExNTY3MjY5","avatar_url":"https://avatars.githubusercontent.com/u/11567269?v=4","gravatar_id":"","url":"https://api.github.com/users/gatorsmile","html_url":"https://github.com/gatorsmile","followers_url":"https://api.github.com/users/gatorsmile/followers","following_url":"https://api.github.com/users/gatorsmile/following{/other_user}","gists_url":"https://api.github.com/users/gatorsmile/gists{/gist_id}","starred_url":"https://api.github.com/users/gatorsmile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gatorsmile/subscriptions","organizations_url":"https://api.github.com/users/gatorsmile/orgs","repos_url":"https://api.github.com/users/gatorsmile/repos","events_url":"https://api.github.com/users/gatorsmile/events{/privacy}","received_events_url":"https://api.github.com/users/gatorsmile/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gatorsmile/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gatorsmile/spark","forks_url":"https://api.github.com/repos/gatorsmile/spark/forks","keys_url":"https://api.github.com/repos/gatorsmile/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gatorsmile/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gatorsmile/spark/teams","hooks_url":"https://api.github.com/repos/gatorsmile/spark/hooks","issue_events_url":"https://api.github.com/repos/gatorsmile/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gatorsmile/spark/events","assignees_url":"https://api.github.com/repos/gatorsmile/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gatorsmile/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gatorsmile/spark/tags","blobs_url":"https://api.github.com/repos/gatorsmile/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gatorsmile/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gatorsmile/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gatorsmile/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gatorsmile/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gatorsmile/spark/languages","stargazers_url":"https://api.github.com/repos/gatorsmile/spark/stargazers","contributors_url":"https://api.github.com/repos/gatorsmile/spark/contributors","subscribers_url":"https://api.github.com/repos/gatorsmile/spark/subscribers","subscription_url":"https://api.github.com/repos/gatorsmile/spark/subscription","commits_url":"https://api.github.com/repos/gatorsmile/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gatorsmile/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gatorsmile/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gatorsmile/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gatorsmile/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gatorsmile/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gatorsmile/spark/merges","archive_url":"https://api.github.com/repos/gatorsmile/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gatorsmile/spark/downloads","issues_url":"https://api.github.com/repos/gatorsmile/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gatorsmile/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gatorsmile/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gatorsmile/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gatorsmile/spark/labels{/name}","releases_url":"https://api.github.com/repos/gatorsmile/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gatorsmile/spark/deployments","created_at":"2015-10-21T23:48:23Z","updated_at":"2020-10-28T13:30:16Z","pushed_at":"2023-06-25T16:40:32Z","git_url":"git://github.com/gatorsmile/spark.git","ssh_url":"git@github.com:gatorsmile/spark.git","clone_url":"https://github.com/gatorsmile/spark.git","svn_url":"https://github.com/gatorsmile/spark","homepage":null,"size":460012,"stargazers_count":4,"watchers_count":4,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":4,"default_branch":"toJson"}},"base":{"label":"apache:master","ref":"master","sha":"fe22faa7fa8f889f3deef1242ab1c0a4227b07c1","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25131"},"html":{"href":"https://github.com/apache/spark/pull/25131"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25131"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25131/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25131/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25131/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ba919665cca5e5118cf0eb90e305d7d4ad12e2d6"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25130","id":296929187,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2OTI5MTg3","html_url":"https://github.com/apache/spark/pull/25130","diff_url":"https://github.com/apache/spark/pull/25130.diff","patch_url":"https://github.com/apache/spark/pull/25130.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25130","number":25130,"state":"closed","locked":false,"title":"[SPARK-28359][SQL][PYTHON][TESTS] Make integrated UDF tests robust by making UDFs (virtually) no-op","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nCurrent UDFs available in `IntegratedUDFTestUtils` are not exactly no-op. It converts input column to strings and outputs to strings.\r\n\r\nIt causes some issues when we convert and port the tests at SPARK-27921. Integrated UDF test cases share one output file and it should outputs the same. However,\r\n\r\n1. Special values are converted into strings differently:\r\n\r\n    | Scala      | Python |\r\n    | ---------- | ------ |\r\n    | `null`     | `None` |\r\n    | `Infinity` | `inf`  |\r\n    | `-Infinity`| `-inf` |\r\n    | `NaN`      | `nan`  |\r\n\r\n2. Due to float limitation at Python (see https://docs.python.org/3/tutorial/floatingpoint.html), if float is passed into Python and sent back to JVM, the values are potentially not exactly correct. See https://github.com/apache/spark/pull/25128 and https://github.com/apache/spark/pull/25110\r\n\r\nTo work around this, this PR targets to change the current UDF to be wrapped by cast. So, Input column is casted into string, UDF returns strings as are, and then output column is casted back to the input column.\r\n\r\nRoughly:\r\n\r\n**Before:**\r\n\r\n```\r\nJVM (col1) -> (cast to string within Python) Python (string) -> (string) JVM\r\n```\r\n\r\n**After:**\r\n\r\n```\r\nJVM (cast col1 to string) -> (string) Python (string) -> (cast back to col1's type) JVM\r\n```\r\n\r\nIn this way, UDF is virtually no-op although there might be some subtleties due to roundtrip in string cast. I believe this is good enough.\r\n\r\nPython native functions and Scala native functions will take strings and output strings as are. So, there will be no potential test failures due to differences of conversion between Python and Scala.\r\n\r\nAfter this fix, for instance, `udf-aggregates_part1.sql` outputs exactly same as `aggregates_part1.sql`:\r\n\r\n<details><summary>Diff comparing to 'pgSQL/aggregates_part1.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/pgSQL/aggregates_part1.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part1.sql.out\r\nindex 51ca1d55869..801735781c7 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/pgSQL/aggregates_part1.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part1.sql.out\r\n@@ -3,7 +3,7 @@\r\n\r\n\r\n -- !query 0\r\n-SELECT avg(four) AS avg_1 FROM onek\r\n+SELECT avg(udf(four)) AS avg_1 FROM onek\r\n -- !query 0 schema\r\n struct<avg_1:double>\r\n -- !query 0 output\r\n@@ -11,7 +11,7 @@ struct<avg_1:double>\r\n\r\n\r\n -- !query 1\r\n-SELECT avg(a) AS avg_32 FROM aggtest WHERE a < 100\r\n+SELECT udf(avg(a)) AS avg_32 FROM aggtest WHERE a < 100\r\n -- !query 1 schema\r\n struct<avg_32:double>\r\n -- !query 1 output\r\n@@ -19,7 +19,7 @@ struct<avg_32:double>\r\n\r\n\r\n -- !query 2\r\n-select CAST(avg(b) AS Decimal(10,3)) AS avg_107_943 FROM aggtest\r\n+select CAST(avg(udf(b)) AS Decimal(10,3)) AS avg_107_943 FROM aggtest\r\n -- !query 2 schema\r\n struct<avg_107_943:decimal(10,3)>\r\n -- !query 2 output\r\n@@ -27,7 +27,7 @@ struct<avg_107_943:decimal(10,3)>\r\n\r\n\r\n -- !query 3\r\n-SELECT sum(four) AS sum_1500 FROM onek\r\n+SELECT sum(udf(four)) AS sum_1500 FROM onek\r\n -- !query 3 schema\r\n struct<sum_1500:bigint>\r\n -- !query 3 output\r\n@@ -35,7 +35,7 @@ struct<sum_1500:bigint>\r\n\r\n\r\n -- !query 4\r\n-SELECT sum(a) AS sum_198 FROM aggtest\r\n+SELECT udf(sum(a)) AS sum_198 FROM aggtest\r\n -- !query 4 schema\r\n struct<sum_198:bigint>\r\n -- !query 4 output\r\n@@ -43,7 +43,7 @@ struct<sum_198:bigint>\r\n\r\n\r\n -- !query 5\r\n-SELECT sum(b) AS avg_431_773 FROM aggtest\r\n+SELECT udf(udf(sum(b))) AS avg_431_773 FROM aggtest\r\n -- !query 5 schema\r\n struct<avg_431_773:double>\r\n -- !query 5 output\r\n@@ -51,7 +51,7 @@ struct<avg_431_773:double>\r\n\r\n\r\n -- !query 6\r\n-SELECT max(four) AS max_3 FROM onek\r\n+SELECT udf(max(four)) AS max_3 FROM onek\r\n -- !query 6 schema\r\n struct<max_3:int>\r\n -- !query 6 output\r\n@@ -59,7 +59,7 @@ struct<max_3:int>\r\n\r\n\r\n -- !query 7\r\n-SELECT max(a) AS max_100 FROM aggtest\r\n+SELECT max(udf(a)) AS max_100 FROM aggtest\r\n -- !query 7 schema\r\n struct<max_100:int>\r\n -- !query 7 output\r\n@@ -67,7 +67,7 @@ struct<max_100:int>\r\n\r\n\r\n -- !query 8\r\n-SELECT max(aggtest.b) AS max_324_78 FROM aggtest\r\n+SELECT udf(udf(max(aggtest.b))) AS max_324_78 FROM aggtest\r\n -- !query 8 schema\r\n struct<max_324_78:float>\r\n -- !query 8 output\r\n@@ -75,237 +75,238 @@ struct<max_324_78:float>\r\n\r\n\r\n -- !query 9\r\n-SELECT stddev_pop(b) FROM aggtest\r\n+SELECT stddev_pop(udf(b)) FROM aggtest\r\n -- !query 9 schema\r\n-struct<stddev_pop(CAST(b AS DOUBLE)):double>\r\n+struct<stddev_pop(CAST(CAST(udf(cast(b as string)) AS FLOAT) AS DOUBLE)):double>\r\n -- !query 9 output\r\n 131.10703231895047\r\n\r\n\r\n -- !query 10\r\n-SELECT stddev_samp(b) FROM aggtest\r\n+SELECT udf(stddev_samp(b)) FROM aggtest\r\n -- !query 10 schema\r\n-struct<stddev_samp(CAST(b AS DOUBLE)):double>\r\n+struct<CAST(udf(cast(stddev_samp(cast(b as double)) as string)) AS DOUBLE):double>\r\n -- !query 10 output\r\n 151.38936080399804\r\n\r\n\r\n -- !query 11\r\n-SELECT var_pop(b) FROM aggtest\r\n+SELECT var_pop(udf(b)) FROM aggtest\r\n -- !query 11 schema\r\n-struct<var_pop(CAST(b AS DOUBLE)):double>\r\n+struct<var_pop(CAST(CAST(udf(cast(b as string)) AS FLOAT) AS DOUBLE)):double>\r\n -- !query 11 output\r\n 17189.053923482323\r\n\r\n\r\n -- !query 12\r\n-SELECT var_samp(b) FROM aggtest\r\n+SELECT udf(var_samp(b)) FROM aggtest\r\n -- !query 12 schema\r\n-struct<var_samp(CAST(b AS DOUBLE)):double>\r\n+struct<CAST(udf(cast(var_samp(cast(b as double)) as string)) AS DOUBLE):double>\r\n -- !query 12 output\r\n 22918.738564643096\r\n\r\n\r\n -- !query 13\r\n-SELECT stddev_pop(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT udf(stddev_pop(CAST(b AS Decimal(38,0)))) FROM aggtest\r\n -- !query 13 schema\r\n-struct<stddev_pop(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<CAST(udf(cast(stddev_pop(cast(cast(b as decimal(38,0)) as double)) as string)) AS DOUBLE):double>\r\n -- !query 13 output\r\n 131.18117242958306\r\n\r\n\r\n -- !query 14\r\n-SELECT stddev_samp(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT stddev_samp(CAST(udf(b) AS Decimal(38,0))) FROM aggtest\r\n -- !query 14 schema\r\n-struct<stddev_samp(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<stddev_samp(CAST(CAST(CAST(udf(cast(b as string)) AS FLOAT) AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n -- !query 14 output\r\n 151.47497042966097\r\n\r\n\r\n -- !query 15\r\n-SELECT var_pop(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT udf(var_pop(CAST(b AS Decimal(38,0)))) FROM aggtest\r\n -- !query 15 schema\r\n-struct<var_pop(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<CAST(udf(cast(var_pop(cast(cast(b as decimal(38,0)) as double)) as string)) AS DOUBLE):double>\r\n -- !query 15 output\r\n 17208.5\r\n\r\n\r\n -- !query 16\r\n-SELECT var_samp(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT var_samp(udf(CAST(b AS Decimal(38,0)))) FROM aggtest\r\n -- !query 16 schema\r\n-struct<var_samp(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<var_samp(CAST(CAST(udf(cast(cast(b as decimal(38,0)) as string)) AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n -- !query 16 output\r\n 22944.666666666668\r\n\r\n\r\n -- !query 17\r\n-SELECT var_pop(1.0), var_samp(2.0)\r\n+SELECT udf(var_pop(1.0)), var_samp(udf(2.0))\r\n -- !query 17 schema\r\n-struct<var_pop(CAST(1.0 AS DOUBLE)):double,var_samp(CAST(2.0 AS DOUBLE)):double>\r\n+struct<CAST(udf(cast(var_pop(cast(1.0 as double)) as string)) AS DOUBLE):double,var_samp(CAST(CAST(udf(cast(2.0 as string)) AS DECIMAL(2,1)) AS DOUBLE)):double>\r\n -- !query 17 output\r\n 0.0    NaN\r\n\r\n\r\n -- !query 18\r\n-SELECT stddev_pop(CAST(3.0 AS Decimal(38,0))), stddev_samp(CAST(4.0 AS Decimal(38,0)))\r\n+SELECT stddev_pop(udf(CAST(3.0 AS Decimal(38,0)))), stddev_samp(CAST(udf(4.0) AS Decimal(38,0)))\r\n -- !query 18 schema\r\n-struct<stddev_pop(CAST(CAST(3.0 AS DECIMAL(38,0)) AS DOUBLE)):double,stddev_samp(CAST(CAST(4.0 AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<stddev_pop(CAST(CAST(udf(cast(cast(3.0 as decimal(38,0)) as string)) AS DECIMAL(38,0)) AS DOUBLE)):double,stddev_samp(CAST(CAST(CAST(udf(cast(4.0 as string)) AS DECIMAL(2,1)) AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n -- !query 18 output\r\n 0.0    NaN\r\n\r\n\r\n -- !query 19\r\n-select sum(CAST(null AS int)) from range(1,4)\r\n+select sum(udf(CAST(null AS int))) from range(1,4)\r\n -- !query 19 schema\r\n-struct<sum(CAST(NULL AS INT)):bigint>\r\n+struct<sum(CAST(udf(cast(cast(null as int) as string)) AS INT)):bigint>\r\n -- !query 19 output\r\n NULL\r\n\r\n\r\n -- !query 20\r\n-select sum(CAST(null AS long)) from range(1,4)\r\n+select sum(udf(CAST(null AS long))) from range(1,4)\r\n -- !query 20 schema\r\n-struct<sum(CAST(NULL AS BIGINT)):bigint>\r\n+struct<sum(CAST(udf(cast(cast(null as bigint) as string)) AS BIGINT)):bigint>\r\n -- !query 20 output\r\n NULL\r\n\r\n\r\n -- !query 21\r\n-select sum(CAST(null AS Decimal(38,0))) from range(1,4)\r\n+select sum(udf(CAST(null AS Decimal(38,0)))) from range(1,4)\r\n -- !query 21 schema\r\n-struct<sum(CAST(NULL AS DECIMAL(38,0))):decimal(38,0)>\r\n+struct<sum(CAST(udf(cast(cast(null as decimal(38,0)) as string)) AS DECIMAL(38,0))):decimal(38,0)>\r\n -- !query 21 output\r\n NULL\r\n\r\n\r\n -- !query 22\r\n-select sum(CAST(null AS DOUBLE)) from range(1,4)\r\n+select sum(udf(CAST(null AS DOUBLE))) from range(1,4)\r\n -- !query 22 schema\r\n-struct<sum(CAST(NULL AS DOUBLE)):double>\r\n+struct<sum(CAST(udf(cast(cast(null as double) as string)) AS DOUBLE)):double>\r\n -- !query 22 output\r\n NULL\r\n\r\n\r\n -- !query 23\r\n-select avg(CAST(null AS int)) from range(1,4)\r\n+select avg(udf(CAST(null AS int))) from range(1,4)\r\n -- !query 23 schema\r\n-struct<avg(CAST(NULL AS INT)):double>\r\n+struct<avg(CAST(udf(cast(cast(null as int) as string)) AS INT)):double>\r\n -- !query 23 output\r\n NULL\r\n\r\n\r\n -- !query 24\r\n-select avg(CAST(null AS long)) from range(1,4)\r\n+select avg(udf(CAST(null AS long))) from range(1,4)\r\n -- !query 24 schema\r\n-struct<avg(CAST(NULL AS BIGINT)):double>\r\n+struct<avg(CAST(udf(cast(cast(null as bigint) as string)) AS BIGINT)):double>\r\n -- !query 24 output\r\n NULL\r\n\r\n\r\n -- !query 25\r\n-select avg(CAST(null AS Decimal(38,0))) from range(1,4)\r\n+select avg(udf(CAST(null AS Decimal(38,0)))) from range(1,4)\r\n -- !query 25 schema\r\n-struct<avg(CAST(NULL AS DECIMAL(38,0))):decimal(38,4)>\r\n+struct<avg(CAST(udf(cast(cast(null as decimal(38,0)) as string)) AS DECIMAL(38,0))):decimal(38,4)>\r\n -- !query 25 output\r\n NULL\r\n\r\n\r\n -- !query 26\r\n-select avg(CAST(null AS DOUBLE)) from range(1,4)\r\n+select avg(udf(CAST(null AS DOUBLE))) from range(1,4)\r\n -- !query 26 schema\r\n-struct<avg(CAST(NULL AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(cast(cast(null as double) as string)) AS DOUBLE)):double>\r\n -- !query 26 output\r\n NULL\r\n\r\n\r\n -- !query 27\r\n-select sum(CAST('NaN' AS DOUBLE)) from range(1,4)\r\n+select sum(CAST(udf('NaN') AS DOUBLE)) from range(1,4)\r\n -- !query 27 schema\r\n-struct<sum(CAST(NaN AS DOUBLE)):double>\r\n+struct<sum(CAST(CAST(udf(cast(NaN as string)) AS STRING) AS DOUBLE)):double>\r\n -- !query 27 output\r\n NaN\r\n\r\n\r\n -- !query 28\r\n-select avg(CAST('NaN' AS DOUBLE)) from range(1,4)\r\n+select avg(CAST(udf('NaN') AS DOUBLE)) from range(1,4)\r\n -- !query 28 schema\r\n-struct<avg(CAST(NaN AS DOUBLE)):double>\r\n+struct<avg(CAST(CAST(udf(cast(NaN as string)) AS STRING) AS DOUBLE)):double>\r\n -- !query 28 output\r\n NaN\r\n\r\n\r\n -- !query 30\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('Infinity'), ('1')) v(x)\r\n -- !query 30 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double,var_pop(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double>\r\n -- !query 30 output\r\n Infinity       NaN\r\n\r\n\r\n -- !query 31\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('Infinity'), ('Infinity')) v(x)\r\n -- !query 31 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double,var_pop(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double>\r\n -- !query 31 output\r\n Infinity       NaN\r\n\r\n\r\n -- !query 32\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('-Infinity'), ('Infinity')) v(x)\r\n -- !query 32 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double,var_pop(CAST(CAST(udf(cast(x as string)) AS STRING) AS DOUBLE)):double>\r\n -- !query 32 output\r\n NaN    NaN\r\n\r\n\r\n -- !query 33\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(udf(CAST(x AS DOUBLE))), udf(var_pop(CAST(x AS DOUBLE)))\r\n FROM (VALUES (100000003), (100000004), (100000006), (100000007)) v(x)\r\n -- !query 33 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(cast(cast(x as double) as string)) AS DOUBLE)):double,CAST(udf(cast(var_pop(cast(x as double)) as string)) AS DOUBLE):double>\r\n -- !query 33 output\r\n 1.00000005E8   2.5\r\n\r\n\r\n -- !query 34\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(udf(CAST(x AS DOUBLE))), udf(var_pop(CAST(x AS DOUBLE)))\r\n FROM (VALUES (7000000000005), (7000000000007)) v(x)\r\n -- !query 34 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(cast(cast(x as double) as string)) AS DOUBLE)):double,CAST(udf(cast(var_pop(cast(x as double)) as string)) AS DOUBLE):double>\r\n -- !query 34 output\r\n 7.000000000006E12      1.0\r\n\r\n\r\n -- !query 35\r\n-SELECT covar_pop(b, a), covar_samp(b, a) FROM aggtest\r\n+SELECT udf(covar_pop(b, udf(a))), covar_samp(udf(b), a) FROM aggtest\r\n -- !query 35 schema\r\n-struct<covar_pop(CAST(b AS DOUBLE), CAST(a AS DOUBLE)):double,covar_samp(CAST(b AS DOUBLE), CAST(a AS DOUBLE)):double>\r\n+struct<CAST(udf(cast(covar_pop(cast(b as double), cast(cast(udf(cast(a as string)) as int) as double)) as string)) AS DOUBLE):double,covar_samp(CAST(CAST(udf(cast(b as string)) AS FLOAT) AS DOUBLE), CAST(a AS DOUBLE)):double>\r\n -- !query 35 output\r\n 653.6289553875104      871.5052738500139\r\n\r\n\r\n -- !query 36\r\n-SELECT corr(b, a) FROM aggtest\r\n+SELECT corr(b, udf(a)) FROM aggtest\r\n -- !query 36 schema\r\n-struct<corr(CAST(b AS DOUBLE), CAST(a AS DOUBLE)):double>\r\n+struct<corr(CAST(b AS DOUBLE), CAST(CAST(udf(cast(a as string)) AS INT) AS DOUBLE)):double>\r\n -- !query 36 output\r\n 0.1396345165178734\r\n\r\n\r\n -- !query 37\r\n-SELECT count(four) AS cnt_1000 FROM onek\r\n+SELECT count(udf(four)) AS cnt_1000 FROM onek\r\n -- !query 37 schema\r\n struct<cnt_1000:bigint>\r\n -- !query 37 output\r\n@@ -313,7 +314,7 @@ struct<cnt_1000:bigint>\r\n\r\n\r\n -- !query 38\r\n-SELECT count(DISTINCT four) AS cnt_4 FROM onek\r\n+SELECT udf(count(DISTINCT four)) AS cnt_4 FROM onek\r\n -- !query 38 schema\r\n struct<cnt_4:bigint>\r\n -- !query 38 output\r\n@@ -321,10 +322,10 @@ struct<cnt_4:bigint>\r\n\r\n\r\n -- !query 39\r\n-select ten, count(*), sum(four) from onek\r\n+select ten, udf(count(*)), sum(udf(four)) from onek\r\n group by ten order by ten\r\n -- !query 39 schema\r\n-struct<ten:int,count(1):bigint,sum(four):bigint>\r\n+struct<ten:int,CAST(udf(cast(count(1) as string)) AS BIGINT):bigint,sum(CAST(udf(cast(four as string)) AS INT)):bigint>\r\n -- !query 39 output\r\n 0      100     100\r\n 1      100     200\r\n@@ -339,10 +340,10 @@ struct<ten:int,count(1):bigint,sum(four):bigint>\r\n\r\n\r\n -- !query 40\r\n-select ten, count(four), sum(DISTINCT four) from onek\r\n+select ten, count(udf(four)), udf(sum(DISTINCT four)) from onek\r\n group by ten order by ten\r\n -- !query 40 schema\r\n-struct<ten:int,count(four):bigint,sum(DISTINCT four):bigint>\r\n+struct<ten:int,count(CAST(udf(cast(four as string)) AS INT)):bigint,CAST(udf(cast(sum(distinct cast(four as bigint)) as string)) AS BIGINT):bigint>\r\n -- !query 40 output\r\n 0      100     2\r\n 1      100     4\r\n@@ -357,11 +358,11 @@ struct<ten:int,count(four):bigint,sum(DISTINCT four):bigint>\r\n\r\n\r\n -- !query 41\r\n-select ten, sum(distinct four) from onek a\r\n+select ten, udf(sum(distinct four)) from onek a\r\n group by ten\r\n-having exists (select 1 from onek b where sum(distinct a.four) = b.four)\r\n+having exists (select 1 from onek b where udf(sum(distinct a.four)) = b.four)\r\n -- !query 41 schema\r\n-struct<ten:int,sum(DISTINCT four):bigint>\r\n+struct<ten:int,CAST(udf(cast(sum(distinct cast(four as bigint)) as string)) AS BIGINT):bigint>\r\n -- !query 41 output\r\n 0      2\r\n 2      2\r\n@@ -374,23 +375,23 @@ struct<ten:int,sum(DISTINCT four):bigint>\r\n select ten, sum(distinct four) from onek a\r\n group by ten\r\n having exists (select 1 from onek b\r\n-               where sum(distinct a.four + b.four) = b.four)\r\n+               where sum(distinct a.four + b.four) = udf(b.four))\r\n -- !query 42 schema\r\n struct<>\r\n -- !query 42 output\r\n org.apache.spark.sql.AnalysisException\r\n\r\n Aggregate/Window/Generate expressions are not valid in where clause of the query.\r\n-Expression in where clause: [(sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT)) = CAST(b.`four` AS BIGINT))]\r\n+Expression in where clause: [(sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT)) = CAST(CAST(udf(cast(four as string)) AS INT) AS BIGINT))]\r\n Invalid expressions: [sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT))];\r\n\r\n\r\n -- !query 43\r\n select\r\n-  (select max((select i.unique2 from tenk1 i where i.unique1 = o.unique1)))\r\n+  (select udf(max((select i.unique2 from tenk1 i where i.unique1 = o.unique1))))\r\n from tenk1 o\r\n -- !query 43 schema\r\n struct<>\r\n -- !query 43 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve '`o.unique1`' given input columns: [i.even, i.fivethous, i.four, i.hundred, i.odd, i.string4, i.stringu1, i.stringu2, i.ten, i.tenthous, i.thousand, i.twenty, i.two, i.twothousand, i.unique1, i.unique2]; line 2 pos 63\r\n+cannot resolve '`o.unique1`' given input columns: [i.even, i.fivethous, i.four, i.hundred, i.odd, i.string4, i.stringu1, i.stringu2, i.ten, i.tenthous, i.thousand, i.twenty, i.two, i.twothousand, i.unique1, i.unique2]; line 2 pos 67\r\n```\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nManually tested.\r\n","created_at":"2019-07-12T06:07:32Z","updated_at":"2020-03-03T01:18:27Z","closed_at":"2019-07-17T13:54:51Z","merged_at":null,"merge_commit_sha":"fe984afc0f1756bdfe5f79119a4fa7e5e2004985","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25130/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25130/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25130/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/720eea7bbd95c74065add08f6195f78d355d7e3a","head":{"label":"HyukjinKwon:SPARK-28359","ref":"SPARK-28359","sha":"720eea7bbd95c74065add08f6195f78d355d7e3a","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2ddeff97d7329942a98ef363991eeabc3fa71a76","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25130"},"html":{"href":"https://github.com/apache/spark/pull/25130"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25130"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25130/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25130/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25130/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/720eea7bbd95c74065add08f6195f78d355d7e3a"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25129","id":296909385,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2OTA5Mzg1","html_url":"https://github.com/apache/spark/pull/25129","diff_url":"https://github.com/apache/spark/pull/25129.diff","patch_url":"https://github.com/apache/spark/pull/25129.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25129","number":25129,"state":"closed","locked":false,"title":"[SPARK-28159][ML][FOLLOWUP] fix typo & (0 until v.size).toList => List.range(0, v.size)","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nfix typo in spark-28159\r\n`transfromWithMean` -> `transformWithMean` \r\n\r\n## How was this patch tested?\r\nexisting test\r\n","created_at":"2019-07-12T04:12:31Z","updated_at":"2019-07-15T03:11:55Z","closed_at":"2019-07-12T18:04:53Z","merged_at":null,"merge_commit_sha":"30ecfdfb06544987905ebe3b1f978bb3838f9337","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801475,"node_id":"MDU6TGFiZWwxNDA1ODAxNDc1","url":"https://api.github.com/repos/apache/spark/labels/ML","name":"ML","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25129/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25129/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25129/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8adbf49406d785310066dda7ab65bbde88e81421","head":{"label":"zhengruifeng:to_ml_vec_cleanup","ref":"to_ml_vec_cleanup","sha":"8adbf49406d785310066dda7ab65bbde88e81421","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"507b7457f4eb41271a18d5a8af29178a4879299a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25129"},"html":{"href":"https://github.com/apache/spark/pull/25129"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25129"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25129/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25129/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25129/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8adbf49406d785310066dda7ab65bbde88e81421"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25128","id":296887483,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2ODg3NDgz","html_url":"https://github.com/apache/spark/pull/25128","diff_url":"https://github.com/apache/spark/pull/25128.diff","patch_url":"https://github.com/apache/spark/pull/25128.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25128","number":25128,"state":"closed","locked":false,"title":"[SPARK-28270][test-maven][FOLLOW-UP][SQL][PYTHON][TESTS] Avoid cast input of UDF as double in the failed test in udf-aggregate_part1.sql","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nIt still can be flaky on certain environments due to float limitation described at https://github.com/apache/spark/pull/25110 . See https://github.com/apache/spark/pull/25110#discussion_r302735905\r\n\r\n- https://amplab.cs.berkeley.edu/jenkins/view/Spark%20QA%20Test%20(Dashboard)/job/spark-master-test-maven-hadoop-2.7/6584/testReport/org.apache.spark.sql/SQLQueryTestSuite/udf_pgSQL_udf_aggregates_part1_sql___Regular_Python_UDF/\r\n\r\n```\r\nExpected \"700000000000[6] 1\", but got \"700000000000[5] 1\" Result did not match for query #33&#010;SELECT CAST(avg(udf(CAST(x AS DOUBLE))) AS long), CAST(udf(var_pop(CAST(x AS DOUBLE))) AS decimal(10,3))&#010;FROM (VALUES (7000000000005), (7000000000007)) v(x)\r\n```\r\n\r\nHere;s what's going on: https://github.com/apache/spark/pull/25110#discussion_r302791930\r\n\r\n```\r\nscala> Seq(\"7000000000004.999\", \"7000000000006.999\").toDF().selectExpr(\"CAST(avg(value) AS long)\").show()\r\n+--------------------------+\r\n|CAST(avg(value) AS BIGINT)|\r\n+--------------------------+\r\n|             7000000000005|\r\n+--------------------------+\r\n```\r\n\r\nTherefore, this PR just avoid to cast in the specific test.\r\n\r\nThis is a temp fix. We need more robust way to avoid such cases.\r\n\r\n## How was this patch tested?\r\n\r\nIt passes with Maven in my local before/after this PR. I believe the problem seems similarly the Python or OS installed in the machine. I should test this against PR builder with `test-maven` for sure..\r\n\r\n","created_at":"2019-07-12T01:59:30Z","updated_at":"2020-03-03T01:18:29Z","closed_at":"2019-07-12T05:37:35Z","merged_at":null,"merge_commit_sha":"eda553a10b0bbc0d546f7e24e164476344f6d38d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25128/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25128/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25128/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/78d636d49efc416ac50367bb751b8819f263316b","head":{"label":"HyukjinKwon:SPARK-28270-2","ref":"SPARK-28270-2","sha":"78d636d49efc416ac50367bb751b8819f263316b","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"9eca58ed3e8ba5ba4e21637f88069f69c2337304","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25128"},"html":{"href":"https://github.com/apache/spark/pull/25128"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25128"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25128/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25128/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25128/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/78d636d49efc416ac50367bb751b8819f263316b"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25127","id":296867745,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2ODY3NzQ1","html_url":"https://github.com/apache/spark/pull/25127","diff_url":"https://github.com/apache/spark/pull/25127.diff","patch_url":"https://github.com/apache/spark/pull/25127.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25127","number":25127,"state":"closed","locked":false,"title":"[SPARK-28284][SQL][PYTHON][TESTS] Convert and port 'join-empty-relation.sql' into UDF test base","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from `join-empty-relation.sql` to test UDFs. Please see contribution guide of this umbrella ticket - [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n\r\n<details><summary>Diff comparing to 'join-empty-relation.sql'</summary>\r\n<p>\r\n\r\n```diff \r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/join-empty-relation.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-join-empty-relation.sql.out\r\nindex 857073a827..e79d01fb14 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/join-empty-relation.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-join-empty-relation.sql.out\r\n@@ -27,111 +27,111 @@ struct<>\r\n \r\n \r\n -- !query 3\r\n-SELECT * FROM t1 INNER JOIN empty_table\r\n+SELECT udf(t1.a), udf(empty_table.a) FROM t1 INNER JOIN empty_table ON (udf(t1.a) = udf(udf(empty_table.a)))\r\n -- !query 3 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int,CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 3 output\r\n \r\n \r\n \r\n -- !query 4\r\n-SELECT * FROM t1 CROSS JOIN empty_table\r\n+SELECT udf(t1.a), udf(udf(empty_table.a)) FROM t1 CROSS JOIN empty_table ON (udf(udf(t1.a)) = udf(empty_table.a))\r\n -- !query 4 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int,CAST(udf(cast(cast(udf(cast(a as string)) as int) as string)) AS INT):int>\r\n -- !query 4 output\r\n \r\n \r\n \r\n -- !query 5\r\n-SELECT * FROM t1 LEFT OUTER JOIN empty_table\r\n+SELECT udf(udf(t1.a)), empty_table.a FROM t1 LEFT OUTER JOIN empty_table ON (udf(t1.a) = udf(empty_table.a))\r\n -- !query 5 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(cast(udf(cast(a as string)) as int) as string)) AS INT):int,a:int>\r\n -- !query 5 output\r\n 1\tNULL\r\n \r\n \r\n -- !query 6\r\n-SELECT * FROM t1 RIGHT OUTER JOIN empty_table\r\n+SELECT udf(t1.a), udf(empty_table.a) FROM t1 RIGHT OUTER JOIN empty_table ON (udf(t1.a) = udf(empty_table.a))\r\n -- !query 6 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int,CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 6 output\r\n \r\n \r\n \r\n -- !query 7\r\n-SELECT * FROM t1 FULL OUTER JOIN empty_table\r\n+SELECT udf(t1.a), empty_table.a FROM t1 FULL OUTER JOIN empty_table ON (udf(t1.a) = udf(empty_table.a))\r\n -- !query 7 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int,a:int>\r\n -- !query 7 output\r\n 1\tNULL\r\n \r\n \r\n -- !query 8\r\n-SELECT * FROM t1 LEFT SEMI JOIN empty_table\r\n+SELECT udf(udf(t1.a)) FROM t1 LEFT SEMI JOIN empty_table ON (udf(t1.a) = udf(udf(empty_table.a)))\r\n -- !query 8 schema\r\n-struct<a:int>\r\n+struct<CAST(udf(cast(cast(udf(cast(a as string)) as int) as string)) AS INT):int>\r\n -- !query 8 output\r\n \r\n \r\n \r\n -- !query 9\r\n-SELECT * FROM t1 LEFT ANTI JOIN empty_table\r\n+SELECT udf(t1.a) FROM t1 LEFT ANTI JOIN empty_table ON (udf(t1.a) = udf(empty_table.a))\r\n -- !query 9 schema\r\n-struct<a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 9 output\r\n 1\r\n \r\n \r\n -- !query 10\r\n-SELECT * FROM empty_table INNER JOIN t1\r\n+SELECT udf(empty_table.a), udf(t1.a) FROM empty_table INNER JOIN t1 ON (udf(udf(empty_table.a)) = udf(t1.a))\r\n -- !query 10 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int,CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 10 output\r\n \r\n \r\n \r\n -- !query 11\r\n-SELECT * FROM empty_table CROSS JOIN t1\r\n+SELECT udf(empty_table.a), udf(udf(t1.a)) FROM empty_table CROSS JOIN t1 ON (udf(empty_table.a) = udf(udf(t1.a)))\r\n -- !query 11 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int,CAST(udf(cast(cast(udf(cast(a as string)) as int) as string)) AS INT):int>\r\n -- !query 11 output\r\n \r\n \r\n \r\n -- !query 12\r\n-SELECT * FROM empty_table LEFT OUTER JOIN t1\r\n+SELECT udf(udf(empty_table.a)), udf(t1.a) FROM empty_table LEFT OUTER JOIN t1 ON (udf(empty_table.a) = udf(t1.a))\r\n -- !query 12 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(cast(udf(cast(a as string)) as int) as string)) AS INT):int,CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 12 output\r\n \r\n \r\n \r\n -- !query 13\r\n-SELECT * FROM empty_table RIGHT OUTER JOIN t1\r\n+SELECT empty_table.a, udf(t1.a) FROM empty_table RIGHT OUTER JOIN t1 ON (udf(empty_table.a) = udf(t1.a))\r\n -- !query 13 schema\r\n-struct<a:int,a:int>\r\n+struct<a:int,CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 13 output\r\n NULL\t1\r\n \r\n \r\n -- !query 14\r\n-SELECT * FROM empty_table FULL OUTER JOIN t1\r\n+SELECT empty_table.a, udf(udf(t1.a)) FROM empty_table FULL OUTER JOIN t1 ON (udf(empty_table.a) = udf(t1.a))\r\n -- !query 14 schema\r\n-struct<a:int,a:int>\r\n+struct<a:int,CAST(udf(cast(cast(udf(cast(a as string)) as int) as string)) AS INT):int>\r\n -- !query 14 output\r\n NULL\t1\r\n \r\n \r\n -- !query 15\r\n-SELECT * FROM empty_table LEFT SEMI JOIN t1\r\n+SELECT udf(udf(empty_table.a)) FROM empty_table LEFT SEMI JOIN t1 ON (udf(empty_table.a) = udf(udf(t1.a)))\r\n -- !query 15 schema\r\n-struct<a:int>\r\n+struct<CAST(udf(cast(cast(udf(cast(a as string)) as int) as string)) AS INT):int>\r\n -- !query 15 output\r\n \r\n \r\n \r\n -- !query 16\r\n-SELECT * FROM empty_table LEFT ANTI JOIN t1\r\n+SELECT empty_table.a FROM empty_table LEFT ANTI JOIN t1 ON (udf(empty_table.a) = udf(t1.a))\r\n -- !query 16 schema\r\n struct<a:int>\r\n -- !query 16 output\r\n@@ -139,56 +139,56 @@ struct<a:int>\r\n \r\n \r\n -- !query 17\r\n-SELECT * FROM empty_table INNER JOIN empty_table\r\n+SELECT udf(empty_table.a) FROM empty_table INNER JOIN empty_table AS empty_table2 ON (udf(empty_table.a) = udf(udf(empty_table2.a)))\r\n -- !query 17 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 17 output\r\n \r\n \r\n \r\n -- !query 18\r\n-SELECT * FROM empty_table CROSS JOIN empty_table\r\n+SELECT udf(udf(empty_table.a)) FROM empty_table CROSS JOIN empty_table AS empty_table2 ON (udf(udf(empty_table.a)) = udf(empty_table2.a))\r\n -- !query 18 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(cast(udf(cast(a as string)) as int) as string)) AS INT):int>\r\n -- !query 18 output\r\n \r\n \r\n \r\n -- !query 19\r\n-SELECT * FROM empty_table LEFT OUTER JOIN empty_table\r\n+SELECT udf(empty_table.a) FROM empty_table LEFT OUTER JOIN empty_table AS empty_table2 ON (udf(empty_table.a) = udf(empty_table2.a))\r\n -- !query 19 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 19 output\r\n \r\n \r\n \r\n -- !query 20\r\n-SELECT * FROM empty_table RIGHT OUTER JOIN empty_table\r\n+SELECT udf(udf(empty_table.a)) FROM empty_table RIGHT OUTER JOIN empty_table AS empty_table2 ON (udf(empty_table.a) = udf(udf(empty_table2.a)))\r\n -- !query 20 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(cast(udf(cast(a as string)) as int) as string)) AS INT):int>\r\n -- !query 20 output\r\n \r\n \r\n \r\n -- !query 21\r\n-SELECT * FROM empty_table FULL OUTER JOIN empty_table\r\n+SELECT udf(empty_table.a) FROM empty_table FULL OUTER JOIN empty_table AS empty_table2 ON (udf(empty_table.a) = udf(empty_table2.a))\r\n -- !query 21 schema\r\n-struct<a:int,a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 21 output\r\n \r\n \r\n \r\n -- !query 22\r\n-SELECT * FROM empty_table LEFT SEMI JOIN empty_table\r\n+SELECT udf(udf(empty_table.a)) FROM empty_table LEFT SEMI JOIN empty_table AS empty_table2 ON (udf(empty_table.a) = udf(empty_table2.a))\r\n -- !query 22 schema\r\n-struct<a:int>\r\n+struct<CAST(udf(cast(cast(udf(cast(a as string)) as int) as string)) AS INT):int>\r\n -- !query 22 output\r\n \r\n \r\n \r\n -- !query 23\r\n-SELECT * FROM empty_table LEFT ANTI JOIN empty_table\r\n+SELECT udf(empty_table.a) FROM empty_table LEFT ANTI JOIN empty_table AS empty_table2 ON (udf(empty_table.a) = udf(empty_table2.a))\r\n -- !query 23 schema\r\n-struct<a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 23 output\r\n \r\n```\r\n</p>\r\n</details> \r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).","created_at":"2019-07-11T23:58:58Z","updated_at":"2019-07-19T21:36:06Z","closed_at":"2019-07-19T07:31:43Z","merged_at":null,"merge_commit_sha":"007c9e931a71c8c675e3a2a695e986c7d88832a9","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25127/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25127/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25127/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e70e147873f7b180a5551c2b2f047019c3bb6d79","head":{"label":"imback82:join-empty-relation-sql","ref":"join-empty-relation-sql","sha":"e70e147873f7b180a5551c2b2f047019c3bb6d79","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":190453549,"node_id":"MDEwOlJlcG9zaXRvcnkxOTA0NTM1NDk=","name":"spark-4","full_name":"imback82/spark-4","private":false,"owner":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/imback82/spark-4","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/imback82/spark-4","forks_url":"https://api.github.com/repos/imback82/spark-4/forks","keys_url":"https://api.github.com/repos/imback82/spark-4/keys{/key_id}","collaborators_url":"https://api.github.com/repos/imback82/spark-4/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/imback82/spark-4/teams","hooks_url":"https://api.github.com/repos/imback82/spark-4/hooks","issue_events_url":"https://api.github.com/repos/imback82/spark-4/issues/events{/number}","events_url":"https://api.github.com/repos/imback82/spark-4/events","assignees_url":"https://api.github.com/repos/imback82/spark-4/assignees{/user}","branches_url":"https://api.github.com/repos/imback82/spark-4/branches{/branch}","tags_url":"https://api.github.com/repos/imback82/spark-4/tags","blobs_url":"https://api.github.com/repos/imback82/spark-4/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/imback82/spark-4/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/imback82/spark-4/git/refs{/sha}","trees_url":"https://api.github.com/repos/imback82/spark-4/git/trees{/sha}","statuses_url":"https://api.github.com/repos/imback82/spark-4/statuses/{sha}","languages_url":"https://api.github.com/repos/imback82/spark-4/languages","stargazers_url":"https://api.github.com/repos/imback82/spark-4/stargazers","contributors_url":"https://api.github.com/repos/imback82/spark-4/contributors","subscribers_url":"https://api.github.com/repos/imback82/spark-4/subscribers","subscription_url":"https://api.github.com/repos/imback82/spark-4/subscription","commits_url":"https://api.github.com/repos/imback82/spark-4/commits{/sha}","git_commits_url":"https://api.github.com/repos/imback82/spark-4/git/commits{/sha}","comments_url":"https://api.github.com/repos/imback82/spark-4/comments{/number}","issue_comment_url":"https://api.github.com/repos/imback82/spark-4/issues/comments{/number}","contents_url":"https://api.github.com/repos/imback82/spark-4/contents/{+path}","compare_url":"https://api.github.com/repos/imback82/spark-4/compare/{base}...{head}","merges_url":"https://api.github.com/repos/imback82/spark-4/merges","archive_url":"https://api.github.com/repos/imback82/spark-4/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/imback82/spark-4/downloads","issues_url":"https://api.github.com/repos/imback82/spark-4/issues{/number}","pulls_url":"https://api.github.com/repos/imback82/spark-4/pulls{/number}","milestones_url":"https://api.github.com/repos/imback82/spark-4/milestones{/number}","notifications_url":"https://api.github.com/repos/imback82/spark-4/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/imback82/spark-4/labels{/name}","releases_url":"https://api.github.com/repos/imback82/spark-4/releases{/id}","deployments_url":"https://api.github.com/repos/imback82/spark-4/deployments","created_at":"2019-06-05T19:09:03Z","updated_at":"2022-01-05T16:28:23Z","pushed_at":"2024-02-20T02:09:15Z","git_url":"git://github.com/imback82/spark-4.git","ssh_url":"git@github.com:imback82/spark-4.git","clone_url":"https://github.com/imback82/spark-4.git","svn_url":"https://github.com/imback82/spark-4","homepage":"","size":412962,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2cf0491a97c17762c36321c28279b28f7510f722","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25127"},"html":{"href":"https://github.com/apache/spark/pull/25127"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25127"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25127/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25127/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25127/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e70e147873f7b180a5551c2b2f047019c3bb6d79"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25126","id":296861844,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2ODYxODQ0","html_url":"https://github.com/apache/spark/pull/25126","diff_url":"https://github.com/apache/spark/pull/25126.diff","patch_url":"https://github.com/apache/spark/pull/25126.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25126","number":25126,"state":"closed","locked":false,"title":"[SPARK-28306][SQL][FOLLOWUP] Fix NormalizeFloatingNumbers rule idempotence for equi-join with `<=>` predicates","user":{"login":"yeshengm","id":12269969,"node_id":"MDQ6VXNlcjEyMjY5OTY5","avatar_url":"https://avatars.githubusercontent.com/u/12269969?v=4","gravatar_id":"","url":"https://api.github.com/users/yeshengm","html_url":"https://github.com/yeshengm","followers_url":"https://api.github.com/users/yeshengm/followers","following_url":"https://api.github.com/users/yeshengm/following{/other_user}","gists_url":"https://api.github.com/users/yeshengm/gists{/gist_id}","starred_url":"https://api.github.com/users/yeshengm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeshengm/subscriptions","organizations_url":"https://api.github.com/users/yeshengm/orgs","repos_url":"https://api.github.com/users/yeshengm/repos","events_url":"https://api.github.com/users/yeshengm/events{/privacy}","received_events_url":"https://api.github.com/users/yeshengm/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nIdempotence of the `NormalizeFloatingNumbers` rule was broken due to the implementation of `ExtractEquiJoinKeys`. There is no reason that we don't remove `EqualNullSafe` join keys from an equi-join's `otherPredicates`.\r\n\r\n## How was this patch tested?\r\nA new UT.","created_at":"2019-07-11T23:25:49Z","updated_at":"2019-07-15T17:43:19Z","closed_at":"2019-07-15T17:43:19Z","merged_at":null,"merge_commit_sha":"71057a53eac292b6e70b7df4a5b55e4a7b5667b9","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25126/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25126/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25126/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/40cbad16bf8ba12c23f80fa04152506c6093ca06","head":{"label":"yeshengm:spark-28306","ref":"spark-28306","sha":"40cbad16bf8ba12c23f80fa04152506c6093ca06","user":{"login":"yeshengm","id":12269969,"node_id":"MDQ6VXNlcjEyMjY5OTY5","avatar_url":"https://avatars.githubusercontent.com/u/12269969?v=4","gravatar_id":"","url":"https://api.github.com/users/yeshengm","html_url":"https://github.com/yeshengm","followers_url":"https://api.github.com/users/yeshengm/followers","following_url":"https://api.github.com/users/yeshengm/following{/other_user}","gists_url":"https://api.github.com/users/yeshengm/gists{/gist_id}","starred_url":"https://api.github.com/users/yeshengm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeshengm/subscriptions","organizations_url":"https://api.github.com/users/yeshengm/orgs","repos_url":"https://api.github.com/users/yeshengm/repos","events_url":"https://api.github.com/users/yeshengm/events{/privacy}","received_events_url":"https://api.github.com/users/yeshengm/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":187889692,"node_id":"MDEwOlJlcG9zaXRvcnkxODc4ODk2OTI=","name":"spark","full_name":"yeshengm/spark","private":false,"owner":{"login":"yeshengm","id":12269969,"node_id":"MDQ6VXNlcjEyMjY5OTY5","avatar_url":"https://avatars.githubusercontent.com/u/12269969?v=4","gravatar_id":"","url":"https://api.github.com/users/yeshengm","html_url":"https://github.com/yeshengm","followers_url":"https://api.github.com/users/yeshengm/followers","following_url":"https://api.github.com/users/yeshengm/following{/other_user}","gists_url":"https://api.github.com/users/yeshengm/gists{/gist_id}","starred_url":"https://api.github.com/users/yeshengm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeshengm/subscriptions","organizations_url":"https://api.github.com/users/yeshengm/orgs","repos_url":"https://api.github.com/users/yeshengm/repos","events_url":"https://api.github.com/users/yeshengm/events{/privacy}","received_events_url":"https://api.github.com/users/yeshengm/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yeshengm/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/yeshengm/spark","forks_url":"https://api.github.com/repos/yeshengm/spark/forks","keys_url":"https://api.github.com/repos/yeshengm/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yeshengm/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yeshengm/spark/teams","hooks_url":"https://api.github.com/repos/yeshengm/spark/hooks","issue_events_url":"https://api.github.com/repos/yeshengm/spark/issues/events{/number}","events_url":"https://api.github.com/repos/yeshengm/spark/events","assignees_url":"https://api.github.com/repos/yeshengm/spark/assignees{/user}","branches_url":"https://api.github.com/repos/yeshengm/spark/branches{/branch}","tags_url":"https://api.github.com/repos/yeshengm/spark/tags","blobs_url":"https://api.github.com/repos/yeshengm/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yeshengm/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yeshengm/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/yeshengm/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yeshengm/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/yeshengm/spark/languages","stargazers_url":"https://api.github.com/repos/yeshengm/spark/stargazers","contributors_url":"https://api.github.com/repos/yeshengm/spark/contributors","subscribers_url":"https://api.github.com/repos/yeshengm/spark/subscribers","subscription_url":"https://api.github.com/repos/yeshengm/spark/subscription","commits_url":"https://api.github.com/repos/yeshengm/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/yeshengm/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/yeshengm/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/yeshengm/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/yeshengm/spark/contents/{+path}","compare_url":"https://api.github.com/repos/yeshengm/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yeshengm/spark/merges","archive_url":"https://api.github.com/repos/yeshengm/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yeshengm/spark/downloads","issues_url":"https://api.github.com/repos/yeshengm/spark/issues{/number}","pulls_url":"https://api.github.com/repos/yeshengm/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/yeshengm/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/yeshengm/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yeshengm/spark/labels{/name}","releases_url":"https://api.github.com/repos/yeshengm/spark/releases{/id}","deployments_url":"https://api.github.com/repos/yeshengm/spark/deployments","created_at":"2019-05-21T18:06:45Z","updated_at":"2019-06-10T23:01:04Z","pushed_at":"2022-02-09T05:43:22Z","git_url":"git://github.com/yeshengm/spark.git","ssh_url":"git@github.com:yeshengm/spark.git","clone_url":"https://github.com/yeshengm/spark.git","svn_url":"https://github.com/yeshengm/spark","homepage":"","size":390452,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1a26126d8c5e9bb647f858db236c370685f2f2da","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25126"},"html":{"href":"https://github.com/apache/spark/pull/25126"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25126"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25126/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25126/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25126/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/40cbad16bf8ba12c23f80fa04152506c6093ca06"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25125","id":296856712,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2ODU2NzEy","html_url":"https://github.com/apache/spark/pull/25125","diff_url":"https://github.com/apache/spark/pull/25125.diff","patch_url":"https://github.com/apache/spark/pull/25125.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25125","number":25125,"state":"closed","locked":false,"title":"[SPARK-28357][CORE][TEST] Fix Flaky Test - FileAppenderSuite.rollingfile appender - size-based rolling compressed","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n`SizeBasedRollingPolicy.shouldRollover` returns false when the size is equal to `rolloverSizeBytes`.\r\n```scala\r\n  /** Should rollover if the next set of bytes is going to exceed the size limit */\r\n  def shouldRollover(bytesToBeWritten: Long): Boolean = {\r\n    logDebug(s\"$bytesToBeWritten + $bytesWrittenSinceRollover > $rolloverSizeBytes\")\r\n    bytesToBeWritten + bytesWrittenSinceRollover > rolloverSizeBytes\r\n  }\r\n```\r\n- https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/107553/testReport/org.apache.spark.util/FileAppenderSuite/rolling_file_appender___size_based_rolling__compressed_/\r\n```\r\norg.scalatest.exceptions.TestFailedException: 1000 was not less than 1000\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nPass the Jenkins with the updated test.","created_at":"2019-07-11T23:00:19Z","updated_at":"2019-07-12T13:59:13Z","closed_at":"2019-07-12T09:44:44Z","merged_at":null,"merge_commit_sha":"cd0ae891920d8ba5015e33d7f97a5b6c4695ee25","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25125/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25125/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25125/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/46a29fedad87ad422a4f56d9483d0b2d5d0136e7","head":{"label":"dongjoon-hyun:SPARK-28357","ref":"SPARK-28357","sha":"46a29fedad87ad422a4f56d9483d0b2d5d0136e7","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"9eca58ed3e8ba5ba4e21637f88069f69c2337304","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25125"},"html":{"href":"https://github.com/apache/spark/pull/25125"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25125"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25125/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25125/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25125/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/46a29fedad87ad422a4f56d9483d0b2d5d0136e7"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25124","id":296856303,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2ODU2MzAz","html_url":"https://github.com/apache/spark/pull/25124","diff_url":"https://github.com/apache/spark/pull/25124.diff","patch_url":"https://github.com/apache/spark/pull/25124.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25124","number":25124,"state":"closed","locked":false,"title":"[SPARK-28282][SQL][PYTHON][TESTS] Convert and port 'inline-table.sql' into UDF test base","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from `inline-table.sql` to test UDFs. Please see contribution guide of this umbrella ticket - [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n\r\n<details><summary>Diff comparing to 'inline-table.sql'</summary>\r\n<p>\r\n\r\n```diff \r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/inline-table.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-inline-table.sql.out\r\nindex 4e80f0bda5..2cf24e50c8 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/inline-table.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-inline-table.sql.out\r\n@@ -3,33 +3,33 @@\r\n \r\n \r\n -- !query 0\r\n-select * from values (\"one\", 1)\r\n+select udf(col1), udf(col2) from values (\"one\", 1)\r\n -- !query 0 schema\r\n-struct<col1:string,col2:int>\r\n+struct<CAST(udf(cast(col1 as string)) AS STRING):string,CAST(udf(cast(col2 as string)) AS INT):int>\r\n -- !query 0 output\r\n one\t1\r\n \r\n \r\n -- !query 1\r\n-select * from values (\"one\", 1) as data\r\n+select udf(col1), udf(udf(col2)) from values (\"one\", 1) as data\r\n -- !query 1 schema\r\n-struct<col1:string,col2:int>\r\n+struct<CAST(udf(cast(col1 as string)) AS STRING):string,CAST(udf(cast(cast(udf(cast(col2 as string)) as int) as string)) AS INT):int>\r\n -- !query 1 output\r\n one\t1\r\n \r\n \r\n -- !query 2\r\n-select * from values (\"one\", 1) as data(a, b)\r\n+select udf(a), b from values (\"one\", 1) as data(a, b)\r\n -- !query 2 schema\r\n-struct<a:string,b:int>\r\n+struct<CAST(udf(cast(a as string)) AS STRING):string,b:int>\r\n -- !query 2 output\r\n one\t1\r\n \r\n \r\n -- !query 3\r\n-select * from values 1, 2, 3 as data(a)\r\n+select udf(a) from values 1, 2, 3 as data(a)\r\n -- !query 3 schema\r\n-struct<a:int>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int>\r\n -- !query 3 output\r\n 1\r\n 2\r\n@@ -37,9 +37,9 @@ struct<a:int>\r\n \r\n \r\n -- !query 4\r\n-select * from values (\"one\", 1), (\"two\", 2), (\"three\", null) as data(a, b)\r\n+select udf(a), b from values (\"one\", 1), (\"two\", 2), (\"three\", null) as data(a, b)\r\n -- !query 4 schema\r\n-struct<a:string,b:int>\r\n+struct<CAST(udf(cast(a as string)) AS STRING):string,b:int>\r\n -- !query 4 output\r\n one\t1\r\n three\tNULL\r\n@@ -47,107 +47,107 @@ two\t2\r\n \r\n \r\n -- !query 5\r\n-select * from values (\"one\", null), (\"two\", null) as data(a, b)\r\n+select udf(a), b from values (\"one\", null), (\"two\", null) as data(a, b)\r\n -- !query 5 schema\r\n-struct<a:string,b:null>\r\n+struct<CAST(udf(cast(a as string)) AS STRING):string,b:null>\r\n -- !query 5 output\r\n one\tNULL\r\n two\tNULL\r\n \r\n \r\n -- !query 6\r\n-select * from values (\"one\", 1), (\"two\", 2L) as data(a, b)\r\n+select udf(a), b from values (\"one\", 1), (\"two\", 2L) as data(a, b)\r\n -- !query 6 schema\r\n-struct<a:string,b:bigint>\r\n+struct<CAST(udf(cast(a as string)) AS STRING):string,b:bigint>\r\n -- !query 6 output\r\n one\t1\r\n two\t2\r\n \r\n \r\n -- !query 7\r\n-select * from values (\"one\", 1 + 0), (\"two\", 1 + 3L) as data(a, b)\r\n+select udf(udf(a)), udf(b) from values (\"one\", 1 + 0), (\"two\", 1 + 3L) as data(a, b)\r\n -- !query 7 schema\r\n-struct<a:string,b:bigint>\r\n+struct<CAST(udf(cast(cast(udf(cast(a as string)) as string) as string)) AS STRING):string,CAST(udf(cast(b as string)) AS BIGINT):bigint>\r\n -- !query 7 output\r\n one\t1\r\n two\t4\r\n \r\n \r\n -- !query 8\r\n-select * from values (\"one\", array(0, 1)), (\"two\", array(2, 3)) as data(a, b)\r\n+select udf(a), b from values (\"one\", array(0, 1)), (\"two\", array(2, 3)) as data(a, b)\r\n -- !query 8 schema\r\n-struct<a:string,b:array<int>>\r\n+struct<CAST(udf(cast(a as string)) AS STRING):string,b:array<int>>\r\n -- !query 8 output\r\n one\t[0,1]\r\n two\t[2,3]\r\n \r\n \r\n -- !query 9\r\n-select * from values (\"one\", 2.0), (\"two\", 3.0D) as data(a, b)\r\n+select udf(a), b from values (\"one\", 2.0), (\"two\", 3.0D) as data(a, b)\r\n -- !query 9 schema\r\n-struct<a:string,b:double>\r\n+struct<CAST(udf(cast(a as string)) AS STRING):string,b:double>\r\n -- !query 9 output\r\n one\t2.0\r\n two\t3.0\r\n \r\n \r\n -- !query 10\r\n-select * from values (\"one\", rand(5)), (\"two\", 3.0D) as data(a, b)\r\n+select udf(a), b from values (\"one\", rand(5)), (\"two\", 3.0D) as data(a, b)\r\n -- !query 10 schema\r\n struct<>\r\n -- !query 10 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot evaluate expression rand(5) in inline table definition; line 1 pos 29\r\n+cannot evaluate expression rand(5) in inline table definition; line 1 pos 37\r\n \r\n \r\n -- !query 11\r\n-select * from values (\"one\", 2.0), (\"two\") as data(a, b)\r\n+select udf(a), udf(b) from values (\"one\", 2.0), (\"two\") as data(a, b)\r\n -- !query 11 schema\r\n struct<>\r\n -- !query 11 output\r\n org.apache.spark.sql.AnalysisException\r\n-expected 2 columns but found 1 columns in row 1; line 1 pos 14\r\n+expected 2 columns but found 1 columns in row 1; line 1 pos 27\r\n \r\n \r\n -- !query 12\r\n-select * from values (\"one\", array(0, 1)), (\"two\", struct(1, 2)) as data(a, b)\r\n+select udf(a), udf(b) from values (\"one\", array(0, 1)), (\"two\", struct(1, 2)) as data(a, b)\r\n -- !query 12 schema\r\n struct<>\r\n -- !query 12 output\r\n org.apache.spark.sql.AnalysisException\r\n-incompatible types found in column b for inline table; line 1 pos 14\r\n+incompatible types found in column b for inline table; line 1 pos 27\r\n \r\n \r\n -- !query 13\r\n-select * from values (\"one\"), (\"two\") as data(a, b)\r\n+select udf(a), udf(b) from values (\"one\"), (\"two\") as data(a, b)\r\n -- !query 13 schema\r\n struct<>\r\n -- !query 13 output\r\n org.apache.spark.sql.AnalysisException\r\n-expected 2 columns but found 1 columns in row 0; line 1 pos 14\r\n+expected 2 columns but found 1 columns in row 0; line 1 pos 27\r\n \r\n \r\n -- !query 14\r\n-select * from values (\"one\", random_not_exist_func(1)), (\"two\", 2) as data(a, b)\r\n+select udf(a), udf(b) from values (\"one\", random_not_exist_func(1)), (\"two\", 2) as data(a, b)\r\n -- !query 14 schema\r\n struct<>\r\n -- !query 14 output\r\n org.apache.spark.sql.AnalysisException\r\n-Undefined function: 'random_not_exist_func'. This function is neither a registered temporary function nor a permanent function registered in the database 'default'.; line 1 pos 29\r\n+Undefined function: 'random_not_exist_func'. This function is neither a registered temporary function nor a permanent function registered in the database 'default'.; line 1 pos 42\r\n \r\n \r\n -- !query 15\r\n-select * from values (\"one\", count(1)), (\"two\", 2) as data(a, b)\r\n+select udf(a), udf(b) from values (\"one\", count(1)), (\"two\", 2) as data(a, b)\r\n -- !query 15 schema\r\n struct<>\r\n -- !query 15 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot evaluate expression count(1) in inline table definition; line 1 pos 29\r\n+cannot evaluate expression count(1) in inline table definition; line 1 pos 42\r\n \r\n \r\n -- !query 16\r\n-select * from values (timestamp('1991-12-06 00:00:00.0'), array(timestamp('1991-12-06 01:00:00.0'), timestamp('1991-12-06 12:00:00.0'))) as data(a, b)\r\n+select udf(a), b from values (timestamp('1991-12-06 00:00:00.0'), array(timestamp('1991-12-06 01:00:00.0'), timestamp('1991-12-06 12:00:00.0'))) as data(a, b)\r\n -- !query 16 schema\r\n-struct<a:timestamp,b:array<timestamp>>\r\n+struct<CAST(udf(cast(a as string)) AS TIMESTAMP):timestamp,b:array<timestamp>>\r\n -- !query 16 output\r\n 1991-12-06 00:00:00\t[1991-12-06 01:00:00.0,1991-12-06 12:00:00.0]\r\n\r\n```\r\n</p>\r\n</details> \r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).","created_at":"2019-07-11T22:58:25Z","updated_at":"2019-07-20T06:24:40Z","closed_at":"2019-07-20T06:24:40Z","merged_at":null,"merge_commit_sha":"a64ec97ccfe5b64b40e499975dee408b14623784","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25124/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25124/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25124/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1ba0886b8d2928252efba4c09da816c72c1e8657","head":{"label":"imback82:inline-table-sql","ref":"inline-table-sql","sha":"1ba0886b8d2928252efba4c09da816c72c1e8657","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":190453549,"node_id":"MDEwOlJlcG9zaXRvcnkxOTA0NTM1NDk=","name":"spark-4","full_name":"imback82/spark-4","private":false,"owner":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/imback82/spark-4","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/imback82/spark-4","forks_url":"https://api.github.com/repos/imback82/spark-4/forks","keys_url":"https://api.github.com/repos/imback82/spark-4/keys{/key_id}","collaborators_url":"https://api.github.com/repos/imback82/spark-4/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/imback82/spark-4/teams","hooks_url":"https://api.github.com/repos/imback82/spark-4/hooks","issue_events_url":"https://api.github.com/repos/imback82/spark-4/issues/events{/number}","events_url":"https://api.github.com/repos/imback82/spark-4/events","assignees_url":"https://api.github.com/repos/imback82/spark-4/assignees{/user}","branches_url":"https://api.github.com/repos/imback82/spark-4/branches{/branch}","tags_url":"https://api.github.com/repos/imback82/spark-4/tags","blobs_url":"https://api.github.com/repos/imback82/spark-4/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/imback82/spark-4/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/imback82/spark-4/git/refs{/sha}","trees_url":"https://api.github.com/repos/imback82/spark-4/git/trees{/sha}","statuses_url":"https://api.github.com/repos/imback82/spark-4/statuses/{sha}","languages_url":"https://api.github.com/repos/imback82/spark-4/languages","stargazers_url":"https://api.github.com/repos/imback82/spark-4/stargazers","contributors_url":"https://api.github.com/repos/imback82/spark-4/contributors","subscribers_url":"https://api.github.com/repos/imback82/spark-4/subscribers","subscription_url":"https://api.github.com/repos/imback82/spark-4/subscription","commits_url":"https://api.github.com/repos/imback82/spark-4/commits{/sha}","git_commits_url":"https://api.github.com/repos/imback82/spark-4/git/commits{/sha}","comments_url":"https://api.github.com/repos/imback82/spark-4/comments{/number}","issue_comment_url":"https://api.github.com/repos/imback82/spark-4/issues/comments{/number}","contents_url":"https://api.github.com/repos/imback82/spark-4/contents/{+path}","compare_url":"https://api.github.com/repos/imback82/spark-4/compare/{base}...{head}","merges_url":"https://api.github.com/repos/imback82/spark-4/merges","archive_url":"https://api.github.com/repos/imback82/spark-4/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/imback82/spark-4/downloads","issues_url":"https://api.github.com/repos/imback82/spark-4/issues{/number}","pulls_url":"https://api.github.com/repos/imback82/spark-4/pulls{/number}","milestones_url":"https://api.github.com/repos/imback82/spark-4/milestones{/number}","notifications_url":"https://api.github.com/repos/imback82/spark-4/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/imback82/spark-4/labels{/name}","releases_url":"https://api.github.com/repos/imback82/spark-4/releases{/id}","deployments_url":"https://api.github.com/repos/imback82/spark-4/deployments","created_at":"2019-06-05T19:09:03Z","updated_at":"2022-01-05T16:28:23Z","pushed_at":"2024-02-20T02:09:15Z","git_url":"git://github.com/imback82/spark-4.git","ssh_url":"git@github.com:imback82/spark-4.git","clone_url":"https://github.com/imback82/spark-4.git","svn_url":"https://github.com/imback82/spark-4","homepage":"","size":412962,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2cf0491a97c17762c36321c28279b28f7510f722","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25124"},"html":{"href":"https://github.com/apache/spark/pull/25124"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25124"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25124/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25124/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25124/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1ba0886b8d2928252efba4c09da816c72c1e8657"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25123","id":296853345,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2ODUzMzQ1","html_url":"https://github.com/apache/spark/pull/25123","diff_url":"https://github.com/apache/spark/pull/25123.diff","patch_url":"https://github.com/apache/spark/pull/25123.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25123","number":25123,"state":"closed","locked":false,"title":"[SPARK-28355][CORE][PYTHON] Use Spark conf for threshold at which command is compressed by broadcast","user":{"login":"jessecai","id":52179364,"node_id":"MDQ6VXNlcjUyMTc5MzY0","avatar_url":"https://avatars.githubusercontent.com/u/52179364?v=4","gravatar_id":"","url":"https://api.github.com/users/jessecai","html_url":"https://github.com/jessecai","followers_url":"https://api.github.com/users/jessecai/followers","following_url":"https://api.github.com/users/jessecai/following{/other_user}","gists_url":"https://api.github.com/users/jessecai/gists{/gist_id}","starred_url":"https://api.github.com/users/jessecai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessecai/subscriptions","organizations_url":"https://api.github.com/users/jessecai/orgs","repos_url":"https://api.github.com/users/jessecai/repos","events_url":"https://api.github.com/users/jessecai/events{/privacy}","received_events_url":"https://api.github.com/users/jessecai/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe `_prepare_for_python_RDD` method currently broadcasts a pickled command if its length is greater than the hardcoded value `1 << 20` (1M). This change sets this value as a Spark conf instead.\r\n\r\n## How was this patch tested?\r\n\r\nUnit tests, manual tests.\r\n","created_at":"2019-07-11T22:43:47Z","updated_at":"2019-07-14T05:55:23Z","closed_at":"2019-07-13T15:49:43Z","merged_at":null,"merge_commit_sha":"d64231822b8ecb414dfd7ed4c4f96e01b74431e4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25123/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25123/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25123/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1ec3a4a338a6f5c5ba9056946ab9747fe7dc0a3d","head":{"label":"jessecai:SPARK-28355","ref":"SPARK-28355","sha":"1ec3a4a338a6f5c5ba9056946ab9747fe7dc0a3d","user":{"login":"jessecai","id":52179364,"node_id":"MDQ6VXNlcjUyMTc5MzY0","avatar_url":"https://avatars.githubusercontent.com/u/52179364?v=4","gravatar_id":"","url":"https://api.github.com/users/jessecai","html_url":"https://github.com/jessecai","followers_url":"https://api.github.com/users/jessecai/followers","following_url":"https://api.github.com/users/jessecai/following{/other_user}","gists_url":"https://api.github.com/users/jessecai/gists{/gist_id}","starred_url":"https://api.github.com/users/jessecai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessecai/subscriptions","organizations_url":"https://api.github.com/users/jessecai/orgs","repos_url":"https://api.github.com/users/jessecai/repos","events_url":"https://api.github.com/users/jessecai/events{/privacy}","received_events_url":"https://api.github.com/users/jessecai/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":196469959,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY0Njk5NTk=","name":"spark","full_name":"jessecai/spark","private":false,"owner":{"login":"jessecai","id":52179364,"node_id":"MDQ6VXNlcjUyMTc5MzY0","avatar_url":"https://avatars.githubusercontent.com/u/52179364?v=4","gravatar_id":"","url":"https://api.github.com/users/jessecai","html_url":"https://github.com/jessecai","followers_url":"https://api.github.com/users/jessecai/followers","following_url":"https://api.github.com/users/jessecai/following{/other_user}","gists_url":"https://api.github.com/users/jessecai/gists{/gist_id}","starred_url":"https://api.github.com/users/jessecai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessecai/subscriptions","organizations_url":"https://api.github.com/users/jessecai/orgs","repos_url":"https://api.github.com/users/jessecai/repos","events_url":"https://api.github.com/users/jessecai/events{/privacy}","received_events_url":"https://api.github.com/users/jessecai/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/jessecai/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/jessecai/spark","forks_url":"https://api.github.com/repos/jessecai/spark/forks","keys_url":"https://api.github.com/repos/jessecai/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/jessecai/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/jessecai/spark/teams","hooks_url":"https://api.github.com/repos/jessecai/spark/hooks","issue_events_url":"https://api.github.com/repos/jessecai/spark/issues/events{/number}","events_url":"https://api.github.com/repos/jessecai/spark/events","assignees_url":"https://api.github.com/repos/jessecai/spark/assignees{/user}","branches_url":"https://api.github.com/repos/jessecai/spark/branches{/branch}","tags_url":"https://api.github.com/repos/jessecai/spark/tags","blobs_url":"https://api.github.com/repos/jessecai/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/jessecai/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/jessecai/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/jessecai/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/jessecai/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/jessecai/spark/languages","stargazers_url":"https://api.github.com/repos/jessecai/spark/stargazers","contributors_url":"https://api.github.com/repos/jessecai/spark/contributors","subscribers_url":"https://api.github.com/repos/jessecai/spark/subscribers","subscription_url":"https://api.github.com/repos/jessecai/spark/subscription","commits_url":"https://api.github.com/repos/jessecai/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/jessecai/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/jessecai/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/jessecai/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/jessecai/spark/contents/{+path}","compare_url":"https://api.github.com/repos/jessecai/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/jessecai/spark/merges","archive_url":"https://api.github.com/repos/jessecai/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/jessecai/spark/downloads","issues_url":"https://api.github.com/repos/jessecai/spark/issues{/number}","pulls_url":"https://api.github.com/repos/jessecai/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/jessecai/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/jessecai/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/jessecai/spark/labels{/name}","releases_url":"https://api.github.com/repos/jessecai/spark/releases{/id}","deployments_url":"https://api.github.com/repos/jessecai/spark/deployments","created_at":"2019-07-11T21:57:16Z","updated_at":"2019-07-11T21:57:46Z","pushed_at":"2019-07-12T23:16:46Z","git_url":"git://github.com/jessecai/spark.git","ssh_url":"git@github.com:jessecai/spark.git","clone_url":"https://github.com/jessecai/spark.git","svn_url":"https://github.com/jessecai/spark","homepage":"","size":300404,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"9eca58ed3e8ba5ba4e21637f88069f69c2337304","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25123"},"html":{"href":"https://github.com/apache/spark/pull/25123"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25123"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25123/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25123/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25123/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1ec3a4a338a6f5c5ba9056946ab9747fe7dc0a3d"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25122","id":296852217,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2ODUyMjE3","html_url":"https://github.com/apache/spark/pull/25122","diff_url":"https://github.com/apache/spark/pull/25122.diff","patch_url":"https://github.com/apache/spark/pull/25122.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25122","number":25122,"state":"closed","locked":false,"title":"[SPARK-28286][SQL][PYTHON][TESTS] Convert and port 'pivot.sql' into UDF test base","user":{"login":"chitralverma","id":11135032,"node_id":"MDQ6VXNlcjExMTM1MDMy","avatar_url":"https://avatars.githubusercontent.com/u/11135032?v=4","gravatar_id":"","url":"https://api.github.com/users/chitralverma","html_url":"https://github.com/chitralverma","followers_url":"https://api.github.com/users/chitralverma/followers","following_url":"https://api.github.com/users/chitralverma/following{/other_user}","gists_url":"https://api.github.com/users/chitralverma/gists{/gist_id}","starred_url":"https://api.github.com/users/chitralverma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chitralverma/subscriptions","organizations_url":"https://api.github.com/users/chitralverma/orgs","repos_url":"https://api.github.com/users/chitralverma/repos","events_url":"https://api.github.com/users/chitralverma/events{/privacy}","received_events_url":"https://api.github.com/users/chitralverma/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from pivot.sql to test UDFs following the combination guide in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n\r\n<details><summary>Diff comparing to 'pivot.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/pivot.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-pivot.sql.out\r\nindex 9a8f783da4..cb9e4d736c 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/pivot.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-pivot.sql.out\r\n@@ -1,5 +1,5 @@\r\n -- Automatically generated by SQLQueryTestSuite\r\n--- Number of queries: 32\r\n+-- Number of queries: 30\r\n \r\n \r\n -- !query 0\r\n@@ -40,14 +40,14 @@ struct<>\r\n \r\n -- !query 3\r\n SELECT * FROM (\r\n-  SELECT year, course, earnings FROM courseSales\r\n+  SELECT udf(year), course, earnings FROM courseSales\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR course IN ('dotNET', 'Java')\r\n )\r\n -- !query 3 schema\r\n-struct<year:int,dotNET:bigint,Java:bigint>\r\n+struct<CAST(udf(cast(year as string)) AS INT):int,dotNET:bigint,Java:bigint>\r\n -- !query 3 output\r\n 2012   15000   20000\r\n 2013   48000   30000\r\n@@ -56,7 +56,7 @@ struct<year:int,dotNET:bigint,Java:bigint>\r\n -- !query 4\r\n SELECT * FROM courseSales\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR year IN (2012, 2013)\r\n )\r\n -- !query 4 schema\r\n@@ -71,11 +71,11 @@ SELECT * FROM (\r\n   SELECT year, course, earnings FROM courseSales\r\n )\r\n PIVOT (\r\n-  sum(earnings), avg(earnings)\r\n+  udf(sum(earnings)), udf(avg(earnings))\r\n   FOR course IN ('dotNET', 'Java')\r\n )\r\n -- !query 5 schema\r\n-struct<year:int,dotNET_sum(CAST(earnings AS BIGINT)):bigint,dotNET_avg(CAST(earnings AS BIGINT)):double,Java_sum(CAST(earnings AS BIGINT)):bigint,Java_avg(CAST(earnings AS BIGINT)):double>\r\n+struct<year:int,dotNET_CAST(udf(cast(sum(cast(earnings as bigint)) as string)) AS BIGINT):bigint,dotNET_CAST(udf(cast(avg(cast(earnings as bigint)) as string)) AS DOUBLE):double,Java_CAST(udf(cast(sum(cast(earnings as bigint)) as string)) AS BIGINT):bigint,Java_CAST(udf(cast(avg(cast(earnings as bigint)) as string)) AS DOUBLE):double>\r\n -- !query 5 output\r\n 2012   15000   7500.0  20000   20000.0\r\n 2013   48000   48000.0 30000   30000.0\r\n@@ -83,10 +83,10 @@ struct<year:int,dotNET_sum(CAST(earnings AS BIGINT)):bigint,dotNET_avg(CAST(earn\r\n \r\n -- !query 6\r\n SELECT * FROM (\r\n-  SELECT course, earnings FROM courseSales\r\n+  SELECT udf(course) as course, earnings FROM courseSales\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR course IN ('dotNET', 'Java')\r\n )\r\n -- !query 6 schema\r\n@@ -100,23 +100,23 @@ SELECT * FROM (\r\n   SELECT year, course, earnings FROM courseSales\r\n )\r\n PIVOT (\r\n-  sum(earnings), min(year)\r\n+  udf(sum(udf(earnings))), udf(min(year))\r\n   FOR course IN ('dotNET', 'Java')\r\n )\r\n -- !query 7 schema\r\n-struct<dotNET_sum(CAST(earnings AS BIGINT)):bigint,dotNET_min(year):int,Java_sum(CAST(earnings AS BIGINT)):bigint,Java_min(year):int>\r\n+struct<dotNET_CAST(udf(cast(sum(cast(cast(udf(cast(earnings as string)) as int) as bigint)) as string)) AS BIGINT):bigint,dotNET_CAST(udf(cast(min(year) as string)) AS INT):int,Java_CAST(udf(cast(sum(cast(cast(udf(cast(earnings as string)) as int) as bigint)) as string)) AS BIGINT):bigint,Java_CAST(udf(cast(min(year) as string)) AS INT):int>\r\n -- !query 7 output\r\n 63000  2012    50000   2012\r\n \r\n \r\n -- !query 8\r\n SELECT * FROM (\r\n-  SELECT course, year, earnings, s\r\n+  SELECT course, year, earnings, udf(s) as s\r\n   FROM courseSales\r\n   JOIN years ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR s IN (1, 2)\r\n )\r\n -- !query 8 schema\r\n@@ -135,11 +135,11 @@ SELECT * FROM (\r\n   JOIN years ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings), min(s)\r\n+  udf(sum(earnings)), udf(min(s))\r\n   FOR course IN ('dotNET', 'Java')\r\n )\r\n -- !query 9 schema\r\n-struct<year:int,dotNET_sum(CAST(earnings AS BIGINT)):bigint,dotNET_min(s):int,Java_sum(CAST(earnings AS BIGINT)):bigint,Java_min(s):int>\r\n+struct<year:int,dotNET_CAST(udf(cast(sum(cast(earnings as bigint)) as string)) AS BIGINT):bigint,dotNET_CAST(udf(cast(min(s) as string)) AS INT):int,Java_CAST(udf(cast(sum(cast(earnings as bigint)) as string)) AS BIGINT):bigint,Java_CAST(udf(cast(min(s) as string)) AS INT):int>\r\n -- !query 9 output\r\n 2012   15000   1       20000   1\r\n 2013   48000   2       30000   2\r\n@@ -152,7 +152,7 @@ SELECT * FROM (\r\n   JOIN years ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings * s)\r\n+  udf(sum(earnings * s))\r\n   FOR course IN ('dotNET', 'Java')\r\n )\r\n -- !query 10 schema\r\n@@ -167,7 +167,7 @@ SELECT 2012_s, 2013_s, 2012_a, 2013_a, c FROM (\r\n   SELECT year y, course c, earnings e FROM courseSales\r\n )\r\n PIVOT (\r\n-  sum(e) s, avg(e) a\r\n+  udf(sum(e)) s, udf(avg(e)) a\r\n   FOR y IN (2012, 2013)\r\n )\r\n -- !query 11 schema\r\n@@ -182,7 +182,7 @@ SELECT firstYear_s, secondYear_s, firstYear_a, secondYear_a, c FROM (\r\n   SELECT year y, course c, earnings e FROM courseSales\r\n )\r\n PIVOT (\r\n-  sum(e) s, avg(e) a\r\n+  udf(sum(e)) s, udf(avg(e)) a\r\n   FOR y IN (2012 as firstYear, 2013 secondYear)\r\n )\r\n -- !query 12 schema\r\n@@ -195,7 +195,7 @@ struct<firstYear_s:bigint,secondYear_s:bigint,firstYear_a:double,secondYear_a:do\r\n -- !query 13\r\n SELECT * FROM courseSales\r\n PIVOT (\r\n-  abs(earnings)\r\n+  udf(abs(earnings))\r\n   FOR year IN (2012, 2013)\r\n )\r\n -- !query 13 schema\r\n@@ -210,7 +210,7 @@ SELECT * FROM (\r\n   SELECT year, course, earnings FROM courseSales\r\n )\r\n PIVOT (\r\n-  sum(earnings), year\r\n+  udf(sum(earnings)), year\r\n   FOR course IN ('dotNET', 'Java')\r\n )\r\n -- !query 14 schema\r\n@@ -225,7 +225,7 @@ SELECT * FROM (\r\n   SELECT course, earnings FROM courseSales\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR year IN (2012, 2013)\r\n )\r\n -- !query 15 schema\r\n@@ -240,11 +240,11 @@ SELECT * FROM (\r\n   SELECT year, course, earnings FROM courseSales\r\n )\r\n PIVOT (\r\n-  ceil(sum(earnings)), avg(earnings) + 1 as a1\r\n+  udf(ceil(udf(sum(earnings)))), avg(earnings) + 1 as a1\r\n   FOR course IN ('dotNET', 'Java')\r\n )\r\n -- !query 16 schema\r\n-struct<year:int,dotNET_CEIL(sum(CAST(earnings AS BIGINT))):bigint,dotNET_a1:double,Java_CEIL(sum(CAST(earnings AS BIGINT))):bigint,Java_a1:double>\r\n+struct<year:int,dotNET_CAST(udf(cast(CEIL(cast(udf(cast(sum(cast(earnings as bigint)) as string)) as bigint)) as string)) AS BIGINT):bigint,dotNET_a1:double,Java_CAST(udf(cast(CEIL(cast(udf(cast(sum(cast(earnings as bigint)) as string)) as bigint)) as string)) AS BIGINT):bigint,Java_a1:double>\r\n -- !query 16 output\r\n 2012   15000   7501.0  20000   20001.0\r\n 2013   48000   48001.0 30000   30001.0\r\n@@ -255,7 +255,7 @@ SELECT * FROM (\r\n   SELECT year, course, earnings FROM courseSales\r\n )\r\n PIVOT (\r\n-  sum(avg(earnings))\r\n+  sum(udf(avg(earnings)))\r\n   FOR course IN ('dotNET', 'Java')\r\n )\r\n -- !query 17 schema\r\n@@ -272,7 +272,7 @@ SELECT * FROM (\r\n   JOIN years ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR (course, year) IN (('dotNET', 2012), ('Java', 2013))\r\n )\r\n -- !query 18 schema\r\n@@ -289,7 +289,7 @@ SELECT * FROM (\r\n   JOIN years ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR (course, s) IN (('dotNET', 2) as c1, ('Java', 1) as c2)\r\n )\r\n -- !query 19 schema\r\n@@ -306,7 +306,7 @@ SELECT * FROM (\r\n   JOIN years ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR (course, year) IN ('dotNET', 'Java')\r\n )\r\n -- !query 20 schema\r\n@@ -319,7 +319,7 @@ Invalid pivot value 'dotNET': value data type string does not match pivot column\r\n -- !query 21\r\n SELECT * FROM courseSales\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR year IN (s, 2013)\r\n )\r\n -- !query 21 schema\r\n@@ -332,7 +332,7 @@ cannot resolve '`s`' given input columns: [coursesales.course, coursesales.earni\r\n -- !query 22\r\n SELECT * FROM courseSales\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR year IN (course, 2013)\r\n )\r\n -- !query 22 schema\r\n@@ -343,151 +343,118 @@ Literal expressions required for pivot values, found 'course#x';\r\n \r\n \r\n -- !query 23\r\n-SELECT * FROM (\r\n-  SELECT course, year, a\r\n-  FROM courseSales\r\n-  JOIN yearsWithComplexTypes ON year = y\r\n-)\r\n-PIVOT (\r\n-  min(a)\r\n-  FOR course IN ('dotNET', 'Java')\r\n-)\r\n--- !query 23 schema\r\n-struct<year:int,dotNET:array<int>,Java:array<int>>\r\n--- !query 23 output\r\n-2012   [1,1]   [1,1]\r\n-2013   [2,2]   [2,2]\r\n-\r\n-\r\n--- !query 24\r\n-SELECT * FROM (\r\n-  SELECT course, year, y, a\r\n-  FROM courseSales\r\n-  JOIN yearsWithComplexTypes ON year = y\r\n-)\r\n-PIVOT (\r\n-  max(a)\r\n-  FOR (y, course) IN ((2012, 'dotNET'), (2013, 'Java'))\r\n-)\r\n--- !query 24 schema\r\n-struct<year:int,[2012, dotNET]:array<int>,[2013, Java]:array<int>>\r\n--- !query 24 output\r\n-2012   [1,1]   NULL\r\n-2013   NULL    [2,2]\r\n-\r\n-\r\n--- !query 25\r\n SELECT * FROM (\r\n   SELECT earnings, year, a\r\n   FROM courseSales\r\n   JOIN yearsWithComplexTypes ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR a IN (array(1, 1), array(2, 2))\r\n )\r\n--- !query 25 schema\r\n+-- !query 23 schema\r\n struct<year:int,[1, 1]:bigint,[2, 2]:bigint>\r\n--- !query 25 output\r\n+-- !query 23 output\r\n 2012   35000   NULL\r\n 2013   NULL    78000\r\n \r\n \r\n--- !query 26\r\n+-- !query 24\r\n SELECT * FROM (\r\n-  SELECT course, earnings, year, a\r\n+  SELECT course, earnings, udf(year) as year, a\r\n   FROM courseSales\r\n   JOIN yearsWithComplexTypes ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR (course, a) IN (('dotNET', array(1, 1)), ('Java', array(2, 2)))\r\n )\r\n--- !query 26 schema\r\n+-- !query 24 schema\r\n struct<year:int,[dotNET, [1, 1]]:bigint,[Java, [2, 2]]:bigint>\r\n--- !query 26 output\r\n+-- !query 24 output\r\n 2012   15000   NULL\r\n 2013   NULL    30000\r\n \r\n \r\n--- !query 27\r\n+-- !query 25\r\n SELECT * FROM (\r\n   SELECT earnings, year, s\r\n   FROM courseSales\r\n   JOIN yearsWithComplexTypes ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR s IN ((1, 'a'), (2, 'b'))\r\n )\r\n--- !query 27 schema\r\n+-- !query 25 schema\r\n struct<year:int,[1, a]:bigint,[2, b]:bigint>\r\n--- !query 27 output\r\n+-- !query 25 output\r\n 2012   35000   NULL\r\n 2013   NULL    78000\r\n \r\n \r\n--- !query 28\r\n+-- !query 26\r\n SELECT * FROM (\r\n   SELECT course, earnings, year, s\r\n   FROM courseSales\r\n   JOIN yearsWithComplexTypes ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR (course, s) IN (('dotNET', (1, 'a')), ('Java', (2, 'b')))\r\n )\r\n--- !query 28 schema\r\n+-- !query 26 schema\r\n struct<year:int,[dotNET, [1, a]]:bigint,[Java, [2, b]]:bigint>\r\n--- !query 28 output\r\n+-- !query 26 output\r\n 2012   15000   NULL\r\n 2013   NULL    30000\r\n \r\n \r\n--- !query 29\r\n+-- !query 27\r\n SELECT * FROM (\r\n   SELECT earnings, year, m\r\n   FROM courseSales\r\n   JOIN yearsWithComplexTypes ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR m IN (map('1', 1), map('2', 2))\r\n )\r\n--- !query 29 schema\r\n+-- !query 27 schema\r\n struct<>\r\n--- !query 29 output\r\n+-- !query 27 output\r\n org.apache.spark.sql.AnalysisException\r\n Invalid pivot column 'm#x'. Pivot columns must be comparable.;\r\n \r\n \r\n--- !query 30\r\n+-- !query 28\r\n SELECT * FROM (\r\n   SELECT course, earnings, year, m\r\n   FROM courseSales\r\n   JOIN yearsWithComplexTypes ON year = y\r\n )\r\n PIVOT (\r\n-  sum(earnings)\r\n+  udf(sum(earnings))\r\n   FOR (course, m) IN (('dotNET', map('1', 1)), ('Java', map('2', 2)))\r\n )\r\n--- !query 30 schema\r\n+-- !query 28 schema\r\n struct<>\r\n--- !query 30 output\r\n+-- !query 28 output\r\n org.apache.spark.sql.AnalysisException\r\n Invalid pivot column 'named_struct(course, course#x, m, m#x)'. Pivot columns must be comparable.;\r\n \r\n \r\n--- !query 31\r\n+-- !query 29\r\n SELECT * FROM (\r\n-  SELECT course, earnings, \"a\" as a, \"z\" as z, \"b\" as b, \"y\" as y, \"c\" as c, \"x\" as x, \"d\" as d, \"w\" as w\r\n+  SELECT course, earnings, udf(\"a\") as a, udf(\"z\") as z, udf(\"b\") as b, udf(\"y\") as y,\r\n+  udf(\"c\") as c, udf(\"x\") as x, udf(\"d\") as d, udf(\"w\") as w\r\n   FROM courseSales\r\n )\r\n PIVOT (\r\n-  sum(Earnings)\r\n+  udf(sum(Earnings))\r\n   FOR Course IN ('dotNET', 'Java')\r\n )\r\n--- !query 31 schema\r\n+-- !query 29 schema\r\n struct<a:string,z:string,b:string,y:string,c:string,x:string,d:string,w:string,dotNET:bigint,Java:bigint>\r\n--- !query 31 output\r\n+-- !query 29 output\r\n a      z       b       y       c       x       d       w       63000   50000\r\n\r\n\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).","created_at":"2019-07-11T22:38:56Z","updated_at":"2019-07-19T02:03:32Z","closed_at":"2019-07-18T13:23:58Z","merged_at":null,"merge_commit_sha":"38ab41b4ab5191ff74e1647d66c643c1391c4ea2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25122/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25122/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25122/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f979a47674c589b34fcf7e988311e89b1c67821c","head":{"label":"chitralverma:SPARK-28286","ref":"SPARK-28286","sha":"f979a47674c589b34fcf7e988311e89b1c67821c","user":{"login":"chitralverma","id":11135032,"node_id":"MDQ6VXNlcjExMTM1MDMy","avatar_url":"https://avatars.githubusercontent.com/u/11135032?v=4","gravatar_id":"","url":"https://api.github.com/users/chitralverma","html_url":"https://github.com/chitralverma","followers_url":"https://api.github.com/users/chitralverma/followers","following_url":"https://api.github.com/users/chitralverma/following{/other_user}","gists_url":"https://api.github.com/users/chitralverma/gists{/gist_id}","starred_url":"https://api.github.com/users/chitralverma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chitralverma/subscriptions","organizations_url":"https://api.github.com/users/chitralverma/orgs","repos_url":"https://api.github.com/users/chitralverma/repos","events_url":"https://api.github.com/users/chitralverma/events{/privacy}","received_events_url":"https://api.github.com/users/chitralverma/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":196439204,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY0MzkyMDQ=","name":"spark","full_name":"chitralverma/spark","private":false,"owner":{"login":"chitralverma","id":11135032,"node_id":"MDQ6VXNlcjExMTM1MDMy","avatar_url":"https://avatars.githubusercontent.com/u/11135032?v=4","gravatar_id":"","url":"https://api.github.com/users/chitralverma","html_url":"https://github.com/chitralverma","followers_url":"https://api.github.com/users/chitralverma/followers","following_url":"https://api.github.com/users/chitralverma/following{/other_user}","gists_url":"https://api.github.com/users/chitralverma/gists{/gist_id}","starred_url":"https://api.github.com/users/chitralverma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chitralverma/subscriptions","organizations_url":"https://api.github.com/users/chitralverma/orgs","repos_url":"https://api.github.com/users/chitralverma/repos","events_url":"https://api.github.com/users/chitralverma/events{/privacy}","received_events_url":"https://api.github.com/users/chitralverma/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/chitralverma/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/chitralverma/spark","forks_url":"https://api.github.com/repos/chitralverma/spark/forks","keys_url":"https://api.github.com/repos/chitralverma/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/chitralverma/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/chitralverma/spark/teams","hooks_url":"https://api.github.com/repos/chitralverma/spark/hooks","issue_events_url":"https://api.github.com/repos/chitralverma/spark/issues/events{/number}","events_url":"https://api.github.com/repos/chitralverma/spark/events","assignees_url":"https://api.github.com/repos/chitralverma/spark/assignees{/user}","branches_url":"https://api.github.com/repos/chitralverma/spark/branches{/branch}","tags_url":"https://api.github.com/repos/chitralverma/spark/tags","blobs_url":"https://api.github.com/repos/chitralverma/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/chitralverma/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/chitralverma/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/chitralverma/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/chitralverma/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/chitralverma/spark/languages","stargazers_url":"https://api.github.com/repos/chitralverma/spark/stargazers","contributors_url":"https://api.github.com/repos/chitralverma/spark/contributors","subscribers_url":"https://api.github.com/repos/chitralverma/spark/subscribers","subscription_url":"https://api.github.com/repos/chitralverma/spark/subscription","commits_url":"https://api.github.com/repos/chitralverma/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/chitralverma/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/chitralverma/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/chitralverma/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/chitralverma/spark/contents/{+path}","compare_url":"https://api.github.com/repos/chitralverma/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/chitralverma/spark/merges","archive_url":"https://api.github.com/repos/chitralverma/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/chitralverma/spark/downloads","issues_url":"https://api.github.com/repos/chitralverma/spark/issues{/number}","pulls_url":"https://api.github.com/repos/chitralverma/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/chitralverma/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/chitralverma/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/chitralverma/spark/labels{/name}","releases_url":"https://api.github.com/repos/chitralverma/spark/releases{/id}","deployments_url":"https://api.github.com/repos/chitralverma/spark/deployments","created_at":"2019-07-11T17:33:51Z","updated_at":"2019-07-11T17:34:22Z","pushed_at":"2019-07-18T14:57:32Z","git_url":"git://github.com/chitralverma/spark.git","ssh_url":"git@github.com:chitralverma/spark.git","clone_url":"https://github.com/chitralverma/spark.git","svn_url":"https://github.com/chitralverma/spark","homepage":"","size":300412,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"971e832e0eb720e346e9863ccfd41304d0f8f3dc","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25122"},"html":{"href":"https://github.com/apache/spark/pull/25122"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25122"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25122/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25122/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25122/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f979a47674c589b34fcf7e988311e89b1c67821c"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25121","id":296851124,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2ODUxMTI0","html_url":"https://github.com/apache/spark/pull/25121","diff_url":"https://github.com/apache/spark/pull/25121.diff","patch_url":"https://github.com/apache/spark/pull/25121.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25121","number":25121,"state":"closed","locked":false,"title":"[SPARK-28356][SQL] Do not reduce the number of partitions for repartition in adaptive execution","user":{"login":"carsonwang","id":9278199,"node_id":"MDQ6VXNlcjkyNzgxOTk=","avatar_url":"https://avatars.githubusercontent.com/u/9278199?v=4","gravatar_id":"","url":"https://api.github.com/users/carsonwang","html_url":"https://github.com/carsonwang","followers_url":"https://api.github.com/users/carsonwang/followers","following_url":"https://api.github.com/users/carsonwang/following{/other_user}","gists_url":"https://api.github.com/users/carsonwang/gists{/gist_id}","starred_url":"https://api.github.com/users/carsonwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carsonwang/subscriptions","organizations_url":"https://api.github.com/users/carsonwang/orgs","repos_url":"https://api.github.com/users/carsonwang/repos","events_url":"https://api.github.com/users/carsonwang/events{/privacy}","received_events_url":"https://api.github.com/users/carsonwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nAdaptive execution reduces the number of post-shuffle partitions at runtime, even for shuffles caused by repartition. However, the user likely wants to get the desired number of partition when he calls repartition even in adaptive execution. This PR adds an internal config to control this and by default adaptive execution will not change the number of post-shuffle partition for repartition.\r\n\r\n## How was this patch tested?\r\nNew tests added.\r\n","created_at":"2019-07-11T22:34:01Z","updated_at":"2019-08-16T14:57:35Z","closed_at":"2019-07-16T09:40:22Z","merged_at":null,"merge_commit_sha":"53c418f6b1fde33f2ade0639b2f85ab7a0c48546","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25121/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25121/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25121/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ba1bda815fe4219961222ed9c872f2810cfab1d5","head":{"label":"carsonwang:AE_repartition","ref":"AE_repartition","sha":"ba1bda815fe4219961222ed9c872f2810cfab1d5","user":{"login":"carsonwang","id":9278199,"node_id":"MDQ6VXNlcjkyNzgxOTk=","avatar_url":"https://avatars.githubusercontent.com/u/9278199?v=4","gravatar_id":"","url":"https://api.github.com/users/carsonwang","html_url":"https://github.com/carsonwang","followers_url":"https://api.github.com/users/carsonwang/followers","following_url":"https://api.github.com/users/carsonwang/following{/other_user}","gists_url":"https://api.github.com/users/carsonwang/gists{/gist_id}","starred_url":"https://api.github.com/users/carsonwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carsonwang/subscriptions","organizations_url":"https://api.github.com/users/carsonwang/orgs","repos_url":"https://api.github.com/users/carsonwang/repos","events_url":"https://api.github.com/users/carsonwang/events{/privacy}","received_events_url":"https://api.github.com/users/carsonwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":36279354,"node_id":"MDEwOlJlcG9zaXRvcnkzNjI3OTM1NA==","name":"spark","full_name":"carsonwang/spark","private":false,"owner":{"login":"carsonwang","id":9278199,"node_id":"MDQ6VXNlcjkyNzgxOTk=","avatar_url":"https://avatars.githubusercontent.com/u/9278199?v=4","gravatar_id":"","url":"https://api.github.com/users/carsonwang","html_url":"https://github.com/carsonwang","followers_url":"https://api.github.com/users/carsonwang/followers","following_url":"https://api.github.com/users/carsonwang/following{/other_user}","gists_url":"https://api.github.com/users/carsonwang/gists{/gist_id}","starred_url":"https://api.github.com/users/carsonwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carsonwang/subscriptions","organizations_url":"https://api.github.com/users/carsonwang/orgs","repos_url":"https://api.github.com/users/carsonwang/repos","events_url":"https://api.github.com/users/carsonwang/events{/privacy}","received_events_url":"https://api.github.com/users/carsonwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/carsonwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/carsonwang/spark","forks_url":"https://api.github.com/repos/carsonwang/spark/forks","keys_url":"https://api.github.com/repos/carsonwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/carsonwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/carsonwang/spark/teams","hooks_url":"https://api.github.com/repos/carsonwang/spark/hooks","issue_events_url":"https://api.github.com/repos/carsonwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/carsonwang/spark/events","assignees_url":"https://api.github.com/repos/carsonwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/carsonwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/carsonwang/spark/tags","blobs_url":"https://api.github.com/repos/carsonwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/carsonwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/carsonwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/carsonwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/carsonwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/carsonwang/spark/languages","stargazers_url":"https://api.github.com/repos/carsonwang/spark/stargazers","contributors_url":"https://api.github.com/repos/carsonwang/spark/contributors","subscribers_url":"https://api.github.com/repos/carsonwang/spark/subscribers","subscription_url":"https://api.github.com/repos/carsonwang/spark/subscription","commits_url":"https://api.github.com/repos/carsonwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/carsonwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/carsonwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/carsonwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/carsonwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/carsonwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/carsonwang/spark/merges","archive_url":"https://api.github.com/repos/carsonwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/carsonwang/spark/downloads","issues_url":"https://api.github.com/repos/carsonwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/carsonwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/carsonwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/carsonwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/carsonwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/carsonwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/carsonwang/spark/deployments","created_at":"2015-05-26T07:28:13Z","updated_at":"2020-06-18T09:21:35Z","pushed_at":"2019-07-15T18:11:12Z","git_url":"git://github.com/carsonwang/spark.git","ssh_url":"git@github.com:carsonwang/spark.git","clone_url":"https://github.com/carsonwang/spark.git","svn_url":"https://github.com/carsonwang/spark","homepage":null,"size":279750,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"9eca58ed3e8ba5ba4e21637f88069f69c2337304","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25121"},"html":{"href":"https://github.com/apache/spark/pull/25121"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25121"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25121/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25121/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25121/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ba1bda815fe4219961222ed9c872f2810cfab1d5"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25120","id":296829858,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2ODI5ODU4","html_url":"https://github.com/apache/spark/pull/25120","diff_url":"https://github.com/apache/spark/pull/25120.diff","patch_url":"https://github.com/apache/spark/pull/25120.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25120","number":25120,"state":"closed","locked":false,"title":"[SPARK-28354][INFRA] Use JIRA user name instead of JIRA user key","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n`dev/merge_spark_pr.py` script always fail for some users because they have different `name` and `key`.\r\n\r\n- https://issues.apache.org/jira/rest/api/2/user?username=yumwang\r\n\r\nJIRA Client expects `name`, but we are using `key`. This PR fixes it.\r\n```python\r\n# This is JIRA client code `/usr/local/lib/python2.7/site-packages/jira/client.py`\r\ndef assign_issue(self, issue, assignee):\r\n    \"\"\"Assign an issue to a user. None will set it to unassigned. -1 will set it to Automatic.\r\n\r\n    :param issue: the issue ID or key to assign\r\n    :param assignee: the user to assign the issue to\r\n\r\n    :type issue: int or str\r\n    :type assignee: str\r\n\r\n    :rtype: bool\r\n    \"\"\"\r\n    url = self._options['server'] + \\\r\n        '/rest/api/latest/issue/' + str(issue) + '/assignee'\r\n    payload = {'name': assignee}\r\n    r = self._session.put(\r\n        url, data=json.dumps(payload))\r\n    raise_on_error(r)\r\n    return True\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nManual with the committer ID/password.\r\n\r\n```python\r\nimport jira.client\r\nasf_jira = jira.client.JIRA({'server': 'https://issues.apache.org/jira'}, basic_auth=('yourid', 'passwd'))\r\nasf_jira.assign_issue(\"SPARK-28354\", \"q79969786\")   # This will raise exception.\r\nasf_jira.assign_issue(\"SPARK-28354\", \"yumwang\")     # This works.\r\n```","created_at":"2019-07-11T21:18:52Z","updated_at":"2019-07-12T13:57:10Z","closed_at":"2019-07-12T09:49:07Z","merged_at":null,"merge_commit_sha":"0a8c522ea586a7fb64bfb32d815d2a145dd607d3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587336,"node_id":"MDU6TGFiZWwxNDA2NTg3MzM2","url":"https://api.github.com/repos/apache/spark/labels/PROJECT%20INFRA","name":"PROJECT INFRA","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25120/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25120/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25120/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f6c01377be59f76b61e92ab6e8f3e4229b312883","head":{"label":"dongjoon-hyun:SPARK-28354","ref":"SPARK-28354","sha":"f6c01377be59f76b61e92ab6e8f3e4229b312883","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"9eca58ed3e8ba5ba4e21637f88069f69c2337304","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25120"},"html":{"href":"https://github.com/apache/spark/pull/25120"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25120"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25120/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25120/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25120/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f6c01377be59f76b61e92ab6e8f3e4229b312883"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25119","id":296739328,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NzM5MzI4","html_url":"https://github.com/apache/spark/pull/25119","diff_url":"https://github.com/apache/spark/pull/25119.diff","patch_url":"https://github.com/apache/spark/pull/25119.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25119","number":25119,"state":"closed","locked":false,"title":"[SPARK-28283][SQL][PYTHON][TESTS] Convert and port 'intersect-all.sql' into UDF test base","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from `intersect-all.sql` to test UDFs. Please see contribution guide of this umbrella ticket - [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n\r\n<details><summary>Diff comparing to 'intersect-all.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/intersect-all.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-intersect-all.sql.out\r\nindex 63dd56ce46..0cb82be2da 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/intersect-all.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-intersect-all.sql.out\r\n@@ -34,11 +34,11 @@ struct<>\r\n \r\n \r\n -- !query 2\r\n-SELECT * FROM tab1\r\n+SELECT udf(k), v FROM tab1\r\n INTERSECT ALL\r\n-SELECT * FROM tab2\r\n+SELECT k, udf(v) FROM tab2\r\n -- !query 2 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,v:int>\r\n -- !query 2 output\r\n 1\t2\r\n 1\t2\r\n@@ -48,11 +48,11 @@ NULL\tNULL\r\n \r\n \r\n -- !query 3\r\n-SELECT * FROM tab1\r\n+SELECT k, udf(v) FROM tab1\r\n INTERSECT ALL\r\n-SELECT * FROM tab1 WHERE k = 1\r\n+SELECT udf(k), v FROM tab1 WHERE udf(k) = 1\r\n -- !query 3 schema\r\n-struct<k:int,v:int>\r\n+struct<k:int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 3 output\r\n 1\t2\r\n 1\t2\r\n@@ -61,39 +61,39 @@ struct<k:int,v:int>\r\n \r\n \r\n -- !query 4\r\n-SELECT * FROM tab1 WHERE k > 2\r\n+SELECT udf(k), udf(v) FROM tab1 WHERE k > udf(2)\r\n INTERSECT ALL\r\n-SELECT * FROM tab2\r\n+SELECT udf(k), udf(v) FROM tab2\r\n -- !query 4 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 4 output\r\n \r\n \r\n \r\n -- !query 5\r\n-SELECT * FROM tab1\r\n+SELECT udf(k), v FROM tab1\r\n INTERSECT ALL\r\n-SELECT * FROM tab2 WHERE k > 3\r\n+SELECT udf(k), v FROM tab2 WHERE udf(udf(k)) > 3\r\n -- !query 5 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,v:int>\r\n -- !query 5 output\r\n \r\n \r\n \r\n -- !query 6\r\n-SELECT * FROM tab1\r\n+SELECT udf(k), v FROM tab1\r\n INTERSECT ALL\r\n-SELECT CAST(1 AS BIGINT), CAST(2 AS BIGINT)\r\n+SELECT CAST(udf(1) AS BIGINT), CAST(udf(2) AS BIGINT)\r\n -- !query 6 schema\r\n-struct<k:bigint,v:bigint>\r\n+struct<CAST(udf(cast(k as string)) AS INT):bigint,v:bigint>\r\n -- !query 6 output\r\n 1\t2\r\n \r\n \r\n -- !query 7\r\n-SELECT * FROM tab1\r\n+SELECT k, udf(v) FROM tab1\r\n INTERSECT ALL\r\n-SELECT array(1), 2\r\n+SELECT array(1), udf(2)\r\n -- !query 7 schema\r\n struct<>\r\n -- !query 7 output\r\n@@ -102,9 +102,9 @@ IntersectAll can only be performed on tables with the compatible column types. a\r\n \r\n \r\n -- !query 8\r\n-SELECT k FROM tab1\r\n+SELECT udf(k) FROM tab1\r\n INTERSECT ALL\r\n-SELECT k, v FROM tab2\r\n+SELECT udf(k), udf(v) FROM tab2\r\n -- !query 8 schema\r\n struct<>\r\n -- !query 8 output\r\n@@ -113,13 +113,13 @@ IntersectAll can only be performed on tables with the same number of columns, bu\r\n \r\n \r\n -- !query 9\r\n-SELECT * FROM tab2\r\n+SELECT udf(k), v FROM tab2\r\n INTERSECT ALL\r\n-SELECT * FROM tab1\r\n+SELECT k, udf(v) FROM tab1\r\n INTERSECT ALL\r\n-SELECT * FROM tab2\r\n+SELECT udf(k), udf(v) FROM tab2\r\n -- !query 9 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,v:int>\r\n -- !query 9 output\r\n 1\t2\r\n 1\t2\r\n@@ -129,15 +129,15 @@ NULL\tNULL\r\n \r\n \r\n -- !query 10\r\n-SELECT * FROM tab1\r\n+SELECT udf(k), v FROM tab1\r\n EXCEPT\r\n-SELECT * FROM tab2\r\n+SELECT k, udf(v) FROM tab2\r\n UNION ALL\r\n-SELECT * FROM tab1\r\n+SELECT k, udf(udf(v)) FROM tab1\r\n INTERSECT ALL\r\n-SELECT * FROM tab2\r\n+SELECT udf(k), v FROM tab2\r\n -- !query 10 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,v:int>\r\n -- !query 10 output\r\n 1\t2\r\n 1\t2\r\n@@ -148,15 +148,15 @@ NULL\tNULL\r\n \r\n \r\n -- !query 11\r\n-SELECT * FROM tab1\r\n+SELECT udf(k), udf(v) FROM tab1\r\n EXCEPT\r\n-SELECT * FROM tab2\r\n+SELECT udf(k), v FROM tab2\r\n EXCEPT\r\n-SELECT * FROM tab1\r\n+SELECT k, udf(v) FROM tab1\r\n INTERSECT ALL\r\n-SELECT * FROM tab2\r\n+SELECT udf(k), udf(udf(v)) FROM tab2\r\n -- !query 11 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 11 output\r\n 1\t3\r\n \r\n@@ -165,38 +165,38 @@ struct<k:int,v:int>\r\n (\r\n   (\r\n     (\r\n-      SELECT * FROM tab1\r\n+      SELECT udf(k), v FROM tab1\r\n       EXCEPT\r\n-      SELECT * FROM tab2\r\n+      SELECT k, udf(v) FROM tab2\r\n     )\r\n     EXCEPT\r\n-    SELECT * FROM tab1\r\n+    SELECT udf(k), udf(v) FROM tab1\r\n   )\r\n   INTERSECT ALL\r\n-  SELECT * FROM tab2\r\n+  SELECT udf(k), udf(v) FROM tab2\r\n )\r\n -- !query 12 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,v:int>\r\n -- !query 12 output\r\n \r\n \r\n \r\n -- !query 13\r\n SELECT * \r\n-FROM   (SELECT tab1.k, \r\n-               tab2.v \r\n+FROM   (SELECT udf(tab1.k),\r\n+               udf(tab2.v)\r\n         FROM   tab1 \r\n                JOIN tab2 \r\n-                 ON tab1.k = tab2.k)\r\n+                 ON udf(udf(tab1.k)) = tab2.k)\r\n INTERSECT ALL \r\n SELECT * \r\n-FROM   (SELECT tab1.k, \r\n-               tab2.v \r\n+FROM   (SELECT udf(tab1.k),\r\n+               udf(tab2.v)\r\n         FROM   tab1 \r\n                JOIN tab2 \r\n-                 ON tab1.k = tab2.k)\r\n+                 ON udf(tab1.k) = udf(udf(tab2.k)))\r\n -- !query 13 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 13 output\r\n 1\t2\r\n 1\t2\r\n@@ -211,30 +211,30 @@ struct<k:int,v:int>\r\n \r\n -- !query 14\r\n SELECT * \r\n-FROM   (SELECT tab1.k, \r\n-               tab2.v \r\n+FROM   (SELECT udf(tab1.k),\r\n+               udf(tab2.v)\r\n         FROM   tab1 \r\n                JOIN tab2 \r\n-                 ON tab1.k = tab2.k) \r\n+                 ON udf(tab1.k) = udf(tab2.k))\r\n INTERSECT ALL \r\n SELECT * \r\n-FROM   (SELECT tab2.v AS k, \r\n-               tab1.k AS v \r\n+FROM   (SELECT udf(tab2.v) AS k,\r\n+               udf(tab1.k) AS v\r\n         FROM   tab1 \r\n                JOIN tab2 \r\n-                 ON tab1.k = tab2.k)\r\n+                 ON tab1.k = udf(tab2.k))\r\n -- !query 14 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 14 output\r\n \r\n \r\n \r\n -- !query 15\r\n-SELECT v FROM tab1 GROUP BY v\r\n+SELECT udf(v) FROM tab1 GROUP BY v\r\n INTERSECT ALL\r\n-SELECT k FROM tab2 GROUP BY k\r\n+SELECT udf(udf(k)) FROM tab2 GROUP BY k\r\n -- !query 15 schema\r\n-struct<v:int>\r\n+struct<CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 15 output\r\n 2\r\n 3\r\n@@ -250,15 +250,15 @@ spark.sql.legacy.setopsPrecedence.enabled\ttrue\r\n \r\n \r\n -- !query 17\r\n-SELECT * FROM tab1\r\n+SELECT udf(k), v FROM tab1\r\n EXCEPT\r\n-SELECT * FROM tab2\r\n+SELECT k, udf(v) FROM tab2\r\n UNION ALL\r\n-SELECT * FROM tab1\r\n+SELECT udf(k), udf(v) FROM tab1\r\n INTERSECT ALL\r\n-SELECT * FROM tab2\r\n+SELECT udf(udf(k)), udf(v) FROM tab2\r\n -- !query 17 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,v:int>\r\n -- !query 17 output\r\n 1\t2\r\n 1\t2\r\n@@ -268,15 +268,15 @@ NULL\tNULL\r\n \r\n \r\n -- !query 18\r\n-SELECT * FROM tab1\r\n+SELECT k, udf(v) FROM tab1\r\n EXCEPT\r\n-SELECT * FROM tab2\r\n+SELECT udf(k), v FROM tab2\r\n UNION ALL\r\n-SELECT * FROM tab1\r\n+SELECT udf(k), udf(v) FROM tab1\r\n INTERSECT\r\n-SELECT * FROM tab2\r\n+SELECT udf(k), udf(udf(v)) FROM tab2\r\n -- !query 18 schema\r\n-struct<k:int,v:int>\r\n+struct<k:int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 18 output\r\n 1\t2\r\n 2\t3\r\n\r\n```\r\n</p>\r\n</details> \r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).","created_at":"2019-07-11T16:48:13Z","updated_at":"2019-07-18T10:54:42Z","closed_at":"2019-07-18T10:54:42Z","merged_at":null,"merge_commit_sha":"b0e1c89e43d2b0deeb8b18945d14e7a45f9bf6c3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25119/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25119/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25119/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/42cf16bd46a6e33226540516b0344c52e543e57e","head":{"label":"imback82:intersect-all-sql","ref":"intersect-all-sql","sha":"42cf16bd46a6e33226540516b0344c52e543e57e","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":190453549,"node_id":"MDEwOlJlcG9zaXRvcnkxOTA0NTM1NDk=","name":"spark-4","full_name":"imback82/spark-4","private":false,"owner":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/imback82/spark-4","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/imback82/spark-4","forks_url":"https://api.github.com/repos/imback82/spark-4/forks","keys_url":"https://api.github.com/repos/imback82/spark-4/keys{/key_id}","collaborators_url":"https://api.github.com/repos/imback82/spark-4/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/imback82/spark-4/teams","hooks_url":"https://api.github.com/repos/imback82/spark-4/hooks","issue_events_url":"https://api.github.com/repos/imback82/spark-4/issues/events{/number}","events_url":"https://api.github.com/repos/imback82/spark-4/events","assignees_url":"https://api.github.com/repos/imback82/spark-4/assignees{/user}","branches_url":"https://api.github.com/repos/imback82/spark-4/branches{/branch}","tags_url":"https://api.github.com/repos/imback82/spark-4/tags","blobs_url":"https://api.github.com/repos/imback82/spark-4/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/imback82/spark-4/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/imback82/spark-4/git/refs{/sha}","trees_url":"https://api.github.com/repos/imback82/spark-4/git/trees{/sha}","statuses_url":"https://api.github.com/repos/imback82/spark-4/statuses/{sha}","languages_url":"https://api.github.com/repos/imback82/spark-4/languages","stargazers_url":"https://api.github.com/repos/imback82/spark-4/stargazers","contributors_url":"https://api.github.com/repos/imback82/spark-4/contributors","subscribers_url":"https://api.github.com/repos/imback82/spark-4/subscribers","subscription_url":"https://api.github.com/repos/imback82/spark-4/subscription","commits_url":"https://api.github.com/repos/imback82/spark-4/commits{/sha}","git_commits_url":"https://api.github.com/repos/imback82/spark-4/git/commits{/sha}","comments_url":"https://api.github.com/repos/imback82/spark-4/comments{/number}","issue_comment_url":"https://api.github.com/repos/imback82/spark-4/issues/comments{/number}","contents_url":"https://api.github.com/repos/imback82/spark-4/contents/{+path}","compare_url":"https://api.github.com/repos/imback82/spark-4/compare/{base}...{head}","merges_url":"https://api.github.com/repos/imback82/spark-4/merges","archive_url":"https://api.github.com/repos/imback82/spark-4/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/imback82/spark-4/downloads","issues_url":"https://api.github.com/repos/imback82/spark-4/issues{/number}","pulls_url":"https://api.github.com/repos/imback82/spark-4/pulls{/number}","milestones_url":"https://api.github.com/repos/imback82/spark-4/milestones{/number}","notifications_url":"https://api.github.com/repos/imback82/spark-4/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/imback82/spark-4/labels{/name}","releases_url":"https://api.github.com/repos/imback82/spark-4/releases{/id}","deployments_url":"https://api.github.com/repos/imback82/spark-4/deployments","created_at":"2019-06-05T19:09:03Z","updated_at":"2022-01-05T16:28:23Z","pushed_at":"2024-02-20T02:09:15Z","git_url":"git://github.com/imback82/spark-4.git","ssh_url":"git@github.com:imback82/spark-4.git","clone_url":"https://github.com/imback82/spark-4.git","svn_url":"https://github.com/imback82/spark-4","homepage":"","size":412962,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"eb5dc746c250d614d7ebf9b310fe531f154c0fee","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25119"},"html":{"href":"https://github.com/apache/spark/pull/25119"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25119"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25119/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25119/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25119/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/42cf16bd46a6e33226540516b0344c52e543e57e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25118","id":296698668,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2Njk4NjY4","html_url":"https://github.com/apache/spark/pull/25118","diff_url":"https://github.com/apache/spark/pull/25118.diff","patch_url":"https://github.com/apache/spark/pull/25118.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25118","number":25118,"state":"closed","locked":false,"title":"[SPARK-27878][SQL] Support ARRAY(subquery) expressions","user":{"login":"peter-toth","id":7253827,"node_id":"MDQ6VXNlcjcyNTM4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/7253827?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-toth","html_url":"https://github.com/peter-toth","followers_url":"https://api.github.com/users/peter-toth/followers","following_url":"https://api.github.com/users/peter-toth/following{/other_user}","gists_url":"https://api.github.com/users/peter-toth/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-toth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-toth/subscriptions","organizations_url":"https://api.github.com/users/peter-toth/orgs","repos_url":"https://api.github.com/users/peter-toth/repos","events_url":"https://api.github.com/users/peter-toth/events{/privacy}","received_events_url":"https://api.github.com/users/peter-toth/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds support for array creation from subquery so this example becomes valid:\r\n```\r\nselect array(select c from t)\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nAdded new UTs.\r\n","created_at":"2019-07-11T15:08:56Z","updated_at":"2019-12-27T02:01:30Z","closed_at":"2019-12-27T00:07:41Z","merged_at":null,"merge_commit_sha":"2158cfd3898a161f8a1560fedb97bb8bba24e57c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25118/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25118/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25118/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/fcef61ec0a2246ecaf37cf9e17536c88915b5ff6","head":{"label":"peter-toth:SPARK-27878-2","ref":"SPARK-27878-2","sha":"fcef61ec0a2246ecaf37cf9e17536c88915b5ff6","user":{"login":"peter-toth","id":7253827,"node_id":"MDQ6VXNlcjcyNTM4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/7253827?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-toth","html_url":"https://github.com/peter-toth","followers_url":"https://api.github.com/users/peter-toth/followers","following_url":"https://api.github.com/users/peter-toth/following{/other_user}","gists_url":"https://api.github.com/users/peter-toth/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-toth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-toth/subscriptions","organizations_url":"https://api.github.com/users/peter-toth/orgs","repos_url":"https://api.github.com/users/peter-toth/repos","events_url":"https://api.github.com/users/peter-toth/events{/privacy}","received_events_url":"https://api.github.com/users/peter-toth/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":130546049,"node_id":"MDEwOlJlcG9zaXRvcnkxMzA1NDYwNDk=","name":"spark","full_name":"peter-toth/spark","private":false,"owner":{"login":"peter-toth","id":7253827,"node_id":"MDQ6VXNlcjcyNTM4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/7253827?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-toth","html_url":"https://github.com/peter-toth","followers_url":"https://api.github.com/users/peter-toth/followers","following_url":"https://api.github.com/users/peter-toth/following{/other_user}","gists_url":"https://api.github.com/users/peter-toth/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-toth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-toth/subscriptions","organizations_url":"https://api.github.com/users/peter-toth/orgs","repos_url":"https://api.github.com/users/peter-toth/repos","events_url":"https://api.github.com/users/peter-toth/events{/privacy}","received_events_url":"https://api.github.com/users/peter-toth/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/peter-toth/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/peter-toth/spark","forks_url":"https://api.github.com/repos/peter-toth/spark/forks","keys_url":"https://api.github.com/repos/peter-toth/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/peter-toth/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/peter-toth/spark/teams","hooks_url":"https://api.github.com/repos/peter-toth/spark/hooks","issue_events_url":"https://api.github.com/repos/peter-toth/spark/issues/events{/number}","events_url":"https://api.github.com/repos/peter-toth/spark/events","assignees_url":"https://api.github.com/repos/peter-toth/spark/assignees{/user}","branches_url":"https://api.github.com/repos/peter-toth/spark/branches{/branch}","tags_url":"https://api.github.com/repos/peter-toth/spark/tags","blobs_url":"https://api.github.com/repos/peter-toth/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/peter-toth/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/peter-toth/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/peter-toth/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/peter-toth/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/peter-toth/spark/languages","stargazers_url":"https://api.github.com/repos/peter-toth/spark/stargazers","contributors_url":"https://api.github.com/repos/peter-toth/spark/contributors","subscribers_url":"https://api.github.com/repos/peter-toth/spark/subscribers","subscription_url":"https://api.github.com/repos/peter-toth/spark/subscription","commits_url":"https://api.github.com/repos/peter-toth/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/peter-toth/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/peter-toth/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/peter-toth/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/peter-toth/spark/contents/{+path}","compare_url":"https://api.github.com/repos/peter-toth/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/peter-toth/spark/merges","archive_url":"https://api.github.com/repos/peter-toth/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/peter-toth/spark/downloads","issues_url":"https://api.github.com/repos/peter-toth/spark/issues{/number}","pulls_url":"https://api.github.com/repos/peter-toth/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/peter-toth/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/peter-toth/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/peter-toth/spark/labels{/name}","releases_url":"https://api.github.com/repos/peter-toth/spark/releases{/id}","deployments_url":"https://api.github.com/repos/peter-toth/spark/deployments","created_at":"2018-04-22T07:43:37Z","updated_at":"2025-01-06T11:44:37Z","pushed_at":"2025-01-07T12:36:36Z","git_url":"git://github.com/peter-toth/spark.git","ssh_url":"git@github.com:peter-toth/spark.git","clone_url":"https://github.com/peter-toth/spark.git","svn_url":"https://github.com/peter-toth/spark","homepage":null,"size":498613,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":3,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"e83583ef70c4e12853720df1984251dce80e66f9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25118"},"html":{"href":"https://github.com/apache/spark/pull/25118"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25118"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25118/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25118/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25118/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/fcef61ec0a2246ecaf37cf9e17536c88915b5ff6"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25117","id":296663729,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NjYzNzI5","html_url":"https://github.com/apache/spark/pull/25117","diff_url":"https://github.com/apache/spark/pull/25117.diff","patch_url":"https://github.com/apache/spark/pull/25117.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25117","number":25117,"state":"closed","locked":false,"title":"[SPARK-28454][PYTHON] Validate LongType in `createDataFrame(verifySchema=True)`","user":{"login":"simplylizz","id":795497,"node_id":"MDQ6VXNlcjc5NTQ5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/795497?v=4","gravatar_id":"","url":"https://api.github.com/users/simplylizz","html_url":"https://github.com/simplylizz","followers_url":"https://api.github.com/users/simplylizz/followers","following_url":"https://api.github.com/users/simplylizz/following{/other_user}","gists_url":"https://api.github.com/users/simplylizz/gists{/gist_id}","starred_url":"https://api.github.com/users/simplylizz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simplylizz/subscriptions","organizations_url":"https://api.github.com/users/simplylizz/orgs","repos_url":"https://api.github.com/users/simplylizz/repos","events_url":"https://api.github.com/users/simplylizz/events{/privacy}","received_events_url":"https://api.github.com/users/simplylizz/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nAdd missing validation for `LongType` in `pyspark.sql.types._make_type_verifier`.\r\n\r\n## How was this patch tested?\r\n\r\nDoctests / unittests / manual tests.\r\n\r\nUnpatched version:\r\n```\r\nIn [23]: s.createDataFrame([{'x': 1 << 64}], StructType([StructField('x', LongType())])).collect()\r\nOut[23]: [Row(x=None)]\r\n```\r\n\r\nPatched:\r\n```\r\nIn [5]: s.createDataFrame([{'x': 1 << 64}], StructType([StructField('x', LongType())])).collect()\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-5-c1740fcadbf9> in <module>\r\n----> 1 s.createDataFrame([{'x': 1 << 64}], StructType([StructField('x', LongType())])).collect()\r\n\r\n/usr/local/lib/python3.5/site-packages/pyspark/sql/session.py in createDataFrame(self, data, schema, samplingRatio, verifySchema)\r\n    689             rdd, schema = self._createFromRDD(data.map(prepare), schema, samplingRatio)\r\n    690         else:\r\n--> 691             rdd, schema = self._createFromLocal(map(prepare, data), schema)\r\n    692         jrdd = self._jvm.SerDeUtil.toJavaArray(rdd._to_java_object_rdd())\r\n    693         jdf = self._jsparkSession.applySchemaToPythonRDD(jrdd.rdd(), schema.json())\r\n\r\n/usr/local/lib/python3.5/site-packages/pyspark/sql/session.py in _createFromLocal(self, data, schema)\r\n    405         # make sure data could consumed multiple times\r\n    406         if not isinstance(data, list):\r\n--> 407             data = list(data)\r\n    408\r\n    409         if schema is None or isinstance(schema, (list, tuple)):\r\n\r\n/usr/local/lib/python3.5/site-packages/pyspark/sql/session.py in prepare(obj)\r\n    671\r\n    672             def prepare(obj):\r\n--> 673                 verify_func(obj)\r\n    674                 return obj\r\n    675         elif isinstance(schema, DataType):\r\n\r\n/usr/local/lib/python3.5/site-packages/pyspark/sql/types.py in verify(obj)\r\n   1427     def verify(obj):\r\n   1428         if not verify_nullability(obj):\r\n-> 1429             verify_value(obj)\r\n   1430\r\n   1431     return verify\r\n\r\n/usr/local/lib/python3.5/site-packages/pyspark/sql/types.py in verify_struct(obj)\r\n   1397             if isinstance(obj, dict):\r\n   1398                 for f, verifier in verifiers:\r\n-> 1399                     verifier(obj.get(f))\r\n   1400             elif isinstance(obj, Row) and getattr(obj, \"__from_dict__\", False):\r\n   1401                 # the order in obj could be different than dataType.fields\r\n\r\n/usr/local/lib/python3.5/site-packages/pyspark/sql/types.py in verify(obj)\r\n   1427     def verify(obj):\r\n   1428         if not verify_nullability(obj):\r\n-> 1429             verify_value(obj)\r\n   1430\r\n   1431     return verify\r\n\r\n/usr/local/lib/python3.5/site-packages/pyspark/sql/types.py in verify_long(obj)\r\n   1356             if obj < -9223372036854775808 or obj > 9223372036854775807:\r\n   1357                 raise ValueError(\r\n-> 1358                     new_msg(\"object of LongType out of range, got: %s\" % obj))\r\n   1359\r\n   1360         verify_value = verify_long\r\n\r\nValueError: field x: object of LongType out of range, got: 18446744073709551616\r\n```","created_at":"2019-07-11T13:55:39Z","updated_at":"2019-08-08T02:52:11Z","closed_at":"2019-08-08T02:52:11Z","merged_at":null,"merge_commit_sha":"93413050c06adfb21d720365695f87c5f1c1bf20","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25117/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25117/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25117/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1f02d0c8c20654668fbbd3a59387efed3f101b88","head":{"label":"simplylizz:master","ref":"master","sha":"1f02d0c8c20654668fbbd3a59387efed3f101b88","user":{"login":"simplylizz","id":795497,"node_id":"MDQ6VXNlcjc5NTQ5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/795497?v=4","gravatar_id":"","url":"https://api.github.com/users/simplylizz","html_url":"https://github.com/simplylizz","followers_url":"https://api.github.com/users/simplylizz/followers","following_url":"https://api.github.com/users/simplylizz/following{/other_user}","gists_url":"https://api.github.com/users/simplylizz/gists{/gist_id}","starred_url":"https://api.github.com/users/simplylizz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simplylizz/subscriptions","organizations_url":"https://api.github.com/users/simplylizz/orgs","repos_url":"https://api.github.com/users/simplylizz/repos","events_url":"https://api.github.com/users/simplylizz/events{/privacy}","received_events_url":"https://api.github.com/users/simplylizz/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"b8e13b0aeae4a25e54a4c4b8a97bc2c19edd37bb","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25117"},"html":{"href":"https://github.com/apache/spark/pull/25117"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25117"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25117/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25117/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25117/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1f02d0c8c20654668fbbd3a59387efed3f101b88"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25116","id":296627466,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NjI3NDY2","html_url":"https://github.com/apache/spark/pull/25116","diff_url":"https://github.com/apache/spark/pull/25116.diff","patch_url":"https://github.com/apache/spark/pull/25116.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25116","number":25116,"state":"closed","locked":false,"title":"[SPARK-26978][SQL][FOLLOWUP] Initialize date-time constants by foldable expressions","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nReverted initialization of date-time constants in `DateTimeUtils` introduced by #23878. As a comment in [Delta repo](https://github.com/delta-io/delta) states, the compiler can do additional optimizations if values can be calculated at compile time: https://github.com/delta-io/delta/blob/master/src/main/scala/org/apache/spark/sql/delta/util/DateTimeUtils.scala#L63-L75 \r\n\r\n## How was this patch tested?\r\n\r\nThis was tested by existing test suites.","created_at":"2019-07-11T12:33:59Z","updated_at":"2019-09-18T15:58:13Z","closed_at":"2019-07-11T15:53:55Z","merged_at":null,"merge_commit_sha":"8df4f1a26b11ba07c4c6232c69a44e32ca77f549","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25116/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25116/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25116/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b3bd3a312471575a7f221a13a3784563f5a7fce3","head":{"label":"MaxGekk:datetime-consts-init","ref":"datetime-consts-init","sha":"b3bd3a312471575a7f221a13a3784563f5a7fce3","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":123690489,"node_id":"MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=","name":"spark","full_name":"MaxGekk/spark","private":false,"owner":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/MaxGekk/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/MaxGekk/spark","forks_url":"https://api.github.com/repos/MaxGekk/spark/forks","keys_url":"https://api.github.com/repos/MaxGekk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/MaxGekk/spark/teams","hooks_url":"https://api.github.com/repos/MaxGekk/spark/hooks","issue_events_url":"https://api.github.com/repos/MaxGekk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/MaxGekk/spark/events","assignees_url":"https://api.github.com/repos/MaxGekk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/MaxGekk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/MaxGekk/spark/tags","blobs_url":"https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/MaxGekk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/MaxGekk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/MaxGekk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/MaxGekk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/MaxGekk/spark/languages","stargazers_url":"https://api.github.com/repos/MaxGekk/spark/stargazers","contributors_url":"https://api.github.com/repos/MaxGekk/spark/contributors","subscribers_url":"https://api.github.com/repos/MaxGekk/spark/subscribers","subscription_url":"https://api.github.com/repos/MaxGekk/spark/subscription","commits_url":"https://api.github.com/repos/MaxGekk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/MaxGekk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/MaxGekk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/MaxGekk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/MaxGekk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/MaxGekk/spark/merges","archive_url":"https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/MaxGekk/spark/downloads","issues_url":"https://api.github.com/repos/MaxGekk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/MaxGekk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/MaxGekk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/MaxGekk/spark/labels{/name}","releases_url":"https://api.github.com/repos/MaxGekk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/MaxGekk/spark/deployments","created_at":"2018-03-03T12:37:00Z","updated_at":"2025-02-07T09:44:52Z","pushed_at":"2025-02-07T09:44:24Z","git_url":"git://github.com/MaxGekk/spark.git","ssh_url":"git@github.com:MaxGekk/spark.git","clone_url":"https://github.com/MaxGekk/spark.git","svn_url":"https://github.com/MaxGekk/spark","homepage":null,"size":486456,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"19bcce15336a050b073617b38265d080dd802e3d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25116"},"html":{"href":"https://github.com/apache/spark/pull/25116"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25116"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25116/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25116/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25116/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b3bd3a312471575a7f221a13a3784563f5a7fce3"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25115","id":296604279,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NjA0Mjc5","html_url":"https://github.com/apache/spark/pull/25115","diff_url":"https://github.com/apache/spark/pull/25115.diff","patch_url":"https://github.com/apache/spark/pull/25115.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25115","number":25115,"state":"closed","locked":false,"title":"[SPARK-28351][SQL] Support DELETE in DataSource V2","user":{"login":"xianyinxin","id":15028683,"node_id":"MDQ6VXNlcjE1MDI4Njgz","avatar_url":"https://avatars.githubusercontent.com/u/15028683?v=4","gravatar_id":"","url":"https://api.github.com/users/xianyinxin","html_url":"https://github.com/xianyinxin","followers_url":"https://api.github.com/users/xianyinxin/followers","following_url":"https://api.github.com/users/xianyinxin/following{/other_user}","gists_url":"https://api.github.com/users/xianyinxin/gists{/gist_id}","starred_url":"https://api.github.com/users/xianyinxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xianyinxin/subscriptions","organizations_url":"https://api.github.com/users/xianyinxin/orgs","repos_url":"https://api.github.com/users/xianyinxin/repos","events_url":"https://api.github.com/users/xianyinxin/events{/privacy}","received_events_url":"https://api.github.com/users/xianyinxin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis pr adds DELETE support for V2 datasources. As a first step, this pr only support delete by source filters:\r\n```scala\r\nvoid delete(Filter[] filters);\r\n```\r\nwhich could not deal with complicated cases like subqueries.\r\n\r\nSince it's uncomfortable to embed the implementation of DELETE in the current V2 APIs, a new mix-in of datasource is added, which is called `SupportsMaintenance`, similar to `SupportsRead` and `SupportsWrite`.  A datasource which can be maintained means we can perform DELETE/UPDATE/MERGE/OPTIMIZE on the datasource, as long as the datasource implements the necessary mix-ins.\r\n\r\n## How was this patch tested?\r\n\r\nnew test case.\r\n\r\nPlease review https://spark.apache.org/contributing.html before opening a pull request.\r\n","created_at":"2019-07-11T11:33:19Z","updated_at":"2019-08-15T01:41:50Z","closed_at":"2019-08-14T15:43:56Z","merged_at":null,"merge_commit_sha":"b10453f621e21870d3d322112d116fd659dad5bf","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25115/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25115/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25115/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/bbf515666495cbf5f12731b3cdab4a23960f3d77","head":{"label":"xianyinxin:SPARK-28351","ref":"SPARK-28351","sha":"bbf515666495cbf5f12731b3cdab4a23960f3d77","user":{"login":"xianyinxin","id":15028683,"node_id":"MDQ6VXNlcjE1MDI4Njgz","avatar_url":"https://avatars.githubusercontent.com/u/15028683?v=4","gravatar_id":"","url":"https://api.github.com/users/xianyinxin","html_url":"https://github.com/xianyinxin","followers_url":"https://api.github.com/users/xianyinxin/followers","following_url":"https://api.github.com/users/xianyinxin/following{/other_user}","gists_url":"https://api.github.com/users/xianyinxin/gists{/gist_id}","starred_url":"https://api.github.com/users/xianyinxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xianyinxin/subscriptions","organizations_url":"https://api.github.com/users/xianyinxin/orgs","repos_url":"https://api.github.com/users/xianyinxin/repos","events_url":"https://api.github.com/users/xianyinxin/events{/privacy}","received_events_url":"https://api.github.com/users/xianyinxin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":182274989,"node_id":"MDEwOlJlcG9zaXRvcnkxODIyNzQ5ODk=","name":"spark","full_name":"xianyinxin/spark","private":false,"owner":{"login":"xianyinxin","id":15028683,"node_id":"MDQ6VXNlcjE1MDI4Njgz","avatar_url":"https://avatars.githubusercontent.com/u/15028683?v=4","gravatar_id":"","url":"https://api.github.com/users/xianyinxin","html_url":"https://github.com/xianyinxin","followers_url":"https://api.github.com/users/xianyinxin/followers","following_url":"https://api.github.com/users/xianyinxin/following{/other_user}","gists_url":"https://api.github.com/users/xianyinxin/gists{/gist_id}","starred_url":"https://api.github.com/users/xianyinxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xianyinxin/subscriptions","organizations_url":"https://api.github.com/users/xianyinxin/orgs","repos_url":"https://api.github.com/users/xianyinxin/repos","events_url":"https://api.github.com/users/xianyinxin/events{/privacy}","received_events_url":"https://api.github.com/users/xianyinxin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xianyinxin/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/xianyinxin/spark","forks_url":"https://api.github.com/repos/xianyinxin/spark/forks","keys_url":"https://api.github.com/repos/xianyinxin/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xianyinxin/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xianyinxin/spark/teams","hooks_url":"https://api.github.com/repos/xianyinxin/spark/hooks","issue_events_url":"https://api.github.com/repos/xianyinxin/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xianyinxin/spark/events","assignees_url":"https://api.github.com/repos/xianyinxin/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xianyinxin/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xianyinxin/spark/tags","blobs_url":"https://api.github.com/repos/xianyinxin/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xianyinxin/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xianyinxin/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xianyinxin/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xianyinxin/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xianyinxin/spark/languages","stargazers_url":"https://api.github.com/repos/xianyinxin/spark/stargazers","contributors_url":"https://api.github.com/repos/xianyinxin/spark/contributors","subscribers_url":"https://api.github.com/repos/xianyinxin/spark/subscribers","subscription_url":"https://api.github.com/repos/xianyinxin/spark/subscription","commits_url":"https://api.github.com/repos/xianyinxin/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xianyinxin/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xianyinxin/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xianyinxin/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xianyinxin/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xianyinxin/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xianyinxin/spark/merges","archive_url":"https://api.github.com/repos/xianyinxin/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xianyinxin/spark/downloads","issues_url":"https://api.github.com/repos/xianyinxin/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xianyinxin/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xianyinxin/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xianyinxin/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xianyinxin/spark/labels{/name}","releases_url":"https://api.github.com/repos/xianyinxin/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xianyinxin/spark/deployments","created_at":"2019-04-19T14:13:19Z","updated_at":"2019-05-08T01:59:34Z","pushed_at":"2020-06-29T06:08:23Z","git_url":"git://github.com/xianyinxin/spark.git","ssh_url":"git@github.com:xianyinxin/spark.git","clone_url":"https://github.com/xianyinxin/spark.git","svn_url":"https://github.com/xianyinxin/spark","homepage":"","size":331024,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5368eaa2fc33f6d50b482bd1e90e0437b1887cd2","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25115"},"html":{"href":"https://github.com/apache/spark/pull/25115"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25115"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25115/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25115/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25115/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/bbf515666495cbf5f12731b3cdab4a23960f3d77"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25114","id":296543068,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NTQzMDY4","html_url":"https://github.com/apache/spark/pull/25114","diff_url":"https://github.com/apache/spark/pull/25114.diff","patch_url":"https://github.com/apache/spark/pull/25114.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25114","number":25114,"state":"closed","locked":false,"title":"[SPARK-28349][SQL] Add FALSE and SETMINUS to ansiNonReserved","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nHow to reproduce this issue:\r\n```sql\r\nspark-sql> set spark.sql.parser.ansi.enabled=true;\r\nspark.sql.parser.ansi.enabled\ttrue\r\nspark-sql> select 1 as false;\r\nError in query:\r\nno viable alternative at input 'false'(line 1, pos 12)\r\n\r\n== SQL ==\r\nselect 1 as false\r\n------------^^^\r\n\r\nspark-sql> select 1 as minus;\r\nError in query:\r\nno viable alternative at input 'minus'(line 1, pos 12)\r\n\r\n== SQL ==\r\nselect 1 as minus\r\n------------^^^\r\n```\r\n\r\nOther databases behaviour:\r\n**PostgreSQL**:\r\n```\r\npostgres=# select 1 as false, 1 as minus;\r\n false | minus\r\n-------+-------\r\n     1 |     1\r\n(1 row)\r\n```\r\n\r\n**Vertica**:\r\n```\r\ndbadmin=> select 1 as false, 1 as minus;\r\n false | minus\r\n-------+-------\r\n     1 |     1\r\n(1 row)\r\n```\r\n\r\n**SQL Server**:\r\n```sql\r\n1> select 1 as false, 1 as minus\r\n2> go\r\nfalse       minus\r\n----------- -----------\r\n          1           1\r\n```\r\n\r\n**DB2**:\r\n![image](https://user-images.githubusercontent.com/5399861/61038827-3f45b900-a400-11e9-82bd-5657cbf4ac1c.png)\r\n\r\n**Oracle**:\r\n```\r\nSQL> select 1 as false, 1 as minus from dual;\r\nselect 1 as false, 1 as minus from dual\r\n                        *\r\nERROR at line 1:\r\nORA-00923: FROM keyword not found where expected\r\n```\r\n\r\n**Teradata**:\r\n![image](https://user-images.githubusercontent.com/5399861/61038909-6bf9d080-a400-11e9-8910-f5ad339c9b0f.png)\r\n\r\nThis pr add `FALSE` and `SETMINUS` to ansiNonReserved to fix this issue.\r\n\r\n## How was this patch tested?\r\n\r\nunit tests and manual tests:\r\n```\r\nspark-sql> select 1 as false, 1 as minus;\r\n1\t1\r\nspark-sql>\r\n```","created_at":"2019-07-11T09:07:12Z","updated_at":"2019-07-19T03:23:05Z","closed_at":"2019-07-13T00:44:43Z","merged_at":null,"merge_commit_sha":"3308b7df3afc6d13f3991486756c2241f7f773f6","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25114/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25114/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25114/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3efbda6e87ee6268a049d0cd42727a9da9b1bd4f","head":{"label":"wangyum:SPARK-28349","ref":"SPARK-28349","sha":"3efbda6e87ee6268a049d0cd42727a9da9b1bd4f","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"7021588ba8365b2018f9f7b5d3b05285886cd0be","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25114"},"html":{"href":"https://github.com/apache/spark/pull/25114"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25114"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25114/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25114/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25114/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3efbda6e87ee6268a049d0cd42727a9da9b1bd4f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25113","id":296524919,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NTI0OTE5","html_url":"https://github.com/apache/spark/pull/25113","diff_url":"https://github.com/apache/spark/pull/25113.diff","patch_url":"https://github.com/apache/spark/pull/25113.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25113","number":25113,"state":"closed","locked":false,"title":"[SPARK-28287][SQL][PYTHON][TESTS] Convert and port 'udaf.sql' into UDF test base","user":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from 'udaf.sql' to test UDFs\r\n\r\n\r\n<details><summary>Diff comparing to 'udaf.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/udaf.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-udaf.sql.out\r\nindex f4455bb717..e1165931d6 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/udaf.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-udaf.sql.out\r\n@@ -21,7 +21,7 @@ struct<>\r\n\r\n\r\n -- !query 2\r\n-SELECT default.myDoubleAvg(int_col1) as my_avg from t1\r\n+SELECT default.myDoubleAvg(udf(int_col1)) as my_avg from t1\r\n -- !query 2 schema\r\n struct<my_avg:double>\r\n -- !query 2 output\r\n@@ -29,7 +29,7 @@ struct<my_avg:double>\r\n\r\n\r\n -- !query 3\r\n-SELECT default.myDoubleAvg(int_col1, 3) as my_avg from t1\r\n+SELECT default.myDoubleAvg(udf(int_col1), udf(3)) as my_avg from t1\r\n -- !query 3 schema\r\n struct<>\r\n -- !query 3 output\r\n@@ -46,7 +46,7 @@ struct<>\r\n\r\n\r\n -- !query 5\r\n-SELECT default.udaf1(int_col1) as udaf1 from t1\r\n+SELECT default.udaf1(udf(int_col1)) as udaf1 from t1\r\n -- !query 5 schema\r\n struct<>\r\n -- !query 5 output\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in SPARK-27921.","created_at":"2019-07-11T08:25:00Z","updated_at":"2021-05-25T07:58:14Z","closed_at":"2019-07-18T07:27:07Z","merged_at":null,"merge_commit_sha":"e35dfd075553d065b21beabf9035e31171817d80","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25113/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25113/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25113/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/bc9b0d2403567573eb0ce28e7f1e40207d561d88","head":{"label":"vinodkc:br_Fix_SPARK-27921","ref":"br_Fix_SPARK-27921","sha":"bc9b0d2403567573eb0ce28e7f1e40207d561d88","user":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":86780265,"node_id":"MDEwOlJlcG9zaXRvcnk4Njc4MDI2NQ==","name":"spark","full_name":"vinodkc/spark","private":false,"owner":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vinodkc/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/vinodkc/spark","forks_url":"https://api.github.com/repos/vinodkc/spark/forks","keys_url":"https://api.github.com/repos/vinodkc/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vinodkc/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vinodkc/spark/teams","hooks_url":"https://api.github.com/repos/vinodkc/spark/hooks","issue_events_url":"https://api.github.com/repos/vinodkc/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vinodkc/spark/events","assignees_url":"https://api.github.com/repos/vinodkc/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vinodkc/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vinodkc/spark/tags","blobs_url":"https://api.github.com/repos/vinodkc/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vinodkc/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vinodkc/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vinodkc/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vinodkc/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vinodkc/spark/languages","stargazers_url":"https://api.github.com/repos/vinodkc/spark/stargazers","contributors_url":"https://api.github.com/repos/vinodkc/spark/contributors","subscribers_url":"https://api.github.com/repos/vinodkc/spark/subscribers","subscription_url":"https://api.github.com/repos/vinodkc/spark/subscription","commits_url":"https://api.github.com/repos/vinodkc/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vinodkc/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vinodkc/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vinodkc/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vinodkc/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vinodkc/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vinodkc/spark/merges","archive_url":"https://api.github.com/repos/vinodkc/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vinodkc/spark/downloads","issues_url":"https://api.github.com/repos/vinodkc/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vinodkc/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vinodkc/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vinodkc/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vinodkc/spark/labels{/name}","releases_url":"https://api.github.com/repos/vinodkc/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vinodkc/spark/deployments","created_at":"2017-03-31T05:10:58Z","updated_at":"2025-01-24T19:30:18Z","pushed_at":"2025-01-24T19:26:51Z","git_url":"git://github.com/vinodkc/spark.git","ssh_url":"git@github.com:vinodkc/spark.git","clone_url":"https://github.com/vinodkc/spark.git","svn_url":"https://github.com/vinodkc/spark","homepage":null,"size":464015,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":3,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7021588ba8365b2018f9f7b5d3b05285886cd0be","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25113"},"html":{"href":"https://github.com/apache/spark/pull/25113"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25113"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25113/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25113/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25113/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/bc9b0d2403567573eb0ce28e7f1e40207d561d88"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25112","id":296516069,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NTE2MDY5","html_url":"https://github.com/apache/spark/pull/25112","diff_url":"https://github.com/apache/spark/pull/25112.diff","patch_url":"https://github.com/apache/spark/pull/25112.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25112","number":25112,"state":"closed","locked":false,"title":"[SPARK-28347][K8S] Add gcompat to spark k8s Dockerfile","user":{"login":"plusplusjiajia","id":5210402,"node_id":"MDQ6VXNlcjUyMTA0MDI=","avatar_url":"https://avatars.githubusercontent.com/u/5210402?v=4","gravatar_id":"","url":"https://api.github.com/users/plusplusjiajia","html_url":"https://github.com/plusplusjiajia","followers_url":"https://api.github.com/users/plusplusjiajia/followers","following_url":"https://api.github.com/users/plusplusjiajia/following{/other_user}","gists_url":"https://api.github.com/users/plusplusjiajia/gists{/gist_id}","starred_url":"https://api.github.com/users/plusplusjiajia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/plusplusjiajia/subscriptions","organizations_url":"https://api.github.com/users/plusplusjiajia/orgs","repos_url":"https://api.github.com/users/plusplusjiajia/repos","events_url":"https://api.github.com/users/plusplusjiajia/events{/privacy}","received_events_url":"https://api.github.com/users/plusplusjiajia/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nI want to run TPC-DS in K8S, when generating data on HDFS, with following error: \r\n\r\nERROR Utils: Aborting task\r\njava.lang.UnsatisfiedLinkError: /tmp/snappy-1.1.7-91d7ec9a-6e2d-47af-90ae-84c00d143b6d-libsnappyjava.so: Error loading shared library ld-linux-x86-64.so.2: No such file or directory\r\n\r\nLooking into the executor pod, ld-linux-x86-64.so.2 is existed in /lib64 but not in /lib :\r\nls -al /lib/ld*\r\n-rwxr-xr-x 1 root root 584304 Mar 19 09:56 /lib/ld-musl-x86_64.so.1\r\nls -al /lib64/ld*\r\nlrwxrwxrwx 1 root root 26 Jul 2 09:05 /lib64/ld-linux-x86-64.so.2 -> /lib/libc.musl-x86_64.so.1\r\n\r\nAfter adding the gcompat in Dockerfile,  ld-linux-x86-64.so.2 exists in both lib and lib64 folders and no more error:\r\n\r\nls -al /lib/ld*\r\n-rwxr-xr-x 1 root root 18512 Dec 24 2018 /lib/ld-linux-x86-64.so.2\r\n-rwxr-xr-x 1 root root 584304 Mar 19 09:56 /lib/ld-musl-x86_64.so.1\r\nls -al /lib64/ld*\r\nlrwxrwxrwx 1 root root 26 Jul 11 02:06 /lib64/ld-linux-x86-64.so.2 -> /lib/libc.musl-x86_64.so.1 \r\n\r\n## How was this patch tested?\r\n\r\nmanual test\r\n","created_at":"2019-07-11T08:03:00Z","updated_at":"2019-07-12T06:02:37Z","closed_at":"2019-07-12T06:01:43Z","merged_at":null,"merge_commit_sha":"e03e0830f4cf4eb271eec78a4e4e4f008d888eee","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406605057,"node_id":"MDU6TGFiZWwxNDA2NjA1MDU3","url":"https://api.github.com/repos/apache/spark/labels/KUBERNETES","name":"KUBERNETES","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25112/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25112/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25112/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/953b866697915e480db1fd761761ec125c87cfa1","head":{"label":"plusplusjiajia:k8s","ref":"k8s","sha":"953b866697915e480db1fd761761ec125c87cfa1","user":{"login":"plusplusjiajia","id":5210402,"node_id":"MDQ6VXNlcjUyMTA0MDI=","avatar_url":"https://avatars.githubusercontent.com/u/5210402?v=4","gravatar_id":"","url":"https://api.github.com/users/plusplusjiajia","html_url":"https://github.com/plusplusjiajia","followers_url":"https://api.github.com/users/plusplusjiajia/followers","following_url":"https://api.github.com/users/plusplusjiajia/following{/other_user}","gists_url":"https://api.github.com/users/plusplusjiajia/gists{/gist_id}","starred_url":"https://api.github.com/users/plusplusjiajia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/plusplusjiajia/subscriptions","organizations_url":"https://api.github.com/users/plusplusjiajia/orgs","repos_url":"https://api.github.com/users/plusplusjiajia/repos","events_url":"https://api.github.com/users/plusplusjiajia/events{/privacy}","received_events_url":"https://api.github.com/users/plusplusjiajia/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":60578100,"node_id":"MDEwOlJlcG9zaXRvcnk2MDU3ODEwMA==","name":"spark","full_name":"plusplusjiajia/spark","private":false,"owner":{"login":"plusplusjiajia","id":5210402,"node_id":"MDQ6VXNlcjUyMTA0MDI=","avatar_url":"https://avatars.githubusercontent.com/u/5210402?v=4","gravatar_id":"","url":"https://api.github.com/users/plusplusjiajia","html_url":"https://github.com/plusplusjiajia","followers_url":"https://api.github.com/users/plusplusjiajia/followers","following_url":"https://api.github.com/users/plusplusjiajia/following{/other_user}","gists_url":"https://api.github.com/users/plusplusjiajia/gists{/gist_id}","starred_url":"https://api.github.com/users/plusplusjiajia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/plusplusjiajia/subscriptions","organizations_url":"https://api.github.com/users/plusplusjiajia/orgs","repos_url":"https://api.github.com/users/plusplusjiajia/repos","events_url":"https://api.github.com/users/plusplusjiajia/events{/privacy}","received_events_url":"https://api.github.com/users/plusplusjiajia/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/plusplusjiajia/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/plusplusjiajia/spark","forks_url":"https://api.github.com/repos/plusplusjiajia/spark/forks","keys_url":"https://api.github.com/repos/plusplusjiajia/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/plusplusjiajia/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/plusplusjiajia/spark/teams","hooks_url":"https://api.github.com/repos/plusplusjiajia/spark/hooks","issue_events_url":"https://api.github.com/repos/plusplusjiajia/spark/issues/events{/number}","events_url":"https://api.github.com/repos/plusplusjiajia/spark/events","assignees_url":"https://api.github.com/repos/plusplusjiajia/spark/assignees{/user}","branches_url":"https://api.github.com/repos/plusplusjiajia/spark/branches{/branch}","tags_url":"https://api.github.com/repos/plusplusjiajia/spark/tags","blobs_url":"https://api.github.com/repos/plusplusjiajia/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/plusplusjiajia/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/plusplusjiajia/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/plusplusjiajia/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/plusplusjiajia/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/plusplusjiajia/spark/languages","stargazers_url":"https://api.github.com/repos/plusplusjiajia/spark/stargazers","contributors_url":"https://api.github.com/repos/plusplusjiajia/spark/contributors","subscribers_url":"https://api.github.com/repos/plusplusjiajia/spark/subscribers","subscription_url":"https://api.github.com/repos/plusplusjiajia/spark/subscription","commits_url":"https://api.github.com/repos/plusplusjiajia/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/plusplusjiajia/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/plusplusjiajia/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/plusplusjiajia/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/plusplusjiajia/spark/contents/{+path}","compare_url":"https://api.github.com/repos/plusplusjiajia/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/plusplusjiajia/spark/merges","archive_url":"https://api.github.com/repos/plusplusjiajia/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/plusplusjiajia/spark/downloads","issues_url":"https://api.github.com/repos/plusplusjiajia/spark/issues{/number}","pulls_url":"https://api.github.com/repos/plusplusjiajia/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/plusplusjiajia/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/plusplusjiajia/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/plusplusjiajia/spark/labels{/name}","releases_url":"https://api.github.com/repos/plusplusjiajia/spark/releases{/id}","deployments_url":"https://api.github.com/repos/plusplusjiajia/spark/deployments","created_at":"2016-06-07T03:12:39Z","updated_at":"2020-03-11T12:30:15Z","pushed_at":"2020-03-11T12:44:52Z","git_url":"git://github.com/plusplusjiajia/spark.git","ssh_url":"git@github.com:plusplusjiajia/spark.git","clone_url":"https://github.com/plusplusjiajia/spark.git","svn_url":"https://github.com/plusplusjiajia/spark","homepage":null,"size":308753,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7021588ba8365b2018f9f7b5d3b05285886cd0be","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25112"},"html":{"href":"https://github.com/apache/spark/pull/25112"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25112"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25112/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25112/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25112/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/953b866697915e480db1fd761761ec125c87cfa1"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25111","id":296487795,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NDg3Nzk1","html_url":"https://github.com/apache/spark/pull/25111","diff_url":"https://github.com/apache/spark/pull/25111.diff","patch_url":"https://github.com/apache/spark/pull/25111.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25111","number":25111,"state":"closed","locked":false,"title":"[SPARK-28346][SQL] clone the query plan between analyzer, optimizer and planner","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nquery plan was designed to be immutable, but sometimes we do allow it to carry mutable states, because of the complexity of the SQL system. One example is `TreeNodeTag`. It's a state of `TreeNode` and can be carried over during copy and transform. The adaptive execution framework relies on it to link the logical and physical plans.\r\n\r\nThis leads to a problem: when we get `QueryExecution#analyzed`, the plan can be changed unexpectedly because it's mutable. I hit a real issue in https://github.com/apache/spark/pull/25107 : I use `TreeNodeTag` to carry dataset id in logical plans. However, the analyzed plan ends up with many duplicated dataset id tags in different nodes. It turns out that, the optimizer transforms the logical plan and add the tag to more nodes.\r\n\r\nFor example, the logical plan is `SubqueryAlias(Filter(...))`, and I expect only the `SubqueryAlais` has the dataset id tag. However, the optimizer removes `SubqueryAlias` and carries over the dataset id tag to `Filter`. When I go back to the analyzed plan, both `SubqueryAlias` and `Filter` has the dataset id tag, which breaks my assumption.\r\n\r\nSince now query plan is mutable, I think it's better to limit the life cycle of a query plan instance. We can clone the query plan between analyzer, optimizer and planner, so that the life cycle is limited in one stage.\r\n\r\n## How was this patch tested?\r\n\r\nnew test","created_at":"2019-07-11T06:44:39Z","updated_at":"2024-02-06T17:47:43Z","closed_at":"2019-07-23T16:05:59Z","merged_at":null,"merge_commit_sha":"befd41e7c10445f8160dab72d8ea8508c132dabe","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25111/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25111/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25111/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/4f75ba4db1455dcc35da88b86a46188ce568f37c","head":{"label":"cloud-fan:clone","ref":"clone","sha":"4f75ba4db1455dcc35da88b86a46188ce568f37c","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f241fc7776cc7a54c9377ec0a81e14f788434073","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25111"},"html":{"href":"https://github.com/apache/spark/pull/25111"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25111"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25111/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25111/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25111/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/4f75ba4db1455dcc35da88b86a46188ce568f37c"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25110","id":296479838,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NDc5ODM4","html_url":"https://github.com/apache/spark/pull/25110","diff_url":"https://github.com/apache/spark/pull/25110.diff","patch_url":"https://github.com/apache/spark/pull/25110.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25110","number":25110,"state":"closed","locked":false,"title":"[SPARK-28270][SQL][FOLLOW-UP] Explicitly cast into int/long/decimal in udf-aggregates_part1.sql to avoid Python float limitation","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe tests added at https://github.com/apache/spark/pull/25069 seem flaky in some environments. See https://github.com/apache/spark/pull/25069#issuecomment-510338469\r\n\r\nPython's string representation of floats can make the tests flaky. See https://docs.python.org/3/tutorial/floatingpoint.html.\r\n\r\nI think it's just better to explicitly cast everywhere udf returns a float (or a double) to stay safe. (note that we're not targeting the Python <> Scala value conversions - there are inevitable differences between Python and Scala; therefore, other languages' UDFs cannot guarantee the same results between Python and Scala).\r\n\r\nThis PR proposes to cast cases to long, integer and decimal explicitly to make the test cases robust.\r\n\r\n<details><summary>Diff comparing to 'pgSQL/aggregates_part1.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/pgSQL/aggregates_part1.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part1.sql.out\r\nindex 51ca1d55869..734634b7388 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/pgSQL/aggregates_part1.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part1.sql.out\r\n@@ -3,23 +3,23 @@\r\n\r\n\r\n -- !query 0\r\n-SELECT avg(four) AS avg_1 FROM onek\r\n+SELECT CAST(avg(udf(four)) AS decimal(10,3)) AS avg_1 FROM onek\r\n -- !query 0 schema\r\n-struct<avg_1:double>\r\n+struct<avg_1:decimal(10,3)>\r\n -- !query 0 output\r\n 1.5\r\n\r\n\r\n -- !query 1\r\n-SELECT avg(a) AS avg_32 FROM aggtest WHERE a < 100\r\n+SELECT CAST(udf(avg(a)) AS decimal(10,3)) AS avg_32 FROM aggtest WHERE a < 100\r\n -- !query 1 schema\r\n-struct<avg_32:double>\r\n+struct<avg_32:decimal(10,3)>\r\n -- !query 1 output\r\n-32.666666666666664\r\n+32.667\r\n\r\n\r\n -- !query 2\r\n-select CAST(avg(b) AS Decimal(10,3)) AS avg_107_943 FROM aggtest\r\n+select CAST(avg(udf(b)) AS Decimal(10,3)) AS avg_107_943 FROM aggtest\r\n -- !query 2 schema\r\n struct<avg_107_943:decimal(10,3)>\r\n -- !query 2 output\r\n@@ -27,39 +27,39 @@ struct<avg_107_943:decimal(10,3)>\r\n\r\n\r\n -- !query 3\r\n-SELECT sum(four) AS sum_1500 FROM onek\r\n+SELECT CAST(sum(udf(four)) AS int) AS sum_1500 FROM onek\r\n -- !query 3 schema\r\n-struct<sum_1500:bigint>\r\n+struct<sum_1500:int>\r\n -- !query 3 output\r\n 1500\r\n\r\n\r\n -- !query 4\r\n-SELECT sum(a) AS sum_198 FROM aggtest\r\n+SELECT udf(sum(a)) AS sum_198 FROM aggtest\r\n -- !query 4 schema\r\n-struct<sum_198:bigint>\r\n+struct<sum_198:string>\r\n -- !query 4 output\r\n 198\r\n\r\n\r\n -- !query 5\r\n-SELECT sum(b) AS avg_431_773 FROM aggtest\r\n+SELECT CAST(udf(udf(sum(b))) AS decimal(10,3)) AS avg_431_773 FROM aggtest\r\n -- !query 5 schema\r\n-struct<avg_431_773:double>\r\n+struct<avg_431_773:decimal(10,3)>\r\n -- !query 5 output\r\n-431.77260909229517\r\n+431.773\r\n\r\n\r\n -- !query 6\r\n-SELECT max(four) AS max_3 FROM onek\r\n+SELECT udf(max(four)) AS max_3 FROM onek\r\n -- !query 6 schema\r\n-struct<max_3:int>\r\n+struct<max_3:string>\r\n -- !query 6 output\r\n 3\r\n\r\n\r\n -- !query 7\r\n-SELECT max(a) AS max_100 FROM aggtest\r\n+SELECT max(CAST(udf(a) AS int)) AS max_100 FROM aggtest\r\n -- !query 7 schema\r\n struct<max_100:int>\r\n -- !query 7 output\r\n@@ -67,245 +67,246 @@ struct<max_100:int>\r\n\r\n\r\n -- !query 8\r\n-SELECT max(aggtest.b) AS max_324_78 FROM aggtest\r\n+SELECT CAST(udf(udf(max(aggtest.b))) AS decimal(10,3)) AS max_324_78 FROM aggtest\r\n -- !query 8 schema\r\n-struct<max_324_78:float>\r\n+struct<max_324_78:decimal(10,3)>\r\n -- !query 8 output\r\n 324.78\r\n\r\n\r\n -- !query 9\r\n-SELECT stddev_pop(b) FROM aggtest\r\n+SELECT CAST(stddev_pop(udf(b)) AS decimal(10,3)) FROM aggtest\r\n -- !query 9 schema\r\n-struct<stddev_pop(CAST(b AS DOUBLE)):double>\r\n+struct<CAST(stddev_pop(CAST(udf(b) AS DOUBLE)) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 9 output\r\n-131.10703231895047\r\n+131.107\r\n\r\n\r\n -- !query 10\r\n-SELECT stddev_samp(b) FROM aggtest\r\n+SELECT CAST(udf(stddev_samp(b)) AS decimal(10,3)) FROM aggtest\r\n -- !query 10 schema\r\n-struct<stddev_samp(CAST(b AS DOUBLE)):double>\r\n+struct<CAST(udf(stddev_samp(cast(b as double))) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 10 output\r\n-151.38936080399804\r\n+151.389\r\n\r\n\r\n -- !query 11\r\n-SELECT var_pop(b) FROM aggtest\r\n+SELECT CAST(var_pop(udf(b)) AS decimal(10,3)) FROM aggtest\r\n -- !query 11 schema\r\n-struct<var_pop(CAST(b AS DOUBLE)):double>\r\n+struct<CAST(var_pop(CAST(udf(b) AS DOUBLE)) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 11 output\r\n-17189.053923482323\r\n+17189.054\r\n\r\n\r\n -- !query 12\r\n-SELECT var_samp(b) FROM aggtest\r\n+SELECT CAST(udf(var_samp(b)) AS decimal(10,3)) FROM aggtest\r\n -- !query 12 schema\r\n-struct<var_samp(CAST(b AS DOUBLE)):double>\r\n+struct<CAST(udf(var_samp(cast(b as double))) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 12 output\r\n-22918.738564643096\r\n+22918.739\r\n\r\n\r\n -- !query 13\r\n-SELECT stddev_pop(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT CAST(udf(stddev_pop(CAST(b AS Decimal(38,0)))) AS decimal(10,3)) FROM aggtest\r\n -- !query 13 schema\r\n-struct<stddev_pop(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<CAST(udf(stddev_pop(cast(cast(b as decimal(38,0)) as double))) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 13 output\r\n-131.18117242958306\r\n+131.181\r\n\r\n\r\n -- !query 14\r\n-SELECT stddev_samp(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT CAST(stddev_samp(CAST(udf(b) AS Decimal(38,0))) AS decimal(10,3)) FROM aggtest\r\n -- !query 14 schema\r\n-struct<stddev_samp(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<CAST(stddev_samp(CAST(CAST(udf(b) AS DECIMAL(38,0)) AS DOUBLE)) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 14 output\r\n-151.47497042966097\r\n+151.475\r\n\r\n\r\n -- !query 15\r\n-SELECT var_pop(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT CAST(udf(var_pop(CAST(b AS Decimal(38,0)))) AS decimal(10,3)) FROM aggtest\r\n -- !query 15 schema\r\n-struct<var_pop(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<CAST(udf(var_pop(cast(cast(b as decimal(38,0)) as double))) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 15 output\r\n 17208.5\r\n\r\n\r\n -- !query 16\r\n-SELECT var_samp(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT CAST(var_samp(udf(CAST(b AS Decimal(38,0)))) AS decimal(10,3)) FROM aggtest\r\n -- !query 16 schema\r\n-struct<var_samp(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<CAST(var_samp(CAST(udf(cast(b as decimal(38,0))) AS DOUBLE)) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 16 output\r\n-22944.666666666668\r\n+22944.667\r\n\r\n\r\n -- !query 17\r\n-SELECT var_pop(1.0), var_samp(2.0)\r\n+SELECT CAST(udf(var_pop(1.0)) AS int), var_samp(udf(2.0))\r\n -- !query 17 schema\r\n-struct<var_pop(CAST(1.0 AS DOUBLE)):double,var_samp(CAST(2.0 AS DOUBLE)):double>\r\n+struct<CAST(udf(var_pop(cast(1.0 as double))) AS INT):int,var_samp(CAST(udf(2.0) AS DOUBLE)):double>\r\n -- !query 17 output\r\n-0.0    NaN\r\n+0      NaN\r\n\r\n\r\n -- !query 18\r\n-SELECT stddev_pop(CAST(3.0 AS Decimal(38,0))), stddev_samp(CAST(4.0 AS Decimal(38,0)))\r\n+SELECT CAST(stddev_pop(udf(CAST(3.0 AS Decimal(38,0)))) AS int), stddev_samp(CAST(udf(4.0) AS Decimal(38,0)))\r\n -- !query 18 schema\r\n-struct<stddev_pop(CAST(CAST(3.0 AS DECIMAL(38,0)) AS DOUBLE)):double,stddev_samp(CAST(CAST(4.0 AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<CAST(stddev_pop(CAST(udf(cast(3.0 as decimal(38,0))) AS DOUBLE)) AS INT):int,stddev_samp(CAST(CAST(udf(4.0) AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n -- !query 18 output\r\n-0.0    NaN\r\n+0      NaN\r\n\r\n\r\n -- !query 19\r\n-select sum(CAST(null AS int)) from range(1,4)\r\n+select sum(udf(CAST(null AS int))) from range(1,4)\r\n -- !query 19 schema\r\n-struct<sum(CAST(NULL AS INT)):bigint>\r\n+struct<sum(CAST(udf(cast(null as int)) AS DOUBLE)):double>\r\n -- !query 19 output\r\n NULL\r\n\r\n\r\n -- !query 20\r\n-select sum(CAST(null AS long)) from range(1,4)\r\n+select sum(udf(CAST(null AS long))) from range(1,4)\r\n -- !query 20 schema\r\n-struct<sum(CAST(NULL AS BIGINT)):bigint>\r\n+struct<sum(CAST(udf(cast(null as bigint)) AS DOUBLE)):double>\r\n -- !query 20 output\r\n NULL\r\n\r\n\r\n -- !query 21\r\n-select sum(CAST(null AS Decimal(38,0))) from range(1,4)\r\n+select sum(udf(CAST(null AS Decimal(38,0)))) from range(1,4)\r\n -- !query 21 schema\r\n-struct<sum(CAST(NULL AS DECIMAL(38,0))):decimal(38,0)>\r\n+struct<sum(CAST(udf(cast(null as decimal(38,0))) AS DOUBLE)):double>\r\n -- !query 21 output\r\n NULL\r\n\r\n\r\n -- !query 22\r\n-select sum(CAST(null AS DOUBLE)) from range(1,4)\r\n+select sum(udf(CAST(null AS DOUBLE))) from range(1,4)\r\n -- !query 22 schema\r\n-struct<sum(CAST(NULL AS DOUBLE)):double>\r\n+struct<sum(CAST(udf(cast(null as double)) AS DOUBLE)):double>\r\n -- !query 22 output\r\n NULL\r\n\r\n\r\n -- !query 23\r\n-select avg(CAST(null AS int)) from range(1,4)\r\n+select avg(udf(CAST(null AS int))) from range(1,4)\r\n -- !query 23 schema\r\n-struct<avg(CAST(NULL AS INT)):double>\r\n+struct<avg(CAST(udf(cast(null as int)) AS DOUBLE)):double>\r\n -- !query 23 output\r\n NULL\r\n\r\n\r\n -- !query 24\r\n-select avg(CAST(null AS long)) from range(1,4)\r\n+select avg(udf(CAST(null AS long))) from range(1,4)\r\n -- !query 24 schema\r\n-struct<avg(CAST(NULL AS BIGINT)):double>\r\n+struct<avg(CAST(udf(cast(null as bigint)) AS DOUBLE)):double>\r\n -- !query 24 output\r\n NULL\r\n\r\n\r\n -- !query 25\r\n-select avg(CAST(null AS Decimal(38,0))) from range(1,4)\r\n+select avg(udf(CAST(null AS Decimal(38,0)))) from range(1,4)\r\n -- !query 25 schema\r\n-struct<avg(CAST(NULL AS DECIMAL(38,0))):decimal(38,4)>\r\n+struct<avg(CAST(udf(cast(null as decimal(38,0))) AS DOUBLE)):double>\r\n -- !query 25 output\r\n NULL\r\n\r\n\r\n -- !query 26\r\n-select avg(CAST(null AS DOUBLE)) from range(1,4)\r\n+select avg(udf(CAST(null AS DOUBLE))) from range(1,4)\r\n -- !query 26 schema\r\n-struct<avg(CAST(NULL AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(cast(null as double)) AS DOUBLE)):double>\r\n -- !query 26 output\r\n NULL\r\n\r\n\r\n -- !query 27\r\n-select sum(CAST('NaN' AS DOUBLE)) from range(1,4)\r\n+select sum(CAST(udf('NaN') AS DOUBLE)) from range(1,4)\r\n -- !query 27 schema\r\n-struct<sum(CAST(NaN AS DOUBLE)):double>\r\n+struct<sum(CAST(udf(NaN) AS DOUBLE)):double>\r\n -- !query 27 output\r\n NaN\r\n\r\n\r\n -- !query 28\r\n-select avg(CAST('NaN' AS DOUBLE)) from range(1,4)\r\n+select avg(CAST(udf('NaN') AS DOUBLE)) from range(1,4)\r\n -- !query 28 schema\r\n-struct<avg(CAST(NaN AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(NaN) AS DOUBLE)):double>\r\n -- !query 28 output\r\n NaN\r\n\r\n -- !query 30\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('Infinity'), ('1')) v(x)\r\n -- !query 30 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(x) AS DOUBLE)):double,var_pop(CAST(udf(x) AS DOUBLE)):double>\r\n -- !query 30 output\r\n Infinity       NaN\r\n\r\n\r\n -- !query 31\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('Infinity'), ('Infinity')) v(x)\r\n -- !query 31 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(x) AS DOUBLE)):double,var_pop(CAST(udf(x) AS DOUBLE)):double>\r\n -- !query 31 output\r\n Infinity       NaN\r\n\r\n\r\n -- !query 32\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('-Infinity'), ('Infinity')) v(x)\r\n -- !query 32 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(x) AS DOUBLE)):double,var_pop(CAST(udf(x) AS DOUBLE)):double>\r\n -- !query 32 output\r\n NaN    NaN\r\n\r\n\r\n -- !query 33\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT CAST(avg(udf(CAST(x AS DOUBLE))) AS int), CAST(udf(var_pop(CAST(x AS DOUBLE))) AS decimal(10,3))\r\n FROM (VALUES (100000003), (100000004), (100000006), (100000007)) v(x)\r\n -- !query 33 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<CAST(avg(CAST(udf(cast(x as double)) AS DOUBLE)) AS INT):int,CAST(udf(var_pop(cast(x as double))) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 33 output\r\n-1.00000005E8   2.5\r\n+100000005      2.5\r\n\r\n\r\n -- !query 34\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT CAST(avg(udf(CAST(x AS DOUBLE))) AS long), CAST(udf(var_pop(CAST(x AS DOUBLE))) AS decimal(10,3))\r\n FROM (VALUES (7000000000005), (7000000000007)) v(x)\r\n -- !query 34 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<CAST(avg(CAST(udf(cast(x as double)) AS DOUBLE)) AS BIGINT):bigint,CAST(udf(var_pop(cast(x as double))) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 34 output\r\n-7.000000000006E12      1.0\r\n+7000000000006  1\r\n\r\n\r\n -- !query 35\r\n-SELECT covar_pop(b, a), covar_samp(b, a) FROM aggtest\r\n+SELECT CAST(udf(covar_pop(b, udf(a))) AS decimal(10,3)), CAST(covar_samp(udf(b), a) as decimal(10,3)) FROM aggtest\r\n -- !query 35 schema\r\n-struct<covar_pop(CAST(b AS DOUBLE), CAST(a AS DOUBLE)):double,covar_samp(CAST(b AS DOUBLE), CAST(a AS DOUBLE)):double>\r\n+struct<CAST(udf(covar_pop(cast(b as double), cast(udf(a) as double))) AS DECIMAL(10,3)):decimal(10,3),CAST(covar_samp(CAST(udf(b) AS DOUBLE), CAST(a AS DOUBLE)) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 35 output\r\n-653.6289553875104      871.5052738500139\r\n+653.629        871.505\r\n\r\n\r\n -- !query 36\r\n-SELECT corr(b, a) FROM aggtest\r\n+SELECT CAST(corr(b, udf(a)) AS decimal(10,3)) FROM aggtest\r\n -- !query 36 schema\r\n-struct<corr(CAST(b AS DOUBLE), CAST(a AS DOUBLE)):double>\r\n+struct<CAST(corr(CAST(b AS DOUBLE), CAST(udf(a) AS DOUBLE)) AS DECIMAL(10,3)):decimal(10,3)>\r\n -- !query 36 output\r\n-0.1396345165178734\r\n+0.14\r\n\r\n\r\n -- !query 37\r\n-SELECT count(four) AS cnt_1000 FROM onek\r\n+SELECT count(udf(four)) AS cnt_1000 FROM onek\r\n -- !query 37 schema\r\n struct<cnt_1000:bigint>\r\n -- !query 37 output\r\n@@ -313,18 +314,18 @@ struct<cnt_1000:bigint>\r\n\r\n\r\n -- !query 38\r\n-SELECT count(DISTINCT four) AS cnt_4 FROM onek\r\n+SELECT udf(count(DISTINCT four)) AS cnt_4 FROM onek\r\n -- !query 38 schema\r\n-struct<cnt_4:bigint>\r\n+struct<cnt_4:string>\r\n -- !query 38 output\r\n 4\r\n\r\n\r\n -- !query 39\r\n-select ten, count(*), sum(four) from onek\r\n+select ten, udf(count(*)), CAST(sum(udf(four)) AS int) from onek\r\n group by ten order by ten\r\n -- !query 39 schema\r\n-struct<ten:int,count(1):bigint,sum(four):bigint>\r\n+struct<ten:int,udf(count(1)):string,CAST(sum(CAST(udf(four) AS DOUBLE)) AS INT):int>\r\n -- !query 39 output\r\n 0      100     100\r\n 1      100     200\r\n@@ -339,10 +340,10 @@ struct<ten:int,count(1):bigint,sum(four):bigint>\r\n\r\n\r\n -- !query 40\r\n-select ten, count(four), sum(DISTINCT four) from onek\r\n+select ten, count(udf(four)), udf(sum(DISTINCT four)) from onek\r\n group by ten order by ten\r\n -- !query 40 schema\r\n-struct<ten:int,count(four):bigint,sum(DISTINCT four):bigint>\r\n+struct<ten:int,count(udf(four)):bigint,udf(sum(distinct cast(four as bigint))):string>\r\n -- !query 40 output\r\n 0      100     2\r\n 1      100     4\r\n@@ -357,11 +358,11 @@ struct<ten:int,count(four):bigint,sum(DISTINCT four):bigint>\r\n\r\n\r\n -- !query 41\r\n-select ten, sum(distinct four) from onek a\r\n+select ten, udf(sum(distinct four)) from onek a\r\n group by ten\r\n-having exists (select 1 from onek b where sum(distinct a.four) = b.four)\r\n+having exists (select 1 from onek b where udf(sum(distinct a.four)) = b.four)\r\n -- !query 41 schema\r\n-struct<ten:int,sum(DISTINCT four):bigint>\r\n+struct<ten:int,udf(sum(distinct cast(four as bigint))):string>\r\n -- !query 41 output\r\n 0      2\r\n 2      2\r\n@@ -374,23 +375,23 @@ struct<ten:int,sum(DISTINCT four):bigint>\r\n select ten, sum(distinct four) from onek a\r\n group by ten\r\n having exists (select 1 from onek b\r\n-               where sum(distinct a.four + b.four) = b.four)\r\n+               where sum(distinct a.four + b.four) = udf(b.four))\r\n -- !query 42 schema\r\n struct<>\r\n -- !query 42 output\r\n org.apache.spark.sql.AnalysisException\r\n\r\n Aggregate/Window/Generate expressions are not valid in where clause of the query.\r\n-Expression in where clause: [(sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT)) = CAST(b.`four` AS BIGINT))]\r\n+Expression in where clause: [(sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT)) = CAST(udf(four) AS BIGINT))]\r\n Invalid expressions: [sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT))];\r\n\r\n\r\n -- !query 43\r\n select\r\n-  (select max((select i.unique2 from tenk1 i where i.unique1 = o.unique1)))\r\n+  (select udf(max((select i.unique2 from tenk1 i where i.unique1 = o.unique1))))\r\n from tenk1 o\r\n -- !query 43 schema\r\n struct<>\r\n -- !query 43 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve '`o.unique1`' given input columns: [i.even, i.fivethous, i.four, i.hundred, i.odd, i.string4, i.stringu1, i.stringu2, i.ten, i.tenthous, i.thousand, i.twenty, i.two, i.twothousand, i.unique1, i.unique2]; line 2 pos 63\r\n+cannot resolve '`o.unique1`' given input columns: [i.even, i.fivethous, i.four, i.hundred, i.odd, i.string4, i.stringu1, i.stringu2, i.ten, i.tenthous, i.thousand, i.twenty, i.two, i.twothousand, i.unique1, i.unique2]; line 2 pos 67\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nManually tested in local.\r\n\r\nAlso, with JDK 11:\r\n\r\n```\r\nUsing /.../jdk-11.0.3.jdk/Contents/Home as default JAVA_HOME.\r\nNote, this will be overridden by -java-home if it is set.\r\n[info] Loading project definition from /.../spark/project\r\n[info] Updating {file:/.../spark/project/}spark-build...\r\n...\r\n[info] SQLQueryTestSuite:\r\n...\r\n[info] - udf/pgSQL/udf-aggregates_part1.sql - Scala UDF (17 seconds, 228 milliseconds)\r\n[info] - udf/pgSQL/udf-aggregates_part1.sql - Regular Python UDF (36 seconds, 170 milliseconds)\r\n[info] - udf/pgSQL/udf-aggregates_part1.sql - Scalar Pandas UDF (41 seconds, 132 milliseconds)\r\n...\r\n```","created_at":"2019-07-11T06:16:24Z","updated_at":"2020-03-03T01:18:30Z","closed_at":"2019-07-11T11:57:47Z","merged_at":null,"merge_commit_sha":"5fdce08637c4935d9ce60333c1a15133fc361339","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25110/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25110/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25110/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/21870c64e6fccf44844770867f14e966cba9512e","head":{"label":"HyukjinKwon:SPARK-28270-1","ref":"SPARK-28270-1","sha":"21870c64e6fccf44844770867f14e966cba9512e","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7021588ba8365b2018f9f7b5d3b05285886cd0be","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25110"},"html":{"href":"https://github.com/apache/spark/pull/25110"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25110"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25110/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25110/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25110/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/21870c64e6fccf44844770867f14e966cba9512e"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25109","id":296474843,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NDc0ODQz","html_url":"https://github.com/apache/spark/pull/25109","diff_url":"https://github.com/apache/spark/pull/25109.diff","patch_url":"https://github.com/apache/spark/pull/25109.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25109","number":25109,"state":"closed","locked":false,"title":"[SPARK-28343][SQL][TEST] Enabling cartesian product and ansi mode for PostgreSQL testing","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis pr enables `spark.sql.crossJoin.enabled` and `spark.sql.parser.ansi.enabled` for PostgreSQL test.\r\n\r\n## How was this patch tested?\r\n\r\nmanual tests:\r\nRun `test.sql` in [pgSQL](https://github.com/apache/spark/tree/master/sql/core/src/test/resources/sql-tests/inputs/pgSQL) directory and in [inputs](https://github.com/apache/spark/tree/master/sql/core/src/test/resources/sql-tests/inputs) directory:\r\n```sql\r\ncat <<EOF > test.sql\r\ncreate or replace temporary view t1 as\r\nselect * from (values(1), (2)) as v (val);\r\n\r\ncreate or replace temporary view t2 as\r\nselect * from (values(2), (1)) as v (val);\r\n\r\nselect t1.*, t2.* from t1 join t2;\r\nEOF\r\n```\r\n\r\n","created_at":"2019-07-11T05:55:51Z","updated_at":"2019-07-14T06:45:00Z","closed_at":"2019-07-14T06:42:36Z","merged_at":null,"merge_commit_sha":"2ee4b4b05dfda80dc2bd0130cf6175dcb082e443","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25109/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25109/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25109/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8ce7af493b38dc9a8dd569be0f998b9b7d12cd7b","head":{"label":"wangyum:SPARK-28343","ref":"SPARK-28343","sha":"8ce7af493b38dc9a8dd569be0f998b9b7d12cd7b","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"60b89cf8097ff583a29a6a19f1db4afa780f3109","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25109"},"html":{"href":"https://github.com/apache/spark/pull/25109"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25109"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25109/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25109/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25109/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8ce7af493b38dc9a8dd569be0f998b9b7d12cd7b"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25108","id":296472855,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NDcyODU1","html_url":"https://github.com/apache/spark/pull/25108","diff_url":"https://github.com/apache/spark/pull/25108.diff","patch_url":"https://github.com/apache/spark/pull/25108.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25108","number":25108,"state":"closed","locked":false,"title":"[SPARK-28321][SQL] 0-args Java UDF should not be called only once","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n0-args Java UDF alone calls the function even before making it as an expression.\r\nIt causes that the function always returns the same value and the function is called at driver side.\r\nSeems like a mistake.\r\n\r\n## How was this patch tested?\r\n\r\nUnit test was added\r\n","created_at":"2019-07-11T05:46:43Z","updated_at":"2020-03-03T01:18:30Z","closed_at":"2019-07-12T04:48:47Z","merged_at":null,"merge_commit_sha":"b892bf30921304b610e7feadd50fcac646a812b2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25108/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25108/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25108/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1567b6c63e251c55ccb503ceae298a4db79bae52","head":{"label":"HyukjinKwon:SPARK-28321","ref":"SPARK-28321","sha":"1567b6c63e251c55ccb503ceae298a4db79bae52","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7021588ba8365b2018f9f7b5d3b05285886cd0be","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25108"},"html":{"href":"https://github.com/apache/spark/pull/25108"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25108"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25108/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25108/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25108/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1567b6c63e251c55ccb503ceae298a4db79bae52"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25107","id":296468928,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NDY4OTI4","html_url":"https://github.com/apache/spark/pull/25107","diff_url":"https://github.com/apache/spark/pull/25107.diff","patch_url":"https://github.com/apache/spark/pull/25107.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25107","number":25107,"state":"closed","locked":false,"title":"[SPARK-28344][SQL] detect ambiguous self-join and fail the query","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis is an alternative solution of https://github.com/apache/spark/pull/24442 . It fails the query if ambiguous self join is detected, instead of trying to disambiguate it. The problem is that, it's hard to come up with a reasonable rule to disambiguate, the rule proposed by #24442 is mostly a heuristic.\r\n\r\n### background of the self-join problem:\r\nThis is a long-standing bug and I've seen many people complaining about it in JIRA/dev list.\r\n\r\nA typical example:\r\n```\r\nval df1 = …\r\nval df2 = df1.filter(...)\r\ndf1.join(df2, df1(\"a\") > df2(\"a\")) // returns empty result\r\n```\r\nThe root cause is, `Dataset.apply` is so powerful that users think it returns a column reference which can point to the column of the Dataset at anywhere. This is not true in many cases. `Dataset.apply` returns an `AttributeReference` . Different Datasets may share the same `AttributeReference`. In the example above, `df2` adds a Filter operator above the logical plan of `df1`, and the Filter operator reserves the output `AttributeReference` of its child. This means, `df1(\"a\")` is exactly the same as `df2(\"a\")`, and `df1(\"a\") > df2(\"a\")` always evaluates to false.\r\n\r\n### The rule to detect ambiguous column reference caused by self join:\r\nWe can reuse the infra in #24442 :\r\n1. each Dataset has a globally unique id.\r\n2. the `AttributeReference` returned by `Dataset.apply` carries the ID and column position(e.g. 3rd column of the Dataset) via metadata.\r\n3. the logical plan of a `Dataset` carries the ID via `TreeNodeTag`\r\n\r\nWhen self-join happens, the analyzer asks the right side plan of join to re-generate output attributes with new exprIds. Based on it, a simple rule to detect ambiguous self join is:\r\n1. find all column references (i.e. `AttributeReference`s with Dataset ID and col position) in the root node of a query plan.\r\n2. for each column reference, traverse the query plan tree, find a sub-plan that carries Dataset ID and the ID is the same as the one in the column reference.\r\n3. get the corresponding output attribute of the sub-plan by the col position in the column reference.\r\n4. if the corresponding output attribute has a different exprID than the column reference, then it means this sub-plan is on the right side of a self-join and has regenerated its output attributes. This is an ambiguous self join because the column reference points to a table being self-joined.\r\n\r\n\r\n## How was this patch tested?\r\n\r\nexisting tests and new test cases","created_at":"2019-07-11T05:28:07Z","updated_at":"2020-01-31T18:22:37Z","closed_at":"2019-08-06T02:11:19Z","merged_at":null,"merge_commit_sha":"c8b733d24ab044eb9ce7d68130e35e8ee68db146","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25107/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25107/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25107/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/62228e8ffbb5d54ad2ec5a85dd2450cd1dec5ae2","head":{"label":"cloud-fan:new-self-join","ref":"new-self-join","sha":"62228e8ffbb5d54ad2ec5a85dd2450cd1dec5ae2","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"0345f1174d6019374ed5451140e01c224508bc0e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25107"},"html":{"href":"https://github.com/apache/spark/pull/25107"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25107"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25107/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25107/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25107/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/62228e8ffbb5d54ad2ec5a85dd2450cd1dec5ae2"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25106","id":296464270,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NDY0Mjcw","html_url":"https://github.com/apache/spark/pull/25106","diff_url":"https://github.com/apache/spark/pull/25106.diff","patch_url":"https://github.com/apache/spark/pull/25106.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25106","number":25106,"state":"closed","locked":false,"title":"[SPARK-28345][SQL][Python] PythonUDF predicate should be able to pushdown to join","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nA `Filter` predicate using `PythonUDF` can't be push down into join condition, currently. A predicate like that should be able to push down to join condition. For `PythonUDF`s that can't be evaluated in join condition, `PullOutPythonUDFInJoinCondition` will pull them out later.\r\n\r\nAn example like:\r\n\r\n```scala\r\nval pythonTestUDF = TestPythonUDF(name = \"udf\")\r\n\r\nval left = Seq((1, 2), (2, 3)).toDF(\"a\", \"b\")\r\nval right = Seq((1, 2), (3, 4)).toDF(\"c\", \"d\")\r\nval df = left.crossJoin(right).where(pythonTestUDF($\"a\") === pythonTestUDF($\"c\"))\r\n```\r\n\r\nQuery plan before the PR:\r\n```\r\n== Physical Plan ==                                                              \r\n*(3) Project [a#2121, b#2122, c#2132, d#2133]                      \r\n+- *(3) Filter (pythonUDF0#2142 = pythonUDF1#2143)                                                                                                    \r\n   +- BatchEvalPython [udf(a#2121), udf(c#2132)], [pythonUDF0#2142, pythonUDF1#2143]\r\n      +- BroadcastNestedLoopJoin BuildRight, Cross                                                                \r\n         :- *(1) Project [_1#2116 AS a#2121, _2#2117 AS b#2122]                   \r\n         :  +- LocalTableScan [_1#2116, _2#2117]                                   \r\n         +- BroadcastExchange IdentityBroadcastMode                       \r\n            +- *(2) Project [_1#2127 AS c#2132, _2#2128 AS d#2133]                \r\n               +- LocalTableScan [_1#2127, _2#2128]            \r\n```\r\n\r\nQuery plan after the PR:\r\n```\r\n== Physical Plan ==\r\n*(3) Project [a#2121, b#2122, c#2132, d#2133]\r\n+- *(3) BroadcastHashJoin [pythonUDF0#2142], [pythonUDF0#2143], Cross, BuildRight\r\n   :- BatchEvalPython [udf(a#2121)], [pythonUDF0#2142]\r\n   :  +- *(1) Project [_1#2116 AS a#2121, _2#2117 AS b#2122]\r\n   :     +- LocalTableScan [_1#2116, _2#2117]\r\n   +- BroadcastExchange HashedRelationBroadcastMode(List(input[2, string, true]))\r\n      +- BatchEvalPython [udf(c#2132)], [pythonUDF0#2143]\r\n         +- *(2) Project [_1#2127 AS c#2132, _2#2128 AS d#2133]\r\n            +- LocalTableScan [_1#2127, _2#2128]\r\n```\r\n\r\nAfter this PR, the join can use `BroadcastHashJoin`, instead of `BroadcastNestedLoopJoin`.\r\n\r\n## How was this patch tested?\r\n\r\nAdded tests.\r\n","created_at":"2019-07-11T05:03:10Z","updated_at":"2023-12-27T18:37:41Z","closed_at":"2019-07-16T07:20:27Z","merged_at":null,"merge_commit_sha":"1cd7cd0be8c511857cab06bd6990951a5a00c3d9","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25106/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25106/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25106/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/4cca8138843db00882f38e0f8aefbcc1f66df137","head":{"label":"viirya:pythonudf-join-condition","ref":"pythonudf-join-condition","sha":"4cca8138843db00882f38e0f8aefbcc1f66df137","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7021588ba8365b2018f9f7b5d3b05285886cd0be","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25106"},"html":{"href":"https://github.com/apache/spark/pull/25106"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25106"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25106/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25106/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25106/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/4cca8138843db00882f38e0f8aefbcc1f66df137"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25105","id":296425578,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NDI1NTc4","html_url":"https://github.com/apache/spark/pull/25105","diff_url":"https://github.com/apache/spark/pull/25105.diff","patch_url":"https://github.com/apache/spark/pull/25105.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25105","number":25105,"state":"closed","locked":false,"title":"[SPARK-28342][SQL][TESTS] Replace REL_12_BETA1 to REL_12_BETA2 in PostgresSQL SQL tests","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR proposes to replace `REL_12_BETA1` to `REL_12_BETA2` which is latest.\r\n\r\n## How was this patch tested?\r\n\r\nManually checked each link and checked via `git grep -r REL_12_BETA1` as well.","created_at":"2019-07-11T01:54:06Z","updated_at":"2020-03-03T01:18:31Z","closed_at":"2019-07-11T02:06:51Z","merged_at":null,"merge_commit_sha":"1c4b961f162554e204e5b8c6f5ab879b186d0fd1","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25105/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25105/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25105/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f90660a537ea63ff4aa7ca49fc2cf3947bd8d9aa","head":{"label":"HyukjinKwon:SPARK-28342","ref":"SPARK-28342","sha":"f90660a537ea63ff4aa7ca49fc2cf3947bd8d9aa","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"3f375c850b5a41ae1ca5deb84fdcea667c32a032","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25105"},"html":{"href":"https://github.com/apache/spark/pull/25105"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25105"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25105/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25105/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25105/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f90660a537ea63ff4aa7ca49fc2cf3947bd8d9aa"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25104","id":296424160,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NDI0MTYw","html_url":"https://github.com/apache/spark/pull/25104","diff_url":"https://github.com/apache/spark/pull/25104.diff","patch_url":"https://github.com/apache/spark/pull/25104.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25104","number":25104,"state":"closed","locked":false,"title":"[SPARK-28341][SQL] create a public API for V2SessionCatalog","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe `V2SessionCatalog` has 2 functionalities:\r\n1. work as an adapter: provide v2 APIs and translate calls to the `SessionCatalog`.\r\n2. allow users to extend it, so that they can add hooks to apply custom logic before calling methods of the builtin catalog (session catalog).\r\n\r\nTo leverage the second functionality, users must extend `V2SessionCatalog` which is an internal class. There is no doc to explain this usage.\r\n\r\nThis PR does 2 things:\r\n1. refine the document of the config `spark.sql.catalog.session`.\r\n2. add a public abstract class `CatalogExtension` for users to write implementations.\r\n\r\nTODOs for followup PRs:\r\n1. discuss if we should allow users to completely overwrite the v2 session catalog with a new one.\r\n2. discuss to change the name of session catalog, so that it's less likely to conflict with existing namespace names.\r\n\r\n## How was this patch tested?\r\n\r\nexisting tests","created_at":"2019-07-11T01:47:07Z","updated_at":"2019-09-11T16:50:32Z","closed_at":"2019-09-09T13:14:48Z","merged_at":null,"merge_commit_sha":"e2243cd83848c25dd35fc595420f1ffcc52c4821","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25104/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25104/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25104/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/05db8602d0ef8c98f0f4d70ef8a4d67bb3f73692","head":{"label":"cloud-fan:session-catalog","ref":"session-catalog","sha":"05db8602d0ef8c98f0f4d70ef8a4d67bb3f73692","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"cb0cddffe9452937033e0e6b1fc0e600d2c787ad","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25104"},"html":{"href":"https://github.com/apache/spark/pull/25104"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25104"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25104/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25104/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25104/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/05db8602d0ef8c98f0f4d70ef8a4d67bb3f73692"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25103","id":296411377,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2NDExMzc3","html_url":"https://github.com/apache/spark/pull/25103","diff_url":"https://github.com/apache/spark/pull/25103.diff","patch_url":"https://github.com/apache/spark/pull/25103.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25103","number":25103,"state":"closed","locked":false,"title":"[SPARK-28285][SQL][PYTHON][TESTS] Convert and port 'outer-join.sql' into UDF test base","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from ```outer-join.sql``` to test UDFs. Please see contribution guide of this umbrella ticket - [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n<details><summary>Diff comparing to 'outer-join.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/outer-join.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-outer-join.sql.out\r\nindex 5db3bae5d0..819f786070 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/outer-join.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-outer-join.sql.out\r\n@@ -24,17 +24,17 @@ struct<>\r\n \r\n -- !query 2\r\n SELECT\r\n-  (SUM(COALESCE(t1.int_col1, t2.int_col0))),\r\n-     ((COALESCE(t1.int_col1, t2.int_col0)) * 2)\r\n+  (udf(SUM(udf(COALESCE(t1.int_col1, t2.int_col0))))),\r\n+     (udf(COALESCE(t1.int_col1, t2.int_col0)) * 2)\r\n FROM t1\r\n RIGHT JOIN t2\r\n-  ON (t2.int_col0) = (t1.int_col1)\r\n-GROUP BY GREATEST(COALESCE(t2.int_col1, 109), COALESCE(t1.int_col1, -449)),\r\n+  ON udf(t2.int_col0) = udf(t1.int_col1)\r\n+GROUP BY udf(GREATEST(COALESCE(udf(t2.int_col1), 109), COALESCE(t1.int_col1, udf(-449)))),\r\n          COALESCE(t1.int_col1, t2.int_col0)\r\n-HAVING (SUM(COALESCE(t1.int_col1, t2.int_col0)))\r\n-            > ((COALESCE(t1.int_col1, t2.int_col0)) * 2)\r\n+HAVING (udf(SUM(COALESCE(udf(t1.int_col1), udf(t2.int_col0)))))\r\n+            > (udf(COALESCE(t1.int_col1, t2.int_col0)) * 2)\r\n -- !query 2 schema\r\n-struct<sum(coalesce(int_col1, int_col0)):bigint,(coalesce(int_col1, int_col0) * 2):int>\r\n+struct<CAST(udf(cast(sum(cast(cast(udf(cast(coalesce(int_col1, int_col0) as string)) as int) as bigint)) as string)) AS BIGINT):bigint,(CAST(udf(cast(coalesce(int_col1, int_col0) as string)) AS INT) * 2):int>\r\n -- !query 2 output\r\n -367   -734\r\n -507   -1014\r\n@@ -70,10 +70,10 @@ spark.sql.crossJoin.enabled true\r\n SELECT *\r\n FROM (\r\n SELECT\r\n-    COALESCE(t2.int_col1, t1.int_col1) AS int_col\r\n+    udf(COALESCE(udf(t2.int_col1), udf(t1.int_col1))) AS int_col\r\n     FROM t1\r\n     LEFT JOIN t2 ON false\r\n-) t where (t.int_col) is not null\r\n+) t where (udf(t.int_col)) is not null\r\n -- !query 6 schema\r\n struct<int_col:int>\r\n -- !query 6 output\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n","created_at":"2019-07-11T00:47:36Z","updated_at":"2019-07-19T03:22:09Z","closed_at":"2019-07-19T03:21:09Z","merged_at":null,"merge_commit_sha":"cf29c226248cd3b87b90282ab7be38ab358de305","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25103/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25103/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25103/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5955d46daddcb8b875dffbf645af1c0f5e63a986","head":{"label":"huaxingao:spark-28285","ref":"spark-28285","sha":"5955d46daddcb8b875dffbf645af1c0f5e63a986","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":50813048,"node_id":"MDEwOlJlcG9zaXRvcnk1MDgxMzA0OA==","name":"spark","full_name":"huaxingao/spark","private":false,"owner":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/huaxingao/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/huaxingao/spark","forks_url":"https://api.github.com/repos/huaxingao/spark/forks","keys_url":"https://api.github.com/repos/huaxingao/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/huaxingao/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/huaxingao/spark/teams","hooks_url":"https://api.github.com/repos/huaxingao/spark/hooks","issue_events_url":"https://api.github.com/repos/huaxingao/spark/issues/events{/number}","events_url":"https://api.github.com/repos/huaxingao/spark/events","assignees_url":"https://api.github.com/repos/huaxingao/spark/assignees{/user}","branches_url":"https://api.github.com/repos/huaxingao/spark/branches{/branch}","tags_url":"https://api.github.com/repos/huaxingao/spark/tags","blobs_url":"https://api.github.com/repos/huaxingao/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/huaxingao/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/huaxingao/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/huaxingao/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/huaxingao/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/huaxingao/spark/languages","stargazers_url":"https://api.github.com/repos/huaxingao/spark/stargazers","contributors_url":"https://api.github.com/repos/huaxingao/spark/contributors","subscribers_url":"https://api.github.com/repos/huaxingao/spark/subscribers","subscription_url":"https://api.github.com/repos/huaxingao/spark/subscription","commits_url":"https://api.github.com/repos/huaxingao/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/huaxingao/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/huaxingao/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/huaxingao/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/huaxingao/spark/contents/{+path}","compare_url":"https://api.github.com/repos/huaxingao/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/huaxingao/spark/merges","archive_url":"https://api.github.com/repos/huaxingao/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/huaxingao/spark/downloads","issues_url":"https://api.github.com/repos/huaxingao/spark/issues{/number}","pulls_url":"https://api.github.com/repos/huaxingao/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/huaxingao/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/huaxingao/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/huaxingao/spark/labels{/name}","releases_url":"https://api.github.com/repos/huaxingao/spark/releases{/id}","deployments_url":"https://api.github.com/repos/huaxingao/spark/deployments","created_at":"2016-02-01T04:09:11Z","updated_at":"2022-01-06T22:35:11Z","pushed_at":"2023-12-21T02:21:07Z","git_url":"git://github.com/huaxingao/spark.git","ssh_url":"git@github.com:huaxingao/spark.git","clone_url":"https://github.com/huaxingao/spark.git","svn_url":"https://github.com/huaxingao/spark","homepage":null,"size":376946,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"28774cd2ea001f2270f3a5097c552e99dcd8fbe3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25103"},"html":{"href":"https://github.com/apache/spark/pull/25103"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25103"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25103/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25103/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25103/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5955d46daddcb8b875dffbf645af1c0f5e63a986"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25102","id":296353838,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2MzUzODM4","html_url":"https://github.com/apache/spark/pull/25102","diff_url":"https://github.com/apache/spark/pull/25102.diff","patch_url":"https://github.com/apache/spark/pull/25102.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25102","number":25102,"state":"closed","locked":false,"title":"[SPARK-28339][SQL] Rename Spark SQL adaptive execution configuration name","user":{"login":"carsonwang","id":9278199,"node_id":"MDQ6VXNlcjkyNzgxOTk=","avatar_url":"https://avatars.githubusercontent.com/u/9278199?v=4","gravatar_id":"","url":"https://api.github.com/users/carsonwang","html_url":"https://github.com/carsonwang","followers_url":"https://api.github.com/users/carsonwang/followers","following_url":"https://api.github.com/users/carsonwang/following{/other_user}","gists_url":"https://api.github.com/users/carsonwang/gists{/gist_id}","starred_url":"https://api.github.com/users/carsonwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carsonwang/subscriptions","organizations_url":"https://api.github.com/users/carsonwang/orgs","repos_url":"https://api.github.com/users/carsonwang/repos","events_url":"https://api.github.com/users/carsonwang/events{/privacy}","received_events_url":"https://api.github.com/users/carsonwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nThe new adaptive execution framework introduced configuration `spark.sql.runtime.reoptimization.enabled`. We now rename it back to `spark.sql.adaptive.enabled` as the umbrella configuration for adaptive execution.\r\n\r\n## How was this patch tested?\r\nExisting tests.\r\n","created_at":"2019-07-10T21:27:32Z","updated_at":"2019-07-11T01:22:39Z","closed_at":"2019-07-11T01:22:39Z","merged_at":null,"merge_commit_sha":"0769740d8ae3035f2a4cfc42e6a3858b76c6d4fd","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25102/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25102/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25102/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/fbff48cd575608b94da6560107f8272feb0af4dd","head":{"label":"carsonwang:renameAE","ref":"renameAE","sha":"fbff48cd575608b94da6560107f8272feb0af4dd","user":{"login":"carsonwang","id":9278199,"node_id":"MDQ6VXNlcjkyNzgxOTk=","avatar_url":"https://avatars.githubusercontent.com/u/9278199?v=4","gravatar_id":"","url":"https://api.github.com/users/carsonwang","html_url":"https://github.com/carsonwang","followers_url":"https://api.github.com/users/carsonwang/followers","following_url":"https://api.github.com/users/carsonwang/following{/other_user}","gists_url":"https://api.github.com/users/carsonwang/gists{/gist_id}","starred_url":"https://api.github.com/users/carsonwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carsonwang/subscriptions","organizations_url":"https://api.github.com/users/carsonwang/orgs","repos_url":"https://api.github.com/users/carsonwang/repos","events_url":"https://api.github.com/users/carsonwang/events{/privacy}","received_events_url":"https://api.github.com/users/carsonwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":36279354,"node_id":"MDEwOlJlcG9zaXRvcnkzNjI3OTM1NA==","name":"spark","full_name":"carsonwang/spark","private":false,"owner":{"login":"carsonwang","id":9278199,"node_id":"MDQ6VXNlcjkyNzgxOTk=","avatar_url":"https://avatars.githubusercontent.com/u/9278199?v=4","gravatar_id":"","url":"https://api.github.com/users/carsonwang","html_url":"https://github.com/carsonwang","followers_url":"https://api.github.com/users/carsonwang/followers","following_url":"https://api.github.com/users/carsonwang/following{/other_user}","gists_url":"https://api.github.com/users/carsonwang/gists{/gist_id}","starred_url":"https://api.github.com/users/carsonwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carsonwang/subscriptions","organizations_url":"https://api.github.com/users/carsonwang/orgs","repos_url":"https://api.github.com/users/carsonwang/repos","events_url":"https://api.github.com/users/carsonwang/events{/privacy}","received_events_url":"https://api.github.com/users/carsonwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/carsonwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/carsonwang/spark","forks_url":"https://api.github.com/repos/carsonwang/spark/forks","keys_url":"https://api.github.com/repos/carsonwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/carsonwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/carsonwang/spark/teams","hooks_url":"https://api.github.com/repos/carsonwang/spark/hooks","issue_events_url":"https://api.github.com/repos/carsonwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/carsonwang/spark/events","assignees_url":"https://api.github.com/repos/carsonwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/carsonwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/carsonwang/spark/tags","blobs_url":"https://api.github.com/repos/carsonwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/carsonwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/carsonwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/carsonwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/carsonwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/carsonwang/spark/languages","stargazers_url":"https://api.github.com/repos/carsonwang/spark/stargazers","contributors_url":"https://api.github.com/repos/carsonwang/spark/contributors","subscribers_url":"https://api.github.com/repos/carsonwang/spark/subscribers","subscription_url":"https://api.github.com/repos/carsonwang/spark/subscription","commits_url":"https://api.github.com/repos/carsonwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/carsonwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/carsonwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/carsonwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/carsonwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/carsonwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/carsonwang/spark/merges","archive_url":"https://api.github.com/repos/carsonwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/carsonwang/spark/downloads","issues_url":"https://api.github.com/repos/carsonwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/carsonwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/carsonwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/carsonwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/carsonwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/carsonwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/carsonwang/spark/deployments","created_at":"2015-05-26T07:28:13Z","updated_at":"2020-06-18T09:21:35Z","pushed_at":"2019-07-15T18:11:12Z","git_url":"git://github.com/carsonwang/spark.git","ssh_url":"git@github.com:carsonwang/spark.git","clone_url":"https://github.com/carsonwang/spark.git","svn_url":"https://github.com/carsonwang/spark","homepage":null,"size":279750,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"579edf472822802285b5cd7d07f63503015eff5a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25102"},"html":{"href":"https://github.com/apache/spark/pull/25102"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25102"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25102/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25102/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25102/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/fbff48cd575608b94da6560107f8272feb0af4dd"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25101","id":296279953,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2Mjc5OTUz","html_url":"https://github.com/apache/spark/pull/25101","diff_url":"https://github.com/apache/spark/pull/25101.diff","patch_url":"https://github.com/apache/spark/pull/25101.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25101","number":25101,"state":"closed","locked":false,"title":"[SPARK-28277][SQL][PYTHON][TESTS] Convert and port 'except.sql' into UDF test base","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from ```except.sql``` to test UDFs. Please see contribution guide of this umbrella ticket - [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n<details><summary>Diff comparing to 'except.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/except.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-except.sql.out\r\nindex c9b712d4d2..27ca7ea226 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/except.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-except.sql.out\r\n@@ -30,16 +30,16 @@ struct<>\r\n \r\n \r\n -- !query 2\r\n-SELECT * FROM t1 EXCEPT SELECT * FROM t2\r\n+SELECT udf(k), udf(v) FROM t1 EXCEPT SELECT udf(k), udf(v) FROM t2\r\n -- !query 2 schema\r\n-struct<k:string,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS STRING):string,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 2 output\r\n three  3\r\n two    2\r\n \r\n \r\n -- !query 3\r\n-SELECT * FROM t1 EXCEPT SELECT * FROM t1 where v <> 1 and v <> 2\r\n+SELECT * FROM t1 EXCEPT SELECT * FROM t1 where udf(v) <> 1 and v <> udf(2)\r\n -- !query 3 schema\r\n struct<k:string,v:int>\r\n -- !query 3 output\r\n@@ -49,7 +49,7 @@ two   2\r\n \r\n \r\n -- !query 4\r\n-SELECT * FROM t1 where v <> 1 and v <> 22 EXCEPT SELECT * FROM t1 where v <> 2 and v >= 3\r\n+SELECT * FROM t1 where udf(v) <> 1 and v <> udf(22) EXCEPT SELECT * FROM t1 where udf(v) <> 2 and v >= udf(3)\r\n -- !query 4 schema\r\n struct<k:string,v:int>\r\n -- !query 4 output\r\n@@ -59,7 +59,7 @@ two   2\r\n -- !query 5\r\n SELECT t1.* FROM t1, t2 where t1.k = t2.k\r\n EXCEPT\r\n-SELECT t1.* FROM t1, t2 where t1.k = t2.k and t1.k != 'one'\r\n+SELECT t1.* FROM t1, t2 where t1.k = t2.k and t1.k != udf('one')\r\n -- !query 5 schema\r\n struct<k:string,v:int>\r\n -- !query 5 output\r\n@@ -68,7 +68,7 @@ one   NULL\r\n \r\n \r\n -- !query 6\r\n-SELECT * FROM t2 where v >= 1 and v <> 22 EXCEPT SELECT * FROM t1\r\n+SELECT * FROM t2 where v >= udf(1) and udf(v) <> 22 EXCEPT SELECT * FROM t1\r\n -- !query 6 schema\r\n struct<k:string,v:int>\r\n -- !query 6 output\r\n@@ -77,9 +77,9 @@ one   5\r\n \r\n \r\n -- !query 7\r\n-SELECT (SELECT min(k) FROM t2 WHERE t2.k = t1.k) min_t2 FROM t1\r\n+SELECT (SELECT min(udf(k)) FROM t2 WHERE t2.k = t1.k) min_t2 FROM t1\r\n MINUS\r\n-SELECT (SELECT min(k) FROM t2) abs_min_t2 FROM t1 WHERE  t1.k = 'one'\r\n+SELECT (SELECT udf(min(k)) FROM t2) abs_min_t2 FROM t1 WHERE  t1.k = udf('one')\r\n -- !query 7 schema\r\n struct<min_t2:string>\r\n -- !query 7 output\r\n@@ -90,16 +90,17 @@ two\r\n -- !query 8\r\n SELECT t1.k\r\n FROM   t1\r\n-WHERE  t1.v <= (SELECT   max(t2.v)\r\n+WHERE  t1.v <= (SELECT   udf(max(udf(t2.v)))\r\n                 FROM     t2\r\n-                WHERE    t2.k = t1.k)\r\n+                WHERE    udf(t2.k) = udf(t1.k))\r\n MINUS\r\n SELECT t1.k\r\n FROM   t1\r\n-WHERE  t1.v >= (SELECT   min(t2.v)\r\n+WHERE  udf(t1.v) >= (SELECT   min(udf(t2.v))\r\n                 FROM     t2\r\n                 WHERE    t2.k = t1.k)\r\n -- !query 8 schema\r\n-struct<k:string>\r\n+struct<>\r\n -- !query 8 output\r\n-two\r\n+java.lang.UnsupportedOperationException\r\n+Cannot evaluate expression: udf(cast(null as string))\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\nTested as guided in [SPARK-27921.](https://issues.apache.org/jira/browse/SPARK-27921)\r\n\r\n","created_at":"2019-07-10T17:53:15Z","updated_at":"2019-07-19T14:37:28Z","closed_at":"2019-07-19T04:48:53Z","merged_at":null,"merge_commit_sha":"82a66e46942631ec343eb67494be38f2ee1ae648","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25101/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25101/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25101/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d956d374b9f4ad855bff46c98f621f821352f728","head":{"label":"huaxingao:spark-28277","ref":"spark-28277","sha":"d956d374b9f4ad855bff46c98f621f821352f728","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":50813048,"node_id":"MDEwOlJlcG9zaXRvcnk1MDgxMzA0OA==","name":"spark","full_name":"huaxingao/spark","private":false,"owner":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/huaxingao/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/huaxingao/spark","forks_url":"https://api.github.com/repos/huaxingao/spark/forks","keys_url":"https://api.github.com/repos/huaxingao/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/huaxingao/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/huaxingao/spark/teams","hooks_url":"https://api.github.com/repos/huaxingao/spark/hooks","issue_events_url":"https://api.github.com/repos/huaxingao/spark/issues/events{/number}","events_url":"https://api.github.com/repos/huaxingao/spark/events","assignees_url":"https://api.github.com/repos/huaxingao/spark/assignees{/user}","branches_url":"https://api.github.com/repos/huaxingao/spark/branches{/branch}","tags_url":"https://api.github.com/repos/huaxingao/spark/tags","blobs_url":"https://api.github.com/repos/huaxingao/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/huaxingao/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/huaxingao/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/huaxingao/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/huaxingao/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/huaxingao/spark/languages","stargazers_url":"https://api.github.com/repos/huaxingao/spark/stargazers","contributors_url":"https://api.github.com/repos/huaxingao/spark/contributors","subscribers_url":"https://api.github.com/repos/huaxingao/spark/subscribers","subscription_url":"https://api.github.com/repos/huaxingao/spark/subscription","commits_url":"https://api.github.com/repos/huaxingao/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/huaxingao/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/huaxingao/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/huaxingao/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/huaxingao/spark/contents/{+path}","compare_url":"https://api.github.com/repos/huaxingao/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/huaxingao/spark/merges","archive_url":"https://api.github.com/repos/huaxingao/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/huaxingao/spark/downloads","issues_url":"https://api.github.com/repos/huaxingao/spark/issues{/number}","pulls_url":"https://api.github.com/repos/huaxingao/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/huaxingao/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/huaxingao/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/huaxingao/spark/labels{/name}","releases_url":"https://api.github.com/repos/huaxingao/spark/releases{/id}","deployments_url":"https://api.github.com/repos/huaxingao/spark/deployments","created_at":"2016-02-01T04:09:11Z","updated_at":"2022-01-06T22:35:11Z","pushed_at":"2023-12-21T02:21:07Z","git_url":"git://github.com/huaxingao/spark.git","ssh_url":"git@github.com:huaxingao/spark.git","clone_url":"https://github.com/huaxingao/spark.git","svn_url":"https://github.com/huaxingao/spark","homepage":null,"size":376946,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"54e058dff2037066ddaf0ada1357701de04169a5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25101"},"html":{"href":"https://github.com/apache/spark/pull/25101"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25101"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25101/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25101/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25101/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d956d374b9f4ad855bff46c98f621f821352f728"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25100","id":296196807,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2MTk2ODA3","html_url":"https://github.com/apache/spark/pull/25100","diff_url":"https://github.com/apache/spark/pull/25100.diff","patch_url":"https://github.com/apache/spark/pull/25100.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25100","number":25100,"state":"closed","locked":false,"title":"[SPARK-28335][DSTREAMS][TEST] DirectKafkaStreamSuite wait for Kafka async commit","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n`DirectKafkaStreamSuite.offset recovery from kafka` commits offsets to Kafka with `Consumer.commitAsync` API (and then reads it back). Since this API is asynchronous it may send notifications late(or not at all). The actual test makes the assumption if the data sent and collected then the offset must be committed as well. This is not true.\r\n\r\nIn this PR I've made the following modifications:\r\n* Wait for async offset commit before context stopped\r\n* Added commit succeed log to see whether it arrived at all\r\n* Using `ConcurrentHashMap` for committed offsets because 2 threads are using the variable (`JobGenerator` and `ScalaTest...`)\r\n\r\n## How was this patch tested?\r\n\r\nExisting unit test in a loop + jenkins runs.\r\n","created_at":"2019-07-10T14:20:18Z","updated_at":"2019-07-10T17:14:03Z","closed_at":"2019-07-10T16:40:15Z","merged_at":null,"merge_commit_sha":"d406f26cf67017109b51bf5695bf2e8f53607441","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587334,"node_id":"MDU6TGFiZWwxNDA2NTg3MzM0","url":"https://api.github.com/repos/apache/spark/labels/DSTREAMS","name":"DSTREAMS","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25100/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25100/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25100/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f1715f5cd1d789612f62fd9717c4970e52e1e9b3","head":{"label":"gaborgsomogyi:SPARK-28335","ref":"SPARK-28335","sha":"f1715f5cd1d789612f62fd9717c4970e52e1e9b3","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":111547097,"node_id":"MDEwOlJlcG9zaXRvcnkxMTE1NDcwOTc=","name":"spark","full_name":"gaborgsomogyi/spark","private":false,"owner":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gaborgsomogyi/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gaborgsomogyi/spark","forks_url":"https://api.github.com/repos/gaborgsomogyi/spark/forks","keys_url":"https://api.github.com/repos/gaborgsomogyi/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gaborgsomogyi/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gaborgsomogyi/spark/teams","hooks_url":"https://api.github.com/repos/gaborgsomogyi/spark/hooks","issue_events_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gaborgsomogyi/spark/events","assignees_url":"https://api.github.com/repos/gaborgsomogyi/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gaborgsomogyi/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/tags","blobs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gaborgsomogyi/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gaborgsomogyi/spark/languages","stargazers_url":"https://api.github.com/repos/gaborgsomogyi/spark/stargazers","contributors_url":"https://api.github.com/repos/gaborgsomogyi/spark/contributors","subscribers_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscribers","subscription_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscription","commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gaborgsomogyi/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gaborgsomogyi/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gaborgsomogyi/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gaborgsomogyi/spark/merges","archive_url":"https://api.github.com/repos/gaborgsomogyi/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gaborgsomogyi/spark/downloads","issues_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gaborgsomogyi/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gaborgsomogyi/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gaborgsomogyi/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gaborgsomogyi/spark/labels{/name}","releases_url":"https://api.github.com/repos/gaborgsomogyi/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gaborgsomogyi/spark/deployments","created_at":"2017-11-21T12:38:03Z","updated_at":"2024-05-06T08:51:33Z","pushed_at":"2024-05-06T08:50:41Z","git_url":"git://github.com/gaborgsomogyi/spark.git","ssh_url":"git@github.com:gaborgsomogyi/spark.git","clone_url":"https://github.com/gaborgsomogyi/spark.git","svn_url":"https://github.com/gaborgsomogyi/spark","homepage":null,"size":416015,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"bbc2be4f425c4c26450e1bf21db407e81046ce21","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25100"},"html":{"href":"https://github.com/apache/spark/pull/25100"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25100"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25100/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25100/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25100/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f1715f5cd1d789612f62fd9717c4970e52e1e9b3"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25099","id":296170186,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2MTcwMTg2","html_url":"https://github.com/apache/spark/pull/25099","diff_url":"https://github.com/apache/spark/pull/25099.diff","patch_url":"https://github.com/apache/spark/pull/25099.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25099","number":25099,"state":"closed","locked":false,"title":"[SPARK-28337][spark-assembly]add commons-jxpath dependency for assembly.","user":{"login":"yanlin-Lynn","id":32827886,"node_id":"MDQ6VXNlcjMyODI3ODg2","avatar_url":"https://avatars.githubusercontent.com/u/32827886?v=4","gravatar_id":"","url":"https://api.github.com/users/yanlin-Lynn","html_url":"https://github.com/yanlin-Lynn","followers_url":"https://api.github.com/users/yanlin-Lynn/followers","following_url":"https://api.github.com/users/yanlin-Lynn/following{/other_user}","gists_url":"https://api.github.com/users/yanlin-Lynn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanlin-Lynn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanlin-Lynn/subscriptions","organizations_url":"https://api.github.com/users/yanlin-Lynn/orgs","repos_url":"https://api.github.com/users/yanlin-Lynn/repos","events_url":"https://api.github.com/users/yanlin-Lynn/events{/privacy}","received_events_url":"https://api.github.com/users/yanlin-Lynn/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR add `commons-jxpath:commons-jxpath` dependency for assembly it into jars directory.\r\nSpark contains `commons-configuration-1.6.jar` in the jars directory after assembly, and `commons-configuration-1.6.jar` depends on `commons-jxpath:commons-jxpath`. For spark application which use `XPathExpressionEngine`, a ClassNotFound exception will be thrown even though the classes of commons-jxpath:commons-jxpath are shaded inside the app jar. Becase class `XPathExpressionEngine`\r\nis loader by the **Launcher$AppClassLoader** in jars directory, so when the classloader need to load **NodePointerFactory**(which need by `XPathExpressionEngine`) class, user spark app jar is not in the path for searching.\r\n## How was this patch tested?\r\nmanual tests.\r\n","created_at":"2019-07-10T13:19:17Z","updated_at":"2019-07-11T13:46:49Z","closed_at":"2019-07-11T13:46:49Z","merged_at":null,"merge_commit_sha":"f80ca70c1a2afb64f54cadbbf5e18def82f6fb79","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1445212545,"node_id":"MDU6TGFiZWwxNDQ1MjEyNTQ1","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20SUBMIT","name":"SPARK SUBMIT","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25099/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25099/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25099/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a84f81378f5af1278acc2e3e509dc971502f4287","head":{"label":"yanlin-Lynn:yanlin-jxpath","ref":"yanlin-jxpath","sha":"a84f81378f5af1278acc2e3e509dc971502f4287","user":{"login":"yanlin-Lynn","id":32827886,"node_id":"MDQ6VXNlcjMyODI3ODg2","avatar_url":"https://avatars.githubusercontent.com/u/32827886?v=4","gravatar_id":"","url":"https://api.github.com/users/yanlin-Lynn","html_url":"https://github.com/yanlin-Lynn","followers_url":"https://api.github.com/users/yanlin-Lynn/followers","following_url":"https://api.github.com/users/yanlin-Lynn/following{/other_user}","gists_url":"https://api.github.com/users/yanlin-Lynn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanlin-Lynn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanlin-Lynn/subscriptions","organizations_url":"https://api.github.com/users/yanlin-Lynn/orgs","repos_url":"https://api.github.com/users/yanlin-Lynn/repos","events_url":"https://api.github.com/users/yanlin-Lynn/events{/privacy}","received_events_url":"https://api.github.com/users/yanlin-Lynn/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":115577076,"node_id":"MDEwOlJlcG9zaXRvcnkxMTU1NzcwNzY=","name":"spark","full_name":"yanlin-Lynn/spark","private":false,"owner":{"login":"yanlin-Lynn","id":32827886,"node_id":"MDQ6VXNlcjMyODI3ODg2","avatar_url":"https://avatars.githubusercontent.com/u/32827886?v=4","gravatar_id":"","url":"https://api.github.com/users/yanlin-Lynn","html_url":"https://github.com/yanlin-Lynn","followers_url":"https://api.github.com/users/yanlin-Lynn/followers","following_url":"https://api.github.com/users/yanlin-Lynn/following{/other_user}","gists_url":"https://api.github.com/users/yanlin-Lynn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanlin-Lynn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanlin-Lynn/subscriptions","organizations_url":"https://api.github.com/users/yanlin-Lynn/orgs","repos_url":"https://api.github.com/users/yanlin-Lynn/repos","events_url":"https://api.github.com/users/yanlin-Lynn/events{/privacy}","received_events_url":"https://api.github.com/users/yanlin-Lynn/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yanlin-Lynn/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/yanlin-Lynn/spark","forks_url":"https://api.github.com/repos/yanlin-Lynn/spark/forks","keys_url":"https://api.github.com/repos/yanlin-Lynn/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yanlin-Lynn/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yanlin-Lynn/spark/teams","hooks_url":"https://api.github.com/repos/yanlin-Lynn/spark/hooks","issue_events_url":"https://api.github.com/repos/yanlin-Lynn/spark/issues/events{/number}","events_url":"https://api.github.com/repos/yanlin-Lynn/spark/events","assignees_url":"https://api.github.com/repos/yanlin-Lynn/spark/assignees{/user}","branches_url":"https://api.github.com/repos/yanlin-Lynn/spark/branches{/branch}","tags_url":"https://api.github.com/repos/yanlin-Lynn/spark/tags","blobs_url":"https://api.github.com/repos/yanlin-Lynn/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yanlin-Lynn/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yanlin-Lynn/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/yanlin-Lynn/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yanlin-Lynn/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/yanlin-Lynn/spark/languages","stargazers_url":"https://api.github.com/repos/yanlin-Lynn/spark/stargazers","contributors_url":"https://api.github.com/repos/yanlin-Lynn/spark/contributors","subscribers_url":"https://api.github.com/repos/yanlin-Lynn/spark/subscribers","subscription_url":"https://api.github.com/repos/yanlin-Lynn/spark/subscription","commits_url":"https://api.github.com/repos/yanlin-Lynn/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/yanlin-Lynn/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/yanlin-Lynn/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/yanlin-Lynn/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/yanlin-Lynn/spark/contents/{+path}","compare_url":"https://api.github.com/repos/yanlin-Lynn/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yanlin-Lynn/spark/merges","archive_url":"https://api.github.com/repos/yanlin-Lynn/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yanlin-Lynn/spark/downloads","issues_url":"https://api.github.com/repos/yanlin-Lynn/spark/issues{/number}","pulls_url":"https://api.github.com/repos/yanlin-Lynn/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/yanlin-Lynn/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/yanlin-Lynn/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yanlin-Lynn/spark/labels{/name}","releases_url":"https://api.github.com/repos/yanlin-Lynn/spark/releases{/id}","deployments_url":"https://api.github.com/repos/yanlin-Lynn/spark/deployments","created_at":"2017-12-28T02:38:42Z","updated_at":"2019-09-18T07:39:06Z","pushed_at":"2019-07-10T13:05:46Z","git_url":"git://github.com/yanlin-Lynn/spark.git","ssh_url":"git@github.com:yanlin-Lynn/spark.git","clone_url":"https://github.com/yanlin-Lynn/spark.git","svn_url":"https://github.com/yanlin-Lynn/spark","homepage":null,"size":291745,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1b232671a8210ed7de5e7e3ce5aecc140db847f2","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25099"},"html":{"href":"https://github.com/apache/spark/pull/25099"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25099"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25099/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25099/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25099/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a84f81378f5af1278acc2e3e509dc971502f4287"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25098","id":296155250,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2MTU1MjUw","html_url":"https://github.com/apache/spark/pull/25098","diff_url":"https://github.com/apache/spark/pull/25098.diff","patch_url":"https://github.com/apache/spark/pull/25098.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25098","number":25098,"state":"closed","locked":false,"title":"[SPARK-28280][SQL][PYTHON][TESTS] Convert and port 'group-by.sql' into UDF test base","user":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from `group-by.sql` to test UDFs. Please see contribution guide of this umbrella ticket - [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n<details><summary>Diff comparing to 'group-by.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/udf/udf-group-by.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-group-by.sql.out\r\nindex 3a5df254f2..0118c05b1d 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/udf/udf-group-by.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-group-by.sql.out\r\n@@ -13,26 +13,26 @@ struct<>\r\n \r\n \r\n -- !query 1\r\n-SELECT a, COUNT(b) FROM testData\r\n+SELECT udf(a), udf(COUNT(b)) FROM testData\r\n -- !query 1 schema\r\n struct<>\r\n -- !query 1 output\r\n org.apache.spark.sql.AnalysisException\r\n-grouping expressions sequence is empty, and 'testdata.`a`' is not an aggregate function. Wrap '(count(testdata.`b`) AS `count(b)`)' in windowing function(s) or wrap 'testdata.`a`' in first() (or first_value) if you don't care which value you get.;\r\n+grouping expressions sequence is empty, and 'testdata.`a`' is not an aggregate function. Wrap '(CAST(udf(cast(count(b) as string)) AS BIGINT) AS `CAST(udf(cast(count(b) as string)) AS BIGINT)`)' in windowing function(s) or wrap 'testdata.`a`' in first() (or first_value) if you don't care which value you get.;\r\n \r\n \r\n -- !query 2\r\n-SELECT COUNT(a), COUNT(b) FROM testData\r\n+SELECT COUNT(udf(a)), udf(COUNT(b)) FROM testData\r\n -- !query 2 schema\r\n-struct<count(a):bigint,count(b):bigint>\r\n+struct<count(CAST(udf(cast(a as string)) AS INT)):bigint,CAST(udf(cast(count(b) as string)) AS BIGINT):bigint>\r\n -- !query 2 output\r\n 7\t7\r\n \r\n \r\n -- !query 3\r\n-SELECT a, COUNT(b) FROM testData GROUP BY a\r\n+SELECT udf(a), COUNT(udf(b)) FROM testData GROUP BY a\r\n -- !query 3 schema\r\n-struct<a:int,count(b):bigint>\r\n+struct<CAST(udf(cast(a as string)) AS INT):int,count(CAST(udf(cast(b as string)) AS INT)):bigint>\r\n -- !query 3 output\r\n 1\t2\r\n 2\t2\r\n@@ -41,7 +41,7 @@ NULL\t1\r\n \r\n \r\n -- !query 4\r\n-SELECT a, COUNT(b) FROM testData GROUP BY b\r\n+SELECT udf(a), udf(COUNT(udf(b))) FROM testData GROUP BY b\r\n -- !query 4 schema\r\n struct<>\r\n -- !query 4 output\r\n@@ -50,9 +50,9 @@ expression 'testdata.`a`' is neither present in the group by, nor is it an aggre\r\n \r\n \r\n -- !query 5\r\n-SELECT COUNT(a), COUNT(b) FROM testData GROUP BY a\r\n+SELECT COUNT(udf(a)), COUNT(udf(b)) FROM testData GROUP BY udf(a)\r\n -- !query 5 schema\r\n-struct<count(a):bigint,count(b):bigint>\r\n+struct<count(CAST(udf(cast(a as string)) AS INT)):bigint,count(CAST(udf(cast(b as string)) AS INT)):bigint>\r\n -- !query 5 output\r\n 0\t1\r\n 2\t2\r\n@@ -61,15 +61,15 @@ struct<count(a):bigint,count(b):bigint>\r\n \r\n \r\n -- !query 6\r\n-SELECT 'foo', COUNT(a) FROM testData GROUP BY 1\r\n+SELECT 'foo', COUNT(udf(a)) FROM testData GROUP BY 1\r\n -- !query 6 schema\r\n-struct<foo:string,count(a):bigint>\r\n+struct<foo:string,count(CAST(udf(cast(a as string)) AS INT)):bigint>\r\n -- !query 6 output\r\n foo\t7\r\n \r\n \r\n -- !query 7\r\n-SELECT 'foo' FROM testData WHERE a = 0 GROUP BY 1\r\n+SELECT 'foo' FROM testData WHERE a = 0 GROUP BY udf(1)\r\n -- !query 7 schema\r\n struct<foo:string>\r\n -- !query 7 output\r\n@@ -77,25 +77,25 @@ struct<foo:string>\r\n \r\n \r\n -- !query 8\r\n-SELECT 'foo', APPROX_COUNT_DISTINCT(a) FROM testData WHERE a = 0 GROUP BY 1\r\n+SELECT 'foo', udf(APPROX_COUNT_DISTINCT(udf(a))) FROM testData WHERE a = 0 GROUP BY 1\r\n -- !query 8 schema\r\n-struct<foo:string,approx_count_distinct(a):bigint>\r\n+struct<foo:string,CAST(udf(cast(approx_count_distinct(cast(udf(cast(a as string)) as int), 0.05, 0, 0) as string)) AS BIGINT):bigint>\r\n -- !query 8 output\r\n \r\n \r\n \r\n -- !query 9\r\n-SELECT 'foo', MAX(STRUCT(a)) FROM testData WHERE a = 0 GROUP BY 1\r\n+SELECT 'foo', MAX(STRUCT(udf(a))) FROM testData WHERE a = 0 GROUP BY 1\r\n -- !query 9 schema\r\n-struct<foo:string,max(named_struct(a, a)):struct<a:int>>\r\n+struct<foo:string,max(named_struct(col1, CAST(udf(cast(a as string)) AS INT))):struct<col1:int>>\r\n -- !query 9 output\r\n \r\n \r\n \r\n -- !query 10\r\n-SELECT a + b, COUNT(b) FROM testData GROUP BY a + b\r\n+SELECT udf(a + b), udf(COUNT(b)) FROM testData GROUP BY a + b\r\n -- !query 10 schema\r\n-struct<(a + b):int,count(b):bigint>\r\n+struct<CAST(udf(cast((a + b) as string)) AS INT):int,CAST(udf(cast(count(b) as string)) AS BIGINT):bigint>\r\n -- !query 10 output\r\n 2\t1\r\n 3\t2\r\n@@ -105,7 +105,7 @@ NULL\t1\r\n \r\n \r\n -- !query 11\r\n-SELECT a + 2, COUNT(b) FROM testData GROUP BY a + 1\r\n+SELECT udf(a + 2), udf(COUNT(b)) FROM testData GROUP BY a + 1\r\n -- !query 11 schema\r\n struct<>\r\n -- !query 11 output\r\n@@ -114,37 +114,35 @@ expression 'testdata.`a`' is neither present in the group by, nor is it an aggre\r\n \r\n \r\n -- !query 12\r\n-SELECT a + 1 + 1, COUNT(b) FROM testData GROUP BY a + 1\r\n+SELECT udf(a + 1 + 1), udf(COUNT(b)) FROM testData GROUP BY udf(a + 1)\r\n -- !query 12 schema\r\n-struct<((a + 1) + 1):int,count(b):bigint>\r\n+struct<>\r\n -- !query 12 output\r\n-3\t2\r\n-4\t2\r\n-5\t2\r\n-NULL\t1\r\n+org.apache.spark.sql.AnalysisException\r\n+expression 'testdata.`a`' is neither present in the group by, nor is it an aggregate function. Add to group by or wrap in first() (or first_value) if you don't care which value you get.;\r\n \r\n \r\n -- !query 13\r\n-SELECT SKEWNESS(a), KURTOSIS(a), MIN(a), MAX(a), AVG(a), VARIANCE(a), STDDEV(a), SUM(a), COUNT(a)\r\n+SELECT SKEWNESS(udf(a)), udf(KURTOSIS(a)), udf(MIN(a)), MAX(udf(a)), udf(AVG(udf(a))), udf(VARIANCE(a)), STDDEV(udf(a)), udf(SUM(a)), udf(COUNT(a))\r\n FROM testData\r\n -- !query 13 schema\r\n-struct<skewness(CAST(a AS DOUBLE)):double,kurtosis(CAST(a AS DOUBLE)):double,min(a):int,max(a):int,avg(a):double,var_samp(CAST(a AS DOUBLE)):double,stddev_samp(CAST(a AS DOUBLE)):double,sum(a):bigint,count(a):bigint>\r\n+struct<skewness(CAST(CAST(udf(cast(a as string)) AS INT) AS DOUBLE)):double,CAST(udf(cast(kurtosis(cast(a as double)) as string)) AS DOUBLE):double,CAST(udf(cast(min(a) as string)) AS INT):int,max(CAST(udf(cast(a as string)) AS INT)):int,CAST(udf(cast(avg(cast(cast(udf(cast(a as string)) as int) as bigint)) as string)) AS DOUBLE):double,CAST(udf(cast(var_samp(cast(a as double)) as string)) AS DOUBLE):double,stddev_samp(CAST(CAST(udf(cast(a as string)) AS INT) AS DOUBLE)):double,CAST(udf(cast(sum(cast(a as bigint)) as string)) AS BIGINT):bigint,CAST(udf(cast(count(a) as string)) AS BIGINT):bigint>\r\n -- !query 13 output\r\n -0.2723801058145729\t-1.5069204152249134\t1\t3\t2.142857142857143\t0.8095238095238094\t0.8997354108424372\t15\t7\r\n \r\n \r\n -- !query 14\r\n-SELECT COUNT(DISTINCT b), COUNT(DISTINCT b, c) FROM (SELECT 1 AS a, 2 AS b, 3 AS c) GROUP BY a\r\n+SELECT COUNT(DISTINCT udf(b)), udf(COUNT(DISTINCT b, c)) FROM (SELECT 1 AS a, 2 AS b, 3 AS c) GROUP BY a\r\n -- !query 14 schema\r\n-struct<count(DISTINCT b):bigint,count(DISTINCT b, c):bigint>\r\n+struct<count(DISTINCT CAST(udf(cast(b as string)) AS INT)):bigint,CAST(udf(cast(count(distinct b, c) as string)) AS BIGINT):bigint>\r\n -- !query 14 output\r\n 1\t1\r\n \r\n \r\n -- !query 15\r\n-SELECT a AS k, COUNT(b) FROM testData GROUP BY k\r\n+SELECT a AS k, COUNT(udf(b)) FROM testData GROUP BY k\r\n -- !query 15 schema\r\n-struct<k:int,count(b):bigint>\r\n+struct<k:int,count(CAST(udf(cast(b as string)) AS INT)):bigint>\r\n -- !query 15 output\r\n 1\t2\r\n 2\t2\r\n@@ -153,21 +151,21 @@ NULL\t1\r\n \r\n \r\n -- !query 16\r\n-SELECT a AS k, COUNT(b) FROM testData GROUP BY k HAVING k > 1\r\n+SELECT a AS k, udf(COUNT(b)) FROM testData GROUP BY k HAVING k > 1\r\n -- !query 16 schema\r\n-struct<k:int,count(b):bigint>\r\n+struct<k:int,CAST(udf(cast(count(b) as string)) AS BIGINT):bigint>\r\n -- !query 16 output\r\n 2\t2\r\n 3\t2\r\n \r\n \r\n -- !query 17\r\n-SELECT COUNT(b) AS k FROM testData GROUP BY k\r\n+SELECT udf(COUNT(b)) AS k FROM testData GROUP BY k\r\n -- !query 17 schema\r\n struct<>\r\n -- !query 17 output\r\n org.apache.spark.sql.AnalysisException\r\n-aggregate functions are not allowed in GROUP BY, but found count(testdata.`b`);\r\n+aggregate functions are not allowed in GROUP BY, but found CAST(udf(cast(count(b) as string)) AS BIGINT);\r\n \r\n \r\n -- !query 18\r\n@@ -180,7 +178,7 @@ struct<>\r\n \r\n \r\n -- !query 19\r\n-SELECT k AS a, COUNT(v) FROM testDataHasSameNameWithAlias GROUP BY a\r\n+SELECT k AS a, udf(COUNT(udf(v))) FROM testDataHasSameNameWithAlias GROUP BY a\r\n -- !query 19 schema\r\n struct<>\r\n -- !query 19 output\r\n@@ -197,32 +195,32 @@ spark.sql.groupByAliases\tfalse\r\n \r\n \r\n -- !query 21\r\n-SELECT a AS k, COUNT(b) FROM testData GROUP BY k\r\n+SELECT a AS k, udf(COUNT(udf(b))) FROM testData GROUP BY k\r\n -- !query 21 schema\r\n struct<>\r\n -- !query 21 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve '`k`' given input columns: [testdata.a, testdata.b]; line 1 pos 47\r\n+cannot resolve '`k`' given input columns: [testdata.a, testdata.b]; line 1 pos 57\r\n \r\n \r\n -- !query 22\r\n-SELECT a, COUNT(1) FROM testData WHERE false GROUP BY a\r\n+SELECT a, COUNT(udf(1)) FROM testData WHERE false GROUP BY a\r\n -- !query 22 schema\r\n-struct<a:int,count(1):bigint>\r\n+struct<a:int,count(CAST(udf(cast(1 as string)) AS INT)):bigint>\r\n -- !query 22 output\r\n \r\n \r\n \r\n -- !query 23\r\n-SELECT COUNT(1) FROM testData WHERE false\r\n+SELECT udf(COUNT(1)) FROM testData WHERE false\r\n -- !query 23 schema\r\n-struct<count(1):bigint>\r\n+struct<CAST(udf(cast(count(1) as string)) AS BIGINT):bigint>\r\n -- !query 23 output\r\n 0\r\n \r\n \r\n -- !query 24\r\n-SELECT 1 FROM (SELECT COUNT(1) FROM testData WHERE false) t\r\n+SELECT 1 FROM (SELECT udf(COUNT(1)) FROM testData WHERE false) t\r\n -- !query 24 schema\r\n struct<1:int>\r\n -- !query 24 output\r\n@@ -232,7 +230,7 @@ struct<1:int>\r\n -- !query 25\r\n SELECT 1 from (\r\n   SELECT 1 AS z,\r\n-  MIN(a.x)\r\n+  udf(MIN(a.x))\r\n   FROM (select 1 as x) a\r\n   WHERE false\r\n ) b\r\n@@ -244,32 +242,32 @@ struct<1:int>\r\n \r\n \r\n -- !query 26\r\n-SELECT corr(DISTINCT x, y), corr(DISTINCT y, x), count(*)\r\n+SELECT corr(DISTINCT x, y), udf(corr(DISTINCT y, x)), count(*)\r\n   FROM (VALUES (1, 1), (2, 2), (2, 2)) t(x, y)\r\n -- !query 26 schema\r\n-struct<corr(DISTINCT CAST(x AS DOUBLE), CAST(y AS DOUBLE)):double,corr(DISTINCT CAST(y AS DOUBLE), CAST(x AS DOUBLE)):double,count(1):bigint>\r\n+struct<corr(DISTINCT CAST(x AS DOUBLE), CAST(y AS DOUBLE)):double,CAST(udf(cast(corr(distinct cast(y as double), cast(x as double)) as string)) AS DOUBLE):double,count(1):bigint>\r\n -- !query 26 output\r\n 1.0\t1.0\t3\r\n \r\n \r\n -- !query 27\r\n-SELECT 1 FROM range(10) HAVING true\r\n+SELECT udf(1) FROM range(10) HAVING true\r\n -- !query 27 schema\r\n-struct<1:int>\r\n+struct<CAST(udf(cast(1 as string)) AS INT):int>\r\n -- !query 27 output\r\n 1\r\n \r\n \r\n -- !query 28\r\n-SELECT 1 FROM range(10) HAVING MAX(id) > 0\r\n+SELECT udf(udf(1)) FROM range(10) HAVING MAX(id) > 0\r\n -- !query 28 schema\r\n-struct<1:int>\r\n+struct<CAST(udf(cast(cast(udf(cast(1 as string)) as int) as string)) AS INT):int>\r\n -- !query 28 output\r\n 1\r\n \r\n \r\n -- !query 29\r\n-SELECT id FROM range(10) HAVING id > 0\r\n+SELECT udf(id) FROM range(10) HAVING id > 0\r\n -- !query 29 schema\r\n struct<>\r\n -- !query 29 output\r\n@@ -291,33 +289,33 @@ struct<>\r\n \r\n \r\n -- !query 31\r\n-SELECT every(v), some(v), any(v) FROM test_agg WHERE 1 = 0\r\n+SELECT udf(every(v)), udf(some(v)), any(v) FROM test_agg WHERE 1 = 0\r\n -- !query 31 schema\r\n-struct<every(v):boolean,some(v):boolean,any(v):boolean>\r\n+struct<CAST(udf(cast(every(v) as string)) AS BOOLEAN):boolean,CAST(udf(cast(some(v) as string)) AS BOOLEAN):boolean,any(v):boolean>\r\n -- !query 31 output\r\n NULL\tNULL\tNULL\r\n \r\n \r\n -- !query 32\r\n-SELECT every(v), some(v), any(v) FROM test_agg WHERE k = 4\r\n+SELECT udf(every(udf(v))), some(v), any(v) FROM test_agg WHERE k = 4\r\n -- !query 32 schema\r\n-struct<every(v):boolean,some(v):boolean,any(v):boolean>\r\n+struct<CAST(udf(cast(every(cast(udf(cast(v as string)) as boolean)) as string)) AS BOOLEAN):boolean,some(v):boolean,any(v):boolean>\r\n -- !query 32 output\r\n NULL\tNULL\tNULL\r\n \r\n \r\n -- !query 33\r\n-SELECT every(v), some(v), any(v) FROM test_agg WHERE k = 5\r\n+SELECT every(v), udf(some(v)), any(v) FROM test_agg WHERE k = 5\r\n -- !query 33 schema\r\n-struct<every(v):boolean,some(v):boolean,any(v):boolean>\r\n+struct<every(v):boolean,CAST(udf(cast(some(v) as string)) AS BOOLEAN):boolean,any(v):boolean>\r\n -- !query 33 output\r\n false\ttrue\ttrue\r\n \r\n \r\n -- !query 34\r\n-SELECT k, every(v), some(v), any(v) FROM test_agg GROUP BY k\r\n+SELECT k, every(v), udf(some(v)), any(v) FROM test_agg GROUP BY k\r\n -- !query 34 schema\r\n-struct<k:int,every(v):boolean,some(v):boolean,any(v):boolean>\r\n+struct<k:int,every(v):boolean,CAST(udf(cast(some(v) as string)) AS BOOLEAN):boolean,any(v):boolean>\r\n -- !query 34 output\r\n 1\tfalse\ttrue\ttrue\r\n 2\ttrue\ttrue\ttrue\r\n@@ -327,9 +325,9 @@ struct<k:int,every(v):boolean,some(v):boolean,any(v):boolean>\r\n \r\n \r\n -- !query 35\r\n-SELECT k, every(v) FROM test_agg GROUP BY k HAVING every(v) = false\r\n+SELECT udf(k), every(v) FROM test_agg GROUP BY k HAVING every(v) = false\r\n -- !query 35 schema\r\n-struct<k:int,every(v):boolean>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,every(v):boolean>\r\n -- !query 35 output\r\n 1\tfalse\r\n 3\tfalse\r\n@@ -337,16 +335,16 @@ struct<k:int,every(v):boolean>\r\n \r\n \r\n -- !query 36\r\n-SELECT k, every(v) FROM test_agg GROUP BY k HAVING every(v) IS NULL\r\n+SELECT k, udf(every(v)) FROM test_agg GROUP BY k HAVING every(v) IS NULL\r\n -- !query 36 schema\r\n-struct<k:int,every(v):boolean>\r\n+struct<k:int,CAST(udf(cast(every(v) as string)) AS BOOLEAN):boolean>\r\n -- !query 36 output\r\n 4\tNULL\r\n \r\n \r\n -- !query 37\r\n SELECT k,\r\n-       Every(v) AS every\r\n+       udf(Every(v)) AS every\r\n FROM   test_agg\r\n WHERE  k = 2\r\n        AND v IN (SELECT Any(v)\r\n@@ -360,7 +358,7 @@ struct<k:int,every:boolean>\r\n \r\n \r\n -- !query 38\r\n-SELECT k,\r\n+SELECT udf(udf(k)),\r\n        Every(v) AS every\r\n FROM   test_agg\r\n WHERE  k = 2\r\n@@ -369,45 +367,45 @@ WHERE  k = 2\r\n                  WHERE  k = 1)\r\n GROUP  BY k\r\n -- !query 38 schema\r\n-struct<k:int,every:boolean>\r\n+struct<CAST(udf(cast(cast(udf(cast(k as string)) as int) as string)) AS INT):int,every:boolean>\r\n -- !query 38 output\r\n \r\n \r\n \r\n -- !query 39\r\n-SELECT every(1)\r\n+SELECT every(udf(1))\r\n -- !query 39 schema\r\n struct<>\r\n -- !query 39 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve 'every(1)' due to data type mismatch: Input to function 'every' should have been boolean, but it's [int].; line 1 pos 7\r\n+cannot resolve 'every(CAST(udf(cast(1 as string)) AS INT))' due to data type mismatch: Input to function 'every' should have been boolean, but it's [int].; line 1 pos 7\r\n \r\n \r\n -- !query 40\r\n-SELECT some(1S)\r\n+SELECT some(udf(1S))\r\n -- !query 40 schema\r\n struct<>\r\n -- !query 40 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve 'some(1S)' due to data type mismatch: Input to function 'some' should have been boolean, but it's [smallint].; line 1 pos 7\r\n+cannot resolve 'some(CAST(udf(cast(1 as string)) AS SMALLINT))' due to data type mismatch: Input to function 'some' should have been boolean, but it's [smallint].; line 1 pos 7\r\n \r\n \r\n -- !query 41\r\n-SELECT any(1L)\r\n+SELECT any(udf(1L))\r\n -- !query 41 schema\r\n struct<>\r\n -- !query 41 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve 'any(1L)' due to data type mismatch: Input to function 'any' should have been boolean, but it's [bigint].; line 1 pos 7\r\n+cannot resolve 'any(CAST(udf(cast(1 as string)) AS BIGINT))' due to data type mismatch: Input to function 'any' should have been boolean, but it's [bigint].; line 1 pos 7\r\n \r\n \r\n -- !query 42\r\n-SELECT every(\"true\")\r\n+SELECT udf(every(\"true\"))\r\n -- !query 42 schema\r\n struct<>\r\n -- !query 42 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve 'every('true')' due to data type mismatch: Input to function 'every' should have been boolean, but it's [string].; line 1 pos 7\r\n+cannot resolve 'every('true')' due to data type mismatch: Input to function 'every' should have been boolean, but it's [string].; line 1 pos 11\r\n \r\n \r\n -- !query 43\r\n@@ -428,9 +426,9 @@ struct<k:int,v:boolean,every(v) OVER (PARTITION BY k ORDER BY v ASC NULLS FIRST\r\n \r\n \r\n -- !query 44\r\n-SELECT k, v, some(v) OVER (PARTITION BY k ORDER BY v) FROM test_agg\r\n+SELECT k, udf(udf(v)), some(v) OVER (PARTITION BY k ORDER BY v) FROM test_agg\r\n -- !query 44 schema\r\n-struct<k:int,v:boolean,some(v) OVER (PARTITION BY k ORDER BY v ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW):boolean>\r\n+struct<k:int,CAST(udf(cast(cast(udf(cast(v as string)) as boolean) as string)) AS BOOLEAN):boolean,some(v) OVER (PARTITION BY k ORDER BY v ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW):boolean>\r\n -- !query 44 output\r\n 1\tfalse\tfalse\r\n 1\ttrue\ttrue\r\n@@ -445,9 +443,9 @@ struct<k:int,v:boolean,some(v) OVER (PARTITION BY k ORDER BY v ASC NULLS FIRST R\r\n \r\n \r\n -- !query 45\r\n-SELECT k, v, any(v) OVER (PARTITION BY k ORDER BY v) FROM test_agg\r\n+SELECT udf(udf(k)), v, any(v) OVER (PARTITION BY k ORDER BY v) FROM test_agg\r\n -- !query 45 schema\r\n-struct<k:int,v:boolean,any(v) OVER (PARTITION BY k ORDER BY v ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW):boolean>\r\n+struct<CAST(udf(cast(cast(udf(cast(k as string)) as int) as string)) AS INT):int,v:boolean,any(v) OVER (PARTITION BY k ORDER BY v ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW):boolean>\r\n -- !query 45 output\r\n 1\tfalse\tfalse\r\n 1\ttrue\ttrue\r\n@@ -462,17 +460,17 @@ struct<k:int,v:boolean,any(v) OVER (PARTITION BY k ORDER BY v ASC NULLS FIRST RA\r\n \r\n \r\n -- !query 46\r\n-SELECT count(*) FROM test_agg HAVING count(*) > 1L\r\n+SELECT udf(count(*)) FROM test_agg HAVING count(*) > 1L\r\n -- !query 46 schema\r\n-struct<count(1):bigint>\r\n+struct<CAST(udf(cast(count(1) as string)) AS BIGINT):bigint>\r\n -- !query 46 output\r\n 10\r\n \r\n \r\n -- !query 47\r\n-SELECT k, max(v) FROM test_agg GROUP BY k HAVING max(v) = true\r\n+SELECT k, udf(max(v)) FROM test_agg GROUP BY k HAVING max(v) = true\r\n -- !query 47 schema\r\n-struct<k:int,max(v):boolean>\r\n+struct<k:int,CAST(udf(cast(max(v) as string)) AS BOOLEAN):boolean>\r\n -- !query 47 output\r\n 1\ttrue\r\n 2\ttrue\r\n@@ -480,7 +478,7 @@ struct<k:int,max(v):boolean>\r\n \r\n \r\n -- !query 48\r\n-SELECT * FROM (SELECT COUNT(*) AS cnt FROM test_agg) WHERE cnt > 1L\r\n+SELECT * FROM (SELECT udf(COUNT(*)) AS cnt FROM test_agg) WHERE cnt > 1L\r\n -- !query 48 schema\r\n struct<cnt:bigint>\r\n -- !query 48 output\r\n@@ -488,7 +486,7 @@ struct<cnt:bigint>\r\n \r\n \r\n -- !query 49\r\n-SELECT count(*) FROM test_agg WHERE count(*) > 1L\r\n+SELECT udf(count(*)) FROM test_agg WHERE count(*) > 1L\r\n -- !query 49 schema\r\n struct<>\r\n -- !query 49 output\r\n@@ -500,7 +498,7 @@ Invalid expressions: [count(1)];\r\n \r\n \r\n -- !query 50\r\n-SELECT count(*) FROM test_agg WHERE count(*) + 1L > 1L\r\n+SELECT udf(count(*)) FROM test_agg WHERE count(*) + 1L > 1L\r\n -- !query 50 schema\r\n struct<>\r\n -- !query 50 output\r\n@@ -512,7 +510,7 @@ Invalid expressions: [count(1)];\r\n \r\n \r\n -- !query 51\r\n-SELECT count(*) FROM test_agg WHERE k = 1 or k = 2 or count(*) + 1L > 1L or max(k) > 1\r\n+SELECT udf(count(*)) FROM test_agg WHERE k = 1 or k = 2 or count(*) + 1L > 1L or max(k) > 1\r\n -- !query 51 schema\r\n struct<>\r\n -- !query 51 output\r\n\r\n\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\nVerified pandas & pyarrow versions:\r\n```$python3\r\nPython 3.6.8 (default, Jan 14 2019, 11:02:34) \r\n[GCC 8.0.1 20180414 (experimental) [trunk revision 259383]] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import pandas\r\n>>> import pyarrow\r\n>>> pyarrow.__version__\r\n'0.14.0'\r\n>>> pandas.__version__\r\n'0.24.2'\r\n```\r\nFrom the sql output it seems that sql statements are evaluated correctly given that udf returns a string and may change results as Null will be returned as None and will be counted in returned values.\r\n","created_at":"2019-07-10T12:40:37Z","updated_at":"2019-07-22T13:46:30Z","closed_at":"2019-07-22T13:46:30Z","merged_at":null,"merge_commit_sha":"db966fc8d50acfc070f71e7674ba7d69a1f5e87f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25098/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25098/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25098/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9dc5aa12cfd0783fb75876611bad4bb054a6d819","head":{"label":"skonto:group-by.sql","ref":"group-by.sql","sha":"9dc5aa12cfd0783fb75876611bad4bb054a6d819","user":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":48892104,"node_id":"MDEwOlJlcG9zaXRvcnk0ODg5MjEwNA==","name":"spark","full_name":"skonto/spark","private":false,"owner":{"login":"skonto","id":7945591,"node_id":"MDQ6VXNlcjc5NDU1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7945591?v=4","gravatar_id":"","url":"https://api.github.com/users/skonto","html_url":"https://github.com/skonto","followers_url":"https://api.github.com/users/skonto/followers","following_url":"https://api.github.com/users/skonto/following{/other_user}","gists_url":"https://api.github.com/users/skonto/gists{/gist_id}","starred_url":"https://api.github.com/users/skonto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skonto/subscriptions","organizations_url":"https://api.github.com/users/skonto/orgs","repos_url":"https://api.github.com/users/skonto/repos","events_url":"https://api.github.com/users/skonto/events{/privacy}","received_events_url":"https://api.github.com/users/skonto/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/skonto/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/skonto/spark","forks_url":"https://api.github.com/repos/skonto/spark/forks","keys_url":"https://api.github.com/repos/skonto/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/skonto/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/skonto/spark/teams","hooks_url":"https://api.github.com/repos/skonto/spark/hooks","issue_events_url":"https://api.github.com/repos/skonto/spark/issues/events{/number}","events_url":"https://api.github.com/repos/skonto/spark/events","assignees_url":"https://api.github.com/repos/skonto/spark/assignees{/user}","branches_url":"https://api.github.com/repos/skonto/spark/branches{/branch}","tags_url":"https://api.github.com/repos/skonto/spark/tags","blobs_url":"https://api.github.com/repos/skonto/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/skonto/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/skonto/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/skonto/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/skonto/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/skonto/spark/languages","stargazers_url":"https://api.github.com/repos/skonto/spark/stargazers","contributors_url":"https://api.github.com/repos/skonto/spark/contributors","subscribers_url":"https://api.github.com/repos/skonto/spark/subscribers","subscription_url":"https://api.github.com/repos/skonto/spark/subscription","commits_url":"https://api.github.com/repos/skonto/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/skonto/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/skonto/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/skonto/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/skonto/spark/contents/{+path}","compare_url":"https://api.github.com/repos/skonto/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/skonto/spark/merges","archive_url":"https://api.github.com/repos/skonto/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/skonto/spark/downloads","issues_url":"https://api.github.com/repos/skonto/spark/issues{/number}","pulls_url":"https://api.github.com/repos/skonto/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/skonto/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/skonto/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/skonto/spark/labels{/name}","releases_url":"https://api.github.com/repos/skonto/spark/releases{/id}","deployments_url":"https://api.github.com/repos/skonto/spark/deployments","created_at":"2016-01-01T23:02:52Z","updated_at":"2023-10-13T14:17:45Z","pushed_at":"2023-10-13T14:15:23Z","git_url":"git://github.com/skonto/spark.git","ssh_url":"git@github.com:skonto/spark.git","clone_url":"https://github.com/skonto/spark.git","svn_url":"https://github.com/skonto/spark","homepage":null,"size":395104,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"e3f7ca37db0a63653f2e87f19442e8e84ced51cd","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25098"},"html":{"href":"https://github.com/apache/spark/pull/25098"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25098"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25098/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25098/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25098/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9dc5aa12cfd0783fb75876611bad4bb054a6d819"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25097","id":296147912,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2MTQ3OTEy","html_url":"https://github.com/apache/spark/pull/25097","diff_url":"https://github.com/apache/spark/pull/25097.diff","patch_url":"https://github.com/apache/spark/pull/25097.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25097","number":25097,"state":"closed","locked":false,"title":"[SPARK-28015][SQL] Check stringToDate() consumes entire input for the yyyy and yyyy-[m]m formats","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nFix `stringToDate()` for the formats `yyyy` and `yyyy-[m]m` that assumes there are no additional chars after the last components `yyyy` and `[m]m`. In the PR, I propose to check that entire input was consumed for the formats.\r\n\r\nAfter the fix, the input `1999 08 01` will be invalid because it matches to the pattern `yyyy` but the strings contains additional chars ` 08 01`.\r\n\r\nSince Spark 1.6.3 ~ 2.4.3, the behavior is the same.\r\n```\r\nspark-sql> SELECT CAST('1999 08 01' AS DATE);\r\n1999-01-01\r\n```\r\n\r\nThis PR makes it return NULL like Hive.\r\n```\r\nspark-sql> SELECT CAST('1999 08 01' AS DATE);\r\nNULL\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nAdded new checks to `DateTimeUtilsSuite` for the `1999 08 01` and `1999 08` inputs.\r\n","created_at":"2019-07-10T12:20:45Z","updated_at":"2019-09-18T15:58:12Z","closed_at":"2019-07-11T01:15:29Z","merged_at":null,"merge_commit_sha":"d64f66046397409daee8e18c839f52494343bdb7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25097/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25097/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25097/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2ee26df049dc0ad6a4bbf3c72007c274970a2853","head":{"label":"MaxGekk:spark-28015-invalid-date-format","ref":"spark-28015-invalid-date-format","sha":"2ee26df049dc0ad6a4bbf3c72007c274970a2853","user":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":123690489,"node_id":"MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=","name":"spark","full_name":"MaxGekk/spark","private":false,"owner":{"login":"MaxGekk","id":1580697,"node_id":"MDQ6VXNlcjE1ODA2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1580697?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxGekk","html_url":"https://github.com/MaxGekk","followers_url":"https://api.github.com/users/MaxGekk/followers","following_url":"https://api.github.com/users/MaxGekk/following{/other_user}","gists_url":"https://api.github.com/users/MaxGekk/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxGekk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxGekk/subscriptions","organizations_url":"https://api.github.com/users/MaxGekk/orgs","repos_url":"https://api.github.com/users/MaxGekk/repos","events_url":"https://api.github.com/users/MaxGekk/events{/privacy}","received_events_url":"https://api.github.com/users/MaxGekk/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/MaxGekk/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/MaxGekk/spark","forks_url":"https://api.github.com/repos/MaxGekk/spark/forks","keys_url":"https://api.github.com/repos/MaxGekk/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/MaxGekk/spark/teams","hooks_url":"https://api.github.com/repos/MaxGekk/spark/hooks","issue_events_url":"https://api.github.com/repos/MaxGekk/spark/issues/events{/number}","events_url":"https://api.github.com/repos/MaxGekk/spark/events","assignees_url":"https://api.github.com/repos/MaxGekk/spark/assignees{/user}","branches_url":"https://api.github.com/repos/MaxGekk/spark/branches{/branch}","tags_url":"https://api.github.com/repos/MaxGekk/spark/tags","blobs_url":"https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/MaxGekk/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/MaxGekk/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/MaxGekk/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/MaxGekk/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/MaxGekk/spark/languages","stargazers_url":"https://api.github.com/repos/MaxGekk/spark/stargazers","contributors_url":"https://api.github.com/repos/MaxGekk/spark/contributors","subscribers_url":"https://api.github.com/repos/MaxGekk/spark/subscribers","subscription_url":"https://api.github.com/repos/MaxGekk/spark/subscription","commits_url":"https://api.github.com/repos/MaxGekk/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/MaxGekk/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/MaxGekk/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/MaxGekk/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/MaxGekk/spark/contents/{+path}","compare_url":"https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/MaxGekk/spark/merges","archive_url":"https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/MaxGekk/spark/downloads","issues_url":"https://api.github.com/repos/MaxGekk/spark/issues{/number}","pulls_url":"https://api.github.com/repos/MaxGekk/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/MaxGekk/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/MaxGekk/spark/labels{/name}","releases_url":"https://api.github.com/repos/MaxGekk/spark/releases{/id}","deployments_url":"https://api.github.com/repos/MaxGekk/spark/deployments","created_at":"2018-03-03T12:37:00Z","updated_at":"2025-02-07T09:44:52Z","pushed_at":"2025-02-07T09:44:24Z","git_url":"git://github.com/MaxGekk/spark.git","ssh_url":"git@github.com:MaxGekk/spark.git","clone_url":"https://github.com/MaxGekk/spark.git","svn_url":"https://github.com/MaxGekk/spark","homepage":null,"size":486456,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1b232671a8210ed7de5e7e3ce5aecc140db847f2","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25097"},"html":{"href":"https://github.com/apache/spark/pull/25097"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25097"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25097/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25097/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25097/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2ee26df049dc0ad6a4bbf3c72007c274970a2853"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25096","id":296142099,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2MTQyMDk5","html_url":"https://github.com/apache/spark/pull/25096","diff_url":"https://github.com/apache/spark/pull/25096.diff","patch_url":"https://github.com/apache/spark/pull/25096.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25096","number":25096,"state":"closed","locked":false,"title":"[SPARK-28334][SQL][TEST] Port select.sql","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR is to port select.sql from PostgreSQL regression tests. https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/sql/select.sql\r\n\r\nThe expected results can be found in the link: https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/expected/select.out\r\n\r\nWhen porting the test cases, found four PostgreSQL specific features that do not exist in Spark SQL:\r\n[SPARK-28010](https://issues.apache.org/jira/browse/SPARK-28010): Support ORDER BY ... USING syntax\r\n[SPARK-28329](https://issues.apache.org/jira/browse/SPARK-28329): Support SELECT INTO syntax\r\n[SPARK-28330](https://issues.apache.org/jira/browse/SPARK-28330): Enhance query limit\r\n[SPARK-28296](https://issues.apache.org/jira/browse/SPARK-28296): Improved VALUES support\r\n\r\nAlso, found one inconsistent behavior:\r\n[SPARK-28333](https://issues.apache.org/jira/browse/SPARK-28333): `NULLS FIRST` for `DESC` and `NULLS LAST` for `ASC`\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-10T12:04:17Z","updated_at":"2019-07-11T23:19:44Z","closed_at":"2019-07-11T20:58:50Z","merged_at":null,"merge_commit_sha":"868d269a0a813f66fb9d5287c104c42d63d6864b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25096/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25096/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25096/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/092bba95543c861146bafbd6a529913e353a4d51","head":{"label":"wangyum:SPARK-28334","ref":"SPARK-28334","sha":"092bba95543c861146bafbd6a529913e353a4d51","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"1b232671a8210ed7de5e7e3ce5aecc140db847f2","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25096"},"html":{"href":"https://github.com/apache/spark/pull/25096"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25096"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25096/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25096/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25096/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/092bba95543c861146bafbd6a529913e353a4d51"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25095","id":296102594,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2MTAyNTk0","html_url":"https://github.com/apache/spark/pull/25095","diff_url":"https://github.com/apache/spark/pull/25095.diff","patch_url":"https://github.com/apache/spark/pull/25095.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25095","number":25095,"state":"closed","locked":false,"title":"[SPARK-28332][SQL] SQLMetric wrong initValue","user":{"login":"windpiger","id":12979185,"node_id":"MDQ6VXNlcjEyOTc5MTg1","avatar_url":"https://avatars.githubusercontent.com/u/12979185?v=4","gravatar_id":"","url":"https://api.github.com/users/windpiger","html_url":"https://github.com/windpiger","followers_url":"https://api.github.com/users/windpiger/followers","following_url":"https://api.github.com/users/windpiger/following{/other_user}","gists_url":"https://api.github.com/users/windpiger/gists{/gist_id}","starred_url":"https://api.github.com/users/windpiger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windpiger/subscriptions","organizations_url":"https://api.github.com/users/windpiger/orgs","repos_url":"https://api.github.com/users/windpiger/repos","events_url":"https://api.github.com/users/windpiger/events{/privacy}","received_events_url":"https://api.github.com/users/windpiger/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nCurrently SQLMetrics.createSizeMetric create a SQLMetric with initValue set to -1.\r\n\r\nIf there is a ShuffleMapStage with lots of Tasks which read 0 bytes data, these tasks will send the metric(the metric value still be the initValue with -1) to Driver,  then Driver do metric merge for this Stage in DAGScheduler.updateAccumulators, this will cause the merged metric value of this Stage set to be a negative value. \r\n\r\nThis is incorrect， we should set the initValue to 0 .\r\n\r\nAnother same case in SQLMetrics.createTimingMetric/createNanoTimingMetric\r\n\r\n## How was this patch tested?\r\nNo more tests","created_at":"2019-07-10T10:08:48Z","updated_at":"2019-12-26T04:10:26Z","closed_at":"2019-12-26T04:10:26Z","merged_at":null,"merge_commit_sha":"e21e65fd8bcae6ae80764c1b3df96e1306ab1061","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25095/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25095/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25095/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5cc78fb90bca1f087dce20f887bcaa706df76335","head":{"label":"windpiger:sqlmetric-initvalue","ref":"sqlmetric-initvalue","sha":"5cc78fb90bca1f087dce20f887bcaa706df76335","user":{"login":"windpiger","id":12979185,"node_id":"MDQ6VXNlcjEyOTc5MTg1","avatar_url":"https://avatars.githubusercontent.com/u/12979185?v=4","gravatar_id":"","url":"https://api.github.com/users/windpiger","html_url":"https://github.com/windpiger","followers_url":"https://api.github.com/users/windpiger/followers","following_url":"https://api.github.com/users/windpiger/following{/other_user}","gists_url":"https://api.github.com/users/windpiger/gists{/gist_id}","starred_url":"https://api.github.com/users/windpiger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windpiger/subscriptions","organizations_url":"https://api.github.com/users/windpiger/orgs","repos_url":"https://api.github.com/users/windpiger/repos","events_url":"https://api.github.com/users/windpiger/events{/privacy}","received_events_url":"https://api.github.com/users/windpiger/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":70575274,"node_id":"MDEwOlJlcG9zaXRvcnk3MDU3NTI3NA==","name":"spark","full_name":"windpiger/spark","private":false,"owner":{"login":"windpiger","id":12979185,"node_id":"MDQ6VXNlcjEyOTc5MTg1","avatar_url":"https://avatars.githubusercontent.com/u/12979185?v=4","gravatar_id":"","url":"https://api.github.com/users/windpiger","html_url":"https://github.com/windpiger","followers_url":"https://api.github.com/users/windpiger/followers","following_url":"https://api.github.com/users/windpiger/following{/other_user}","gists_url":"https://api.github.com/users/windpiger/gists{/gist_id}","starred_url":"https://api.github.com/users/windpiger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windpiger/subscriptions","organizations_url":"https://api.github.com/users/windpiger/orgs","repos_url":"https://api.github.com/users/windpiger/repos","events_url":"https://api.github.com/users/windpiger/events{/privacy}","received_events_url":"https://api.github.com/users/windpiger/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/windpiger/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/windpiger/spark","forks_url":"https://api.github.com/repos/windpiger/spark/forks","keys_url":"https://api.github.com/repos/windpiger/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/windpiger/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/windpiger/spark/teams","hooks_url":"https://api.github.com/repos/windpiger/spark/hooks","issue_events_url":"https://api.github.com/repos/windpiger/spark/issues/events{/number}","events_url":"https://api.github.com/repos/windpiger/spark/events","assignees_url":"https://api.github.com/repos/windpiger/spark/assignees{/user}","branches_url":"https://api.github.com/repos/windpiger/spark/branches{/branch}","tags_url":"https://api.github.com/repos/windpiger/spark/tags","blobs_url":"https://api.github.com/repos/windpiger/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/windpiger/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/windpiger/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/windpiger/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/windpiger/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/windpiger/spark/languages","stargazers_url":"https://api.github.com/repos/windpiger/spark/stargazers","contributors_url":"https://api.github.com/repos/windpiger/spark/contributors","subscribers_url":"https://api.github.com/repos/windpiger/spark/subscribers","subscription_url":"https://api.github.com/repos/windpiger/spark/subscription","commits_url":"https://api.github.com/repos/windpiger/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/windpiger/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/windpiger/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/windpiger/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/windpiger/spark/contents/{+path}","compare_url":"https://api.github.com/repos/windpiger/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/windpiger/spark/merges","archive_url":"https://api.github.com/repos/windpiger/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/windpiger/spark/downloads","issues_url":"https://api.github.com/repos/windpiger/spark/issues{/number}","pulls_url":"https://api.github.com/repos/windpiger/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/windpiger/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/windpiger/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/windpiger/spark/labels{/name}","releases_url":"https://api.github.com/repos/windpiger/spark/releases{/id}","deployments_url":"https://api.github.com/repos/windpiger/spark/deployments","created_at":"2016-10-11T08:59:56Z","updated_at":"2019-07-10T10:07:26Z","pushed_at":"2019-09-24T01:53:29Z","git_url":"git://github.com/windpiger/spark.git","ssh_url":"git@github.com:windpiger/spark.git","clone_url":"https://github.com/windpiger/spark.git","svn_url":"https://github.com/windpiger/spark","homepage":null,"size":304262,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1b232671a8210ed7de5e7e3ce5aecc140db847f2","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25095"},"html":{"href":"https://github.com/apache/spark/pull/25095"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25095"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25095/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25095/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25095/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5cc78fb90bca1f087dce20f887bcaa706df76335"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25094","id":296101696,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2MTAxNjk2","html_url":"https://github.com/apache/spark/pull/25094","diff_url":"https://github.com/apache/spark/pull/25094.diff","patch_url":"https://github.com/apache/spark/pull/25094.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25094","number":25094,"state":"closed","locked":false,"title":"[SPARK-28331][SQL] Catalogs.load() should be able to load built-in catalogs","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nIn `Catalogs.load`, the `pluginClassName` in the following code \r\n```\r\nString pluginClassName = conf.getConfString(\"spark.sql.catalog.\" + name, null);\r\n```\r\nis always null for built-in catalogs, e.g there is a SQLConf entry `spark.sql.catalog.session`.\r\n\r\nThis is because of https://github.com/apache/spark/pull/18852: SQLConf.conf.getConfString(key, null) always returns null.\r\n\r\n## How was this patch tested?\r\n\r\nApply code changes of https://github.com/apache/spark/pull/24768 and tried loading session catalog.\r\n","created_at":"2019-07-10T10:06:27Z","updated_at":"2019-08-07T23:19:25Z","closed_at":"2019-08-07T23:19:25Z","merged_at":null,"merge_commit_sha":"4d45bd224e298ef4a182e209355b94b82aacc5e4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25094/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25094/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25094/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/fdf9d352f2ec5e489405fbdfe37a5cf102a1aea5","head":{"label":"gengliangwang:fixCatalogLoad","ref":"fixCatalogLoad","sha":"fdf9d352f2ec5e489405fbdfe37a5cf102a1aea5","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1b232671a8210ed7de5e7e3ce5aecc140db847f2","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25094"},"html":{"href":"https://github.com/apache/spark/pull/25094"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25094"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25094/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25094/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25094/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/fdf9d352f2ec5e489405fbdfe37a5cf102a1aea5"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25093","id":296028584,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2MDI4NTg0","html_url":"https://github.com/apache/spark/pull/25093","diff_url":"https://github.com/apache/spark/pull/25093.diff","patch_url":"https://github.com/apache/spark/pull/25093.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25093","number":25093,"state":"closed","locked":false,"title":"[SPARK-28281][SQL][PYTHON][TESTS]Convert and port 'having.sql' into UDF test base","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n\r\n## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from having.sql to test UDFs following the combination guide in [SPARK-27921](url)\r\n<details><summary>Diff comparing to 'having.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/having.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-having.sql.out\r\nindex d87ee52216..7cea2e5128 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/having.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-having.sql.out\r\n@@ -16,34 +16,34 @@ struct<>\r\n \r\n \r\n -- !query 1\r\n-SELECT k, sum(v) FROM hav GROUP BY k HAVING sum(v) > 2\r\n+SELECT udf(k) AS k, udf(sum(v)) FROM hav GROUP BY k HAVING udf(sum(v)) > 2\r\n -- !query 1 schema\r\n-struct<k:string,sum(v):bigint>\r\n+struct<k:string,udf(sum(cast(v as bigint))):string>\r\n -- !query 1 output\r\n one    6\r\n three  3\r\n \r\n \r\n -- !query 2\r\n-SELECT count(k) FROM hav GROUP BY v + 1 HAVING v + 1 = 2\r\n+SELECT udf(count(udf(k))) FROM hav GROUP BY v + 1 HAVING v + 1 = udf(2)\r\n -- !query 2 schema\r\n-struct<count(k):bigint>\r\n+struct<udf(count(udf(k))):string>\r\n -- !query 2 output\r\n 1\r\n \r\n \r\n -- !query 3\r\n-SELECT MIN(t.v) FROM (SELECT * FROM hav WHERE v > 0) t HAVING(COUNT(1) > 0)\r\n+SELECT udf(MIN(t.v)) FROM (SELECT * FROM hav WHERE v > 0) t HAVING(udf(COUNT(udf(1))) > 0)\r\n -- !query 3 schema\r\n-struct<min(v):int>\r\n+struct<udf(min(v)):string>\r\n -- !query 3 output\r\n 1\r\n \r\n \r\n -- !query 4\r\n-SELECT a + b FROM VALUES (1L, 2), (3L, 4) AS T(a, b) GROUP BY a + b HAVING a + b > 1\r\n+SELECT udf(a + b) FROM VALUES (1L, 2), (3L, 4) AS T(a, b) GROUP BY a + b HAVING a + b > udf(1)\r\n -- !query 4 schema\r\n-struct<(a + CAST(b AS BIGINT)):bigint>\r\n+struct<udf((a + cast(b as bigint))):string>\r\n -- !query 4 output\r\n 3\r\n 7\r\n\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in SPARK-27921.","created_at":"2019-07-10T06:36:23Z","updated_at":"2019-07-11T01:02:16Z","closed_at":"2019-07-11T01:02:16Z","merged_at":null,"merge_commit_sha":"58bf9151d39cce59a5cda7ccfacfea2cdc4b0966","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25093/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25093/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25093/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/27836b16651ed40977bd38c620686605fd714487","head":{"label":"huaxingao:spark-28281","ref":"spark-28281","sha":"27836b16651ed40977bd38c620686605fd714487","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":50813048,"node_id":"MDEwOlJlcG9zaXRvcnk1MDgxMzA0OA==","name":"spark","full_name":"huaxingao/spark","private":false,"owner":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/huaxingao/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/huaxingao/spark","forks_url":"https://api.github.com/repos/huaxingao/spark/forks","keys_url":"https://api.github.com/repos/huaxingao/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/huaxingao/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/huaxingao/spark/teams","hooks_url":"https://api.github.com/repos/huaxingao/spark/hooks","issue_events_url":"https://api.github.com/repos/huaxingao/spark/issues/events{/number}","events_url":"https://api.github.com/repos/huaxingao/spark/events","assignees_url":"https://api.github.com/repos/huaxingao/spark/assignees{/user}","branches_url":"https://api.github.com/repos/huaxingao/spark/branches{/branch}","tags_url":"https://api.github.com/repos/huaxingao/spark/tags","blobs_url":"https://api.github.com/repos/huaxingao/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/huaxingao/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/huaxingao/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/huaxingao/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/huaxingao/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/huaxingao/spark/languages","stargazers_url":"https://api.github.com/repos/huaxingao/spark/stargazers","contributors_url":"https://api.github.com/repos/huaxingao/spark/contributors","subscribers_url":"https://api.github.com/repos/huaxingao/spark/subscribers","subscription_url":"https://api.github.com/repos/huaxingao/spark/subscription","commits_url":"https://api.github.com/repos/huaxingao/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/huaxingao/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/huaxingao/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/huaxingao/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/huaxingao/spark/contents/{+path}","compare_url":"https://api.github.com/repos/huaxingao/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/huaxingao/spark/merges","archive_url":"https://api.github.com/repos/huaxingao/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/huaxingao/spark/downloads","issues_url":"https://api.github.com/repos/huaxingao/spark/issues{/number}","pulls_url":"https://api.github.com/repos/huaxingao/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/huaxingao/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/huaxingao/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/huaxingao/spark/labels{/name}","releases_url":"https://api.github.com/repos/huaxingao/spark/releases{/id}","deployments_url":"https://api.github.com/repos/huaxingao/spark/deployments","created_at":"2016-02-01T04:09:11Z","updated_at":"2022-01-06T22:35:11Z","pushed_at":"2023-12-21T02:21:07Z","git_url":"git://github.com/huaxingao/spark.git","ssh_url":"git@github.com:huaxingao/spark.git","clone_url":"https://github.com/huaxingao/spark.git","svn_url":"https://github.com/huaxingao/spark","homepage":null,"size":376946,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1b232671a8210ed7de5e7e3ce5aecc140db847f2","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25093"},"html":{"href":"https://github.com/apache/spark/pull/25093"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25093"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25093/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25093/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25093/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/27836b16651ed40977bd38c620686605fd714487"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25092","id":296013704,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2MDEzNzA0","html_url":"https://github.com/apache/spark/pull/25092","diff_url":"https://github.com/apache/spark/pull/25092.diff","patch_url":"https://github.com/apache/spark/pull/25092.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25092","number":25092,"state":"closed","locked":false,"title":"[SPARK-28312][SQL][TEST] Port numeric.sql","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR is to port numeric.sql from PostgreSQL regression tests. https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/sql/numeric.sql\r\n\r\nThe expected results can be found in the link: https://github.com/postgres/postgres/blob/REL_12_BETA2/src/test/regress/expected/numeric.out\r\n\r\nWhen porting the test cases, found four PostgreSQL specific features that do not exist in Spark SQL:\r\n[SPARK-28315](https://issues.apache.org/jira/browse/SPARK-28315): Decimal can not accept `NaN` as input\r\n[SPARK-28317](https://issues.apache.org/jira/browse/SPARK-28317): Built-in Mathematical Functions: SCALE\r\n[SPARK-28318](https://issues.apache.org/jira/browse/SPARK-28318): Decimal can only support precision up to 38\r\n[SPARK-28322](https://issues.apache.org/jira/browse/SPARK-28322): DIV support decimal type\r\n\r\nAlso, found four inconsistent behavior:\r\n[SPARK-28316](https://issues.apache.org/jira/browse/SPARK-28316): Decimal precision issue\r\n[SPARK-28324](https://issues.apache.org/jira/browse/SPARK-28324): The LOG function using 10 as the base, but Spark using E\r\n[SPARK-27923](https://issues.apache.org/jira/browse/SPARK-27923): Spark SQL insert bad inputs to NULL\r\n[SPARK-28007](https://issues.apache.org/jira/browse/SPARK-28007):  Caret operator (^) means bitwise XOR in Spark/Hive and exponentiation in Postgres\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-10T05:33:06Z","updated_at":"2019-07-18T23:14:24Z","closed_at":"2019-07-18T20:54:20Z","merged_at":null,"merge_commit_sha":"60991bd830c3bff0faf5c95b5b4f4a0018cb3827","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25092/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25092/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25092/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e146292df5ce029fe36cd9f82e45018a8be82e49","head":{"label":"wangyum:SPARK-28312","ref":"SPARK-28312","sha":"e146292df5ce029fe36cd9f82e45018a8be82e49","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"72cc85309221e8b24684333470dee44a555fca2b","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25092"},"html":{"href":"https://github.com/apache/spark/pull/25092"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25092"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25092/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25092/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25092/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e146292df5ce029fe36cd9f82e45018a8be82e49"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25091","id":296000209,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk2MDAwMjA5","html_url":"https://github.com/apache/spark/pull/25091","diff_url":"https://github.com/apache/spark/pull/25091.diff","patch_url":"https://github.com/apache/spark/pull/25091.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25091","number":25091,"state":"closed","locked":false,"title":"[SPARK-28323][SQL][Python] PythonUDF should be able to use in join condition","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThere is a bug in `ExtractPythonUDFs` that produces wrong result attributes. It causes a failure when using `PythonUDF`s among multiple child plans, e.g., join. An example is using `PythonUDF`s in join condition.\r\n\r\n```python                                                                \r\n>>> left = spark.createDataFrame([Row(a=1, a1=1, a2=1), Row(a=2, a1=2, a2=2)])                                                                                                                                                                                                                      \r\n>>> right = spark.createDataFrame([Row(b=1, b1=1, b2=1), Row(b=1, b1=3, b2=1)])                                                                       \r\n>>> f = udf(lambda a: a, IntegerType())                                                                                                               \r\n>>> df = left.join(right, [f(\"a\") == f(\"b\"), left.a1 == right.b1])                                                \r\n>>> df.collect()                                                                                                                                      \r\n19/07/10 12:20:49 ERROR Executor: Exception in task 5.0 in stage 0.0 (TID 5)                                                                                                                                                 \r\njava.lang.ArrayIndexOutOfBoundsException: 1                                                                                                           \r\n        at org.apache.spark.sql.catalyst.expressions.GenericInternalRow.genericGet(rows.scala:201)                                                    \r\n        at org.apache.spark.sql.catalyst.expressions.BaseGenericInternalRow.getAs(rows.scala:35)               \r\n        at org.apache.spark.sql.catalyst.expressions.BaseGenericInternalRow.isNullAt(rows.scala:36)               \r\n        at org.apache.spark.sql.catalyst.expressions.BaseGenericInternalRow.isNullAt$(rows.scala:36)                             \r\n        at org.apache.spark.sql.catalyst.expressions.GenericInternalRow.isNullAt(rows.scala:195)\r\n        at org.apache.spark.sql.catalyst.expressions.JoinedRow.isNullAt(JoinedRow.scala:70)\r\n        ...\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nAdded test.\r\n","created_at":"2019-07-10T04:19:26Z","updated_at":"2023-12-27T18:36:35Z","closed_at":"2019-07-10T23:35:05Z","merged_at":null,"merge_commit_sha":"e3c6fc46d4a1b926e404b8dee16ab40289bf6cb2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25091/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25091/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25091/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/fbf8be959429871176fd82b3797ca19d3571fa15","head":{"label":"viirya:SPARK-28323","ref":"SPARK-28323","sha":"fbf8be959429871176fd82b3797ca19d3571fa15","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1b232671a8210ed7de5e7e3ce5aecc140db847f2","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25091"},"html":{"href":"https://github.com/apache/spark/pull/25091"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25091"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25091/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25091/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25091/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/fbf8be959429871176fd82b3797ca19d3571fa15"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25090","id":295990443,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1OTkwNDQz","html_url":"https://github.com/apache/spark/pull/25090","diff_url":"https://github.com/apache/spark/pull/25090.diff","patch_url":"https://github.com/apache/spark/pull/25090.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25090","number":25090,"state":"closed","locked":false,"title":"[SPARK-28278][SQL][PYTHON][TESTS] Convert and port 'except-all.sql' into UDF test base","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from `except-all.sql` to test UDFs. Please see contribution guide of this umbrella ticket - [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n\r\n<details><summary>Diff comparing to 'except-all.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/except-all.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-except-all.sql.out\r\nindex 01091a2f75..b7bfad0e53 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/except-all.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-except-all.sql.out\r\n@@ -49,11 +49,11 @@ struct<>\r\n \r\n \r\n -- !query 4\r\n-SELECT * FROM tab1\r\n+SELECT udf(c1) FROM tab1\r\n EXCEPT ALL\r\n-SELECT * FROM tab2\r\n+SELECT udf(c1) FROM tab2\r\n -- !query 4 schema\r\n-struct<c1:int>\r\n+struct<CAST(udf(cast(c1 as string)) AS INT):int>\r\n -- !query 4 output\r\n 0\r\n 2\r\n@@ -62,11 +62,11 @@ NULL\r\n \r\n \r\n -- !query 5\r\n-SELECT * FROM tab1\r\n+SELECT udf(c1) FROM tab1\r\n MINUS ALL\r\n-SELECT * FROM tab2\r\n+SELECT udf(c1) FROM tab2\r\n -- !query 5 schema\r\n-struct<c1:int>\r\n+struct<CAST(udf(cast(c1 as string)) AS INT):int>\r\n -- !query 5 output\r\n 0\r\n 2\r\n@@ -75,11 +75,11 @@ NULL\r\n \r\n \r\n -- !query 6\r\n-SELECT * FROM tab1\r\n+SELECT udf(c1) FROM tab1\r\n EXCEPT ALL\r\n-SELECT * FROM tab2 WHERE c1 IS NOT NULL\r\n+SELECT udf(c1) FROM tab2 WHERE udf(c1) IS NOT NULL\r\n -- !query 6 schema\r\n-struct<c1:int>\r\n+struct<CAST(udf(cast(c1 as string)) AS INT):int>\r\n -- !query 6 output\r\n 0\r\n 2\r\n@@ -89,21 +89,21 @@ NULL\r\n \r\n \r\n -- !query 7\r\n-SELECT * FROM tab1 WHERE c1 > 5\r\n+SELECT udf(c1) FROM tab1 WHERE udf(c1) > 5\r\n EXCEPT ALL\r\n-SELECT * FROM tab2\r\n+SELECT udf(c1) FROM tab2\r\n -- !query 7 schema\r\n-struct<c1:int>\r\n+struct<CAST(udf(cast(c1 as string)) AS INT):int>\r\n -- !query 7 output\r\n \r\n \r\n \r\n -- !query 8\r\n-SELECT * FROM tab1\r\n+SELECT udf(c1) FROM tab1\r\n EXCEPT ALL\r\n-SELECT * FROM tab2 WHERE c1 > 6\r\n+SELECT udf(c1) FROM tab2 WHERE udf(c1 > udf(6))\r\n -- !query 8 schema\r\n-struct<c1:int>\r\n+struct<CAST(udf(cast(c1 as string)) AS INT):int>\r\n -- !query 8 output\r\n 0\r\n 1\r\n@@ -117,11 +117,11 @@ NULL\r\n \r\n \r\n -- !query 9\r\n-SELECT * FROM tab1\r\n+SELECT udf(c1) FROM tab1\r\n EXCEPT ALL\r\n-SELECT CAST(1 AS BIGINT)\r\n+SELECT CAST(udf(1) AS BIGINT)\r\n -- !query 9 schema\r\n-struct<c1:bigint>\r\n+struct<CAST(udf(cast(c1 as string)) AS INT):bigint>\r\n -- !query 9 output\r\n 0\r\n 2\r\n@@ -134,7 +134,7 @@ NULL\r\n \r\n \r\n -- !query 10\r\n-SELECT * FROM tab1\r\n+SELECT udf(c1) FROM tab1\r\n EXCEPT ALL\r\n SELECT array(1)\r\n -- !query 10 schema\r\n@@ -145,62 +145,62 @@ ExceptAll can only be performed on tables with the compatible column types. arra\r\n \r\n \r\n -- !query 11\r\n-SELECT * FROM tab3\r\n+SELECT udf(k), v FROM tab3\r\n EXCEPT ALL\r\n-SELECT * FROM tab4\r\n+SELECT k, udf(v) FROM tab4\r\n -- !query 11 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,v:int>\r\n -- !query 11 output\r\n 1\t2\r\n 1\t3\r\n \r\n \r\n -- !query 12\r\n-SELECT * FROM tab4\r\n+SELECT k, udf(v) FROM tab4\r\n EXCEPT ALL\r\n-SELECT * FROM tab3\r\n+SELECT udf(k), v FROM tab3\r\n -- !query 12 schema\r\n-struct<k:int,v:int>\r\n+struct<k:int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 12 output\r\n 2\t2\r\n 2\t20\r\n \r\n \r\n -- !query 13\r\n-SELECT * FROM tab4\r\n+SELECT udf(k), udf(v) FROM tab4\r\n EXCEPT ALL\r\n-SELECT * FROM tab3\r\n+SELECT udf(k), udf(v) FROM tab3\r\n INTERSECT DISTINCT\r\n-SELECT * FROM tab4\r\n+SELECT udf(k), udf(v) FROM tab4\r\n -- !query 13 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 13 output\r\n 2\t2\r\n 2\t20\r\n \r\n \r\n -- !query 14\r\n-SELECT * FROM tab4\r\n+SELECT udf(k), v FROM tab4\r\n EXCEPT ALL\r\n-SELECT * FROM tab3\r\n+SELECT k, udf(v) FROM tab3\r\n EXCEPT DISTINCT\r\n-SELECT * FROM tab4\r\n+SELECT udf(k), udf(v) FROM tab4\r\n -- !query 14 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,v:int>\r\n -- !query 14 output\r\n \r\n \r\n \r\n -- !query 15\r\n-SELECT * FROM tab3\r\n+SELECT k, udf(v) FROM tab3\r\n EXCEPT ALL\r\n-SELECT * FROM tab4\r\n+SELECT udf(k), udf(v) FROM tab4\r\n UNION ALL\r\n-SELECT * FROM tab3\r\n+SELECT udf(k), v FROM tab3\r\n EXCEPT DISTINCT\r\n-SELECT * FROM tab4\r\n+SELECT k, udf(v) FROM tab4\r\n -- !query 15 schema\r\n-struct<k:int,v:int>\r\n+struct<k:int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 15 output\r\n 1\t3\r\n \r\n@@ -217,83 +217,83 @@ ExceptAll can only be performed on tables with the same number of columns, but t\r\n \r\n \r\n -- !query 17\r\n-SELECT * FROM tab3\r\n+SELECT udf(k), udf(v) FROM tab3\r\n EXCEPT ALL\r\n-SELECT * FROM tab4\r\n+SELECT udf(k), udf(v) FROM tab4\r\n UNION\r\n-SELECT * FROM tab3\r\n+SELECT udf(k), udf(v) FROM tab3\r\n EXCEPT DISTINCT\r\n-SELECT * FROM tab4\r\n+SELECT udf(k), udf(v) FROM tab4\r\n -- !query 17 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 17 output\r\n 1\t3\r\n \r\n \r\n -- !query 18\r\n-SELECT * FROM tab3\r\n+SELECT udf(k), udf(v) FROM tab3\r\n MINUS ALL\r\n-SELECT * FROM tab4\r\n+SELECT k, udf(v) FROM tab4\r\n UNION\r\n-SELECT * FROM tab3\r\n+SELECT udf(k), udf(v) FROM tab3\r\n MINUS DISTINCT\r\n-SELECT * FROM tab4\r\n+SELECT k, udf(v) FROM tab4\r\n -- !query 18 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(k as string)) AS INT):int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 18 output\r\n 1\t3\r\n \r\n \r\n -- !query 19\r\n-SELECT * FROM tab3\r\n+SELECT k, udf(v) FROM tab3\r\n EXCEPT ALL\r\n-SELECT * FROM tab4\r\n+SELECT udf(k), v FROM tab4\r\n EXCEPT DISTINCT\r\n-SELECT * FROM tab3\r\n+SELECT k, udf(v) FROM tab3\r\n EXCEPT DISTINCT\r\n-SELECT * FROM tab4\r\n+SELECT udf(k), v FROM tab4\r\n -- !query 19 schema\r\n-struct<k:int,v:int>\r\n+struct<k:int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 19 output\r\n \r\n \r\n \r\n -- !query 20\r\n SELECT * \r\n-FROM   (SELECT tab3.k, \r\n-               tab4.v \r\n+FROM   (SELECT tab3.k,\r\n+               udf(tab4.v)\r\n         FROM   tab3 \r\n                JOIN tab4 \r\n-                 ON tab3.k = tab4.k)\r\n+                 ON udf(tab3.k) = tab4.k)\r\n EXCEPT ALL \r\n SELECT * \r\n-FROM   (SELECT tab3.k, \r\n-               tab4.v \r\n+FROM   (SELECT udf(tab3.k),\r\n+               tab4.v\r\n         FROM   tab3 \r\n                JOIN tab4 \r\n-                 ON tab3.k = tab4.k)\r\n+                 ON tab3.k = udf(tab4.k))\r\n -- !query 20 schema\r\n-struct<k:int,v:int>\r\n+struct<k:int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 20 output\r\n \r\n \r\n \r\n -- !query 21\r\n SELECT * \r\n-FROM   (SELECT tab3.k, \r\n-               tab4.v \r\n+FROM   (SELECT udf(udf(tab3.k)),\r\n+               udf(tab4.v)\r\n         FROM   tab3 \r\n                JOIN tab4 \r\n-                 ON tab3.k = tab4.k) \r\n+                 ON udf(udf(tab3.k)) = udf(tab4.k))\r\n EXCEPT ALL \r\n SELECT * \r\n-FROM   (SELECT tab4.v AS k, \r\n-               tab3.k AS v \r\n+FROM   (SELECT udf(tab4.v) AS k,\r\n+               udf(udf(tab3.k)) AS v\r\n         FROM   tab3 \r\n                JOIN tab4 \r\n-                 ON tab3.k = tab4.k)\r\n+                 ON udf(tab3.k) = udf(tab4.k))\r\n -- !query 21 schema\r\n-struct<k:int,v:int>\r\n+struct<CAST(udf(cast(cast(udf(cast(k as string)) as int) as string)) AS INT):int,CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 21 output\r\n 1\t2\r\n 1\t2\r\n@@ -305,11 +305,11 @@ struct<k:int,v:int>\r\n \r\n \r\n -- !query 22\r\n-SELECT v FROM tab3 GROUP BY v\r\n+SELECT udf(v) FROM tab3 GROUP BY v\r\n EXCEPT ALL\r\n-SELECT k FROM tab4 GROUP BY k\r\n+SELECT udf(k) FROM tab4 GROUP BY k\r\n -- !query 22 schema\r\n-struct<v:int>\r\n+struct<CAST(udf(cast(v as string)) AS INT):int>\r\n -- !query 22 output\r\n 3\r\n \r\n\r\n```\r\n</p>\r\n</details> \r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).","created_at":"2019-07-10T03:18:11Z","updated_at":"2019-07-18T10:54:42Z","closed_at":"2019-07-18T10:54:42Z","merged_at":null,"merge_commit_sha":"69a79a53386a968cb727c4079c68725b6e43ad31","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25090/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25090/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25090/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2c8cc194fb6552cebe6cd1333cb88374c4a156a8","head":{"label":"imback82:except-all","ref":"except-all","sha":"2c8cc194fb6552cebe6cd1333cb88374c4a156a8","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":190453549,"node_id":"MDEwOlJlcG9zaXRvcnkxOTA0NTM1NDk=","name":"spark-4","full_name":"imback82/spark-4","private":false,"owner":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/imback82/spark-4","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/imback82/spark-4","forks_url":"https://api.github.com/repos/imback82/spark-4/forks","keys_url":"https://api.github.com/repos/imback82/spark-4/keys{/key_id}","collaborators_url":"https://api.github.com/repos/imback82/spark-4/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/imback82/spark-4/teams","hooks_url":"https://api.github.com/repos/imback82/spark-4/hooks","issue_events_url":"https://api.github.com/repos/imback82/spark-4/issues/events{/number}","events_url":"https://api.github.com/repos/imback82/spark-4/events","assignees_url":"https://api.github.com/repos/imback82/spark-4/assignees{/user}","branches_url":"https://api.github.com/repos/imback82/spark-4/branches{/branch}","tags_url":"https://api.github.com/repos/imback82/spark-4/tags","blobs_url":"https://api.github.com/repos/imback82/spark-4/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/imback82/spark-4/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/imback82/spark-4/git/refs{/sha}","trees_url":"https://api.github.com/repos/imback82/spark-4/git/trees{/sha}","statuses_url":"https://api.github.com/repos/imback82/spark-4/statuses/{sha}","languages_url":"https://api.github.com/repos/imback82/spark-4/languages","stargazers_url":"https://api.github.com/repos/imback82/spark-4/stargazers","contributors_url":"https://api.github.com/repos/imback82/spark-4/contributors","subscribers_url":"https://api.github.com/repos/imback82/spark-4/subscribers","subscription_url":"https://api.github.com/repos/imback82/spark-4/subscription","commits_url":"https://api.github.com/repos/imback82/spark-4/commits{/sha}","git_commits_url":"https://api.github.com/repos/imback82/spark-4/git/commits{/sha}","comments_url":"https://api.github.com/repos/imback82/spark-4/comments{/number}","issue_comment_url":"https://api.github.com/repos/imback82/spark-4/issues/comments{/number}","contents_url":"https://api.github.com/repos/imback82/spark-4/contents/{+path}","compare_url":"https://api.github.com/repos/imback82/spark-4/compare/{base}...{head}","merges_url":"https://api.github.com/repos/imback82/spark-4/merges","archive_url":"https://api.github.com/repos/imback82/spark-4/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/imback82/spark-4/downloads","issues_url":"https://api.github.com/repos/imback82/spark-4/issues{/number}","pulls_url":"https://api.github.com/repos/imback82/spark-4/pulls{/number}","milestones_url":"https://api.github.com/repos/imback82/spark-4/milestones{/number}","notifications_url":"https://api.github.com/repos/imback82/spark-4/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/imback82/spark-4/labels{/name}","releases_url":"https://api.github.com/repos/imback82/spark-4/releases{/id}","deployments_url":"https://api.github.com/repos/imback82/spark-4/deployments","created_at":"2019-06-05T19:09:03Z","updated_at":"2022-01-05T16:28:23Z","pushed_at":"2024-02-20T02:09:15Z","git_url":"git://github.com/imback82/spark-4.git","ssh_url":"git@github.com:imback82/spark-4.git","clone_url":"https://github.com/imback82/spark-4.git","svn_url":"https://github.com/imback82/spark-4","homepage":"","size":412962,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"eb5dc746c250d614d7ebf9b310fe531f154c0fee","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25090"},"html":{"href":"https://github.com/apache/spark/pull/25090"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25090"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25090/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25090/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25090/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2c8cc194fb6552cebe6cd1333cb88374c4a156a8"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25089","id":295987985,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1OTg3OTg1","html_url":"https://github.com/apache/spark/pull/25089","diff_url":"https://github.com/apache/spark/pull/25089.diff","patch_url":"https://github.com/apache/spark/pull/25089.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25089","number":25089,"state":"closed","locked":false,"title":"[SPARK-28275][SQL][PYTHON][TESTS] Convert and port 'count.sql' into UDF test base","user":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from 'count.sql' to test UDFs\r\n\r\n<details><summary>Diff comparing to 'count.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/count.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-count.sql.out\r\nindex b8a86d4c44..9476937abd 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/count.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-count.sql.out\r\n@@ -14,42 +14,42 @@ struct<>\r\n \r\n -- !query 1\r\n SELECT\r\n-  count(*), count(1), count(null), count(a), count(b), count(a + b), count((a, b))\r\n+  udf(count(*)), udf(count(1)), udf(count(null)), udf(count(a)), udf(count(b)), udf(count(a + b)), udf(count((a, b)))\r\n FROM testData\r\n -- !query 1 schema\r\n-struct<count(1):bigint,count(1):bigint,count(NULL):bigint,count(a):bigint,count(b):bigint,count((a + b)):bigint,count(named_struct(a, a, b, b)):bigint>\r\n+struct<udf(count(1)):string,udf(count(1)):string,udf(count(null)):string,udf(count(a)):string,udf(count(b)):string,udf(count((a + b))):string,udf(count(named_struct(a, a, b, b))):string>\r\n -- !query 1 output\r\n 7\t7\t0\t5\t5\t4\t7\r\n \r\n \r\n -- !query 2\r\n SELECT\r\n-  count(DISTINCT 1),\r\n-  count(DISTINCT null),\r\n-  count(DISTINCT a),\r\n-  count(DISTINCT b),\r\n-  count(DISTINCT (a + b)),\r\n-  count(DISTINCT (a, b))\r\n+  udf(count(DISTINCT 1)),\r\n+  udf(count(DISTINCT null)),\r\n+  udf(count(DISTINCT a)),\r\n+  udf(count(DISTINCT b)),\r\n+  udf(count(DISTINCT (a + b))),\r\n+  udf(count(DISTINCT (a, b)))\r\n FROM testData\r\n -- !query 2 schema\r\n-struct<count(DISTINCT 1):bigint,count(DISTINCT NULL):bigint,count(DISTINCT a):bigint,count(DISTINCT b):bigint,count(DISTINCT (a + b)):bigint,count(DISTINCT named_struct(a, a, b, b)):bigint>\r\n+struct<udf(count(distinct 1)):string,udf(count(distinct null)):string,udf(count(distinct a)):string,udf(count(distinct b)):string,udf(count(distinct (a + b))):string,udf(count(distinct named_struct(a, a, b, b))):string>\r\n -- !query 2 output\r\n 1\t0\t2\t2\t2\t6\r\n \r\n \r\n -- !query 3\r\n-SELECT count(a, b), count(b, a), count(testData.*) FROM testData\r\n+SELECT udf(count(a, b)), udf(count(b, a)), udf(count(testData.*)) FROM testData\r\n -- !query 3 schema\r\n-struct<count(a, b):bigint,count(b, a):bigint,count(a, b):bigint>\r\n+struct<udf(count(a, b)):string,udf(count(b, a)):string,udf(count(a, b)):string>\r\n -- !query 3 output\r\n 4\t4\t4\r\n \r\n \r\n -- !query 4\r\n SELECT\r\n-  count(DISTINCT a, b), count(DISTINCT b, a), count(DISTINCT *), count(DISTINCT testData.*)\r\n+  udf(count(DISTINCT a, b)), udf(count(DISTINCT b, a)), udf(count(DISTINCT *)), udf(count(DISTINCT testData.*))\r\n FROM testData\r\n -- !query 4 schema\r\n-struct<count(DISTINCT a, b):bigint,count(DISTINCT b, a):bigint,count(DISTINCT a, b):bigint,count(DISTINCT a, b):bigint>\r\n+struct<udf(count(distinct a, b)):string,udf(count(distinct b, a)):string,udf(count(distinct a, b)):string,udf(count(distinct a, b)):string>\r\n -- !query 4 output\r\n 3\t3\t3\t3\r\n\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in SPARK-27921.","created_at":"2019-07-10T03:02:25Z","updated_at":"2019-07-11T00:43:13Z","closed_at":"2019-07-11T00:43:13Z","merged_at":null,"merge_commit_sha":"d9e0f9077e0f7c867b6b34c5223d7f790c174492","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25089/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25089/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25089/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b173330d416f54c30d327228c21965d3c4457722","head":{"label":"vinodkc:br_Fix_SPARK-28275","ref":"br_Fix_SPARK-28275","sha":"b173330d416f54c30d327228c21965d3c4457722","user":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":86780265,"node_id":"MDEwOlJlcG9zaXRvcnk4Njc4MDI2NQ==","name":"spark","full_name":"vinodkc/spark","private":false,"owner":{"login":"vinodkc","id":9795818,"node_id":"MDQ6VXNlcjk3OTU4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/9795818?v=4","gravatar_id":"","url":"https://api.github.com/users/vinodkc","html_url":"https://github.com/vinodkc","followers_url":"https://api.github.com/users/vinodkc/followers","following_url":"https://api.github.com/users/vinodkc/following{/other_user}","gists_url":"https://api.github.com/users/vinodkc/gists{/gist_id}","starred_url":"https://api.github.com/users/vinodkc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinodkc/subscriptions","organizations_url":"https://api.github.com/users/vinodkc/orgs","repos_url":"https://api.github.com/users/vinodkc/repos","events_url":"https://api.github.com/users/vinodkc/events{/privacy}","received_events_url":"https://api.github.com/users/vinodkc/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vinodkc/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/vinodkc/spark","forks_url":"https://api.github.com/repos/vinodkc/spark/forks","keys_url":"https://api.github.com/repos/vinodkc/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vinodkc/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vinodkc/spark/teams","hooks_url":"https://api.github.com/repos/vinodkc/spark/hooks","issue_events_url":"https://api.github.com/repos/vinodkc/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vinodkc/spark/events","assignees_url":"https://api.github.com/repos/vinodkc/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vinodkc/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vinodkc/spark/tags","blobs_url":"https://api.github.com/repos/vinodkc/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vinodkc/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vinodkc/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vinodkc/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vinodkc/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vinodkc/spark/languages","stargazers_url":"https://api.github.com/repos/vinodkc/spark/stargazers","contributors_url":"https://api.github.com/repos/vinodkc/spark/contributors","subscribers_url":"https://api.github.com/repos/vinodkc/spark/subscribers","subscription_url":"https://api.github.com/repos/vinodkc/spark/subscription","commits_url":"https://api.github.com/repos/vinodkc/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vinodkc/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vinodkc/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vinodkc/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vinodkc/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vinodkc/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vinodkc/spark/merges","archive_url":"https://api.github.com/repos/vinodkc/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vinodkc/spark/downloads","issues_url":"https://api.github.com/repos/vinodkc/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vinodkc/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vinodkc/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vinodkc/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vinodkc/spark/labels{/name}","releases_url":"https://api.github.com/repos/vinodkc/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vinodkc/spark/deployments","created_at":"2017-03-31T05:10:58Z","updated_at":"2025-01-24T19:30:18Z","pushed_at":"2025-01-24T19:26:51Z","git_url":"git://github.com/vinodkc/spark.git","ssh_url":"git@github.com:vinodkc/spark.git","clone_url":"https://github.com/vinodkc/spark.git","svn_url":"https://github.com/vinodkc/spark","homepage":null,"size":464015,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":3,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a32c92c0cd72046053879416d77510d1c57bafcd","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25089"},"html":{"href":"https://github.com/apache/spark/pull/25089"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25089"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25089/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25089/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25089/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b173330d416f54c30d327228c21965d3c4457722"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25088","id":295960254,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1OTYwMjU0","html_url":"https://github.com/apache/spark/pull/25088","diff_url":"https://github.com/apache/spark/pull/25088.diff","patch_url":"https://github.com/apache/spark/pull/25088.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25088","number":25088,"state":"closed","locked":false,"title":"[SPARK-27922][SQL][PYTHON][TESTS] Convert and port 'natural-join.sql' into UDF test base","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from `natural-join.sql` to test UDFs following the combination guide in  [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n\r\n<details><summary>Diff results comparing to `natural-join.sql`</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/udf/udf-natural-join.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-natural-join.\r\nsql.out\r\nindex 43f2f9a..53ef177 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/udf/udf-natural-join.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-natural-join.sql.out\r\n@@ -27,7 +27,7 @@ struct<>\r\n\r\n\r\n -- !query 2\r\n-SELECT * FROM nt1 natural join nt2 where k = \"one\"\r\n+SELECT * FROM nt1 natural join nt2 where udf(k) = \"one\"\r\n -- !query 2 schema\r\n struct<k:string,v1:int,v2:int>\r\n -- !query 2 output\r\n@@ -36,7 +36,7 @@ one   1       5\r\n\r\n\r\n -- !query 3\r\n-SELECT * FROM nt1 natural left join nt2 order by v1, v2\r\n+SELECT * FROM nt1 natural left join nt2 where k <> udf(\"\") order by v1, v2\r\n -- !query 3 schema\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/udf/udf-natural-join.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/udf-natural-join.\r\nsql.out\r\nindex 43f2f9a..53ef177 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/udf/udf-natural-join.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/udf-natural-join.sql.out\r\n@@ -27,7 +27,7 @@ struct<>\r\n\r\n\r\n -- !query 2\r\n-SELECT * FROM nt1 natural join nt2 where k = \"one\"\r\n+SELECT * FROM nt1 natural join nt2 where udf(k) = \"one\"\r\n -- !query 2 schema\r\n struct<k:string,v1:int,v2:int>\r\n -- !query 2 output\r\n@@ -36,7 +36,7 @@ one   1       5\r\n\r\n\r\n -- !query 3\r\n-SELECT * FROM nt1 natural left join nt2 order by v1, v2\r\n+SELECT * FROM nt1 natural left join nt2 where k <> udf(\"\") order by v1, v2\r\n -- !query 3 schema\r\n struct<k:string,v1:int,v2:int>\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).","created_at":"2019-07-10T00:01:47Z","updated_at":"2019-07-11T00:42:23Z","closed_at":"2019-07-11T00:42:23Z","merged_at":null,"merge_commit_sha":"527e551026c7f1a4b734e44c3e2bb094bfcc75cc","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25088/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25088/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25088/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a20eff0af9047243b16cc7b3d23d491a6e5774b0","head":{"label":"manuzhang:SPARK-27922","ref":"SPARK-27922","sha":"a20eff0af9047243b16cc7b3d23d491a6e5774b0","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":132739917,"node_id":"MDEwOlJlcG9zaXRvcnkxMzI3Mzk5MTc=","name":"spark","full_name":"manuzhang/spark","private":false,"owner":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/manuzhang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/manuzhang/spark","forks_url":"https://api.github.com/repos/manuzhang/spark/forks","keys_url":"https://api.github.com/repos/manuzhang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/manuzhang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/manuzhang/spark/teams","hooks_url":"https://api.github.com/repos/manuzhang/spark/hooks","issue_events_url":"https://api.github.com/repos/manuzhang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/manuzhang/spark/events","assignees_url":"https://api.github.com/repos/manuzhang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/manuzhang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/manuzhang/spark/tags","blobs_url":"https://api.github.com/repos/manuzhang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/manuzhang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/manuzhang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/manuzhang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/manuzhang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/manuzhang/spark/languages","stargazers_url":"https://api.github.com/repos/manuzhang/spark/stargazers","contributors_url":"https://api.github.com/repos/manuzhang/spark/contributors","subscribers_url":"https://api.github.com/repos/manuzhang/spark/subscribers","subscription_url":"https://api.github.com/repos/manuzhang/spark/subscription","commits_url":"https://api.github.com/repos/manuzhang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/manuzhang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/manuzhang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/manuzhang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/manuzhang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/manuzhang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/manuzhang/spark/merges","archive_url":"https://api.github.com/repos/manuzhang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/manuzhang/spark/downloads","issues_url":"https://api.github.com/repos/manuzhang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/manuzhang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/manuzhang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/manuzhang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/manuzhang/spark/labels{/name}","releases_url":"https://api.github.com/repos/manuzhang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/manuzhang/spark/deployments","created_at":"2018-05-09T10:20:51Z","updated_at":"2018-05-09T10:21:17Z","pushed_at":"2024-11-15T02:44:45Z","git_url":"git://github.com/manuzhang/spark.git","ssh_url":"git@github.com:manuzhang/spark.git","clone_url":"https://github.com/manuzhang/spark.git","svn_url":"https://github.com/manuzhang/spark","homepage":null,"size":447024,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a32c92c0cd72046053879416d77510d1c57bafcd","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25088"},"html":{"href":"https://github.com/apache/spark/pull/25088"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25088"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25088/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25088/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25088/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a20eff0af9047243b16cc7b3d23d491a6e5774b0"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25087","id":295868182,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1ODY4MTgy","html_url":"https://github.com/apache/spark/pull/25087","diff_url":"https://github.com/apache/spark/pull/25087.diff","patch_url":"https://github.com/apache/spark/pull/25087.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25087","number":25087,"state":"closed","locked":false,"title":"[SPARK-28234][CORE][PYTHON]  Add python and JavaSparkContext support to get resources","user":{"login":"tgravescs","id":4563792,"node_id":"MDQ6VXNlcjQ1NjM3OTI=","avatar_url":"https://avatars.githubusercontent.com/u/4563792?v=4","gravatar_id":"","url":"https://api.github.com/users/tgravescs","html_url":"https://github.com/tgravescs","followers_url":"https://api.github.com/users/tgravescs/followers","following_url":"https://api.github.com/users/tgravescs/following{/other_user}","gists_url":"https://api.github.com/users/tgravescs/gists{/gist_id}","starred_url":"https://api.github.com/users/tgravescs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tgravescs/subscriptions","organizations_url":"https://api.github.com/users/tgravescs/orgs","repos_url":"https://api.github.com/users/tgravescs/repos","events_url":"https://api.github.com/users/tgravescs/events{/privacy}","received_events_url":"https://api.github.com/users/tgravescs/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nAdd python api support and JavaSparkContext support for resources().  I needed the JavaSparkContext support for it to properly translate into python with the py4j stuff.\r\n\r\n\r\n## How was this patch tested?\r\n\r\nUnit tests added and manually tested in local cluster mode and on yarn.","created_at":"2019-07-09T18:22:57Z","updated_at":"2019-07-11T00:37:48Z","closed_at":"2019-07-11T00:37:48Z","merged_at":null,"merge_commit_sha":"79e4f951956e5c7ca85e908c4f8bc2154301b319","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25087/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25087/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25087/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c4c02f5665921864eaecb0d113577718a6f13006","head":{"label":"tgravescs:SPARK-28234-python","ref":"SPARK-28234-python","sha":"c4c02f5665921864eaecb0d113577718a6f13006","user":{"login":"tgravescs","id":4563792,"node_id":"MDQ6VXNlcjQ1NjM3OTI=","avatar_url":"https://avatars.githubusercontent.com/u/4563792?v=4","gravatar_id":"","url":"https://api.github.com/users/tgravescs","html_url":"https://github.com/tgravescs","followers_url":"https://api.github.com/users/tgravescs/followers","following_url":"https://api.github.com/users/tgravescs/following{/other_user}","gists_url":"https://api.github.com/users/tgravescs/gists{/gist_id}","starred_url":"https://api.github.com/users/tgravescs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tgravescs/subscriptions","organizations_url":"https://api.github.com/users/tgravescs/orgs","repos_url":"https://api.github.com/users/tgravescs/repos","events_url":"https://api.github.com/users/tgravescs/events{/privacy}","received_events_url":"https://api.github.com/users/tgravescs/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":17249522,"node_id":"MDEwOlJlcG9zaXRvcnkxNzI0OTUyMg==","name":"spark","full_name":"tgravescs/spark","private":false,"owner":{"login":"tgravescs","id":4563792,"node_id":"MDQ6VXNlcjQ1NjM3OTI=","avatar_url":"https://avatars.githubusercontent.com/u/4563792?v=4","gravatar_id":"","url":"https://api.github.com/users/tgravescs","html_url":"https://github.com/tgravescs","followers_url":"https://api.github.com/users/tgravescs/followers","following_url":"https://api.github.com/users/tgravescs/following{/other_user}","gists_url":"https://api.github.com/users/tgravescs/gists{/gist_id}","starred_url":"https://api.github.com/users/tgravescs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tgravescs/subscriptions","organizations_url":"https://api.github.com/users/tgravescs/orgs","repos_url":"https://api.github.com/users/tgravescs/repos","events_url":"https://api.github.com/users/tgravescs/events{/privacy}","received_events_url":"https://api.github.com/users/tgravescs/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/tgravescs/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/tgravescs/spark","forks_url":"https://api.github.com/repos/tgravescs/spark/forks","keys_url":"https://api.github.com/repos/tgravescs/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/tgravescs/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/tgravescs/spark/teams","hooks_url":"https://api.github.com/repos/tgravescs/spark/hooks","issue_events_url":"https://api.github.com/repos/tgravescs/spark/issues/events{/number}","events_url":"https://api.github.com/repos/tgravescs/spark/events","assignees_url":"https://api.github.com/repos/tgravescs/spark/assignees{/user}","branches_url":"https://api.github.com/repos/tgravescs/spark/branches{/branch}","tags_url":"https://api.github.com/repos/tgravescs/spark/tags","blobs_url":"https://api.github.com/repos/tgravescs/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/tgravescs/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/tgravescs/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/tgravescs/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/tgravescs/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/tgravescs/spark/languages","stargazers_url":"https://api.github.com/repos/tgravescs/spark/stargazers","contributors_url":"https://api.github.com/repos/tgravescs/spark/contributors","subscribers_url":"https://api.github.com/repos/tgravescs/spark/subscribers","subscription_url":"https://api.github.com/repos/tgravescs/spark/subscription","commits_url":"https://api.github.com/repos/tgravescs/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/tgravescs/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/tgravescs/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/tgravescs/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/tgravescs/spark/contents/{+path}","compare_url":"https://api.github.com/repos/tgravescs/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/tgravescs/spark/merges","archive_url":"https://api.github.com/repos/tgravescs/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/tgravescs/spark/downloads","issues_url":"https://api.github.com/repos/tgravescs/spark/issues{/number}","pulls_url":"https://api.github.com/repos/tgravescs/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/tgravescs/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/tgravescs/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/tgravescs/spark/labels{/name}","releases_url":"https://api.github.com/repos/tgravescs/spark/releases{/id}","deployments_url":"https://api.github.com/repos/tgravescs/spark/deployments","created_at":"2014-02-27T13:26:24Z","updated_at":"2019-12-12T03:01:23Z","pushed_at":"2023-06-22T16:10:25Z","git_url":"git://github.com/tgravescs/spark.git","ssh_url":"git@github.com:tgravescs/spark.git","clone_url":"https://github.com/tgravescs/spark.git","svn_url":"https://github.com/tgravescs/spark","homepage":null,"size":442803,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":2,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"019efaa3751307c757eb8e5823aa0e79b30082d8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25087"},"html":{"href":"https://github.com/apache/spark/pull/25087"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25087"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25087/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25087/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25087/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c4c02f5665921864eaecb0d113577718a6f13006"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25086","id":295867409,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1ODY3NDA5","html_url":"https://github.com/apache/spark/pull/25086","diff_url":"https://github.com/apache/spark/pull/25086.diff","patch_url":"https://github.com/apache/spark/pull/25086.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25086","number":25086,"state":"closed","locked":false,"title":"[SPARK-28271][SQL][PYTHON][TESTS] Convert and port 'pgSQL/aggregates_part2.sql' into UDF test base","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from `pgSQL/aggregates_part2.sql'` to test UDFs. Please see contribution guide of this umbrella ticket - [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n\r\n<details><summary>Diff comparing to 'pgSQL/aggregates_part2.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/pgSQL/aggregates_part2.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part2.sql.out\r\nindex 2606d2eba7..00c06f94b5 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/pgSQL/aggregates_part2.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part2.sql.out\r\n@@ -57,23 +57,23 @@ true        false   true    false   true    true    true    true    true\r\n\r\n\r\n -- !query 3\r\n-select min(unique1) from tenk1\r\n+select min(udf(unique1)) from tenk1\r\n -- !query 3 schema\r\n-struct<min(unique1):int>\r\n+struct<min(udf(unique1)):string>\r\n -- !query 3 output\r\n 0\r\n\r\n\r\n -- !query 4\r\n-select max(unique1) from tenk1\r\n+select udf(max(unique1)) from tenk1\r\n -- !query 4 schema\r\n-struct<max(unique1):int>\r\n+struct<udf(max(unique1)):string>\r\n -- !query 4 output\r\n 9999\r\n\r\n\r\n -- !query 5\r\n-select max(unique1) from tenk1 where unique1 < 42\r\n+select max(unique1) from tenk1 where udf(unique1) < 42\r\n -- !query 5 schema\r\n struct<max(unique1):int>\r\n -- !query 5 output\r\n@@ -81,7 +81,7 @@ struct<max(unique1):int>\r\n\r\n\r\n -- !query 6\r\n-select max(unique1) from tenk1 where unique1 > 42\r\n+select max(unique1) from tenk1 where unique1 > udf(42)\r\n -- !query 6 schema\r\n struct<max(unique1):int>\r\n -- !query 6 output\r\n@@ -89,7 +89,7 @@ struct<max(unique1):int>\r\n\r\n\r\n -- !query 7\r\n-select max(unique1) from tenk1 where unique1 > 42000\r\n+select max(unique1) from tenk1 where udf(unique1) > 42000\r\n -- !query 7 schema\r\n struct<max(unique1):int>\r\n -- !query 7 output\r\n@@ -97,7 +97,7 @@ NULL\r\n\r\n\r\n -- !query 8\r\n-select max(tenthous) from tenk1 where thousand = 33\r\n+select max(tenthous) from tenk1 where udf(thousand) = 33\r\n -- !query 8 schema\r\n struct<max(tenthous):int>\r\n -- !query 8 output\r\n@@ -105,7 +105,7 @@ struct<max(tenthous):int>\r\n\r\n\r\n -- !query 9\r\n-select min(tenthous) from tenk1 where thousand = 33\r\n+select min(tenthous) from tenk1 where udf(thousand) = 33\r\n -- !query 9 schema\r\n struct<min(tenthous):int>\r\n -- !query 9 output\r\n@@ -113,15 +113,15 @@ struct<min(tenthous):int>\r\n\r\n\r\n -- !query 10\r\n-select distinct max(unique2) from tenk1\r\n+select distinct max(udf(unique2)) from tenk1\r\n -- !query 10 schema\r\n-struct<max(unique2):int>\r\n+struct<max(udf(unique2)):string>\r\n -- !query 10 output\r\n 9999\r\n\r\n\r\n -- !query 11\r\n-select max(unique2) from tenk1 order by 1\r\n+select max(unique2) from tenk1 order by udf(1)\r\n -- !query 11 schema\r\n struct<max(unique2):int>\r\n -- !query 11 output\r\n@@ -129,7 +129,7 @@ struct<max(unique2):int>\r\n\r\n -- !query 12\r\n-select max(unique2) from tenk1 order by max(unique2)\r\n+select max(unique2) from tenk1 order by max(udf(unique2))\r\n -- !query 12 schema\r\n struct<max(unique2):int>\r\n -- !query 12 output\r\n@@ -137,7 +137,7 @@ struct<max(unique2):int>\r\n\r\n\r\n -- !query 13\r\n-select max(unique2) from tenk1 order by max(unique2)+1\r\n+select udf(max(udf(unique2))) from tenk1 order by udf(max(unique2))+1\r\n -- !query 13 schema\r\n-struct<max(unique2):int>\r\n+struct<udf(max(udf(unique2))):string>\r\n -- !query 13 output\r\n 9999\r\n\r\n\r\n -- !query 14\r\n-select t1.max_unique2, g from (select max(unique2) as max_unique2 FROM tenk1) t1 LATERAL VIEW explode(array(1,2,3)) t2 AS g order by g desc\r\n+select t1.max_unique2, udf(g) from (select max(udf(unique2)) as max_unique2 FROM tenk1) t1 LATERAL VIEW explode(array(1,2,3)) t2 AS g order by g desc\r\n -- !query 14 schema\r\n-struct<max_unique2:int,g:int>\r\n+struct<max_unique2:string,udf(g):string>\r\n -- !query 14 output\r\n 9999   3\r\n 9999   2\r\n@@ -155,8 +155,8 @@ struct<max_unique2:int,g:int>\r\n\r\n\r\n -- !query 15\r\n-select max(100) from tenk1\r\n+select udf(max(100)) from tenk1\r\n -- !query 15 schema\r\n-struct<max(100):int>\r\n+struct<udf(max(100)):string>\r\n -- !query 15 output\r\n 100\r\n```\r\n\r\n</p>\r\n</details> \r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).","created_at":"2019-07-09T18:20:31Z","updated_at":"2019-07-13T01:41:25Z","closed_at":"2019-07-11T00:50:38Z","merged_at":null,"merge_commit_sha":"79037306f044940d14799e4d19b29063d348994f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25086/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25086/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25086/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0550038260abd9ac975ae6ba8c53087fd33b0bdb","head":{"label":"imback82:udf_test","ref":"udf_test","sha":"0550038260abd9ac975ae6ba8c53087fd33b0bdb","user":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":190453549,"node_id":"MDEwOlJlcG9zaXRvcnkxOTA0NTM1NDk=","name":"spark-4","full_name":"imback82/spark-4","private":false,"owner":{"login":"imback82","id":12103644,"node_id":"MDQ6VXNlcjEyMTAzNjQ0","avatar_url":"https://avatars.githubusercontent.com/u/12103644?v=4","gravatar_id":"","url":"https://api.github.com/users/imback82","html_url":"https://github.com/imback82","followers_url":"https://api.github.com/users/imback82/followers","following_url":"https://api.github.com/users/imback82/following{/other_user}","gists_url":"https://api.github.com/users/imback82/gists{/gist_id}","starred_url":"https://api.github.com/users/imback82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imback82/subscriptions","organizations_url":"https://api.github.com/users/imback82/orgs","repos_url":"https://api.github.com/users/imback82/repos","events_url":"https://api.github.com/users/imback82/events{/privacy}","received_events_url":"https://api.github.com/users/imback82/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/imback82/spark-4","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/imback82/spark-4","forks_url":"https://api.github.com/repos/imback82/spark-4/forks","keys_url":"https://api.github.com/repos/imback82/spark-4/keys{/key_id}","collaborators_url":"https://api.github.com/repos/imback82/spark-4/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/imback82/spark-4/teams","hooks_url":"https://api.github.com/repos/imback82/spark-4/hooks","issue_events_url":"https://api.github.com/repos/imback82/spark-4/issues/events{/number}","events_url":"https://api.github.com/repos/imback82/spark-4/events","assignees_url":"https://api.github.com/repos/imback82/spark-4/assignees{/user}","branches_url":"https://api.github.com/repos/imback82/spark-4/branches{/branch}","tags_url":"https://api.github.com/repos/imback82/spark-4/tags","blobs_url":"https://api.github.com/repos/imback82/spark-4/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/imback82/spark-4/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/imback82/spark-4/git/refs{/sha}","trees_url":"https://api.github.com/repos/imback82/spark-4/git/trees{/sha}","statuses_url":"https://api.github.com/repos/imback82/spark-4/statuses/{sha}","languages_url":"https://api.github.com/repos/imback82/spark-4/languages","stargazers_url":"https://api.github.com/repos/imback82/spark-4/stargazers","contributors_url":"https://api.github.com/repos/imback82/spark-4/contributors","subscribers_url":"https://api.github.com/repos/imback82/spark-4/subscribers","subscription_url":"https://api.github.com/repos/imback82/spark-4/subscription","commits_url":"https://api.github.com/repos/imback82/spark-4/commits{/sha}","git_commits_url":"https://api.github.com/repos/imback82/spark-4/git/commits{/sha}","comments_url":"https://api.github.com/repos/imback82/spark-4/comments{/number}","issue_comment_url":"https://api.github.com/repos/imback82/spark-4/issues/comments{/number}","contents_url":"https://api.github.com/repos/imback82/spark-4/contents/{+path}","compare_url":"https://api.github.com/repos/imback82/spark-4/compare/{base}...{head}","merges_url":"https://api.github.com/repos/imback82/spark-4/merges","archive_url":"https://api.github.com/repos/imback82/spark-4/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/imback82/spark-4/downloads","issues_url":"https://api.github.com/repos/imback82/spark-4/issues{/number}","pulls_url":"https://api.github.com/repos/imback82/spark-4/pulls{/number}","milestones_url":"https://api.github.com/repos/imback82/spark-4/milestones{/number}","notifications_url":"https://api.github.com/repos/imback82/spark-4/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/imback82/spark-4/labels{/name}","releases_url":"https://api.github.com/repos/imback82/spark-4/releases{/id}","deployments_url":"https://api.github.com/repos/imback82/spark-4/deployments","created_at":"2019-06-05T19:09:03Z","updated_at":"2022-01-05T16:28:23Z","pushed_at":"2024-02-20T02:09:15Z","git_url":"git://github.com/imback82/spark-4.git","ssh_url":"git@github.com:imback82/spark-4.git","clone_url":"https://github.com/imback82/spark-4.git","svn_url":"https://github.com/imback82/spark-4","homepage":"","size":412962,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"019efaa3751307c757eb8e5823aa0e79b30082d8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25086"},"html":{"href":"https://github.com/apache/spark/pull/25086"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25086"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25086/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25086/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25086/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0550038260abd9ac975ae6ba8c53087fd33b0bdb"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25085","id":295747505,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1NzQ3NTA1","html_url":"https://github.com/apache/spark/pull/25085","diff_url":"https://github.com/apache/spark/pull/25085.diff","patch_url":"https://github.com/apache/spark/pull/25085.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25085","number":25085,"state":"closed","locked":false,"title":"[SPARK-28313][SQL] Spark sql null type incompatible with hive void type","user":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n [SPARK-20680](https://issues.apache.org/jira/browse/SPARK-20680), [PR](https://github.com/apache/spark/pull/17953), but actually this Jira was not solved. \r\n\r\nSpark is incompatible with hive void type. When table schema contains void type, spark throw exception in ddl option, like desc, show create table..\r\n\r\nAlso, spark catalog.createTable can create NullType Table that is not allowed.\r\n\r\nGoal:\r\n\r\n1. Support hive void column type for `desc`,`show create table` option\r\n2. Add rule to throw exception when catalog.create NullType StructField, see [25198](https://github.com/apache/spark/pull/25198)\r\n\r\n## How was this patch tested?\r\n\r\nUT\r\n","created_at":"2019-07-09T13:11:38Z","updated_at":"2020-01-19T00:06:36Z","closed_at":"2020-01-19T00:06:36Z","merged_at":null,"merge_commit_sha":"6541f612f43e9c3e0b3d19974a8d0d09cc97ee89","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25085/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25085/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25085/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/aa0865815d3e0ef54175b5e598b175b77a5562e8","head":{"label":"ulysses-you:SPARK-28313","ref":"SPARK-28313","sha":"aa0865815d3e0ef54175b5e598b175b77a5562e8","user":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":195747855,"node_id":"MDEwOlJlcG9zaXRvcnkxOTU3NDc4NTU=","name":"spark","full_name":"ulysses-you/spark","private":false,"owner":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ulysses-you/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/ulysses-you/spark","forks_url":"https://api.github.com/repos/ulysses-you/spark/forks","keys_url":"https://api.github.com/repos/ulysses-you/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ulysses-you/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ulysses-you/spark/teams","hooks_url":"https://api.github.com/repos/ulysses-you/spark/hooks","issue_events_url":"https://api.github.com/repos/ulysses-you/spark/issues/events{/number}","events_url":"https://api.github.com/repos/ulysses-you/spark/events","assignees_url":"https://api.github.com/repos/ulysses-you/spark/assignees{/user}","branches_url":"https://api.github.com/repos/ulysses-you/spark/branches{/branch}","tags_url":"https://api.github.com/repos/ulysses-you/spark/tags","blobs_url":"https://api.github.com/repos/ulysses-you/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ulysses-you/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ulysses-you/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ulysses-you/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ulysses-you/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ulysses-you/spark/languages","stargazers_url":"https://api.github.com/repos/ulysses-you/spark/stargazers","contributors_url":"https://api.github.com/repos/ulysses-you/spark/contributors","subscribers_url":"https://api.github.com/repos/ulysses-you/spark/subscribers","subscription_url":"https://api.github.com/repos/ulysses-you/spark/subscription","commits_url":"https://api.github.com/repos/ulysses-you/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ulysses-you/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ulysses-you/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ulysses-you/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ulysses-you/spark/contents/{+path}","compare_url":"https://api.github.com/repos/ulysses-you/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ulysses-you/spark/merges","archive_url":"https://api.github.com/repos/ulysses-you/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ulysses-you/spark/downloads","issues_url":"https://api.github.com/repos/ulysses-you/spark/issues{/number}","pulls_url":"https://api.github.com/repos/ulysses-you/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ulysses-you/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ulysses-you/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ulysses-you/spark/labels{/name}","releases_url":"https://api.github.com/repos/ulysses-you/spark/releases{/id}","deployments_url":"https://api.github.com/repos/ulysses-you/spark/deployments","created_at":"2019-07-08T06:11:57Z","updated_at":"2022-01-10T01:34:59Z","pushed_at":"2024-08-13T23:12:37Z","git_url":"git://github.com/ulysses-you/spark.git","ssh_url":"git@github.com:ulysses-you/spark.git","clone_url":"https://github.com/ulysses-you/spark.git","svn_url":"https://github.com/ulysses-you/spark","homepage":"","size":399300,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"3ea9d6825b64f0f21f066b4f07589c7d2c81bcbd","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25085"},"html":{"href":"https://github.com/apache/spark/pull/25085"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25085"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25085/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25085/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25085/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/aa0865815d3e0ef54175b5e598b175b77a5562e8"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25084","id":295653910,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1NjUzOTEw","html_url":"https://github.com/apache/spark/pull/25084","diff_url":"https://github.com/apache/spark/pull/25084.diff","patch_url":"https://github.com/apache/spark/pull/25084.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25084","number":25084,"state":"closed","locked":false,"title":"[SPARK-28314][SQL] Use the same MemoryManager when building HashedRelation","user":{"login":"cxzl25","id":3898450,"node_id":"MDQ6VXNlcjM4OTg0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/3898450?v=4","gravatar_id":"","url":"https://api.github.com/users/cxzl25","html_url":"https://github.com/cxzl25","followers_url":"https://api.github.com/users/cxzl25/followers","following_url":"https://api.github.com/users/cxzl25/following{/other_user}","gists_url":"https://api.github.com/users/cxzl25/gists{/gist_id}","starred_url":"https://api.github.com/users/cxzl25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cxzl25/subscriptions","organizations_url":"https://api.github.com/users/cxzl25/orgs","repos_url":"https://api.github.com/users/cxzl25/repos","events_url":"https://api.github.com/users/cxzl25/events{/privacy}","received_events_url":"https://api.github.com/users/cxzl25/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nBroadcasting some tables with a large number of rows may cause infinite recursion loop in ```TaskMemoryManager#allocatePage```.\r\nThis is because ```HashedRelation``` uses ```Long.MaxValue``` to construct ```MemoryManager``` instead of memory configured by driver.\r\n```MemoryAllocator#allocate``` throws OOM,```TaskMemoryManager#allocatePage``` captures OOM and continues to call ```allocatePage```.\r\n\r\n## How was this patch tested?\r\nadd UT\r\n","created_at":"2019-07-09T08:58:38Z","updated_at":"2019-12-28T00:07:23Z","closed_at":"2019-12-28T00:07:23Z","merged_at":null,"merge_commit_sha":"45c1739e63d44961543ceb3fb376b95b106e478a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25084/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25084/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25084/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/171a209fd61263525ea1b5d9f6807e91334dccf6","head":{"label":"cxzl25:fix_build_HashedRelation","ref":"fix_build_HashedRelation","sha":"171a209fd61263525ea1b5d9f6807e91334dccf6","user":{"login":"cxzl25","id":3898450,"node_id":"MDQ6VXNlcjM4OTg0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/3898450?v=4","gravatar_id":"","url":"https://api.github.com/users/cxzl25","html_url":"https://github.com/cxzl25","followers_url":"https://api.github.com/users/cxzl25/followers","following_url":"https://api.github.com/users/cxzl25/following{/other_user}","gists_url":"https://api.github.com/users/cxzl25/gists{/gist_id}","starred_url":"https://api.github.com/users/cxzl25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cxzl25/subscriptions","organizations_url":"https://api.github.com/users/cxzl25/orgs","repos_url":"https://api.github.com/users/cxzl25/repos","events_url":"https://api.github.com/users/cxzl25/events{/privacy}","received_events_url":"https://api.github.com/users/cxzl25/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":119043888,"node_id":"MDEwOlJlcG9zaXRvcnkxMTkwNDM4ODg=","name":"spark","full_name":"cxzl25/spark","private":false,"owner":{"login":"cxzl25","id":3898450,"node_id":"MDQ6VXNlcjM4OTg0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/3898450?v=4","gravatar_id":"","url":"https://api.github.com/users/cxzl25","html_url":"https://github.com/cxzl25","followers_url":"https://api.github.com/users/cxzl25/followers","following_url":"https://api.github.com/users/cxzl25/following{/other_user}","gists_url":"https://api.github.com/users/cxzl25/gists{/gist_id}","starred_url":"https://api.github.com/users/cxzl25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cxzl25/subscriptions","organizations_url":"https://api.github.com/users/cxzl25/orgs","repos_url":"https://api.github.com/users/cxzl25/repos","events_url":"https://api.github.com/users/cxzl25/events{/privacy}","received_events_url":"https://api.github.com/users/cxzl25/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cxzl25/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cxzl25/spark","forks_url":"https://api.github.com/repos/cxzl25/spark/forks","keys_url":"https://api.github.com/repos/cxzl25/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cxzl25/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cxzl25/spark/teams","hooks_url":"https://api.github.com/repos/cxzl25/spark/hooks","issue_events_url":"https://api.github.com/repos/cxzl25/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cxzl25/spark/events","assignees_url":"https://api.github.com/repos/cxzl25/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cxzl25/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cxzl25/spark/tags","blobs_url":"https://api.github.com/repos/cxzl25/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cxzl25/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cxzl25/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cxzl25/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cxzl25/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cxzl25/spark/languages","stargazers_url":"https://api.github.com/repos/cxzl25/spark/stargazers","contributors_url":"https://api.github.com/repos/cxzl25/spark/contributors","subscribers_url":"https://api.github.com/repos/cxzl25/spark/subscribers","subscription_url":"https://api.github.com/repos/cxzl25/spark/subscription","commits_url":"https://api.github.com/repos/cxzl25/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cxzl25/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cxzl25/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cxzl25/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cxzl25/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cxzl25/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cxzl25/spark/merges","archive_url":"https://api.github.com/repos/cxzl25/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cxzl25/spark/downloads","issues_url":"https://api.github.com/repos/cxzl25/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cxzl25/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cxzl25/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cxzl25/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cxzl25/spark/labels{/name}","releases_url":"https://api.github.com/repos/cxzl25/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cxzl25/spark/deployments","created_at":"2018-01-26T11:26:14Z","updated_at":"2024-12-27T09:40:45Z","pushed_at":"2025-01-17T03:20:50Z","git_url":"git://github.com/cxzl25/spark.git","ssh_url":"git@github.com:cxzl25/spark.git","clone_url":"https://github.com/cxzl25/spark.git","svn_url":"https://github.com/cxzl25/spark","homepage":null,"size":463865,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"925f620570a022ff8229bfde076e7dde6bf242df","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25084"},"html":{"href":"https://github.com/apache/spark/pull/25084"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25084"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25084/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25084/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25084/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/171a209fd61263525ea1b5d9f6807e91334dccf6"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25083","id":295566674,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1NTY2Njc0","html_url":"https://github.com/apache/spark/pull/25083","diff_url":"https://github.com/apache/spark/pull/25083.diff","patch_url":"https://github.com/apache/spark/pull/25083.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25083","number":25083,"state":"closed","locked":false,"title":"[SPARK-28311][SQL] Fix STS OpenSession failed return wrong origin PROTOCOL_VERSION","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nFor Thrift server, It's downward compatible. Such as if a PROTOCOL_VERSION_V7 client connect to a  PROTOCOL_VERSION_V8 server, when OpenSession, server will change his response's protocol version to min of (client and server).  \r\n`TProtocolVersion protocol = getMinVersion(CLIService.SERVER_VERSION,`\r\n `       req.getClient_protocol());`\r\nthen set it to OpenSession's response.\r\n\r\nBut if OpenSession failed , it won't execute behavior of reset response's protocol_version.\r\nThen it will return server's origin protocol version.\r\nFinally client will get en error as below:\r\n![image](https://user-images.githubusercontent.com/46485123/61023164-54f4b780-a3db-11e9-8c49-60217b36287b.png)\r\nSince we write a wrong database,, OpenSession failed, right protocol version haven't been rest.\r\n\r\n\r\n## How was this patch tested?\r\n\r\nSince I really don't know how to write unit test about this, so I build a jar with this PR,and retry the error above, then it will return a reasonable Error of DB not found :\r\n![image](https://user-images.githubusercontent.com/46485123/61023923-67242500-a3de-11e9-8e98-8f391a038480.png)\r\n\r\n","created_at":"2019-07-09T03:16:24Z","updated_at":"2019-07-17T02:24:11Z","closed_at":"2019-07-15T14:40:25Z","merged_at":null,"merge_commit_sha":"b54f3c33ff5d4ad327f7f94b0cab3a1c08727c27","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25083/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25083/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25083/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8d94dab884bf5d475dafe315d728216fffbf0aa0","head":{"label":"AngersZhuuuu:SPARK-28311","ref":"SPARK-28311","sha":"8d94dab884bf5d475dafe315d728216fffbf0aa0","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":176224753,"node_id":"MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=","name":"spark","full_name":"AngersZhuuuu/spark","private":false,"owner":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/AngersZhuuuu/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/AngersZhuuuu/spark","forks_url":"https://api.github.com/repos/AngersZhuuuu/spark/forks","keys_url":"https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/AngersZhuuuu/spark/teams","hooks_url":"https://api.github.com/repos/AngersZhuuuu/spark/hooks","issue_events_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/AngersZhuuuu/spark/events","assignees_url":"https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/tags","blobs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/AngersZhuuuu/spark/languages","stargazers_url":"https://api.github.com/repos/AngersZhuuuu/spark/stargazers","contributors_url":"https://api.github.com/repos/AngersZhuuuu/spark/contributors","subscribers_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscribers","subscription_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscription","commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/AngersZhuuuu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/AngersZhuuuu/spark/merges","archive_url":"https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/AngersZhuuuu/spark/downloads","issues_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/AngersZhuuuu/spark/labels{/name}","releases_url":"https://api.github.com/repos/AngersZhuuuu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/AngersZhuuuu/spark/deployments","created_at":"2019-03-18T07:13:25Z","updated_at":"2024-12-31T06:48:27Z","pushed_at":"2024-12-31T06:45:23Z","git_url":"git://github.com/AngersZhuuuu/spark.git","ssh_url":"git@github.com:AngersZhuuuu/spark.git","clone_url":"https://github.com/AngersZhuuuu/spark.git","svn_url":"https://github.com/AngersZhuuuu/spark","homepage":"","size":446399,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f15102b1702b64a54233ae31357e32335722f4e5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25083"},"html":{"href":"https://github.com/apache/spark/pull/25083"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25083"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25083/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25083/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25083/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8d94dab884bf5d475dafe315d728216fffbf0aa0"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25082","id":295561673,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1NTYxNjcz","html_url":"https://github.com/apache/spark/pull/25082","diff_url":"https://github.com/apache/spark/pull/25082.diff","patch_url":"https://github.com/apache/spark/pull/25082.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25082","number":25082,"state":"closed","locked":false,"title":"[SPARK-28310][SQL] Support (FIRST_VALUE|LAST_VALUE)(expr[ (IGNORE|RESPECT) NULLS]?) syntax","user":{"login":"lipzhu","id":698621,"node_id":"MDQ6VXNlcjY5ODYyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/698621?v=4","gravatar_id":"","url":"https://api.github.com/users/lipzhu","html_url":"https://github.com/lipzhu","followers_url":"https://api.github.com/users/lipzhu/followers","following_url":"https://api.github.com/users/lipzhu/following{/other_user}","gists_url":"https://api.github.com/users/lipzhu/gists{/gist_id}","starred_url":"https://api.github.com/users/lipzhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lipzhu/subscriptions","organizations_url":"https://api.github.com/users/lipzhu/orgs","repos_url":"https://api.github.com/users/lipzhu/repos","events_url":"https://api.github.com/users/lipzhu/events{/privacy}","received_events_url":"https://api.github.com/users/lipzhu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nAccording to the ANSI SQL 2011 \r\n![image](https://user-images.githubusercontent.com/698621/60855327-d01c6900-a235-11e9-9a1b-d438615a4673.png)\r\n\r\nBelow are Teradata, Oracle, Redshift which already support this grammar.\r\n\r\n- Teradata - https://docs.teradata.com/reader/756LNiPSFdY~4JcCCcR5Cw/SUwCpTupqmlBJvi2mipOaA \r\n- Oracle - https://docs.oracle.com/en/database/oracle/oracle-database/18/sqlrf/FIRST_VALUE.html#GUID-D454EC3F-370C-4C64-9B11-33FCB10D95EC\r\n- Redshift – https://docs.aws.amazon.com/redshift/latest/dg/r_WF_first_value.html\r\n\r\n- Postgresql didn't implement this grammar: \r\nhttps://www.postgresql.org/docs/devel/functions-window.html\r\n\r\n  >The SQL standard defines a RESPECT NULLS or IGNORE NULLS option for lead, lag, first_value, last_value, and nth_value. This is not implemented in PostgreSQL: the behavior is always the same as the standard's default, namely RESPECT NULLS.\r\n\r\n## How was this patch tested?\r\nUT.","created_at":"2019-07-09T02:43:48Z","updated_at":"2020-02-05T04:22:50Z","closed_at":"2019-07-10T14:46:01Z","merged_at":null,"merge_commit_sha":"32bc010ed51b81a2899d20334059cd131efd98bd","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25082/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25082/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25082/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/353becd753af27d65d58b3c81ac0cc14a7f51c91","head":{"label":"lipzhu:SPARK-28310","ref":"SPARK-28310","sha":"353becd753af27d65d58b3c81ac0cc14a7f51c91","user":{"login":"lipzhu","id":698621,"node_id":"MDQ6VXNlcjY5ODYyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/698621?v=4","gravatar_id":"","url":"https://api.github.com/users/lipzhu","html_url":"https://github.com/lipzhu","followers_url":"https://api.github.com/users/lipzhu/followers","following_url":"https://api.github.com/users/lipzhu/following{/other_user}","gists_url":"https://api.github.com/users/lipzhu/gists{/gist_id}","starred_url":"https://api.github.com/users/lipzhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lipzhu/subscriptions","organizations_url":"https://api.github.com/users/lipzhu/orgs","repos_url":"https://api.github.com/users/lipzhu/repos","events_url":"https://api.github.com/users/lipzhu/events{/privacy}","received_events_url":"https://api.github.com/users/lipzhu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":153439750,"node_id":"MDEwOlJlcG9zaXRvcnkxNTM0Mzk3NTA=","name":"spark","full_name":"lipzhu/spark","private":false,"owner":{"login":"lipzhu","id":698621,"node_id":"MDQ6VXNlcjY5ODYyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/698621?v=4","gravatar_id":"","url":"https://api.github.com/users/lipzhu","html_url":"https://github.com/lipzhu","followers_url":"https://api.github.com/users/lipzhu/followers","following_url":"https://api.github.com/users/lipzhu/following{/other_user}","gists_url":"https://api.github.com/users/lipzhu/gists{/gist_id}","starred_url":"https://api.github.com/users/lipzhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lipzhu/subscriptions","organizations_url":"https://api.github.com/users/lipzhu/orgs","repos_url":"https://api.github.com/users/lipzhu/repos","events_url":"https://api.github.com/users/lipzhu/events{/privacy}","received_events_url":"https://api.github.com/users/lipzhu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/lipzhu/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/lipzhu/spark","forks_url":"https://api.github.com/repos/lipzhu/spark/forks","keys_url":"https://api.github.com/repos/lipzhu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/lipzhu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/lipzhu/spark/teams","hooks_url":"https://api.github.com/repos/lipzhu/spark/hooks","issue_events_url":"https://api.github.com/repos/lipzhu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/lipzhu/spark/events","assignees_url":"https://api.github.com/repos/lipzhu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/lipzhu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/lipzhu/spark/tags","blobs_url":"https://api.github.com/repos/lipzhu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/lipzhu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/lipzhu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/lipzhu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/lipzhu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/lipzhu/spark/languages","stargazers_url":"https://api.github.com/repos/lipzhu/spark/stargazers","contributors_url":"https://api.github.com/repos/lipzhu/spark/contributors","subscribers_url":"https://api.github.com/repos/lipzhu/spark/subscribers","subscription_url":"https://api.github.com/repos/lipzhu/spark/subscription","commits_url":"https://api.github.com/repos/lipzhu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/lipzhu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/lipzhu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/lipzhu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/lipzhu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/lipzhu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/lipzhu/spark/merges","archive_url":"https://api.github.com/repos/lipzhu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/lipzhu/spark/downloads","issues_url":"https://api.github.com/repos/lipzhu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/lipzhu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/lipzhu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/lipzhu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/lipzhu/spark/labels{/name}","releases_url":"https://api.github.com/repos/lipzhu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/lipzhu/spark/deployments","created_at":"2018-10-17T10:38:03Z","updated_at":"2024-03-27T01:27:46Z","pushed_at":"2024-03-27T01:27:00Z","git_url":"git://github.com/lipzhu/spark.git","ssh_url":"git@github.com:lipzhu/spark.git","clone_url":"https://github.com/lipzhu/spark.git","svn_url":"https://github.com/lipzhu/spark","homepage":null,"size":393968,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a5ff9221fc23cc758db228493d451f542591eff7","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25082"},"html":{"href":"https://github.com/apache/spark/pull/25082"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25082"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25082/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25082/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25082/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/353becd753af27d65d58b3c81ac0cc14a7f51c91"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25081","id":295548860,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1NTQ4ODYw","html_url":"https://github.com/apache/spark/pull/25081","diff_url":"https://github.com/apache/spark/pull/25081.diff","patch_url":"https://github.com/apache/spark/pull/25081.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25081","number":25081,"state":"closed","locked":false,"title":"[SPARK-28309][R][INFRA] Fix AppVeyor to run SparkR tests by avoiding to use devtools for testthat","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nLooks `devtools` 2.1.0 is released and then our AppVeyor users the latest one.\r\nThe problem is, they added `testthat` 2.1.1+ as its dependency - https://github.com/r-lib/devtools/blob/master/DESCRIPTION#L35\r\n\r\nUsually it should remove and reinstall it properly when we install other packages; however, seems it's being failed in AppVeyor due to the previous installation for an unknown reason.\r\n\r\n```\r\n[00:01:41] > devtools::install_version('testthat', version = '1.0.2', repos='https://cloud.r-project.org/')\r\n[00:01:44] Downloading package from url: https://cloud.r-project.org//src/contrib/Archive/testthat/testthat_1.0.2.tar.gz\r\n...\r\n[00:02:25] WARNING: moving package to final location failed, copying instead\r\n[00:02:25] Warning in file.copy(instdir, dirname(final_instdir), recursive = TRUE,  :\r\n[00:02:25]   problem copying c:\\RLibrary\\00LOCK-testthat\\00new\\testthat\\libs\\i386\\testthat.dll to c:\\RLibrary\\testthat\\libs\\i386\\testthat.dll: Permission denied\r\n[00:02:25] ** testing if installed package can be loaded from final location\r\n[00:02:25] *** arch - i386\r\n[00:02:26] Error: package or namespace load failed for 'testthat' in FUN(X[[i]], ...):\r\n[00:02:26]  no such symbol find_label_ in package c:/RLibrary/testthat/libs/i386/testthat.dll\r\n[00:02:26] Error: loading failed\r\n[00:02:26] Execution halted\r\n[00:02:26] *** arch - x64\r\n[00:02:26] ERROR: loading failed for 'i386'\r\n[00:02:26] * removing 'c:/RLibrary/testthat'\r\n[00:02:26] * restoring previous 'c:/RLibrary/testthat'\r\n[00:02:26] Warning in file.copy(lp, dirname(pkgdir), recursive = TRUE, copy.date = TRUE) :\r\n[00:02:26]   problem copying c:\\RLibrary\\00LOCK-testthat\\testthat\\libs\\i386\\testthat.dll to c:\\RLibrary\\testthat\\libs\\i386\\testthat.dll: Permission denied\r\n[00:02:26] Warning message:\r\n[00:02:26] In i.p(...) :\r\n[00:02:26]   installation of package 'C:/Users/appveyor/AppData/Local/Temp/1/RtmpIx25hi/remotes5743d4a9b1/testthat' had non-zero exit status\r\n```\r\n\r\nSee https://ci.appveyor.com/project/ApacheSoftwareFoundation/spark/builds/25818746\r\n\r\nOur SparkR testbed requires `testthat` 1.0.2 at most for the current status and `devtools` was installed at SPARK-22817 to pin the `testthat` version to 1.0.2\r\n\r\nTherefore, this PR works around the current issue by directly installing from the archive instead, and don't use `devtools`.\r\n\r\n```R\r\n R -e \"install.packages('https://cloud.r-project.org/src/contrib/Archive/testthat/testthat_1.0.2.tar.gz', repos=NULL, type='source')\"\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nAppVeyor will test.","created_at":"2019-07-09T01:21:16Z","updated_at":"2020-03-03T01:18:35Z","closed_at":"2019-07-09T03:09:46Z","merged_at":null,"merge_commit_sha":"cf7e53498ee65f24f57bc933c866a7227d9282cd","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587336,"node_id":"MDU6TGFiZWwxNDA2NTg3MzM2","url":"https://api.github.com/repos/apache/spark/labels/PROJECT%20INFRA","name":"PROJECT INFRA","color":"ededed","default":false,"description":null},{"id":1406606336,"node_id":"MDU6TGFiZWwxNDA2NjA2MzM2","url":"https://api.github.com/repos/apache/spark/labels/SPARKR","name":"SPARKR","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25081/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25081/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25081/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5b14e67477dbb9948c6c51f6d12a7e3a5ae6552d","head":{"label":"HyukjinKwon:SPARK-28309","ref":"SPARK-28309","sha":"5b14e67477dbb9948c6c51f6d12a7e3a5ae6552d","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"28ea445c4325ff567a1b80903e656cf34767e0fe","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25081"},"html":{"href":"https://github.com/apache/spark/pull/25081"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25081"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25081/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25081/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25081/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5b14e67477dbb9948c6c51f6d12a7e3a5ae6552d"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25080","id":295531023,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1NTMxMDIz","html_url":"https://github.com/apache/spark/pull/25080","diff_url":"https://github.com/apache/spark/pull/25080.diff","patch_url":"https://github.com/apache/spark/pull/25080.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25080","number":25080,"state":"closed","locked":false,"title":"[SPARK-28306][SQL] Make NormalizeFloatingNumbers rule idempotent","user":{"login":"yeshengm","id":12269969,"node_id":"MDQ6VXNlcjEyMjY5OTY5","avatar_url":"https://avatars.githubusercontent.com/u/12269969?v=4","gravatar_id":"","url":"https://api.github.com/users/yeshengm","html_url":"https://github.com/yeshengm","followers_url":"https://api.github.com/users/yeshengm/followers","following_url":"https://api.github.com/users/yeshengm/following{/other_user}","gists_url":"https://api.github.com/users/yeshengm/gists{/gist_id}","starred_url":"https://api.github.com/users/yeshengm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeshengm/subscriptions","organizations_url":"https://api.github.com/users/yeshengm/orgs","repos_url":"https://api.github.com/users/yeshengm/repos","events_url":"https://api.github.com/users/yeshengm/events{/privacy}","received_events_url":"https://api.github.com/users/yeshengm/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nThe optimizer rule `NormalizeFloatingNumbers` is not idempotent. It will generate multiple `NormalizeNaNAndZero` and `ArrayTransform` expression nodes for multiple runs. This patch fixed this non-idempotence by adding a marking tag above normalized expressions. It also adds missing UTs for `NormalizeFloatingNumbers`.\r\n\r\n## How was this patch tested?\r\nNew UTs.\r\n","created_at":"2019-07-08T23:26:56Z","updated_at":"2019-07-11T02:26:27Z","closed_at":"2019-07-11T02:26:27Z","merged_at":null,"merge_commit_sha":"88207404ae8b81dd0536433c65015a8073081b00","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25080/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25080/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25080/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f255c8ed5f22fa10acdf12994867303596ee696e","head":{"label":"yeshengm:spark-28306","ref":"spark-28306","sha":"f255c8ed5f22fa10acdf12994867303596ee696e","user":{"login":"yeshengm","id":12269969,"node_id":"MDQ6VXNlcjEyMjY5OTY5","avatar_url":"https://avatars.githubusercontent.com/u/12269969?v=4","gravatar_id":"","url":"https://api.github.com/users/yeshengm","html_url":"https://github.com/yeshengm","followers_url":"https://api.github.com/users/yeshengm/followers","following_url":"https://api.github.com/users/yeshengm/following{/other_user}","gists_url":"https://api.github.com/users/yeshengm/gists{/gist_id}","starred_url":"https://api.github.com/users/yeshengm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeshengm/subscriptions","organizations_url":"https://api.github.com/users/yeshengm/orgs","repos_url":"https://api.github.com/users/yeshengm/repos","events_url":"https://api.github.com/users/yeshengm/events{/privacy}","received_events_url":"https://api.github.com/users/yeshengm/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":187889692,"node_id":"MDEwOlJlcG9zaXRvcnkxODc4ODk2OTI=","name":"spark","full_name":"yeshengm/spark","private":false,"owner":{"login":"yeshengm","id":12269969,"node_id":"MDQ6VXNlcjEyMjY5OTY5","avatar_url":"https://avatars.githubusercontent.com/u/12269969?v=4","gravatar_id":"","url":"https://api.github.com/users/yeshengm","html_url":"https://github.com/yeshengm","followers_url":"https://api.github.com/users/yeshengm/followers","following_url":"https://api.github.com/users/yeshengm/following{/other_user}","gists_url":"https://api.github.com/users/yeshengm/gists{/gist_id}","starred_url":"https://api.github.com/users/yeshengm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeshengm/subscriptions","organizations_url":"https://api.github.com/users/yeshengm/orgs","repos_url":"https://api.github.com/users/yeshengm/repos","events_url":"https://api.github.com/users/yeshengm/events{/privacy}","received_events_url":"https://api.github.com/users/yeshengm/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yeshengm/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/yeshengm/spark","forks_url":"https://api.github.com/repos/yeshengm/spark/forks","keys_url":"https://api.github.com/repos/yeshengm/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yeshengm/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yeshengm/spark/teams","hooks_url":"https://api.github.com/repos/yeshengm/spark/hooks","issue_events_url":"https://api.github.com/repos/yeshengm/spark/issues/events{/number}","events_url":"https://api.github.com/repos/yeshengm/spark/events","assignees_url":"https://api.github.com/repos/yeshengm/spark/assignees{/user}","branches_url":"https://api.github.com/repos/yeshengm/spark/branches{/branch}","tags_url":"https://api.github.com/repos/yeshengm/spark/tags","blobs_url":"https://api.github.com/repos/yeshengm/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yeshengm/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yeshengm/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/yeshengm/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yeshengm/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/yeshengm/spark/languages","stargazers_url":"https://api.github.com/repos/yeshengm/spark/stargazers","contributors_url":"https://api.github.com/repos/yeshengm/spark/contributors","subscribers_url":"https://api.github.com/repos/yeshengm/spark/subscribers","subscription_url":"https://api.github.com/repos/yeshengm/spark/subscription","commits_url":"https://api.github.com/repos/yeshengm/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/yeshengm/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/yeshengm/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/yeshengm/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/yeshengm/spark/contents/{+path}","compare_url":"https://api.github.com/repos/yeshengm/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yeshengm/spark/merges","archive_url":"https://api.github.com/repos/yeshengm/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yeshengm/spark/downloads","issues_url":"https://api.github.com/repos/yeshengm/spark/issues{/number}","pulls_url":"https://api.github.com/repos/yeshengm/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/yeshengm/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/yeshengm/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yeshengm/spark/labels{/name}","releases_url":"https://api.github.com/repos/yeshengm/spark/releases{/id}","deployments_url":"https://api.github.com/repos/yeshengm/spark/deployments","created_at":"2019-05-21T18:06:45Z","updated_at":"2019-06-10T23:01:04Z","pushed_at":"2022-02-09T05:43:22Z","git_url":"git://github.com/yeshengm/spark.git","ssh_url":"git@github.com:yeshengm/spark.git","clone_url":"https://github.com/yeshengm/spark.git","svn_url":"https://github.com/yeshengm/spark","homepage":"","size":390452,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f15102b1702b64a54233ae31357e32335722f4e5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25080"},"html":{"href":"https://github.com/apache/spark/pull/25080"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25080"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25080/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25080/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25080/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f255c8ed5f22fa10acdf12994867303596ee696e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25079","id":295529381,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1NTI5Mzgx","html_url":"https://github.com/apache/spark/pull/25079","diff_url":"https://github.com/apache/spark/pull/25079.diff","patch_url":"https://github.com/apache/spark/pull/25079.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25079","number":25079,"state":"closed","locked":false,"title":"[SPARK-28308][CORE] CalendarInterval sub-second part should be padded before parsing","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe sub-second part of the interval should be padded before parsing. Currently, Spark gives a correct value only when there is 9 digits below `.`.\r\n```\r\nspark-sql> select interval '0 0:0:0.123456789' day to second;\r\ninterval 123 milliseconds 456 microseconds\r\n\r\nspark-sql> select interval '0 0:0:0.12345678' day to second;\r\ninterval 12 milliseconds 345 microseconds\r\n\r\nspark-sql> select interval '0 0:0:0.1234' day to second;\r\ninterval 1 microseconds\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nPass the Jenkins with the fixed test cases.","created_at":"2019-07-08T23:18:40Z","updated_at":"2019-07-09T03:03:31Z","closed_at":"2019-07-09T02:45:13Z","merged_at":null,"merge_commit_sha":"454fe9ec8c560bea43c764cfc243ddb571baf96e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25079/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25079/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25079/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3669a516ecb0bd064f4b0c201d1fd35e0a28be1a","head":{"label":"dongjoon-hyun:SPARK-28308","ref":"SPARK-28308","sha":"3669a516ecb0bd064f4b0c201d1fd35e0a28be1a","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"28ea445c4325ff567a1b80903e656cf34767e0fe","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25079"},"html":{"href":"https://github.com/apache/spark/pull/25079"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25079"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25079/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25079/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25079/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3669a516ecb0bd064f4b0c201d1fd35e0a28be1a"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25078","id":295401995,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1NDAxOTk1","html_url":"https://github.com/apache/spark/pull/25078","diff_url":"https://github.com/apache/spark/pull/25078.diff","patch_url":"https://github.com/apache/spark/pull/25078.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25078","number":25078,"state":"closed","locked":false,"title":"[SPARK-28305][YARN] Request GetExecutorLossReason to use a smaller timeout parameter","user":{"login":"cxzl25","id":3898450,"node_id":"MDQ6VXNlcjM4OTg0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/3898450?v=4","gravatar_id":"","url":"https://api.github.com/users/cxzl25","html_url":"https://github.com/cxzl25","followers_url":"https://api.github.com/users/cxzl25/followers","following_url":"https://api.github.com/users/cxzl25/following{/other_user}","gists_url":"https://api.github.com/users/cxzl25/gists{/gist_id}","starred_url":"https://api.github.com/users/cxzl25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cxzl25/subscriptions","organizations_url":"https://api.github.com/users/cxzl25/orgs","repos_url":"https://api.github.com/users/cxzl25/repos","events_url":"https://api.github.com/users/cxzl25/events{/privacy}","received_events_url":"https://api.github.com/users/cxzl25/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\nRequest GetExecutorLossReason to use a smaller timeout parameter.\r\n\r\nIn some cases, such as NM machine crashes or shuts down,driver ask ```GetExecutorLossReason```,\r\nAM ```getCompletedContainersStatuses``` can't get the failure information of container.\r\n\r\nBecause the yarn NM detection timeout is 10 minutes, it is controlled by the parameter yarn.resourcemanager.rm.container-allocation.expiry-interval-ms.\r\nSo AM has to wait for 10 minutes to get the cause of the container failure.\r\n\r\nAlthough the driver's ask fails, it will call recover.\r\nHowever, due to the 2-minute timeout (spark.network.timeout) configured by ```IdleStateHandler```, the connection between driver and am is closed, AM exits, app finish, driver exits, causing the job to fail.\r\n\r\n## How was this patch tested?\r\n","created_at":"2019-07-08T16:03:36Z","updated_at":"2019-12-28T00:07:24Z","closed_at":"2019-12-28T00:07:24Z","merged_at":null,"merge_commit_sha":"78bd674203e0aa49aa9f69a2cee6627def17e432","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1427970157,"node_id":"MDU6TGFiZWwxNDI3OTcwMTU3","url":"https://api.github.com/repos/apache/spark/labels/YARN","name":"YARN","color":"ededed","default":false,"description":null},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25078/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25078/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25078/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/762a419432f1b74b7ed15f4dfa9b543eed465f7f","head":{"label":"cxzl25:fix_GetExecutorLossReason","ref":"fix_GetExecutorLossReason","sha":"762a419432f1b74b7ed15f4dfa9b543eed465f7f","user":{"login":"cxzl25","id":3898450,"node_id":"MDQ6VXNlcjM4OTg0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/3898450?v=4","gravatar_id":"","url":"https://api.github.com/users/cxzl25","html_url":"https://github.com/cxzl25","followers_url":"https://api.github.com/users/cxzl25/followers","following_url":"https://api.github.com/users/cxzl25/following{/other_user}","gists_url":"https://api.github.com/users/cxzl25/gists{/gist_id}","starred_url":"https://api.github.com/users/cxzl25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cxzl25/subscriptions","organizations_url":"https://api.github.com/users/cxzl25/orgs","repos_url":"https://api.github.com/users/cxzl25/repos","events_url":"https://api.github.com/users/cxzl25/events{/privacy}","received_events_url":"https://api.github.com/users/cxzl25/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":119043888,"node_id":"MDEwOlJlcG9zaXRvcnkxMTkwNDM4ODg=","name":"spark","full_name":"cxzl25/spark","private":false,"owner":{"login":"cxzl25","id":3898450,"node_id":"MDQ6VXNlcjM4OTg0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/3898450?v=4","gravatar_id":"","url":"https://api.github.com/users/cxzl25","html_url":"https://github.com/cxzl25","followers_url":"https://api.github.com/users/cxzl25/followers","following_url":"https://api.github.com/users/cxzl25/following{/other_user}","gists_url":"https://api.github.com/users/cxzl25/gists{/gist_id}","starred_url":"https://api.github.com/users/cxzl25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cxzl25/subscriptions","organizations_url":"https://api.github.com/users/cxzl25/orgs","repos_url":"https://api.github.com/users/cxzl25/repos","events_url":"https://api.github.com/users/cxzl25/events{/privacy}","received_events_url":"https://api.github.com/users/cxzl25/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cxzl25/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cxzl25/spark","forks_url":"https://api.github.com/repos/cxzl25/spark/forks","keys_url":"https://api.github.com/repos/cxzl25/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cxzl25/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cxzl25/spark/teams","hooks_url":"https://api.github.com/repos/cxzl25/spark/hooks","issue_events_url":"https://api.github.com/repos/cxzl25/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cxzl25/spark/events","assignees_url":"https://api.github.com/repos/cxzl25/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cxzl25/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cxzl25/spark/tags","blobs_url":"https://api.github.com/repos/cxzl25/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cxzl25/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cxzl25/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cxzl25/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cxzl25/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cxzl25/spark/languages","stargazers_url":"https://api.github.com/repos/cxzl25/spark/stargazers","contributors_url":"https://api.github.com/repos/cxzl25/spark/contributors","subscribers_url":"https://api.github.com/repos/cxzl25/spark/subscribers","subscription_url":"https://api.github.com/repos/cxzl25/spark/subscription","commits_url":"https://api.github.com/repos/cxzl25/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cxzl25/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cxzl25/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cxzl25/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cxzl25/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cxzl25/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cxzl25/spark/merges","archive_url":"https://api.github.com/repos/cxzl25/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cxzl25/spark/downloads","issues_url":"https://api.github.com/repos/cxzl25/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cxzl25/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cxzl25/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cxzl25/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cxzl25/spark/labels{/name}","releases_url":"https://api.github.com/repos/cxzl25/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cxzl25/spark/deployments","created_at":"2018-01-26T11:26:14Z","updated_at":"2024-12-27T09:40:45Z","pushed_at":"2025-01-17T03:20:50Z","git_url":"git://github.com/cxzl25/spark.git","ssh_url":"git@github.com:cxzl25/spark.git","clone_url":"https://github.com/cxzl25/spark.git","svn_url":"https://github.com/cxzl25/spark","homepage":null,"size":463865,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"20469d43eb22c832b4d8f30c9e611ef622c3366d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25078"},"html":{"href":"https://github.com/apache/spark/pull/25078"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25078"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25078/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25078/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25078/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/762a419432f1b74b7ed15f4dfa9b543eed465f7f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25077","id":295319703,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MzE5NzAz","html_url":"https://github.com/apache/spark/pull/25077","diff_url":"https://github.com/apache/spark/pull/25077.diff","patch_url":"https://github.com/apache/spark/pull/25077.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25077","number":25077,"state":"closed","locked":false,"title":"[SPARK-28301][SQL] fix the behavior of table name resolution with multi-catalog","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nNow users can register multiple catalogs in Spark, and the table name resolution should be compatible with multi-catalog. The expected behavior is simple:\r\n* For DDL commands that can only deal with tables\r\n    * If the table name has only one name part, then it's a table in the default catalog.\r\n    * If the table name has more than one name part like `a.b.c`.\r\n        * if `a` is a registered catalog, then it's a table `c` under namespace `b` in catalog `a`.\r\n        * if `a` is not a registered catalog, then it's a table `c` under namespace `a.b` in the default catalog.\r\n* For SELECT/INSERT that can handle both tables and temp views, first check if the table name is a temp view or global temp view, otherwise the rule is the same as DDL commands.\r\n\r\nHowever, we need to change the expected behavior a little bit because the builtin hive catalog hasn't migrated to the new catalog API yet:\r\n1. If the default catalog config is set, pick it as the default catalog. Otherwise pick hive catalog as the default catalog.\r\n2. If the default catalog config is not set, and the table name has more than 2 name parts. We should fail with \"no catalog specified for table\"\r\n\r\nThe current behavior of table name resolution is a little confusing:\r\n* For DDL commands that can only deal with tables\r\n    * If the first part of the table name matches a registered catalog, then it's a table in that catalog. (expected)\r\n    * Otherwise, if the table name has less than 3 parts, and the provider name is v1, go with the builtin Hive catalog. (This is not expected. By design different catalogs can interprete table provider name differently. We should go with the default catalog if the config is set, no matter what the table provider name is.)\r\n* For SELECT/INSERT that can handle both tables and temp views\r\n    * If the first part of the table name matches a registered catalog, then it's a table in that catalog. (expected)\r\n    * Otherwise, if the table name has less than 3 parts, go with the builtin Hive catalog. (This is not expected as we need to respect the default catalog config.)\r\n    * Otherwise, the query is unresolved. (This is not expected as we need to respect the default catalog config.)\r\n\r\nThis PR fixes the behavior of the table name resolution:\r\n1. Now `Analyzer` instead of `SparkSession` tracks all the registered catalogs. This is because `SparkSession` is in sql/core not sql/catalyst.\r\n2. The rule `DataSourceResolution` only resolves table name to the hive catalog when the catalog is not specified in the table name and default catalog is not set.\r\n\r\n## How was this patch tested?\r\n\r\nnew test cases\r\n","created_at":"2019-07-08T12:47:12Z","updated_at":"2019-09-16T12:11:44Z","closed_at":"2019-09-16T12:11:44Z","merged_at":null,"merge_commit_sha":"3c37a78c2a2ac2c97bb4261a9d59a1c288168578","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25077/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25077/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25077/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/4ed4399ad558249ceb2c56e1d1c88837ae4602df","head":{"label":"cloud-fan:catalog","ref":"catalog","sha":"4ed4399ad558249ceb2c56e1d1c88837ae4602df","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f15102b1702b64a54233ae31357e32335722f4e5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25077"},"html":{"href":"https://github.com/apache/spark/pull/25077"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25077"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25077/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25077/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25077/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/4ed4399ad558249ceb2c56e1d1c88837ae4602df"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25076","id":295311670,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MzExNjcw","html_url":"https://github.com/apache/spark/pull/25076","diff_url":"https://github.com/apache/spark/pull/25076.diff","patch_url":"https://github.com/apache/spark/pull/25076.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25076","number":25076,"state":"closed","locked":false,"title":"[SPARK-28302] [CORE] Make sure to generate unique output file for SparkLauncher on Windows","user":{"login":"Ngone51","id":16397174,"node_id":"MDQ6VXNlcjE2Mzk3MTc0","avatar_url":"https://avatars.githubusercontent.com/u/16397174?v=4","gravatar_id":"","url":"https://api.github.com/users/Ngone51","html_url":"https://github.com/Ngone51","followers_url":"https://api.github.com/users/Ngone51/followers","following_url":"https://api.github.com/users/Ngone51/following{/other_user}","gists_url":"https://api.github.com/users/Ngone51/gists{/gist_id}","starred_url":"https://api.github.com/users/Ngone51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ngone51/subscriptions","organizations_url":"https://api.github.com/users/Ngone51/orgs","repos_url":"https://api.github.com/users/Ngone51/repos","events_url":"https://api.github.com/users/Ngone51/events{/privacy}","received_events_url":"https://api.github.com/users/Ngone51/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nWhen using SparkLauncher to submit applications **concurrently** with multiple threads under **Windows**, some apps would show that \"The process cannot access the file because it is being used by another process\" and remains in LOST state at the end. The issue can be reproduced by  this [demo](https://issues.apache.org/jira/secure/attachment/12973920/Main.scala).\r\n\r\nAfter digging into the code, I find that, Windows cmd `%RANDOM%` would return the same number if we call it  instantly(e.g. < 500ms) after last call. As a result, SparkLauncher would get same output file(spark-class-launcher-output-%RANDOM%.txt) for apps. Then, the following app would hit the issue when it tries to write the same file which has already been opened for writing by another app. \r\n\r\nWe should make sure to generate unique output file for SparkLauncher on Windows to avoid this issue.\r\n\r\n## How was this patch tested?\r\n\r\nTested manually on Windows.","created_at":"2019-07-08T12:24:32Z","updated_at":"2020-05-26T20:13:11Z","closed_at":"2019-07-09T06:54:02Z","merged_at":null,"merge_commit_sha":"7f96ed56eb8937437cc821a6e5d9ece5208d4ff3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25076/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25076/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25076/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9273f33fbd6ea5cf71b19e84689b3ef43132d6cd","head":{"label":"Ngone51:SPARK-28302","ref":"SPARK-28302","sha":"9273f33fbd6ea5cf71b19e84689b3ef43132d6cd","user":{"login":"Ngone51","id":16397174,"node_id":"MDQ6VXNlcjE2Mzk3MTc0","avatar_url":"https://avatars.githubusercontent.com/u/16397174?v=4","gravatar_id":"","url":"https://api.github.com/users/Ngone51","html_url":"https://github.com/Ngone51","followers_url":"https://api.github.com/users/Ngone51/followers","following_url":"https://api.github.com/users/Ngone51/following{/other_user}","gists_url":"https://api.github.com/users/Ngone51/gists{/gist_id}","starred_url":"https://api.github.com/users/Ngone51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ngone51/subscriptions","organizations_url":"https://api.github.com/users/Ngone51/orgs","repos_url":"https://api.github.com/users/Ngone51/repos","events_url":"https://api.github.com/users/Ngone51/events{/privacy}","received_events_url":"https://api.github.com/users/Ngone51/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":114185286,"node_id":"MDEwOlJlcG9zaXRvcnkxMTQxODUyODY=","name":"spark","full_name":"Ngone51/spark","private":false,"owner":{"login":"Ngone51","id":16397174,"node_id":"MDQ6VXNlcjE2Mzk3MTc0","avatar_url":"https://avatars.githubusercontent.com/u/16397174?v=4","gravatar_id":"","url":"https://api.github.com/users/Ngone51","html_url":"https://github.com/Ngone51","followers_url":"https://api.github.com/users/Ngone51/followers","following_url":"https://api.github.com/users/Ngone51/following{/other_user}","gists_url":"https://api.github.com/users/Ngone51/gists{/gist_id}","starred_url":"https://api.github.com/users/Ngone51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ngone51/subscriptions","organizations_url":"https://api.github.com/users/Ngone51/orgs","repos_url":"https://api.github.com/users/Ngone51/repos","events_url":"https://api.github.com/users/Ngone51/events{/privacy}","received_events_url":"https://api.github.com/users/Ngone51/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Ngone51/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/Ngone51/spark","forks_url":"https://api.github.com/repos/Ngone51/spark/forks","keys_url":"https://api.github.com/repos/Ngone51/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Ngone51/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Ngone51/spark/teams","hooks_url":"https://api.github.com/repos/Ngone51/spark/hooks","issue_events_url":"https://api.github.com/repos/Ngone51/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Ngone51/spark/events","assignees_url":"https://api.github.com/repos/Ngone51/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Ngone51/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Ngone51/spark/tags","blobs_url":"https://api.github.com/repos/Ngone51/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Ngone51/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Ngone51/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Ngone51/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Ngone51/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Ngone51/spark/languages","stargazers_url":"https://api.github.com/repos/Ngone51/spark/stargazers","contributors_url":"https://api.github.com/repos/Ngone51/spark/contributors","subscribers_url":"https://api.github.com/repos/Ngone51/spark/subscribers","subscription_url":"https://api.github.com/repos/Ngone51/spark/subscription","commits_url":"https://api.github.com/repos/Ngone51/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Ngone51/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Ngone51/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Ngone51/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Ngone51/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Ngone51/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Ngone51/spark/merges","archive_url":"https://api.github.com/repos/Ngone51/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Ngone51/spark/downloads","issues_url":"https://api.github.com/repos/Ngone51/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Ngone51/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Ngone51/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Ngone51/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Ngone51/spark/labels{/name}","releases_url":"https://api.github.com/repos/Ngone51/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Ngone51/spark/deployments","created_at":"2017-12-14T01:05:22Z","updated_at":"2021-11-09T15:33:30Z","pushed_at":"2025-01-23T04:25:21Z","git_url":"git://github.com/Ngone51/spark.git","ssh_url":"git@github.com:Ngone51/spark.git","clone_url":"https://github.com/Ngone51/spark.git","svn_url":"https://github.com/Ngone51/spark","homepage":null,"size":478226,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"20469d43eb22c832b4d8f30c9e611ef622c3366d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25076"},"html":{"href":"https://github.com/apache/spark/pull/25076"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25076"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25076/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25076/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25076/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9273f33fbd6ea5cf71b19e84689b3ef43132d6cd"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25075","id":295298034,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1Mjk4MDM0","html_url":"https://github.com/apache/spark/pull/25075","diff_url":"https://github.com/apache/spark/pull/25075.diff","patch_url":"https://github.com/apache/spark/pull/25075.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25075","number":25075,"state":"closed","locked":false,"title":"[SPARK-28261][CORE] Fix client reuse test","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThere is the following code in [TransportClientFactory#createClient](https://github.com/apache/spark/blob/master/common/network-common/src/main/java/org/apache/spark/network/client/TransportClientFactory.java#L150)\r\n```\r\n    int clientIndex = rand.nextInt(numConnectionsPerPeer);\r\n    TransportClient cachedClient = clientPool.clients[clientIndex];\r\n```\r\nwhich choose a client from its pool randomly. If we are unlucky we might not get the max number of connections out, but less than that.\r\n\r\nTo prove that I've tried out the following test:\r\n```java\r\n  @Test\r\n  public void testRandom() {\r\n    Random rand = new Random();\r\n    Set<Integer> clients = Collections.synchronizedSet(new HashSet<>());\r\n    long iterCounter = 0;\r\n    while (true) {\r\n      iterCounter++;\r\n      int maxConnections = 4;\r\n      clients.clear();\r\n      for (int i = 0; i < maxConnections * 10; i++) {\r\n        int clientIndex = rand.nextInt(maxConnections);\r\n        clients.add(clientIndex);\r\n      }\r\n      if (clients.size() != maxConnections) {\r\n        System.err.println(\"Unexpected clients size (iterCounter=\" + iterCounter + \"): \" + clients.size() + \", maxConnections: \" + maxConnections);\r\n      }\r\n      if (iterCounter % 100000 == 0) {\r\n        System.out.println(\"IterCounter: \" + iterCounter);\r\n      }\r\n    }\r\n  }\r\n```\r\n\r\nResult:\r\n```\r\nUnexpected clients size (iterCounter=22388): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=36244): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=85798): 3, maxConnections: 4\r\nIterCounter: 100000\r\nUnexpected clients size (iterCounter=97108): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=119121): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=129948): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=173736): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=178138): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=195108): 3, maxConnections: 4\r\nIterCounter: 200000\r\nUnexpected clients size (iterCounter=209006): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=217105): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=222456): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=226899): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=229101): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=253549): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=277550): 3, maxConnections: 4\r\nUnexpected clients size (iterCounter=289637): 3, maxConnections: 4\r\n...\r\n```\r\n\r\nIn this PR I've adapted the test code not to have this flakyness.\r\n\r\n## How was this patch tested?\r\n\r\nAdditional (not committed test) + existing unit tests in a loop.\r\n","created_at":"2019-07-08T11:44:08Z","updated_at":"2019-07-08T18:17:33Z","closed_at":"2019-07-08T18:14:57Z","merged_at":null,"merge_commit_sha":"62b7a99e75a939c995abed53f53b732ea0940d8f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null},{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25075/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25075/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25075/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1cf4635c866f44002afe043a8e7691271aff6afd","head":{"label":"gaborgsomogyi:SPARK-28261","ref":"SPARK-28261","sha":"1cf4635c866f44002afe043a8e7691271aff6afd","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":111547097,"node_id":"MDEwOlJlcG9zaXRvcnkxMTE1NDcwOTc=","name":"spark","full_name":"gaborgsomogyi/spark","private":false,"owner":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gaborgsomogyi/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gaborgsomogyi/spark","forks_url":"https://api.github.com/repos/gaborgsomogyi/spark/forks","keys_url":"https://api.github.com/repos/gaborgsomogyi/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gaborgsomogyi/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gaborgsomogyi/spark/teams","hooks_url":"https://api.github.com/repos/gaborgsomogyi/spark/hooks","issue_events_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gaborgsomogyi/spark/events","assignees_url":"https://api.github.com/repos/gaborgsomogyi/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gaborgsomogyi/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/tags","blobs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gaborgsomogyi/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gaborgsomogyi/spark/languages","stargazers_url":"https://api.github.com/repos/gaborgsomogyi/spark/stargazers","contributors_url":"https://api.github.com/repos/gaborgsomogyi/spark/contributors","subscribers_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscribers","subscription_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscription","commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gaborgsomogyi/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gaborgsomogyi/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gaborgsomogyi/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gaborgsomogyi/spark/merges","archive_url":"https://api.github.com/repos/gaborgsomogyi/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gaborgsomogyi/spark/downloads","issues_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gaborgsomogyi/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gaborgsomogyi/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gaborgsomogyi/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gaborgsomogyi/spark/labels{/name}","releases_url":"https://api.github.com/repos/gaborgsomogyi/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gaborgsomogyi/spark/deployments","created_at":"2017-11-21T12:38:03Z","updated_at":"2024-05-06T08:51:33Z","pushed_at":"2024-05-06T08:50:41Z","git_url":"git://github.com/gaborgsomogyi/spark.git","ssh_url":"git@github.com:gaborgsomogyi/spark.git","clone_url":"https://github.com/gaborgsomogyi/spark.git","svn_url":"https://github.com/gaborgsomogyi/spark","homepage":null,"size":416015,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"20469d43eb22c832b4d8f30c9e611ef622c3366d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25075"},"html":{"href":"https://github.com/apache/spark/pull/25075"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25075"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25075/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25075/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25075/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1cf4635c866f44002afe043a8e7691271aff6afd"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25074","id":295248354,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MjQ4MzU0","html_url":"https://github.com/apache/spark/pull/25074","diff_url":"https://github.com/apache/spark/pull/25074.diff","patch_url":"https://github.com/apache/spark/pull/25074.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25074","number":25074,"state":"closed","locked":false,"title":"[SPARK-27924][SQL] Support ANSI SQL Boolean-Predicate syntax ","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR aims to support ANSI SQL `Boolean-Predicate` syntax.\r\n```sql\r\nexpression IS [NOT] TRUE\r\nexpression IS [NOT] FALSE\r\nexpression IS [NOT] UNKNOWN\r\n```\r\n\r\nThere are some mainstream database support this syntax.\r\n- **PostgreSQL:**  https://www.postgresql.org/docs/9.1/functions-comparison.html\r\n- **Hive:** https://issues.apache.org/jira/browse/HIVE-13583\r\n- **Redshift:** https://docs.aws.amazon.com/redshift/latest/dg/r_Boolean_type.html\r\n- **Vertica:** https://www.vertica.com/docs/9.2.x/HTML/Content/Authoring/SQLReferenceManual/LanguageElements/Predicates/Boolean-predicate.htm\r\n\r\nFor example:\r\n```sql\r\nspark-sql> select null is true, null is not true;\r\nfalse\ttrue\r\n\r\nspark-sql> select false is true, false is not true;\r\nfalse\ttrue\r\n\r\nspark-sql> select true is true, true is not true;\r\ntrue\tfalse\r\n\r\nspark-sql> select null is false, null is not false;\r\nfalse\ttrue\r\n\r\nspark-sql> select false is false, false is not false;\r\ntrue\tfalse\r\n\r\nspark-sql> select true is false,  true is not false;\r\nfalse\ttrue\r\n\r\nspark-sql> select null is unknown, null is not unknown;\r\ntrue\tfalse\r\n\r\nspark-sql> select false is unknown, false is not unknown;\r\nfalse\ttrue\r\n\r\nspark-sql> select true is unknown, true is not unknown;\r\nfalse\ttrue\r\n```\r\n**Note**: A null input is treated as the logical value \"unknown\".\r\n\r\n## How was this patch tested?\r\n\r\nPass the Jenkins with the newly added test cases.","created_at":"2019-07-08T09:22:08Z","updated_at":"2020-02-26T00:33:16Z","closed_at":"2019-07-31T07:04:29Z","merged_at":null,"merge_commit_sha":"00eadb86530747427ccaff6680b53a475b9f3af1","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25074/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25074/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25074/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ae126e7aee616d30916d8223d07e5f37384b21f4","head":{"label":"beliefer:ansi-sql-boolean-test","ref":"ansi-sql-boolean-test","sha":"ae126e7aee616d30916d8223d07e5f37384b21f4","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"20469d43eb22c832b4d8f30c9e611ef622c3366d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25074"},"html":{"href":"https://github.com/apache/spark/pull/25074"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25074"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25074/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25074/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25074/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ae126e7aee616d30916d8223d07e5f37384b21f4"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25073","id":295218924,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MjE4OTI0","html_url":"https://github.com/apache/spark/pull/25073","diff_url":"https://github.com/apache/spark/pull/25073.diff","patch_url":"https://github.com/apache/spark/pull/25073.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25073","number":25073,"state":"closed","locked":false,"title":"[SPARK-28293][SQL] Implement Spark's own GetTableTypesOperation","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe table type is from Hive now. This will have some issues. For example, we don't support `index_table`, different Hive supports different table types:\r\nBuild with Hive 1.2.1:\r\n![image](https://user-images.githubusercontent.com/5399861/60792689-be38b880-a198-11e9-82b8-868992a505e3.png)\r\nBuild with Hive 2.3.5:\r\n![image](https://user-images.githubusercontent.com/5399861/60792727-d4467900-a198-11e9-952c-210bb7bb3bed.png)\r\n\r\n\r\nThis pr implement Spark's own `GetTableTypesOperation`.\r\n\r\n## How was this patch tested?\r\n\r\nunit tests and manual tests:\r\n![image](https://user-images.githubusercontent.com/5399861/60793368-2a67ec00-a19a-11e9-9511-c67483dcc370.png)\r\n\r\n","created_at":"2019-07-08T07:59:05Z","updated_at":"2019-08-22T11:03:11Z","closed_at":"2019-07-24T18:32:17Z","merged_at":null,"merge_commit_sha":"0d9e50ff7591d3e36a11528e3823af2af723f921","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25073/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25073/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25073/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a008c81eddff1bd252326f2acbb6b77605529556","head":{"label":"wangyum:SPARK-28293","ref":"SPARK-28293","sha":"a008c81eddff1bd252326f2acbb6b77605529556","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"aa41dcea4a41899507dfe4ec1eceaabb5edf728f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25073"},"html":{"href":"https://github.com/apache/spark/pull/25073"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25073"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25073/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25073/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25073/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a008c81eddff1bd252326f2acbb6b77605529556"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25072","id":295202366,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MjAyMzY2","html_url":"https://github.com/apache/spark/pull/25072","diff_url":"https://github.com/apache/spark/pull/25072.diff","patch_url":"https://github.com/apache/spark/pull/25072.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25072","number":25072,"state":"closed","locked":false,"title":"[SPARK-28294][CORE] Support `spark.history.fs.cleaner.maxNum` configuration","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nUp to now, Apache Spark maintains the given event log directory by **time** policy, `spark.history.fs.cleaner.maxAge`. However, there are two issues.\r\n1. Some file system has a limitation on the maximum number of files in a single directory. For example, HDFS `dfs.namenode.fs-limits.max-directory-items` is 1024 * 1024 by default.\r\nhttps://hadoop.apache.org/docs/r3.2.0/hadoop-project-dist/hadoop-hdfs/hdfs-default.xml\r\n2. Spark is sometimes unable to to clean up some old log files due to permission issues (mainly, security policy).\r\n\r\nTo handle both (1) and (2), this PR aims to support an additional policy configuration for the maximum number of files in the event log directory, `spark.history.fs.cleaner.maxNum`. Spark will try to keep the number of files in the event log directory according to this policy.\r\n\r\n## How was this patch tested?\r\n\r\nPass the Jenkins with a newly added test case.","created_at":"2019-07-08T07:03:16Z","updated_at":"2019-07-10T14:24:28Z","closed_at":"2019-07-10T14:24:28Z","merged_at":null,"merge_commit_sha":"35bc685b4617320424496eb81093a825909b6d97","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25072/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25072/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25072/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f2c93a0291877f3e4af03ab279fba93201054d14","head":{"label":"dongjoon-hyun:SPARK-28294","ref":"SPARK-28294","sha":"f2c93a0291877f3e4af03ab279fba93201054d14","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"20469d43eb22c832b4d8f30c9e611ef622c3366d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25072"},"html":{"href":"https://github.com/apache/spark/pull/25072"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25072"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25072/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25072/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25072/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f2c93a0291877f3e4af03ab279fba93201054d14"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25071","id":295197705,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MTk3NzA1","html_url":"https://github.com/apache/spark/pull/25071","diff_url":"https://github.com/apache/spark/pull/25071.diff","patch_url":"https://github.com/apache/spark/pull/25071.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25071","number":25071,"state":"closed","locked":false,"title":"[SPARK-28292][SQL] Enable inject user-defined Hint","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nCurrent catalyst construct, we can't add our user-defined hint to Analyzer. Since Catalyst will resolve hint first when analyze LogicalPlan,  after it resolve it' s own hints, it will call RemoveAllHint, so when we add Rule of hint to SparkSessionExtension, it will be ignored.\r\nThis PR is a small extension to SparkSessionExtension. It enable user to add user-defined hint to Analyze.\r\n\r\nFAQ:\r\nQ: Why we need this extension?\r\nA: Such as DataBricks,  in their delta platform, the add more hint for better join behavior such as RANK_JOIN,  and SKEW_JOIN, through these hints and their parameter, Catalyst will choose a better behavior to solve un-healthy join operator.  And we also can add some other hints to restrict user's behavior such as we only can submit query like **SELECT * FROM TABLE**  with a spec hint flag.\r\nWith this extension, you will have more freedom to customize your catalyst.\r\nAnd will a hint extension, you can combine you code with SparkSessionExtension. More safety.\r\n\r\nQ: How to write your hints.\r\nA: Blow is a simple example, it's function is to use hint to pass a LIMIT behavior to a subquery:\r\n```\r\nobject MyHint extends Rule[LogicalPlan] {\r\n // you hint name, a Set of string, for same Hint\r\n  private val MY_HINT_NAME = Set(\"MY_HINT\")\r\n\r\n  def apply(plan: LogicalPlan): LogicalPlan = plan.resolveOperators {\r\n  // match when there is a hint in you SQL\r\n    case h: UnresolvedHint if MY_HINT_NAME.contains(h.name.toUpperCase(Locale.ROOT)) =>\r\n     // resolve hint parameters\r\n    val limits = h.parameters match {\r\n        case Seq(IntegerLiteral(limits)) =>\r\n          limits\r\n        case Seq(limits: Int) =>\r\n          limits\r\n        case _ =>\r\n          throw new AnalysisException(s\"$MY_HINT_NAME Hint expects a limits number as parameter\")\r\n      }\r\n      // The result LogicalPlan with you hint , in there, it just add a Limit to current subquery\r\n      GlobalLimit(Literal(limits), LocalLimit(Literal(limits), h.child))\r\n  }\r\n}\r\n```\r\nSQL => \r\n`SELECT /* MY_HINT(10) */  * FROM TEST_TABLE`\r\n\r\nit will return same behavior as \r\n`SELECT  * FROM TEST_TABLE LIMIT 10`\r\n\r\n## How was this patch tested?\r\n\r\nAdded unit test.","created_at":"2019-07-08T06:47:30Z","updated_at":"2021-06-09T03:56:03Z","closed_at":"2019-09-16T23:44:34Z","merged_at":null,"merge_commit_sha":"d816e6cf70514aeb0fcf6c2852a023505d989561","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25071/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25071/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25071/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/af759fa83968fe58beccc5a24e573b650fd1f979","head":{"label":"AngersZhuuuu:SPARK-28292","ref":"SPARK-28292","sha":"af759fa83968fe58beccc5a24e573b650fd1f979","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":176224753,"node_id":"MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=","name":"spark","full_name":"AngersZhuuuu/spark","private":false,"owner":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/AngersZhuuuu/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/AngersZhuuuu/spark","forks_url":"https://api.github.com/repos/AngersZhuuuu/spark/forks","keys_url":"https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/AngersZhuuuu/spark/teams","hooks_url":"https://api.github.com/repos/AngersZhuuuu/spark/hooks","issue_events_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/AngersZhuuuu/spark/events","assignees_url":"https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/tags","blobs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/AngersZhuuuu/spark/languages","stargazers_url":"https://api.github.com/repos/AngersZhuuuu/spark/stargazers","contributors_url":"https://api.github.com/repos/AngersZhuuuu/spark/contributors","subscribers_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscribers","subscription_url":"https://api.github.com/repos/AngersZhuuuu/spark/subscription","commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/AngersZhuuuu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/AngersZhuuuu/spark/merges","archive_url":"https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/AngersZhuuuu/spark/downloads","issues_url":"https://api.github.com/repos/AngersZhuuuu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/AngersZhuuuu/spark/labels{/name}","releases_url":"https://api.github.com/repos/AngersZhuuuu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/AngersZhuuuu/spark/deployments","created_at":"2019-03-18T07:13:25Z","updated_at":"2024-12-31T06:48:27Z","pushed_at":"2024-12-31T06:45:23Z","git_url":"git://github.com/AngersZhuuuu/spark.git","ssh_url":"git@github.com:AngersZhuuuu/spark.git","clone_url":"https://github.com/AngersZhuuuu/spark.git","svn_url":"https://github.com/AngersZhuuuu/spark","homepage":"","size":446399,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"bf43541c928af2788c1e9990faf57e9508f974e9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25071"},"html":{"href":"https://github.com/apache/spark/pull/25071"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25071"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25071/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25071/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25071/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/af759fa83968fe58beccc5a24e573b650fd1f979"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25070","id":295174638,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MTc0NjM4","html_url":"https://github.com/apache/spark/pull/25070","diff_url":"https://github.com/apache/spark/pull/25070.diff","patch_url":"https://github.com/apache/spark/pull/25070.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25070","number":25070,"state":"closed","locked":false,"title":"[SPARK-28273][SQL][PYTHON] Convert and port 'pgSQL/case.sql' into UDF test base","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from `pgSQL/case.sql'` to test UDFs. Please see contribution guide of this umbrella ticket - [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n\r\nThis PR also contains two minor fixes:\r\n\r\n1. Change name of Scala UDF from `UDF:name(...)` to `name(...)` to be consistent with Python'\r\n\r\n2. Fix Scala UDF at `IntegratedUDFTestUtils.scala ` to handle `null` in strings.\r\n\r\n<details><summary>Diff comparing to 'pgSQL/case.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/pgSQL/case.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-case.sql.out\r\nindex fa078d16d6d..55bef64338f 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/pgSQL/case.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-case.sql.out\r\n@@ -115,7 +115,7 @@ struct<>\r\n -- !query 13\r\n SELECT '3' AS `One`,\r\n   CASE\r\n-    WHEN 1 < 2 THEN 3\r\n+    WHEN CAST(udf(1 < 2) AS boolean) THEN 3\r\n   END AS `Simple WHEN`\r\n -- !query 13 schema\r\n struct<One:string,Simple WHEN:int>\r\n@@ -126,10 +126,10 @@ struct<One:string,Simple WHEN:int>\r\n -- !query 14\r\n SELECT '<NULL>' AS `One`,\r\n   CASE\r\n-    WHEN 1 > 2 THEN 3\r\n+    WHEN 1 > 2 THEN udf(3)\r\n   END AS `Simple default`\r\n -- !query 14 schema\r\n-struct<One:string,Simple default:int>\r\n+struct<One:string,Simple default:string>\r\n -- !query 14 output\r\n <NULL> NULL\r\n\r\n@@ -137,17 +137,17 @@ struct<One:string,Simple default:int>\r\n -- !query 15\r\n SELECT '3' AS `One`,\r\n   CASE\r\n-    WHEN 1 < 2 THEN 3\r\n-    ELSE 4\r\n+    WHEN udf(1) < 2 THEN udf(3)\r\n+    ELSE udf(4)\r\n   END AS `Simple ELSE`\r\n -- !query 15 schema\r\n-struct<One:string,Simple ELSE:int>\r\n+struct<One:string,Simple ELSE:string>\r\n -- !query 15 output\r\n 3      3\r\n\r\n\r\n -- !query 16\r\n-SELECT '4' AS `One`,\r\n+SELECT udf('4') AS `One`,\r\n   CASE\r\n     WHEN 1 > 2 THEN 3\r\n     ELSE 4\r\n@@ -159,10 +159,10 @@ struct<One:string,ELSE default:int>\r\n\r\n\r\n -- !query 17\r\n-SELECT '6' AS `One`,\r\n+SELECT udf('6') AS `One`,\r\n   CASE\r\n-    WHEN 1 > 2 THEN 3\r\n-    WHEN 4 < 5 THEN 6\r\n+    WHEN CAST(udf(1 > 2) AS boolean) THEN 3\r\n+    WHEN udf(4) < 5 THEN 6\r\n     ELSE 7\r\n   END AS `Two WHEN with default`\r\n -- !query 17 schema\r\n@@ -173,7 +173,7 @@ struct<One:string,Two WHEN with default:int>\r\n\r\n -- !query 18\r\n SELECT '7' AS `None`,\r\n-  CASE WHEN rand() < 0 THEN 1\r\n+  CASE WHEN rand() < udf(0) THEN 1\r\n   END AS `NULL on no matches`\r\n -- !query 18 schema\r\n struct<None:string,NULL on no matches:int>\r\n@@ -182,36 +182,36 @@ struct<None:string,NULL on no matches:int>\r\n\r\n\r\n -- !query 19\r\n-SELECT CASE WHEN 1=0 THEN 1/0 WHEN 1=1 THEN 1 ELSE 2/0 END\r\n+SELECT CASE WHEN CAST(udf(1=0) AS boolean) THEN 1/0 WHEN 1=1 THEN 1 ELSE 2/0 END\r\n -- !query 19 schema\r\n-struct<CASE WHEN (1 = 0) THEN (CAST(1 AS DOUBLE) / CAST(0 AS DOUBLE)) WHEN (1 = 1) THEN CAST(1 AS DOUBLE) ELSE (CAST(2 AS DOUBLE) / CAST(0 AS DOUBLE)) END:double>\r\n+struct<CASE WHEN CAST(udf((1 = 0)) AS BOOLEAN) THEN (CAST(1 AS DOUBLE) / CAST(0 AS DOUBLE)) WHEN (1 = 1) THEN CAST(1 AS DOUBLE) ELSE (CAST(2 AS DOUBLE) / CAST(0 AS DOUBLE)) END:double>\r\n -- !query 19 output\r\n 1.0\r\n\r\n\r\n -- !query 20\r\n-SELECT CASE 1 WHEN 0 THEN 1/0 WHEN 1 THEN 1 ELSE 2/0 END\r\n+SELECT CASE 1 WHEN 0 THEN 1/udf(0) WHEN 1 THEN 1 ELSE 2/0 END\r\n -- !query 20 schema\r\n-struct<CASE WHEN (1 = 0) THEN (CAST(1 AS DOUBLE) / CAST(0 AS DOUBLE)) WHEN (1 = 1) THEN CAST(1 AS DOUBLE) ELSE (CAST(2 AS DOUBLE) / CAST(0 AS DOUBLE)) END:double>\r\n+struct<CASE WHEN (1 = 0) THEN (CAST(1 AS DOUBLE) / CAST(CAST(udf(0) AS DOUBLE) AS DOUBLE)) WHEN (1 = 1) THEN CAST(1 AS DOUBLE) ELSE (CAST(2 AS DOUBLE) / CAST(0 AS DOUBLE)) END:double>\r\n -- !query 20 output\r\n 1.0\r\n\r\n\r\n -- !query 21\r\n-SELECT CASE WHEN i > 100 THEN 1/0 ELSE 0 END FROM case_tbl\r\n+SELECT CASE WHEN i > 100 THEN udf(1/0) ELSE udf(0) END FROM case_tbl\r\n -- !query 21 schema\r\n-struct<CASE WHEN (i > 100) THEN (CAST(1 AS DOUBLE) / CAST(0 AS DOUBLE)) ELSE CAST(0 AS DOUBLE) END:double>\r\n+struct<CASE WHEN (i > 100) THEN udf((cast(1 as double) / cast(0 as double))) ELSE udf(0) END:string>\r\n -- !query 21 output\r\n-0.0\r\n-0.0\r\n-0.0\r\n-0.0\r\n+0\r\n+0\r\n+0\r\n+0\r\n\r\n\r\n -- !query 22\r\n-SELECT CASE 'a' WHEN 'a' THEN 1 ELSE 2 END\r\n+SELECT CASE 'a' WHEN 'a' THEN udf(1) ELSE udf(2) END\r\n -- !query 22 schema\r\n-struct<CASE WHEN (a = a) THEN 1 ELSE 2 END:int>\r\n+struct<CASE WHEN (a = a) THEN udf(1) ELSE udf(2) END:string>\r\n -- !query 22 output\r\n 1\r\n\r\n@@ -283,7 +283,7 @@ big\r\n\r\n\r\n -- !query 27\r\n-SELECT * FROM CASE_TBL WHERE COALESCE(f,i) = 4\r\n+SELECT * FROM CASE_TBL WHERE udf(COALESCE(f,i)) = 4\r\n -- !query 27 schema\r\n struct<i:int,f:double>\r\n -- !query 27 output\r\n@@ -291,7 +291,7 @@ struct<i:int,f:double>\r\n\r\n\r\n -- !query 28\r\n-SELECT * FROM CASE_TBL WHERE NULLIF(f,i) = 2\r\n+SELECT * FROM CASE_TBL WHERE udf(NULLIF(f,i)) = 2\r\n -- !query 28 schema\r\n struct<i:int,f:double>\r\n -- !query 28 output\r\n@@ -299,10 +299,10 @@ struct<i:int,f:double>\r\n\r\n\r\n -- !query 29\r\n-SELECT COALESCE(a.f, b.i, b.j)\r\n+SELECT udf(COALESCE(a.f, b.i, b.j))\r\n   FROM CASE_TBL a, CASE2_TBL b\r\n -- !query 29 schema\r\n-struct<coalesce(f, CAST(i AS DOUBLE), CAST(j AS DOUBLE)):double>\r\n+struct<udf(coalesce(f, cast(i as double), cast(j as double))):string>\r\n -- !query 29 output\r\n -30.3\r\n -30.3\r\n@@ -332,8 +332,8 @@ struct<coalesce(f, CAST(i AS DOUBLE), CAST(j AS DOUBLE)):double>\r\n\r\n -- !query 30\r\n SELECT *\r\n-  FROM CASE_TBL a, CASE2_TBL b\r\n-  WHERE COALESCE(a.f, b.i, b.j) = 2\r\n+   FROM CASE_TBL a, CASE2_TBL b\r\n+   WHERE udf(COALESCE(a.f, b.i, b.j)) = 2\r\n -- !query 30 schema\r\n struct<i:int,f:double,i:int,j:int>\r\n -- !query 30 output\r\n@@ -342,7 +342,7 @@ struct<i:int,f:double,i:int,j:int>\r\n\r\n\r\n -- !query 31\r\n-SELECT '' AS Five, NULLIF(a.i,b.i) AS `NULLIF(a.i,b.i)`,\r\n+SELECT udf('') AS Five, NULLIF(a.i,b.i) AS `NULLIF(a.i,b.i)`,\r\n   NULLIF(b.i, 4) AS `NULLIF(b.i,4)`\r\n   FROM CASE_TBL a, CASE2_TBL b\r\n -- !query 31 schema\r\n@@ -377,7 +377,7 @@ struct<Five:string,NULLIF(a.i,b.i):int,NULLIF(b.i,4):int>\r\n -- !query 32\r\n SELECT '' AS `Two`, *\r\n   FROM CASE_TBL a, CASE2_TBL b\r\n-  WHERE COALESCE(f,b.i) = 2\r\n+  WHERE CAST(udf(COALESCE(f,b.i) = 2) AS boolean)\r\n -- !query 32 schema\r\n struct<Two:string,i:int,f:double,i:int,j:int>\r\n -- !query 32 output\r\n@@ -388,15 +388,15 @@ struct<Two:string,i:int,f:double,i:int,j:int>\r\n -- !query 33\r\n SELECT CASE\r\n   (CASE vol('bar')\r\n-    WHEN 'foo' THEN 'it was foo!'\r\n-    WHEN vol(null) THEN 'null input'\r\n+    WHEN udf('foo') THEN 'it was foo!'\r\n+    WHEN udf(vol(null)) THEN 'null input'\r\n     WHEN 'bar' THEN 'it was bar!' END\r\n   )\r\n-  WHEN 'it was foo!' THEN 'foo recognized'\r\n-  WHEN 'it was bar!' THEN 'bar recognized'\r\n-  ELSE 'unrecognized' END\r\n+  WHEN udf('it was foo!') THEN 'foo recognized'\r\n+  WHEN 'it was bar!' THEN udf('bar recognized')\r\n+  ELSE 'unrecognized' END AS col\r\n -- !query 33 schema\r\n-struct<CASE WHEN (CASE WHEN (UDF:vol(bar) = foo) THEN it was foo! WHEN (UDF:vol(bar) = UDF:vol(null)) THEN null input WHEN (UDF:vol(bar) = bar) THEN it was bar! END = it was foo!) THEN foo recognized WHEN (CASE WHEN (UDF:vol(bar) = foo) THEN it was foo! WHEN (UDF:vol(bar) = UDF:vol(null)) THEN null input WHEN (UDF:vol(bar) = bar) THEN it was bar! END = it was bar!) THEN bar recognized ELSE unrecognized END:string>\r\n+struct<col:string>\r\n -- !query 33 output\r\n bar recognized\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\nhttps://github.com/apache/spark/pull/25069 contains the same minor fixes as it's required to write the tests.\r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).","created_at":"2019-07-08T04:53:32Z","updated_at":"2020-03-03T01:18:36Z","closed_at":"2019-07-09T02:54:42Z","merged_at":null,"merge_commit_sha":"62c0d25e8c96a1c1788229d62c122bc89255cd8d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25070/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25070/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25070/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/13c790dcafdfaaf943c42e8dfd69ccff8f31694c","head":{"label":"HyukjinKwon:SPARK-28273","ref":"SPARK-28273","sha":"13c790dcafdfaaf943c42e8dfd69ccff8f31694c","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"20469d43eb22c832b4d8f30c9e611ef622c3366d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25070"},"html":{"href":"https://github.com/apache/spark/pull/25070"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25070"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25070/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25070/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25070/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/13c790dcafdfaaf943c42e8dfd69ccff8f31694c"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25069","id":295163903,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MTYzOTAz","html_url":"https://github.com/apache/spark/pull/25069","diff_url":"https://github.com/apache/spark/pull/25069.diff","patch_url":"https://github.com/apache/spark/pull/25069.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25069","number":25069,"state":"closed","locked":false,"title":"[SPARK-28270][SQL][PYTHON] Convert and port 'pgSQL/aggregates_part1.sql' into UDF test base","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR adds some tests converted from `pgSQL/aggregates_part1.sql'` to test UDFs. Please see contribution guide of this umbrella ticket - [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).\r\n\r\nThis PR also contains two minor fixes:\r\n\r\n1. Change name of Scala UDF from `UDF:name(...)` to `name(...)` to be consistent with Python'\r\n\r\n2. Fix Scala UDF at `IntegratedUDFTestUtils.scala ` to handle `null` in strings.\r\n\r\n\r\n<details><summary>Diff comparing to 'pgSQL/aggregates_part1.sql'</summary>\r\n<p>\r\n\r\n```diff\r\ndiff --git a/sql/core/src/test/resources/sql-tests/results/pgSQL/aggregates_part1.sql.out b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part1.sql.out\r\nindex 51ca1d55869..124fdd6416e 100644\r\n--- a/sql/core/src/test/resources/sql-tests/results/pgSQL/aggregates_part1.sql.out\r\n+++ b/sql/core/src/test/resources/sql-tests/results/udf/pgSQL/udf-aggregates_part1.sql.out\r\n@@ -3,7 +3,7 @@\r\n\r\n\r\n -- !query 0\r\n-SELECT avg(four) AS avg_1 FROM onek\r\n+SELECT avg(udf(four)) AS avg_1 FROM onek\r\n -- !query 0 schema\r\n struct<avg_1:double>\r\n -- !query 0 output\r\n@@ -11,15 +11,15 @@ struct<avg_1:double>\r\n\r\n\r\n -- !query 1\r\n-SELECT avg(a) AS avg_32 FROM aggtest WHERE a < 100\r\n+SELECT udf(avg(a)) AS avg_32 FROM aggtest WHERE a < 100\r\n -- !query 1 schema\r\n-struct<avg_32:double>\r\n+struct<avg_32:string>\r\n -- !query 1 output\r\n 32.666666666666664\r\n\r\n\r\n -- !query 2\r\n-select CAST(avg(b) AS Decimal(10,3)) AS avg_107_943 FROM aggtest\r\n+select CAST(avg(udf(b)) AS Decimal(10,3)) AS avg_107_943 FROM aggtest\r\n -- !query 2 schema\r\n struct<avg_107_943:decimal(10,3)>\r\n -- !query 2 output\r\n@@ -27,285 +27,286 @@ struct<avg_107_943:decimal(10,3)>\r\n\r\n\r\n -- !query 3\r\n-SELECT sum(four) AS sum_1500 FROM onek\r\n+SELECT sum(udf(four)) AS sum_1500 FROM onek\r\n -- !query 3 schema\r\n-struct<sum_1500:bigint>\r\n+struct<sum_1500:double>\r\n -- !query 3 output\r\n-1500\r\n+1500.0\r\n\r\n\r\n -- !query 4\r\n-SELECT sum(a) AS sum_198 FROM aggtest\r\n+SELECT udf(sum(a)) AS sum_198 FROM aggtest\r\n -- !query 4 schema\r\n-struct<sum_198:bigint>\r\n+struct<sum_198:string>\r\n -- !query 4 output\r\n 198\r\n\r\n\r\n -- !query 5\r\n-SELECT sum(b) AS avg_431_773 FROM aggtest\r\n+SELECT udf(udf(sum(b))) AS avg_431_773 FROM aggtest\r\n -- !query 5 schema\r\n-struct<avg_431_773:double>\r\n+struct<avg_431_773:string>\r\n -- !query 5 output\r\n 431.77260909229517\r\n\r\n\r\n -- !query 6\r\n-SELECT max(four) AS max_3 FROM onek\r\n+SELECT udf(max(four)) AS max_3 FROM onek\r\n -- !query 6 schema\r\n-struct<max_3:int>\r\n+struct<max_3:string>\r\n -- !query 6 output\r\n 3\r\n\r\n\r\n -- !query 7\r\n-SELECT max(a) AS max_100 FROM aggtest\r\n+SELECT max(udf(a)) AS max_100 FROM aggtest\r\n -- !query 7 schema\r\n-struct<max_100:int>\r\n+struct<max_100:string>\r\n -- !query 7 output\r\n-100\r\n+56\r\n\r\n\r\n -- !query 8\r\n-SELECT max(aggtest.b) AS max_324_78 FROM aggtest\r\n+SELECT CAST(udf(udf(max(aggtest.b))) AS int) AS max_324_78 FROM aggtest\r\n -- !query 8 schema\r\n-struct<max_324_78:float>\r\n+struct<max_324_78:int>\r\n -- !query 8 output\r\n-324.78\r\n+324\r\n\r\n\r\n -- !query 9\r\n-SELECT stddev_pop(b) FROM aggtest\r\n+SELECT CAST(stddev_pop(udf(b)) AS int) FROM aggtest\r\n -- !query 9 schema\r\n-struct<stddev_pop(CAST(b AS DOUBLE)):double>\r\n+struct<CAST(stddev_pop(CAST(udf(b) AS DOUBLE)) AS INT):int>\r\n -- !query 9 output\r\n-131.10703231895047\r\n+131\r\n\r\n\r\n -- !query 10\r\n-SELECT stddev_samp(b) FROM aggtest\r\n+SELECT udf(stddev_samp(b)) FROM aggtest\r\n -- !query 10 schema\r\n-struct<stddev_samp(CAST(b AS DOUBLE)):double>\r\n+struct<udf(stddev_samp(cast(b as double))):string>\r\n -- !query 10 output\r\n 151.38936080399804\r\n\r\n\r\n -- !query 11\r\n-SELECT var_pop(b) FROM aggtest\r\n+SELECT CAST(var_pop(udf(b)) as int) FROM aggtest\r\n -- !query 11 schema\r\n-struct<var_pop(CAST(b AS DOUBLE)):double>\r\n+struct<CAST(var_pop(CAST(udf(b) AS DOUBLE)) AS INT):int>\r\n -- !query 11 output\r\n-17189.053923482323\r\n+17189\r\n\r\n\r\n -- !query 12\r\n-SELECT var_samp(b) FROM aggtest\r\n+SELECT udf(var_samp(b)) FROM aggtest\r\n -- !query 12 schema\r\n-struct<var_samp(CAST(b AS DOUBLE)):double>\r\n+struct<udf(var_samp(cast(b as double))):string>\r\n -- !query 12 output\r\n 22918.738564643096\r\n\r\n\r\n -- !query 13\r\n-SELECT stddev_pop(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT udf(stddev_pop(CAST(b AS Decimal(38,0)))) FROM aggtest\r\n -- !query 13 schema\r\n-struct<stddev_pop(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<udf(stddev_pop(cast(cast(b as decimal(38,0)) as double))):string>\r\n -- !query 13 output\r\n 131.18117242958306\r\n\r\n\r\n -- !query 14\r\n-SELECT stddev_samp(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT stddev_samp(CAST(udf(b) AS Decimal(38,0))) FROM aggtest\r\n -- !query 14 schema\r\n-struct<stddev_samp(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<stddev_samp(CAST(CAST(udf(b) AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n -- !query 14 output\r\n 151.47497042966097\r\n\r\n\r\n -- !query 15\r\n-SELECT var_pop(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT udf(var_pop(CAST(b AS Decimal(38,0)))) FROM aggtest\r\n -- !query 15 schema\r\n-struct<var_pop(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<udf(var_pop(cast(cast(b as decimal(38,0)) as double))):string>\r\n -- !query 15 output\r\n 17208.5\r\n\r\n\r\n -- !query 16\r\n-SELECT var_samp(CAST(b AS Decimal(38,0))) FROM aggtest\r\n+SELECT var_samp(udf(CAST(b AS Decimal(38,0)))) FROM aggtest\r\n -- !query 16 schema\r\n-struct<var_samp(CAST(CAST(b AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<var_samp(CAST(udf(cast(b as decimal(38,0))) AS DOUBLE)):double>\r\n -- !query 16 output\r\n 22944.666666666668\r\n\r\n\r\n -- !query 17\r\n-SELECT var_pop(1.0), var_samp(2.0)\r\n+SELECT udf(var_pop(1.0)), var_samp(udf(2.0))\r\n -- !query 17 schema\r\n-struct<var_pop(CAST(1.0 AS DOUBLE)):double,var_samp(CAST(2.0 AS DOUBLE)):double>\r\n+struct<udf(var_pop(cast(1.0 as double))):string,var_samp(CAST(udf(2.0) AS DOUBLE)):double>\r\n -- !query 17 output\r\n 0.0    NaN\r\n\r\n\r\n -- !query 18\r\n-SELECT stddev_pop(CAST(3.0 AS Decimal(38,0))), stddev_samp(CAST(4.0 AS Decimal(38,0)))\r\n+SELECT stddev_pop(udf(CAST(3.0 AS Decimal(38,0)))), stddev_samp(CAST(udf(4.0) AS Decimal(38,0)))\r\n -- !query 18 schema\r\n-struct<stddev_pop(CAST(CAST(3.0 AS DECIMAL(38,0)) AS DOUBLE)):double,stddev_samp(CAST(CAST(4.0 AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n+struct<stddev_pop(CAST(udf(cast(3.0 as decimal(38,0))) AS DOUBLE)):double,stddev_samp(CAST(CAST(udf(4.0) AS DECIMAL(38,0)) AS DOUBLE)):double>\r\n -- !query 18 output\r\n 0.0    NaN\r\n\r\n\r\n -- !query 19\r\n-select sum(CAST(null AS int)) from range(1,4)\r\n+select sum(udf(CAST(null AS int))) from range(1,4)\r\n -- !query 19 schema\r\n-struct<sum(CAST(NULL AS INT)):bigint>\r\n+struct<sum(CAST(udf(cast(null as int)) AS DOUBLE)):double>\r\n -- !query 19 output\r\n NULL\r\n\r\n\r\n -- !query 20\r\n-select sum(CAST(null AS long)) from range(1,4)\r\n+select sum(udf(CAST(null AS long))) from range(1,4)\r\n -- !query 20 schema\r\n-struct<sum(CAST(NULL AS BIGINT)):bigint>\r\n+struct<sum(CAST(udf(cast(null as bigint)) AS DOUBLE)):double>\r\n -- !query 20 output\r\n NULL\r\n\r\n\r\n -- !query 21\r\n-select sum(CAST(null AS Decimal(38,0))) from range(1,4)\r\n+select sum(udf(CAST(null AS Decimal(38,0)))) from range(1,4)\r\n -- !query 21 schema\r\n-struct<sum(CAST(NULL AS DECIMAL(38,0))):decimal(38,0)>\r\n+struct<sum(CAST(udf(cast(null as decimal(38,0))) AS DOUBLE)):double>\r\n -- !query 21 output\r\n NULL\r\n\r\n\r\n -- !query 22\r\n-select sum(CAST(null AS DOUBLE)) from range(1,4)\r\n+select sum(udf(CAST(null AS DOUBLE))) from range(1,4)\r\n -- !query 22 schema\r\n-struct<sum(CAST(NULL AS DOUBLE)):double>\r\n+struct<sum(CAST(udf(cast(null as double)) AS DOUBLE)):double>\r\n -- !query 22 output\r\n NULL\r\n\r\n\r\n -- !query 23\r\n-select avg(CAST(null AS int)) from range(1,4)\r\n+select avg(udf(CAST(null AS int))) from range(1,4)\r\n -- !query 23 schema\r\n-struct<avg(CAST(NULL AS INT)):double>\r\n+struct<avg(CAST(udf(cast(null as int)) AS DOUBLE)):double>\r\n -- !query 23 output\r\n NULL\r\n\r\n\r\n -- !query 24\r\n-select avg(CAST(null AS long)) from range(1,4)\r\n+select avg(udf(CAST(null AS long))) from range(1,4)\r\n -- !query 24 schema\r\n-struct<avg(CAST(NULL AS BIGINT)):double>\r\n+struct<avg(CAST(udf(cast(null as bigint)) AS DOUBLE)):double>\r\n -- !query 24 output\r\n NULL\r\n\r\n\r\n -- !query 25\r\n-select avg(CAST(null AS Decimal(38,0))) from range(1,4)\r\n+select avg(udf(CAST(null AS Decimal(38,0)))) from range(1,4)\r\n -- !query 25 schema\r\n-struct<avg(CAST(NULL AS DECIMAL(38,0))):decimal(38,4)>\r\n+struct<avg(CAST(udf(cast(null as decimal(38,0))) AS DOUBLE)):double>\r\n -- !query 25 output\r\n NULL\r\n\r\n\r\n -- !query 26\r\n-select avg(CAST(null AS DOUBLE)) from range(1,4)\r\n+select avg(udf(CAST(null AS DOUBLE))) from range(1,4)\r\n -- !query 26 schema\r\n-struct<avg(CAST(NULL AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(cast(null as double)) AS DOUBLE)):double>\r\n -- !query 26 output\r\n NULL\r\n\r\n\r\n -- !query 27\r\n-select sum(CAST('NaN' AS DOUBLE)) from range(1,4)\r\n+select sum(CAST(udf('NaN') AS DOUBLE)) from range(1,4)\r\n -- !query 27 schema\r\n-struct<sum(CAST(NaN AS DOUBLE)):double>\r\n+struct<sum(CAST(udf(NaN) AS DOUBLE)):double>\r\n -- !query 27 output\r\n NaN\r\n\r\n\r\n -- !query 28\r\n-select avg(CAST('NaN' AS DOUBLE)) from range(1,4)\r\n+select avg(CAST(udf('NaN') AS DOUBLE)) from range(1,4)\r\n -- !query 28 schema\r\n-struct<avg(CAST(NaN AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(NaN) AS DOUBLE)):double>\r\n -- !query 28 output\r\n NaN\r\n\r\n\r\n -- !query 29\r\n SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n-FROM (VALUES (CAST('1' AS DOUBLE)), (CAST('Infinity' AS DOUBLE))) v(x)\r\n+FROM (VALUES (CAST(udf('1') AS DOUBLE)), (CAST(udf('Infinity') AS DOUBLE))) v(x)\r\n -- !query 29 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<>\r\n -- !query 29 output\r\n-Infinity       NaN\r\n+org.apache.spark.sql.AnalysisException\r\n+cannot evaluate expression CAST(udf(1) AS DOUBLE) in inline table definition; line 2 pos 14\r\n\r\n\r\n -- !query 30\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('Infinity'), ('1')) v(x)\r\n -- !query 30 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(x) AS DOUBLE)):double,var_pop(CAST(udf(x) AS DOUBLE)):double>\r\n -- !query 30 output\r\n Infinity       NaN\r\n\r\n\r\n -- !query 31\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('Infinity'), ('Infinity')) v(x)\r\n -- !query 31 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(x) AS DOUBLE)):double,var_pop(CAST(udf(x) AS DOUBLE)):double>\r\n -- !query 31 output\r\n Infinity       NaN\r\n\r\n\r\n -- !query 32\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(CAST(udf(x) AS DOUBLE)), var_pop(CAST(udf(x) AS DOUBLE))\r\n FROM (VALUES ('-Infinity'), ('Infinity')) v(x)\r\n -- !query 32 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(x) AS DOUBLE)):double,var_pop(CAST(udf(x) AS DOUBLE)):double>\r\n -- !query 32 output\r\n NaN    NaN\r\n\r\n\r\n -- !query 33\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(udf(CAST(x AS DOUBLE))), udf(var_pop(CAST(x AS DOUBLE)))\r\n FROM (VALUES (100000003), (100000004), (100000006), (100000007)) v(x)\r\n -- !query 33 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(cast(x as double)) AS DOUBLE)):double,udf(var_pop(cast(x as double))):string>\r\n -- !query 33 output\r\n 1.00000005E8   2.5\r\n\r\n\r\n -- !query 34\r\n-SELECT avg(CAST(x AS DOUBLE)), var_pop(CAST(x AS DOUBLE))\r\n+SELECT avg(udf(CAST(x AS DOUBLE))), udf(var_pop(CAST(x AS DOUBLE)))\r\n FROM (VALUES (7000000000005), (7000000000007)) v(x)\r\n -- !query 34 schema\r\n-struct<avg(CAST(x AS DOUBLE)):double,var_pop(CAST(x AS DOUBLE)):double>\r\n+struct<avg(CAST(udf(cast(x as double)) AS DOUBLE)):double,udf(var_pop(cast(x as double))):string>\r\n -- !query 34 output\r\n 7.000000000006E12      1.0\r\n\r\n\r\n -- !query 35\r\n-SELECT covar_pop(b, a), covar_samp(b, a) FROM aggtest\r\n+SELECT CAST(udf(covar_pop(b, udf(a))) AS int), CAST(covar_samp(udf(b), a) as int) FROM aggtest\r\n -- !query 35 schema\r\n-struct<covar_pop(CAST(b AS DOUBLE), CAST(a AS DOUBLE)):double,covar_samp(CAST(b AS DOUBLE), CAST(a AS DOUBLE)):double>\r\n+struct<CAST(udf(covar_pop(cast(b as double), cast(udf(a) as double))) AS INT):int,CAST(covar_samp(CAST(udf(b) AS DOUBLE), CAST(a AS DOUBLE)) AS INT):int>\r\n -- !query 35 output\r\n-653.6289553875104      871.5052738500139\r\n+653    871\r\n\r\n\r\n -- !query 36\r\n-SELECT corr(b, a) FROM aggtest\r\n+SELECT corr(b, udf(a)) FROM aggtest\r\n -- !query 36 schema\r\n-struct<corr(CAST(b AS DOUBLE), CAST(a AS DOUBLE)):double>\r\n+struct<corr(CAST(b AS DOUBLE), CAST(udf(a) AS DOUBLE)):double>\r\n -- !query 36 output\r\n 0.1396345165178734\r\n\r\n\r\n -- !query 37\r\n-SELECT count(four) AS cnt_1000 FROM onek\r\n+SELECT count(udf(four)) AS cnt_1000 FROM onek\r\n -- !query 37 schema\r\n struct<cnt_1000:bigint>\r\n -- !query 37 output\r\n@@ -313,36 +314,36 @@ struct<cnt_1000:bigint>\r\n\r\n\r\n -- !query 38\r\n-SELECT count(DISTINCT four) AS cnt_4 FROM onek\r\n+SELECT udf(count(DISTINCT four)) AS cnt_4 FROM onek\r\n -- !query 38 schema\r\n-struct<cnt_4:bigint>\r\n+struct<cnt_4:string>\r\n -- !query 38 output\r\n 4\r\n\r\n\r\n -- !query 39\r\n-select ten, count(*), sum(four) from onek\r\n+select ten, udf(count(*)), sum(udf(four)) from onek\r\n group by ten order by ten\r\n -- !query 39 schema\r\n-struct<ten:int,count(1):bigint,sum(four):bigint>\r\n+struct<ten:int,udf(count(1)):string,sum(CAST(udf(four) AS DOUBLE)):double>\r\n -- !query 39 output\r\n-0      100     100\r\n-1      100     200\r\n-2      100     100\r\n-3      100     200\r\n-4      100     100\r\n-5      100     200\r\n-6      100     100\r\n-7      100     200\r\n-8      100     100\r\n-9      100     200\r\n+0      100     100.0\r\n+1      100     200.0\r\n+2      100     100.0\r\n+3      100     200.0\r\n+4      100     100.0\r\n+5      100     200.0\r\n+6      100     100.0\r\n+7      100     200.0\r\n+8      100     100.0\r\n+9      100     200.0\r\n\r\n\r\n -- !query 40\r\n-select ten, count(four), sum(DISTINCT four) from onek\r\n+select ten, count(udf(four)), udf(sum(DISTINCT four)) from onek\r\n group by ten order by ten\r\n -- !query 40 schema\r\n-struct<ten:int,count(four):bigint,sum(DISTINCT four):bigint>\r\n+struct<ten:int,count(udf(four)):bigint,udf(sum(distinct cast(four as bigint))):string>\r\n -- !query 40 output\r\n 0      100     2\r\n 1      100     4\r\n@@ -357,11 +358,11 @@ struct<ten:int,count(four):bigint,sum(DISTINCT four):bigint>\r\n\r\n\r\n -- !query 41\r\n-select ten, sum(distinct four) from onek a\r\n+select ten, udf(sum(distinct four)) from onek a\r\n group by ten\r\n-having exists (select 1 from onek b where sum(distinct a.four) = b.four)\r\n+having exists (select 1 from onek b where udf(sum(distinct a.four)) = b.four)\r\n -- !query 41 schema\r\n-struct<ten:int,sum(DISTINCT four):bigint>\r\n+struct<ten:int,udf(sum(distinct cast(four as bigint))):string>\r\n -- !query 41 output\r\n 0      2\r\n 2      2\r\n@@ -374,23 +375,23 @@ struct<ten:int,sum(DISTINCT four):bigint>\r\n select ten, sum(distinct four) from onek a\r\n group by ten\r\n having exists (select 1 from onek b\r\n-               where sum(distinct a.four + b.four) = b.four)\r\n+               where sum(distinct a.four + b.four) = udf(b.four))\r\n -- !query 42 schema\r\n struct<>\r\n -- !query 42 output\r\n org.apache.spark.sql.AnalysisException\r\n\r\n Aggregate/Window/Generate expressions are not valid in where clause of the query.\r\n-Expression in where clause: [(sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT)) = CAST(b.`four` AS BIGINT))]\r\n+Expression in where clause: [(sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT)) = CAST(udf(four) AS BIGINT))]\r\n Invalid expressions: [sum(DISTINCT CAST((outer() + b.`four`) AS BIGINT))];\r\n\r\n\r\n -- !query 43\r\n select\r\n-  (select max((select i.unique2 from tenk1 i where i.unique1 = o.unique1)))\r\n+  (select udf(max((select i.unique2 from tenk1 i where i.unique1 = o.unique1))))\r\n from tenk1 o\r\n -- !query 43 schema\r\n struct<>\r\n -- !query 43 output\r\n org.apache.spark.sql.AnalysisException\r\n-cannot resolve '`o.unique1`' given input columns: [i.even, i.fivethous, i.four, i.hundred, i.odd, i.string4, i.stringu1, i.stringu2, i.ten, i.tenthous, i.thousand, i.twenty, i.two, i.twothousand, i.unique1, i.unique2]; line 2 pos 63\r\n+cannot resolve '`o.unique1`' given input columns: [i.even, i.fivethous, i.four, i.hundred, i.odd, i.string4, i.stringu1, i.stringu2, i.ten, i.tenthous, i.thousand, i.twenty, i.two, i.twothousand, i.unique1, i.unique2]; line 2 pos 67\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\nNote that, currently, `IntegratedUDFTestUtils.scala`'s UDFs only return strings. There are some differences between those UDFs (Scala, Pandas and Python):\r\n\r\n  - Python's string representation of floats can make the tests flaky. (See https://docs.python.org/3/tutorial/floatingpoint.html). To work around this, I had to `CAST(... as int)`.\r\n  - There are string representation differences between `Inf` `-Inf` <> `Infinity` `-Infinity` and  `nan` <> `NaN`\r\n  - Maybe we should add other type versions of UDFs if this makes adding tests difficult.\r\n\r\nNote that one issue found - [SPARK-28291](https://issues.apache.org/jira/browse/SPARK-28291). The test was commented for now.\r\n\r\n## How was this patch tested?\r\n\r\nTested as guided in [SPARK-27921](https://issues.apache.org/jira/browse/SPARK-27921).","created_at":"2019-07-08T03:41:32Z","updated_at":"2020-03-03T01:18:31Z","closed_at":"2019-07-11T05:49:14Z","merged_at":null,"merge_commit_sha":"c2f70df9381b17fbb54fce5bdea89e7e8317946f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25069/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25069/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25069/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/99f01f73c5b5f6f21e9bbcce2a88cad8878d1945","head":{"label":"HyukjinKwon:SPARK-28270","ref":"SPARK-28270","sha":"99f01f73c5b5f6f21e9bbcce2a88cad8878d1945","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f15102b1702b64a54233ae31357e32335722f4e5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25069"},"html":{"href":"https://github.com/apache/spark/pull/25069"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25069"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25069/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25069/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25069/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/99f01f73c5b5f6f21e9bbcce2a88cad8878d1945"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25068","id":295158919,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MTU4OTE5","html_url":"https://github.com/apache/spark/pull/25068","diff_url":"https://github.com/apache/spark/pull/25068.diff","patch_url":"https://github.com/apache/spark/pull/25068.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25068","number":25068,"state":"closed","locked":false,"title":"[SPARK-28156][SQL][BACKPORT-2.4] Self-join should not miss cached view","user":{"login":"bersprockets","id":21131848,"node_id":"MDQ6VXNlcjIxMTMxODQ4","avatar_url":"https://avatars.githubusercontent.com/u/21131848?v=4","gravatar_id":"","url":"https://api.github.com/users/bersprockets","html_url":"https://github.com/bersprockets","followers_url":"https://api.github.com/users/bersprockets/followers","following_url":"https://api.github.com/users/bersprockets/following{/other_user}","gists_url":"https://api.github.com/users/bersprockets/gists{/gist_id}","starred_url":"https://api.github.com/users/bersprockets/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bersprockets/subscriptions","organizations_url":"https://api.github.com/users/bersprockets/orgs","repos_url":"https://api.github.com/users/bersprockets/repos","events_url":"https://api.github.com/users/bersprockets/events{/privacy}","received_events_url":"https://api.github.com/users/bersprockets/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"Back-port of #24960 to branch-2.4.\r\n\r\nThe issue is when self-join a cached view, only one side of join uses cached relation. The cause is in `ResolveReferences` we do deduplicate for a view to have new output attributes. Then in `AliasViewChild`, the rule adds extra project under a view. So it breaks cache matching.\r\n\r\nThe fix is when dedup, we only dedup a view which has output different to its child plan. Otherwise, we dedup on the view's child plan.\r\n\r\n```scala\r\nval df = Seq.tabulate(5) { x => (x, x + 1, x + 2, x + 3) }.toDF(\"a\", \"b\", \"c\", \"d\")\r\ndf.write.mode(\"overwrite\").format(\"orc\").saveAsTable(\"table1\")\r\n\r\nsql(\"drop view if exists table1_vw\")\r\nsql(\"create view table1_vw as select * from table1\")\r\n\r\nval cachedView = sql(\"select a, b, c, d from table1_vw\")\r\n\r\ncachedView.createOrReplaceTempView(\"cachedview\")\r\ncachedView.persist()\r\n\r\nval queryDf = sql(\r\n  s\"\"\"select leftside.a, leftside.b\r\n      |from cachedview leftside\r\n      |join cachedview rightside\r\n      |on leftside.a = rightside.a\r\n    \"\"\".stripMargin)\r\n```\r\n\r\nQuery plan before this PR:\r\n```scala\r\n== Physical Plan ==\r\n*(2) Project [a#12664, b#12665]\r\n+- *(2) BroadcastHashJoin [a#12664], [a#12660], Inner, BuildRight\r\n   :- *(2) Filter isnotnull(a#12664)\r\n   :  +- *(2) InMemoryTableScan [a#12664, b#12665], [isnotnull(a#12664)]\r\n   :        +- InMemoryRelation [a#12664, b#12665, c#12666, d#12667], StorageLevel(disk, memory, deserialized, 1 replicas)\r\n   :              +- *(1) FileScan orc default.table1[a#12660,b#12661,c#12662,d#12663] Batched: true, DataFilters: [], Format: ORC, Location: InMemoryF\r\nileIndex[file:/Users/viirya/repos/spark-1/sql/core/spark-warehouse/org.apache.spark.sql...., PartitionFilters: [], PushedFilters: [], ReadSchema: struc\r\nt<a:int,b:int,c:int,d:int>\r\n   +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))\r\n      +- *(1) Project [a#12660]\r\n         +- *(1) Filter isnotnull(a#12660)\r\n            +- *(1) FileScan orc default.table1[a#12660] Batched: true, DataFilters: [isnotnull(a#12660)], Format: ORC, Location: InMemoryFileIndex[fil\r\ne:/Users/viirya/repos/spark-1/sql/core/spark-warehouse/org.apache.spark.sql...., PartitionFilters: [], PushedFilters: [IsNotNull(a)], ReadSchema: struc\r\nt<a:int>\r\n```\r\n\r\nQuery plan after this PR:\r\n```scala\r\n== Physical Plan ==\r\n*(2) Project [a#12664, b#12665]\r\n+- *(2) BroadcastHashJoin [a#12664], [a#12692], Inner, BuildRight\r\n   :- *(2) Filter isnotnull(a#12664)\r\n   :  +- *(2) InMemoryTableScan [a#12664, b#12665], [isnotnull(a#12664)]\r\n   :        +- InMemoryRelation [a#12664, b#12665, c#12666, d#12667], StorageLevel(disk, memory, deserialized, 1 replicas)\r\n   :              +- *(1) FileScan orc default.table1[a#12660,b#12661,c#12662,d#12663] Batched: true, DataFilters: [], Format: ORC, Location: InMemoryFileIndex[file:/Users/viirya/repos/spark-1/sql/core/spark-warehouse/org.apache.spark.sql...., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<a:int,b:int,c:int,d:int>\r\n   +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)))\r\n      +- *(1) Filter isnotnull(a#12692)\r\n         +- *(1) InMemoryTableScan [a#12692], [isnotnull(a#12692)]\r\n               +- InMemoryRelation [a#12692, b#12693, c#12694, d#12695], StorageLevel(disk, memory, deserialized, 1 replicas)\r\n                     +- *(1) FileScan orc default.table1[a#12660,b#12661,c#12662,d#12663] Batched: true, DataFilters: [], Format: ORC, Location: InMemoryFileIndex[file:/Users/viirya/repos/spark-1/sql/core/spark-warehouse/org.apache.spark.sql...., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<a:int,b:int,c:int,d:int>\r\n```\r\n\r\nAdded test.","created_at":"2019-07-08T03:02:50Z","updated_at":"2022-05-01T01:17:59Z","closed_at":"2019-07-25T08:36:51Z","merged_at":null,"merge_commit_sha":"e1ae0fa07db05f6fc3732c7b4b58b526e4ae4e1e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25068/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25068/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25068/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/474c16ea5eae33da3f198c8f240a77ae8b1ce13e","head":{"label":"bersprockets:selfjoin_24","ref":"selfjoin_24","sha":"474c16ea5eae33da3f198c8f240a77ae8b1ce13e","user":{"login":"bersprockets","id":21131848,"node_id":"MDQ6VXNlcjIxMTMxODQ4","avatar_url":"https://avatars.githubusercontent.com/u/21131848?v=4","gravatar_id":"","url":"https://api.github.com/users/bersprockets","html_url":"https://github.com/bersprockets","followers_url":"https://api.github.com/users/bersprockets/followers","following_url":"https://api.github.com/users/bersprockets/following{/other_user}","gists_url":"https://api.github.com/users/bersprockets/gists{/gist_id}","starred_url":"https://api.github.com/users/bersprockets/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bersprockets/subscriptions","organizations_url":"https://api.github.com/users/bersprockets/orgs","repos_url":"https://api.github.com/users/bersprockets/repos","events_url":"https://api.github.com/users/bersprockets/events{/privacy}","received_events_url":"https://api.github.com/users/bersprockets/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":115567071,"node_id":"MDEwOlJlcG9zaXRvcnkxMTU1NjcwNzE=","name":"spark","full_name":"bersprockets/spark","private":false,"owner":{"login":"bersprockets","id":21131848,"node_id":"MDQ6VXNlcjIxMTMxODQ4","avatar_url":"https://avatars.githubusercontent.com/u/21131848?v=4","gravatar_id":"","url":"https://api.github.com/users/bersprockets","html_url":"https://github.com/bersprockets","followers_url":"https://api.github.com/users/bersprockets/followers","following_url":"https://api.github.com/users/bersprockets/following{/other_user}","gists_url":"https://api.github.com/users/bersprockets/gists{/gist_id}","starred_url":"https://api.github.com/users/bersprockets/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bersprockets/subscriptions","organizations_url":"https://api.github.com/users/bersprockets/orgs","repos_url":"https://api.github.com/users/bersprockets/repos","events_url":"https://api.github.com/users/bersprockets/events{/privacy}","received_events_url":"https://api.github.com/users/bersprockets/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bersprockets/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/bersprockets/spark","forks_url":"https://api.github.com/repos/bersprockets/spark/forks","keys_url":"https://api.github.com/repos/bersprockets/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bersprockets/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bersprockets/spark/teams","hooks_url":"https://api.github.com/repos/bersprockets/spark/hooks","issue_events_url":"https://api.github.com/repos/bersprockets/spark/issues/events{/number}","events_url":"https://api.github.com/repos/bersprockets/spark/events","assignees_url":"https://api.github.com/repos/bersprockets/spark/assignees{/user}","branches_url":"https://api.github.com/repos/bersprockets/spark/branches{/branch}","tags_url":"https://api.github.com/repos/bersprockets/spark/tags","blobs_url":"https://api.github.com/repos/bersprockets/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bersprockets/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bersprockets/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/bersprockets/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bersprockets/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/bersprockets/spark/languages","stargazers_url":"https://api.github.com/repos/bersprockets/spark/stargazers","contributors_url":"https://api.github.com/repos/bersprockets/spark/contributors","subscribers_url":"https://api.github.com/repos/bersprockets/spark/subscribers","subscription_url":"https://api.github.com/repos/bersprockets/spark/subscription","commits_url":"https://api.github.com/repos/bersprockets/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/bersprockets/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/bersprockets/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/bersprockets/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/bersprockets/spark/contents/{+path}","compare_url":"https://api.github.com/repos/bersprockets/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bersprockets/spark/merges","archive_url":"https://api.github.com/repos/bersprockets/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bersprockets/spark/downloads","issues_url":"https://api.github.com/repos/bersprockets/spark/issues{/number}","pulls_url":"https://api.github.com/repos/bersprockets/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/bersprockets/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/bersprockets/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bersprockets/spark/labels{/name}","releases_url":"https://api.github.com/repos/bersprockets/spark/releases{/id}","deployments_url":"https://api.github.com/repos/bersprockets/spark/deployments","created_at":"2017-12-28T00:03:24Z","updated_at":"2025-01-24T22:51:50Z","pushed_at":"2025-01-24T22:51:35Z","git_url":"git://github.com/bersprockets/spark.git","ssh_url":"git@github.com:bersprockets/spark.git","clone_url":"https://github.com/bersprockets/spark.git","svn_url":"https://github.com/bersprockets/spark","homepage":null,"size":475116,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:branch-2.4","ref":"branch-2.4","sha":"ec6d0c9ab2a3cab586e73def9167a120780a2fbe","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25068"},"html":{"href":"https://github.com/apache/spark/pull/25068"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25068"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25068/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25068/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25068/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/474c16ea5eae33da3f198c8f240a77ae8b1ce13e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25067","id":295150647,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MTUwNjQ3","html_url":"https://github.com/apache/spark/pull/25067","diff_url":"https://github.com/apache/spark/pull/25067.diff","patch_url":"https://github.com/apache/spark/pull/25067.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25067","number":25067,"state":"closed","locked":false,"title":"[SPARK-28290][CORE][SQL] Use SslContextFactory.Server instead of SslContextFactory","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n`SslContextFactory` is deprecated at Jetty 9.4 and we are using `9.4.18.v20190429`. This PR aims to replace it with `SslContextFactory.Server`.\r\n- https://www.eclipse.org/jetty/javadoc/9.4.19.v20190610/org/eclipse/jetty/util/ssl/SslContextFactory.html\r\n- https://www.eclipse.org/jetty/javadoc/9.3.24.v20180605/org/eclipse/jetty/util/ssl/SslContextFactory.html\r\n\r\n```\r\n[WARNING] /Users/dhyun/APACHE/spark/core/src/main/scala/org/apache/spark/SSLOptions.scala:71:\r\nconstructor SslContextFactory in class SslContextFactory is deprecated:\r\nsee corresponding Javadoc for more information.\r\n[WARNING]       val sslContextFactory = new SslContextFactory()\r\n[WARNING]                               ^\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nPass the Jenkins with the existing tests.","created_at":"2019-07-08T01:59:11Z","updated_at":"2019-07-10T16:10:39Z","closed_at":"2019-07-10T16:10:39Z","merged_at":null,"merge_commit_sha":"5d55460faee242f08a0c0498483272fb95e8ff1f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25067/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25067/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25067/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/895af34271485c173a81768cb33edd26909709d6","head":{"label":"dongjoon-hyun:SPARK-28290","ref":"SPARK-28290","sha":"895af34271485c173a81768cb33edd26909709d6","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"20469d43eb22c832b4d8f30c9e611ef622c3366d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25067"},"html":{"href":"https://github.com/apache/spark/pull/25067"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25067"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25067/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25067/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25067/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/895af34271485c173a81768cb33edd26909709d6"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25066","id":295123077,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MTIzMDc3","html_url":"https://github.com/apache/spark/pull/25066","diff_url":"https://github.com/apache/spark/pull/25066.diff","patch_url":"https://github.com/apache/spark/pull/25066.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25066","number":25066,"state":"closed","locked":false,"title":"[SPARK-28156][SQL][BACKPORT-2.3] Self-join should not miss cached view","user":{"login":"bersprockets","id":21131848,"node_id":"MDQ6VXNlcjIxMTMxODQ4","avatar_url":"https://avatars.githubusercontent.com/u/21131848?v=4","gravatar_id":"","url":"https://api.github.com/users/bersprockets","html_url":"https://github.com/bersprockets","followers_url":"https://api.github.com/users/bersprockets/followers","following_url":"https://api.github.com/users/bersprockets/following{/other_user}","gists_url":"https://api.github.com/users/bersprockets/gists{/gist_id}","starred_url":"https://api.github.com/users/bersprockets/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bersprockets/subscriptions","organizations_url":"https://api.github.com/users/bersprockets/orgs","repos_url":"https://api.github.com/users/bersprockets/repos","events_url":"https://api.github.com/users/bersprockets/events{/privacy}","received_events_url":"https://api.github.com/users/bersprockets/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"Back-port of #24960 to branch-2.3.\r\n\r\nThe issue is when self-join a cached view, only one side of join uses cached relation. The cause is in `ResolveReferences` we do deduplicate for a view to have new output attributes. Then in `AliasViewChild`, the rule adds extra project under a view. So it breaks cache matching.\r\n\r\nThe fix is when dedup, we only dedup a view which has output different to its child plan. Otherwise, we dedup on the view's child plan.\r\n\r\n```scala\r\nval df = Seq.tabulate(5) { x => (x, x + 1, x + 2, x + 3) }.toDF(\"a\", \"b\", \"c\", \"d\")\r\ndf.write.mode(\"overwrite\").format(\"orc\").saveAsTable(\"table1\")\r\n\r\nsql(\"drop view if exists table1_vw\")\r\nsql(\"create view table1_vw as select * from table1\")\r\n\r\nval cachedView = sql(\"select a, b, c, d from table1_vw\")\r\n\r\ncachedView.createOrReplaceTempView(\"cachedview\")\r\ncachedView.persist()\r\n\r\nval queryDf = sql(\r\n  s\"\"\"select leftside.a, leftside.b\r\n      |from cachedview leftside\r\n      |join cachedview rightside\r\n      |on leftside.a = rightside.a\r\n    \"\"\".stripMargin)\r\n```\r\n\r\nQuery plan before this PR:\r\n```scala\r\n== Physical Plan ==\r\n*(2) Project [a#12664, b#12665]\r\n+- *(2) BroadcastHashJoin [a#12664], [a#12660], Inner, BuildRight\r\n   :- *(2) Filter isnotnull(a#12664)\r\n   :  +- *(2) InMemoryTableScan [a#12664, b#12665], [isnotnull(a#12664)]\r\n   :        +- InMemoryRelation [a#12664, b#12665, c#12666, d#12667], StorageLevel(disk, memory, deserialized, 1 replicas)\r\n   :              +- *(1) FileScan orc default.table1[a#12660,b#12661,c#12662,d#12663] Batched: true, DataFilters: [], Format: ORC, Location: InMemoryF\r\nileIndex[file:/Users/viirya/repos/spark-1/sql/core/spark-warehouse/org.apache.spark.sql...., PartitionFilters: [], PushedFilters: [], ReadSchema: struc\r\nt<a:int,b:int,c:int,d:int>\r\n   +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))\r\n      +- *(1) Project [a#12660]\r\n         +- *(1) Filter isnotnull(a#12660)\r\n            +- *(1) FileScan orc default.table1[a#12660] Batched: true, DataFilters: [isnotnull(a#12660)], Format: ORC, Location: InMemoryFileIndex[fil\r\ne:/Users/viirya/repos/spark-1/sql/core/spark-warehouse/org.apache.spark.sql...., PartitionFilters: [], PushedFilters: [IsNotNull(a)], ReadSchema: struc\r\nt<a:int>\r\n```\r\n\r\nQuery plan after this PR:\r\n```scala\r\n== Physical Plan ==\r\n*(2) Project [a#12664, b#12665]\r\n+- *(2) BroadcastHashJoin [a#12664], [a#12692], Inner, BuildRight\r\n   :- *(2) Filter isnotnull(a#12664)\r\n   :  +- *(2) InMemoryTableScan [a#12664, b#12665], [isnotnull(a#12664)]\r\n   :        +- InMemoryRelation [a#12664, b#12665, c#12666, d#12667], StorageLevel(disk, memory, deserialized, 1 replicas)\r\n   :              +- *(1) FileScan orc default.table1[a#12660,b#12661,c#12662,d#12663] Batched: true, DataFilters: [], Format: ORC, Location: InMemoryFileIndex[file:/Users/viirya/repos/spark-1/sql/core/spark-warehouse/org.apache.spark.sql...., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<a:int,b:int,c:int,d:int>\r\n   +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)))\r\n      +- *(1) Filter isnotnull(a#12692)\r\n         +- *(1) InMemoryTableScan [a#12692], [isnotnull(a#12692)]\r\n               +- InMemoryRelation [a#12692, b#12693, c#12694, d#12695], StorageLevel(disk, memory, deserialized, 1 replicas)\r\n                     +- *(1) FileScan orc default.table1[a#12660,b#12661,c#12662,d#12663] Batched: true, DataFilters: [], Format: ORC, Location: InMemoryFileIndex[file:/Users/viirya/repos/spark-1/sql/core/spark-warehouse/org.apache.spark.sql...., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<a:int,b:int,c:int,d:int>\r\n```\r\n\r\nAdded test.","created_at":"2019-07-07T18:50:12Z","updated_at":"2022-05-01T01:17:49Z","closed_at":"2019-07-07T23:14:09Z","merged_at":null,"merge_commit_sha":"5665989c7156ccd5b3571dd7638a35eabb4a72ec","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25066/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25066/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25066/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/54417a777c4378cc6ac5ccedf9d3c77106139548","head":{"label":"bersprockets:selfjoin_23","ref":"selfjoin_23","sha":"54417a777c4378cc6ac5ccedf9d3c77106139548","user":{"login":"bersprockets","id":21131848,"node_id":"MDQ6VXNlcjIxMTMxODQ4","avatar_url":"https://avatars.githubusercontent.com/u/21131848?v=4","gravatar_id":"","url":"https://api.github.com/users/bersprockets","html_url":"https://github.com/bersprockets","followers_url":"https://api.github.com/users/bersprockets/followers","following_url":"https://api.github.com/users/bersprockets/following{/other_user}","gists_url":"https://api.github.com/users/bersprockets/gists{/gist_id}","starred_url":"https://api.github.com/users/bersprockets/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bersprockets/subscriptions","organizations_url":"https://api.github.com/users/bersprockets/orgs","repos_url":"https://api.github.com/users/bersprockets/repos","events_url":"https://api.github.com/users/bersprockets/events{/privacy}","received_events_url":"https://api.github.com/users/bersprockets/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":115567071,"node_id":"MDEwOlJlcG9zaXRvcnkxMTU1NjcwNzE=","name":"spark","full_name":"bersprockets/spark","private":false,"owner":{"login":"bersprockets","id":21131848,"node_id":"MDQ6VXNlcjIxMTMxODQ4","avatar_url":"https://avatars.githubusercontent.com/u/21131848?v=4","gravatar_id":"","url":"https://api.github.com/users/bersprockets","html_url":"https://github.com/bersprockets","followers_url":"https://api.github.com/users/bersprockets/followers","following_url":"https://api.github.com/users/bersprockets/following{/other_user}","gists_url":"https://api.github.com/users/bersprockets/gists{/gist_id}","starred_url":"https://api.github.com/users/bersprockets/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bersprockets/subscriptions","organizations_url":"https://api.github.com/users/bersprockets/orgs","repos_url":"https://api.github.com/users/bersprockets/repos","events_url":"https://api.github.com/users/bersprockets/events{/privacy}","received_events_url":"https://api.github.com/users/bersprockets/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bersprockets/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/bersprockets/spark","forks_url":"https://api.github.com/repos/bersprockets/spark/forks","keys_url":"https://api.github.com/repos/bersprockets/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bersprockets/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bersprockets/spark/teams","hooks_url":"https://api.github.com/repos/bersprockets/spark/hooks","issue_events_url":"https://api.github.com/repos/bersprockets/spark/issues/events{/number}","events_url":"https://api.github.com/repos/bersprockets/spark/events","assignees_url":"https://api.github.com/repos/bersprockets/spark/assignees{/user}","branches_url":"https://api.github.com/repos/bersprockets/spark/branches{/branch}","tags_url":"https://api.github.com/repos/bersprockets/spark/tags","blobs_url":"https://api.github.com/repos/bersprockets/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bersprockets/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bersprockets/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/bersprockets/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bersprockets/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/bersprockets/spark/languages","stargazers_url":"https://api.github.com/repos/bersprockets/spark/stargazers","contributors_url":"https://api.github.com/repos/bersprockets/spark/contributors","subscribers_url":"https://api.github.com/repos/bersprockets/spark/subscribers","subscription_url":"https://api.github.com/repos/bersprockets/spark/subscription","commits_url":"https://api.github.com/repos/bersprockets/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/bersprockets/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/bersprockets/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/bersprockets/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/bersprockets/spark/contents/{+path}","compare_url":"https://api.github.com/repos/bersprockets/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bersprockets/spark/merges","archive_url":"https://api.github.com/repos/bersprockets/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bersprockets/spark/downloads","issues_url":"https://api.github.com/repos/bersprockets/spark/issues{/number}","pulls_url":"https://api.github.com/repos/bersprockets/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/bersprockets/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/bersprockets/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bersprockets/spark/labels{/name}","releases_url":"https://api.github.com/repos/bersprockets/spark/releases{/id}","deployments_url":"https://api.github.com/repos/bersprockets/spark/deployments","created_at":"2017-12-28T00:03:24Z","updated_at":"2025-01-24T22:51:50Z","pushed_at":"2025-01-24T22:51:35Z","git_url":"git://github.com/bersprockets/spark.git","ssh_url":"git@github.com:bersprockets/spark.git","clone_url":"https://github.com/bersprockets/spark.git","svn_url":"https://github.com/bersprockets/spark","homepage":null,"size":475116,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:branch-2.3","ref":"branch-2.3","sha":"a3d7c4f8eec1a77bbbb0b4f45dd57aba1dc13ad5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25066"},"html":{"href":"https://github.com/apache/spark/pull/25066"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25066"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25066/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25066/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25066/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/54417a777c4378cc6ac5ccedf9d3c77106139548"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25065","id":295102839,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MTAyODM5","html_url":"https://github.com/apache/spark/pull/25065","diff_url":"https://github.com/apache/spark/pull/25065.diff","patch_url":"https://github.com/apache/spark/pull/25065.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25065","number":25065,"state":"closed","locked":false,"title":"[MINOR][SQL] Clean up ObjectProducerExec operators","user":{"login":"jaceklaskowski","id":62313,"node_id":"MDQ6VXNlcjYyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/62313?v=4","gravatar_id":"","url":"https://api.github.com/users/jaceklaskowski","html_url":"https://github.com/jaceklaskowski","followers_url":"https://api.github.com/users/jaceklaskowski/followers","following_url":"https://api.github.com/users/jaceklaskowski/following{/other_user}","gists_url":"https://api.github.com/users/jaceklaskowski/gists{/gist_id}","starred_url":"https://api.github.com/users/jaceklaskowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaceklaskowski/subscriptions","organizations_url":"https://api.github.com/users/jaceklaskowski/orgs","repos_url":"https://api.github.com/users/jaceklaskowski/repos","events_url":"https://api.github.com/users/jaceklaskowski/events{/privacy}","received_events_url":"https://api.github.com/users/jaceklaskowski/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nCleaned up (removed) code duplication in `ObjectProducerExec` operators so they use the trait's methods.\r\n\r\n## How was this patch tested?\r\n\r\nLocal build. Waiting for Jenkins.","created_at":"2019-07-07T13:06:17Z","updated_at":"2019-07-15T08:35:38Z","closed_at":"2019-07-11T14:13:39Z","merged_at":null,"merge_commit_sha":"b80c87835b3016340ccb2bbc8384ea9cf944d1c6","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25065/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25065/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25065/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/52b03b1e9e249f056d1a1c3027180b8473fe4b2f","head":{"label":"jaceklaskowski:ObjectProducerExec-operators-cleanup","ref":"ObjectProducerExec-operators-cleanup","sha":"52b03b1e9e249f056d1a1c3027180b8473fe4b2f","user":{"login":"jaceklaskowski","id":62313,"node_id":"MDQ6VXNlcjYyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/62313?v=4","gravatar_id":"","url":"https://api.github.com/users/jaceklaskowski","html_url":"https://github.com/jaceklaskowski","followers_url":"https://api.github.com/users/jaceklaskowski/followers","following_url":"https://api.github.com/users/jaceklaskowski/following{/other_user}","gists_url":"https://api.github.com/users/jaceklaskowski/gists{/gist_id}","starred_url":"https://api.github.com/users/jaceklaskowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaceklaskowski/subscriptions","organizations_url":"https://api.github.com/users/jaceklaskowski/orgs","repos_url":"https://api.github.com/users/jaceklaskowski/repos","events_url":"https://api.github.com/users/jaceklaskowski/events{/privacy}","received_events_url":"https://api.github.com/users/jaceklaskowski/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19512335,"node_id":"MDEwOlJlcG9zaXRvcnkxOTUxMjMzNQ==","name":"spark","full_name":"jaceklaskowski/spark","private":false,"owner":{"login":"jaceklaskowski","id":62313,"node_id":"MDQ6VXNlcjYyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/62313?v=4","gravatar_id":"","url":"https://api.github.com/users/jaceklaskowski","html_url":"https://github.com/jaceklaskowski","followers_url":"https://api.github.com/users/jaceklaskowski/followers","following_url":"https://api.github.com/users/jaceklaskowski/following{/other_user}","gists_url":"https://api.github.com/users/jaceklaskowski/gists{/gist_id}","starred_url":"https://api.github.com/users/jaceklaskowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaceklaskowski/subscriptions","organizations_url":"https://api.github.com/users/jaceklaskowski/orgs","repos_url":"https://api.github.com/users/jaceklaskowski/repos","events_url":"https://api.github.com/users/jaceklaskowski/events{/privacy}","received_events_url":"https://api.github.com/users/jaceklaskowski/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/jaceklaskowski/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/jaceklaskowski/spark","forks_url":"https://api.github.com/repos/jaceklaskowski/spark/forks","keys_url":"https://api.github.com/repos/jaceklaskowski/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/jaceklaskowski/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/jaceklaskowski/spark/teams","hooks_url":"https://api.github.com/repos/jaceklaskowski/spark/hooks","issue_events_url":"https://api.github.com/repos/jaceklaskowski/spark/issues/events{/number}","events_url":"https://api.github.com/repos/jaceklaskowski/spark/events","assignees_url":"https://api.github.com/repos/jaceklaskowski/spark/assignees{/user}","branches_url":"https://api.github.com/repos/jaceklaskowski/spark/branches{/branch}","tags_url":"https://api.github.com/repos/jaceklaskowski/spark/tags","blobs_url":"https://api.github.com/repos/jaceklaskowski/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/jaceklaskowski/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/jaceklaskowski/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/jaceklaskowski/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/jaceklaskowski/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/jaceklaskowski/spark/languages","stargazers_url":"https://api.github.com/repos/jaceklaskowski/spark/stargazers","contributors_url":"https://api.github.com/repos/jaceklaskowski/spark/contributors","subscribers_url":"https://api.github.com/repos/jaceklaskowski/spark/subscribers","subscription_url":"https://api.github.com/repos/jaceklaskowski/spark/subscription","commits_url":"https://api.github.com/repos/jaceklaskowski/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/jaceklaskowski/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/jaceklaskowski/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/jaceklaskowski/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/jaceklaskowski/spark/contents/{+path}","compare_url":"https://api.github.com/repos/jaceklaskowski/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/jaceklaskowski/spark/merges","archive_url":"https://api.github.com/repos/jaceklaskowski/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/jaceklaskowski/spark/downloads","issues_url":"https://api.github.com/repos/jaceklaskowski/spark/issues{/number}","pulls_url":"https://api.github.com/repos/jaceklaskowski/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/jaceklaskowski/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/jaceklaskowski/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/jaceklaskowski/spark/labels{/name}","releases_url":"https://api.github.com/repos/jaceklaskowski/spark/releases{/id}","deployments_url":"https://api.github.com/repos/jaceklaskowski/spark/deployments","created_at":"2014-05-06T21:58:46Z","updated_at":"2024-11-17T10:14:07Z","pushed_at":"2024-11-17T10:12:58Z","git_url":"git://github.com/jaceklaskowski/spark.git","ssh_url":"git@github.com:jaceklaskowski/spark.git","clone_url":"https://github.com/jaceklaskowski/spark.git","svn_url":"https://github.com/jaceklaskowski/spark","homepage":null,"size":421970,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":3,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"20469d43eb22c832b4d8f30c9e611ef622c3366d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25065"},"html":{"href":"https://github.com/apache/spark/pull/25065"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25065"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25065/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25065/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25065/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/52b03b1e9e249f056d1a1c3027180b8473fe4b2f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25064","id":295087967,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MDg3OTY3","html_url":"https://github.com/apache/spark/pull/25064","diff_url":"https://github.com/apache/spark/pull/25064.diff","patch_url":"https://github.com/apache/spark/pull/25064.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25064","number":25064,"state":"closed","locked":false,"title":"[SPARK-28268][SQL] Rewrite non-correlated Semi/Anti join as Filter","user":{"login":"francis0407","id":25431723,"node_id":"MDQ6VXNlcjI1NDMxNzIz","avatar_url":"https://avatars.githubusercontent.com/u/25431723?v=4","gravatar_id":"","url":"https://api.github.com/users/francis0407","html_url":"https://github.com/francis0407","followers_url":"https://api.github.com/users/francis0407/followers","following_url":"https://api.github.com/users/francis0407/following{/other_user}","gists_url":"https://api.github.com/users/francis0407/gists{/gist_id}","starred_url":"https://api.github.com/users/francis0407/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/francis0407/subscriptions","organizations_url":"https://api.github.com/users/francis0407/orgs","repos_url":"https://api.github.com/users/francis0407/repos","events_url":"https://api.github.com/users/francis0407/events{/privacy}","received_events_url":"https://api.github.com/users/francis0407/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nWhen semi/anti join has a non-correlated join condition, we can convert it to a Filter with a non-correlated Exists subquery. As the Exists subquery is non-correlated, we can use a physical plan for it to avoid join.\r\n\r\nActually, this optimization is mainly for the non-correlated subqueries (Exists/In). We currently rewrite Exists/InSubquery as semi/anti/existential join, whether it is correlated or not. And they are mostly executed using a BroadcastNestedLoopJoin which is really not a good choice.\r\n\r\nHere are some examples:\r\n1. \r\n``` SQL\r\nSELECT t1a\r\nFROM    t1  \r\nSEMI JOIN t2\r\nON t2a > 10 OR t2b = 'a'\r\n```\r\n=>\r\n```SQL\r\nSELECT t1a\r\nFROM t1\r\nWHERE EXISTS(SELECT 1 \r\n             FROM t2 \r\n             WHERE t2a > 10 OR t2b = 'a')\r\n```\r\n2.\r\n```SQL\r\nSELECT t1a\r\nFROM  t1\r\nANTI JOIN t2\r\nON t1b > 10 AND t2b = 'b'\r\n```\r\n=>\r\n```SQL\r\nSELECT t1a\r\nFROM t1\r\nWHERE NOT(t1b > 10 \r\n          AND EXISTS(SELECT 1\r\n                     FROM  t2\r\n                     WHERE t2b = 'b'))\r\n```\r\n\r\nThis PR adds a new optimize rule : `ReplaceLeftSemiAntiJoinWithFilter`.\r\nThis rule replaces non-correlated `LeftSemi/LeftAnti Join` with `Filter`. When the `condition` of a semi/anti join can be split by `And` into expressions where each expression only refers to attributes from one side, we can turn it into a `Filter` with a non-correlated `Exists` subquery.\r\n\r\nBesides, this PR adds a physical plan for non-correlated Exists.\r\n\r\n## How was this patch tested?\r\nut\r\n","created_at":"2019-07-07T08:34:33Z","updated_at":"2019-12-27T08:18:01Z","closed_at":"2019-12-27T08:18:01Z","merged_at":null,"merge_commit_sha":"e930afb117f8dcaeec76fe6a779dbc135429e190","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25064/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25064/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25064/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1eaa79abb8e97a4d33259145879928a5e7e9940c","head":{"label":"francis0407:SPARK-28268","ref":"SPARK-28268","sha":"1eaa79abb8e97a4d33259145879928a5e7e9940c","user":{"login":"francis0407","id":25431723,"node_id":"MDQ6VXNlcjI1NDMxNzIz","avatar_url":"https://avatars.githubusercontent.com/u/25431723?v=4","gravatar_id":"","url":"https://api.github.com/users/francis0407","html_url":"https://github.com/francis0407","followers_url":"https://api.github.com/users/francis0407/followers","following_url":"https://api.github.com/users/francis0407/following{/other_user}","gists_url":"https://api.github.com/users/francis0407/gists{/gist_id}","starred_url":"https://api.github.com/users/francis0407/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/francis0407/subscriptions","organizations_url":"https://api.github.com/users/francis0407/orgs","repos_url":"https://api.github.com/users/francis0407/repos","events_url":"https://api.github.com/users/francis0407/events{/privacy}","received_events_url":"https://api.github.com/users/francis0407/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":169244879,"node_id":"MDEwOlJlcG9zaXRvcnkxNjkyNDQ4Nzk=","name":"spark","full_name":"francis0407/spark","private":false,"owner":{"login":"francis0407","id":25431723,"node_id":"MDQ6VXNlcjI1NDMxNzIz","avatar_url":"https://avatars.githubusercontent.com/u/25431723?v=4","gravatar_id":"","url":"https://api.github.com/users/francis0407","html_url":"https://github.com/francis0407","followers_url":"https://api.github.com/users/francis0407/followers","following_url":"https://api.github.com/users/francis0407/following{/other_user}","gists_url":"https://api.github.com/users/francis0407/gists{/gist_id}","starred_url":"https://api.github.com/users/francis0407/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/francis0407/subscriptions","organizations_url":"https://api.github.com/users/francis0407/orgs","repos_url":"https://api.github.com/users/francis0407/repos","events_url":"https://api.github.com/users/francis0407/events{/privacy}","received_events_url":"https://api.github.com/users/francis0407/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/francis0407/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/francis0407/spark","forks_url":"https://api.github.com/repos/francis0407/spark/forks","keys_url":"https://api.github.com/repos/francis0407/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/francis0407/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/francis0407/spark/teams","hooks_url":"https://api.github.com/repos/francis0407/spark/hooks","issue_events_url":"https://api.github.com/repos/francis0407/spark/issues/events{/number}","events_url":"https://api.github.com/repos/francis0407/spark/events","assignees_url":"https://api.github.com/repos/francis0407/spark/assignees{/user}","branches_url":"https://api.github.com/repos/francis0407/spark/branches{/branch}","tags_url":"https://api.github.com/repos/francis0407/spark/tags","blobs_url":"https://api.github.com/repos/francis0407/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/francis0407/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/francis0407/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/francis0407/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/francis0407/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/francis0407/spark/languages","stargazers_url":"https://api.github.com/repos/francis0407/spark/stargazers","contributors_url":"https://api.github.com/repos/francis0407/spark/contributors","subscribers_url":"https://api.github.com/repos/francis0407/spark/subscribers","subscription_url":"https://api.github.com/repos/francis0407/spark/subscription","commits_url":"https://api.github.com/repos/francis0407/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/francis0407/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/francis0407/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/francis0407/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/francis0407/spark/contents/{+path}","compare_url":"https://api.github.com/repos/francis0407/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/francis0407/spark/merges","archive_url":"https://api.github.com/repos/francis0407/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/francis0407/spark/downloads","issues_url":"https://api.github.com/repos/francis0407/spark/issues{/number}","pulls_url":"https://api.github.com/repos/francis0407/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/francis0407/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/francis0407/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/francis0407/spark/labels{/name}","releases_url":"https://api.github.com/repos/francis0407/spark/releases{/id}","deployments_url":"https://api.github.com/repos/francis0407/spark/deployments","created_at":"2019-02-05T13:23:20Z","updated_at":"2019-04-08T06:39:02Z","pushed_at":"2019-09-17T02:28:33Z","git_url":"git://github.com/francis0407/spark.git","ssh_url":"git@github.com:francis0407/spark.git","clone_url":"https://github.com/francis0407/spark.git","svn_url":"https://github.com/francis0407/spark","homepage":"","size":310157,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"20469d43eb22c832b4d8f30c9e611ef622c3366d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25064"},"html":{"href":"https://github.com/apache/spark/pull/25064"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25064"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25064/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25064/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25064/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1eaa79abb8e97a4d33259145879928a5e7e9940c"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25063","id":295083577,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MDgzNTc3","html_url":"https://github.com/apache/spark/pull/25063","diff_url":"https://github.com/apache/spark/pull/25063.diff","patch_url":"https://github.com/apache/spark/pull/25063.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25063","number":25063,"state":"closed","locked":false,"title":"[SPARK-28267][DOC] Update building-spark.md(support build with hadoop-3.2)","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nSince [SPARK-23710](https://issues.apache.org/jira/browse/SPARK-23710), Hadoop 3.x can support Hive. This PR add _build with `hadoop-3.2`_ to building-spark.md.\r\n\r\n## How was this patch tested?\r\n\r\nmanual tests\r\n```\r\ncd docs\r\nSKIP_API=1 jekyll build\r\n```\r\n![image](https://user-images.githubusercontent.com/5399861/60942057-cf5a0480-a313-11e9-9534-4765520e799f.png)\r\n\r\n\r\n\r\n","created_at":"2019-07-07T07:04:50Z","updated_at":"2019-07-10T13:57:00Z","closed_at":"2019-07-10T13:55:45Z","merged_at":null,"merge_commit_sha":"4c89b910311be1c57b1a38c17f4621587adaa29d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627011,"node_id":"MDU6TGFiZWwxNDA2NjI3MDEx","url":"https://api.github.com/repos/apache/spark/labels/DOCUMENTATION","name":"DOCUMENTATION","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25063/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25063/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25063/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ba30f586008df0b083bb84a5091cbdf91988a540","head":{"label":"wangyum:SPARK-28267","ref":"SPARK-28267","sha":"ba30f586008df0b083bb84a5091cbdf91988a540","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"20469d43eb22c832b4d8f30c9e611ef622c3366d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25063"},"html":{"href":"https://github.com/apache/spark/pull/25063"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25063"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25063/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25063/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25063/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ba30f586008df0b083bb84a5091cbdf91988a540"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25062","id":295036712,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk1MDM2NzEy","html_url":"https://github.com/apache/spark/pull/25062","diff_url":"https://github.com/apache/spark/pull/25062.diff","patch_url":"https://github.com/apache/spark/pull/25062.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25062","number":25062,"state":"closed","locked":false,"title":"[SPARK-28260][SQL] Add CLOSED state to ExecutionState","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThe `ThriftServerTab` displays a FINISHED state when the operation finishes execution, but quite often it still takes a lot of time to fetch the results. OperationState has state CLOSED for when after the iterator is closed. This PR add CLOSED state to ExecutionState, and override the `close()` in SparkExecuteStatementOperation, SparkGetColumnsOperation, SparkGetSchemasOperation and SparkGetTablesOperation.\r\n\r\n## How was this patch tested?\r\n\r\nmanual tests\r\n1. Add `Thread.sleep(10000)` before [SparkExecuteStatementOperation.scala#L112](https://github.com/apache/spark/blob/b2e7677f4d3d8f47f5f148680af39d38f2b558f0/sql/hive-thriftserver/src/main/scala/org/apache/spark/sql/hive/thriftserver/SparkExecuteStatementOperation.scala#L112)\r\n2. Switch to `ThriftServerTab`:\r\n![image](https://user-images.githubusercontent.com/5399861/60809590-9dcf2500-a1bd-11e9-826e-33729bb97daf.png)\r\n3. After a while:\r\n![image](https://user-images.githubusercontent.com/5399861/60809719-e850a180-a1bd-11e9-9a6a-546146e626ab.png)\r\n\r\n\r\n\r\n","created_at":"2019-07-06T12:34:31Z","updated_at":"2019-07-26T11:00:10Z","closed_at":"2019-07-12T17:36:03Z","merged_at":null,"merge_commit_sha":"9941a589b4d4b8c1184600f9de37290d20d09ffa","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25062/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25062/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25062/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7a4f41646e79ef88c2af677d6c2488517c2e4b56","head":{"label":"wangyum:SPARK-28260","ref":"SPARK-28260","sha":"7a4f41646e79ef88c2af677d6c2488517c2e4b56","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"51379b731db4523d5e10ad9f2c063e445ae10e72","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25062"},"html":{"href":"https://github.com/apache/spark/pull/25062"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25062"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25062/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25062/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25062/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7a4f41646e79ef88c2af677d6c2488517c2e4b56"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25061","id":294919765,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0OTE5NzY1","html_url":"https://github.com/apache/spark/pull/25061","diff_url":"https://github.com/apache/spark/pull/25061.diff","patch_url":"https://github.com/apache/spark/pull/25061.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25061","number":25061,"state":"closed","locked":false,"title":"[SPARK-28262][SQL] Support `DROP GLOBAL TEMPORARY VIEW`","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nWe create global temporary view by:\r\n```sql\r\nCREATE GLOBAL TEMPORARY VIEW temp_view AS SELECT 1 AS col1;\r\n```\r\nBut we need to specify `spark.sql.globalTempDatabase` when drop it:\r\n```sql\r\nDROP VIEW global_temp.temp_view;\r\n```\r\nWhich is not very convenient, this PR add support `DROP GLOBAL TEMPORARY VIEW` and `DROP TEMPORARY VIEW`.\r\nArter this PR:\r\n```sql\r\nDROP GLOBAL TEMPORARY VIEW temp_view;\r\n```\r\n\r\n\r\nDrop view related code:\r\nhttps://github.com/apache/spark/blob/447bfdec830ba5eaaee791e86caad39f4f6661eb/sql/core/src/main/scala/org/apache/spark/sql/execution/command/ddl.scala#L194-L219\r\n\r\n## How was this patch tested?\r\n\r\nunit tests\r\n","created_at":"2019-07-05T15:42:09Z","updated_at":"2019-07-19T10:20:24Z","closed_at":"2019-07-19T10:20:12Z","merged_at":null,"merge_commit_sha":"62712b12c204b86f51536554e1c1f9ecab8fa329","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25061/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25061/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25061/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/41715c609175c5fca5b5de51a4d17a33d1ac6b83","head":{"label":"wangyum:SPARK-28262","ref":"SPARK-28262","sha":"41715c609175c5fca5b5de51a4d17a33d1ac6b83","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"683e270c16258490c7c1deedb05fe44d45c39616","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25061"},"html":{"href":"https://github.com/apache/spark/pull/25061"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25061"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25061/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25061/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25061/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/41715c609175c5fca5b5de51a4d17a33d1ac6b83"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25060","id":294846952,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0ODQ2OTUy","html_url":"https://github.com/apache/spark/pull/25060","diff_url":"https://github.com/apache/spark/pull/25060.diff","patch_url":"https://github.com/apache/spark/pull/25060.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25060","number":25060,"state":"closed","locked":false,"title":"[SPARK-28206][PYTHON] Remove the legacy Epydoc in PySpark API documentation","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nSeems like we used to generate PySpark API documentation by Epydoc almost at the very first place (see https://github.com/apache/spark/commit/85b8f2c64f0fc4be5645d8736629fc082cb3587b).\r\n\r\nThis fixes an actual issue:\r\n\r\nBefore:\r\n\r\n![Screen Shot 2019-07-05 at 8 20 01 PM](https://user-images.githubusercontent.com/6477701/60720491-e9879180-9f65-11e9-9562-100830a456cd.png)\r\n\r\nAfter:\r\n\r\n![Screen Shot 2019-07-05 at 8 20 05 PM](https://user-images.githubusercontent.com/6477701/60720495-ec828200-9f65-11e9-8277-8f689e292cb0.png)\r\n\r\nIt seems apparently a bug within `epytext` plugin during the conversion between`@param` and `:param` syntax. See also [Epydoc syntax](http://epydoc.sourceforge.net/manual-epytext.html).\r\n\r\nActually, Epydoc syntax violates [PEP-257](https://www.python.org/dev/peps/pep-0257/) IIRC and blocks us to enable some rules for doctest linter as well.\r\n\r\nWe should remove this legacy away and I guess Spark 3 is good timing to do it.\r\n\r\n## How was this patch tested?\r\n\r\nManually built the doc and check each.\r\n\r\nI had to manually find the Epydoc syntax by `git grep -r \"{L\"`, for instance.","created_at":"2019-07-05T11:49:42Z","updated_at":"2020-03-03T01:18:37Z","closed_at":"2019-07-05T17:12:56Z","merged_at":null,"merge_commit_sha":"230c8c31518cf21c636ec1553d0daa4dab69e217","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25060/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25060/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25060/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8f56ad6725f725158b532e752c40bae39e1f9046","head":{"label":"HyukjinKwon:SPARK-28206","ref":"SPARK-28206","sha":"8f56ad6725f725158b532e752c40bae39e1f9046","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"e299f62ec55a0c65574a6dbb1a2070cb6a562061","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25060"},"html":{"href":"https://github.com/apache/spark/pull/25060"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25060"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25060/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25060/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25060/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8f56ad6725f725158b532e752c40bae39e1f9046"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25059","id":294782454,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NzgyNDU0","html_url":"https://github.com/apache/spark/pull/25059","diff_url":"https://github.com/apache/spark/pull/25059.diff","patch_url":"https://github.com/apache/spark/pull/25059.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25059","number":25059,"state":"closed","locked":false,"title":"[SPARK-28257][SQL] Use ConfigEntry for hardcoded configs in SQL","user":{"login":"WangGuangxin","id":1312321,"node_id":"MDQ6VXNlcjEzMTIzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1312321?v=4","gravatar_id":"","url":"https://api.github.com/users/WangGuangxin","html_url":"https://github.com/WangGuangxin","followers_url":"https://api.github.com/users/WangGuangxin/followers","following_url":"https://api.github.com/users/WangGuangxin/following{/other_user}","gists_url":"https://api.github.com/users/WangGuangxin/gists{/gist_id}","starred_url":"https://api.github.com/users/WangGuangxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WangGuangxin/subscriptions","organizations_url":"https://api.github.com/users/WangGuangxin/orgs","repos_url":"https://api.github.com/users/WangGuangxin/repos","events_url":"https://api.github.com/users/WangGuangxin/events{/privacy}","received_events_url":"https://api.github.com/users/WangGuangxin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThere are some hardcoded configs, using config entry to replace them.\r\n\r\n## How was this patch tested?\r\n\r\nExisting UT","created_at":"2019-07-05T08:25:32Z","updated_at":"2019-07-12T09:32:31Z","closed_at":"2019-07-12T05:39:44Z","merged_at":null,"merge_commit_sha":"f92a7cfe74e36d5a2049e7f6c6fbf73d62cca5ce","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25059/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25059/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25059/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b39fb625b18d5a07d3076406a73e0db8d519ae4b","head":{"label":"WangGuangxin:ConfigEntry","ref":"ConfigEntry","sha":"b39fb625b18d5a07d3076406a73e0db8d519ae4b","user":{"login":"WangGuangxin","id":1312321,"node_id":"MDQ6VXNlcjEzMTIzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1312321?v=4","gravatar_id":"","url":"https://api.github.com/users/WangGuangxin","html_url":"https://github.com/WangGuangxin","followers_url":"https://api.github.com/users/WangGuangxin/followers","following_url":"https://api.github.com/users/WangGuangxin/following{/other_user}","gists_url":"https://api.github.com/users/WangGuangxin/gists{/gist_id}","starred_url":"https://api.github.com/users/WangGuangxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WangGuangxin/subscriptions","organizations_url":"https://api.github.com/users/WangGuangxin/orgs","repos_url":"https://api.github.com/users/WangGuangxin/repos","events_url":"https://api.github.com/users/WangGuangxin/events{/privacy}","received_events_url":"https://api.github.com/users/WangGuangxin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":163655040,"node_id":"MDEwOlJlcG9zaXRvcnkxNjM2NTUwNDA=","name":"spark","full_name":"WangGuangxin/spark","private":false,"owner":{"login":"WangGuangxin","id":1312321,"node_id":"MDQ6VXNlcjEzMTIzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1312321?v=4","gravatar_id":"","url":"https://api.github.com/users/WangGuangxin","html_url":"https://github.com/WangGuangxin","followers_url":"https://api.github.com/users/WangGuangxin/followers","following_url":"https://api.github.com/users/WangGuangxin/following{/other_user}","gists_url":"https://api.github.com/users/WangGuangxin/gists{/gist_id}","starred_url":"https://api.github.com/users/WangGuangxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WangGuangxin/subscriptions","organizations_url":"https://api.github.com/users/WangGuangxin/orgs","repos_url":"https://api.github.com/users/WangGuangxin/repos","events_url":"https://api.github.com/users/WangGuangxin/events{/privacy}","received_events_url":"https://api.github.com/users/WangGuangxin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/WangGuangxin/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/WangGuangxin/spark","forks_url":"https://api.github.com/repos/WangGuangxin/spark/forks","keys_url":"https://api.github.com/repos/WangGuangxin/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/WangGuangxin/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/WangGuangxin/spark/teams","hooks_url":"https://api.github.com/repos/WangGuangxin/spark/hooks","issue_events_url":"https://api.github.com/repos/WangGuangxin/spark/issues/events{/number}","events_url":"https://api.github.com/repos/WangGuangxin/spark/events","assignees_url":"https://api.github.com/repos/WangGuangxin/spark/assignees{/user}","branches_url":"https://api.github.com/repos/WangGuangxin/spark/branches{/branch}","tags_url":"https://api.github.com/repos/WangGuangxin/spark/tags","blobs_url":"https://api.github.com/repos/WangGuangxin/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/WangGuangxin/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/WangGuangxin/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/WangGuangxin/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/WangGuangxin/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/WangGuangxin/spark/languages","stargazers_url":"https://api.github.com/repos/WangGuangxin/spark/stargazers","contributors_url":"https://api.github.com/repos/WangGuangxin/spark/contributors","subscribers_url":"https://api.github.com/repos/WangGuangxin/spark/subscribers","subscription_url":"https://api.github.com/repos/WangGuangxin/spark/subscription","commits_url":"https://api.github.com/repos/WangGuangxin/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/WangGuangxin/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/WangGuangxin/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/WangGuangxin/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/WangGuangxin/spark/contents/{+path}","compare_url":"https://api.github.com/repos/WangGuangxin/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/WangGuangxin/spark/merges","archive_url":"https://api.github.com/repos/WangGuangxin/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/WangGuangxin/spark/downloads","issues_url":"https://api.github.com/repos/WangGuangxin/spark/issues{/number}","pulls_url":"https://api.github.com/repos/WangGuangxin/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/WangGuangxin/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/WangGuangxin/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/WangGuangxin/spark/labels{/name}","releases_url":"https://api.github.com/repos/WangGuangxin/spark/releases{/id}","deployments_url":"https://api.github.com/repos/WangGuangxin/spark/deployments","created_at":"2018-12-31T09:09:24Z","updated_at":"2024-12-18T05:55:56Z","pushed_at":"2024-12-18T13:26:59Z","git_url":"git://github.com/WangGuangxin/spark.git","ssh_url":"git@github.com:WangGuangxin/spark.git","clone_url":"https://github.com/WangGuangxin/spark.git","svn_url":"https://github.com/WangGuangxin/spark","homepage":"","size":449518,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7021588ba8365b2018f9f7b5d3b05285886cd0be","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25059"},"html":{"href":"https://github.com/apache/spark/pull/25059"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25059"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25059/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25059/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25059/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b39fb625b18d5a07d3076406a73e0db8d519ae4b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25058","id":294761574,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NzYxNTc0","html_url":"https://github.com/apache/spark/pull/25058","diff_url":"https://github.com/apache/spark/pull/25058.diff","patch_url":"https://github.com/apache/spark/pull/25058.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25058","number":25058,"state":"closed","locked":false,"title":"[SPARK-21067][SQL] Fix Thrift Server - CTAS fail with Unable to move source","user":{"login":"Deegue","id":25916266,"node_id":"MDQ6VXNlcjI1OTE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/25916266?v=4","gravatar_id":"","url":"https://api.github.com/users/Deegue","html_url":"https://github.com/Deegue","followers_url":"https://api.github.com/users/Deegue/followers","following_url":"https://api.github.com/users/Deegue/following{/other_user}","gists_url":"https://api.github.com/users/Deegue/gists{/gist_id}","starred_url":"https://api.github.com/users/Deegue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Deegue/subscriptions","organizations_url":"https://api.github.com/users/Deegue/orgs","repos_url":"https://api.github.com/users/Deegue/repos","events_url":"https://api.github.com/users/Deegue/events{/privacy}","received_events_url":"https://api.github.com/users/Deegue/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nWhen we close a session of STS, FileSystem(cached by default) on HDFS will be closed. \r\nThen if we do CTAS and trigger `Hive.moveFile`, DFSClient will do `checkOpen` and throw `java.io.IOException: Filesystem closed`.\r\n\r\nSo we add a Spark config `spark.sql.thriftserver.hdfs.disable.cache` to control whether disable the FileSystem connection cache of HDFS.\r\n\r\n## How was this patch tested?\r\n\r\nManually tested.","created_at":"2019-07-05T07:11:17Z","updated_at":"2019-09-16T23:47:57Z","closed_at":"2019-09-16T23:47:57Z","merged_at":null,"merge_commit_sha":"6e2ca20415ac6572d140f81fb35f039fff37d27a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25058/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25058/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25058/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e197060374580d71bb8aef98fc25d72ec16bed4a","head":{"label":"Deegue:master-fix_thrift_file_system","ref":"master-fix_thrift_file_system","sha":"e197060374580d71bb8aef98fc25d72ec16bed4a","user":{"login":"Deegue","id":25916266,"node_id":"MDQ6VXNlcjI1OTE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/25916266?v=4","gravatar_id":"","url":"https://api.github.com/users/Deegue","html_url":"https://github.com/Deegue","followers_url":"https://api.github.com/users/Deegue/followers","following_url":"https://api.github.com/users/Deegue/following{/other_user}","gists_url":"https://api.github.com/users/Deegue/gists{/gist_id}","starred_url":"https://api.github.com/users/Deegue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Deegue/subscriptions","organizations_url":"https://api.github.com/users/Deegue/orgs","repos_url":"https://api.github.com/users/Deegue/repos","events_url":"https://api.github.com/users/Deegue/events{/privacy}","received_events_url":"https://api.github.com/users/Deegue/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":194640910,"node_id":"MDEwOlJlcG9zaXRvcnkxOTQ2NDA5MTA=","name":"spark","full_name":"Deegue/spark","private":false,"owner":{"login":"Deegue","id":25916266,"node_id":"MDQ6VXNlcjI1OTE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/25916266?v=4","gravatar_id":"","url":"https://api.github.com/users/Deegue","html_url":"https://github.com/Deegue","followers_url":"https://api.github.com/users/Deegue/followers","following_url":"https://api.github.com/users/Deegue/following{/other_user}","gists_url":"https://api.github.com/users/Deegue/gists{/gist_id}","starred_url":"https://api.github.com/users/Deegue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Deegue/subscriptions","organizations_url":"https://api.github.com/users/Deegue/orgs","repos_url":"https://api.github.com/users/Deegue/repos","events_url":"https://api.github.com/users/Deegue/events{/privacy}","received_events_url":"https://api.github.com/users/Deegue/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Deegue/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/Deegue/spark","forks_url":"https://api.github.com/repos/Deegue/spark/forks","keys_url":"https://api.github.com/repos/Deegue/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Deegue/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Deegue/spark/teams","hooks_url":"https://api.github.com/repos/Deegue/spark/hooks","issue_events_url":"https://api.github.com/repos/Deegue/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Deegue/spark/events","assignees_url":"https://api.github.com/repos/Deegue/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Deegue/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Deegue/spark/tags","blobs_url":"https://api.github.com/repos/Deegue/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Deegue/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Deegue/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Deegue/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Deegue/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Deegue/spark/languages","stargazers_url":"https://api.github.com/repos/Deegue/spark/stargazers","contributors_url":"https://api.github.com/repos/Deegue/spark/contributors","subscribers_url":"https://api.github.com/repos/Deegue/spark/subscribers","subscription_url":"https://api.github.com/repos/Deegue/spark/subscription","commits_url":"https://api.github.com/repos/Deegue/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Deegue/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Deegue/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Deegue/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Deegue/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Deegue/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Deegue/spark/merges","archive_url":"https://api.github.com/repos/Deegue/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Deegue/spark/downloads","issues_url":"https://api.github.com/repos/Deegue/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Deegue/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Deegue/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Deegue/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Deegue/spark/labels{/name}","releases_url":"https://api.github.com/repos/Deegue/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Deegue/spark/deployments","created_at":"2019-07-01T09:20:59Z","updated_at":"2019-11-19T03:54:24Z","pushed_at":"2020-05-29T08:32:30Z","git_url":"git://github.com/Deegue/spark.git","ssh_url":"git@github.com:Deegue/spark.git","clone_url":"https://github.com/Deegue/spark.git","svn_url":"https://github.com/Deegue/spark","homepage":"","size":312684,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5c55812400e1e0a8aaeb50a50be106e80c916c86","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25058"},"html":{"href":"https://github.com/apache/spark/pull/25058"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25058"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25058/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25058/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25058/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e197060374580d71bb8aef98fc25d72ec16bed4a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25057","id":294757887,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NzU3ODg3","html_url":"https://github.com/apache/spark/pull/25057","diff_url":"https://github.com/apache/spark/pull/25057.diff","patch_url":"https://github.com/apache/spark/pull/25057.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25057","number":25057,"state":"closed","locked":false,"title":"[SPARK-28239][SHUFFLE] Allow TCP connections created by shuffle service auto close on YARN NodeManagers","user":{"login":"Deegue","id":25916266,"node_id":"MDQ6VXNlcjI1OTE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/25916266?v=4","gravatar_id":"","url":"https://api.github.com/users/Deegue","html_url":"https://github.com/Deegue","followers_url":"https://api.github.com/users/Deegue/followers","following_url":"https://api.github.com/users/Deegue/following{/other_user}","gists_url":"https://api.github.com/users/Deegue/gists{/gist_id}","starred_url":"https://api.github.com/users/Deegue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Deegue/subscriptions","organizations_url":"https://api.github.com/users/Deegue/orgs","repos_url":"https://api.github.com/users/Deegue/repos","events_url":"https://api.github.com/users/Deegue/events{/privacy}","received_events_url":"https://api.github.com/users/Deegue/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nMake it possible to close TCP connections on YARN NodeManager automatically.\r\nIt will fix connections piling up on NodeManagers and NodeManagers getting slow.\r\n\r\n## How was this patch tested?\r\n\r\nManually tested.\r\nBuild Spark and deploy as [Configuring the External Shuffle Service](http://spark.apache.org/docs/latest/running-on-yarn.html#configuring-the-external-shuffle-service)\r\nSet spark.shuffle.io.enableTcpAutoClose to true.\r\n\r\nThen execute command `lsof -i:7337 |wc -l` on NodeManagers. The results will like :\r\n\r\n![image](https://user-images.githubusercontent.com/25916266/60579060-ed27e680-9db4-11e9-9d9c-29c75fadcea7.png)\r\n\r\nIt keeps in a range and won't increase continuously.\r\n\r\nEnvironment:\r\nHadoop2.6.0-CDH5.8.3(netty3)\r\nSpark2.4.0(netty4)\r\n\r\nConfigs:\r\nspark.dynamicAllocation.enabled=true\r\nspark.shuffle.service.enabled=true\r\n","created_at":"2019-07-05T06:56:32Z","updated_at":"2019-07-08T03:56:42Z","closed_at":"2019-07-08T03:56:42Z","merged_at":null,"merge_commit_sha":"645c38f9dd140f2366d7095cdfd0c137eb86d323","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406605327,"node_id":"MDU6TGFiZWwxNDA2NjA1MzI3","url":"https://api.github.com/repos/apache/spark/labels/SHUFFLE","name":"SHUFFLE","color":"ededed","default":false,"description":null},{"id":1427970157,"node_id":"MDU6TGFiZWwxNDI3OTcwMTU3","url":"https://api.github.com/repos/apache/spark/labels/YARN","name":"YARN","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25057/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25057/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25057/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5453461e7699a0dd7aa04a09782206ecc4e57925","head":{"label":"Deegue:master-fix_shuffle_service","ref":"master-fix_shuffle_service","sha":"5453461e7699a0dd7aa04a09782206ecc4e57925","user":{"login":"Deegue","id":25916266,"node_id":"MDQ6VXNlcjI1OTE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/25916266?v=4","gravatar_id":"","url":"https://api.github.com/users/Deegue","html_url":"https://github.com/Deegue","followers_url":"https://api.github.com/users/Deegue/followers","following_url":"https://api.github.com/users/Deegue/following{/other_user}","gists_url":"https://api.github.com/users/Deegue/gists{/gist_id}","starred_url":"https://api.github.com/users/Deegue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Deegue/subscriptions","organizations_url":"https://api.github.com/users/Deegue/orgs","repos_url":"https://api.github.com/users/Deegue/repos","events_url":"https://api.github.com/users/Deegue/events{/privacy}","received_events_url":"https://api.github.com/users/Deegue/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":194640910,"node_id":"MDEwOlJlcG9zaXRvcnkxOTQ2NDA5MTA=","name":"spark","full_name":"Deegue/spark","private":false,"owner":{"login":"Deegue","id":25916266,"node_id":"MDQ6VXNlcjI1OTE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/25916266?v=4","gravatar_id":"","url":"https://api.github.com/users/Deegue","html_url":"https://github.com/Deegue","followers_url":"https://api.github.com/users/Deegue/followers","following_url":"https://api.github.com/users/Deegue/following{/other_user}","gists_url":"https://api.github.com/users/Deegue/gists{/gist_id}","starred_url":"https://api.github.com/users/Deegue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Deegue/subscriptions","organizations_url":"https://api.github.com/users/Deegue/orgs","repos_url":"https://api.github.com/users/Deegue/repos","events_url":"https://api.github.com/users/Deegue/events{/privacy}","received_events_url":"https://api.github.com/users/Deegue/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Deegue/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/Deegue/spark","forks_url":"https://api.github.com/repos/Deegue/spark/forks","keys_url":"https://api.github.com/repos/Deegue/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Deegue/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Deegue/spark/teams","hooks_url":"https://api.github.com/repos/Deegue/spark/hooks","issue_events_url":"https://api.github.com/repos/Deegue/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Deegue/spark/events","assignees_url":"https://api.github.com/repos/Deegue/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Deegue/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Deegue/spark/tags","blobs_url":"https://api.github.com/repos/Deegue/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Deegue/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Deegue/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Deegue/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Deegue/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Deegue/spark/languages","stargazers_url":"https://api.github.com/repos/Deegue/spark/stargazers","contributors_url":"https://api.github.com/repos/Deegue/spark/contributors","subscribers_url":"https://api.github.com/repos/Deegue/spark/subscribers","subscription_url":"https://api.github.com/repos/Deegue/spark/subscription","commits_url":"https://api.github.com/repos/Deegue/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Deegue/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Deegue/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Deegue/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Deegue/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Deegue/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Deegue/spark/merges","archive_url":"https://api.github.com/repos/Deegue/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Deegue/spark/downloads","issues_url":"https://api.github.com/repos/Deegue/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Deegue/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Deegue/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Deegue/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Deegue/spark/labels{/name}","releases_url":"https://api.github.com/repos/Deegue/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Deegue/spark/deployments","created_at":"2019-07-01T09:20:59Z","updated_at":"2019-11-19T03:54:24Z","pushed_at":"2020-05-29T08:32:30Z","git_url":"git://github.com/Deegue/spark.git","ssh_url":"git@github.com:Deegue/spark.git","clone_url":"https://github.com/Deegue/spark.git","svn_url":"https://github.com/Deegue/spark","homepage":"","size":312684,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5c55812400e1e0a8aaeb50a50be106e80c916c86","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25057"},"html":{"href":"https://github.com/apache/spark/pull/25057"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25057"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25057/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25057/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25057/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5453461e7699a0dd7aa04a09782206ecc4e57925"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25056","id":294747488,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NzQ3NDg4","html_url":"https://github.com/apache/spark/pull/25056","diff_url":"https://github.com/apache/spark/pull/25056.diff","patch_url":"https://github.com/apache/spark/pull/25056.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25056","number":25056,"state":"closed","locked":false,"title":"[SPARK-28256][SS] Failed to initialize FileContextBasedCheckpointFileManager with uri without authority","user":{"login":"uncleGen","id":7402327,"node_id":"MDQ6VXNlcjc0MDIzMjc=","avatar_url":"https://avatars.githubusercontent.com/u/7402327?v=4","gravatar_id":"","url":"https://api.github.com/users/uncleGen","html_url":"https://github.com/uncleGen","followers_url":"https://api.github.com/users/uncleGen/followers","following_url":"https://api.github.com/users/uncleGen/following{/other_user}","gists_url":"https://api.github.com/users/uncleGen/gists{/gist_id}","starred_url":"https://api.github.com/users/uncleGen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uncleGen/subscriptions","organizations_url":"https://api.github.com/users/uncleGen/orgs","repos_url":"https://api.github.com/users/uncleGen/repos","events_url":"https://api.github.com/users/uncleGen/events{/privacy}","received_events_url":"https://api.github.com/users/uncleGen/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nreproduce code:\r\n\r\n```\r\nCREATE TABLE `user_click_count` (`userId` STRING, `click` BIGINT)\r\nUSING org.apache.spark.sql.json\r\nOPTIONS (path 'hdfs:///tmp/test');\r\n\r\nINSERT INTO user_click_count SELECT xxx from ${streaming_source_table};\r\n```\r\n\r\nerror:\r\n\r\n```\r\njava.lang.RuntimeException: java.lang.reflect.InvocationTargetException\r\n\tat org.apache.hadoop.fs.AbstractFileSystem.newInstance(AbstractFileSystem.java:136)\r\n\tat org.apache.hadoop.fs.AbstractFileSystem.createFileSystem(AbstractFileSystem.java:165)\r\n\tat org.apache.hadoop.fs.AbstractFileSystem.get(AbstractFileSystem.java:250)\r\n\tat org.apache.hadoop.fs.FileContext$2.run(FileContext.java:342)\r\n\tat org.apache.hadoop.fs.FileContext$2.run(FileContext.java:339)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat javax.security.auth.Subject.doAs(Subject.java:422)\r\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1911)\r\n\tat org.apache.hadoop.fs.FileContext.getAbstractFileSystem(FileContext.java:339)\r\n\tat org.apache.hadoop.fs.FileContext.getFileContext(FileContext.java:456)\r\n\tat org.apache.spark.sql.execution.streaming.FileContextBasedCheckpointFileManager.<init>(CheckpointFileManager.scala:297)\r\n\tat org.apache.spark.sql.execution.streaming.CheckpointFileManager$.create(CheckpointFileManager.scala:189)\r\n\tat org.apache.spark.sql.execution.streaming.HDFSMetadataLog.<init>(HDFSMetadataLog.scala:63)\r\n\tat org.apache.spark.sql.execution.streaming.CompactibleFileStreamLog.<init>(CompactibleFileStreamLog.scala:46)\r\n\tat org.apache.spark.sql.execution.streaming.FileStreamSinkLog.<init>(FileStreamSinkLog.scala:85)\r\n\tat org.apache.spark.sql.execution.streaming.FileStreamSink.<init>(FileStreamSink.scala:98)\r\n\tat org.apache.spark.sql.execution.datasources.DataSource.createSink(DataSource.scala:297)\r\n\tat org.apache.spark.sql.execution.datasources.FindDataSourceTable$$anonfun$apply$2.applyOrElse(DataSourceStrategy.scala:379)\r\n\r\n...\r\n\r\nCaused by: java.lang.reflect.InvocationTargetException\r\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n\tat org.apache.hadoop.fs.AbstractFileSystem.newInstance(AbstractFileSystem.java:134)\r\n\t... 67 more\r\nCaused by: org.apache.hadoop.HadoopIllegalArgumentException: Uri without authority: hdfs:/tmp/test/_spark_metadata\r\n\tat org.apache.hadoop.fs.AbstractFileSystem.getUri(AbstractFileSystem.java:313)\r\n\tat org.apache.hadoop.fs.AbstractFileSystem.<init>(AbstractFileSystem.java:266)\r\n\tat org.apache.hadoop.fs.Hdfs.<init>(Hdfs.java:80)\r\n\t... 72 more\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nN/A","created_at":"2019-07-05T06:13:07Z","updated_at":"2019-12-28T00:07:24Z","closed_at":"2019-12-28T00:07:24Z","merged_at":null,"merge_commit_sha":"e24ea418f448a538a05ca3db198cfe74ccc639a2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25056/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25056/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25056/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/89216cbfb70485bba62bd6629832e21aa1d15070","head":{"label":"uncleGen:SPARK-28256","ref":"SPARK-28256","sha":"89216cbfb70485bba62bd6629832e21aa1d15070","user":{"login":"uncleGen","id":7402327,"node_id":"MDQ6VXNlcjc0MDIzMjc=","avatar_url":"https://avatars.githubusercontent.com/u/7402327?v=4","gravatar_id":"","url":"https://api.github.com/users/uncleGen","html_url":"https://github.com/uncleGen","followers_url":"https://api.github.com/users/uncleGen/followers","following_url":"https://api.github.com/users/uncleGen/following{/other_user}","gists_url":"https://api.github.com/users/uncleGen/gists{/gist_id}","starred_url":"https://api.github.com/users/uncleGen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uncleGen/subscriptions","organizations_url":"https://api.github.com/users/uncleGen/orgs","repos_url":"https://api.github.com/users/uncleGen/repos","events_url":"https://api.github.com/users/uncleGen/events{/privacy}","received_events_url":"https://api.github.com/users/uncleGen/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":23988410,"node_id":"MDEwOlJlcG9zaXRvcnkyMzk4ODQxMA==","name":"spark","full_name":"uncleGen/spark","private":false,"owner":{"login":"uncleGen","id":7402327,"node_id":"MDQ6VXNlcjc0MDIzMjc=","avatar_url":"https://avatars.githubusercontent.com/u/7402327?v=4","gravatar_id":"","url":"https://api.github.com/users/uncleGen","html_url":"https://github.com/uncleGen","followers_url":"https://api.github.com/users/uncleGen/followers","following_url":"https://api.github.com/users/uncleGen/following{/other_user}","gists_url":"https://api.github.com/users/uncleGen/gists{/gist_id}","starred_url":"https://api.github.com/users/uncleGen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uncleGen/subscriptions","organizations_url":"https://api.github.com/users/uncleGen/orgs","repos_url":"https://api.github.com/users/uncleGen/repos","events_url":"https://api.github.com/users/uncleGen/events{/privacy}","received_events_url":"https://api.github.com/users/uncleGen/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/uncleGen/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/uncleGen/spark","forks_url":"https://api.github.com/repos/uncleGen/spark/forks","keys_url":"https://api.github.com/repos/uncleGen/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/uncleGen/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/uncleGen/spark/teams","hooks_url":"https://api.github.com/repos/uncleGen/spark/hooks","issue_events_url":"https://api.github.com/repos/uncleGen/spark/issues/events{/number}","events_url":"https://api.github.com/repos/uncleGen/spark/events","assignees_url":"https://api.github.com/repos/uncleGen/spark/assignees{/user}","branches_url":"https://api.github.com/repos/uncleGen/spark/branches{/branch}","tags_url":"https://api.github.com/repos/uncleGen/spark/tags","blobs_url":"https://api.github.com/repos/uncleGen/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/uncleGen/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/uncleGen/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/uncleGen/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/uncleGen/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/uncleGen/spark/languages","stargazers_url":"https://api.github.com/repos/uncleGen/spark/stargazers","contributors_url":"https://api.github.com/repos/uncleGen/spark/contributors","subscribers_url":"https://api.github.com/repos/uncleGen/spark/subscribers","subscription_url":"https://api.github.com/repos/uncleGen/spark/subscription","commits_url":"https://api.github.com/repos/uncleGen/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/uncleGen/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/uncleGen/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/uncleGen/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/uncleGen/spark/contents/{+path}","compare_url":"https://api.github.com/repos/uncleGen/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/uncleGen/spark/merges","archive_url":"https://api.github.com/repos/uncleGen/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/uncleGen/spark/downloads","issues_url":"https://api.github.com/repos/uncleGen/spark/issues{/number}","pulls_url":"https://api.github.com/repos/uncleGen/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/uncleGen/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/uncleGen/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/uncleGen/spark/labels{/name}","releases_url":"https://api.github.com/repos/uncleGen/spark/releases{/id}","deployments_url":"https://api.github.com/repos/uncleGen/spark/deployments","created_at":"2014-09-13T07:16:52Z","updated_at":"2015-03-24T04:21:04Z","pushed_at":"2020-12-07T10:01:10Z","git_url":"git://github.com/uncleGen/spark.git","ssh_url":"git@github.com:uncleGen/spark.git","clone_url":"https://github.com/uncleGen/spark.git","svn_url":"https://github.com/uncleGen/spark","homepage":null,"size":322219,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5c55812400e1e0a8aaeb50a50be106e80c916c86","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25056"},"html":{"href":"https://github.com/apache/spark/pull/25056"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25056"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25056/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25056/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25056/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/89216cbfb70485bba62bd6629832e21aa1d15070"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25055","id":294701300,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NzAxMzAw","html_url":"https://github.com/apache/spark/pull/25055","diff_url":"https://github.com/apache/spark/pull/25055.diff","patch_url":"https://github.com/apache/spark/pull/25055.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25055","number":25055,"state":"closed","locked":false,"title":"[SPARK-28189][SQL] Use semanticEquals in Dataset drop method for attributes comparison","user":{"login":"Tonix517","id":5504323,"node_id":"MDQ6VXNlcjU1MDQzMjM=","avatar_url":"https://avatars.githubusercontent.com/u/5504323?v=4","gravatar_id":"","url":"https://api.github.com/users/Tonix517","html_url":"https://github.com/Tonix517","followers_url":"https://api.github.com/users/Tonix517/followers","following_url":"https://api.github.com/users/Tonix517/following{/other_user}","gists_url":"https://api.github.com/users/Tonix517/gists{/gist_id}","starred_url":"https://api.github.com/users/Tonix517/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tonix517/subscriptions","organizations_url":"https://api.github.com/users/Tonix517/orgs","repos_url":"https://api.github.com/users/Tonix517/repos","events_url":"https://api.github.com/users/Tonix517/events{/privacy}","received_events_url":"https://api.github.com/users/Tonix517/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nIn Dataset drop(col: Column) method, the `equals` comparison method was used instead of `semanticEquals`, which caused the problem of abnormal case-sensitivity behavior. When attributes of LogicalPlan are checked for equality, `semanticEquals` should be used instead.\r\n\r\nA similar PR I referred to: https://github.com/apache/spark/pull/22713 created by @mgaido91 \r\n\r\n## How was this patch tested?\r\n\r\n- Added new unit test case in DataFrameSuite\r\n- ./build/sbt \"testOnly org.apache.spark.sql.*\"\r\n- The python code from ticket reporter at https://issues.apache.org/jira/browse/SPARK-28189\r\n\r\n","created_at":"2019-07-05T00:10:38Z","updated_at":"2019-07-21T03:18:05Z","closed_at":"2019-07-07T04:43:43Z","merged_at":null,"merge_commit_sha":"5782182b5d5e2a8bf6329401445d9bd489ac2107","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25055/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25055/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25055/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1dc9aa73bf4077bf7de6ab46c7227f09d7d4ffdb","head":{"label":"Tonix517:SPARK-28189","ref":"SPARK-28189","sha":"1dc9aa73bf4077bf7de6ab46c7227f09d7d4ffdb","user":{"login":"Tonix517","id":5504323,"node_id":"MDQ6VXNlcjU1MDQzMjM=","avatar_url":"https://avatars.githubusercontent.com/u/5504323?v=4","gravatar_id":"","url":"https://api.github.com/users/Tonix517","html_url":"https://github.com/Tonix517","followers_url":"https://api.github.com/users/Tonix517/followers","following_url":"https://api.github.com/users/Tonix517/following{/other_user}","gists_url":"https://api.github.com/users/Tonix517/gists{/gist_id}","starred_url":"https://api.github.com/users/Tonix517/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tonix517/subscriptions","organizations_url":"https://api.github.com/users/Tonix517/orgs","repos_url":"https://api.github.com/users/Tonix517/repos","events_url":"https://api.github.com/users/Tonix517/events{/privacy}","received_events_url":"https://api.github.com/users/Tonix517/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":193259908,"node_id":"MDEwOlJlcG9zaXRvcnkxOTMyNTk5MDg=","name":"spark","full_name":"Tonix517/spark","private":false,"owner":{"login":"Tonix517","id":5504323,"node_id":"MDQ6VXNlcjU1MDQzMjM=","avatar_url":"https://avatars.githubusercontent.com/u/5504323?v=4","gravatar_id":"","url":"https://api.github.com/users/Tonix517","html_url":"https://github.com/Tonix517","followers_url":"https://api.github.com/users/Tonix517/followers","following_url":"https://api.github.com/users/Tonix517/following{/other_user}","gists_url":"https://api.github.com/users/Tonix517/gists{/gist_id}","starred_url":"https://api.github.com/users/Tonix517/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tonix517/subscriptions","organizations_url":"https://api.github.com/users/Tonix517/orgs","repos_url":"https://api.github.com/users/Tonix517/repos","events_url":"https://api.github.com/users/Tonix517/events{/privacy}","received_events_url":"https://api.github.com/users/Tonix517/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Tonix517/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/Tonix517/spark","forks_url":"https://api.github.com/repos/Tonix517/spark/forks","keys_url":"https://api.github.com/repos/Tonix517/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Tonix517/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Tonix517/spark/teams","hooks_url":"https://api.github.com/repos/Tonix517/spark/hooks","issue_events_url":"https://api.github.com/repos/Tonix517/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Tonix517/spark/events","assignees_url":"https://api.github.com/repos/Tonix517/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Tonix517/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Tonix517/spark/tags","blobs_url":"https://api.github.com/repos/Tonix517/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Tonix517/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Tonix517/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Tonix517/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Tonix517/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Tonix517/spark/languages","stargazers_url":"https://api.github.com/repos/Tonix517/spark/stargazers","contributors_url":"https://api.github.com/repos/Tonix517/spark/contributors","subscribers_url":"https://api.github.com/repos/Tonix517/spark/subscribers","subscription_url":"https://api.github.com/repos/Tonix517/spark/subscription","commits_url":"https://api.github.com/repos/Tonix517/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Tonix517/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Tonix517/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Tonix517/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Tonix517/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Tonix517/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Tonix517/spark/merges","archive_url":"https://api.github.com/repos/Tonix517/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Tonix517/spark/downloads","issues_url":"https://api.github.com/repos/Tonix517/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Tonix517/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Tonix517/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Tonix517/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Tonix517/spark/labels{/name}","releases_url":"https://api.github.com/repos/Tonix517/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Tonix517/spark/deployments","created_at":"2019-06-22T17:14:34Z","updated_at":"2021-05-03T00:35:56Z","pushed_at":"2021-05-03T00:34:56Z","git_url":"git://github.com/Tonix517/spark.git","ssh_url":"git@github.com:Tonix517/spark.git","clone_url":"https://github.com/Tonix517/spark.git","svn_url":"https://github.com/Tonix517/spark","homepage":"","size":355776,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4ed88b32adcf9f2c3c9fbf12d599a91450f29ce9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25055"},"html":{"href":"https://github.com/apache/spark/pull/25055"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25055"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25055/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25055/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25055/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1dc9aa73bf4077bf7de6ab46c7227f09d7d4ffdb"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25054","id":294626593,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NjI2NTkz","html_url":"https://github.com/apache/spark/pull/25054","diff_url":"https://github.com/apache/spark/pull/25054.diff","patch_url":"https://github.com/apache/spark/pull/25054.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25054","number":25054,"state":"closed","locked":false,"title":"[SPARK-28251][SQL] Fix error message of inserting into a non-existing table","user":{"login":"peter-toth","id":7253827,"node_id":"MDQ6VXNlcjcyNTM4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/7253827?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-toth","html_url":"https://github.com/peter-toth","followers_url":"https://api.github.com/users/peter-toth/followers","following_url":"https://api.github.com/users/peter-toth/following{/other_user}","gists_url":"https://api.github.com/users/peter-toth/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-toth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-toth/subscriptions","organizations_url":"https://api.github.com/users/peter-toth/orgs","repos_url":"https://api.github.com/users/peter-toth/repos","events_url":"https://api.github.com/users/peter-toth/events{/privacy}","received_events_url":"https://api.github.com/users/peter-toth/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nBefore this PR inserting into a non-existing table returned a weird error message:\r\n```\r\nsql(\"INSERT INTO test VALUES (1)\").show\r\norg.apache.spark.sql.AnalysisException: unresolved operator 'InsertIntoTable 'UnresolvedRelation [test], false, false;;\r\n'InsertIntoTable 'UnresolvedRelation [test], false, false\r\n+- LocalRelation [col1#4]\r\n```\r\nafter this PR the error message becomes:\r\n```\r\norg.apache.spark.sql.AnalysisException: Table not found: test;;\r\n'InsertIntoTable 'UnresolvedRelation [test], false, false\r\n+- LocalRelation [col1#0]\r\n```\r\n\r\n## How was this patch tested?\r\n\r\nAdded a new UT.\r\n","created_at":"2019-07-04T15:30:21Z","updated_at":"2019-07-04T19:37:14Z","closed_at":"2019-07-04T19:37:14Z","merged_at":null,"merge_commit_sha":"672a0f26d3ff47000ab6f2a7ffad8554a0e14065","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25054/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25054/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25054/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9ac59ba336b7ae00a11a456517ac703900141828","head":{"label":"peter-toth:SPARK-28251","ref":"SPARK-28251","sha":"9ac59ba336b7ae00a11a456517ac703900141828","user":{"login":"peter-toth","id":7253827,"node_id":"MDQ6VXNlcjcyNTM4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/7253827?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-toth","html_url":"https://github.com/peter-toth","followers_url":"https://api.github.com/users/peter-toth/followers","following_url":"https://api.github.com/users/peter-toth/following{/other_user}","gists_url":"https://api.github.com/users/peter-toth/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-toth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-toth/subscriptions","organizations_url":"https://api.github.com/users/peter-toth/orgs","repos_url":"https://api.github.com/users/peter-toth/repos","events_url":"https://api.github.com/users/peter-toth/events{/privacy}","received_events_url":"https://api.github.com/users/peter-toth/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":130546049,"node_id":"MDEwOlJlcG9zaXRvcnkxMzA1NDYwNDk=","name":"spark","full_name":"peter-toth/spark","private":false,"owner":{"login":"peter-toth","id":7253827,"node_id":"MDQ6VXNlcjcyNTM4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/7253827?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-toth","html_url":"https://github.com/peter-toth","followers_url":"https://api.github.com/users/peter-toth/followers","following_url":"https://api.github.com/users/peter-toth/following{/other_user}","gists_url":"https://api.github.com/users/peter-toth/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-toth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-toth/subscriptions","organizations_url":"https://api.github.com/users/peter-toth/orgs","repos_url":"https://api.github.com/users/peter-toth/repos","events_url":"https://api.github.com/users/peter-toth/events{/privacy}","received_events_url":"https://api.github.com/users/peter-toth/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/peter-toth/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/peter-toth/spark","forks_url":"https://api.github.com/repos/peter-toth/spark/forks","keys_url":"https://api.github.com/repos/peter-toth/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/peter-toth/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/peter-toth/spark/teams","hooks_url":"https://api.github.com/repos/peter-toth/spark/hooks","issue_events_url":"https://api.github.com/repos/peter-toth/spark/issues/events{/number}","events_url":"https://api.github.com/repos/peter-toth/spark/events","assignees_url":"https://api.github.com/repos/peter-toth/spark/assignees{/user}","branches_url":"https://api.github.com/repos/peter-toth/spark/branches{/branch}","tags_url":"https://api.github.com/repos/peter-toth/spark/tags","blobs_url":"https://api.github.com/repos/peter-toth/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/peter-toth/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/peter-toth/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/peter-toth/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/peter-toth/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/peter-toth/spark/languages","stargazers_url":"https://api.github.com/repos/peter-toth/spark/stargazers","contributors_url":"https://api.github.com/repos/peter-toth/spark/contributors","subscribers_url":"https://api.github.com/repos/peter-toth/spark/subscribers","subscription_url":"https://api.github.com/repos/peter-toth/spark/subscription","commits_url":"https://api.github.com/repos/peter-toth/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/peter-toth/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/peter-toth/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/peter-toth/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/peter-toth/spark/contents/{+path}","compare_url":"https://api.github.com/repos/peter-toth/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/peter-toth/spark/merges","archive_url":"https://api.github.com/repos/peter-toth/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/peter-toth/spark/downloads","issues_url":"https://api.github.com/repos/peter-toth/spark/issues{/number}","pulls_url":"https://api.github.com/repos/peter-toth/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/peter-toth/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/peter-toth/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/peter-toth/spark/labels{/name}","releases_url":"https://api.github.com/repos/peter-toth/spark/releases{/id}","deployments_url":"https://api.github.com/repos/peter-toth/spark/deployments","created_at":"2018-04-22T07:43:37Z","updated_at":"2025-01-06T11:44:37Z","pushed_at":"2025-01-07T12:36:36Z","git_url":"git://github.com/peter-toth/spark.git","ssh_url":"git@github.com:peter-toth/spark.git","clone_url":"https://github.com/peter-toth/spark.git","svn_url":"https://github.com/peter-toth/spark","homepage":null,"size":498613,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":3,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"cad440d1f59d9bb674e06b0f656d6bb9d7872bf9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25054"},"html":{"href":"https://github.com/apache/spark/pull/25054"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25054"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25054/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25054/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25054/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9ac59ba336b7ae00a11a456517ac703900141828"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25053","id":294611491,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NjExNDkx","html_url":"https://github.com/apache/spark/pull/25053","diff_url":"https://github.com/apache/spark/pull/25053.diff","patch_url":"https://github.com/apache/spark/pull/25053.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25053","number":25053,"state":"closed","locked":false,"title":"[SPARK-28252][SQL] local/global temp views should not accept duplicate column names","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nWe disabled create table with duplicate column names:\r\nhttps://github.com/apache/spark/blob/f9837d3bf6c15600f926917a253bf1bdddb4d1b4/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/rules.scala#L247-L250\r\n\r\nBut we can create local/global temporary views with duplicate column names. This pr disabled create local/global temporary views with duplicate column names. Otherwise:\r\n```shell\r\nscala> spark.sql(\"create temp view v1 as select 1 as col1, 2 as col1\")\r\nres0: org.apache.spark.sql.DataFrame = []\r\n\r\nscala> spark.sql(\"select col1 from v1\").show\r\n19/07/04 22:27:19 WARN ObjectStore: Failed to get database global_temp, returning NoSuchObjectException\r\norg.apache.spark.sql.AnalysisException: Reference 'col1' is ambiguous, could be: v1.col1, v1.col1.; line 1 pos 7\r\n  at org.apache.spark.sql.catalyst.expressions.package$AttributeSeq.resolve(package.scala:259)\r\n```\r\n\r\n\r\n\r\n## How was this patch tested?\r\n\r\nunit tests\r\n","created_at":"2019-07-04T14:44:04Z","updated_at":"2019-12-27T08:26:59Z","closed_at":"2019-12-27T08:26:59Z","merged_at":null,"merge_commit_sha":"187862a3fee12c59d571776126e3e9fcb67b78e7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25053/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25053/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25053/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/129ac2d926d4f129537b3a718bc0b915a4ad27f2","head":{"label":"wangyum:SPARK-28252","ref":"SPARK-28252","sha":"129ac2d926d4f129537b3a718bc0b915a4ad27f2","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"1b232671a8210ed7de5e7e3ce5aecc140db847f2","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25053"},"html":{"href":"https://github.com/apache/spark/pull/25053"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25053"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25053/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25053/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25053/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/129ac2d926d4f129537b3a718bc0b915a4ad27f2"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25052","id":294583327,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NTgzMzI3","html_url":"https://github.com/apache/spark/pull/25052","diff_url":"https://github.com/apache/spark/pull/25052.diff","patch_url":"https://github.com/apache/spark/pull/25052.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25052","number":25052,"state":"closed","locked":false,"title":"[SPARK-28250][SQL] QueryPlan#references should exclude producedAttributes","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis is a followup of the discussion in https://github.com/apache/spark/pull/24675#discussion_r286786053\r\n\r\n`QueryPlan#references` is an important property. The `ColumnPrunning` rule relies on it.\r\n\r\nSome query plan nodes have `Seq[Attribute]` parameter, which is used as its output attributes. For example, leaf nodes, `Generate`, `MapPartitionsInPandas`, etc. These nodes override `producedAttributes` to make `missingInputs` correct.\r\n\r\nHowever, these nodes also need to override `references` to make column pruning work. This PR proposes to exclude `producedAttributes` from the default implementation of `QueryPlan#references`, so that we don't need to override `references` in all these nodes.\r\n\r\nNote that, technically we can remove `producedAttributes` and always ask query plan nodes to override `references`. But I do find the code can be simpler with `producedAttributes` in some places, where there is a base class for some specific query plan nodes.\r\n\r\n## How was this patch tested?\r\n\r\nexisting tests","created_at":"2019-07-04T13:30:05Z","updated_at":"2019-07-09T03:09:19Z","closed_at":"2019-07-09T03:09:19Z","merged_at":null,"merge_commit_sha":"db1665b19687bfa897730f6b8237c17a715e6ff8","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25052/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25052/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25052/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e7fc7e906d8266d1997c06e8d208a5bc0ce063a3","head":{"label":"cloud-fan:minor","ref":"minor","sha":"e7fc7e906d8266d1997c06e8d208a5bc0ce063a3","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"cad440d1f59d9bb674e06b0f656d6bb9d7872bf9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25052"},"html":{"href":"https://github.com/apache/spark/pull/25052"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25052"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25052/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25052/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25052/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e7fc7e906d8266d1997c06e8d208a5bc0ce063a3"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25051","id":294578970,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NTc4OTcw","html_url":"https://github.com/apache/spark/pull/25051","diff_url":"https://github.com/apache/spark/pull/25051.diff","patch_url":"https://github.com/apache/spark/pull/25051.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25051","number":25051,"state":"closed","locked":false,"title":"[SPARK-28249][K8S][DOC] Update the path in the comment inside the Dockerfile","user":{"login":"sujeshchirackkal","id":1498788,"node_id":"MDQ6VXNlcjE0OTg3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1498788?v=4","gravatar_id":"","url":"https://api.github.com/users/sujeshchirackkal","html_url":"https://github.com/sujeshchirackkal","followers_url":"https://api.github.com/users/sujeshchirackkal/followers","following_url":"https://api.github.com/users/sujeshchirackkal/following{/other_user}","gists_url":"https://api.github.com/users/sujeshchirackkal/gists{/gist_id}","starred_url":"https://api.github.com/users/sujeshchirackkal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sujeshchirackkal/subscriptions","organizations_url":"https://api.github.com/users/sujeshchirackkal/orgs","repos_url":"https://api.github.com/users/sujeshchirackkal/repos","events_url":"https://api.github.com/users/sujeshchirackkal/events{/privacy}","received_events_url":"https://api.github.com/users/sujeshchirackkal/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nCorrects the path given in the comment for building the docker image\r\n\r\n## How was this patch tested?\r\n\r\nNo testing done. it changes only the comment. \r\n","created_at":"2019-07-04T13:18:37Z","updated_at":"2019-07-04T19:34:22Z","closed_at":"2019-07-04T17:22:55Z","merged_at":null,"merge_commit_sha":"566f588a514408eb028bb7171508694e47d7712d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406605057,"node_id":"MDU6TGFiZWwxNDA2NjA1MDU3","url":"https://api.github.com/repos/apache/spark/labels/KUBERNETES","name":"KUBERNETES","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25051/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25051/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25051/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/cb62f3cefaedafd8cd52cc42843382e45ed20878","head":{"label":"sujeshchirackkal:kube_dockerfile_update","ref":"kube_dockerfile_update","sha":"cb62f3cefaedafd8cd52cc42843382e45ed20878","user":{"login":"sujeshchirackkal","id":1498788,"node_id":"MDQ6VXNlcjE0OTg3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1498788?v=4","gravatar_id":"","url":"https://api.github.com/users/sujeshchirackkal","html_url":"https://github.com/sujeshchirackkal","followers_url":"https://api.github.com/users/sujeshchirackkal/followers","following_url":"https://api.github.com/users/sujeshchirackkal/following{/other_user}","gists_url":"https://api.github.com/users/sujeshchirackkal/gists{/gist_id}","starred_url":"https://api.github.com/users/sujeshchirackkal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sujeshchirackkal/subscriptions","organizations_url":"https://api.github.com/users/sujeshchirackkal/orgs","repos_url":"https://api.github.com/users/sujeshchirackkal/repos","events_url":"https://api.github.com/users/sujeshchirackkal/events{/privacy}","received_events_url":"https://api.github.com/users/sujeshchirackkal/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":195240531,"node_id":"MDEwOlJlcG9zaXRvcnkxOTUyNDA1MzE=","name":"spark","full_name":"sujeshchirackkal/spark","private":false,"owner":{"login":"sujeshchirackkal","id":1498788,"node_id":"MDQ6VXNlcjE0OTg3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1498788?v=4","gravatar_id":"","url":"https://api.github.com/users/sujeshchirackkal","html_url":"https://github.com/sujeshchirackkal","followers_url":"https://api.github.com/users/sujeshchirackkal/followers","following_url":"https://api.github.com/users/sujeshchirackkal/following{/other_user}","gists_url":"https://api.github.com/users/sujeshchirackkal/gists{/gist_id}","starred_url":"https://api.github.com/users/sujeshchirackkal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sujeshchirackkal/subscriptions","organizations_url":"https://api.github.com/users/sujeshchirackkal/orgs","repos_url":"https://api.github.com/users/sujeshchirackkal/repos","events_url":"https://api.github.com/users/sujeshchirackkal/events{/privacy}","received_events_url":"https://api.github.com/users/sujeshchirackkal/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sujeshchirackkal/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/sujeshchirackkal/spark","forks_url":"https://api.github.com/repos/sujeshchirackkal/spark/forks","keys_url":"https://api.github.com/repos/sujeshchirackkal/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sujeshchirackkal/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sujeshchirackkal/spark/teams","hooks_url":"https://api.github.com/repos/sujeshchirackkal/spark/hooks","issue_events_url":"https://api.github.com/repos/sujeshchirackkal/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sujeshchirackkal/spark/events","assignees_url":"https://api.github.com/repos/sujeshchirackkal/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sujeshchirackkal/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sujeshchirackkal/spark/tags","blobs_url":"https://api.github.com/repos/sujeshchirackkal/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sujeshchirackkal/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sujeshchirackkal/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sujeshchirackkal/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sujeshchirackkal/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sujeshchirackkal/spark/languages","stargazers_url":"https://api.github.com/repos/sujeshchirackkal/spark/stargazers","contributors_url":"https://api.github.com/repos/sujeshchirackkal/spark/contributors","subscribers_url":"https://api.github.com/repos/sujeshchirackkal/spark/subscribers","subscription_url":"https://api.github.com/repos/sujeshchirackkal/spark/subscription","commits_url":"https://api.github.com/repos/sujeshchirackkal/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sujeshchirackkal/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sujeshchirackkal/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sujeshchirackkal/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sujeshchirackkal/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sujeshchirackkal/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sujeshchirackkal/spark/merges","archive_url":"https://api.github.com/repos/sujeshchirackkal/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sujeshchirackkal/spark/downloads","issues_url":"https://api.github.com/repos/sujeshchirackkal/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sujeshchirackkal/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sujeshchirackkal/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sujeshchirackkal/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sujeshchirackkal/spark/labels{/name}","releases_url":"https://api.github.com/repos/sujeshchirackkal/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sujeshchirackkal/spark/deployments","created_at":"2019-07-04T12:48:24Z","updated_at":"2019-07-04T12:48:52Z","pushed_at":"2019-07-04T17:23:12Z","git_url":"git://github.com/sujeshchirackkal/spark.git","ssh_url":"git@github.com:sujeshchirackkal/spark.git","clone_url":"https://github.com/sujeshchirackkal/spark.git","svn_url":"https://github.com/sujeshchirackkal/spark","homepage":"","size":299867,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"cec6a329044fa7d8a4f3da3871dbacac95cc38ed","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25051"},"html":{"href":"https://github.com/apache/spark/pull/25051"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25051"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25051/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25051/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25051/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/cb62f3cefaedafd8cd52cc42843382e45ed20878"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25050","id":294559004,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NTU5MDA0","html_url":"https://github.com/apache/spark/pull/25050","diff_url":"https://github.com/apache/spark/pull/25050.diff","patch_url":"https://github.com/apache/spark/pull/25050.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25050","number":25050,"state":"closed","locked":false,"title":"[SPARK-28248][SQL][TEST] Upgrade docker image and library for PostgreSQL integration test","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis pr upgrades Postgres docker image for integration tests.\r\n\r\n## How was this patch tested?\r\n\r\nmanual tests:\r\n```\r\n./build/mvn install -DskipTests\r\n./build/mvn test -Pdocker-integration-tests -pl :spark-docker-integration-tests_2.12\r\n```\r\n","created_at":"2019-07-04T12:23:36Z","updated_at":"2019-07-05T10:04:09Z","closed_at":"2019-07-05T07:48:35Z","merged_at":null,"merge_commit_sha":"ecf7c2449ae45b4f688d7bbd1ee4d569985a4aca","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406606402,"node_id":"MDU6TGFiZWwxNDA2NjA2NDAy","url":"https://api.github.com/repos/apache/spark/labels/TESTS","name":"TESTS","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25050/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25050/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25050/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0c7f0584efad0ad49807d1f9543845ecc01e5a5f","head":{"label":"wangyum:SPARK-28248","ref":"SPARK-28248","sha":"0c7f0584efad0ad49807d1f9543845ecc01e5a5f","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"cec6a329044fa7d8a4f3da3871dbacac95cc38ed","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25050"},"html":{"href":"https://github.com/apache/spark/pull/25050"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25050"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25050/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25050/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25050/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0c7f0584efad0ad49807d1f9543845ecc01e5a5f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25049","id":294497173,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NDk3MTcz","html_url":"https://github.com/apache/spark/pull/25049","diff_url":"https://github.com/apache/spark/pull/25049.diff","patch_url":"https://github.com/apache/spark/pull/25049.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25049","number":25049,"state":"closed","locked":false,"title":"[SPARK-26713][CORE][followup] revert the partial fix in ShuffleBlockFetcherIterator","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR reverts the partial bug fix in `ShuffleBlockFetcherIterator` which was introduced by https://github.com/apache/spark/pull/23638 .\r\nThe reasons:\r\n1. It's a potential bug. After fixing `PipelinedRDD` in #23638 , the original problem was resolved.\r\n2. The fix is incomplete according to [the discussion](https://github.com/apache/spark/pull/23638#discussion_r251869084)\r\n\r\nWe should fix the potential bug completely later.\r\n\r\n## How was this patch tested?\r\n\r\nexisting tests","created_at":"2019-07-04T09:24:32Z","updated_at":"2019-07-09T02:55:16Z","closed_at":"2019-07-09T02:55:16Z","merged_at":null,"merge_commit_sha":"0cfb1526856a458b486b222cbedc29fea73a9925","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25049/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25049/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25049/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/79bfab8506a3805bd487081af583384f57c0f263","head":{"label":"cloud-fan:revert","ref":"revert","sha":"79bfab8506a3805bd487081af583384f57c0f263","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"cec6a329044fa7d8a4f3da3871dbacac95cc38ed","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25049"},"html":{"href":"https://github.com/apache/spark/pull/25049"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25049"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25049/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25049/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25049/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/79bfab8506a3805bd487081af583384f57c0f263"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25048","id":294471035,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0NDcxMDM1","html_url":"https://github.com/apache/spark/pull/25048","diff_url":"https://github.com/apache/spark/pull/25048.diff","patch_url":"https://github.com/apache/spark/pull/25048.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25048","number":25048,"state":"closed","locked":false,"title":"[SPARK-28247][SS] Fix flaky test \"query without test harness\" on ContinuousSuite ","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis patch fixes the flaky test \"query without test harness\" on ContinuousSuite, via adding some more gaps on waiting query to commit the epoch which writes output rows.\r\n\r\nThe observation of this issue is below (injected some debug logs to get them):\r\n\r\n```\r\nreader creation time                                   1562225320210\r\nepoch 1 launched                                       1562225320593 (+380ms from reader creation time)\r\nepoch 13 launched                                      1562225321702 (+1.5s from reader creation time)\r\npartition reader creation time                         1562225321715 (+1.5s from reader creation time)\r\n\r\nnext read time for first next call                     1562225321210 (+1s from reader creation time)\r\nfirst next called in partition reader                  1562225321746 (immediately after creation of partition reader)\r\nwait finished in next called in partition reader       1562225321746 (no wait)\r\n\r\nsecond next called in partition reader                 1562225321747 (immediately after first next())\r\n\r\nepoch 0 commit started                                 1562225321861\r\n\r\nwriting rows (0, 1) (belong to epoch 13)               1562225321866 (+100ms after first next())\r\n\r\nwait start in waitForRateSourceTriggers(2)             1562225322059\r\n\r\nnext read time for second next call                    1562225322210 (+1s from previous \"next read time\")\r\nwait finished in next called in partition reader       1562225322211 (+450ms wait)\r\n\r\nwriting rows (2, 3) (belong to epoch 13)               1562225322211 (immediately after next())\r\n\r\nepoch 14 launched                                      1562225322246\r\n\r\ndesired wait time in waitForRateSourceTriggers(2)      1562225322510 (+2.3s from reader creation time)\r\n\r\nepoch 12 committed                                     1562225323034\r\n```\r\n\r\nThese rows were written within desired wait time, but the epoch 13 couldn't be committed within it. Interestingly, epoch 12 was lucky to be committed within a gap between finished waiting in waitForRateSourceTriggers and query.stop() - but even suppose the rows were written in epoch 12, it would be just in luck and epoch should be committed within desired wait time.\r\n\r\nThis patch modifies Rate continuous stream to track the highest committed value, so that test can wait until desired value is reported to the stream as committed.\r\n\r\nThis patch also modifies Rate continuous stream to track the timestamp at stream gets the first committed offset, and let `waitForRateSourceTriggers` use the timestamp. This also relies on waiting for specific period, but safer approach compared to current based on the observation above. Based on the change, this patch saves couple of seconds in test time.\r\n\r\n## How was this patch tested?\r\n\r\n10 sequential test runs succeeded locally.","created_at":"2019-07-04T08:15:51Z","updated_at":"2019-07-15T01:11:54Z","closed_at":"2019-07-13T17:16:01Z","merged_at":null,"merge_commit_sha":"30073ce30db99b109c8297be063e83672c068901","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25048/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25048/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25048/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6706a65ac2f7d7735332e7863c565e1994f5d431","head":{"label":"HeartSaVioR:SPARK-28247","ref":"SPARK-28247","sha":"6706a65ac2f7d7735332e7863c565e1994f5d431","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":27994296,"node_id":"MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==","name":"spark","full_name":"HeartSaVioR/spark","private":false,"owner":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HeartSaVioR/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HeartSaVioR/spark","forks_url":"https://api.github.com/repos/HeartSaVioR/spark/forks","keys_url":"https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HeartSaVioR/spark/teams","hooks_url":"https://api.github.com/repos/HeartSaVioR/spark/hooks","issue_events_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HeartSaVioR/spark/events","assignees_url":"https://api.github.com/repos/HeartSaVioR/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HeartSaVioR/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HeartSaVioR/spark/tags","blobs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HeartSaVioR/spark/languages","stargazers_url":"https://api.github.com/repos/HeartSaVioR/spark/stargazers","contributors_url":"https://api.github.com/repos/HeartSaVioR/spark/contributors","subscribers_url":"https://api.github.com/repos/HeartSaVioR/spark/subscribers","subscription_url":"https://api.github.com/repos/HeartSaVioR/spark/subscription","commits_url":"https://api.github.com/repos/HeartSaVioR/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HeartSaVioR/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HeartSaVioR/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HeartSaVioR/spark/merges","archive_url":"https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HeartSaVioR/spark/downloads","issues_url":"https://api.github.com/repos/HeartSaVioR/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HeartSaVioR/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HeartSaVioR/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HeartSaVioR/spark/labels{/name}","releases_url":"https://api.github.com/repos/HeartSaVioR/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HeartSaVioR/spark/deployments","created_at":"2014-12-14T12:56:04Z","updated_at":"2024-10-21T04:36:36Z","pushed_at":"2025-01-08T06:13:27Z","git_url":"git://github.com/HeartSaVioR/spark.git","ssh_url":"git@github.com:HeartSaVioR/spark.git","clone_url":"https://github.com/HeartSaVioR/spark.git","svn_url":"https://github.com/HeartSaVioR/spark","homepage":null,"size":456164,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":1,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"28ea445c4325ff567a1b80903e656cf34767e0fe","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25048"},"html":{"href":"https://github.com/apache/spark/pull/25048"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25048"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25048/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25048/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25048/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6706a65ac2f7d7735332e7863c565e1994f5d431"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25047","id":294394766,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0Mzk0NzY2","html_url":"https://github.com/apache/spark/pull/25047","diff_url":"https://github.com/apache/spark/pull/25047.diff","patch_url":"https://github.com/apache/spark/pull/25047.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25047","number":25047,"state":"closed","locked":false,"title":"[SPARK-27371][CORE] Support GPU-aware resources scheduling in Standalone","user":{"login":"Ngone51","id":16397174,"node_id":"MDQ6VXNlcjE2Mzk3MTc0","avatar_url":"https://avatars.githubusercontent.com/u/16397174?v=4","gravatar_id":"","url":"https://api.github.com/users/Ngone51","html_url":"https://github.com/Ngone51","followers_url":"https://api.github.com/users/Ngone51/followers","following_url":"https://api.github.com/users/Ngone51/following{/other_user}","gists_url":"https://api.github.com/users/Ngone51/gists{/gist_id}","starred_url":"https://api.github.com/users/Ngone51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ngone51/subscriptions","organizations_url":"https://api.github.com/users/Ngone51/orgs","repos_url":"https://api.github.com/users/Ngone51/repos","events_url":"https://api.github.com/users/Ngone51/events{/privacy}","received_events_url":"https://api.github.com/users/Ngone51/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nIn this PR, we implements a complete process of GPU-aware resources scheduling\r\nin Standalone. The whole process looks like: Worker sets up isolated resources\r\nwhen it starts up and registers to master along with its resources. And, Master\r\npicks up usable workers according to driver/executor's resource requirements to\r\nlaunch driver/executor on them. Then, Worker launches the driver/executor after\r\npreparing resources file, which is created under driver/executor's working directory,\r\nwith specified resource addresses(told by master). When driver/executor finished,\r\ntheir resources could be recycled to worker. Finally, if a worker stops, it\r\nshould always release its resources firstly.\r\n\r\nFor the case of Workers and Drivers in **client** mode run on the same host, we introduce\r\na config option named `spark.resources.coordinate.enable`(default true) to indicate \r\nwhether Spark should coordinate resources for user. If `spark.resources.coordinate.enable=false`, user should be responsible for configuring different resources for Workers and Drivers when use resourcesFile or discovery script. If true, Spark would help user to assign different  resources for Workers and Drivers.\r\n\r\nThe solution for Spark to coordinate resources among Workers and Drivers is:\r\n\r\nGenerally, use a shared file named *____allocated_resources____.json* to sync allocated\r\nresources info among Workers and Drivers on the same host. \r\n\r\nAfter a Worker or Driver found all resources using the configured resourcesFile and/or \r\ndiscovery script during launching, it should filter out available resources by excluding resources already allocated in *____allocated_resources____.json* and acquire resources from available resources according to its own requirement. After that, it should write its allocated resources along with its process id (pid) into *____allocated_resources____.json*.  Pid (proposed by @tgravescs) here used to check whether the allocated resources are still valid in case of Worker or Driver crashes and doesn't release resources properly. And when a Worker or Driver finished, normally, it would always clean up its own allocated resources in *____allocated_resources____.json*.\r\n\r\nNote that we'll always get a file lock before any access to file *____allocated_resources____.json*\r\nand release the lock finally. \r\n\r\nFuthermore, we appended resources info in `WorkerSchedulerStateResponse` to work\r\naround master change behaviour in HA mode.\r\n\r\n## How was this patch tested?\r\n\r\nAdded unit tests in WorkerSuite, MasterSuite, SparkContextSuite.\r\n\r\nManually tested with client/cluster mode (e.g. multiple workers) in a single node Standalone.","created_at":"2019-07-04T02:46:03Z","updated_at":"2019-08-10T08:27:56Z","closed_at":"2019-08-09T12:54:25Z","merged_at":null,"merge_commit_sha":"273b0f18f660e0e191d1531d3e711435728a480c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801482,"node_id":"MDU6TGFiZWwxNDA1ODAxNDgy","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20CORE","name":"SPARK CORE","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25047/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25047/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25047/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/15a9897131f06ec115b13d97e86c497ef36dace8","head":{"label":"Ngone51:SPARK-27371","ref":"SPARK-27371","sha":"15a9897131f06ec115b13d97e86c497ef36dace8","user":{"login":"Ngone51","id":16397174,"node_id":"MDQ6VXNlcjE2Mzk3MTc0","avatar_url":"https://avatars.githubusercontent.com/u/16397174?v=4","gravatar_id":"","url":"https://api.github.com/users/Ngone51","html_url":"https://github.com/Ngone51","followers_url":"https://api.github.com/users/Ngone51/followers","following_url":"https://api.github.com/users/Ngone51/following{/other_user}","gists_url":"https://api.github.com/users/Ngone51/gists{/gist_id}","starred_url":"https://api.github.com/users/Ngone51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ngone51/subscriptions","organizations_url":"https://api.github.com/users/Ngone51/orgs","repos_url":"https://api.github.com/users/Ngone51/repos","events_url":"https://api.github.com/users/Ngone51/events{/privacy}","received_events_url":"https://api.github.com/users/Ngone51/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":114185286,"node_id":"MDEwOlJlcG9zaXRvcnkxMTQxODUyODY=","name":"spark","full_name":"Ngone51/spark","private":false,"owner":{"login":"Ngone51","id":16397174,"node_id":"MDQ6VXNlcjE2Mzk3MTc0","avatar_url":"https://avatars.githubusercontent.com/u/16397174?v=4","gravatar_id":"","url":"https://api.github.com/users/Ngone51","html_url":"https://github.com/Ngone51","followers_url":"https://api.github.com/users/Ngone51/followers","following_url":"https://api.github.com/users/Ngone51/following{/other_user}","gists_url":"https://api.github.com/users/Ngone51/gists{/gist_id}","starred_url":"https://api.github.com/users/Ngone51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ngone51/subscriptions","organizations_url":"https://api.github.com/users/Ngone51/orgs","repos_url":"https://api.github.com/users/Ngone51/repos","events_url":"https://api.github.com/users/Ngone51/events{/privacy}","received_events_url":"https://api.github.com/users/Ngone51/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Ngone51/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/Ngone51/spark","forks_url":"https://api.github.com/repos/Ngone51/spark/forks","keys_url":"https://api.github.com/repos/Ngone51/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Ngone51/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Ngone51/spark/teams","hooks_url":"https://api.github.com/repos/Ngone51/spark/hooks","issue_events_url":"https://api.github.com/repos/Ngone51/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Ngone51/spark/events","assignees_url":"https://api.github.com/repos/Ngone51/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Ngone51/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Ngone51/spark/tags","blobs_url":"https://api.github.com/repos/Ngone51/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Ngone51/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Ngone51/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Ngone51/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Ngone51/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Ngone51/spark/languages","stargazers_url":"https://api.github.com/repos/Ngone51/spark/stargazers","contributors_url":"https://api.github.com/repos/Ngone51/spark/contributors","subscribers_url":"https://api.github.com/repos/Ngone51/spark/subscribers","subscription_url":"https://api.github.com/repos/Ngone51/spark/subscription","commits_url":"https://api.github.com/repos/Ngone51/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Ngone51/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Ngone51/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Ngone51/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Ngone51/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Ngone51/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Ngone51/spark/merges","archive_url":"https://api.github.com/repos/Ngone51/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Ngone51/spark/downloads","issues_url":"https://api.github.com/repos/Ngone51/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Ngone51/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Ngone51/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Ngone51/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Ngone51/spark/labels{/name}","releases_url":"https://api.github.com/repos/Ngone51/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Ngone51/spark/deployments","created_at":"2017-12-14T01:05:22Z","updated_at":"2021-11-09T15:33:30Z","pushed_at":"2025-01-23T04:25:21Z","git_url":"git://github.com/Ngone51/spark.git","ssh_url":"git@github.com:Ngone51/spark.git","clone_url":"https://github.com/Ngone51/spark.git","svn_url":"https://github.com/Ngone51/spark","homepage":null,"size":478226,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"bab88c48b1432249571aae90bc56b40d74f2fa88","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25047"},"html":{"href":"https://github.com/apache/spark/pull/25047"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25047"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25047/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25047/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25047/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/15a9897131f06ec115b13d97e86c497ef36dace8"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25046","id":294212347,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0MjEyMzQ3","html_url":"https://github.com/apache/spark/pull/25046","diff_url":"https://github.com/apache/spark/pull/25046.diff","patch_url":"https://github.com/apache/spark/pull/25046.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25046","number":25046,"state":"closed","locked":false,"title":"[SPARK-28243][PYSPARK][ML] Remove setFeatureSubsetStrategy and setSubsamplingRate from Python TreeEnsembleParams","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nRemove deprecated setFeatureSubsetStrategy and setSubsamplingRate from Python TreeEnsembleParams\r\n\r\n## How was this patch tested?\r\n\r\nUse existing tests. \r\n","created_at":"2019-07-03T15:05:33Z","updated_at":"2019-08-12T02:12:27Z","closed_at":"2019-07-20T15:49:23Z","merged_at":null,"merge_commit_sha":"97509baa26273a8e19e4f79f4a36e5a2d994135a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801475,"node_id":"MDU6TGFiZWwxNDA1ODAxNDc1","url":"https://api.github.com/repos/apache/spark/labels/ML","name":"ML","color":"ededed","default":false,"description":null},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25046/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25046/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25046/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0dd3ba6306e49da2594f233398e236b7983417c0","head":{"label":"huaxingao:spark-28243","ref":"spark-28243","sha":"0dd3ba6306e49da2594f233398e236b7983417c0","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":50813048,"node_id":"MDEwOlJlcG9zaXRvcnk1MDgxMzA0OA==","name":"spark","full_name":"huaxingao/spark","private":false,"owner":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/huaxingao/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/huaxingao/spark","forks_url":"https://api.github.com/repos/huaxingao/spark/forks","keys_url":"https://api.github.com/repos/huaxingao/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/huaxingao/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/huaxingao/spark/teams","hooks_url":"https://api.github.com/repos/huaxingao/spark/hooks","issue_events_url":"https://api.github.com/repos/huaxingao/spark/issues/events{/number}","events_url":"https://api.github.com/repos/huaxingao/spark/events","assignees_url":"https://api.github.com/repos/huaxingao/spark/assignees{/user}","branches_url":"https://api.github.com/repos/huaxingao/spark/branches{/branch}","tags_url":"https://api.github.com/repos/huaxingao/spark/tags","blobs_url":"https://api.github.com/repos/huaxingao/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/huaxingao/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/huaxingao/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/huaxingao/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/huaxingao/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/huaxingao/spark/languages","stargazers_url":"https://api.github.com/repos/huaxingao/spark/stargazers","contributors_url":"https://api.github.com/repos/huaxingao/spark/contributors","subscribers_url":"https://api.github.com/repos/huaxingao/spark/subscribers","subscription_url":"https://api.github.com/repos/huaxingao/spark/subscription","commits_url":"https://api.github.com/repos/huaxingao/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/huaxingao/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/huaxingao/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/huaxingao/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/huaxingao/spark/contents/{+path}","compare_url":"https://api.github.com/repos/huaxingao/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/huaxingao/spark/merges","archive_url":"https://api.github.com/repos/huaxingao/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/huaxingao/spark/downloads","issues_url":"https://api.github.com/repos/huaxingao/spark/issues{/number}","pulls_url":"https://api.github.com/repos/huaxingao/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/huaxingao/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/huaxingao/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/huaxingao/spark/labels{/name}","releases_url":"https://api.github.com/repos/huaxingao/spark/releases{/id}","deployments_url":"https://api.github.com/repos/huaxingao/spark/deployments","created_at":"2016-02-01T04:09:11Z","updated_at":"2022-01-06T22:35:11Z","pushed_at":"2023-12-21T02:21:07Z","git_url":"git://github.com/huaxingao/spark.git","ssh_url":"git@github.com:huaxingao/spark.git","clone_url":"https://github.com/huaxingao/spark.git","svn_url":"https://github.com/huaxingao/spark","homepage":null,"size":376946,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"913ab4b9fd2ac417822590b227ce4f7a9dd2ac04","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25046"},"html":{"href":"https://github.com/apache/spark/pull/25046"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25046"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25046/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25046/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25046/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0dd3ba6306e49da2594f233398e236b7983417c0"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25045","id":294191554,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0MTkxNTU0","html_url":"https://github.com/apache/spark/pull/25045","diff_url":"https://github.com/apache/spark/pull/25045.diff","patch_url":"https://github.com/apache/spark/pull/25045.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25045","number":25045,"state":"closed","locked":false,"title":"[MINOR] Add requestHeaderSize debug log","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\n`requestHeaderSize` is added in https://github.com/apache/spark/pull/23090 and applies to Spark + History server UI as well. Without debug log it's hard to find out on which side what configuration is used.\r\n\r\nIn this PR I've added a log message which prints out the value.\r\n\r\n## How was this patch tested?\r\n\r\nManually checked log files.\r\n","created_at":"2019-07-03T14:18:52Z","updated_at":"2019-07-03T16:46:25Z","closed_at":"2019-07-03T16:39:00Z","merged_at":null,"merge_commit_sha":"b9f57ca0eb3855fe84a49437c4cb1bf0aaccf496","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25045/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25045/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25045/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/48405c95aca7961d92304c7e45147f0264bbcb5f","head":{"label":"gaborgsomogyi:SPARK-26118","ref":"SPARK-26118","sha":"48405c95aca7961d92304c7e45147f0264bbcb5f","user":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":111547097,"node_id":"MDEwOlJlcG9zaXRvcnkxMTE1NDcwOTc=","name":"spark","full_name":"gaborgsomogyi/spark","private":false,"owner":{"login":"gaborgsomogyi","id":18561820,"node_id":"MDQ6VXNlcjE4NTYxODIw","avatar_url":"https://avatars.githubusercontent.com/u/18561820?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborgsomogyi","html_url":"https://github.com/gaborgsomogyi","followers_url":"https://api.github.com/users/gaborgsomogyi/followers","following_url":"https://api.github.com/users/gaborgsomogyi/following{/other_user}","gists_url":"https://api.github.com/users/gaborgsomogyi/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborgsomogyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborgsomogyi/subscriptions","organizations_url":"https://api.github.com/users/gaborgsomogyi/orgs","repos_url":"https://api.github.com/users/gaborgsomogyi/repos","events_url":"https://api.github.com/users/gaborgsomogyi/events{/privacy}","received_events_url":"https://api.github.com/users/gaborgsomogyi/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gaborgsomogyi/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gaborgsomogyi/spark","forks_url":"https://api.github.com/repos/gaborgsomogyi/spark/forks","keys_url":"https://api.github.com/repos/gaborgsomogyi/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gaborgsomogyi/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gaborgsomogyi/spark/teams","hooks_url":"https://api.github.com/repos/gaborgsomogyi/spark/hooks","issue_events_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gaborgsomogyi/spark/events","assignees_url":"https://api.github.com/repos/gaborgsomogyi/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gaborgsomogyi/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/tags","blobs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gaborgsomogyi/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gaborgsomogyi/spark/languages","stargazers_url":"https://api.github.com/repos/gaborgsomogyi/spark/stargazers","contributors_url":"https://api.github.com/repos/gaborgsomogyi/spark/contributors","subscribers_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscribers","subscription_url":"https://api.github.com/repos/gaborgsomogyi/spark/subscription","commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gaborgsomogyi/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gaborgsomogyi/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gaborgsomogyi/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gaborgsomogyi/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gaborgsomogyi/spark/merges","archive_url":"https://api.github.com/repos/gaborgsomogyi/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gaborgsomogyi/spark/downloads","issues_url":"https://api.github.com/repos/gaborgsomogyi/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gaborgsomogyi/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gaborgsomogyi/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gaborgsomogyi/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gaborgsomogyi/spark/labels{/name}","releases_url":"https://api.github.com/repos/gaborgsomogyi/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gaborgsomogyi/spark/deployments","created_at":"2017-11-21T12:38:03Z","updated_at":"2024-05-06T08:51:33Z","pushed_at":"2024-05-06T08:50:41Z","git_url":"git://github.com/gaborgsomogyi/spark.git","ssh_url":"git@github.com:gaborgsomogyi/spark.git","clone_url":"https://github.com/gaborgsomogyi/spark.git","svn_url":"https://github.com/gaborgsomogyi/spark","homepage":null,"size":416015,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"913ab4b9fd2ac417822590b227ce4f7a9dd2ac04","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25045"},"html":{"href":"https://github.com/apache/spark/pull/25045"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25045"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25045/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25045/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25045/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/48405c95aca7961d92304c7e45147f0264bbcb5f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/25044","id":294144975,"node_id":"MDExOlB1bGxSZXF1ZXN0Mjk0MTQ0OTc1","html_url":"https://github.com/apache/spark/pull/25044","diff_url":"https://github.com/apache/spark/pull/25044.diff","patch_url":"https://github.com/apache/spark/pull/25044.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/25044","number":25044,"state":"closed","locked":false,"title":"[SPARK-28198][PYTHON][FOLLOW-UP] Rename mapPartitionsInPandas to mapInPandas with a separate evaluation type","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"## What changes were proposed in this pull request?\r\n\r\nThis PR proposes to rename `mapPartitionsInPandas` to `mapInPandas` with a separate evaluation type .\r\n\r\nHad an offline discussion with @rxin, @mengxr and @cloud-fan\r\n\r\nThe reason is basically:\r\n\r\n1. `SCALAR_ITER` doesn't make sense with `mapPartitionsInPandas`.\r\n2. It cannot share the same Pandas UDF, for instance, at `select` and `mapPartitionsInPandas` unlike `GROUPED_AGG` because iterator's return type is different.\r\n3. `mapPartitionsInPandas` -> `mapInPandas` - see https://github.com/apache/spark/pull/25044#issuecomment-508298552 and https://github.com/apache/spark/pull/25044#issuecomment-508299764\r\n\r\nRenaming `SCALAR_ITER` as `MAP_ITER` is abandoned due to 2. reason.\r\n\r\nFor `XXX_ITER`, it might have to have a different interface in the future if we happen to add other versions of them. But this is an orthogonal topic with `mapPartitionsInPandas`.\r\n\r\n## How was this patch tested?\r\n\r\nExisting tests should cover.\r\n","created_at":"2019-07-03T12:26:57Z","updated_at":"2020-03-03T01:18:38Z","closed_at":"2019-07-05T00:27:18Z","merged_at":null,"merge_commit_sha":"a9d3ca0120fc956c782c60cfb18555c7d89ed252","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406590181,"node_id":"MDU6TGFiZWwxNDA2NTkwMTgx","url":"https://api.github.com/repos/apache/spark/labels/PYSPARK","name":"PYSPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/25044/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/25044/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/25044/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/fd7099009f49aa71b2d8ee10c9c0c321904d28f0","head":{"label":"HyukjinKwon:SPARK-28198","ref":"SPARK-28198","sha":"fd7099009f49aa71b2d8ee10c9c0c321904d28f0","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5f7aceb9df472709ffcd3b06d1132be1b077291b","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/25044"},"html":{"href":"https://github.com/apache/spark/pull/25044"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/25044"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/25044/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/25044/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/25044/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/fd7099009f49aa71b2d8ee10c9c0c321904d28f0"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null}]