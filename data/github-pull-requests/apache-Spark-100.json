[{"url":"https://api.github.com/repos/apache/spark/pulls/39951","id":1234917809,"node_id":"PR_kwDOAQXtWs5Jm1mx","html_url":"https://github.com/apache/spark/pull/39951","diff_url":"https://github.com/apache/spark/pull/39951.diff","patch_url":"https://github.com/apache/spark/pull/39951.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39951","number":39951,"state":"closed","locked":false,"title":"[SPARK-42312][SQL] Assign name to _LEGACY_ERROR_TEMP_0042","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to assign name to _LEGACY_ERROR_TEMP_0042, \"INVALID_SET_SYNTAX\".\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*`","created_at":"2023-02-09T10:59:00Z","updated_at":"2023-04-22T05:47:34Z","closed_at":"2023-02-12T14:13:16Z","merged_at":null,"merge_commit_sha":"330f4cd414436975f2d63dbbfbe879ee54542a3f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39951/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39951/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39951/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/65b1edf9171c918f43a3e8e6f92d097b1364eb25","head":{"label":"itholic:LEGACY_0042","ref":"LEGACY_0042","sha":"65b1edf9171c918f43a3e8e6f92d097b1364eb25","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"e7eb836376b72ae58b741e87d40f2d42c9914537","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39951"},"html":{"href":"https://github.com/apache/spark/pull/39951"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39951"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39951/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39951/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39951/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/65b1edf9171c918f43a3e8e6f92d097b1364eb25"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39950","id":1234749356,"node_id":"PR_kwDOAQXtWs5JmMes","html_url":"https://github.com/apache/spark/pull/39950","diff_url":"https://github.com/apache/spark/pull/39950.diff","patch_url":"https://github.com/apache/spark/pull/39950.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39950","number":39950,"state":"closed","locked":false,"title":"[SPARK-42388][SQL] Avoid parquet footer reads twice in vectorized reader","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nParquet footer metadata is now always read twice in vectorized parquet reader. \r\nWhen the NameNode is under high pressure, it will cost time to read twice. Actually we can avoid reading the footer twice by reading all row groups in advance and filter row groups according to filters that require push down (no need to read the footer metadata again the second time).\r\n\r\n### Why are the changes needed?\r\nReduce the reading of footer in vectorized parquet reader \r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno\r\n\r\n\r\n### How was this patch tested?\r\nexisting tests","created_at":"2023-02-09T08:48:53Z","updated_at":"2024-08-01T12:09:00Z","closed_at":"2023-04-16T04:10:05Z","merged_at":null,"merge_commit_sha":"00d5b3ec834bbfc8071c45ca1c306cf7a0b4773e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39950/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39950/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39950/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8174731d29dda8b5b87b864b3f5d432b18ec0719","head":{"label":"yabola:skip_footer","ref":"skip_footer","sha":"8174731d29dda8b5b87b864b3f5d432b18ec0719","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"8deb950f09cd4e5224ed2e727245b5386e1dafdc","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39950"},"html":{"href":"https://github.com/apache/spark/pull/39950"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39950"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39950/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39950/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39950/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8174731d29dda8b5b87b864b3f5d432b18ec0719"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39949","id":1234620210,"node_id":"PR_kwDOAQXtWs5Jls8y","html_url":"https://github.com/apache/spark/pull/39949","diff_url":"https://github.com/apache/spark/pull/39949.diff","patch_url":"https://github.com/apache/spark/pull/39949.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39949","number":39949,"state":"closed","locked":false,"title":"[SPARK-42386][SQL] Rewrite HiveGenericUDF with Invoke","user":{"login":"panbingkun","id":15246973,"node_id":"MDQ6VXNlcjE1MjQ2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/15246973?v=4","gravatar_id":"","url":"https://api.github.com/users/panbingkun","html_url":"https://github.com/panbingkun","followers_url":"https://api.github.com/users/panbingkun/followers","following_url":"https://api.github.com/users/panbingkun/following{/other_user}","gists_url":"https://api.github.com/users/panbingkun/gists{/gist_id}","starred_url":"https://api.github.com/users/panbingkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panbingkun/subscriptions","organizations_url":"https://api.github.com/users/panbingkun/orgs","repos_url":"https://api.github.com/users/panbingkun/repos","events_url":"https://api.github.com/users/panbingkun/events{/privacy}","received_events_url":"https://api.github.com/users/panbingkun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThe pr aim to rewrite HiveGenericUDF with Invoke.\r\nFollow by https://github.com/apache/spark/pull/39555\r\n\r\n### Why are the changes needed?\r\nWith the help of `RuntimeReplaceable`, we don't have to manually implement the codegen logic.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n\r\n### How was this patch tested?\r\nAdd new UT.\r\nPass GA.","created_at":"2023-02-09T06:41:16Z","updated_at":"2023-05-14T00:09:53Z","closed_at":"2023-05-14T00:09:53Z","merged_at":null,"merge_commit_sha":"49df8e969d9e89b803c108e747b637ed29241007","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39949/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39949/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39949/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/cf908afaf5cd24ef3edd4dfe604e2eb1a88e4161","head":{"label":"panbingkun:SPARK-42051_INVOKE","ref":"SPARK-42051_INVOKE","sha":"cf908afaf5cd24ef3edd4dfe604e2eb1a88e4161","user":{"login":"panbingkun","id":15246973,"node_id":"MDQ6VXNlcjE1MjQ2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/15246973?v=4","gravatar_id":"","url":"https://api.github.com/users/panbingkun","html_url":"https://github.com/panbingkun","followers_url":"https://api.github.com/users/panbingkun/followers","following_url":"https://api.github.com/users/panbingkun/following{/other_user}","gists_url":"https://api.github.com/users/panbingkun/gists{/gist_id}","starred_url":"https://api.github.com/users/panbingkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panbingkun/subscriptions","organizations_url":"https://api.github.com/users/panbingkun/orgs","repos_url":"https://api.github.com/users/panbingkun/repos","events_url":"https://api.github.com/users/panbingkun/events{/privacy}","received_events_url":"https://api.github.com/users/panbingkun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":481429011,"node_id":"R_kgDOHLIGEw","name":"spark","full_name":"panbingkun/spark","private":false,"owner":{"login":"panbingkun","id":15246973,"node_id":"MDQ6VXNlcjE1MjQ2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/15246973?v=4","gravatar_id":"","url":"https://api.github.com/users/panbingkun","html_url":"https://github.com/panbingkun","followers_url":"https://api.github.com/users/panbingkun/followers","following_url":"https://api.github.com/users/panbingkun/following{/other_user}","gists_url":"https://api.github.com/users/panbingkun/gists{/gist_id}","starred_url":"https://api.github.com/users/panbingkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panbingkun/subscriptions","organizations_url":"https://api.github.com/users/panbingkun/orgs","repos_url":"https://api.github.com/users/panbingkun/repos","events_url":"https://api.github.com/users/panbingkun/events{/privacy}","received_events_url":"https://api.github.com/users/panbingkun/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/panbingkun/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/panbingkun/spark","forks_url":"https://api.github.com/repos/panbingkun/spark/forks","keys_url":"https://api.github.com/repos/panbingkun/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/panbingkun/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/panbingkun/spark/teams","hooks_url":"https://api.github.com/repos/panbingkun/spark/hooks","issue_events_url":"https://api.github.com/repos/panbingkun/spark/issues/events{/number}","events_url":"https://api.github.com/repos/panbingkun/spark/events","assignees_url":"https://api.github.com/repos/panbingkun/spark/assignees{/user}","branches_url":"https://api.github.com/repos/panbingkun/spark/branches{/branch}","tags_url":"https://api.github.com/repos/panbingkun/spark/tags","blobs_url":"https://api.github.com/repos/panbingkun/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/panbingkun/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/panbingkun/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/panbingkun/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/panbingkun/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/panbingkun/spark/languages","stargazers_url":"https://api.github.com/repos/panbingkun/spark/stargazers","contributors_url":"https://api.github.com/repos/panbingkun/spark/contributors","subscribers_url":"https://api.github.com/repos/panbingkun/spark/subscribers","subscription_url":"https://api.github.com/repos/panbingkun/spark/subscription","commits_url":"https://api.github.com/repos/panbingkun/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/panbingkun/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/panbingkun/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/panbingkun/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/panbingkun/spark/contents/{+path}","compare_url":"https://api.github.com/repos/panbingkun/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/panbingkun/spark/merges","archive_url":"https://api.github.com/repos/panbingkun/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/panbingkun/spark/downloads","issues_url":"https://api.github.com/repos/panbingkun/spark/issues{/number}","pulls_url":"https://api.github.com/repos/panbingkun/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/panbingkun/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/panbingkun/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/panbingkun/spark/labels{/name}","releases_url":"https://api.github.com/repos/panbingkun/spark/releases{/id}","deployments_url":"https://api.github.com/repos/panbingkun/spark/deployments","created_at":"2022-04-14T01:38:25Z","updated_at":"2025-02-05T01:36:40Z","pushed_at":"2025-02-05T01:36:19Z","git_url":"git://github.com/panbingkun/spark.git","ssh_url":"git@github.com:panbingkun/spark.git","clone_url":"https://github.com/panbingkun/spark.git","svn_url":"https://github.com/panbingkun/spark","homepage":"https://spark.apache.org/","size":497912,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"89b16f23f8b3fa92d1a4cab504b088cab6f41577","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39949"},"html":{"href":"https://github.com/apache/spark/pull/39949"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39949"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39949/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39949/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39949/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/cf908afaf5cd24ef3edd4dfe604e2eb1a88e4161"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39948","id":1234568172,"node_id":"PR_kwDOAQXtWs5JlgPs","html_url":"https://github.com/apache/spark/pull/39948","diff_url":"https://github.com/apache/spark/pull/39948.diff","patch_url":"https://github.com/apache/spark/pull/39948.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39948","number":39948,"state":"closed","locked":false,"title":"[SPARK-42385][BUILD] Upgrade RoaringBitmap to 0.9.39","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis pr aims upgrade RoaringBitmap 0.9.39\r\n\r\n\r\n### Why are the changes needed?\r\nThis version bring a bug fix:\r\n\r\n- https://github.com/RoaringBitmap/RoaringBitmap/pull/614\r\n\r\nother changes as follows:\r\n\r\nhttps://github.com/RoaringBitmap/RoaringBitmap/compare/0.9.38...0.9.39\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nPass GitHub Actions","created_at":"2023-02-09T05:36:03Z","updated_at":"2023-06-09T07:04:03Z","closed_at":"2023-02-09T08:14:13Z","merged_at":null,"merge_commit_sha":"60eaef4ec8a19b7f69ad626dfdf1cb56f5c87f31","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39948/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39948/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39948/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0d14b01d612e1a719cb09ae14abf20ace5d8d58b","head":{"label":"LuciferYang:SPARK-42385","ref":"SPARK-42385","sha":"0d14b01d612e1a719cb09ae14abf20ace5d8d58b","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"89b16f23f8b3fa92d1a4cab504b088cab6f41577","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39948"},"html":{"href":"https://github.com/apache/spark/pull/39948"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39948"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39948/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39948/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39948/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0d14b01d612e1a719cb09ae14abf20ace5d8d58b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39947","id":1234472121,"node_id":"PR_kwDOAQXtWs5JlIy5","html_url":"https://github.com/apache/spark/pull/39947","diff_url":"https://github.com/apache/spark/pull/39947.diff","patch_url":"https://github.com/apache/spark/pull/39947.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39947","number":39947,"state":"closed","locked":false,"title":"[SPARK-40453][SPARK-41715][CONNECT] Take super class into account when throwing an exception","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to take the super classes into account when throwing an exception from the server to Python side by adding more metadata of classes, causes and traceback in JVM.\r\n\r\nIn addition, this PR matches the exceptions being thrown to the regular PySpark exceptions defined:\r\n\r\nhttps://github.com/apache/spark/blob/04550edd49ee587656d215e59d6a072772d7d5ec/python/pyspark/errors/exceptions/captured.py#L108-L147\r\n\r\n\r\n### Why are the changes needed?\r\n\r\nRight now, many exceptions cannot be handled (e.g., `NoSuchDatabaseException` that inherits `AnalysisException`) in Python side.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo to end users.\r\nYes, it matches the exceptions to the regular PySpark exceptions.\r\n\r\n### How was this patch tested?\r\n\r\nUnittests fixed.","created_at":"2023-02-09T03:20:41Z","updated_at":"2024-01-15T00:48:53Z","closed_at":"2023-02-10T01:50:09Z","merged_at":null,"merge_commit_sha":"6fb7fdc814d5785d1b9f5df8a90551f97ffd0894","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39947/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39947/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39947/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/25ab26bea145329d28a058b6b551e460f4749c2f","head":{"label":"HyukjinKwon:SPARK-41715","ref":"SPARK-41715","sha":"25ab26bea145329d28a058b6b551e460f4749c2f","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"ced675071f780f75435bef5d72b115ffa783e19e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39947"},"html":{"href":"https://github.com/apache/spark/pull/39947"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39947"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39947/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39947/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39947/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/25ab26bea145329d28a058b6b551e460f4749c2f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39946","id":1233948997,"node_id":"PR_kwDOAQXtWs5JjJFF","html_url":"https://github.com/apache/spark/pull/39946","diff_url":"https://github.com/apache/spark/pull/39946.diff","patch_url":"https://github.com/apache/spark/pull/39946.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39946","number":39946,"state":"closed","locked":false,"title":"[SPARK-42310][SQL] Assign name to _LEGACY_ERROR_TEMP_1289","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to assign name to _LEGACY_ERROR_TEMP_1289, \"INVALID_COLUMN_NAME\".\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*`","created_at":"2023-02-08T18:02:30Z","updated_at":"2023-04-22T05:47:37Z","closed_at":"2023-02-12T00:11:14Z","merged_at":null,"merge_commit_sha":"9e209761133f70ef3b10da543937bf78a4221897","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1988040187,"node_id":"MDU6TGFiZWwxOTg4MDQwMTg3","url":"https://api.github.com/repos/apache/spark/labels/AVRO","name":"AVRO","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39946/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39946/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39946/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/dcced51fead6a82b52f37747b2bb4c8f01e41ea4","head":{"label":"itholic:LEGACY_1289","ref":"LEGACY_1289","sha":"dcced51fead6a82b52f37747b2bb4c8f01e41ea4","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4b50a46f1c6ba4ffe2c42f70a512879c28d11dcf","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39946"},"html":{"href":"https://github.com/apache/spark/pull/39946"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39946"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39946/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39946/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39946/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/dcced51fead6a82b52f37747b2bb4c8f01e41ea4"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39945","id":1233890329,"node_id":"PR_kwDOAQXtWs5Ji6wZ","html_url":"https://github.com/apache/spark/pull/39945","diff_url":"https://github.com/apache/spark/pull/39945.diff","patch_url":"https://github.com/apache/spark/pull/39945.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39945","number":39945,"state":"closed","locked":false,"title":"[SPARK-42384][SQL] Check for null input in generated code for mask function","user":{"login":"bersprockets","id":21131848,"node_id":"MDQ6VXNlcjIxMTMxODQ4","avatar_url":"https://avatars.githubusercontent.com/u/21131848?v=4","gravatar_id":"","url":"https://api.github.com/users/bersprockets","html_url":"https://github.com/bersprockets","followers_url":"https://api.github.com/users/bersprockets/followers","following_url":"https://api.github.com/users/bersprockets/following{/other_user}","gists_url":"https://api.github.com/users/bersprockets/gists{/gist_id}","starred_url":"https://api.github.com/users/bersprockets/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bersprockets/subscriptions","organizations_url":"https://api.github.com/users/bersprockets/orgs","repos_url":"https://api.github.com/users/bersprockets/repos","events_url":"https://api.github.com/users/bersprockets/events{/privacy}","received_events_url":"https://api.github.com/users/bersprockets/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nWhen generating code for the mask function, call `ctx.nullSafeExec` to produce null safe code.\r\n\r\nThis change assumes that the mask function returns null only when the input is null (which appears to be the case, from reading the code of `Mask.transformInput`).\r\n\r\n\r\n### Why are the changes needed?\r\n\r\nThe following query fails with a `NullPointerException`:\r\n```\r\ncreate or replace temp view v1 as\r\nselect * from values\r\n(null),\r\n('AbCD123-@$#')\r\nas data(col1);\r\n\r\ncache table v1;\r\n\r\nselect mask(col1) from v1;\r\n\r\n23/02/07 16:36:06 ERROR Executor: Exception in task 0.0 in stage 3.0 (TID 3)\r\njava.lang.NullPointerException\r\n\tat org.apache.spark.sql.catalyst.expressions.codegen.UnsafeWriter.write(UnsafeWriter.java:110)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\r\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\r\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:760)\r\n```\r\nThe generated code calls `UnsafeWriter.write(0, value_0)` regardless of whether `Mask.transformInput` returns null or not. The `UnsafeWriter.write` method for `UTF8String` does not expect a null pointer.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nNew unit tests.\r\n","created_at":"2023-02-08T17:11:39Z","updated_at":"2023-03-28T16:37:35Z","closed_at":"2023-02-16T00:26:31Z","merged_at":null,"merge_commit_sha":"3990f43ae35c3afadc9c75619185b9f5771e376d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39945/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39945/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39945/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ef49f02f425c9cbcd223fe86c1bad2655e55e42b","head":{"label":"bersprockets:mask_npe_issue","ref":"mask_npe_issue","sha":"ef49f02f425c9cbcd223fe86c1bad2655e55e42b","user":{"login":"bersprockets","id":21131848,"node_id":"MDQ6VXNlcjIxMTMxODQ4","avatar_url":"https://avatars.githubusercontent.com/u/21131848?v=4","gravatar_id":"","url":"https://api.github.com/users/bersprockets","html_url":"https://github.com/bersprockets","followers_url":"https://api.github.com/users/bersprockets/followers","following_url":"https://api.github.com/users/bersprockets/following{/other_user}","gists_url":"https://api.github.com/users/bersprockets/gists{/gist_id}","starred_url":"https://api.github.com/users/bersprockets/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bersprockets/subscriptions","organizations_url":"https://api.github.com/users/bersprockets/orgs","repos_url":"https://api.github.com/users/bersprockets/repos","events_url":"https://api.github.com/users/bersprockets/events{/privacy}","received_events_url":"https://api.github.com/users/bersprockets/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":115567071,"node_id":"MDEwOlJlcG9zaXRvcnkxMTU1NjcwNzE=","name":"spark","full_name":"bersprockets/spark","private":false,"owner":{"login":"bersprockets","id":21131848,"node_id":"MDQ6VXNlcjIxMTMxODQ4","avatar_url":"https://avatars.githubusercontent.com/u/21131848?v=4","gravatar_id":"","url":"https://api.github.com/users/bersprockets","html_url":"https://github.com/bersprockets","followers_url":"https://api.github.com/users/bersprockets/followers","following_url":"https://api.github.com/users/bersprockets/following{/other_user}","gists_url":"https://api.github.com/users/bersprockets/gists{/gist_id}","starred_url":"https://api.github.com/users/bersprockets/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bersprockets/subscriptions","organizations_url":"https://api.github.com/users/bersprockets/orgs","repos_url":"https://api.github.com/users/bersprockets/repos","events_url":"https://api.github.com/users/bersprockets/events{/privacy}","received_events_url":"https://api.github.com/users/bersprockets/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bersprockets/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/bersprockets/spark","forks_url":"https://api.github.com/repos/bersprockets/spark/forks","keys_url":"https://api.github.com/repos/bersprockets/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bersprockets/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bersprockets/spark/teams","hooks_url":"https://api.github.com/repos/bersprockets/spark/hooks","issue_events_url":"https://api.github.com/repos/bersprockets/spark/issues/events{/number}","events_url":"https://api.github.com/repos/bersprockets/spark/events","assignees_url":"https://api.github.com/repos/bersprockets/spark/assignees{/user}","branches_url":"https://api.github.com/repos/bersprockets/spark/branches{/branch}","tags_url":"https://api.github.com/repos/bersprockets/spark/tags","blobs_url":"https://api.github.com/repos/bersprockets/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bersprockets/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bersprockets/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/bersprockets/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bersprockets/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/bersprockets/spark/languages","stargazers_url":"https://api.github.com/repos/bersprockets/spark/stargazers","contributors_url":"https://api.github.com/repos/bersprockets/spark/contributors","subscribers_url":"https://api.github.com/repos/bersprockets/spark/subscribers","subscription_url":"https://api.github.com/repos/bersprockets/spark/subscription","commits_url":"https://api.github.com/repos/bersprockets/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/bersprockets/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/bersprockets/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/bersprockets/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/bersprockets/spark/contents/{+path}","compare_url":"https://api.github.com/repos/bersprockets/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bersprockets/spark/merges","archive_url":"https://api.github.com/repos/bersprockets/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bersprockets/spark/downloads","issues_url":"https://api.github.com/repos/bersprockets/spark/issues{/number}","pulls_url":"https://api.github.com/repos/bersprockets/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/bersprockets/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/bersprockets/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bersprockets/spark/labels{/name}","releases_url":"https://api.github.com/repos/bersprockets/spark/releases{/id}","deployments_url":"https://api.github.com/repos/bersprockets/spark/deployments","created_at":"2017-12-28T00:03:24Z","updated_at":"2025-01-24T22:51:50Z","pushed_at":"2025-01-24T22:51:35Z","git_url":"git://github.com/bersprockets/spark.git","ssh_url":"git@github.com:bersprockets/spark.git","clone_url":"https://github.com/bersprockets/spark.git","svn_url":"https://github.com/bersprockets/spark","homepage":null,"size":475116,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"abff1ae8877360905e80333752b67dfa4abdb62f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39945"},"html":{"href":"https://github.com/apache/spark/pull/39945"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39945"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39945/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39945/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39945/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ef49f02f425c9cbcd223fe86c1bad2655e55e42b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39944","id":1233712288,"node_id":"PR_kwDOAQXtWs5JiPSg","html_url":"https://github.com/apache/spark/pull/39944","diff_url":"https://github.com/apache/spark/pull/39944.diff","patch_url":"https://github.com/apache/spark/pull/39944.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39944","number":39944,"state":"closed","locked":false,"title":"[SPARK-42383][CORE] Protobuf serializer for `RocksDB.TypeAliases`","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nAdd Protobuf serializer for `RocksDB.TypeAliases`\r\n\r\n### Why are the changes needed?\r\nSupport fast and compact serialization/deserialization for `RocksDB.TypeAliases` over RocksDB.\r\n\r\n### Does this PR introduce any user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\n\r\n- New UT\r\n- Local test:\r\n```\r\nexport LIVE_UI_LOCAL_STORE_DIR=/tmp/spark-ui   \r\nbuild/mvn clean install -pl core -Dtest.exclude.tags=org.apache.spark.tags.ExtendedLevelDBTest\r\n```\r\n\r\n```\r\nRun completed in 19 minutes, 42 seconds.\r\nTotal number of tests run: 3127\r\nSuites: completed 294, aborted 0\r\nTests: succeeded 3127, failed 0, canceled 7, ignored 9, pending 0\r\nAll tests passed.\r\n```","created_at":"2023-02-08T15:13:58Z","updated_at":"2023-06-09T07:04:05Z","closed_at":"2023-02-10T02:28:26Z","merged_at":null,"merge_commit_sha":"c6f1f7af9b14e8f079730698e5463fdb66c21819","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39944/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39944/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39944/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/675a2c5351dceb1225c28282fc485e3466bc2c45","head":{"label":"LuciferYang:SPARK-42383","ref":"SPARK-42383","sha":"675a2c5351dceb1225c28282fc485e3466bc2c45","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f8e06c1e1bb335180ce01ba5c8a079687ebcecf1","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39944"},"html":{"href":"https://github.com/apache/spark/pull/39944"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39944"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39944/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39944/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39944/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/675a2c5351dceb1225c28282fc485e3466bc2c45"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39943","id":1233665789,"node_id":"PR_kwDOAQXtWs5JiD79","html_url":"https://github.com/apache/spark/pull/39943","diff_url":"https://github.com/apache/spark/pull/39943.diff","patch_url":"https://github.com/apache/spark/pull/39943.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39943","number":39943,"state":"closed","locked":false,"title":"[SPARK-40819][SQL][FOLLOWUP] Update SqlConf version for nanosAsLong configuration","user":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"As requested by @HyukjinKwon in https://github.com/apache/spark/pull/38312  NB: This change needs to be backported\r\n<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nUpdate version set for \"spark.sql.legacy.parquet.nanosAsLong\"  configuration in SqlConf. This update is required because the previous PR set version to `3.2.3` which has already been released. Updating to version `3.2.4` will correctly reflect when this configuration element was added\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCorrectness and to complete SPARK-40819\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo, this is merely so this configuration element has the correct version\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nN/A\r\n","created_at":"2023-02-08T14:44:02Z","updated_at":"2023-02-09T00:02:50Z","closed_at":"2023-02-09T00:02:23Z","merged_at":null,"merge_commit_sha":"6601ed4b33e6db69649b312c22ff6b8a4a7f4d99","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39943/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39943/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39943/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/fbda7d00747759c48ae4ff02e590f107159eaeb7","head":{"label":"awdavidson:SPARK-40819_sql-conf","ref":"SPARK-40819_sql-conf","sha":"fbda7d00747759c48ae4ff02e590f107159eaeb7","user":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":472961423,"node_id":"R_kgDOHDDRjw","name":"spark","full_name":"awdavidson/spark","private":false,"owner":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/awdavidson/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/awdavidson/spark","forks_url":"https://api.github.com/repos/awdavidson/spark/forks","keys_url":"https://api.github.com/repos/awdavidson/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/awdavidson/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/awdavidson/spark/teams","hooks_url":"https://api.github.com/repos/awdavidson/spark/hooks","issue_events_url":"https://api.github.com/repos/awdavidson/spark/issues/events{/number}","events_url":"https://api.github.com/repos/awdavidson/spark/events","assignees_url":"https://api.github.com/repos/awdavidson/spark/assignees{/user}","branches_url":"https://api.github.com/repos/awdavidson/spark/branches{/branch}","tags_url":"https://api.github.com/repos/awdavidson/spark/tags","blobs_url":"https://api.github.com/repos/awdavidson/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/awdavidson/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/awdavidson/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/awdavidson/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/awdavidson/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/awdavidson/spark/languages","stargazers_url":"https://api.github.com/repos/awdavidson/spark/stargazers","contributors_url":"https://api.github.com/repos/awdavidson/spark/contributors","subscribers_url":"https://api.github.com/repos/awdavidson/spark/subscribers","subscription_url":"https://api.github.com/repos/awdavidson/spark/subscription","commits_url":"https://api.github.com/repos/awdavidson/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/awdavidson/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/awdavidson/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/awdavidson/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/awdavidson/spark/contents/{+path}","compare_url":"https://api.github.com/repos/awdavidson/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/awdavidson/spark/merges","archive_url":"https://api.github.com/repos/awdavidson/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/awdavidson/spark/downloads","issues_url":"https://api.github.com/repos/awdavidson/spark/issues{/number}","pulls_url":"https://api.github.com/repos/awdavidson/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/awdavidson/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/awdavidson/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/awdavidson/spark/labels{/name}","releases_url":"https://api.github.com/repos/awdavidson/spark/releases{/id}","deployments_url":"https://api.github.com/repos/awdavidson/spark/deployments","created_at":"2022-03-22T22:45:53Z","updated_at":"2022-04-13T14:28:23Z","pushed_at":"2023-02-08T14:38:56Z","git_url":"git://github.com/awdavidson/spark.git","ssh_url":"git@github.com:awdavidson/spark.git","clone_url":"https://github.com/awdavidson/spark.git","svn_url":"https://github.com/awdavidson/spark","homepage":"https://spark.apache.org/","size":458761,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f8e06c1e1bb335180ce01ba5c8a079687ebcecf1","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39943"},"html":{"href":"https://github.com/apache/spark/pull/39943"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39943"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39943/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39943/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39943/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/fbda7d00747759c48ae4ff02e590f107159eaeb7"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39942","id":1233433266,"node_id":"PR_kwDOAQXtWs5JhLKy","html_url":"https://github.com/apache/spark/pull/39942","diff_url":"https://github.com/apache/spark/pull/39942.diff","patch_url":"https://github.com/apache/spark/pull/39942.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39942","number":39942,"state":"closed","locked":false,"title":"[SPARK-42398][SQL] Refine default column value framework","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThe current column default value framework has a few problems:\r\n1. The DDL commands can only hold `StructType`. We must store the default value as the SQL text in `StructField` metadata, then parse and resolve it with a hacky analyzer later.\r\n2. The default column validation logic is a bit messy. The consumer side (DML commands) requires the default value to be foldable but the producer side (DDL commands) does not.\r\n3. The DS V2 API is a bit inconsistent. The `createTable` API only takes `StructType`, so implementations must know the special metadata key of the default value to access it. The `TableChange` API has the default value as an individual field.\r\n\r\nThis PR refines the default value framework to solve these problems:\r\n1. The DDL commands now hold `Column`, which keeps the default value as a catalyst `Expression`. Then it can be resolved with the DDL commands by the main analyzer.\r\n2. Due to the above, now we can centralize the validation logic in `CheckAnalysis`.\r\n3. The DS v2 `createTable` API now takes `Column` (different from the catalyst `Column`), which holds the default value as a v2 `Literal` as well as the original SQL. This avoids the need of special metadata key and is also more extensible when adding more special cols like generated cols. This is also type-safe and makes sure the default value is literal. The implementation is free to decide how to encode and store default values. Note: backward compatibility is taken care.\r\n\r\nFor custom v2 catalogs, the workflow is:\r\n1. parser creates DDL commands, with default value as a catalyst expression.\r\n2. analyzer resolves DDL commands and the default value expression.\r\n3. `CheckAnalysis` validates default value expression and makes sure it's literal\r\n4. optimizer optimizes default value to constant\r\n5. Spark turns the default value constant to v2 literal and calls DS v2 APIs.\r\n6. v2 catalogs should properly implement default value in their writers.\r\n\r\nFor v1 catalog (the Hive catalog), the workflow is:\r\n1. parser creates DDL commands, with default value as a catalyst expression.\r\n2. analyzer resolves DDL commands and the default value expression.\r\n \r\nAfter step 2, we have 2 branches:\r\n1.`ResolveSessionCatalog` turns some DDL commands to v1 version. It invokes `CheckAnalysis` to do validation, invokes `ContantFolding` to create constants, and put default value constant as a SQL text in `StructField` metadata.\r\n\r\nAnother branch is still running as v2 commands:\r\n1. `CheckAnalysis` validates default value expression and makes sure it's literal\r\n2. optimizer optimizes default value to constant\r\n5. Spark turns the default value constant to v2 literal and calls DS v2 APIs.\r\n6. `V2SessionCatalog`, the v2 API adaptor of v1 catalog, turns v2 literal to SQL text and put it in `StructField` metadata.\r\n\r\nTODO (in followup PRs): the consumer side (DML commands) should only parse the default value text and use the main analyzer to resolve it. Then we can remove the hacky analyzer completely.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  8. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nRefine the framework before releasing it\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nno\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nexisting tests","created_at":"2023-02-08T11:56:18Z","updated_at":"2023-05-30T00:20:42Z","closed_at":"2023-05-30T00:20:42Z","merged_at":null,"merge_commit_sha":"beae0ca4c23e2602389b1137cf9b2a5af1ea6721","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39942/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39942/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39942/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/514b59c665de038a7340c9927cb2655289725214","head":{"label":"cloud-fan:table","ref":"table","sha":"514b59c665de038a7340c9927cb2655289725214","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a65dfa9577b39198fe37ada3ede9f6afcb0f2361","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39942"},"html":{"href":"https://github.com/apache/spark/pull/39942"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39942"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39942/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39942/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39942/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/514b59c665de038a7340c9927cb2655289725214"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39941","id":1233255108,"node_id":"PR_kwDOAQXtWs5JgfrE","html_url":"https://github.com/apache/spark/pull/39941","diff_url":"https://github.com/apache/spark/pull/39941.diff","patch_url":"https://github.com/apache/spark/pull/39941.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39941","number":39941,"state":"closed","locked":false,"title":"[MINOR][DOCS] Add link to Hadoop docs","user":{"login":"martin-kokos","id":4807476,"node_id":"MDQ6VXNlcjQ4MDc0NzY=","avatar_url":"https://avatars.githubusercontent.com/u/4807476?v=4","gravatar_id":"","url":"https://api.github.com/users/martin-kokos","html_url":"https://github.com/martin-kokos","followers_url":"https://api.github.com/users/martin-kokos/followers","following_url":"https://api.github.com/users/martin-kokos/following{/other_user}","gists_url":"https://api.github.com/users/martin-kokos/gists{/gist_id}","starred_url":"https://api.github.com/users/martin-kokos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martin-kokos/subscriptions","organizations_url":"https://api.github.com/users/martin-kokos/orgs","repos_url":"https://api.github.com/users/martin-kokos/repos","events_url":"https://api.github.com/users/martin-kokos/events{/privacy}","received_events_url":"https://api.github.com/users/martin-kokos/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nAdd link to Writable in Hadoop docs.\r\n\r\n### Why are the changes needed?\r\nThe python card of of the blue talks about Writables with no explanation what it is and the meaning of the whole paragraph is lost. While the Scala card links to Hadoop docs, the python card did not.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nHelp docs readability.\r\n\r\n### How was this patch tested?\r\nLink is tested accessible.","created_at":"2023-02-08T09:33:26Z","updated_at":"2023-03-30T12:38:48Z","closed_at":"2023-03-30T12:38:47Z","merged_at":null,"merge_commit_sha":"076754856919bc19662d60f5450fc20dc45adb56","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39941/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39941/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39941/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1d8a9331a1050ae35a121261df7f7e01b0a8099a","head":{"label":"martin-kokos:patch-1","ref":"patch-1","sha":"1d8a9331a1050ae35a121261df7f7e01b0a8099a","user":{"login":"martin-kokos","id":4807476,"node_id":"MDQ6VXNlcjQ4MDc0NzY=","avatar_url":"https://avatars.githubusercontent.com/u/4807476?v=4","gravatar_id":"","url":"https://api.github.com/users/martin-kokos","html_url":"https://github.com/martin-kokos","followers_url":"https://api.github.com/users/martin-kokos/followers","following_url":"https://api.github.com/users/martin-kokos/following{/other_user}","gists_url":"https://api.github.com/users/martin-kokos/gists{/gist_id}","starred_url":"https://api.github.com/users/martin-kokos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martin-kokos/subscriptions","organizations_url":"https://api.github.com/users/martin-kokos/orgs","repos_url":"https://api.github.com/users/martin-kokos/repos","events_url":"https://api.github.com/users/martin-kokos/events{/privacy}","received_events_url":"https://api.github.com/users/martin-kokos/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"b11fba0b8402905c0d682f90939e64882f0fd7f5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39941"},"html":{"href":"https://github.com/apache/spark/pull/39941"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39941"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39941/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39941/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39941/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1d8a9331a1050ae35a121261df7f7e01b0a8099a"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39940","id":1233185626,"node_id":"PR_kwDOAQXtWs5JgOta","html_url":"https://github.com/apache/spark/pull/39940","diff_url":"https://github.com/apache/spark/pull/39940.diff","patch_url":"https://github.com/apache/spark/pull/39940.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39940","number":39940,"state":"closed","locked":false,"title":"[SPARK-42267][CONNECT][PYTHON][TESTS][FOLLOWUP] Enable `test_udf_in_filter_on_top_of_outer_join `","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nEnable `test_udf_in_filter_on_top_of_outer_join `\r\n\r\n\r\n### Why are the changes needed?\r\nfor test coverage\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno, test-only\r\n\r\n\r\n### How was this patch tested?\r\nenabled test","created_at":"2023-02-08T08:37:21Z","updated_at":"2023-02-08T11:19:41Z","closed_at":"2023-02-08T11:18:43Z","merged_at":null,"merge_commit_sha":"f116fa59f6d8acd331d41f6426e4f89f9278dff2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39940/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39940/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39940/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/4af3474399441f9606d771aad88c36e5b8a13030","head":{"label":"zhengruifeng:connect_enable_42267","ref":"connect_enable_42267","sha":"4af3474399441f9606d771aad88c36e5b8a13030","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f24ce658a71fdb57440f0caff1d3369ade4f688a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39940"},"html":{"href":"https://github.com/apache/spark/pull/39940"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39940"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39940/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39940/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39940/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/4af3474399441f9606d771aad88c36e5b8a13030"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39939","id":1233171627,"node_id":"PR_kwDOAQXtWs5JgLSr","html_url":"https://github.com/apache/spark/pull/39939","diff_url":"https://github.com/apache/spark/pull/39939.diff","patch_url":"https://github.com/apache/spark/pull/39939.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39939","number":39939,"state":"closed","locked":false,"title":"[SPARK-42381][CONNECT][PYTHON] `CreateDataFrame` should accept objects","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n`CreateDataFrame` should accept objects\r\n\r\n\r\n### Why are the changes needed?\r\nfor parity\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nyes\r\n\r\n\r\n### How was this patch tested?\r\nenabled UT and added UT","created_at":"2023-02-08T08:24:01Z","updated_at":"2023-02-08T11:16:46Z","closed_at":"2023-02-08T11:16:00Z","merged_at":null,"merge_commit_sha":"f37b5f9334c67cf832192dad7200c0784352168c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39939/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39939/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39939/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/054b57343c42892ff96ba6f18e0ab75a8981b542","head":{"label":"zhengruifeng:connect_createDF_objects","ref":"connect_createDF_objects","sha":"054b57343c42892ff96ba6f18e0ab75a8981b542","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"dbc4c621679318e0652a00aec54927b5659d65cd","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39939"},"html":{"href":"https://github.com/apache/spark/pull/39939"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39939"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39939/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39939/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39939/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/054b57343c42892ff96ba6f18e0ab75a8981b542"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39938","id":1233094035,"node_id":"PR_kwDOAQXtWs5Jf4WT","html_url":"https://github.com/apache/spark/pull/39938","diff_url":"https://github.com/apache/spark/pull/39938.diff","patch_url":"https://github.com/apache/spark/pull/39938.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39938","number":39938,"state":"closed","locked":false,"title":"[SPARK-42267][CONNECT][PYTHON] `DataFrame.join` should standardize the JoinType string","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n standardize the JoinType string\r\n\r\nbe consistent with PySpark https://github.com/apache/spark/blob/05c0fa573881b49d8ead9a5e16071190e5841e1b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/plans/joinTypes.scala#L25\r\n\r\n### Why are the changes needed?\r\n```\r\n>>> df = spark.range(1)\r\n>>> df2 = spark.range(2)\r\n>>> df.join(df2, how=\"left_outer\")\r\nTraceback (most recent call last):\r\nFile \"<stdin>\", line 1, in <module>\r\nFile \"/Users/xinrong.meng/spark/python/pyspark/sql/connect/dataframe.py\", line 438, in join\r\nplan.Join(left=self._plan, right=other._plan, on=on, how=how),\r\nFile \"/Users/xinrong.meng/spark/python/pyspark/sql/connect/plan.py\", line 730, in _init_\r\nraise NotImplementedError(\r\nNotImplementedError:\r\nUnsupported join type: left_outer. Supported join types include:\r\n\"inner\", \"outer\", \"full\", \"fullouter\", \"full_outer\",\r\n\"leftouter\", \"left\", \"left_outer\", \"rightouter\",\r\n\"right\", \"right_outer\", \"leftsemi\", \"left_semi\",\r\n\"semi\", \"leftanti\", \"left_anti\", \"anti\", \"cross\",\r\n```\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nyes\r\n\r\n\r\n### How was this patch tested?\r\nupdated UT","created_at":"2023-02-08T07:06:01Z","updated_at":"2023-02-08T08:30:25Z","closed_at":"2023-02-08T08:29:17Z","merged_at":null,"merge_commit_sha":"dbcee18ed105eda5fe034bdc0f1f3ba1babfb5cf","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39938/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39938/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39938/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/32ad77ab7923f839272885fe8960bad7d4617229","head":{"label":"zhengruifeng:connect_join_types","ref":"connect_join_types","sha":"32ad77ab7923f839272885fe8960bad7d4617229","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"dbc4c621679318e0652a00aec54927b5659d65cd","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39938"},"html":{"href":"https://github.com/apache/spark/pull/39938"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39938"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39938/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39938/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39938/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/32ad77ab7923f839272885fe8960bad7d4617229"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39937","id":1233078970,"node_id":"PR_kwDOAQXtWs5Jf0q6","html_url":"https://github.com/apache/spark/pull/39937","diff_url":"https://github.com/apache/spark/pull/39937.diff","patch_url":"https://github.com/apache/spark/pull/39937.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39937","number":39937,"state":"closed","locked":false,"title":"[SPARK-42309][SQL] Introduce `INCOMPATIBLE_DATA_TO_TABLE` and sub classes.","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to assign name to _LEGACY_ERROR_TEMP_1204, \"INCOMPATIBLE_DATA_TO_TABLE\" and its sub classes:\r\n- CANNOT_FIND_DATA\r\n- AMBIGUOUS_COLUMN_NAME\r\n- EXTRA_STRUCT_FIELDS\r\n- NULLABLE_COLUMN\r\n- NULLABLE_ARRAY_ELEMENTS\r\n- NULLABLE_MAP_VALUES\r\n- CANNOT_SAFELY_CAST\r\n- STRUCT_MISSING_FIELDS\r\n- UNEXPECTED_COLUMN_NAME\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*`","created_at":"2023-02-08T06:53:22Z","updated_at":"2023-11-20T01:35:50Z","closed_at":"2023-07-13T14:21:47Z","merged_at":null,"merge_commit_sha":"7dba27082514262228bba3e0f2aaeed786487793","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39937/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39937/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39937/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/19e2bf3036d90ef1c5d414c43adb61154d57c764","head":{"label":"itholic:LEGACY_1204","ref":"LEGACY_1204","sha":"19e2bf3036d90ef1c5d414c43adb61154d57c764","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"8fd6d4d69d56229660c35f070d3544102b66786a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39937"},"html":{"href":"https://github.com/apache/spark/pull/39937"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39937"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39937/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39937/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39937/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/19e2bf3036d90ef1c5d414c43adb61154d57c764"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39936","id":1232902994,"node_id":"PR_kwDOAQXtWs5JfJtS","html_url":"https://github.com/apache/spark/pull/39936","diff_url":"https://github.com/apache/spark/pull/39936.diff","patch_url":"https://github.com/apache/spark/pull/39936.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39936","number":39936,"state":"closed","locked":false,"title":"[SPARK-42379][SS] Use FileSystem.exists in FileSystemBasedCheckpointFileManager.exists","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to use FileSystem.exists in FileSystemBasedCheckpointFileManager.exists, which is consistent with other methods in FileSystemBasedCheckpointFileManager.\r\n\r\nThis PR also removes the test case QueryExecutionErrorsSuite.FAILED_RENAME_PATH: rename when destination path already exists because the test relies on incorrect custom file system instance with non-symmetric implementation between `FileSystemBasedCheckpointFileManager.exists` vs `FileSystem.exists`.\r\n(See detailed explanation from https://github.com/apache/spark/pull/39936#issuecomment-1422101967)\r\n\r\n### Why are the changes needed?\r\n\r\nOther methods in FileSystemBasedCheckpointFileManager already uses FileSystem.exists for all cases checking existence of the path.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests.","created_at":"2023-02-08T03:04:48Z","updated_at":"2023-02-08T22:12:31Z","closed_at":"2023-02-08T22:12:31Z","merged_at":null,"merge_commit_sha":"1ee1d6ec12ee0a564b1c57dbfb762b2173539966","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39936/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39936/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39936/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/39332087a635a5ea291f479315e907b65301b7fa","head":{"label":"HeartSaVioR:MINOR-FileSystemBasedCheckpointFileManager-calls-fs-exists-in-exists","ref":"MINOR-FileSystemBasedCheckpointFileManager-calls-fs-exists-in-exists","sha":"39332087a635a5ea291f479315e907b65301b7fa","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":27994296,"node_id":"MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==","name":"spark","full_name":"HeartSaVioR/spark","private":false,"owner":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HeartSaVioR/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HeartSaVioR/spark","forks_url":"https://api.github.com/repos/HeartSaVioR/spark/forks","keys_url":"https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HeartSaVioR/spark/teams","hooks_url":"https://api.github.com/repos/HeartSaVioR/spark/hooks","issue_events_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HeartSaVioR/spark/events","assignees_url":"https://api.github.com/repos/HeartSaVioR/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HeartSaVioR/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HeartSaVioR/spark/tags","blobs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HeartSaVioR/spark/languages","stargazers_url":"https://api.github.com/repos/HeartSaVioR/spark/stargazers","contributors_url":"https://api.github.com/repos/HeartSaVioR/spark/contributors","subscribers_url":"https://api.github.com/repos/HeartSaVioR/spark/subscribers","subscription_url":"https://api.github.com/repos/HeartSaVioR/spark/subscription","commits_url":"https://api.github.com/repos/HeartSaVioR/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HeartSaVioR/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HeartSaVioR/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HeartSaVioR/spark/merges","archive_url":"https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HeartSaVioR/spark/downloads","issues_url":"https://api.github.com/repos/HeartSaVioR/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HeartSaVioR/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HeartSaVioR/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HeartSaVioR/spark/labels{/name}","releases_url":"https://api.github.com/repos/HeartSaVioR/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HeartSaVioR/spark/deployments","created_at":"2014-12-14T12:56:04Z","updated_at":"2024-10-21T04:36:36Z","pushed_at":"2025-01-08T06:13:27Z","git_url":"git://github.com/HeartSaVioR/spark.git","ssh_url":"git@github.com:HeartSaVioR/spark.git","clone_url":"https://github.com/HeartSaVioR/spark.git","svn_url":"https://github.com/HeartSaVioR/spark","homepage":null,"size":456164,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":1,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"11260310f65e1a30f6b00b380350e414609c5fd4","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39936"},"html":{"href":"https://github.com/apache/spark/pull/39936"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39936"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39936/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39936/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39936/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/39332087a635a5ea291f479315e907b65301b7fa"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39935","id":1232890454,"node_id":"PR_kwDOAQXtWs5JfGpW","html_url":"https://github.com/apache/spark/pull/39935","diff_url":"https://github.com/apache/spark/pull/39935.diff","patch_url":"https://github.com/apache/spark/pull/39935.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39935","number":39935,"state":"closed","locked":false,"title":"[SPARK-42244][PYTHON][FOLLOWUP] Fix error messages to keep the consistency","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR follow-ups for https://github.com/apache/spark/pull/39815 to fix error messages that's not meet the consistency with other error messages.\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nTo keep the consistency across all error messages.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo, error message changes.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\nThe existing CI should pass.","created_at":"2023-02-08T02:45:34Z","updated_at":"2023-04-22T05:47:41Z","closed_at":"2023-02-08T11:49:45Z","merged_at":null,"merge_commit_sha":"dc25da900a89b3c10cdf1f691334374176fe8424","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39935/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39935/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39935/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/eec2f94ace25861a5fb85dd59272b79f4575fa8b","head":{"label":"itholic:SPARK-42244-followup","ref":"SPARK-42244-followup","sha":"eec2f94ace25861a5fb85dd59272b79f4575fa8b","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"11260310f65e1a30f6b00b380350e414609c5fd4","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39935"},"html":{"href":"https://github.com/apache/spark/pull/39935"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39935"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39935/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39935/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39935/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/eec2f94ace25861a5fb85dd59272b79f4575fa8b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39934","id":1232831030,"node_id":"PR_kwDOAQXtWs5Je4I2","html_url":"https://github.com/apache/spark/pull/39934","diff_url":"https://github.com/apache/spark/pull/39934.diff","patch_url":"https://github.com/apache/spark/pull/39934.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39934","number":39934,"state":"closed","locked":false,"title":"[SPARK-42378][CONNECT][PYTHON] Make `DataFrame.select` support `a.*`","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nMake `DataFrame.select` support `a.*`\r\n\r\n\r\n### Why are the changes needed?\r\nbugfix:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/Users/ruifeng.zheng/Dev/spark/python/pyspark/sql/tests/connect/test_connect_basic.py\", line 1377, in test_select_star\r\n    cdf.select(\"a\", \"b.*\").collect(),\r\n  File \"/Users/ruifeng.zheng/Dev/spark/python/pyspark/sql/connect/dataframe.py\", line 1305, in collect\r\n    table = self._session.client.to_table(query)\r\n  File \"/Users/ruifeng.zheng/Dev/spark/python/pyspark/sql/connect/client.py\", line 445, in to_table\r\n    table, _ = self._execute_and_fetch(req)\r\n  File \"/Users/ruifeng.zheng/Dev/spark/python/pyspark/sql/connect/client.py\", line 639, in _execute_and_fetch\r\n    self._handle_error(rpc_error)\r\n  File \"/Users/ruifeng.zheng/Dev/spark/python/pyspark/sql/connect/client.py\", line 675, in _handle_error\r\n    raise SparkConnectAnalysisException(\r\npyspark.errors.exceptions.SparkConnectAnalysisException: [FIELD_NOT_FOUND] No such struct field `*` in `c`, `d`.\r\n```\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nyes\r\n\r\n\r\n### How was this patch tested?\r\nadded ut\r\n","created_at":"2023-02-08T01:20:27Z","updated_at":"2023-02-08T06:44:16Z","closed_at":"2023-02-08T06:43:17Z","merged_at":null,"merge_commit_sha":"560a1212a97bf395ff357458539ebe0f87586e6e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39934/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39934/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39934/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/91526cb40b9b51b94810938295218e8e1a80c941","head":{"label":"zhengruifeng:connect_select_star","ref":"connect_select_star","sha":"91526cb40b9b51b94810938295218e8e1a80c941","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"53c1c682acd619c6b3a4beeea53766dda08c7350","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39934"},"html":{"href":"https://github.com/apache/spark/pull/39934"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39934"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39934/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39934/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39934/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/91526cb40b9b51b94810938295218e8e1a80c941"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39933","id":1232740723,"node_id":"PR_kwDOAQXtWs5JeiFz","html_url":"https://github.com/apache/spark/pull/39933","diff_url":"https://github.com/apache/spark/pull/39933.diff","patch_url":"https://github.com/apache/spark/pull/39933.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39933","number":39933,"state":"closed","locked":false,"title":"[SPARK-42377][CONNECT][TESTS] Test framework for Spark Connect Scala Client","user":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR adds a test framework for the Spark Connect Scala Client.\r\n\r\nThis framework consists of two tests:\r\n\r\n- `PlanGenerationTestSuite`: This is the client side testing. Tests in this suite generate queries (relations), and compare the generated query plan to a golden file. In order to facilitate debugging and review the json of the proto file is also generated when the golden file is generated. The goal of this test is to validate whether the generated plan matches expectations, and to catch changes in the generated queries. **This is the only test suite where tests need to be added.**\r\n- `ProtoToParsedPlanTestSuite`: This is server side testing. This test uses the protos generated by the `PlanGenerationTestSuite` and tries to convert them to a catalyst parsed plan (unresolved `LogicaPlan`). The string representation of the generated parsed plan is compared to a golden file.\r\n\r\nWhen adding tests using this framework, both the `PlanGenerationTestSuite` and `ProtoToParsedPlanTestSuite` need to be run, and in this order.\r\n\r\n### Why are the changes needed?\r\nThis makes it easier to test new features for the scala client.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nIt is a test framework. I have added tests for most existing features.\r\n","created_at":"2023-02-07T23:33:02Z","updated_at":"2023-02-12T23:37:58Z","closed_at":"2023-02-12T04:25:49Z","merged_at":null,"merge_commit_sha":"3b169fe53ba9eb2bb583244d87dfa6a20f81d73c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39933/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39933/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39933/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b628c663245c9ce5044c143ade826a0b4dc9cba7","head":{"label":"hvanhovell:SPARK-42377","ref":"SPARK-42377","sha":"b628c663245c9ce5044c143ade826a0b4dc9cba7","user":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":35900688,"node_id":"MDEwOlJlcG9zaXRvcnkzNTkwMDY4OA==","name":"spark","full_name":"hvanhovell/spark","private":false,"owner":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/hvanhovell/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/hvanhovell/spark","forks_url":"https://api.github.com/repos/hvanhovell/spark/forks","keys_url":"https://api.github.com/repos/hvanhovell/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/hvanhovell/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/hvanhovell/spark/teams","hooks_url":"https://api.github.com/repos/hvanhovell/spark/hooks","issue_events_url":"https://api.github.com/repos/hvanhovell/spark/issues/events{/number}","events_url":"https://api.github.com/repos/hvanhovell/spark/events","assignees_url":"https://api.github.com/repos/hvanhovell/spark/assignees{/user}","branches_url":"https://api.github.com/repos/hvanhovell/spark/branches{/branch}","tags_url":"https://api.github.com/repos/hvanhovell/spark/tags","blobs_url":"https://api.github.com/repos/hvanhovell/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/hvanhovell/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/hvanhovell/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/hvanhovell/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/hvanhovell/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/hvanhovell/spark/languages","stargazers_url":"https://api.github.com/repos/hvanhovell/spark/stargazers","contributors_url":"https://api.github.com/repos/hvanhovell/spark/contributors","subscribers_url":"https://api.github.com/repos/hvanhovell/spark/subscribers","subscription_url":"https://api.github.com/repos/hvanhovell/spark/subscription","commits_url":"https://api.github.com/repos/hvanhovell/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/hvanhovell/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/hvanhovell/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/hvanhovell/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/hvanhovell/spark/contents/{+path}","compare_url":"https://api.github.com/repos/hvanhovell/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/hvanhovell/spark/merges","archive_url":"https://api.github.com/repos/hvanhovell/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/hvanhovell/spark/downloads","issues_url":"https://api.github.com/repos/hvanhovell/spark/issues{/number}","pulls_url":"https://api.github.com/repos/hvanhovell/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/hvanhovell/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/hvanhovell/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/hvanhovell/spark/labels{/name}","releases_url":"https://api.github.com/repos/hvanhovell/spark/releases{/id}","deployments_url":"https://api.github.com/repos/hvanhovell/spark/deployments","created_at":"2015-05-19T18:29:31Z","updated_at":"2024-11-14T19:45:14Z","pushed_at":"2025-02-06T16:48:48Z","git_url":"git://github.com/hvanhovell/spark.git","ssh_url":"git@github.com:hvanhovell/spark.git","clone_url":"https://github.com/hvanhovell/spark.git","svn_url":"https://github.com/hvanhovell/spark","homepage":null,"size":447542,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"b5f96fa5fb5ca7daa497b6dfd25e738c4f479aec","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39933"},"html":{"href":"https://github.com/apache/spark/pull/39933"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39933"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39933/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39933/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39933/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b628c663245c9ce5044c143ade826a0b4dc9cba7"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39932","id":1232680402,"node_id":"PR_kwDOAQXtWs5JeTXS","html_url":"https://github.com/apache/spark/pull/39932","diff_url":"https://github.com/apache/spark/pull/39932.diff","patch_url":"https://github.com/apache/spark/pull/39932.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39932","number":39932,"state":"closed","locked":false,"title":"[SPARK-42400] Code clean up in org.apache.spark.storage","user":{"login":"khalidmammadov","id":11574708,"node_id":"MDQ6VXNlcjExNTc0NzA4","avatar_url":"https://avatars.githubusercontent.com/u/11574708?v=4","gravatar_id":"","url":"https://api.github.com/users/khalidmammadov","html_url":"https://github.com/khalidmammadov","followers_url":"https://api.github.com/users/khalidmammadov/followers","following_url":"https://api.github.com/users/khalidmammadov/following{/other_user}","gists_url":"https://api.github.com/users/khalidmammadov/gists{/gist_id}","starred_url":"https://api.github.com/users/khalidmammadov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khalidmammadov/subscriptions","organizations_url":"https://api.github.com/users/khalidmammadov/orgs","repos_url":"https://api.github.com/users/khalidmammadov/repos","events_url":"https://api.github.com/users/khalidmammadov/events{/privacy}","received_events_url":"https://api.github.com/users/khalidmammadov/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nCode clean up. \r\n- Simplified conditions\r\n- Removed unused parameters\r\n- Removed explicit default values\r\n\r\n### Why are the changes needed?\r\nTo make code more readable\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nExisting tests\r\n","created_at":"2023-02-07T22:35:27Z","updated_at":"2023-02-12T15:43:29Z","closed_at":"2023-02-12T15:43:08Z","merged_at":null,"merge_commit_sha":"a1c5db8b03193e09357a4c2ce8ae126839a82fe5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39932/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39932/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39932/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/054dcd4953f97906babb1235efff5710c9e6c24e","head":{"label":"khalidmammadov:feature/minor_fixes_in_storage","ref":"feature/minor_fixes_in_storage","sha":"054dcd4953f97906babb1235efff5710c9e6c24e","user":{"login":"khalidmammadov","id":11574708,"node_id":"MDQ6VXNlcjExNTc0NzA4","avatar_url":"https://avatars.githubusercontent.com/u/11574708?v=4","gravatar_id":"","url":"https://api.github.com/users/khalidmammadov","html_url":"https://github.com/khalidmammadov","followers_url":"https://api.github.com/users/khalidmammadov/followers","following_url":"https://api.github.com/users/khalidmammadov/following{/other_user}","gists_url":"https://api.github.com/users/khalidmammadov/gists{/gist_id}","starred_url":"https://api.github.com/users/khalidmammadov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khalidmammadov/subscriptions","organizations_url":"https://api.github.com/users/khalidmammadov/orgs","repos_url":"https://api.github.com/users/khalidmammadov/repos","events_url":"https://api.github.com/users/khalidmammadov/events{/privacy}","received_events_url":"https://api.github.com/users/khalidmammadov/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":451158537,"node_id":"R_kgDOGuQiCQ","name":"spark","full_name":"khalidmammadov/spark","private":false,"owner":{"login":"khalidmammadov","id":11574708,"node_id":"MDQ6VXNlcjExNTc0NzA4","avatar_url":"https://avatars.githubusercontent.com/u/11574708?v=4","gravatar_id":"","url":"https://api.github.com/users/khalidmammadov","html_url":"https://github.com/khalidmammadov","followers_url":"https://api.github.com/users/khalidmammadov/followers","following_url":"https://api.github.com/users/khalidmammadov/following{/other_user}","gists_url":"https://api.github.com/users/khalidmammadov/gists{/gist_id}","starred_url":"https://api.github.com/users/khalidmammadov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khalidmammadov/subscriptions","organizations_url":"https://api.github.com/users/khalidmammadov/orgs","repos_url":"https://api.github.com/users/khalidmammadov/repos","events_url":"https://api.github.com/users/khalidmammadov/events{/privacy}","received_events_url":"https://api.github.com/users/khalidmammadov/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/khalidmammadov/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/khalidmammadov/spark","forks_url":"https://api.github.com/repos/khalidmammadov/spark/forks","keys_url":"https://api.github.com/repos/khalidmammadov/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/khalidmammadov/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/khalidmammadov/spark/teams","hooks_url":"https://api.github.com/repos/khalidmammadov/spark/hooks","issue_events_url":"https://api.github.com/repos/khalidmammadov/spark/issues/events{/number}","events_url":"https://api.github.com/repos/khalidmammadov/spark/events","assignees_url":"https://api.github.com/repos/khalidmammadov/spark/assignees{/user}","branches_url":"https://api.github.com/repos/khalidmammadov/spark/branches{/branch}","tags_url":"https://api.github.com/repos/khalidmammadov/spark/tags","blobs_url":"https://api.github.com/repos/khalidmammadov/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/khalidmammadov/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/khalidmammadov/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/khalidmammadov/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/khalidmammadov/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/khalidmammadov/spark/languages","stargazers_url":"https://api.github.com/repos/khalidmammadov/spark/stargazers","contributors_url":"https://api.github.com/repos/khalidmammadov/spark/contributors","subscribers_url":"https://api.github.com/repos/khalidmammadov/spark/subscribers","subscription_url":"https://api.github.com/repos/khalidmammadov/spark/subscription","commits_url":"https://api.github.com/repos/khalidmammadov/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/khalidmammadov/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/khalidmammadov/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/khalidmammadov/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/khalidmammadov/spark/contents/{+path}","compare_url":"https://api.github.com/repos/khalidmammadov/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/khalidmammadov/spark/merges","archive_url":"https://api.github.com/repos/khalidmammadov/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/khalidmammadov/spark/downloads","issues_url":"https://api.github.com/repos/khalidmammadov/spark/issues{/number}","pulls_url":"https://api.github.com/repos/khalidmammadov/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/khalidmammadov/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/khalidmammadov/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/khalidmammadov/spark/labels{/name}","releases_url":"https://api.github.com/repos/khalidmammadov/spark/releases{/id}","deployments_url":"https://api.github.com/repos/khalidmammadov/spark/deployments","created_at":"2022-01-23T16:13:31Z","updated_at":"2024-09-16T20:21:46Z","pushed_at":"2024-09-16T20:21:27Z","git_url":"git://github.com/khalidmammadov/spark.git","ssh_url":"git@github.com:khalidmammadov/spark.git","clone_url":"https://github.com/khalidmammadov/spark.git","svn_url":"https://github.com/khalidmammadov/spark","homepage":"https://spark.apache.org/","size":450334,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"b5f96fa5fb5ca7daa497b6dfd25e738c4f479aec","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39932"},"html":{"href":"https://github.com/apache/spark/pull/39932"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39932"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39932/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39932/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39932/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/054dcd4953f97906babb1235efff5710c9e6c24e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39931","id":1232146744,"node_id":"PR_kwDOAQXtWs5JcRE4","html_url":"https://github.com/apache/spark/pull/39931","diff_url":"https://github.com/apache/spark/pull/39931.diff","patch_url":"https://github.com/apache/spark/pull/39931.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39931","number":39931,"state":"closed","locked":false,"title":"[SPARK-42376][SS] Introduce watermark propagation among operators","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to introduce watermark propagation among operators via simulation, which enables the workload of \"stream-stream time interval join followed by stateful operator\".\r\n\r\nAs of now, Spark considers all stateful operators to have same input watermark and output watermark, which is insufficient to handle stream-stream time interval join. It can delay joined output more than global watermark, based on the join criteria. (e.g. `leftTime BETWEEN rightTime - INTERVAL 30 seconds AND rightTime + INTERVAL 40 seconds`). To address this, the join operator should be able to produce \"delayed\" watermark to the downstream operator. That said, Spark has to \"propagate\" watermark among operators, flowing through leaf node(s) to root (going downstream).\r\n\r\nThis PR introduces a new interface `WatermarkPropagator` which performs simulation of watermark propagation based on the watermark. There are three implementations for this interface:\r\n\r\n1. NoOpWatermarkPropagator: Do nothing. This is used for initializing dummy IncrementalExecution.\r\n2. UseSingleWatermarkPropagator: Uses a single global watermark for late events and eviction. This is used for compatibility mode (`spark.sql.streaming.statefulOperator.allowMultiple` to `false`).\r\n3. PropagateWatermarkSimulator: simulates propagation of watermark among operators.\r\n\r\nThe simulation algorithm used in `PropagateWatermarkSimulator` traverses the physical plan tree via post-order (children first) to calculate (input watermark, output watermark) for all nodes. For each node, below logic is applied:\r\n\r\n- Input watermark for specific node is decided by `min(input watermarks from all children)`.\r\n   - Children providing no input watermark are excluded.\r\n   - If there is no valid input watermark from children, it's considered as there is no input watermark.\r\n - Output watermark for specific node is decided as following:\r\n   - watermark nodes: origin watermark value (global watermark).\r\n   - stateless nodes: same as input watermark.\r\n   - stateful nodes: the return value of `op.produceOutputWatermark(input watermark)`. (if there is no input watermark, there is no output watermark)\r\n\r\nOnce the algorithm traverses the physical plan tree, the association between stateful operator and input watermark will be constructed. The association is cached after calculation and being used across microbatches, till Spark determines the association as no longer to be used.\r\n\r\nAs mentioned like `op.produceOutputWatermark()` in above, this PR also adds a new method `produceOutputWatermark` in StateStoreWriter, which requires each stateful operator to calculate output watermark based on given input watermark. In most cases, this is same as the criteria of state eviction, as most stateful operators produce the output from two different kinds:\r\n\r\n1. without buffering (event time > input watermark)\r\n2. with buffering (state)\r\n\r\nThe state eviction happens when event time exceeds a \"certain threshold of timestamp\", which denotes a lower bound of event time values for output (output watermark). Since most stateful operators construct the predicate for state eviction based on watermark in batch planning phase, they can produce an output watermark once Spark provides an input watermark.\r\n\r\nPlease refer to the walkthrough code comment for the test case of `stream-stream time interval left outer join -> aggregation, append mode`.\r\n\r\nThere are several additional decisions made by this PR which introduces backward incompatibility.\r\n\r\n1. Re-definition of watermark will be disallowed.\r\n\r\nTechnically, each watermark node can track its own value of watermark and PropagateWatermarkSimulator can propagate these values correctly. (multiple origins) While this may help to accelerate processing faster stream (as all watermarks don't need to follow the slowest one till join/union), this involves more complicated questions on UX perspective, as all UX about watermark is based on global watermark. This seems harder to address, hence this PR proposes to retain the global watermark as it is.\r\n\r\nSince we want to produce watermark as the single origin value, redefinition of watermark does not make sense. Consider stream-stream time interval join followed by another watermark node. Which is the right value of output watermark for another watermark node? delayed watermark, or global watermark?\r\n\r\n2. stateful operator will not allow multiple event time columns being defined in the input DataFrame.\r\n\r\nThe output of stream-stream join may have two event time columns, which is ambiguous on late record filtering and eviction. Currently the first appeared event time column has been picked up for late record filtering and eviction, which is ambiguous to reason about the correctness. After this PR, Spark will throw an exception. The downstream operator has to pick up only one of event time column to continue.\r\n\r\nTurning off the flag `spark.sql.streaming.statefulOperator.allowMultiple` will restore the old behavior from the above.\r\n\r\n(https://issues.apache.org/jira/browse/SPARK-42549 is filed to remove this limitation later.)\r\n\r\n### Why are the changes needed?\r\n\r\nstream-stream time interval join followed by stateful operator is not supported yet, and this PR unblocks it.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, here is a list of user facing changes (some are backward incompatibility changes, though we have compatibility flag):\r\n\r\n- stream-stream time-interval join followed by stateful operator will be allowed.\r\n- Re-definition of watermark will be disallowed.\r\n- stateful operator will not allow multiple event time columns being defined in the input DataFrame.\r\n\r\n### How was this patch tested?\r\n\r\nNew & modified test cases.","created_at":"2023-02-07T15:14:19Z","updated_at":"2023-03-07T04:44:53Z","closed_at":"2023-03-07T04:44:53Z","merged_at":null,"merge_commit_sha":"871e635c960ddfa4f9fb0fb2bce7bc21005099b3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39931/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39931/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39931/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c39b64284b1298c358fa559ec1b91d0d2f7739a5","head":{"label":"HeartSaVioR:SPARK-42376","ref":"SPARK-42376","sha":"c39b64284b1298c358fa559ec1b91d0d2f7739a5","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":27994296,"node_id":"MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==","name":"spark","full_name":"HeartSaVioR/spark","private":false,"owner":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HeartSaVioR/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HeartSaVioR/spark","forks_url":"https://api.github.com/repos/HeartSaVioR/spark/forks","keys_url":"https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HeartSaVioR/spark/teams","hooks_url":"https://api.github.com/repos/HeartSaVioR/spark/hooks","issue_events_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HeartSaVioR/spark/events","assignees_url":"https://api.github.com/repos/HeartSaVioR/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HeartSaVioR/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HeartSaVioR/spark/tags","blobs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HeartSaVioR/spark/languages","stargazers_url":"https://api.github.com/repos/HeartSaVioR/spark/stargazers","contributors_url":"https://api.github.com/repos/HeartSaVioR/spark/contributors","subscribers_url":"https://api.github.com/repos/HeartSaVioR/spark/subscribers","subscription_url":"https://api.github.com/repos/HeartSaVioR/spark/subscription","commits_url":"https://api.github.com/repos/HeartSaVioR/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HeartSaVioR/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HeartSaVioR/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HeartSaVioR/spark/merges","archive_url":"https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HeartSaVioR/spark/downloads","issues_url":"https://api.github.com/repos/HeartSaVioR/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HeartSaVioR/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HeartSaVioR/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HeartSaVioR/spark/labels{/name}","releases_url":"https://api.github.com/repos/HeartSaVioR/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HeartSaVioR/spark/deployments","created_at":"2014-12-14T12:56:04Z","updated_at":"2024-10-21T04:36:36Z","pushed_at":"2025-01-08T06:13:27Z","git_url":"git://github.com/HeartSaVioR/spark.git","ssh_url":"git@github.com:HeartSaVioR/spark.git","clone_url":"https://github.com/HeartSaVioR/spark.git","svn_url":"https://github.com/HeartSaVioR/spark","homepage":null,"size":456164,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":1,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a9c5efa413335c02621d79242e83595c4b932bf0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39931"},"html":{"href":"https://github.com/apache/spark/pull/39931"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39931"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39931/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39931/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39931/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c39b64284b1298c358fa559ec1b91d0d2f7739a5"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39930","id":1232058457,"node_id":"PR_kwDOAQXtWs5Jb7hZ","html_url":"https://github.com/apache/spark/pull/39930","diff_url":"https://github.com/apache/spark/pull/39930.diff","patch_url":"https://github.com/apache/spark/pull/39930.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39930","number":39930,"state":"closed","locked":false,"title":"[Do not merged][SPARK-37099][SQL] Introduce the group limit of Window for rank-based filter to optimize top-k computation","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR just used to test.\r\n\r\n\r\n### Why are the changes needed?\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\n\r\n\r\n### How was this patch tested?\r\n\r\n","created_at":"2023-02-07T14:14:21Z","updated_at":"2023-02-22T03:25:21Z","closed_at":"2023-02-22T03:25:21Z","merged_at":null,"merge_commit_sha":"b255a21a4e71e487ba053bb69a27019755917da5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39930/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39930/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39930/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a1686779b1886240dbdc2e9c38df42812fcd819a","head":{"label":"beliefer:SPARK-37099_hashtable_test","ref":"SPARK-37099_hashtable_test","sha":"a1686779b1886240dbdc2e9c38df42812fcd819a","user":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":237617513,"node_id":"MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=","name":"spark","full_name":"beliefer/spark","private":false,"owner":{"login":"beliefer","id":8486025,"node_id":"MDQ6VXNlcjg0ODYwMjU=","avatar_url":"https://avatars.githubusercontent.com/u/8486025?v=4","gravatar_id":"","url":"https://api.github.com/users/beliefer","html_url":"https://github.com/beliefer","followers_url":"https://api.github.com/users/beliefer/followers","following_url":"https://api.github.com/users/beliefer/following{/other_user}","gists_url":"https://api.github.com/users/beliefer/gists{/gist_id}","starred_url":"https://api.github.com/users/beliefer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beliefer/subscriptions","organizations_url":"https://api.github.com/users/beliefer/orgs","repos_url":"https://api.github.com/users/beliefer/repos","events_url":"https://api.github.com/users/beliefer/events{/privacy}","received_events_url":"https://api.github.com/users/beliefer/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/beliefer/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/beliefer/spark","forks_url":"https://api.github.com/repos/beliefer/spark/forks","keys_url":"https://api.github.com/repos/beliefer/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/beliefer/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/beliefer/spark/teams","hooks_url":"https://api.github.com/repos/beliefer/spark/hooks","issue_events_url":"https://api.github.com/repos/beliefer/spark/issues/events{/number}","events_url":"https://api.github.com/repos/beliefer/spark/events","assignees_url":"https://api.github.com/repos/beliefer/spark/assignees{/user}","branches_url":"https://api.github.com/repos/beliefer/spark/branches{/branch}","tags_url":"https://api.github.com/repos/beliefer/spark/tags","blobs_url":"https://api.github.com/repos/beliefer/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/beliefer/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/beliefer/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/beliefer/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/beliefer/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/beliefer/spark/languages","stargazers_url":"https://api.github.com/repos/beliefer/spark/stargazers","contributors_url":"https://api.github.com/repos/beliefer/spark/contributors","subscribers_url":"https://api.github.com/repos/beliefer/spark/subscribers","subscription_url":"https://api.github.com/repos/beliefer/spark/subscription","commits_url":"https://api.github.com/repos/beliefer/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/beliefer/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/beliefer/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/beliefer/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/beliefer/spark/contents/{+path}","compare_url":"https://api.github.com/repos/beliefer/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/beliefer/spark/merges","archive_url":"https://api.github.com/repos/beliefer/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/beliefer/spark/downloads","issues_url":"https://api.github.com/repos/beliefer/spark/issues{/number}","pulls_url":"https://api.github.com/repos/beliefer/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/beliefer/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/beliefer/spark/labels{/name}","releases_url":"https://api.github.com/repos/beliefer/spark/releases{/id}","deployments_url":"https://api.github.com/repos/beliefer/spark/deployments","created_at":"2020-02-01T13:17:08Z","updated_at":"2025-01-28T09:45:49Z","pushed_at":"2025-01-28T11:57:29Z","git_url":"git://github.com/beliefer/spark.git","ssh_url":"git@github.com:beliefer/spark.git","clone_url":"https://github.com/beliefer/spark.git","svn_url":"https://github.com/beliefer/spark","homepage":"","size":488033,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a8d69132fb33cc5a7ff365715840ba99c6514c49","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39930"},"html":{"href":"https://github.com/apache/spark/pull/39930"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39930"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39930/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39930/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39930/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a1686779b1886240dbdc2e9c38df42812fcd819a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39929","id":1231777281,"node_id":"PR_kwDOAQXtWs5Ja24B","html_url":"https://github.com/apache/spark/pull/39929","diff_url":"https://github.com/apache/spark/pull/39929.diff","patch_url":"https://github.com/apache/spark/pull/39929.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39929","number":39929,"state":"closed","locked":false,"title":"[SPARK-42372][SQL] Improve performance of HiveGenericUDTF by making inputProjection instantiate once","user":{"login":"yaooqinn","id":8326978,"node_id":"MDQ6VXNlcjgzMjY5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/8326978?v=4","gravatar_id":"","url":"https://api.github.com/users/yaooqinn","html_url":"https://github.com/yaooqinn","followers_url":"https://api.github.com/users/yaooqinn/followers","following_url":"https://api.github.com/users/yaooqinn/following{/other_user}","gists_url":"https://api.github.com/users/yaooqinn/gists{/gist_id}","starred_url":"https://api.github.com/users/yaooqinn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yaooqinn/subscriptions","organizations_url":"https://api.github.com/users/yaooqinn/orgs","repos_url":"https://api.github.com/users/yaooqinn/repos","events_url":"https://api.github.com/users/yaooqinn/events{/privacy}","received_events_url":"https://api.github.com/users/yaooqinn/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\nImprove performance of HiveGenericUDTF by making inputProjection instantiate once\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nperformance improvement for hive udtf\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nno\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\nvia benchmarking, over 2x faster with one LOC.\r\n\r\n```gitdiff\r\n+++ b/sql/hive/benchmarks/HiveUDFBenchmark-per-row-results.txt\r\n@@ -0,0 +1,7 @@\r\n+OpenJDK 64-Bit Server VM 1.8.0_352-bre_2022_12_13_23_06-b00 on Mac OS X 13.1\r\n+Intel(R) Core(TM) i9-9980HK CPU @ 2.40GHz\r\n+Hive UDTF benchmark:                      Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative\r\n+------------------------------------------------------------------------------------------------------------------------\r\n+Hive UDTF dup 2                                    1574           1680         118          0.7        1501.1       1.0X\r\n+Hive UDTF dup 4                                    2642           3076         588          0.4        2519.9       0.6X\r\n+\r\ndiff --git a/sql/hive/benchmarks/HiveUDFBenchmark-results.txt b/sql/hive/benchmarks/HiveUDFBenchmark-results.txt\r\nnew file mode 100644\r\nindex 0000000000..8af8b6582c\r\n--- /dev/null\r\n+++ b/sql/hive/benchmarks/HiveUDFBenchmark-results.txt\r\n@@ -0,0 +1,7 @@\r\n+OpenJDK 64-Bit Server VM 1.8.0_352-bre_2022_12_13_23_06-b00 on Mac OS X 13.1\r\n+Intel(R) Core(TM) i9-9980HK CPU @ 2.40GHz\r\n+Hive UDTF benchmark:                      Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative\r\n+------------------------------------------------------------------------------------------------------------------------\r\n+Hive UDTF dup 2                                     712            789         101          1.5         678.7       1.0X\r\n+Hive UDTF dup 4                                    1212           1294          78          0.9        1156.0       0.6X\r\n+ \r\n```","created_at":"2023-02-07T10:46:53Z","updated_at":"2023-02-08T05:38:32Z","closed_at":"2023-02-08T05:36:53Z","merged_at":null,"merge_commit_sha":"80dd3e00741bda4f491a8c7fe00a8041935a82a2","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39929/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39929/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39929/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1afaf5549c01a65e00a61bf6ded12c1d14a31321","head":{"label":"yaooqinn:SPARK-42372","ref":"SPARK-42372","sha":"1afaf5549c01a65e00a61bf6ded12c1d14a31321","user":{"login":"yaooqinn","id":8326978,"node_id":"MDQ6VXNlcjgzMjY5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/8326978?v=4","gravatar_id":"","url":"https://api.github.com/users/yaooqinn","html_url":"https://github.com/yaooqinn","followers_url":"https://api.github.com/users/yaooqinn/followers","following_url":"https://api.github.com/users/yaooqinn/following{/other_user}","gists_url":"https://api.github.com/users/yaooqinn/gists{/gist_id}","starred_url":"https://api.github.com/users/yaooqinn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yaooqinn/subscriptions","organizations_url":"https://api.github.com/users/yaooqinn/orgs","repos_url":"https://api.github.com/users/yaooqinn/repos","events_url":"https://api.github.com/users/yaooqinn/events{/privacy}","received_events_url":"https://api.github.com/users/yaooqinn/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":357976080,"node_id":"MDEwOlJlcG9zaXRvcnkzNTc5NzYwODA=","name":"spark","full_name":"yaooqinn/spark","private":false,"owner":{"login":"yaooqinn","id":8326978,"node_id":"MDQ6VXNlcjgzMjY5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/8326978?v=4","gravatar_id":"","url":"https://api.github.com/users/yaooqinn","html_url":"https://github.com/yaooqinn","followers_url":"https://api.github.com/users/yaooqinn/followers","following_url":"https://api.github.com/users/yaooqinn/following{/other_user}","gists_url":"https://api.github.com/users/yaooqinn/gists{/gist_id}","starred_url":"https://api.github.com/users/yaooqinn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yaooqinn/subscriptions","organizations_url":"https://api.github.com/users/yaooqinn/orgs","repos_url":"https://api.github.com/users/yaooqinn/repos","events_url":"https://api.github.com/users/yaooqinn/events{/privacy}","received_events_url":"https://api.github.com/users/yaooqinn/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yaooqinn/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/yaooqinn/spark","forks_url":"https://api.github.com/repos/yaooqinn/spark/forks","keys_url":"https://api.github.com/repos/yaooqinn/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yaooqinn/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yaooqinn/spark/teams","hooks_url":"https://api.github.com/repos/yaooqinn/spark/hooks","issue_events_url":"https://api.github.com/repos/yaooqinn/spark/issues/events{/number}","events_url":"https://api.github.com/repos/yaooqinn/spark/events","assignees_url":"https://api.github.com/repos/yaooqinn/spark/assignees{/user}","branches_url":"https://api.github.com/repos/yaooqinn/spark/branches{/branch}","tags_url":"https://api.github.com/repos/yaooqinn/spark/tags","blobs_url":"https://api.github.com/repos/yaooqinn/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yaooqinn/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yaooqinn/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/yaooqinn/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yaooqinn/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/yaooqinn/spark/languages","stargazers_url":"https://api.github.com/repos/yaooqinn/spark/stargazers","contributors_url":"https://api.github.com/repos/yaooqinn/spark/contributors","subscribers_url":"https://api.github.com/repos/yaooqinn/spark/subscribers","subscription_url":"https://api.github.com/repos/yaooqinn/spark/subscription","commits_url":"https://api.github.com/repos/yaooqinn/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/yaooqinn/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/yaooqinn/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/yaooqinn/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/yaooqinn/spark/contents/{+path}","compare_url":"https://api.github.com/repos/yaooqinn/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yaooqinn/spark/merges","archive_url":"https://api.github.com/repos/yaooqinn/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yaooqinn/spark/downloads","issues_url":"https://api.github.com/repos/yaooqinn/spark/issues{/number}","pulls_url":"https://api.github.com/repos/yaooqinn/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/yaooqinn/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/yaooqinn/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yaooqinn/spark/labels{/name}","releases_url":"https://api.github.com/repos/yaooqinn/spark/releases{/id}","deployments_url":"https://api.github.com/repos/yaooqinn/spark/deployments","created_at":"2021-04-14T16:44:36Z","updated_at":"2024-11-05T08:03:33Z","pushed_at":"2025-01-24T02:12:30Z","git_url":"git://github.com/yaooqinn/spark.git","ssh_url":"git@github.com:yaooqinn/spark.git","clone_url":"https://github.com/yaooqinn/spark.git","svn_url":"https://github.com/yaooqinn/spark","homepage":"https://spark.apache.org/","size":468287,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"d5b0cb49f45ebb6ad9c9d288822ede4653d4a3a0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39929"},"html":{"href":"https://github.com/apache/spark/pull/39929"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39929"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39929/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39929/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39929/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1afaf5549c01a65e00a61bf6ded12c1d14a31321"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39928","id":1231758099,"node_id":"PR_kwDOAQXtWs5JayMT","html_url":"https://github.com/apache/spark/pull/39928","diff_url":"https://github.com/apache/spark/pull/39928.diff","patch_url":"https://github.com/apache/spark/pull/39928.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39928","number":39928,"state":"closed","locked":false,"title":"[SPARK-42371][CONNECT] Add scripts to start and stop Spark Connect server","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to scripts to start and stop the Spark Connect server.\r\n\r\n### Why are the changes needed?\r\n\r\nCurrently, there is no proper way to start and stop the Spark Connect server. Now it requires you to start it with, for example, a Spark shell:\r\n\r\n```bash\r\n# For development,\r\n./bin/spark-shell \\\r\n   --jars `ls connector/connect/server/target/**/spark-connect*SNAPSHOT.jar` \\\r\n  --conf spark.plugins=org.apache.spark.sql.connect.SparkConnectPlugin\r\n```\r\n\r\n```bash\r\n# For released Spark versions\r\n./bin/spark-shell \\\r\n  --packages org.apache.spark:spark-connect_2.12:3.4.0 \\\r\n  --conf spark.plugins=org.apache.spark.sql.connect.SparkConnectPlugin\r\n```\r\n\r\nwhich is awkward.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, it adds new scripts to start and stop Spark Connect server.\r\n\r\n### How was this patch tested?\r\n\r\nManually tested:\r\n\r\n```bash\r\n# For released Spark versions,\r\n#`sbin/start-connect-server.sh --packages org.apache.spark:spark-connect_2.12:3.4.0`\r\nsbin/start-connect-server.sh --jars `ls connector/connect/server/target/**/spark-connect*SNAPSHOT.jar`\r\n```\r\n\r\n```bash\r\nbin/pyspark --remote sc://localhost:15002\r\n...\r\n```\r\n\r\n```bash\r\nsbin/stop-connect-server.sh\r\nps -fe | grep Spark\r\n```","created_at":"2023-02-07T10:31:12Z","updated_at":"2024-01-15T00:48:54Z","closed_at":"2023-02-08T02:39:44Z","merged_at":null,"merge_commit_sha":"22d749804983c53330624861d9739f9734c8a0eb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406606351,"node_id":"MDU6TGFiZWwxNDA2NjA2MzUx","url":"https://api.github.com/repos/apache/spark/labels/DEPLOY","name":"DEPLOY","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39928/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39928/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39928/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8ba8e8b40ff701b62e437ab84a0d083e9f468572","head":{"label":"HyukjinKwon:exec-script","ref":"exec-script","sha":"8ba8e8b40ff701b62e437ab84a0d083e9f468572","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"56dd20f6a6b3efb2676196fa14d5e7fbbafe4949","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39928"},"html":{"href":"https://github.com/apache/spark/pull/39928"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39928"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39928/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39928/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39928/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8ba8e8b40ff701b62e437ab84a0d083e9f468572"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39927","id":1231616922,"node_id":"PR_kwDOAQXtWs5JaPua","html_url":"https://github.com/apache/spark/pull/39927","diff_url":"https://github.com/apache/spark/pull/39927.diff","patch_url":"https://github.com/apache/spark/pull/39927.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39927","number":39927,"state":"closed","locked":false,"title":"[SPARK-42373][SQL] Remove unused blank line removal from CSVExprUtils","user":{"login":"ted-jenks","id":77486246,"node_id":"MDQ6VXNlcjc3NDg2MjQ2","avatar_url":"https://avatars.githubusercontent.com/u/77486246?v=4","gravatar_id":"","url":"https://api.github.com/users/ted-jenks","html_url":"https://github.com/ted-jenks","followers_url":"https://api.github.com/users/ted-jenks/followers","following_url":"https://api.github.com/users/ted-jenks/following{/other_user}","gists_url":"https://api.github.com/users/ted-jenks/gists{/gist_id}","starred_url":"https://api.github.com/users/ted-jenks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ted-jenks/subscriptions","organizations_url":"https://api.github.com/users/ted-jenks/orgs","repos_url":"https://api.github.com/users/ted-jenks/repos","events_url":"https://api.github.com/users/ted-jenks/events{/privacy}","received_events_url":"https://api.github.com/users/ted-jenks/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nRemove blank line removal from CSVExprUtils. This is currently unused as the parser used to generate inputs for this code-path removes blank and whitespace lines. \r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCloses [SPARK-42373](https://issues.apache.org/jira/browse/SPARK-42373). The current state is misleading, indicating that the function is responsible for functionality that it is not. The multiline codepath does not contain any methods claiming to remove blank lines, leading to a confusing disparity between the two. If in the future blank lines need to be removed from an `Iterator[String]`, this behavior should be added back explicitly.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nSee CSVSuite tests that read \"cars...\" files which contain blank lines on the multiline and non-multiline code-path.\r\n","created_at":"2023-02-07T08:44:27Z","updated_at":"2023-02-14T14:39:40Z","closed_at":"2023-02-14T14:39:40Z","merged_at":null,"merge_commit_sha":"a041f490b16d560dc0e69fecd580c704646af609","assignee":null,"assignees":[],"requested_reviewers":[{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39927/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39927/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39927/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/44cb57bd28f15434fb33858d3a7dcbeb432e6442","head":{"label":"ted-jenks:patch-2","ref":"patch-2","sha":"44cb57bd28f15434fb33858d3a7dcbeb432e6442","user":{"login":"ted-jenks","id":77486246,"node_id":"MDQ6VXNlcjc3NDg2MjQ2","avatar_url":"https://avatars.githubusercontent.com/u/77486246?v=4","gravatar_id":"","url":"https://api.github.com/users/ted-jenks","html_url":"https://github.com/ted-jenks","followers_url":"https://api.github.com/users/ted-jenks/followers","following_url":"https://api.github.com/users/ted-jenks/following{/other_user}","gists_url":"https://api.github.com/users/ted-jenks/gists{/gist_id}","starred_url":"https://api.github.com/users/ted-jenks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ted-jenks/subscriptions","organizations_url":"https://api.github.com/users/ted-jenks/orgs","repos_url":"https://api.github.com/users/ted-jenks/repos","events_url":"https://api.github.com/users/ted-jenks/events{/privacy}","received_events_url":"https://api.github.com/users/ted-jenks/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":576309126,"node_id":"R_kgDOIlnHhg","name":"spark","full_name":"ted-jenks/spark","private":false,"owner":{"login":"ted-jenks","id":77486246,"node_id":"MDQ6VXNlcjc3NDg2MjQ2","avatar_url":"https://avatars.githubusercontent.com/u/77486246?v=4","gravatar_id":"","url":"https://api.github.com/users/ted-jenks","html_url":"https://github.com/ted-jenks","followers_url":"https://api.github.com/users/ted-jenks/followers","following_url":"https://api.github.com/users/ted-jenks/following{/other_user}","gists_url":"https://api.github.com/users/ted-jenks/gists{/gist_id}","starred_url":"https://api.github.com/users/ted-jenks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ted-jenks/subscriptions","organizations_url":"https://api.github.com/users/ted-jenks/orgs","repos_url":"https://api.github.com/users/ted-jenks/repos","events_url":"https://api.github.com/users/ted-jenks/events{/privacy}","received_events_url":"https://api.github.com/users/ted-jenks/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ted-jenks/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/ted-jenks/spark","forks_url":"https://api.github.com/repos/ted-jenks/spark/forks","keys_url":"https://api.github.com/repos/ted-jenks/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ted-jenks/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ted-jenks/spark/teams","hooks_url":"https://api.github.com/repos/ted-jenks/spark/hooks","issue_events_url":"https://api.github.com/repos/ted-jenks/spark/issues/events{/number}","events_url":"https://api.github.com/repos/ted-jenks/spark/events","assignees_url":"https://api.github.com/repos/ted-jenks/spark/assignees{/user}","branches_url":"https://api.github.com/repos/ted-jenks/spark/branches{/branch}","tags_url":"https://api.github.com/repos/ted-jenks/spark/tags","blobs_url":"https://api.github.com/repos/ted-jenks/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ted-jenks/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ted-jenks/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ted-jenks/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ted-jenks/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ted-jenks/spark/languages","stargazers_url":"https://api.github.com/repos/ted-jenks/spark/stargazers","contributors_url":"https://api.github.com/repos/ted-jenks/spark/contributors","subscribers_url":"https://api.github.com/repos/ted-jenks/spark/subscribers","subscription_url":"https://api.github.com/repos/ted-jenks/spark/subscription","commits_url":"https://api.github.com/repos/ted-jenks/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ted-jenks/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ted-jenks/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ted-jenks/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ted-jenks/spark/contents/{+path}","compare_url":"https://api.github.com/repos/ted-jenks/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ted-jenks/spark/merges","archive_url":"https://api.github.com/repos/ted-jenks/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ted-jenks/spark/downloads","issues_url":"https://api.github.com/repos/ted-jenks/spark/issues{/number}","pulls_url":"https://api.github.com/repos/ted-jenks/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ted-jenks/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ted-jenks/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ted-jenks/spark/labels{/name}","releases_url":"https://api.github.com/repos/ted-jenks/spark/releases{/id}","deployments_url":"https://api.github.com/repos/ted-jenks/spark/deployments","created_at":"2022-12-09T14:17:53Z","updated_at":"2022-12-09T08:58:57Z","pushed_at":"2024-03-12T13:48:17Z","git_url":"git://github.com/ted-jenks/spark.git","ssh_url":"git@github.com:ted-jenks/spark.git","clone_url":"https://github.com/ted-jenks/spark.git","svn_url":"https://github.com/ted-jenks/spark","homepage":"https://spark.apache.org/","size":410714,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"d5b0cb49f45ebb6ad9c9d288822ede4653d4a3a0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39927"},"html":{"href":"https://github.com/apache/spark/pull/39927"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39927"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39927/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39927/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39927/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/44cb57bd28f15434fb33858d3a7dcbeb432e6442"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39926","id":1231581254,"node_id":"PR_kwDOAQXtWs5JaHBG","html_url":"https://github.com/apache/spark/pull/39926","diff_url":"https://github.com/apache/spark/pull/39926.diff","patch_url":"https://github.com/apache/spark/pull/39926.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39926","number":39926,"state":"closed","locked":false,"title":"[WIP][SQL] Remove skipComments function in CSVExprUtils","user":{"login":"ted-jenks","id":77486246,"node_id":"MDQ6VXNlcjc3NDg2MjQ2","avatar_url":"https://avatars.githubusercontent.com/u/77486246?v=4","gravatar_id":"","url":"https://api.github.com/users/ted-jenks","html_url":"https://github.com/ted-jenks","followers_url":"https://api.github.com/users/ted-jenks/followers","following_url":"https://api.github.com/users/ted-jenks/following{/other_user}","gists_url":"https://api.github.com/users/ted-jenks/gists{/gist_id}","starred_url":"https://api.github.com/users/ted-jenks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ted-jenks/subscriptions","organizations_url":"https://api.github.com/users/ted-jenks/orgs","repos_url":"https://api.github.com/users/ted-jenks/repos","events_url":"https://api.github.com/users/ted-jenks/events{/privacy}","received_events_url":"https://api.github.com/users/ted-jenks/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nCode simplification: skipComments cannot be replaced with filterCommentsAndEmpty for its only use, so skipComments has been removed here.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCurrently code to achieve the same ends is repeated right next to itself.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nCoverage already given by existing tests in CSV suite - no behavior change expected.","created_at":"2023-02-07T08:13:36Z","updated_at":"2023-02-07T11:26:33Z","closed_at":"2023-02-07T11:26:33Z","merged_at":null,"merge_commit_sha":"4ea82fe53d6ab3dbf9d0b440bd1dcb15722f9519","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":true,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39926/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39926/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39926/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b360c6b1420c3ce719e6ac55b483c931066000a7","head":{"label":"ted-jenks:patch-1","ref":"patch-1","sha":"b360c6b1420c3ce719e6ac55b483c931066000a7","user":{"login":"ted-jenks","id":77486246,"node_id":"MDQ6VXNlcjc3NDg2MjQ2","avatar_url":"https://avatars.githubusercontent.com/u/77486246?v=4","gravatar_id":"","url":"https://api.github.com/users/ted-jenks","html_url":"https://github.com/ted-jenks","followers_url":"https://api.github.com/users/ted-jenks/followers","following_url":"https://api.github.com/users/ted-jenks/following{/other_user}","gists_url":"https://api.github.com/users/ted-jenks/gists{/gist_id}","starred_url":"https://api.github.com/users/ted-jenks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ted-jenks/subscriptions","organizations_url":"https://api.github.com/users/ted-jenks/orgs","repos_url":"https://api.github.com/users/ted-jenks/repos","events_url":"https://api.github.com/users/ted-jenks/events{/privacy}","received_events_url":"https://api.github.com/users/ted-jenks/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":576309126,"node_id":"R_kgDOIlnHhg","name":"spark","full_name":"ted-jenks/spark","private":false,"owner":{"login":"ted-jenks","id":77486246,"node_id":"MDQ6VXNlcjc3NDg2MjQ2","avatar_url":"https://avatars.githubusercontent.com/u/77486246?v=4","gravatar_id":"","url":"https://api.github.com/users/ted-jenks","html_url":"https://github.com/ted-jenks","followers_url":"https://api.github.com/users/ted-jenks/followers","following_url":"https://api.github.com/users/ted-jenks/following{/other_user}","gists_url":"https://api.github.com/users/ted-jenks/gists{/gist_id}","starred_url":"https://api.github.com/users/ted-jenks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ted-jenks/subscriptions","organizations_url":"https://api.github.com/users/ted-jenks/orgs","repos_url":"https://api.github.com/users/ted-jenks/repos","events_url":"https://api.github.com/users/ted-jenks/events{/privacy}","received_events_url":"https://api.github.com/users/ted-jenks/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ted-jenks/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/ted-jenks/spark","forks_url":"https://api.github.com/repos/ted-jenks/spark/forks","keys_url":"https://api.github.com/repos/ted-jenks/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ted-jenks/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ted-jenks/spark/teams","hooks_url":"https://api.github.com/repos/ted-jenks/spark/hooks","issue_events_url":"https://api.github.com/repos/ted-jenks/spark/issues/events{/number}","events_url":"https://api.github.com/repos/ted-jenks/spark/events","assignees_url":"https://api.github.com/repos/ted-jenks/spark/assignees{/user}","branches_url":"https://api.github.com/repos/ted-jenks/spark/branches{/branch}","tags_url":"https://api.github.com/repos/ted-jenks/spark/tags","blobs_url":"https://api.github.com/repos/ted-jenks/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ted-jenks/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ted-jenks/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ted-jenks/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ted-jenks/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ted-jenks/spark/languages","stargazers_url":"https://api.github.com/repos/ted-jenks/spark/stargazers","contributors_url":"https://api.github.com/repos/ted-jenks/spark/contributors","subscribers_url":"https://api.github.com/repos/ted-jenks/spark/subscribers","subscription_url":"https://api.github.com/repos/ted-jenks/spark/subscription","commits_url":"https://api.github.com/repos/ted-jenks/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ted-jenks/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ted-jenks/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ted-jenks/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ted-jenks/spark/contents/{+path}","compare_url":"https://api.github.com/repos/ted-jenks/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ted-jenks/spark/merges","archive_url":"https://api.github.com/repos/ted-jenks/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ted-jenks/spark/downloads","issues_url":"https://api.github.com/repos/ted-jenks/spark/issues{/number}","pulls_url":"https://api.github.com/repos/ted-jenks/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ted-jenks/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ted-jenks/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ted-jenks/spark/labels{/name}","releases_url":"https://api.github.com/repos/ted-jenks/spark/releases{/id}","deployments_url":"https://api.github.com/repos/ted-jenks/spark/deployments","created_at":"2022-12-09T14:17:53Z","updated_at":"2022-12-09T08:58:57Z","pushed_at":"2024-03-12T13:48:17Z","git_url":"git://github.com/ted-jenks/spark.git","ssh_url":"git@github.com:ted-jenks/spark.git","clone_url":"https://github.com/ted-jenks/spark.git","svn_url":"https://github.com/ted-jenks/spark","homepage":"https://spark.apache.org/","size":410714,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"d5b0cb49f45ebb6ad9c9d288822ede4653d4a3a0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39926"},"html":{"href":"https://github.com/apache/spark/pull/39926"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39926"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39926/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39926/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39926/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b360c6b1420c3ce719e6ac55b483c931066000a7"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39925","id":1231564163,"node_id":"PR_kwDOAQXtWs5JaC2D","html_url":"https://github.com/apache/spark/pull/39925","diff_url":"https://github.com/apache/spark/pull/39925.diff","patch_url":"https://github.com/apache/spark/pull/39925.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39925","number":39925,"state":"closed","locked":false,"title":"[SPARK-41812][SPARK-41823][CONNECT][SQL][PYTHON] Resolve ambiguous columns issue in `Join`","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nIn Python Client\r\n- generate `plan_id` for each proto plan (It's up to the Client to guarantee the uniqueness);\r\n- attach `plan_id` to the column created by `DataFrame[col_name]` or `DataFrame.col_name`;\r\n- Note that `F.col(col_name)` doesn't have `plan_id`;\r\n\r\nIn Connect Planner:\r\n- attach `plan_id` to `UnresolvedAttribute`s and `LogicalPlan `s via `TreeNodeTag`\r\n\r\nIn Analyzer:\r\n- for an `UnresolvedAttribute` with `plan_id`, search the matching node in the plan, and resolve it with the found node if possible\r\n\r\n\r\n**Out of scope:**\r\n\r\n- resolve `self-join`\r\n- add a `DetectAmbiguousSelfJoin`-like rule for detection\r\n\r\n### Why are the changes needed?\r\nFix bug, before this PR:\r\n```\r\ndf1.join(df2, df1[\"value\"] == df2[\"value\"])  <- fail due to can not resolve `value`\r\ndf1.join(df2, df1[\"value\"] == df2[\"value\"]).select(df1.value) <- fail due to can not resolve `value`\r\ndf1.select(df2.value)    <- should fail, but run as `df1.select(df1.value)` and return the incorrect results\r\n```\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nyes\r\n\r\n\r\n### How was this patch tested?\r\nadded tests, enabled tests\r\n","created_at":"2023-02-07T07:58:45Z","updated_at":"2023-02-13T08:26:54Z","closed_at":"2023-02-13T08:22:29Z","merged_at":null,"merge_commit_sha":"89e2d3f8aec28762fdbf17360b4a669ab7325331","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39925/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39925/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39925/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/68968c089a5a7224e5db60ea01ed784306616f15","head":{"label":"zhengruifeng:connect_plan_id","ref":"connect_plan_id","sha":"68968c089a5a7224e5db60ea01ed784306616f15","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"3985b91633f5e49c8c97433651f81604dad193e9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39925"},"html":{"href":"https://github.com/apache/spark/pull/39925"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39925"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39925/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39925/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39925/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/68968c089a5a7224e5db60ea01ed784306616f15"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39924","id":1231519406,"node_id":"PR_kwDOAQXtWs5JZ36u","html_url":"https://github.com/apache/spark/pull/39924","diff_url":"https://github.com/apache/spark/pull/39924.diff","patch_url":"https://github.com/apache/spark/pull/39924.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39924","number":39924,"state":"closed","locked":false,"title":"[SPARK-41708][SQL][TEST][FOLLOWUP] Match non-space chars in path string","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis is a followup of https://github.com/apache/spark/pull/39610 . The non-greedy mode does not work well if the ending class name appears more than once, like `file://myPath/.../clsName/.../clsName`. We should still use greedy mode, but to match any chars that are not space or comma (comma is used to combine multiple paths in `FileIndex.toString`).\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nmake the test framework more stable\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nno\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nN/A","created_at":"2023-02-07T07:12:51Z","updated_at":"2023-02-08T11:59:14Z","closed_at":"2023-02-08T11:58:36Z","merged_at":null,"merge_commit_sha":"4dd114d1a9c914d12cf2257fb0a4a077bad10d11","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39924/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39924/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39924/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7ab022c961c13c48fcd60d257f1537dfafc93ca7","head":{"label":"cloud-fan:minor","ref":"minor","sha":"7ab022c961c13c48fcd60d257f1537dfafc93ca7","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"839c56a8d96e0885821c492407dbe2801398f2b8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39924"},"html":{"href":"https://github.com/apache/spark/pull/39924"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39924"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39924/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39924/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39924/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7ab022c961c13c48fcd60d257f1537dfafc93ca7"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39923","id":1231510698,"node_id":"PR_kwDOAQXtWs5JZ1yq","html_url":"https://github.com/apache/spark/pull/39923","diff_url":"https://github.com/apache/spark/pull/39923.diff","patch_url":"https://github.com/apache/spark/pull/39923.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39923","number":39923,"state":"closed","locked":false,"title":"[SPARK-39851][SQL] Improve join stats estimation if one side can keep uniqueness","user":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR improves join stats estimation if one side can keep uniqueness(The distinct keys of the children of the join are a subset of the join keys). A common case is:\r\n\r\n```sql\r\nSELECT i_item_sk ss_item_sk\r\nFROM   item,\r\n       (SELECT DISTINCT iss.i_brand_id    brand_id,\r\n                        iss.i_class_id    class_id,\r\n                        iss.i_category_id category_id\r\n        FROM   item iss) x\r\nWHERE  i_brand_id = brand_id\r\n       AND i_class_id = class_id\r\n       AND i_category_id = category_id \r\n```\r\n\r\nIn this case, the row count of the join will definitely not expand.\r\n\r\nBefore this PR:\r\n\r\n```\r\n== Optimized Logical Plan ==\r\nProject [i_item_sk#4 AS ss_item_sk#54], Statistics(sizeInBytes=370.8 MiB, rowCount=3.24E+7)\r\n+- Join Inner, (((i_brand_id#11 = brand_id#51) AND (i_class_id#13 = class_id#52)) AND (i_category_id#15 = category_id#53)), Statistics(sizeInBytes=1112.3 MiB, rowCount=3.24E+7)\r\n   :- Project [i_item_sk#4, i_brand_id#11, i_class_id#13, i_category_id#15], Statistics(sizeInBytes=4.6 MiB, rowCount=2.02E+5)\r\n   :  +- Filter ((isnotnull(i_brand_id#11) AND isnotnull(i_class_id#13)) AND isnotnull(i_category_id#15)), Statistics(sizeInBytes=84.6 MiB, rowCount=2.02E+5)\r\n   :     +- Relation spark_catalog.default.item[i_item_sk#4,i_item_id#5,i_rec_start_date#6,i_rec_end_date#7,i_item_desc#8,i_current_price#9,i_wholesale_cost#10,i_brand_id#11,i_brand#12,i_class_id#13,i_class#14,i_category_id#15,i_category#16,i_manufact_id#17,i_manufact#18,i_size#19,i_formulation#20,i_color#21,i_units#22,i_container#23,i_manager_id#24,i_product_name#25] parquet, Statistics(sizeInBytes=85.2 MiB, rowCount=2.04E+5)\r\n   +- Aggregate [brand_id#51, class_id#52, category_id#53], [brand_id#51, class_id#52, category_id#53], Statistics(sizeInBytes=2.6 MiB, rowCount=1.37E+5)\r\n      +- Project [i_brand_id#62 AS brand_id#51, i_class_id#64 AS class_id#52, i_category_id#66 AS category_id#53], Statistics(sizeInBytes=3.9 MiB, rowCount=2.02E+5)\r\n         +- Filter ((isnotnull(i_brand_id#62) AND isnotnull(i_class_id#64)) AND isnotnull(i_category_id#66)), Statistics(sizeInBytes=84.6 MiB, rowCount=2.02E+5)\r\n            +- Relation spark_catalog.default.item[i_item_sk#55,i_item_id#56,i_rec_start_date#57,i_rec_end_date#58,i_item_desc#59,i_current_price#60,i_wholesale_cost#61,i_brand_id#62,i_brand#63,i_class_id#64,i_class#65,i_category_id#66,i_category#67,i_manufact_id#68,i_manufact#69,i_size#70,i_formulation#71,i_color#72,i_units#73,i_container#74,i_manager_id#75,i_product_name#76] parquet, Statistics(sizeInBytes=85.2 MiB, rowCount=2.04E+5)\r\n```\r\n\r\nAfter this PR:\r\n\r\n```\r\n== Optimized Logical Plan ==\r\nProject [i_item_sk#4 AS ss_item_sk#54], Statistics(sizeInBytes=2.3 MiB, rowCount=2.02E+5)\r\n+- Join Inner, (((i_brand_id#11 = brand_id#51) AND (i_class_id#13 = class_id#52)) AND (i_category_id#15 = category_id#53)), Statistics(sizeInBytes=7.0 MiB, rowCount=2.02E+5)\r\n   :- Project [i_item_sk#4, i_brand_id#11, i_class_id#13, i_category_id#15], Statistics(sizeInBytes=4.6 MiB, rowCount=2.02E+5)\r\n   :  +- Filter ((isnotnull(i_brand_id#11) AND isnotnull(i_class_id#13)) AND isnotnull(i_category_id#15)), Statistics(sizeInBytes=84.6 MiB, rowCount=2.02E+5)\r\n   :     +- Relation spark_catalog.default.item[i_item_sk#4,i_item_id#5,i_rec_start_date#6,i_rec_end_date#7,i_item_desc#8,i_current_price#9,i_wholesale_cost#10,i_brand_id#11,i_brand#12,i_class_id#13,i_class#14,i_category_id#15,i_category#16,i_manufact_id#17,i_manufact#18,i_size#19,i_formulation#20,i_color#21,i_units#22,i_container#23,i_manager_id#24,i_product_name#25] parquet, Statistics(sizeInBytes=85.2 MiB, rowCount=2.04E+5)\r\n   +- Aggregate [brand_id#51, class_id#52, category_id#53], [brand_id#51, class_id#52, category_id#53], Statistics(sizeInBytes=2.6 MiB, rowCount=1.37E+5)\r\n      +- Project [i_brand_id#62 AS brand_id#51, i_class_id#64 AS class_id#52, i_category_id#66 AS category_id#53], Statistics(sizeInBytes=3.9 MiB, rowCount=2.02E+5)\r\n         +- Filter ((isnotnull(i_brand_id#62) AND isnotnull(i_class_id#64)) AND isnotnull(i_category_id#66)), Statistics(sizeInBytes=84.6 MiB, rowCount=2.02E+5)\r\n            +- Relation spark_catalog.default.item[i_item_sk#55,i_item_id#56,i_rec_start_date#57,i_rec_end_date#58,i_item_desc#59,i_current_price#60,i_wholesale_cost#61,i_brand_id#62,i_brand#63,i_class_id#64,i_class#65,i_category_id#66,i_category#67,i_manufact_id#68,i_manufact#69,i_size#70,i_formulation#71,i_color#72,i_units#73,i_container#74,i_manager_id#75,i_product_name#76] parquet, Statistics(sizeInBytes=85.2 MiB, rowCount=2.04E+5)\r\n```\r\n\r\n### Why are the changes needed?\r\nPlan more broadcast joins to improve query performance.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nUnit test and TPC-DS benchmark test.\r\n\r\nSQL\tBefore this PR(Seconds)\tAfter this PR(Seconds)\r\nq14a\t187 \t164\r\n","created_at":"2023-02-07T07:04:43Z","updated_at":"2023-02-17T10:35:43Z","closed_at":"2023-02-17T04:48:09Z","merged_at":null,"merge_commit_sha":"ff1b1c0d97c896c1779a3caacf45e7518f4b4c80","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39923/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39923/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39923/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/36e0de3981aa76a9eecf1a1b729bcb33e58aa62a","head":{"label":"wankunde:SPARK-39851","ref":"SPARK-39851","sha":"36e0de3981aa76a9eecf1a1b729bcb33e58aa62a","user":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":260172941,"node_id":"MDEwOlJlcG9zaXRvcnkyNjAxNzI5NDE=","name":"spark","full_name":"wankunde/spark","private":false,"owner":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/wankunde/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/wankunde/spark","forks_url":"https://api.github.com/repos/wankunde/spark/forks","keys_url":"https://api.github.com/repos/wankunde/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/wankunde/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/wankunde/spark/teams","hooks_url":"https://api.github.com/repos/wankunde/spark/hooks","issue_events_url":"https://api.github.com/repos/wankunde/spark/issues/events{/number}","events_url":"https://api.github.com/repos/wankunde/spark/events","assignees_url":"https://api.github.com/repos/wankunde/spark/assignees{/user}","branches_url":"https://api.github.com/repos/wankunde/spark/branches{/branch}","tags_url":"https://api.github.com/repos/wankunde/spark/tags","blobs_url":"https://api.github.com/repos/wankunde/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/wankunde/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/wankunde/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/wankunde/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/wankunde/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/wankunde/spark/languages","stargazers_url":"https://api.github.com/repos/wankunde/spark/stargazers","contributors_url":"https://api.github.com/repos/wankunde/spark/contributors","subscribers_url":"https://api.github.com/repos/wankunde/spark/subscribers","subscription_url":"https://api.github.com/repos/wankunde/spark/subscription","commits_url":"https://api.github.com/repos/wankunde/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/wankunde/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/wankunde/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/wankunde/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/wankunde/spark/contents/{+path}","compare_url":"https://api.github.com/repos/wankunde/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/wankunde/spark/merges","archive_url":"https://api.github.com/repos/wankunde/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/wankunde/spark/downloads","issues_url":"https://api.github.com/repos/wankunde/spark/issues{/number}","pulls_url":"https://api.github.com/repos/wankunde/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/wankunde/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/wankunde/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/wankunde/spark/labels{/name}","releases_url":"https://api.github.com/repos/wankunde/spark/releases{/id}","deployments_url":"https://api.github.com/repos/wankunde/spark/deployments","created_at":"2020-04-30T09:47:54Z","updated_at":"2024-09-04T10:05:04Z","pushed_at":"2024-09-04T10:03:10Z","git_url":"git://github.com/wankunde/spark.git","ssh_url":"git@github.com:wankunde/spark.git","clone_url":"https://github.com/wankunde/spark.git","svn_url":"https://github.com/wankunde/spark","homepage":"https://spark.apache.org/","size":438528,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"6b6bb6fa20f40aeedea2fb87008e9cce76c54e28","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39923"},"html":{"href":"https://github.com/apache/spark/pull/39923"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39923"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39923/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39923/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39923/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/36e0de3981aa76a9eecf1a1b729bcb33e58aa62a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39922","id":1231502298,"node_id":"PR_kwDOAQXtWs5JZzva","html_url":"https://github.com/apache/spark/pull/39922","diff_url":"https://github.com/apache/spark/pull/39922.diff","patch_url":"https://github.com/apache/spark/pull/39922.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39922","number":39922,"state":"closed","locked":false,"title":"[SPARK-41708][SQL][FOLLOWUP] Do not insert columnar to row transition before write command","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis is a followup of https://github.com/apache/spark/pull/39277 . With planned write, the write command requires neither columnar nor row-based execution. It invokes a new API `executeWrite`, which returns commit messages, not columnar or row-based data.\r\n\r\nThis PR updates `ApplyColumnarRulesAndInsertTransitions` to take this case into consideration.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nIf people replaces `WriteFilesExec` with a columnar version, the plan can't be executed due to an extra columnar to row transition between `WriteFilesExee` and the write command.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nnew test","created_at":"2023-02-07T06:55:16Z","updated_at":"2023-02-07T12:13:53Z","closed_at":"2023-02-07T12:13:53Z","merged_at":null,"merge_commit_sha":"ac35807e80f6c4553004b4764d32b2968beea417","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39922/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39922/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39922/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b3e7691984e3db9e6166c644c9acfe1c917743cd","head":{"label":"cloud-fan:write","ref":"write","sha":"b3e7691984e3db9e6166c644c9acfe1c917743cd","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"6b6bb6fa20f40aeedea2fb87008e9cce76c54e28","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39922"},"html":{"href":"https://github.com/apache/spark/pull/39922"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39922"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39922/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39922/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39922/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b3e7691984e3db9e6166c644c9acfe1c917743cd"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39921","id":1231488585,"node_id":"PR_kwDOAQXtWs5JZwZJ","html_url":"https://github.com/apache/spark/pull/39921","diff_url":"https://github.com/apache/spark/pull/39921.diff","patch_url":"https://github.com/apache/spark/pull/39921.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39921","number":39921,"state":"closed","locked":false,"title":"[SPARK-42368][INFRA][TESTS] Exclude SparkRemoteFileTest from GitHub Action K8s IT job","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR aims to exclude `SparkRemoteFileTest` from K8s IT GitHub Action job.\r\n\r\n```\r\n$ git grep localTestTag\r\nresource-managers/kubernetes/integration-tests/src/test/scala/org/apache/spark/deploy/k8s/integrationtest/BasicTestsSuite.scala:  import KubernetesSuite.{k8sTestTag, localTestTag}\r\nresource-managers/kubernetes/integration-tests/src/test/scala/org/apache/spark/deploy/k8s/integrationtest/BasicTestsSuite.scala:  test(\"Run SparkRemoteFileTest using a remote data file\", k8sTestTag, localTestTag) {\r\nresource-managers/kubernetes/integration-tests/src/test/scala/org/apache/spark/deploy/k8s/integrationtest/KubernetesSuite.scala:  val localTestTag = Tag(\"local\")\r\n```\r\n\r\n### Why are the changes needed?\r\n\r\nSince #39697 , I've been monitoring this job. The test is too flaky in GitHub Action environment due to the limited resources and slowness.\r\n\r\n**MASTER**\r\n- https://github.com/apache/spark/actions/runs/4110706261/jobs/7093797830\r\n- https://github.com/apache/spark/actions/runs/4110355193/jobs/7093093588\r\n\r\n**BRANCH-3.4**\r\n- https://github.com/apache/spark/actions/runs/4110731960/jobs/7093844949\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo. This is a test infra PR.\r\n\r\n### How was this patch tested?\r\n\r\nPass the CIs.","created_at":"2023-02-07T06:36:57Z","updated_at":"2023-02-07T07:34:54Z","closed_at":"2023-02-07T07:34:37Z","merged_at":null,"merge_commit_sha":"e8ef670224afb3c9444c893051566ff9908a5404","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1982110661,"node_id":"MDU6TGFiZWwxOTgyMTEwNjYx","url":"https://api.github.com/repos/apache/spark/labels/INFRA","name":"INFRA","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39921/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39921/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39921/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6b151e93f8918a7eb69c08c982f75c414cd74851","head":{"label":"dongjoon-hyun:SPARK-42368","ref":"SPARK-42368","sha":"6b151e93f8918a7eb69c08c982f75c414cd74851","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"54b5cf687b838a5ed9af43d566ef3c7320fb37d8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39921"},"html":{"href":"https://github.com/apache/spark/pull/39921"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39921"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39921/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39921/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39921/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6b151e93f8918a7eb69c08c982f75c414cd74851"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39920","id":1231391881,"node_id":"PR_kwDOAQXtWs5JZYyJ","html_url":"https://github.com/apache/spark/pull/39920","diff_url":"https://github.com/apache/spark/pull/39920.diff","patch_url":"https://github.com/apache/spark/pull/39920.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39920","number":39920,"state":"closed","locked":false,"title":"[SPARK-41716][CONNECT] Rename _catalog_to_pandas to _execute_and_fetch in Catalog","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to rename `_catalog_to_pandas` to `_execute_and_fetch`, and remove the JIRA in the comment.\r\n\r\n### Why are the changes needed?\r\n\r\nI tried to factor this out to the client but I realised that there won't be too much difference.\r\nIn addition, we need a new design for Catalog API so I proposed to remove the JIRA for now.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nExisting test cases should cover.","created_at":"2023-02-07T04:15:36Z","updated_at":"2024-01-15T00:48:55Z","closed_at":"2023-02-07T08:34:03Z","merged_at":null,"merge_commit_sha":"8862b289e4faaf56892ccf0c65d55b6d8442e313","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39920/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39920/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39920/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/82f963e1e0846d5d5ec7754c85805c8eb0df84c4","head":{"label":"HyukjinKwon:SPARK-41716-1","ref":"SPARK-41716-1","sha":"82f963e1e0846d5d5ec7754c85805c8eb0df84c4","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"6b6bb6fa20f40aeedea2fb87008e9cce76c54e28","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39920"},"html":{"href":"https://github.com/apache/spark/pull/39920"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39920"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39920/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39920/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39920/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/82f963e1e0846d5d5ec7754c85805c8eb0df84c4"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39919","id":1231346491,"node_id":"PR_kwDOAQXtWs5JZNs7","html_url":"https://github.com/apache/spark/pull/39919","diff_url":"https://github.com/apache/spark/pull/39919.diff","patch_url":"https://github.com/apache/spark/pull/39919.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39919","number":39919,"state":"closed","locked":false,"title":"[SPARK-41600][SPARK-41623][SPARK-41612][CONNECT] Implement Catalog.cacheTable, isCached and uncache","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR adds three API below to Spark Connect\r\n- `Catalog.isCached`\r\n- `Catalog.cacheTable`\r\n- `Catalog uncacheTable`\r\n\r\n### Why are the changes needed?\r\n\r\nThese were not added because of the design concern (in its behaviour). However, we should provide the same API compatibility and behaivours with the regular PySpark in any event. So these are proposed back.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo to end users.\r\nYes to the dev because it adds three new API in Spark Connect.\r\n\r\n### How was this patch tested?\r\n\r\nUnittests were added.\r\n","created_at":"2023-02-07T03:10:33Z","updated_at":"2024-01-15T00:48:56Z","closed_at":"2023-02-07T06:27:24Z","merged_at":null,"merge_commit_sha":"f344259dc392d2f67e75d1acb9abac43ec7a38f1","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39919/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39919/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39919/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/bae11a1153755b607975bad6003bfd0623cbacee","head":{"label":"HyukjinKwon:SPARK-41600-SPARK-41623-SPARK-41612","ref":"SPARK-41600-SPARK-41623-SPARK-41612","sha":"bae11a1153755b607975bad6003bfd0623cbacee","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"9b51f54cb883196db95ddd300cc94d840ed390b2","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39919"},"html":{"href":"https://github.com/apache/spark/pull/39919"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39919"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39919/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39919/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39919/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/bae11a1153755b607975bad6003bfd0623cbacee"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39918","id":1231336574,"node_id":"PR_kwDOAQXtWs5JZLR-","html_url":"https://github.com/apache/spark/pull/39918","diff_url":"https://github.com/apache/spark/pull/39918.diff","patch_url":"https://github.com/apache/spark/pull/39918.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39918","number":39918,"state":"closed","locked":false,"title":"[SPARK-42366][SHUFFLE] Log shuffle data corruption diagnose cause","user":{"login":"cxzl25","id":3898450,"node_id":"MDQ6VXNlcjM4OTg0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/3898450?v=4","gravatar_id":"","url":"https://api.github.com/users/cxzl25","html_url":"https://github.com/cxzl25","followers_url":"https://api.github.com/users/cxzl25/followers","following_url":"https://api.github.com/users/cxzl25/following{/other_user}","gists_url":"https://api.github.com/users/cxzl25/gists{/gist_id}","starred_url":"https://api.github.com/users/cxzl25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cxzl25/subscriptions","organizations_url":"https://api.github.com/users/cxzl25/orgs","repos_url":"https://api.github.com/users/cxzl25/repos","events_url":"https://api.github.com/users/cxzl25/events{/privacy}","received_events_url":"https://api.github.com/users/cxzl25/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nOutput the cause in the `diagnoseCorruption` method.\r\n\r\n\r\n### Why are the changes needed?\r\nIt is convenient to collect the reason of shuffle corruption from the shuffle service Log deployed by YARN Nodemanager.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nexist UT\r\n","created_at":"2023-02-07T02:55:27Z","updated_at":"2023-02-09T17:15:03Z","closed_at":"2023-02-09T16:36:21Z","merged_at":null,"merge_commit_sha":"b3ac0e8bdb3188c17a5cdd51e46944884af594be","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39918/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39918/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39918/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1f5d182e5765ecce5d23c8b06ae0b02662c512c2","head":{"label":"cxzl25:SPARK-42366","ref":"SPARK-42366","sha":"1f5d182e5765ecce5d23c8b06ae0b02662c512c2","user":{"login":"cxzl25","id":3898450,"node_id":"MDQ6VXNlcjM4OTg0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/3898450?v=4","gravatar_id":"","url":"https://api.github.com/users/cxzl25","html_url":"https://github.com/cxzl25","followers_url":"https://api.github.com/users/cxzl25/followers","following_url":"https://api.github.com/users/cxzl25/following{/other_user}","gists_url":"https://api.github.com/users/cxzl25/gists{/gist_id}","starred_url":"https://api.github.com/users/cxzl25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cxzl25/subscriptions","organizations_url":"https://api.github.com/users/cxzl25/orgs","repos_url":"https://api.github.com/users/cxzl25/repos","events_url":"https://api.github.com/users/cxzl25/events{/privacy}","received_events_url":"https://api.github.com/users/cxzl25/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":119043888,"node_id":"MDEwOlJlcG9zaXRvcnkxMTkwNDM4ODg=","name":"spark","full_name":"cxzl25/spark","private":false,"owner":{"login":"cxzl25","id":3898450,"node_id":"MDQ6VXNlcjM4OTg0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/3898450?v=4","gravatar_id":"","url":"https://api.github.com/users/cxzl25","html_url":"https://github.com/cxzl25","followers_url":"https://api.github.com/users/cxzl25/followers","following_url":"https://api.github.com/users/cxzl25/following{/other_user}","gists_url":"https://api.github.com/users/cxzl25/gists{/gist_id}","starred_url":"https://api.github.com/users/cxzl25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cxzl25/subscriptions","organizations_url":"https://api.github.com/users/cxzl25/orgs","repos_url":"https://api.github.com/users/cxzl25/repos","events_url":"https://api.github.com/users/cxzl25/events{/privacy}","received_events_url":"https://api.github.com/users/cxzl25/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cxzl25/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cxzl25/spark","forks_url":"https://api.github.com/repos/cxzl25/spark/forks","keys_url":"https://api.github.com/repos/cxzl25/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cxzl25/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cxzl25/spark/teams","hooks_url":"https://api.github.com/repos/cxzl25/spark/hooks","issue_events_url":"https://api.github.com/repos/cxzl25/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cxzl25/spark/events","assignees_url":"https://api.github.com/repos/cxzl25/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cxzl25/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cxzl25/spark/tags","blobs_url":"https://api.github.com/repos/cxzl25/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cxzl25/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cxzl25/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cxzl25/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cxzl25/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cxzl25/spark/languages","stargazers_url":"https://api.github.com/repos/cxzl25/spark/stargazers","contributors_url":"https://api.github.com/repos/cxzl25/spark/contributors","subscribers_url":"https://api.github.com/repos/cxzl25/spark/subscribers","subscription_url":"https://api.github.com/repos/cxzl25/spark/subscription","commits_url":"https://api.github.com/repos/cxzl25/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cxzl25/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cxzl25/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cxzl25/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cxzl25/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cxzl25/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cxzl25/spark/merges","archive_url":"https://api.github.com/repos/cxzl25/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cxzl25/spark/downloads","issues_url":"https://api.github.com/repos/cxzl25/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cxzl25/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cxzl25/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cxzl25/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cxzl25/spark/labels{/name}","releases_url":"https://api.github.com/repos/cxzl25/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cxzl25/spark/deployments","created_at":"2018-01-26T11:26:14Z","updated_at":"2024-12-27T09:40:45Z","pushed_at":"2025-01-17T03:20:50Z","git_url":"git://github.com/cxzl25/spark.git","ssh_url":"git@github.com:cxzl25/spark.git","clone_url":"https://github.com/cxzl25/spark.git","svn_url":"https://github.com/cxzl25/spark","homepage":null,"size":463865,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"286d3364ab258e68b4dd0df8bc0980645119d222","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39918"},"html":{"href":"https://github.com/apache/spark/pull/39918"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39918"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39918/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39918/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39918/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1f5d182e5765ecce5d23c8b06ae0b02662c512c2"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39917","id":1231326643,"node_id":"PR_kwDOAQXtWs5JZI2z","html_url":"https://github.com/apache/spark/pull/39917","diff_url":"https://github.com/apache/spark/pull/39917.diff","patch_url":"https://github.com/apache/spark/pull/39917.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39917","number":39917,"state":"closed","locked":false,"title":"[SPARK-42365][PS][TESTS] Split 'pyspark.pandas.tests.test_ops_on_diff_frames'","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nSplit 'pyspark.pandas.tests.test_ops_on_diff_frames'\r\n\r\n\r\n### Why are the changes needed?\r\nit may take more than 15min sometimes\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo, test-only\r\n\r\n\r\n### How was this patch tested?\r\nupdated UT\r\n\r\nin my local env: 145sec -> 75sec + 78sec","created_at":"2023-02-07T02:35:24Z","updated_at":"2023-02-07T08:49:43Z","closed_at":"2023-02-07T08:35:03Z","merged_at":null,"merge_commit_sha":"cc94f87d44fb11c837617a2ccde9d6c3593124f3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4138679613,"node_id":"LA_kwDOAQXtWs72rz09","url":"https://api.github.com/repos/apache/spark/labels/PANDAS%20API%20ON%20SPARK","name":"PANDAS API ON SPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39917/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39917/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39917/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/718a0d85fd2b97db27d23cd014dbd9cc078de3d6","head":{"label":"zhengruifeng:ps_split_ops_on_diff_frames","ref":"ps_split_ops_on_diff_frames","sha":"718a0d85fd2b97db27d23cd014dbd9cc078de3d6","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"286d3364ab258e68b4dd0df8bc0980645119d222","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39917"},"html":{"href":"https://github.com/apache/spark/pull/39917"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39917"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39917/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39917/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39917/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/718a0d85fd2b97db27d23cd014dbd9cc078de3d6"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39916","id":1231318119,"node_id":"PR_kwDOAQXtWs5JZGxn","html_url":"https://github.com/apache/spark/pull/39916","diff_url":"https://github.com/apache/spark/pull/39916.diff","patch_url":"https://github.com/apache/spark/pull/39916.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39916","number":39916,"state":"closed","locked":false,"title":"[SPARK-42363][CONNECT] Remove SparkSession.register_udf","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to remove `SparkSession.register_udf` and `pyspark.sql.connect.function_builder`.\r\n\r\n### Why are the changes needed?\r\n\r\n- For API parity w/ regular PySpark.\r\n- They have to be implemented via `SparkSession.udf` (SPARK-41843).\r\n- For non-registered Python and Pandas UDFs, they are implemented at SPARK-42124 and SPARK-42125.\r\n- We implemented all functions so we do not need `pyspark.sql.connect.function_builder` workaround anymore.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo to end users.\r\n\r\nYee to the dev because it removes an API `SparkSession.register_udf` and `pyspark.sql.connect.function_builder`.\r\n\r\n### How was this patch tested?\r\n\r\nCI in this PR should verify them","created_at":"2023-02-07T02:18:28Z","updated_at":"2024-01-15T00:48:56Z","closed_at":"2023-02-07T05:31:09Z","merged_at":null,"merge_commit_sha":"89e767a8b783f644563ec41c8c1f213cd02d3496","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39916/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39916/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39916/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/cdbdeb0f8fc8b756fc74162727e363764f114544","head":{"label":"HyukjinKwon:remove-register-udf","ref":"remove-register-udf","sha":"cdbdeb0f8fc8b756fc74162727e363764f114544","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"286d3364ab258e68b4dd0df8bc0980645119d222","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39916"},"html":{"href":"https://github.com/apache/spark/pull/39916"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39916"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39916/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39916/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39916/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/cdbdeb0f8fc8b756fc74162727e363764f114544"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39915","id":1231317495,"node_id":"PR_kwDOAQXtWs5JZGn3","html_url":"https://github.com/apache/spark/pull/39915","diff_url":"https://github.com/apache/spark/pull/39915.diff","patch_url":"https://github.com/apache/spark/pull/39915.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39915","number":39915,"state":"closed","locked":false,"title":"[SPARK-42364][PS][TESTS] Split 'pyspark.pandas.tests.test_dataframe'","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nSplit 'pyspark.pandas.tests.test_dataframe'\r\n\r\n\r\n### Why are the changes needed?\r\n'pyspark.pandas.tests.test_dataframe' is too large: more than 7K lines, may take >15min sometimes\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo, test-only\r\n\r\n### How was this patch tested?\r\nupdated UT\r\n\r\nin my local env: 175 sec -> 95 sec + 102 sec","created_at":"2023-02-07T02:17:11Z","updated_at":"2023-02-07T08:50:01Z","closed_at":"2023-02-07T05:39:07Z","merged_at":null,"merge_commit_sha":"e417df0285b6fc3c174f955ec62c79789189b3d4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4138679613,"node_id":"LA_kwDOAQXtWs72rz09","url":"https://api.github.com/repos/apache/spark/labels/PANDAS%20API%20ON%20SPARK","name":"PANDAS API ON SPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39915/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39915/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39915/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/712856100100e4f060863eed4ca0472335059fd6","head":{"label":"zhengruifeng:ps_split_test_df","ref":"ps_split_test_df","sha":"712856100100e4f060863eed4ca0472335059fd6","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"3e40b38bcc9d4529dcd868d67e079330b93c464e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39915"},"html":{"href":"https://github.com/apache/spark/pull/39915"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39915"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39915/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39915/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39915/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/712856100100e4f060863eed4ca0472335059fd6"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39914","id":1231307661,"node_id":"PR_kwDOAQXtWs5JZEON","html_url":"https://github.com/apache/spark/pull/39914","diff_url":"https://github.com/apache/spark/pull/39914.diff","patch_url":"https://github.com/apache/spark/pull/39914.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39914","number":39914,"state":"closed","locked":false,"title":"[SPARK-40532][CONNECT] Add Python Version into Python UDF message","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR adds the Python version from the remote client.\r\n\r\nSee also:\r\n\r\nhttps://github.com/apache/spark/blob/56c7cf33929d7d42b7d299c0bb7e895963241214/python/pyspark/context.py#L312\r\n\r\nhttps://github.com/apache/spark/blob/603dc5098217d9580f611873165d25392f41cdfe/python/pyspark/worker.py#L682-L691\r\n\r\n### Why are the changes needed?\r\n\r\nIn order to make sure to run it in the same Python version of executors.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo to end users.\r\nYes for the dev. Now other Python versions can be used for Spark Connect.\r\n\r\n### How was this patch tested?\r\n\r\nManually tested.","created_at":"2023-02-07T02:03:08Z","updated_at":"2024-01-15T00:48:55Z","closed_at":"2023-02-07T08:31:33Z","merged_at":null,"merge_commit_sha":"d20c4a9fa41a83923f3752f1c5c12d6abe7dc79f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39914/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39914/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39914/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5c9266d7a9289f627d57e1f62848b4a0af884cda","head":{"label":"HyukjinKwon:SPARK-40532","ref":"SPARK-40532","sha":"5c9266d7a9289f627d57e1f62848b4a0af884cda","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"6b6bb6fa20f40aeedea2fb87008e9cce76c54e28","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39914"},"html":{"href":"https://github.com/apache/spark/pull/39914"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39914"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39914/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39914/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39914/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5c9266d7a9289f627d57e1f62848b4a0af884cda"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39913","id":1231286825,"node_id":"PR_kwDOAQXtWs5JY_Ip","html_url":"https://github.com/apache/spark/pull/39913","diff_url":"https://github.com/apache/spark/pull/39913.diff","patch_url":"https://github.com/apache/spark/pull/39913.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39913","number":39913,"state":"closed","locked":false,"title":"[SPARK-42268][CONNECT][PYTHON][TESTS][FOLLOWUP] Add `test_simple_udt` for `UserDefinedType`","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nadd more tests for UDT\r\n\r\n\r\n### Why are the changes needed?\r\nhttps://github.com/apache/spark/pull/39835 added tests for UDT for this conversion: \r\nUDT in Server -> proto -> UDT in Python Client\r\n\r\nAs per @xinrong-meng 's suggestion, this PR adds more tests to cover this: \r\nUDT in Python Client -> proto -> UDT in Server -> proto -> UDT in Python Client\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo, test-only\r\n\r\n\r\n### How was this patch tested?\r\nadded UT","created_at":"2023-02-07T01:29:07Z","updated_at":"2023-02-07T05:17:00Z","closed_at":"2023-02-07T05:04:29Z","merged_at":null,"merge_commit_sha":"fb6f4b771f97f31514812b60991c9c5fc268496d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39913/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39913/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39913/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/56d70afcf1703ffe43f65d78c702fffe9bee9851","head":{"label":"zhengruifeng:connect_more_test_udt","ref":"connect_more_test_udt","sha":"56d70afcf1703ffe43f65d78c702fffe9bee9851","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"3e40b38bcc9d4529dcd868d67e079330b93c464e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39913"},"html":{"href":"https://github.com/apache/spark/pull/39913"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39913"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39913/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39913/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39913/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/56d70afcf1703ffe43f65d78c702fffe9bee9851"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39912","id":1231093589,"node_id":"PR_kwDOAQXtWs5JYP9V","html_url":"https://github.com/apache/spark/pull/39912","diff_url":"https://github.com/apache/spark/pull/39912.diff","patch_url":"https://github.com/apache/spark/pull/39912.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39912","number":39912,"state":"closed","locked":false,"title":"[SPARK-42362][BUILD] Upgrade `kubernetes-client` to 6.4.1","user":{"login":"bjornjorgensen","id":47577197,"node_id":"MDQ6VXNlcjQ3NTc3MTk3","avatar_url":"https://avatars.githubusercontent.com/u/47577197?v=4","gravatar_id":"","url":"https://api.github.com/users/bjornjorgensen","html_url":"https://github.com/bjornjorgensen","followers_url":"https://api.github.com/users/bjornjorgensen/followers","following_url":"https://api.github.com/users/bjornjorgensen/following{/other_user}","gists_url":"https://api.github.com/users/bjornjorgensen/gists{/gist_id}","starred_url":"https://api.github.com/users/bjornjorgensen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bjornjorgensen/subscriptions","organizations_url":"https://api.github.com/users/bjornjorgensen/orgs","repos_url":"https://api.github.com/users/bjornjorgensen/repos","events_url":"https://api.github.com/users/bjornjorgensen/events{/privacy}","received_events_url":"https://api.github.com/users/bjornjorgensen/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nUpgrade kubernetes-client from 6.4.0 to 6.4.1\r\n\r\n### Why are the changes needed?\r\nNew version of kubernetes client, witch fix some bugs. \r\n\r\n[Release notes](https://github.com/fabric8io/kubernetes-client/releases/tag/v6.4.1) \r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nPass GA.","created_at":"2023-02-06T21:29:52Z","updated_at":"2023-02-07T03:52:24Z","closed_at":"2023-02-07T03:52:24Z","merged_at":null,"merge_commit_sha":"010d80760434487636c5d7e3faa3634da73b21d1","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39912/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39912/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39912/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f11b2ac685c854426d98b4ab9055edef2e0176db","head":{"label":"bjornjorgensen:kubernetes-client.version6_4_1","ref":"kubernetes-client.version6_4_1","sha":"f11b2ac685c854426d98b4ab9055edef2e0176db","user":{"login":"bjornjorgensen","id":47577197,"node_id":"MDQ6VXNlcjQ3NTc3MTk3","avatar_url":"https://avatars.githubusercontent.com/u/47577197?v=4","gravatar_id":"","url":"https://api.github.com/users/bjornjorgensen","html_url":"https://github.com/bjornjorgensen","followers_url":"https://api.github.com/users/bjornjorgensen/followers","following_url":"https://api.github.com/users/bjornjorgensen/following{/other_user}","gists_url":"https://api.github.com/users/bjornjorgensen/gists{/gist_id}","starred_url":"https://api.github.com/users/bjornjorgensen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bjornjorgensen/subscriptions","organizations_url":"https://api.github.com/users/bjornjorgensen/orgs","repos_url":"https://api.github.com/users/bjornjorgensen/repos","events_url":"https://api.github.com/users/bjornjorgensen/events{/privacy}","received_events_url":"https://api.github.com/users/bjornjorgensen/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":479752228,"node_id":"R_kgDOHJhwJA","name":"spark","full_name":"bjornjorgensen/spark","private":false,"owner":{"login":"bjornjorgensen","id":47577197,"node_id":"MDQ6VXNlcjQ3NTc3MTk3","avatar_url":"https://avatars.githubusercontent.com/u/47577197?v=4","gravatar_id":"","url":"https://api.github.com/users/bjornjorgensen","html_url":"https://github.com/bjornjorgensen","followers_url":"https://api.github.com/users/bjornjorgensen/followers","following_url":"https://api.github.com/users/bjornjorgensen/following{/other_user}","gists_url":"https://api.github.com/users/bjornjorgensen/gists{/gist_id}","starred_url":"https://api.github.com/users/bjornjorgensen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bjornjorgensen/subscriptions","organizations_url":"https://api.github.com/users/bjornjorgensen/orgs","repos_url":"https://api.github.com/users/bjornjorgensen/repos","events_url":"https://api.github.com/users/bjornjorgensen/events{/privacy}","received_events_url":"https://api.github.com/users/bjornjorgensen/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bjornjorgensen/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/bjornjorgensen/spark","forks_url":"https://api.github.com/repos/bjornjorgensen/spark/forks","keys_url":"https://api.github.com/repos/bjornjorgensen/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bjornjorgensen/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bjornjorgensen/spark/teams","hooks_url":"https://api.github.com/repos/bjornjorgensen/spark/hooks","issue_events_url":"https://api.github.com/repos/bjornjorgensen/spark/issues/events{/number}","events_url":"https://api.github.com/repos/bjornjorgensen/spark/events","assignees_url":"https://api.github.com/repos/bjornjorgensen/spark/assignees{/user}","branches_url":"https://api.github.com/repos/bjornjorgensen/spark/branches{/branch}","tags_url":"https://api.github.com/repos/bjornjorgensen/spark/tags","blobs_url":"https://api.github.com/repos/bjornjorgensen/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bjornjorgensen/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bjornjorgensen/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/bjornjorgensen/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bjornjorgensen/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/bjornjorgensen/spark/languages","stargazers_url":"https://api.github.com/repos/bjornjorgensen/spark/stargazers","contributors_url":"https://api.github.com/repos/bjornjorgensen/spark/contributors","subscribers_url":"https://api.github.com/repos/bjornjorgensen/spark/subscribers","subscription_url":"https://api.github.com/repos/bjornjorgensen/spark/subscription","commits_url":"https://api.github.com/repos/bjornjorgensen/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/bjornjorgensen/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/bjornjorgensen/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/bjornjorgensen/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/bjornjorgensen/spark/contents/{+path}","compare_url":"https://api.github.com/repos/bjornjorgensen/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bjornjorgensen/spark/merges","archive_url":"https://api.github.com/repos/bjornjorgensen/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bjornjorgensen/spark/downloads","issues_url":"https://api.github.com/repos/bjornjorgensen/spark/issues{/number}","pulls_url":"https://api.github.com/repos/bjornjorgensen/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/bjornjorgensen/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/bjornjorgensen/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bjornjorgensen/spark/labels{/name}","releases_url":"https://api.github.com/repos/bjornjorgensen/spark/releases{/id}","deployments_url":"https://api.github.com/repos/bjornjorgensen/spark/deployments","created_at":"2022-04-09T14:34:52Z","updated_at":"2025-02-06T15:10:30Z","pushed_at":"2025-02-06T15:10:10Z","git_url":"git://github.com/bjornjorgensen/spark.git","ssh_url":"git@github.com:bjornjorgensen/spark.git","clone_url":"https://github.com/bjornjorgensen/spark.git","svn_url":"https://github.com/bjornjorgensen/spark","homepage":"https://spark.apache.org/","size":481895,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":47,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":3,"open_issues":47,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"3e40b38bcc9d4529dcd868d67e079330b93c464e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39912"},"html":{"href":"https://github.com/apache/spark/pull/39912"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39912"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39912/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39912/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39912/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f11b2ac685c854426d98b4ab9055edef2e0176db"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39911","id":1230963354,"node_id":"PR_kwDOAQXtWs5JXwKa","html_url":"https://github.com/apache/spark/pull/39911","diff_url":"https://github.com/apache/spark/pull/39911.diff","patch_url":"https://github.com/apache/spark/pull/39911.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39911","number":39911,"state":"closed","locked":false,"title":"[SPARK-36478][SQL][WIP] Optimize out unused left-outer Join under Project","user":{"login":"clubycoder","id":11688604,"node_id":"MDQ6VXNlcjExNjg4NjA0","avatar_url":"https://avatars.githubusercontent.com/u/11688604?v=4","gravatar_id":"","url":"https://api.github.com/users/clubycoder","html_url":"https://github.com/clubycoder","followers_url":"https://api.github.com/users/clubycoder/followers","following_url":"https://api.github.com/users/clubycoder/following{/other_user}","gists_url":"https://api.github.com/users/clubycoder/gists{/gist_id}","starred_url":"https://api.github.com/users/clubycoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clubycoder/subscriptions","organizations_url":"https://api.github.com/users/clubycoder/orgs","repos_url":"https://api.github.com/users/clubycoder/repos","events_url":"https://api.github.com/users/clubycoder/events{/privacy}","received_events_url":"https://api.github.com/users/clubycoder/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"This is an alternate approach to PR's previously submitted for - https://issues.apache.org/jira/browse/SPARK-36478\r\n\r\n\r\n### What changes were proposed in this pull request?\r\nThis PR adds an additional Join optimizer that will eliminate a left-outer join that is under a Project where the columns needed are on all the right side of the join.  In this case the join is removed and the right child of the Join is put directly under the Project.\r\n\r\n\r\n### Why are the changes needed?\r\nThis optimization is meant to optimize queries that don't depend on a left-outer join that has been applied to an upstream view.  The use-case is a group has standardized their analysis around a view that includes one or more left-outer joins to bring in additional columns that enhance the core data.  This view has been saved off and is now a blackbox for multiple downstream queries that are required to use this view for standardization.  Many of the queries on this view will not depend on columns coming from the view's left-joins.  If this joined columns are not being used, we should avoid doing the join and reading the joined dataset.\r\n\r\nFor example we would like:\r\n```\r\n== Optimized Logical Plan ==\r\nProject [timestamp#16L, customerId#17]\r\n+- Join LeftOuter, (productId#18 = productId_products_productId#64)\r\n   :- Project [timestamp#16L, customerId#17, productId#18]\r\n   :  +- Join LeftOuter, (customerId#17 = customerId_customers_customerId#58)\r\n   :     :- LocalRelation [timestamp#16L, customerId#17, productId#18]\r\n   :     +- LocalRelation [customerId_customers_customerId#58]\r\n   +- LocalRelation [productId_products_productId#64]\r\n```\r\nto become:\r\n```\r\n== Optimized Logical Plan ==\r\nLocalRelation [timestamp#16L, customerId#17]\r\n```\r\nbecause the columns that come from the joins are not being used.\r\n\r\n**NOTE**: The removal of the redundant Project(s) is handled by other existing optimizers.\r\n**ALSO NOTE**: In the above example the joined products and customers tables also provide additional metadata columns to the view that could be used, but they have already been removed from the plan by other column optimizers.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nThe only use-facing change would be the explain of a query that matches the plan optimization.  The optimized plan will have the left-outer join removed if the join is not used by the wrapping project.\r\n\r\n\r\n### How was this patch tested?\r\nAdditional tests added to JoinOptimizationSuite covering plans that match and don't match the optimization as well as tested manually.\r\n","created_at":"2023-02-06T19:45:25Z","updated_at":"2023-02-07T01:09:49Z","closed_at":"2023-02-07T01:09:48Z","merged_at":null,"merge_commit_sha":"4ffba5d72eb5a83b60f7dcb867f0cc8f40a860b8","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39911/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39911/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39911/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/70724701f4261d93d220ba5daaa01f25afdba5cb","head":{"label":"clubycoder:SPARK-36478","ref":"SPARK-36478","sha":"70724701f4261d93d220ba5daaa01f25afdba5cb","user":{"login":"clubycoder","id":11688604,"node_id":"MDQ6VXNlcjExNjg4NjA0","avatar_url":"https://avatars.githubusercontent.com/u/11688604?v=4","gravatar_id":"","url":"https://api.github.com/users/clubycoder","html_url":"https://github.com/clubycoder","followers_url":"https://api.github.com/users/clubycoder/followers","following_url":"https://api.github.com/users/clubycoder/following{/other_user}","gists_url":"https://api.github.com/users/clubycoder/gists{/gist_id}","starred_url":"https://api.github.com/users/clubycoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clubycoder/subscriptions","organizations_url":"https://api.github.com/users/clubycoder/orgs","repos_url":"https://api.github.com/users/clubycoder/repos","events_url":"https://api.github.com/users/clubycoder/events{/privacy}","received_events_url":"https://api.github.com/users/clubycoder/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":597137419,"node_id":"R_kgDOI5eYCw","name":"spark","full_name":"clubycoder/spark","private":false,"owner":{"login":"clubycoder","id":11688604,"node_id":"MDQ6VXNlcjExNjg4NjA0","avatar_url":"https://avatars.githubusercontent.com/u/11688604?v=4","gravatar_id":"","url":"https://api.github.com/users/clubycoder","html_url":"https://github.com/clubycoder","followers_url":"https://api.github.com/users/clubycoder/followers","following_url":"https://api.github.com/users/clubycoder/following{/other_user}","gists_url":"https://api.github.com/users/clubycoder/gists{/gist_id}","starred_url":"https://api.github.com/users/clubycoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clubycoder/subscriptions","organizations_url":"https://api.github.com/users/clubycoder/orgs","repos_url":"https://api.github.com/users/clubycoder/repos","events_url":"https://api.github.com/users/clubycoder/events{/privacy}","received_events_url":"https://api.github.com/users/clubycoder/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/clubycoder/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/clubycoder/spark","forks_url":"https://api.github.com/repos/clubycoder/spark/forks","keys_url":"https://api.github.com/repos/clubycoder/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/clubycoder/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/clubycoder/spark/teams","hooks_url":"https://api.github.com/repos/clubycoder/spark/hooks","issue_events_url":"https://api.github.com/repos/clubycoder/spark/issues/events{/number}","events_url":"https://api.github.com/repos/clubycoder/spark/events","assignees_url":"https://api.github.com/repos/clubycoder/spark/assignees{/user}","branches_url":"https://api.github.com/repos/clubycoder/spark/branches{/branch}","tags_url":"https://api.github.com/repos/clubycoder/spark/tags","blobs_url":"https://api.github.com/repos/clubycoder/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/clubycoder/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/clubycoder/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/clubycoder/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/clubycoder/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/clubycoder/spark/languages","stargazers_url":"https://api.github.com/repos/clubycoder/spark/stargazers","contributors_url":"https://api.github.com/repos/clubycoder/spark/contributors","subscribers_url":"https://api.github.com/repos/clubycoder/spark/subscribers","subscription_url":"https://api.github.com/repos/clubycoder/spark/subscription","commits_url":"https://api.github.com/repos/clubycoder/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/clubycoder/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/clubycoder/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/clubycoder/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/clubycoder/spark/contents/{+path}","compare_url":"https://api.github.com/repos/clubycoder/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/clubycoder/spark/merges","archive_url":"https://api.github.com/repos/clubycoder/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/clubycoder/spark/downloads","issues_url":"https://api.github.com/repos/clubycoder/spark/issues{/number}","pulls_url":"https://api.github.com/repos/clubycoder/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/clubycoder/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/clubycoder/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/clubycoder/spark/labels{/name}","releases_url":"https://api.github.com/repos/clubycoder/spark/releases{/id}","deployments_url":"https://api.github.com/repos/clubycoder/spark/deployments","created_at":"2023-02-03T17:58:52Z","updated_at":"2023-02-03T17:47:40Z","pushed_at":"2023-02-06T19:48:01Z","git_url":"git://github.com/clubycoder/spark.git","ssh_url":"git@github.com:clubycoder/spark.git","clone_url":"https://github.com/clubycoder/spark.git","svn_url":"https://github.com/clubycoder/spark","homepage":"https://spark.apache.org/","size":458764,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"3e40b38bcc9d4529dcd868d67e079330b93c464e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39911"},"html":{"href":"https://github.com/apache/spark/pull/39911"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39911"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39911/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39911/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39911/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/70724701f4261d93d220ba5daaa01f25afdba5cb"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39910","id":1230864138,"node_id":"PR_kwDOAQXtWs5JXX8K","html_url":"https://github.com/apache/spark/pull/39910","diff_url":"https://github.com/apache/spark/pull/39910.diff","patch_url":"https://github.com/apache/spark/pull/39910.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39910","number":39910,"state":"closed","locked":false,"title":"[SPARK-42337][SQL] Add error class INVALID_TEMP_OBJ_REFERENCE","user":{"login":"allisonwang-db","id":66282705,"node_id":"MDQ6VXNlcjY2MjgyNzA1","avatar_url":"https://avatars.githubusercontent.com/u/66282705?v=4","gravatar_id":"","url":"https://api.github.com/users/allisonwang-db","html_url":"https://github.com/allisonwang-db","followers_url":"https://api.github.com/users/allisonwang-db/followers","following_url":"https://api.github.com/users/allisonwang-db/following{/other_user}","gists_url":"https://api.github.com/users/allisonwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/allisonwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/allisonwang-db/subscriptions","organizations_url":"https://api.github.com/users/allisonwang-db/orgs","repos_url":"https://api.github.com/users/allisonwang-db/repos","events_url":"https://api.github.com/users/allisonwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/allisonwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR adds a new error class `INVALID_TEMP_OBJ_REFERENCE ` and replaces two existing error classes with this new one:\r\n- _LEGACY_ERROR_TEMP_1283\r\n- _LEGACY_ERROR_TEMP_1284\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo improve the error messages.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nYes, the PR changes a user-facing error message.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nExisting unit tests.","created_at":"2023-02-06T18:18:02Z","updated_at":"2023-02-18T07:22:18Z","closed_at":"2023-02-18T07:17:35Z","merged_at":null,"merge_commit_sha":"d5db04f263b906d3848ac3852485f9abe7635862","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39910/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39910/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39910/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a22481798c8fcea6ddf462b1bd46dd317fe4cc98","head":{"label":"allisonwang-db:spark-42337-persistent-over-temp-err","ref":"spark-42337-persistent-over-temp-err","sha":"a22481798c8fcea6ddf462b1bd46dd317fe4cc98","user":{"login":"allisonwang-db","id":66282705,"node_id":"MDQ6VXNlcjY2MjgyNzA1","avatar_url":"https://avatars.githubusercontent.com/u/66282705?v=4","gravatar_id":"","url":"https://api.github.com/users/allisonwang-db","html_url":"https://github.com/allisonwang-db","followers_url":"https://api.github.com/users/allisonwang-db/followers","following_url":"https://api.github.com/users/allisonwang-db/following{/other_user}","gists_url":"https://api.github.com/users/allisonwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/allisonwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/allisonwang-db/subscriptions","organizations_url":"https://api.github.com/users/allisonwang-db/orgs","repos_url":"https://api.github.com/users/allisonwang-db/repos","events_url":"https://api.github.com/users/allisonwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/allisonwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":271915022,"node_id":"MDEwOlJlcG9zaXRvcnkyNzE5MTUwMjI=","name":"spark","full_name":"allisonwang-db/spark","private":false,"owner":{"login":"allisonwang-db","id":66282705,"node_id":"MDQ6VXNlcjY2MjgyNzA1","avatar_url":"https://avatars.githubusercontent.com/u/66282705?v=4","gravatar_id":"","url":"https://api.github.com/users/allisonwang-db","html_url":"https://github.com/allisonwang-db","followers_url":"https://api.github.com/users/allisonwang-db/followers","following_url":"https://api.github.com/users/allisonwang-db/following{/other_user}","gists_url":"https://api.github.com/users/allisonwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/allisonwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/allisonwang-db/subscriptions","organizations_url":"https://api.github.com/users/allisonwang-db/orgs","repos_url":"https://api.github.com/users/allisonwang-db/repos","events_url":"https://api.github.com/users/allisonwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/allisonwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/allisonwang-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/allisonwang-db/spark","forks_url":"https://api.github.com/repos/allisonwang-db/spark/forks","keys_url":"https://api.github.com/repos/allisonwang-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/allisonwang-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/allisonwang-db/spark/teams","hooks_url":"https://api.github.com/repos/allisonwang-db/spark/hooks","issue_events_url":"https://api.github.com/repos/allisonwang-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/allisonwang-db/spark/events","assignees_url":"https://api.github.com/repos/allisonwang-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/allisonwang-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/allisonwang-db/spark/tags","blobs_url":"https://api.github.com/repos/allisonwang-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/allisonwang-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/allisonwang-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/allisonwang-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/allisonwang-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/allisonwang-db/spark/languages","stargazers_url":"https://api.github.com/repos/allisonwang-db/spark/stargazers","contributors_url":"https://api.github.com/repos/allisonwang-db/spark/contributors","subscribers_url":"https://api.github.com/repos/allisonwang-db/spark/subscribers","subscription_url":"https://api.github.com/repos/allisonwang-db/spark/subscription","commits_url":"https://api.github.com/repos/allisonwang-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/allisonwang-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/allisonwang-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/allisonwang-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/allisonwang-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/allisonwang-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/allisonwang-db/spark/merges","archive_url":"https://api.github.com/repos/allisonwang-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/allisonwang-db/spark/downloads","issues_url":"https://api.github.com/repos/allisonwang-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/allisonwang-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/allisonwang-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/allisonwang-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/allisonwang-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/allisonwang-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/allisonwang-db/spark/deployments","created_at":"2020-06-13T00:43:34Z","updated_at":"2025-01-07T02:25:07Z","pushed_at":"2025-01-24T00:00:13Z","git_url":"git://github.com/allisonwang-db/spark.git","ssh_url":"git@github.com:allisonwang-db/spark.git","clone_url":"https://github.com/allisonwang-db/spark.git","svn_url":"https://github.com/allisonwang-db/spark","homepage":"https://spark.apache.org/","size":467528,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"97a20edb25850015695ffe1a7246df55951ebd35","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39910"},"html":{"href":"https://github.com/apache/spark/pull/39910"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39910"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39910/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39910/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39910/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a22481798c8fcea6ddf462b1bd46dd317fe4cc98"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39909","id":1230636454,"node_id":"PR_kwDOAQXtWs5JWgWm","html_url":"https://github.com/apache/spark/pull/39909","diff_url":"https://github.com/apache/spark/pull/39909.diff","patch_url":"https://github.com/apache/spark/pull/39909.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39909","number":39909,"state":"closed","locked":false,"title":"[SPARK-42369][CORE] Fix constructor for java.nio.DirectByteBuffer","user":{"login":"luhenry","id":660779,"node_id":"MDQ6VXNlcjY2MDc3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/660779?v=4","gravatar_id":"","url":"https://api.github.com/users/luhenry","html_url":"https://github.com/luhenry","followers_url":"https://api.github.com/users/luhenry/followers","following_url":"https://api.github.com/users/luhenry/following{/other_user}","gists_url":"https://api.github.com/users/luhenry/gists{/gist_id}","starred_url":"https://api.github.com/users/luhenry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luhenry/subscriptions","organizations_url":"https://api.github.com/users/luhenry/orgs","repos_url":"https://api.github.com/users/luhenry/repos","events_url":"https://api.github.com/users/luhenry/events{/privacy}","received_events_url":"https://api.github.com/users/luhenry/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nIn the latest JDK, the constructor `DirectByteBuffer(long, int)` was replaced with `DirectByteBuffer(long, long)`. We just want to support both by probing for the legacy one first and falling back to the newer one second.\r\n\r\nThis change is completely transparent for the end-user, and makes sure Spark works transparently on the latest JDK as well.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nIt's required to support the latest versions of the JDK.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\nIt was built and ran locally against the newest JDK.\r\n","created_at":"2023-02-06T15:36:05Z","updated_at":"2023-02-25T09:43:45Z","closed_at":"2023-02-07T15:45:35Z","merged_at":null,"merge_commit_sha":"5863413c2dd9effa86e39089e1bb258cec2dded5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39909/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39909/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39909/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d639e91b701ebaab0f5ee706db566b9e81d46cf4","head":{"label":"luhenry:patch-2","ref":"patch-2","sha":"d639e91b701ebaab0f5ee706db566b9e81d46cf4","user":{"login":"luhenry","id":660779,"node_id":"MDQ6VXNlcjY2MDc3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/660779?v=4","gravatar_id":"","url":"https://api.github.com/users/luhenry","html_url":"https://github.com/luhenry","followers_url":"https://api.github.com/users/luhenry/followers","following_url":"https://api.github.com/users/luhenry/following{/other_user}","gists_url":"https://api.github.com/users/luhenry/gists{/gist_id}","starred_url":"https://api.github.com/users/luhenry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luhenry/subscriptions","organizations_url":"https://api.github.com/users/luhenry/orgs","repos_url":"https://api.github.com/users/luhenry/repos","events_url":"https://api.github.com/users/luhenry/events{/privacy}","received_events_url":"https://api.github.com/users/luhenry/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":320590912,"node_id":"MDEwOlJlcG9zaXRvcnkzMjA1OTA5MTI=","name":"spark","full_name":"luhenry/spark","private":false,"owner":{"login":"luhenry","id":660779,"node_id":"MDQ6VXNlcjY2MDc3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/660779?v=4","gravatar_id":"","url":"https://api.github.com/users/luhenry","html_url":"https://github.com/luhenry","followers_url":"https://api.github.com/users/luhenry/followers","following_url":"https://api.github.com/users/luhenry/following{/other_user}","gists_url":"https://api.github.com/users/luhenry/gists{/gist_id}","starred_url":"https://api.github.com/users/luhenry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luhenry/subscriptions","organizations_url":"https://api.github.com/users/luhenry/orgs","repos_url":"https://api.github.com/users/luhenry/repos","events_url":"https://api.github.com/users/luhenry/events{/privacy}","received_events_url":"https://api.github.com/users/luhenry/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/luhenry/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/luhenry/spark","forks_url":"https://api.github.com/repos/luhenry/spark/forks","keys_url":"https://api.github.com/repos/luhenry/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/luhenry/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/luhenry/spark/teams","hooks_url":"https://api.github.com/repos/luhenry/spark/hooks","issue_events_url":"https://api.github.com/repos/luhenry/spark/issues/events{/number}","events_url":"https://api.github.com/repos/luhenry/spark/events","assignees_url":"https://api.github.com/repos/luhenry/spark/assignees{/user}","branches_url":"https://api.github.com/repos/luhenry/spark/branches{/branch}","tags_url":"https://api.github.com/repos/luhenry/spark/tags","blobs_url":"https://api.github.com/repos/luhenry/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/luhenry/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/luhenry/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/luhenry/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/luhenry/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/luhenry/spark/languages","stargazers_url":"https://api.github.com/repos/luhenry/spark/stargazers","contributors_url":"https://api.github.com/repos/luhenry/spark/contributors","subscribers_url":"https://api.github.com/repos/luhenry/spark/subscribers","subscription_url":"https://api.github.com/repos/luhenry/spark/subscription","commits_url":"https://api.github.com/repos/luhenry/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/luhenry/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/luhenry/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/luhenry/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/luhenry/spark/contents/{+path}","compare_url":"https://api.github.com/repos/luhenry/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/luhenry/spark/merges","archive_url":"https://api.github.com/repos/luhenry/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/luhenry/spark/downloads","issues_url":"https://api.github.com/repos/luhenry/spark/issues{/number}","pulls_url":"https://api.github.com/repos/luhenry/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/luhenry/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/luhenry/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/luhenry/spark/labels{/name}","releases_url":"https://api.github.com/repos/luhenry/spark/releases{/id}","deployments_url":"https://api.github.com/repos/luhenry/spark/deployments","created_at":"2020-12-11T14:06:28Z","updated_at":"2021-12-23T09:04:57Z","pushed_at":"2023-02-07T08:41:10Z","git_url":"git://github.com/luhenry/spark.git","ssh_url":"git@github.com:luhenry/spark.git","clone_url":"https://github.com/luhenry/spark.git","svn_url":"https://github.com/luhenry/spark","homepage":"https://spark.apache.org/","size":444011,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"d5b0cb49f45ebb6ad9c9d288822ede4653d4a3a0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39909"},"html":{"href":"https://github.com/apache/spark/pull/39909"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39909"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39909/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39909/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39909/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d639e91b701ebaab0f5ee706db566b9e81d46cf4"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39908","id":1230548627,"node_id":"PR_kwDOAQXtWs5JWK6T","html_url":"https://github.com/apache/spark/pull/39908","diff_url":"https://github.com/apache/spark/pull/39908.diff","patch_url":"https://github.com/apache/spark/pull/39908.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39908","number":39908,"state":"closed","locked":false,"title":"[SPARK-42360][SQL] Transform LeftOuter join with IsNull filter on right side to Anti join","user":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nOptimize left outer join to anti join if exists IsNull filter on the right side.\r\nFor example, query\r\n```sql\r\nSELECT t1.*\r\nFROM t1 LEFT JOIN t2\r\nON t1.id = t2.id\r\nWHERE t2.id is null and t1.id = 1 and Rand() < 0.5\r\n```\r\ncan be optimized to\r\n```sql\r\nSELECT t1.*\r\nFROM t1 LEFT ANTI JOIN t2\r\nON t1.id = t2.id\r\nWHERE t1.id = 1 and Rand() < 0.5\r\n```\r\n\r\nPostgreSQL also has this optimization\r\n![image](https://github.com/apache/spark/assets/3626747/484eb224-5962-40fa-8544-65637c0d93fe)\r\n\r\n\r\n### Why are the changes needed?\r\n\r\nOptimize left outer join.\r\n\r\nLocal benchmark code:\r\n```\r\nobject LeftOuterToAntiJoinBenchmark extends SqlBasedBenchmark {\r\n\r\n  override def runBenchmarkSuite(mainArgs: Array[String]): Unit = {\r\n    runBenchmark(\"Compare left outer join to anti join\") {\r\n      spark.range(1, 100000, 1, 5)\r\n        .selectExpr(\"id%5 as id\")\r\n        .createOrReplaceTempView(\"tab\")\r\n      val testQuery =\r\n        s\"\"\"SELECT t1.*\r\n           |FROM tab t1\r\n           |LEFT OUTER JOIN tab t2\r\n           |ON t1.id = t2.id\r\n           |WHERE t2.id is null\r\n           |\"\"\".stripMargin\r\n      val benchmark =\r\n        new Benchmark(\"Compare left outer join to anti join\", 100000, output = output)\r\n      benchmark.addCase(s\"Left outer join result\") { _ =>\r\n        withSQLConf(SQLConf.OPTIMIZER_EXCLUDED_RULES.key ->\r\n          \"org.apache.spark.sql.catalyst.optimizer.EliminateOuterJoin\") {\r\n          val res = spark.sql(testQuery)\r\n          res.noop()\r\n        }\r\n      }\r\n      benchmark.addCase(s\"Anti join result\") { _ =>\r\n        val res = spark.sql(testQuery)\r\n        res.noop()\r\n      }\r\n      benchmark.run()\r\n    }\r\n  }\r\n}\r\n```\r\nbenchmark result\r\n```\r\nIntel(R) Core(TM) i9-9980HK CPU @ 2.40GHz\r\nCompare left outer join to anti join:     Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative\r\n------------------------------------------------------------------------------------------------------------------------\r\nLeft outer join result                             9500           9884         544          0.0       94997.6       1.0X\r\nAnti join result                                    287            356          80          0.3        2869.9      33.1X\r\n```\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo\r\n\r\n### How was this patch tested?\r\n\r\nAdded UT\r\n","created_at":"2023-02-06T14:44:21Z","updated_at":"2023-06-01T00:25:49Z","closed_at":"2023-06-01T00:25:49Z","merged_at":null,"merge_commit_sha":"33d17781c41337e86dc2c575751a62b1463be7d5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39908/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39908/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39908/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c73c4047ba2a4a19506b1294c4be1a67ccde11c9","head":{"label":"wankunde:outer_to_anti_join","ref":"outer_to_anti_join","sha":"c73c4047ba2a4a19506b1294c4be1a67ccde11c9","user":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":260172941,"node_id":"MDEwOlJlcG9zaXRvcnkyNjAxNzI5NDE=","name":"spark","full_name":"wankunde/spark","private":false,"owner":{"login":"wankunde","id":3626747,"node_id":"MDQ6VXNlcjM2MjY3NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3626747?v=4","gravatar_id":"","url":"https://api.github.com/users/wankunde","html_url":"https://github.com/wankunde","followers_url":"https://api.github.com/users/wankunde/followers","following_url":"https://api.github.com/users/wankunde/following{/other_user}","gists_url":"https://api.github.com/users/wankunde/gists{/gist_id}","starred_url":"https://api.github.com/users/wankunde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wankunde/subscriptions","organizations_url":"https://api.github.com/users/wankunde/orgs","repos_url":"https://api.github.com/users/wankunde/repos","events_url":"https://api.github.com/users/wankunde/events{/privacy}","received_events_url":"https://api.github.com/users/wankunde/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/wankunde/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/wankunde/spark","forks_url":"https://api.github.com/repos/wankunde/spark/forks","keys_url":"https://api.github.com/repos/wankunde/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/wankunde/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/wankunde/spark/teams","hooks_url":"https://api.github.com/repos/wankunde/spark/hooks","issue_events_url":"https://api.github.com/repos/wankunde/spark/issues/events{/number}","events_url":"https://api.github.com/repos/wankunde/spark/events","assignees_url":"https://api.github.com/repos/wankunde/spark/assignees{/user}","branches_url":"https://api.github.com/repos/wankunde/spark/branches{/branch}","tags_url":"https://api.github.com/repos/wankunde/spark/tags","blobs_url":"https://api.github.com/repos/wankunde/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/wankunde/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/wankunde/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/wankunde/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/wankunde/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/wankunde/spark/languages","stargazers_url":"https://api.github.com/repos/wankunde/spark/stargazers","contributors_url":"https://api.github.com/repos/wankunde/spark/contributors","subscribers_url":"https://api.github.com/repos/wankunde/spark/subscribers","subscription_url":"https://api.github.com/repos/wankunde/spark/subscription","commits_url":"https://api.github.com/repos/wankunde/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/wankunde/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/wankunde/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/wankunde/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/wankunde/spark/contents/{+path}","compare_url":"https://api.github.com/repos/wankunde/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/wankunde/spark/merges","archive_url":"https://api.github.com/repos/wankunde/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/wankunde/spark/downloads","issues_url":"https://api.github.com/repos/wankunde/spark/issues{/number}","pulls_url":"https://api.github.com/repos/wankunde/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/wankunde/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/wankunde/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/wankunde/spark/labels{/name}","releases_url":"https://api.github.com/repos/wankunde/spark/releases{/id}","deployments_url":"https://api.github.com/repos/wankunde/spark/deployments","created_at":"2020-04-30T09:47:54Z","updated_at":"2024-09-04T10:05:04Z","pushed_at":"2024-09-04T10:03:10Z","git_url":"git://github.com/wankunde/spark.git","ssh_url":"git@github.com:wankunde/spark.git","clone_url":"https://github.com/wankunde/spark.git","svn_url":"https://github.com/wankunde/spark","homepage":"https://spark.apache.org/","size":438528,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"64aef23d9a8c4f9222d6cf9994545157487f78b1","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39908"},"html":{"href":"https://github.com/apache/spark/pull/39908"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39908"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39908/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39908/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39908/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c73c4047ba2a4a19506b1294c4be1a67ccde11c9"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39907","id":1230505505,"node_id":"PR_kwDOAQXtWs5JWAYh","html_url":"https://github.com/apache/spark/pull/39907","diff_url":"https://github.com/apache/spark/pull/39907.diff","patch_url":"https://github.com/apache/spark/pull/39907.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39907","number":39907,"state":"closed","locked":false,"title":"[SPARK-42359][SQL] Support row skipping when reading CSV files","user":{"login":"ted-jenks","id":77486246,"node_id":"MDQ6VXNlcjc3NDg2MjQ2","avatar_url":"https://avatars.githubusercontent.com/u/77486246?v=4","gravatar_id":"","url":"https://api.github.com/users/ted-jenks","html_url":"https://github.com/ted-jenks","followers_url":"https://api.github.com/users/ted-jenks/followers","following_url":"https://api.github.com/users/ted-jenks/following{/other_user}","gists_url":"https://api.github.com/users/ted-jenks/gists{/gist_id}","starred_url":"https://api.github.com/users/ted-jenks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ted-jenks/subscriptions","organizations_url":"https://api.github.com/users/ted-jenks/orgs","repos_url":"https://api.github.com/users/ted-jenks/repos","events_url":"https://api.github.com/users/ted-jenks/events{/privacy}","received_events_url":"https://api.github.com/users/ted-jenks/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nAdded support row skipping when reading CSV files with a `skipLines` option.\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nIn [SPARK-42359](https://issues.apache.org/jira/browse/SPARK-42359) we highlight the need for row skipping functionality in CSV reads. In summary, there is no way of users reading CSV files that do not have the header/data in the first row with the DataFrame API. Advanced users can use RDDs and `zipWithIndex` to remove the first n rows, though this is not compatible with RDDs being an unordered concept.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNow the user's have access to a new a option when reading CSVs. This option defaults to 0 so legacy code will be unaffected. The `skipLines` option that has been added will cause the parser to skip a specified number of lines before parsing the data. It will respect multline values. If the `header` option is set to `true`, the first line after the `skipLines` will be taken as the header.\r\n\r\nThe option is used: `spark.read.option(\"skipLines\", 2).csv(\"/path/to/file.csv\")`.\r\n\r\nThis change has been reflected in the user docs.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nTests added in CSVSuite for:\r\n* Reads from datasets of Strings with `multiLine` enabled and disabled.\r\n* Reads from CSV files with `multiLine` enabled and disabled (these take different code-paths). \r\n* Reads with `header` set as `true` and as as `false` (ensure schema is correctly inferred).\r\n* Invalid `skipLines` option throws exception.","created_at":"2023-02-06T14:18:52Z","updated_at":"2023-10-19T00:17:44Z","closed_at":"2023-10-19T00:17:44Z","merged_at":null,"merge_commit_sha":"c62fb46aeffdd9b0ddf4cfa7c85fd022a080e272","assignee":null,"assignees":[],"requested_reviewers":[{"login":"jaceklaskowski","id":62313,"node_id":"MDQ6VXNlcjYyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/62313?v=4","gravatar_id":"","url":"https://api.github.com/users/jaceklaskowski","html_url":"https://github.com/jaceklaskowski","followers_url":"https://api.github.com/users/jaceklaskowski/followers","following_url":"https://api.github.com/users/jaceklaskowski/following{/other_user}","gists_url":"https://api.github.com/users/jaceklaskowski/gists{/gist_id}","starred_url":"https://api.github.com/users/jaceklaskowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaceklaskowski/subscriptions","organizations_url":"https://api.github.com/users/jaceklaskowski/orgs","repos_url":"https://api.github.com/users/jaceklaskowski/repos","events_url":"https://api.github.com/users/jaceklaskowski/events{/privacy}","received_events_url":"https://api.github.com/users/jaceklaskowski/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39907/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39907/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39907/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b636a7535edf590d6aec993beb7b8d1d807b24cb","head":{"label":"ted-jenks:SPARK-42359","ref":"SPARK-42359","sha":"b636a7535edf590d6aec993beb7b8d1d807b24cb","user":{"login":"ted-jenks","id":77486246,"node_id":"MDQ6VXNlcjc3NDg2MjQ2","avatar_url":"https://avatars.githubusercontent.com/u/77486246?v=4","gravatar_id":"","url":"https://api.github.com/users/ted-jenks","html_url":"https://github.com/ted-jenks","followers_url":"https://api.github.com/users/ted-jenks/followers","following_url":"https://api.github.com/users/ted-jenks/following{/other_user}","gists_url":"https://api.github.com/users/ted-jenks/gists{/gist_id}","starred_url":"https://api.github.com/users/ted-jenks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ted-jenks/subscriptions","organizations_url":"https://api.github.com/users/ted-jenks/orgs","repos_url":"https://api.github.com/users/ted-jenks/repos","events_url":"https://api.github.com/users/ted-jenks/events{/privacy}","received_events_url":"https://api.github.com/users/ted-jenks/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":576309126,"node_id":"R_kgDOIlnHhg","name":"spark","full_name":"ted-jenks/spark","private":false,"owner":{"login":"ted-jenks","id":77486246,"node_id":"MDQ6VXNlcjc3NDg2MjQ2","avatar_url":"https://avatars.githubusercontent.com/u/77486246?v=4","gravatar_id":"","url":"https://api.github.com/users/ted-jenks","html_url":"https://github.com/ted-jenks","followers_url":"https://api.github.com/users/ted-jenks/followers","following_url":"https://api.github.com/users/ted-jenks/following{/other_user}","gists_url":"https://api.github.com/users/ted-jenks/gists{/gist_id}","starred_url":"https://api.github.com/users/ted-jenks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ted-jenks/subscriptions","organizations_url":"https://api.github.com/users/ted-jenks/orgs","repos_url":"https://api.github.com/users/ted-jenks/repos","events_url":"https://api.github.com/users/ted-jenks/events{/privacy}","received_events_url":"https://api.github.com/users/ted-jenks/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ted-jenks/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/ted-jenks/spark","forks_url":"https://api.github.com/repos/ted-jenks/spark/forks","keys_url":"https://api.github.com/repos/ted-jenks/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ted-jenks/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ted-jenks/spark/teams","hooks_url":"https://api.github.com/repos/ted-jenks/spark/hooks","issue_events_url":"https://api.github.com/repos/ted-jenks/spark/issues/events{/number}","events_url":"https://api.github.com/repos/ted-jenks/spark/events","assignees_url":"https://api.github.com/repos/ted-jenks/spark/assignees{/user}","branches_url":"https://api.github.com/repos/ted-jenks/spark/branches{/branch}","tags_url":"https://api.github.com/repos/ted-jenks/spark/tags","blobs_url":"https://api.github.com/repos/ted-jenks/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ted-jenks/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ted-jenks/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ted-jenks/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ted-jenks/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ted-jenks/spark/languages","stargazers_url":"https://api.github.com/repos/ted-jenks/spark/stargazers","contributors_url":"https://api.github.com/repos/ted-jenks/spark/contributors","subscribers_url":"https://api.github.com/repos/ted-jenks/spark/subscribers","subscription_url":"https://api.github.com/repos/ted-jenks/spark/subscription","commits_url":"https://api.github.com/repos/ted-jenks/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ted-jenks/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ted-jenks/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ted-jenks/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ted-jenks/spark/contents/{+path}","compare_url":"https://api.github.com/repos/ted-jenks/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ted-jenks/spark/merges","archive_url":"https://api.github.com/repos/ted-jenks/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ted-jenks/spark/downloads","issues_url":"https://api.github.com/repos/ted-jenks/spark/issues{/number}","pulls_url":"https://api.github.com/repos/ted-jenks/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ted-jenks/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ted-jenks/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ted-jenks/spark/labels{/name}","releases_url":"https://api.github.com/repos/ted-jenks/spark/releases{/id}","deployments_url":"https://api.github.com/repos/ted-jenks/spark/deployments","created_at":"2022-12-09T14:17:53Z","updated_at":"2022-12-09T08:58:57Z","pushed_at":"2024-03-12T13:48:17Z","git_url":"git://github.com/ted-jenks/spark.git","ssh_url":"git@github.com:ted-jenks/spark.git","clone_url":"https://github.com/ted-jenks/spark.git","svn_url":"https://github.com/ted-jenks/spark","homepage":"https://spark.apache.org/","size":410714,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5940b9884b4b172f65220da7857d2952b137bc51","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39907"},"html":{"href":"https://github.com/apache/spark/pull/39907"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39907"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39907/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39907/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39907/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b636a7535edf590d6aec993beb7b8d1d807b24cb"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39906","id":1230424199,"node_id":"PR_kwDOAQXtWs5JVsiH","html_url":"https://github.com/apache/spark/pull/39906","diff_url":"https://github.com/apache/spark/pull/39906.diff","patch_url":"https://github.com/apache/spark/pull/39906.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39906","number":39906,"state":"closed","locked":false,"title":"[SPARK-41962][MINOR][SQL] Update the order of imports in class SpecificParquetRecordReaderBase","user":{"login":"wayneguow","id":16032294,"node_id":"MDQ6VXNlcjE2MDMyMjk0","avatar_url":"https://avatars.githubusercontent.com/u/16032294?v=4","gravatar_id":"","url":"https://api.github.com/users/wayneguow","html_url":"https://github.com/wayneguow","followers_url":"https://api.github.com/users/wayneguow/followers","following_url":"https://api.github.com/users/wayneguow/following{/other_user}","gists_url":"https://api.github.com/users/wayneguow/gists{/gist_id}","starred_url":"https://api.github.com/users/wayneguow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wayneguow/subscriptions","organizations_url":"https://api.github.com/users/wayneguow/orgs","repos_url":"https://api.github.com/users/wayneguow/repos","events_url":"https://api.github.com/users/wayneguow/events{/privacy}","received_events_url":"https://api.github.com/users/wayneguow/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nUpdate the order of imports in class SpecificParquetRecordReaderBase.\r\n\r\n\r\n### Why are the changes needed?\r\nFollow the code style.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nPassed GA.\r\n","created_at":"2023-02-06T13:21:50Z","updated_at":"2023-02-08T21:59:29Z","closed_at":"2023-02-07T12:33:28Z","merged_at":null,"merge_commit_sha":"26daf94ea5528875d975198068b922730d44e9d7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39906/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39906/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39906/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7289fcfde53aa368a0734dc9eaceb9af8dc905c4","head":{"label":"wayneguow:import","ref":"import","sha":"7289fcfde53aa368a0734dc9eaceb9af8dc905c4","user":{"login":"wayneguow","id":16032294,"node_id":"MDQ6VXNlcjE2MDMyMjk0","avatar_url":"https://avatars.githubusercontent.com/u/16032294?v=4","gravatar_id":"","url":"https://api.github.com/users/wayneguow","html_url":"https://github.com/wayneguow","followers_url":"https://api.github.com/users/wayneguow/followers","following_url":"https://api.github.com/users/wayneguow/following{/other_user}","gists_url":"https://api.github.com/users/wayneguow/gists{/gist_id}","starred_url":"https://api.github.com/users/wayneguow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wayneguow/subscriptions","organizations_url":"https://api.github.com/users/wayneguow/orgs","repos_url":"https://api.github.com/users/wayneguow/repos","events_url":"https://api.github.com/users/wayneguow/events{/privacy}","received_events_url":"https://api.github.com/users/wayneguow/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":436644142,"node_id":"R_kgDOGgapLg","name":"spark","full_name":"wayneguow/spark","private":false,"owner":{"login":"wayneguow","id":16032294,"node_id":"MDQ6VXNlcjE2MDMyMjk0","avatar_url":"https://avatars.githubusercontent.com/u/16032294?v=4","gravatar_id":"","url":"https://api.github.com/users/wayneguow","html_url":"https://github.com/wayneguow","followers_url":"https://api.github.com/users/wayneguow/followers","following_url":"https://api.github.com/users/wayneguow/following{/other_user}","gists_url":"https://api.github.com/users/wayneguow/gists{/gist_id}","starred_url":"https://api.github.com/users/wayneguow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wayneguow/subscriptions","organizations_url":"https://api.github.com/users/wayneguow/orgs","repos_url":"https://api.github.com/users/wayneguow/repos","events_url":"https://api.github.com/users/wayneguow/events{/privacy}","received_events_url":"https://api.github.com/users/wayneguow/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/wayneguow/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/wayneguow/spark","forks_url":"https://api.github.com/repos/wayneguow/spark/forks","keys_url":"https://api.github.com/repos/wayneguow/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/wayneguow/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/wayneguow/spark/teams","hooks_url":"https://api.github.com/repos/wayneguow/spark/hooks","issue_events_url":"https://api.github.com/repos/wayneguow/spark/issues/events{/number}","events_url":"https://api.github.com/repos/wayneguow/spark/events","assignees_url":"https://api.github.com/repos/wayneguow/spark/assignees{/user}","branches_url":"https://api.github.com/repos/wayneguow/spark/branches{/branch}","tags_url":"https://api.github.com/repos/wayneguow/spark/tags","blobs_url":"https://api.github.com/repos/wayneguow/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/wayneguow/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/wayneguow/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/wayneguow/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/wayneguow/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/wayneguow/spark/languages","stargazers_url":"https://api.github.com/repos/wayneguow/spark/stargazers","contributors_url":"https://api.github.com/repos/wayneguow/spark/contributors","subscribers_url":"https://api.github.com/repos/wayneguow/spark/subscribers","subscription_url":"https://api.github.com/repos/wayneguow/spark/subscription","commits_url":"https://api.github.com/repos/wayneguow/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/wayneguow/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/wayneguow/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/wayneguow/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/wayneguow/spark/contents/{+path}","compare_url":"https://api.github.com/repos/wayneguow/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/wayneguow/spark/merges","archive_url":"https://api.github.com/repos/wayneguow/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/wayneguow/spark/downloads","issues_url":"https://api.github.com/repos/wayneguow/spark/issues{/number}","pulls_url":"https://api.github.com/repos/wayneguow/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/wayneguow/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/wayneguow/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/wayneguow/spark/labels{/name}","releases_url":"https://api.github.com/repos/wayneguow/spark/releases{/id}","deployments_url":"https://api.github.com/repos/wayneguow/spark/deployments","created_at":"2021-12-09T14:20:45Z","updated_at":"2024-12-23T09:38:57Z","pushed_at":"2025-02-09T10:48:02Z","git_url":"git://github.com/wayneguow/spark.git","ssh_url":"git@github.com:wayneguow/spark.git","clone_url":"https://github.com/wayneguow/spark.git","svn_url":"https://github.com/wayneguow/spark","homepage":"https://spark.apache.org/","size":475066,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"56dd20f6a6b3efb2676196fa14d5e7fbbafe4949","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39906"},"html":{"href":"https://github.com/apache/spark/pull/39906"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39906"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39906/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39906/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39906/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7289fcfde53aa368a0734dc9eaceb9af8dc905c4"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39905","id":1230368584,"node_id":"PR_kwDOAQXtWs5JVe9I","html_url":"https://github.com/apache/spark/pull/39905","diff_url":"https://github.com/apache/spark/pull/39905.diff","patch_url":"https://github.com/apache/spark/pull/39905.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39905","number":39905,"state":"closed","locked":false,"title":"[SPARK-40819][SQL][3.2] Timestamp nanos behaviour regression","user":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\nAs per @HyukjinKwon request on https://github.com/apache/spark/pull/38312 to backport fix into 3.2\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nHandle `TimeUnit.NANOS` for parquet `Timestamps` addressing a regression in behaviour since 3.2\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nSince version 3.2 reading parquet files that contain attributes with type `TIMESTAMP(NANOS,true)` is not possible as ParquetSchemaConverter returns\r\n```\r\nCaused by: org.apache.spark.sql.AnalysisException: Illegal Parquet type: INT64 (TIMESTAMP(NANOS,true))\r\n```\r\nhttps://issues.apache.org/jira/browse/SPARK-34661 introduced a change matching on the `LogicalTypeAnnotation` which only covers Timestamp cases for `TimeUnit.MILLIS` and `TimeUnit.MICROS` meaning `TimeUnit.NANOS` would return `illegalType()`\r\n\r\nPrior to 3.2 the matching used the `originalType` which for `TIMESTAMP(NANOS,true)` return `null` and therefore resulted to a `LongType`, the change proposed is too consider `TimeUnit.NANOS` and return `LongType` making behaviour the same as before.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nAdded unit test covering this scenario.\r\nInternally deployed to read parquet files that contain `TIMESTAMP(NANOS,true)`","created_at":"2023-02-06T12:39:23Z","updated_at":"2023-02-08T02:08:15Z","closed_at":"2023-02-08T02:08:15Z","merged_at":null,"merge_commit_sha":"3b641cee5f39a902fb1d2cf1fb8caf57be88a186","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39905/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39905/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39905/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0129d697a7e8f2f751309f3ea70222b269db09b5","head":{"label":"awdavidson:ts-nanos-fix-3.2","ref":"ts-nanos-fix-3.2","sha":"0129d697a7e8f2f751309f3ea70222b269db09b5","user":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":472961423,"node_id":"R_kgDOHDDRjw","name":"spark","full_name":"awdavidson/spark","private":false,"owner":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/awdavidson/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/awdavidson/spark","forks_url":"https://api.github.com/repos/awdavidson/spark/forks","keys_url":"https://api.github.com/repos/awdavidson/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/awdavidson/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/awdavidson/spark/teams","hooks_url":"https://api.github.com/repos/awdavidson/spark/hooks","issue_events_url":"https://api.github.com/repos/awdavidson/spark/issues/events{/number}","events_url":"https://api.github.com/repos/awdavidson/spark/events","assignees_url":"https://api.github.com/repos/awdavidson/spark/assignees{/user}","branches_url":"https://api.github.com/repos/awdavidson/spark/branches{/branch}","tags_url":"https://api.github.com/repos/awdavidson/spark/tags","blobs_url":"https://api.github.com/repos/awdavidson/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/awdavidson/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/awdavidson/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/awdavidson/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/awdavidson/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/awdavidson/spark/languages","stargazers_url":"https://api.github.com/repos/awdavidson/spark/stargazers","contributors_url":"https://api.github.com/repos/awdavidson/spark/contributors","subscribers_url":"https://api.github.com/repos/awdavidson/spark/subscribers","subscription_url":"https://api.github.com/repos/awdavidson/spark/subscription","commits_url":"https://api.github.com/repos/awdavidson/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/awdavidson/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/awdavidson/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/awdavidson/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/awdavidson/spark/contents/{+path}","compare_url":"https://api.github.com/repos/awdavidson/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/awdavidson/spark/merges","archive_url":"https://api.github.com/repos/awdavidson/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/awdavidson/spark/downloads","issues_url":"https://api.github.com/repos/awdavidson/spark/issues{/number}","pulls_url":"https://api.github.com/repos/awdavidson/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/awdavidson/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/awdavidson/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/awdavidson/spark/labels{/name}","releases_url":"https://api.github.com/repos/awdavidson/spark/releases{/id}","deployments_url":"https://api.github.com/repos/awdavidson/spark/deployments","created_at":"2022-03-22T22:45:53Z","updated_at":"2022-04-13T14:28:23Z","pushed_at":"2023-02-08T14:38:56Z","git_url":"git://github.com/awdavidson/spark.git","ssh_url":"git@github.com:awdavidson/spark.git","clone_url":"https://github.com/awdavidson/spark.git","svn_url":"https://github.com/awdavidson/spark","homepage":"https://spark.apache.org/","size":458761,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:branch-3.2","ref":"branch-3.2","sha":"d304a6528233798dc93d31da58be220cf6d0485e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39905"},"html":{"href":"https://github.com/apache/spark/pull/39905"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39905"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39905/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39905/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39905/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0129d697a7e8f2f751309f3ea70222b269db09b5"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39904","id":1230313165,"node_id":"PR_kwDOAQXtWs5JVRbN","html_url":"https://github.com/apache/spark/pull/39904","diff_url":"https://github.com/apache/spark/pull/39904.diff","patch_url":"https://github.com/apache/spark/pull/39904.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39904","number":39904,"state":"closed","locked":false,"title":"[SPARK-40819][SQL][3.3] Timestamp nanos behaviour regression","user":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\nAs per @HyukjinKwon request on https://github.com/apache/spark/pull/38312 to backport fix into 3.3\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nHandle `TimeUnit.NANOS` for parquet `Timestamps` addressing a regression in behaviour since 3.2\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nSince version 3.2 reading parquet files that contain attributes with type `TIMESTAMP(NANOS,true)` is not possible as ParquetSchemaConverter returns\r\n```\r\nCaused by: org.apache.spark.sql.AnalysisException: Illegal Parquet type: INT64 (TIMESTAMP(NANOS,true))\r\n```\r\nhttps://issues.apache.org/jira/browse/SPARK-34661 introduced a change matching on the `LogicalTypeAnnotation` which only covers Timestamp cases for `TimeUnit.MILLIS` and `TimeUnit.MICROS` meaning `TimeUnit.NANOS` would return `illegalType()`\r\n\r\nPrior to 3.2 the matching used the `originalType` which for `TIMESTAMP(NANOS,true)` return `null` and therefore resulted to a `LongType`, the change proposed is too consider `TimeUnit.NANOS` and return `LongType` making behaviour the same as before.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nAdded unit test covering this scenario.\r\nInternally deployed to read parquet files that contain `TIMESTAMP(NANOS,true)`","created_at":"2023-02-06T11:58:06Z","updated_at":"2023-02-08T02:07:57Z","closed_at":"2023-02-08T02:07:57Z","merged_at":null,"merge_commit_sha":"790b208e6e2bd8e753897c53f2360cbd053a250a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39904/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39904/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39904/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2ee8403cf76645813ce752af4ec9735bbbb43f6e","head":{"label":"awdavidson:ts-nanos-fix-3.3","ref":"ts-nanos-fix-3.3","sha":"2ee8403cf76645813ce752af4ec9735bbbb43f6e","user":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":472961423,"node_id":"R_kgDOHDDRjw","name":"spark","full_name":"awdavidson/spark","private":false,"owner":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/awdavidson/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/awdavidson/spark","forks_url":"https://api.github.com/repos/awdavidson/spark/forks","keys_url":"https://api.github.com/repos/awdavidson/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/awdavidson/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/awdavidson/spark/teams","hooks_url":"https://api.github.com/repos/awdavidson/spark/hooks","issue_events_url":"https://api.github.com/repos/awdavidson/spark/issues/events{/number}","events_url":"https://api.github.com/repos/awdavidson/spark/events","assignees_url":"https://api.github.com/repos/awdavidson/spark/assignees{/user}","branches_url":"https://api.github.com/repos/awdavidson/spark/branches{/branch}","tags_url":"https://api.github.com/repos/awdavidson/spark/tags","blobs_url":"https://api.github.com/repos/awdavidson/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/awdavidson/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/awdavidson/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/awdavidson/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/awdavidson/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/awdavidson/spark/languages","stargazers_url":"https://api.github.com/repos/awdavidson/spark/stargazers","contributors_url":"https://api.github.com/repos/awdavidson/spark/contributors","subscribers_url":"https://api.github.com/repos/awdavidson/spark/subscribers","subscription_url":"https://api.github.com/repos/awdavidson/spark/subscription","commits_url":"https://api.github.com/repos/awdavidson/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/awdavidson/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/awdavidson/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/awdavidson/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/awdavidson/spark/contents/{+path}","compare_url":"https://api.github.com/repos/awdavidson/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/awdavidson/spark/merges","archive_url":"https://api.github.com/repos/awdavidson/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/awdavidson/spark/downloads","issues_url":"https://api.github.com/repos/awdavidson/spark/issues{/number}","pulls_url":"https://api.github.com/repos/awdavidson/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/awdavidson/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/awdavidson/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/awdavidson/spark/labels{/name}","releases_url":"https://api.github.com/repos/awdavidson/spark/releases{/id}","deployments_url":"https://api.github.com/repos/awdavidson/spark/deployments","created_at":"2022-03-22T22:45:53Z","updated_at":"2022-04-13T14:28:23Z","pushed_at":"2023-02-08T14:38:56Z","git_url":"git://github.com/awdavidson/spark.git","ssh_url":"git@github.com:awdavidson/spark.git","clone_url":"https://github.com/awdavidson/spark.git","svn_url":"https://github.com/awdavidson/spark","homepage":"https://spark.apache.org/","size":458761,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:branch-3.3","ref":"branch-3.3","sha":"cdb494bec615ab4eff8aa0e90afb57e0daa8023f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39904"},"html":{"href":"https://github.com/apache/spark/pull/39904"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39904"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39904/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39904/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39904/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2ee8403cf76645813ce752af4ec9735bbbb43f6e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39903","id":1230231658,"node_id":"PR_kwDOAQXtWs5JU9hq","html_url":"https://github.com/apache/spark/pull/39903","diff_url":"https://github.com/apache/spark/pull/39903.diff","patch_url":"https://github.com/apache/spark/pull/39903.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39903","number":39903,"state":"closed","locked":false,"title":"[SPARK-42358][CORE] Send ExecutorUpdated with the message argument in Master.removeWorker","user":{"login":"bozhang2820","id":44179472,"node_id":"MDQ6VXNlcjQ0MTc5NDcy","avatar_url":"https://avatars.githubusercontent.com/u/44179472?v=4","gravatar_id":"","url":"https://api.github.com/users/bozhang2820","html_url":"https://github.com/bozhang2820","followers_url":"https://api.github.com/users/bozhang2820/followers","following_url":"https://api.github.com/users/bozhang2820/following{/other_user}","gists_url":"https://api.github.com/users/bozhang2820/gists{/gist_id}","starred_url":"https://api.github.com/users/bozhang2820/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bozhang2820/subscriptions","organizations_url":"https://api.github.com/users/bozhang2820/orgs","repos_url":"https://api.github.com/users/bozhang2820/repos","events_url":"https://api.github.com/users/bozhang2820/events{/privacy}","received_events_url":"https://api.github.com/users/bozhang2820/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nCurrently field `message` in `ExecutorUpdated` sent in Master.removeWorker is always `Some(\"worker lost\")`. This PR change to use the method argument `message` instead.\r\n\r\n### Why are the changes needed?\r\nThis is to provide more information in the message to better differentiate the causes of worker removals.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nExisting tests.\r\n","created_at":"2023-02-06T10:54:13Z","updated_at":"2023-04-24T07:02:10Z","closed_at":"2023-02-08T05:09:06Z","merged_at":null,"merge_commit_sha":"fe258f6e4ca0a77eaf2cca32d510d89588e655af","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39903/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39903/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39903/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/983713b0c3680585005275dc3424b78986925edd","head":{"label":"bozhang2820:spark-42358","ref":"spark-42358","sha":"983713b0c3680585005275dc3424b78986925edd","user":{"login":"bozhang2820","id":44179472,"node_id":"MDQ6VXNlcjQ0MTc5NDcy","avatar_url":"https://avatars.githubusercontent.com/u/44179472?v=4","gravatar_id":"","url":"https://api.github.com/users/bozhang2820","html_url":"https://github.com/bozhang2820","followers_url":"https://api.github.com/users/bozhang2820/followers","following_url":"https://api.github.com/users/bozhang2820/following{/other_user}","gists_url":"https://api.github.com/users/bozhang2820/gists{/gist_id}","starred_url":"https://api.github.com/users/bozhang2820/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bozhang2820/subscriptions","organizations_url":"https://api.github.com/users/bozhang2820/orgs","repos_url":"https://api.github.com/users/bozhang2820/repos","events_url":"https://api.github.com/users/bozhang2820/events{/privacy}","received_events_url":"https://api.github.com/users/bozhang2820/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":295316675,"node_id":"MDEwOlJlcG9zaXRvcnkyOTUzMTY2NzU=","name":"spark","full_name":"bozhang2820/spark","private":false,"owner":{"login":"bozhang2820","id":44179472,"node_id":"MDQ6VXNlcjQ0MTc5NDcy","avatar_url":"https://avatars.githubusercontent.com/u/44179472?v=4","gravatar_id":"","url":"https://api.github.com/users/bozhang2820","html_url":"https://github.com/bozhang2820","followers_url":"https://api.github.com/users/bozhang2820/followers","following_url":"https://api.github.com/users/bozhang2820/following{/other_user}","gists_url":"https://api.github.com/users/bozhang2820/gists{/gist_id}","starred_url":"https://api.github.com/users/bozhang2820/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bozhang2820/subscriptions","organizations_url":"https://api.github.com/users/bozhang2820/orgs","repos_url":"https://api.github.com/users/bozhang2820/repos","events_url":"https://api.github.com/users/bozhang2820/events{/privacy}","received_events_url":"https://api.github.com/users/bozhang2820/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bozhang2820/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/bozhang2820/spark","forks_url":"https://api.github.com/repos/bozhang2820/spark/forks","keys_url":"https://api.github.com/repos/bozhang2820/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bozhang2820/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bozhang2820/spark/teams","hooks_url":"https://api.github.com/repos/bozhang2820/spark/hooks","issue_events_url":"https://api.github.com/repos/bozhang2820/spark/issues/events{/number}","events_url":"https://api.github.com/repos/bozhang2820/spark/events","assignees_url":"https://api.github.com/repos/bozhang2820/spark/assignees{/user}","branches_url":"https://api.github.com/repos/bozhang2820/spark/branches{/branch}","tags_url":"https://api.github.com/repos/bozhang2820/spark/tags","blobs_url":"https://api.github.com/repos/bozhang2820/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bozhang2820/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bozhang2820/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/bozhang2820/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bozhang2820/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/bozhang2820/spark/languages","stargazers_url":"https://api.github.com/repos/bozhang2820/spark/stargazers","contributors_url":"https://api.github.com/repos/bozhang2820/spark/contributors","subscribers_url":"https://api.github.com/repos/bozhang2820/spark/subscribers","subscription_url":"https://api.github.com/repos/bozhang2820/spark/subscription","commits_url":"https://api.github.com/repos/bozhang2820/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/bozhang2820/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/bozhang2820/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/bozhang2820/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/bozhang2820/spark/contents/{+path}","compare_url":"https://api.github.com/repos/bozhang2820/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bozhang2820/spark/merges","archive_url":"https://api.github.com/repos/bozhang2820/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bozhang2820/spark/downloads","issues_url":"https://api.github.com/repos/bozhang2820/spark/issues{/number}","pulls_url":"https://api.github.com/repos/bozhang2820/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/bozhang2820/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/bozhang2820/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bozhang2820/spark/labels{/name}","releases_url":"https://api.github.com/repos/bozhang2820/spark/releases{/id}","deployments_url":"https://api.github.com/repos/bozhang2820/spark/deployments","created_at":"2020-09-14T05:49:28Z","updated_at":"2025-01-08T01:37:51Z","pushed_at":"2025-01-16T02:46:07Z","git_url":"git://github.com/bozhang2820/spark.git","ssh_url":"git@github.com:bozhang2820/spark.git","clone_url":"https://github.com/bozhang2820/spark.git","svn_url":"https://github.com/bozhang2820/spark","homepage":"https://spark.apache.org/","size":449059,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"b6eadf00fc527df428a451ebb20777de9965b2de","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39903"},"html":{"href":"https://github.com/apache/spark/pull/39903"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39903"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39903/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39903/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39903/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/983713b0c3680585005275dc3424b78986925edd"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39902","id":1230195118,"node_id":"PR_kwDOAQXtWs5JU0mu","html_url":"https://github.com/apache/spark/pull/39902","diff_url":"https://github.com/apache/spark/pull/39902.diff","patch_url":"https://github.com/apache/spark/pull/39902.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39902","number":39902,"state":"closed","locked":false,"title":"[SPARK-42349][PYTHON] Support pandas cogroup with multiple df","user":{"login":"santosh-d3vpl3x","id":3813695,"node_id":"MDQ6VXNlcjM4MTM2OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3813695?v=4","gravatar_id":"","url":"https://api.github.com/users/santosh-d3vpl3x","html_url":"https://github.com/santosh-d3vpl3x","followers_url":"https://api.github.com/users/santosh-d3vpl3x/followers","following_url":"https://api.github.com/users/santosh-d3vpl3x/following{/other_user}","gists_url":"https://api.github.com/users/santosh-d3vpl3x/gists{/gist_id}","starred_url":"https://api.github.com/users/santosh-d3vpl3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/santosh-d3vpl3x/subscriptions","organizations_url":"https://api.github.com/users/santosh-d3vpl3x/orgs","repos_url":"https://api.github.com/users/santosh-d3vpl3x/repos","events_url":"https://api.github.com/users/santosh-d3vpl3x/events{/privacy}","received_events_url":"https://api.github.com/users/santosh-d3vpl3x/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"Pandas cogroup UDF with applyInPandas currently support two dataframes. This is already very useful but limits us both API wise and efficiency wise when we have to use multiple DFs with cogroup.applyInPandas. The PR here is to support multiple DFs in cogroup.\r\n\r\n```python\r\ndf1 = spark.createDataFrame(\r\n    [(20000101, 1, 1.0), (20000101, 2, 2.0), (20000102, 1, 3.0), (20000102, 2, 4.0)],\r\n    (\"time\", \"id\", \"v1\"))\r\ndf2 = spark.createDataFrame(\r\n    [(20000101, 1, \"x\"), (20000101, 2, \"y\")],\r\n    (\"time\", \"id\", \"v2\"))\r\ndf3 = spark.createDataFrame(\r\n    [(20000101, 1, \"asd\"), (20000101, 2, \"d\")],\r\n    (\"time\", \"id\", \"v3\"))\r\ndf4 = spark.createDataFrame(\r\n    [(20000101, 1, \"v\"), (20000101, 2, \"g\")],\r\n    (\"time\", \"id\", \"v4\"))\r\ndef asof_join(df1, df2, df3, df4):\r\n    df12 = pd.merge_asof(df1, df2, on=\"time\", by=\"id\")\r\n    df123 = pd.merge_asof(df12, df3, on=\"time\", by=\"id\")\r\n    df1234 = pd.merge_asof(df123, df4, on=\"time\", by=\"id\")\r\n    return df1234\r\ndf1.groupby(\"id\").cogroup(df2.groupby(\"id\"), df3.groupby(\"id\"), df4.groupby(\"id\")).applyInPandas(\r\n    asof_join, schema=\"time int, id int, v1 double, v2 string, v3 string, v4 string\"\r\n).show()\r\n\r\n+--------+---+---+---+---+---+\r\n|    time| id| v1| v2| v3| v4|\r\n+--------+---+---+---+---+---+\r\n|20000101|  1|1.0|  x|asd|  v|\r\n|20000102|  1|3.0|  x|asd|  v|\r\n|20000101|  2|2.0|  y|  d|  g|\r\n|20000102|  2|4.0|  y|  d|  g|\r\n+--------+---+---+---+---+---+\r\n```\r\n\r\nNote: The previous experimental implementation of the API expects either 2 or 3 args. If 2 args are passed then UDF receives 2 cogrouped DFs, if 3 args are passed then UDF receives 2 cogrouped DFs with grouping key as the first arg. The previous API is limiting and has implications on new proposed change. There is no clear way of distinguishing whether 3 args are for 3 DFs or 2 DFs + 1 grouping key. I have kept previous implementation and codepath intact but I would like to get rid of it. I would like to make `pass_key` as a way of indicating whether grouping key should be passed as first arg to UDF or not.  **Question: Can I remove previous implementation with this new idea?**\r\n\r\n![image](https://user-images.githubusercontent.com/3813695/216947300-f1876572-d934-42b6-8003-8df0bde917bc.png)\r\n","created_at":"2023-02-06T10:24:12Z","updated_at":"2023-12-01T15:10:46Z","closed_at":"2023-05-29T00:19:01Z","merged_at":null,"merge_commit_sha":"4b8deeb1f524a511d95fad1a81bf959f84b47bcd","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39902/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39902/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39902/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/56603331a4bafd8ff3ea28d2f2cb21c5c88a311c","head":{"label":"santosh-d3vpl3x:multi_cogroup","ref":"multi_cogroup","sha":"56603331a4bafd8ff3ea28d2f2cb21c5c88a311c","user":{"login":"santosh-d3vpl3x","id":3813695,"node_id":"MDQ6VXNlcjM4MTM2OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3813695?v=4","gravatar_id":"","url":"https://api.github.com/users/santosh-d3vpl3x","html_url":"https://github.com/santosh-d3vpl3x","followers_url":"https://api.github.com/users/santosh-d3vpl3x/followers","following_url":"https://api.github.com/users/santosh-d3vpl3x/following{/other_user}","gists_url":"https://api.github.com/users/santosh-d3vpl3x/gists{/gist_id}","starred_url":"https://api.github.com/users/santosh-d3vpl3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/santosh-d3vpl3x/subscriptions","organizations_url":"https://api.github.com/users/santosh-d3vpl3x/orgs","repos_url":"https://api.github.com/users/santosh-d3vpl3x/repos","events_url":"https://api.github.com/users/santosh-d3vpl3x/events{/privacy}","received_events_url":"https://api.github.com/users/santosh-d3vpl3x/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":518972204,"node_id":"R_kgDOHu7jLA","name":"spark","full_name":"santosh-d3vpl3x/spark","private":false,"owner":{"login":"santosh-d3vpl3x","id":3813695,"node_id":"MDQ6VXNlcjM4MTM2OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3813695?v=4","gravatar_id":"","url":"https://api.github.com/users/santosh-d3vpl3x","html_url":"https://github.com/santosh-d3vpl3x","followers_url":"https://api.github.com/users/santosh-d3vpl3x/followers","following_url":"https://api.github.com/users/santosh-d3vpl3x/following{/other_user}","gists_url":"https://api.github.com/users/santosh-d3vpl3x/gists{/gist_id}","starred_url":"https://api.github.com/users/santosh-d3vpl3x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/santosh-d3vpl3x/subscriptions","organizations_url":"https://api.github.com/users/santosh-d3vpl3x/orgs","repos_url":"https://api.github.com/users/santosh-d3vpl3x/repos","events_url":"https://api.github.com/users/santosh-d3vpl3x/events{/privacy}","received_events_url":"https://api.github.com/users/santosh-d3vpl3x/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/santosh-d3vpl3x/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/santosh-d3vpl3x/spark","forks_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/forks","keys_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/teams","hooks_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/hooks","issue_events_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/issues/events{/number}","events_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/events","assignees_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/assignees{/user}","branches_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/branches{/branch}","tags_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/tags","blobs_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/languages","stargazers_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/stargazers","contributors_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/contributors","subscribers_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/subscribers","subscription_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/subscription","commits_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/contents/{+path}","compare_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/merges","archive_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/downloads","issues_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/issues{/number}","pulls_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/labels{/name}","releases_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/releases{/id}","deployments_url":"https://api.github.com/repos/santosh-d3vpl3x/spark/deployments","created_at":"2022-07-28T19:33:37Z","updated_at":"2022-07-28T19:37:43Z","pushed_at":"2023-02-23T16:58:42Z","git_url":"git://github.com/santosh-d3vpl3x/spark.git","ssh_url":"git@github.com:santosh-d3vpl3x/spark.git","clone_url":"https://github.com/santosh-d3vpl3x/spark.git","svn_url":"https://github.com/santosh-d3vpl3x/spark","homepage":"https://spark.apache.org/","size":404262,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"70633e7158f90bb1a7005b3c65fe10751e08e7bf","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39902"},"html":{"href":"https://github.com/apache/spark/pull/39902"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39902"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39902/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39902/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39902/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/56603331a4bafd8ff3ea28d2f2cb21c5c88a311c"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39901","id":1230191892,"node_id":"PR_kwDOAQXtWs5JUz0U","html_url":"https://github.com/apache/spark/pull/39901","diff_url":"https://github.com/apache/spark/pull/39901.diff","patch_url":"https://github.com/apache/spark/pull/39901.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39901","number":39901,"state":"closed","locked":false,"title":"[SPARK-40819][SQL] Backport Timestamp nanos regression to 3.3","user":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n","created_at":"2023-02-06T10:21:50Z","updated_at":"2023-02-06T10:41:33Z","closed_at":"2023-02-06T10:41:33Z","merged_at":null,"merge_commit_sha":null,"assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1405801475,"node_id":"MDU6TGFiZWwxNDA1ODAxNDc1","url":"https://api.github.com/repos/apache/spark/labels/ML","name":"ML","color":"ededed","default":false,"description":null},{"id":1405803268,"node_id":"MDU6TGFiZWwxNDA1ODAzMjY4","url":"https://api.github.com/repos/apache/spark/labels/MLLIB","name":"MLLIB","color":"ededed","default":false,"description":null},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1406605057,"node_id":"MDU6TGFiZWwxNDA2NjA1MDU3","url":"https://api.github.com/repos/apache/spark/labels/KUBERNETES","name":"KUBERNETES","color":"ededed","default":false,"description":null},{"id":1406605079,"node_id":"MDU6TGFiZWwxNDA2NjA1MDc5","url":"https://api.github.com/repos/apache/spark/labels/WEB%20UI","name":"WEB UI","color":"ededed","default":false,"description":null},{"id":1406606351,"node_id":"MDU6TGFiZWwxNDA2NjA2MzUx","url":"https://api.github.com/repos/apache/spark/labels/DEPLOY","name":"DEPLOY","color":"ededed","default":false,"description":null},{"id":1406607243,"node_id":"MDU6TGFiZWwxNDA2NjA3MjQz","url":"https://api.github.com/repos/apache/spark/labels/GRAPHX","name":"GRAPHX","color":"ededed","default":false,"description":null},{"id":1406625202,"node_id":"MDU6TGFiZWwxNDA2NjI1MjAy","url":"https://api.github.com/repos/apache/spark/labels/MESOS","name":"MESOS","color":"ededed","default":false,"description":null},{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1406628559,"node_id":"MDU6TGFiZWwxNDA2NjI4NTU5","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20SHELL","name":"SPARK SHELL","color":"ededed","default":false,"description":null},{"id":1427970157,"node_id":"MDU6TGFiZWwxNDI3OTcwMTU3","url":"https://api.github.com/repos/apache/spark/labels/YARN","name":"YARN","color":"ededed","default":false,"description":null},{"id":1496047285,"node_id":"MDU6TGFiZWwxNDk2MDQ3Mjg1","url":"https://api.github.com/repos/apache/spark/labels/EXAMPLES","name":"EXAMPLES","color":"ededed","default":false,"description":""},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982015569,"node_id":"MDU6TGFiZWwxOTgyMDE1NTY5","url":"https://api.github.com/repos/apache/spark/labels/WINDOWS","name":"WINDOWS","color":"ededed","default":false,"description":null},{"id":1982110661,"node_id":"MDU6TGFiZWwxOTgyMTEwNjYx","url":"https://api.github.com/repos/apache/spark/labels/INFRA","name":"INFRA","color":"ededed","default":false,"description":null},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":1984361638,"node_id":"MDU6TGFiZWwxOTg0MzYxNjM4","url":"https://api.github.com/repos/apache/spark/labels/R","name":"R","color":"ededed","default":false,"description":null},{"id":1984378631,"node_id":"MDU6TGFiZWwxOTg0Mzc4NjMx","url":"https://api.github.com/repos/apache/spark/labels/DSTREAM","name":"DSTREAM","color":"ededed","default":false,"description":null},{"id":1988040187,"node_id":"MDU6TGFiZWwxOTg4MDQwMTg3","url":"https://api.github.com/repos/apache/spark/labels/AVRO","name":"AVRO","color":"ededed","default":false,"description":null}],"milestone":null,"draft":true,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39901/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39901/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39901/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/83391ab81af8490628d8af74571e4ab8853cc51d","head":{"label":"awdavidson:ts-nanos-fix","ref":"ts-nanos-fix","sha":"83391ab81af8490628d8af74571e4ab8853cc51d","user":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":472961423,"node_id":"R_kgDOHDDRjw","name":"spark","full_name":"awdavidson/spark","private":false,"owner":{"login":"awdavidson","id":54780428,"node_id":"MDQ6VXNlcjU0NzgwNDI4","avatar_url":"https://avatars.githubusercontent.com/u/54780428?v=4","gravatar_id":"","url":"https://api.github.com/users/awdavidson","html_url":"https://github.com/awdavidson","followers_url":"https://api.github.com/users/awdavidson/followers","following_url":"https://api.github.com/users/awdavidson/following{/other_user}","gists_url":"https://api.github.com/users/awdavidson/gists{/gist_id}","starred_url":"https://api.github.com/users/awdavidson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awdavidson/subscriptions","organizations_url":"https://api.github.com/users/awdavidson/orgs","repos_url":"https://api.github.com/users/awdavidson/repos","events_url":"https://api.github.com/users/awdavidson/events{/privacy}","received_events_url":"https://api.github.com/users/awdavidson/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/awdavidson/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/awdavidson/spark","forks_url":"https://api.github.com/repos/awdavidson/spark/forks","keys_url":"https://api.github.com/repos/awdavidson/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/awdavidson/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/awdavidson/spark/teams","hooks_url":"https://api.github.com/repos/awdavidson/spark/hooks","issue_events_url":"https://api.github.com/repos/awdavidson/spark/issues/events{/number}","events_url":"https://api.github.com/repos/awdavidson/spark/events","assignees_url":"https://api.github.com/repos/awdavidson/spark/assignees{/user}","branches_url":"https://api.github.com/repos/awdavidson/spark/branches{/branch}","tags_url":"https://api.github.com/repos/awdavidson/spark/tags","blobs_url":"https://api.github.com/repos/awdavidson/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/awdavidson/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/awdavidson/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/awdavidson/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/awdavidson/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/awdavidson/spark/languages","stargazers_url":"https://api.github.com/repos/awdavidson/spark/stargazers","contributors_url":"https://api.github.com/repos/awdavidson/spark/contributors","subscribers_url":"https://api.github.com/repos/awdavidson/spark/subscribers","subscription_url":"https://api.github.com/repos/awdavidson/spark/subscription","commits_url":"https://api.github.com/repos/awdavidson/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/awdavidson/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/awdavidson/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/awdavidson/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/awdavidson/spark/contents/{+path}","compare_url":"https://api.github.com/repos/awdavidson/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/awdavidson/spark/merges","archive_url":"https://api.github.com/repos/awdavidson/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/awdavidson/spark/downloads","issues_url":"https://api.github.com/repos/awdavidson/spark/issues{/number}","pulls_url":"https://api.github.com/repos/awdavidson/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/awdavidson/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/awdavidson/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/awdavidson/spark/labels{/name}","releases_url":"https://api.github.com/repos/awdavidson/spark/releases{/id}","deployments_url":"https://api.github.com/repos/awdavidson/spark/deployments","created_at":"2022-03-22T22:45:53Z","updated_at":"2022-04-13T14:28:23Z","pushed_at":"2023-02-08T14:38:56Z","git_url":"git://github.com/awdavidson/spark.git","ssh_url":"git@github.com:awdavidson/spark.git","clone_url":"https://github.com/awdavidson/spark.git","svn_url":"https://github.com/awdavidson/spark","homepage":"https://spark.apache.org/","size":458761,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:branch-3.3","ref":"branch-3.3","sha":"cdb494bec615ab4eff8aa0e90afb57e0daa8023f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39901"},"html":{"href":"https://github.com/apache/spark/pull/39901"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39901"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39901/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39901/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39901/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/83391ab81af8490628d8af74571e4ab8853cc51d"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39900","id":1230184057,"node_id":"PR_kwDOAQXtWs5JUx55","html_url":"https://github.com/apache/spark/pull/39900","diff_url":"https://github.com/apache/spark/pull/39900.diff","patch_url":"https://github.com/apache/spark/pull/39900.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39900","number":39900,"state":"closed","locked":false,"title":"[SPARK-42357][CORE] Log `exitCode` when `SparkContext.stop` starts","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR aims to log `exitCode` when `SparkContext.stop` starts as a clear boundary to ignore the meaningless log messages from user jobs.\r\n\r\n### Why are the changes needed?\r\n\r\nThis PR adds the following log.\r\n```\r\n23/02/06 02:12:55 INFO SparkContext: SparkContext is stopping with exitCode 0.\r\n```\r\n\r\nIn the simplest case, it stops like the following.\r\n\r\n```\r\n$ bin/spark-submit examples/src/main/python/pi.py\r\n...\r\nPi is roughly 3.147080\r\n23/02/06 02:12:55 INFO SparkContext: SparkContext is stopping with exitCode 0.\r\n23/02/06 02:12:55 INFO AbstractConnector: Stopped Spark@1cb72b8{HTTP/1.1, (http/1.1)}{localhost:4040}\r\n23/02/06 02:12:55 INFO SparkUI: Stopped Spark web UI at http://localhost:4040\r\n23/02/06 02:12:55 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!\r\n23/02/06 02:12:55 INFO MemoryStore: MemoryStore cleared\r\n23/02/06 02:12:55 INFO BlockManager: BlockManager stopped\r\n23/02/06 02:12:55 INFO BlockManagerMaster: BlockManagerMaster stopped\r\n23/02/06 02:12:55 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!\r\n23/02/06 02:12:55 INFO SparkContext: Successfully stopped SparkContext\r\n23/02/06 02:12:56 INFO ShutdownHookManager: Shutdown hook called\r\n```\r\n\r\nHowever, in the complex case, there are many many logs after invoking `SparkContet.stop(0)`. Sometimes, this makes users confused. New log will show a clear boundary to ignore the meaningless messages.\r\n```\r\n23/02/06 02:59:27 INFO TaskSetManager: Starting task 283.0 in stage 34.0 (TID 426) (172.31.218.234, executor 5, partition 283, PROCESS_LOCAL, 8001 bytes)\r\n...\r\n23/02/06 02:59:27 INFO BlockManagerInfo: Removed broadcast_35_piece0 on 172.31.218.244:41741 in memory (size: 5.7 KiB, free: 50.8 GiB)\r\n...\r\n23/02/06 02:59:27 INFO SparkUI: Stopped Spark web UI at http://r6i-16xlarge-3402-0203-apple-3-bf3f7e8624a90a37-driver-svc.default.svc:4040\r\n...\r\n23/02/06 02:59:27 INFO DAGScheduler: ShuffleMapStage 34 (q24a) failed in 0.103 s due to Stage cancelled because SparkContext was shut down\r\n...\r\n23/02/06 02:59:27 INFO KubernetesClusterSchedulerBackend: Shutting down all executors\r\n...\r\n23/02/06 02:59:27 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Asking each executor to shut down\r\n...\r\n23/02/06 02:59:27 ERROR TransportRequestHandler: Error while invoking RpcHandler#receive() for one-way message.\r\norg.apache.spark.SparkException: Could not find CoarseGrainedScheduler.\r\n```\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo, this is a log-only change.\r\n\r\n### How was this patch tested?\r\n\r\nManually.","created_at":"2023-02-06T10:16:40Z","updated_at":"2023-02-07T02:49:59Z","closed_at":"2023-02-06T19:23:59Z","merged_at":null,"merge_commit_sha":"1910daa96d284781ce8f08709d7860104455a42c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39900/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39900/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39900/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/131b093bf5615d77b8d425745bddc24712b08eef","head":{"label":"dongjoon-hyun:SPARK-42357","ref":"SPARK-42357","sha":"131b093bf5615d77b8d425745bddc24712b08eef","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"537c04ff7ae8eddb0d52684a01ff7fa2ace91103","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39900"},"html":{"href":"https://github.com/apache/spark/pull/39900"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39900"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39900/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39900/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39900/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/131b093bf5615d77b8d425745bddc24712b08eef"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39899","id":1230039936,"node_id":"PR_kwDOAQXtWs5JUOuA","html_url":"https://github.com/apache/spark/pull/39899","diff_url":"https://github.com/apache/spark/pull/39899.diff","patch_url":"https://github.com/apache/spark/pull/39899.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39899","number":39899,"state":"closed","locked":false,"title":"[SPARK-42355][BUILD] Upgrade some maven-plugins","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis pr aims upgrade maven plugins including:\r\n\r\n- maven-checkstyle-plugin: from 3.2.0 to 3.2.1\r\n- maven-clean-plugin: from 3.1.0 to 3.2.0\r\n- maven-dependency-plugin: from 3.3.0 to 3.5.0\r\n- maven-source-plugin: from 3.1.0 to 3.2.1\r\n- maven-surefire-plugin: from 3.0.0-M7 to 3.0.0-M8\r\n- maven-jar-plugin: from 3.2.2 to 3.3.0\r\n\r\n### Why are the changes needed?\r\n- maven-checkstyle-plugin\r\nhttps://github.com/apache/maven-checkstyle-plugin/compare/maven-checkstyle-plugin-3.2.0...maven-checkstyle-plugin-3.2.1\r\n\r\n- maven-clean-plugin\r\n3.2.0 include a new feature: https://github.com/apache/maven-clean-plugin/pull/6\r\nhttps://github.com/apache/maven-clean-plugin/releases/tag/maven-clean-plugin-3.2.0\r\n\r\n- maven-dependency-plugin\r\nhttps://github.com/apache/maven-dependency-plugin/compare/maven-dependency-plugin-3.3.0...maven-dependency-plugin-3.5.0\r\n\r\n- maven-source-plugin\r\nhttps://github.com/apache/maven-source-plugin/compare/maven-source-plugin-3.1.0...maven-source-plugin-3.2.1\r\n\r\n- maven-surefire-plugin\r\nhttps://github.com/apache/maven-surefire/compare/surefire-3.0.0-M7...surefire-3.0.0-M8\r\n\r\n- maven-jar-plugin\r\nhttps://github.com/apache/maven-jar-plugin/releases/tag/maven-jar-plugin-3.3.0\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n\r\n- Pass GitHub Actions\r\n- Manually check these plugins work normally","created_at":"2023-02-06T08:19:27Z","updated_at":"2023-06-09T07:04:05Z","closed_at":"2023-02-09T02:46:33Z","merged_at":null,"merge_commit_sha":"c6c897261e7f36112d3345e74cba72745874e25e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39899/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39899/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39899/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/73d90f22bc7eaa22753608e28196b5bfed29b43f","head":{"label":"LuciferYang:SPARK-42355","ref":"SPARK-42355","sha":"73d90f22bc7eaa22753608e28196b5bfed29b43f","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"04550edd49ee587656d215e59d6a072772d7d5ec","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39899"},"html":{"href":"https://github.com/apache/spark/pull/39899"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39899"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39899/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39899/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39899/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/73d90f22bc7eaa22753608e28196b5bfed29b43f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39898","id":1230026471,"node_id":"PR_kwDOAQXtWs5JULbn","html_url":"https://github.com/apache/spark/pull/39898","diff_url":"https://github.com/apache/spark/pull/39898.diff","patch_url":"https://github.com/apache/spark/pull/39898.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39898","number":39898,"state":"closed","locked":false,"title":"[SPARK-42354][BUILD] Upgrade jackson to 2.14.2","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis pr aims upgrade `Jackson` related dependencies to 2.14.2\r\n\r\n\r\n\r\n### Why are the changes needed?\r\nThis version include some bug fix and improvement of databind, such as:\r\n\r\n- https://github.com/FasterXML/jackson-databind/issues/3063\r\n- https://github.com/FasterXML/jackson-databind/issues/3699\r\n\r\nThe full release notes as follows:\r\n\r\n- https://github.com/FasterXML/jackson/wiki/Jackson-Release-2.14.2\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nPass Github Actions","created_at":"2023-02-06T08:09:17Z","updated_at":"2023-06-09T07:04:11Z","closed_at":"2023-02-07T05:08:32Z","merged_at":null,"merge_commit_sha":"f7916574a785a7f08e2ee1c37fd3ac0b83b6df98","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39898/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39898/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39898/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a411cccdf692eadb6d0ff3558c9db12829a69b32","head":{"label":"LuciferYang:SPARK-42354","ref":"SPARK-42354","sha":"a411cccdf692eadb6d0ff3558c9db12829a69b32","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fbfcd81e65630260273148fb19ee3e471056119d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39898"},"html":{"href":"https://github.com/apache/spark/pull/39898"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39898"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39898/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39898/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39898/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a411cccdf692eadb6d0ff3558c9db12829a69b32"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39897","id":1230012814,"node_id":"PR_kwDOAQXtWs5JUIGO","html_url":"https://github.com/apache/spark/pull/39897","diff_url":"https://github.com/apache/spark/pull/39897.diff","patch_url":"https://github.com/apache/spark/pull/39897.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39897","number":39897,"state":"closed","locked":false,"title":"[SPARK-42353][SS] Cleanup orphan sst and log files in RocksDB checkpoint directory","user":{"login":"chaoqin-li1123","id":55518381,"node_id":"MDQ6VXNlcjU1NTE4Mzgx","avatar_url":"https://avatars.githubusercontent.com/u/55518381?v=4","gravatar_id":"","url":"https://api.github.com/users/chaoqin-li1123","html_url":"https://github.com/chaoqin-li1123","followers_url":"https://api.github.com/users/chaoqin-li1123/followers","following_url":"https://api.github.com/users/chaoqin-li1123/following{/other_user}","gists_url":"https://api.github.com/users/chaoqin-li1123/gists{/gist_id}","starred_url":"https://api.github.com/users/chaoqin-li1123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chaoqin-li1123/subscriptions","organizations_url":"https://api.github.com/users/chaoqin-li1123/orgs","repos_url":"https://api.github.com/users/chaoqin-li1123/repos","events_url":"https://api.github.com/users/chaoqin-li1123/events{/privacy}","received_events_url":"https://api.github.com/users/chaoqin-li1123/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nWhen RocksDB version.zip file get overwritten (e.g. concurrent task execution, task/stage/batch reattempts) or the zip file don't get uploaded successfully, the associated sst and log files don't get garbage collected. We can clean up these SST files during periodic state store maintenance. The major concern is that sst files for ongoing version also appear to be \"orphan\" because they are uploaded before zip file, we have to be careful not to delete them. To be conservative, we only delete orphan files older than all files tracked by current metadata when there are at least 2 versions.\r\n\r\n\r\n### Why are the changes needed?\r\nWhen RocksDB version.zip file get overwritten (e.g. concurrent task execution, task/stage/batch reattempts) or the zip file don't get uploaded successfully, the associated sst and log files don't get garbage collected.([https://github.com/databricks/runtime/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/streaming/state/RocksDBFileManager.scala](https://github.com/databricks/runtime/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/streaming/state/RocksDBFileManager.scala#L305-L309)) These files consume storage. \r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nAdd unit test.\r\n","created_at":"2023-02-06T07:58:17Z","updated_at":"2023-02-09T23:22:14Z","closed_at":"2023-02-09T23:22:14Z","merged_at":null,"merge_commit_sha":"fba234c088165f7bfe85c3a479b79a87dd06bef1","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39897/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39897/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39897/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3f3d16081f7382f77b5e2cf8db72d9a7e47517e2","head":{"label":"chaoqin-li1123:orphan_cleanup","ref":"orphan_cleanup","sha":"3f3d16081f7382f77b5e2cf8db72d9a7e47517e2","user":{"login":"chaoqin-li1123","id":55518381,"node_id":"MDQ6VXNlcjU1NTE4Mzgx","avatar_url":"https://avatars.githubusercontent.com/u/55518381?v=4","gravatar_id":"","url":"https://api.github.com/users/chaoqin-li1123","html_url":"https://github.com/chaoqin-li1123","followers_url":"https://api.github.com/users/chaoqin-li1123/followers","following_url":"https://api.github.com/users/chaoqin-li1123/following{/other_user}","gists_url":"https://api.github.com/users/chaoqin-li1123/gists{/gist_id}","starred_url":"https://api.github.com/users/chaoqin-li1123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chaoqin-li1123/subscriptions","organizations_url":"https://api.github.com/users/chaoqin-li1123/orgs","repos_url":"https://api.github.com/users/chaoqin-li1123/repos","events_url":"https://api.github.com/users/chaoqin-li1123/events{/privacy}","received_events_url":"https://api.github.com/users/chaoqin-li1123/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":538626126,"node_id":"R_kgDOIBrITg","name":"spark","full_name":"chaoqin-li1123/spark","private":false,"owner":{"login":"chaoqin-li1123","id":55518381,"node_id":"MDQ6VXNlcjU1NTE4Mzgx","avatar_url":"https://avatars.githubusercontent.com/u/55518381?v=4","gravatar_id":"","url":"https://api.github.com/users/chaoqin-li1123","html_url":"https://github.com/chaoqin-li1123","followers_url":"https://api.github.com/users/chaoqin-li1123/followers","following_url":"https://api.github.com/users/chaoqin-li1123/following{/other_user}","gists_url":"https://api.github.com/users/chaoqin-li1123/gists{/gist_id}","starred_url":"https://api.github.com/users/chaoqin-li1123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chaoqin-li1123/subscriptions","organizations_url":"https://api.github.com/users/chaoqin-li1123/orgs","repos_url":"https://api.github.com/users/chaoqin-li1123/repos","events_url":"https://api.github.com/users/chaoqin-li1123/events{/privacy}","received_events_url":"https://api.github.com/users/chaoqin-li1123/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/chaoqin-li1123/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/chaoqin-li1123/spark","forks_url":"https://api.github.com/repos/chaoqin-li1123/spark/forks","keys_url":"https://api.github.com/repos/chaoqin-li1123/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/chaoqin-li1123/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/chaoqin-li1123/spark/teams","hooks_url":"https://api.github.com/repos/chaoqin-li1123/spark/hooks","issue_events_url":"https://api.github.com/repos/chaoqin-li1123/spark/issues/events{/number}","events_url":"https://api.github.com/repos/chaoqin-li1123/spark/events","assignees_url":"https://api.github.com/repos/chaoqin-li1123/spark/assignees{/user}","branches_url":"https://api.github.com/repos/chaoqin-li1123/spark/branches{/branch}","tags_url":"https://api.github.com/repos/chaoqin-li1123/spark/tags","blobs_url":"https://api.github.com/repos/chaoqin-li1123/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/chaoqin-li1123/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/chaoqin-li1123/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/chaoqin-li1123/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/chaoqin-li1123/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/chaoqin-li1123/spark/languages","stargazers_url":"https://api.github.com/repos/chaoqin-li1123/spark/stargazers","contributors_url":"https://api.github.com/repos/chaoqin-li1123/spark/contributors","subscribers_url":"https://api.github.com/repos/chaoqin-li1123/spark/subscribers","subscription_url":"https://api.github.com/repos/chaoqin-li1123/spark/subscription","commits_url":"https://api.github.com/repos/chaoqin-li1123/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/chaoqin-li1123/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/chaoqin-li1123/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/chaoqin-li1123/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/chaoqin-li1123/spark/contents/{+path}","compare_url":"https://api.github.com/repos/chaoqin-li1123/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/chaoqin-li1123/spark/merges","archive_url":"https://api.github.com/repos/chaoqin-li1123/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/chaoqin-li1123/spark/downloads","issues_url":"https://api.github.com/repos/chaoqin-li1123/spark/issues{/number}","pulls_url":"https://api.github.com/repos/chaoqin-li1123/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/chaoqin-li1123/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/chaoqin-li1123/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/chaoqin-li1123/spark/labels{/name}","releases_url":"https://api.github.com/repos/chaoqin-li1123/spark/releases{/id}","deployments_url":"https://api.github.com/repos/chaoqin-li1123/spark/deployments","created_at":"2022-09-19T17:46:41Z","updated_at":"2024-08-15T18:30:16Z","pushed_at":"2024-09-12T22:08:02Z","git_url":"git://github.com/chaoqin-li1123/spark.git","ssh_url":"git@github.com:chaoqin-li1123/spark.git","clone_url":"https://github.com/chaoqin-li1123/spark.git","svn_url":"https://github.com/chaoqin-li1123/spark","homepage":"https://spark.apache.org/","size":412663,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":3,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fdcf85ee263f406597aa99a2f9a187bb9cd1ef76","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39897"},"html":{"href":"https://github.com/apache/spark/pull/39897"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39897"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39897/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39897/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39897/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3f3d16081f7382f77b5e2cf8db72d9a7e47517e2"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39896","id":1229983563,"node_id":"PR_kwDOAQXtWs5JUA9L","html_url":"https://github.com/apache/spark/pull/39896","diff_url":"https://github.com/apache/spark/pull/39896.diff","patch_url":"https://github.com/apache/spark/pull/39896.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39896","number":39896,"state":"closed","locked":false,"title":"[SPARK-42352][BUILD] Upgrade maven to 3.8.7","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR aims to upgrade Maven to 3.8.7 from 3.8.6.\r\n\r\n\r\n\r\n### Why are the changes needed?\r\nThe release notes and as follows:\r\n\r\n- https://maven.apache.org/docs/3.8.7/release-notes.html\r\n- https://github.com/apache/maven/releases/tag/maven-3.8.7\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n\r\n- Pass GitHub Actions\r\n- Manual test :\r\n\r\nrun `build/mvn -version` wll trigger download `apache-maven-3.8.7-bin.tar.gz`\r\n\r\n```\r\nexec: curl --silent --show-error -L https://www.apache.org/dyn/closer.lua/maven/maven-3/3.8.7/binaries/apache-maven-3.8.7-bin.tar.gz?action=download\r\n```\r\n\r\nrun `./dev/test-dependencies.sh --replace-manifest`  doesn't generate git diff","created_at":"2023-02-06T07:24:33Z","updated_at":"2023-06-09T07:04:08Z","closed_at":"2023-02-08T00:17:58Z","merged_at":null,"merge_commit_sha":"c26c72727c0bdcfc9f633c45d86b9ba030b1a286","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39896/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39896/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39896/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/564b5e435b527cb033baf00a4e767dea72f82763","head":{"label":"LuciferYang:mvn-387","ref":"mvn-387","sha":"564b5e435b527cb033baf00a4e767dea72f82763","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fdcf85ee263f406597aa99a2f9a187bb9cd1ef76","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39896"},"html":{"href":"https://github.com/apache/spark/pull/39896"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39896"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39896/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39896/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39896/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/564b5e435b527cb033baf00a4e767dea72f82763"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39895","id":1229935493,"node_id":"PR_kwDOAQXtWs5JT1OF","html_url":"https://github.com/apache/spark/pull/39895","diff_url":"https://github.com/apache/spark/pull/39895.diff","patch_url":"https://github.com/apache/spark/pull/39895.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39895","number":39895,"state":"closed","locked":false,"title":"[SPARK-40149][SQL][FOLLOWUP] Avoid adding extra Project in AddMetadataColumns","user":{"login":"allisonwang-db","id":66282705,"node_id":"MDQ6VXNlcjY2MjgyNzA1","avatar_url":"https://avatars.githubusercontent.com/u/66282705?v=4","gravatar_id":"","url":"https://api.github.com/users/allisonwang-db","html_url":"https://github.com/allisonwang-db","followers_url":"https://api.github.com/users/allisonwang-db/followers","following_url":"https://api.github.com/users/allisonwang-db/following{/other_user}","gists_url":"https://api.github.com/users/allisonwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/allisonwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/allisonwang-db/subscriptions","organizations_url":"https://api.github.com/users/allisonwang-db/orgs","repos_url":"https://api.github.com/users/allisonwang-db/repos","events_url":"https://api.github.com/users/allisonwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/allisonwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nThis PR is a follow-up for #37758. It updates the rule `AddMetadataColumns` to avoid introducing extra `Project`.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo fix an issue introduced by #37758.\r\n```sql\r\n-- t1: [key, value] t2: [key, value]\r\nselect t1.key, t2.key from t1 full outer join t2 using (key)\r\n```\r\nBefore this PR, the rule `AddMetadataColumns` will add a new Project between the using join and the select list:\r\n```\r\nProject [key, key]\r\n+- Project [key, key, key, key] <--- extra project\r\n   +- Project [coalesce(key, key) AS key, value, value, key, key]\r\n      +- Join FullOuter, (key = key)\r\n         :- LocalRelation <empty>, [key#0, value#0]\r\n         +- LocalRelation <empty>, [key#0, value#0]\r\n```\r\nAfter this PR, this extra Project will be removed.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nAdd a new UT.","created_at":"2023-02-06T06:38:12Z","updated_at":"2023-02-07T02:22:09Z","closed_at":"2023-02-07T02:22:09Z","merged_at":null,"merge_commit_sha":"c0790747a944230158462975f7c1105c0c37a83a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39895/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39895/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39895/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/524753ac43e7f6bcdbb05be5976a6055afda3e24","head":{"label":"allisonwang-db:spark-40149-follow-up","ref":"spark-40149-follow-up","sha":"524753ac43e7f6bcdbb05be5976a6055afda3e24","user":{"login":"allisonwang-db","id":66282705,"node_id":"MDQ6VXNlcjY2MjgyNzA1","avatar_url":"https://avatars.githubusercontent.com/u/66282705?v=4","gravatar_id":"","url":"https://api.github.com/users/allisonwang-db","html_url":"https://github.com/allisonwang-db","followers_url":"https://api.github.com/users/allisonwang-db/followers","following_url":"https://api.github.com/users/allisonwang-db/following{/other_user}","gists_url":"https://api.github.com/users/allisonwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/allisonwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/allisonwang-db/subscriptions","organizations_url":"https://api.github.com/users/allisonwang-db/orgs","repos_url":"https://api.github.com/users/allisonwang-db/repos","events_url":"https://api.github.com/users/allisonwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/allisonwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":271915022,"node_id":"MDEwOlJlcG9zaXRvcnkyNzE5MTUwMjI=","name":"spark","full_name":"allisonwang-db/spark","private":false,"owner":{"login":"allisonwang-db","id":66282705,"node_id":"MDQ6VXNlcjY2MjgyNzA1","avatar_url":"https://avatars.githubusercontent.com/u/66282705?v=4","gravatar_id":"","url":"https://api.github.com/users/allisonwang-db","html_url":"https://github.com/allisonwang-db","followers_url":"https://api.github.com/users/allisonwang-db/followers","following_url":"https://api.github.com/users/allisonwang-db/following{/other_user}","gists_url":"https://api.github.com/users/allisonwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/allisonwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/allisonwang-db/subscriptions","organizations_url":"https://api.github.com/users/allisonwang-db/orgs","repos_url":"https://api.github.com/users/allisonwang-db/repos","events_url":"https://api.github.com/users/allisonwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/allisonwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/allisonwang-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/allisonwang-db/spark","forks_url":"https://api.github.com/repos/allisonwang-db/spark/forks","keys_url":"https://api.github.com/repos/allisonwang-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/allisonwang-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/allisonwang-db/spark/teams","hooks_url":"https://api.github.com/repos/allisonwang-db/spark/hooks","issue_events_url":"https://api.github.com/repos/allisonwang-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/allisonwang-db/spark/events","assignees_url":"https://api.github.com/repos/allisonwang-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/allisonwang-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/allisonwang-db/spark/tags","blobs_url":"https://api.github.com/repos/allisonwang-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/allisonwang-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/allisonwang-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/allisonwang-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/allisonwang-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/allisonwang-db/spark/languages","stargazers_url":"https://api.github.com/repos/allisonwang-db/spark/stargazers","contributors_url":"https://api.github.com/repos/allisonwang-db/spark/contributors","subscribers_url":"https://api.github.com/repos/allisonwang-db/spark/subscribers","subscription_url":"https://api.github.com/repos/allisonwang-db/spark/subscription","commits_url":"https://api.github.com/repos/allisonwang-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/allisonwang-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/allisonwang-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/allisonwang-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/allisonwang-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/allisonwang-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/allisonwang-db/spark/merges","archive_url":"https://api.github.com/repos/allisonwang-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/allisonwang-db/spark/downloads","issues_url":"https://api.github.com/repos/allisonwang-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/allisonwang-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/allisonwang-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/allisonwang-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/allisonwang-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/allisonwang-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/allisonwang-db/spark/deployments","created_at":"2020-06-13T00:43:34Z","updated_at":"2025-01-07T02:25:07Z","pushed_at":"2025-01-24T00:00:13Z","git_url":"git://github.com/allisonwang-db/spark.git","ssh_url":"git@github.com:allisonwang-db/spark.git","clone_url":"https://github.com/allisonwang-db/spark.git","svn_url":"https://github.com/allisonwang-db/spark","homepage":"https://spark.apache.org/","size":467528,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fdcf85ee263f406597aa99a2f9a187bb9cd1ef76","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39895"},"html":{"href":"https://github.com/apache/spark/pull/39895"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39895"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39895/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39895/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39895/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/524753ac43e7f6bcdbb05be5976a6055afda3e24"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39894","id":1229889161,"node_id":"PR_kwDOAQXtWs5JTp6J","html_url":"https://github.com/apache/spark/pull/39894","diff_url":"https://github.com/apache/spark/pull/39894.diff","patch_url":"https://github.com/apache/spark/pull/39894.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39894","number":39894,"state":"closed","locked":false,"title":"[SPARK-42351][CORE] Protobuf serializer for FsHistoryProviderMetadata","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nAdd Protobuf serializer for `FsHistoryProviderMetadata`\r\n\r\n### Why are the changes needed?\r\nSupport fast and compact serialization/deserialization for `FsHistoryProviderMetadata` over RocksDB.\r\n\r\n### Does this PR introduce any user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nNew UT","created_at":"2023-02-06T05:40:28Z","updated_at":"2023-06-09T07:04:10Z","closed_at":"2023-02-10T02:27:57Z","merged_at":null,"merge_commit_sha":"8218ff4e5447af702b851d259dc796eeb1250245","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39894/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39894/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39894/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6f443338a070b110ef19d1dd3144e2474fe95642","head":{"label":"LuciferYang:SPARK-42351","ref":"SPARK-42351","sha":"6f443338a070b110ef19d1dd3144e2474fe95642","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fdcf85ee263f406597aa99a2f9a187bb9cd1ef76","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39894"},"html":{"href":"https://github.com/apache/spark/pull/39894"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39894"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39894/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39894/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39894/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6f443338a070b110ef19d1dd3144e2474fe95642"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39893","id":1229864984,"node_id":"PR_kwDOAQXtWs5JTkAY","html_url":"https://github.com/apache/spark/pull/39893","diff_url":"https://github.com/apache/spark/pull/39893.diff","patch_url":"https://github.com/apache/spark/pull/39893.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39893","number":39893,"state":"closed","locked":false,"title":"[SPARK-42350][SQL][K8S][SS] Replcace `get().getOrElse` with `getOrElse`","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis pr just a trivial fix, replcace `get().getOrElse` with `getOrElse`\r\n\r\n\r\n### Why are the changes needed?\r\nCode simplification\r\n\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nPass GitHub Actions\r\n","created_at":"2023-02-06T05:08:54Z","updated_at":"2023-06-09T07:04:11Z","closed_at":"2023-02-09T02:45:39Z","merged_at":null,"merge_commit_sha":"5ec6eea464198b43694035f03ff9fe339925aecf","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1406605057,"node_id":"MDU6TGFiZWwxNDA2NjA1MDU3","url":"https://api.github.com/repos/apache/spark/labels/KUBERNETES","name":"KUBERNETES","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39893/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39893/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39893/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d2cadcc8a91521ee56cb99ccfb163b5026f9a71a","head":{"label":"LuciferYang:getOrElse","ref":"getOrElse","sha":"d2cadcc8a91521ee56cb99ccfb163b5026f9a71a","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fdcf85ee263f406597aa99a2f9a187bb9cd1ef76","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39893"},"html":{"href":"https://github.com/apache/spark/pull/39893"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39893"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39893/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39893/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39893/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d2cadcc8a91521ee56cb99ccfb163b5026f9a71a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39892","id":1229722280,"node_id":"PR_kwDOAQXtWs5JTBKo","html_url":"https://github.com/apache/spark/pull/39892","diff_url":"https://github.com/apache/spark/pull/39892.diff","patch_url":"https://github.com/apache/spark/pull/39892.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39892","number":39892,"state":"closed","locked":false,"title":"[SPARK-40045][SQL]Optimize the order of filtering predicates","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"All the credit of this PR goes to @caican00. Here is the original [PR](https://github.com/apache/spark/pull/37479)\r\n\r\n### What changes were proposed in this pull request?\r\nput untranslated filters to the right side of the translated filters.\r\n\r\n\r\n### Why are the changes needed?\r\nNormally the translated filters (postScanFilters) are simple filters that can be evaluated faster, while the untranslated filters are complicated filters that take more time to evaluate, so we want to evaluate the postScanFilters filters first.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nnew UT\r\n","created_at":"2023-02-06T02:07:32Z","updated_at":"2023-02-08T05:32:36Z","closed_at":"2023-02-08T05:04:37Z","merged_at":null,"merge_commit_sha":"b65f2902788e1ba062ef37848c8ae74387285add","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39892/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39892/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39892/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/96e05ee20522ceaa4a52708230517f44756d5b03","head":{"label":"huaxingao:filter_order","ref":"filter_order","sha":"96e05ee20522ceaa4a52708230517f44756d5b03","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":50813048,"node_id":"MDEwOlJlcG9zaXRvcnk1MDgxMzA0OA==","name":"spark","full_name":"huaxingao/spark","private":false,"owner":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/huaxingao/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/huaxingao/spark","forks_url":"https://api.github.com/repos/huaxingao/spark/forks","keys_url":"https://api.github.com/repos/huaxingao/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/huaxingao/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/huaxingao/spark/teams","hooks_url":"https://api.github.com/repos/huaxingao/spark/hooks","issue_events_url":"https://api.github.com/repos/huaxingao/spark/issues/events{/number}","events_url":"https://api.github.com/repos/huaxingao/spark/events","assignees_url":"https://api.github.com/repos/huaxingao/spark/assignees{/user}","branches_url":"https://api.github.com/repos/huaxingao/spark/branches{/branch}","tags_url":"https://api.github.com/repos/huaxingao/spark/tags","blobs_url":"https://api.github.com/repos/huaxingao/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/huaxingao/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/huaxingao/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/huaxingao/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/huaxingao/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/huaxingao/spark/languages","stargazers_url":"https://api.github.com/repos/huaxingao/spark/stargazers","contributors_url":"https://api.github.com/repos/huaxingao/spark/contributors","subscribers_url":"https://api.github.com/repos/huaxingao/spark/subscribers","subscription_url":"https://api.github.com/repos/huaxingao/spark/subscription","commits_url":"https://api.github.com/repos/huaxingao/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/huaxingao/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/huaxingao/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/huaxingao/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/huaxingao/spark/contents/{+path}","compare_url":"https://api.github.com/repos/huaxingao/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/huaxingao/spark/merges","archive_url":"https://api.github.com/repos/huaxingao/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/huaxingao/spark/downloads","issues_url":"https://api.github.com/repos/huaxingao/spark/issues{/number}","pulls_url":"https://api.github.com/repos/huaxingao/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/huaxingao/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/huaxingao/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/huaxingao/spark/labels{/name}","releases_url":"https://api.github.com/repos/huaxingao/spark/releases{/id}","deployments_url":"https://api.github.com/repos/huaxingao/spark/deployments","created_at":"2016-02-01T04:09:11Z","updated_at":"2022-01-06T22:35:11Z","pushed_at":"2023-12-21T02:21:07Z","git_url":"git://github.com/huaxingao/spark.git","ssh_url":"git@github.com:huaxingao/spark.git","clone_url":"https://github.com/huaxingao/spark.git","svn_url":"https://github.com/huaxingao/spark","homepage":null,"size":376946,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"6bb68b5f75ac883423a68583750258656f381c33","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39892"},"html":{"href":"https://github.com/apache/spark/pull/39892"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39892"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39892/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39892/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39892/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/96e05ee20522ceaa4a52708230517f44756d5b03"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39891","id":1229430505,"node_id":"PR_kwDOAQXtWs5JR57p","html_url":"https://github.com/apache/spark/pull/39891","diff_url":"https://github.com/apache/spark/pull/39891.diff","patch_url":"https://github.com/apache/spark/pull/39891.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39891","number":39891,"state":"closed","locked":false,"title":"[SPARK-42318][SPARK-42319][SQL] Assign name to _LEGACY_ERROR_TEMP_(2123|2125)","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to assign name to _LEGACY_ERROR_TEMP_2123 and _LEGACY_ERROR_TEMP_2125, \"CANNOT_MERGE_INCOMPATIBLE_DATA_TYPE\".\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*`","created_at":"2023-02-05T12:34:48Z","updated_at":"2023-04-22T05:47:39Z","closed_at":"2023-02-08T19:18:34Z","merged_at":null,"merge_commit_sha":"f96af70614e85e3e8a60614129a6bd9e32e9efab","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39891/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39891/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39891/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/4e3494b0d3e5d4dc63df2674b03778332ffed7e6","head":{"label":"itholic:LEGACY_2125","ref":"LEGACY_2125","sha":"4e3494b0d3e5d4dc63df2674b03778332ffed7e6","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f8e06c1e1bb335180ce01ba5c8a079687ebcecf1","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39891"},"html":{"href":"https://github.com/apache/spark/pull/39891"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39891"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39891/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39891/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39891/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/4e3494b0d3e5d4dc63df2674b03778332ffed7e6"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39890","id":1229420484,"node_id":"PR_kwDOAQXtWs5JR3fE","html_url":"https://github.com/apache/spark/pull/39890","diff_url":"https://github.com/apache/spark/pull/39890.diff","patch_url":"https://github.com/apache/spark/pull/39890.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39890","number":39890,"state":"closed","locked":false,"title":"[SPARK-42314][SQL] Assign name to _LEGACY_ERROR_TEMP_2127","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to assign name to _LEGACY_ERROR_TEMP_2127, \"DUPLICATED_MAP_KEY\".\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*`","created_at":"2023-02-05T11:51:58Z","updated_at":"2023-04-22T05:47:40Z","closed_at":"2023-02-08T17:47:36Z","merged_at":null,"merge_commit_sha":"6c5f85f1c229fa4ec9e9d3e635df1b3a252c0024","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39890/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39890/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39890/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0966d7f1f7530c8d92edab3d130c072d9914bd45","head":{"label":"itholic:LEGACY_2127","ref":"LEGACY_2127","sha":"0966d7f1f7530c8d92edab3d130c072d9914bd45","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"9ac46408ec943d5121bbc14f2ce0d8b2ff453de5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39890"},"html":{"href":"https://github.com/apache/spark/pull/39890"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39890"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39890/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39890/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39890/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0966d7f1f7530c8d92edab3d130c072d9914bd45"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39889","id":1229413483,"node_id":"PR_kwDOAQXtWs5JR1xr","html_url":"https://github.com/apache/spark/pull/39889","diff_url":"https://github.com/apache/spark/pull/39889.diff","patch_url":"https://github.com/apache/spark/pull/39889.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39889","number":39889,"state":"closed","locked":false,"title":"[SPARK-42315][SQL] Assign name to _LEGACY_ERROR_TEMP_(2091|2092)","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to assign name to _LEGACY_ERROR_TEMP_2091 and _LEGACY_ERROR_TEMP_2091, \"CANNOT_READ_FOOTER\".\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*`","created_at":"2023-02-05T11:18:34Z","updated_at":"2023-04-22T05:47:46Z","closed_at":"2023-02-08T05:26:07Z","merged_at":null,"merge_commit_sha":"abb31c058dd28a8e07b2d8ce7717cbd6ef87fa11","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39889/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39889/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39889/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b01c43fffe1022ebf564382fcc5e17ab46834336","head":{"label":"itholic:LEGACY_2092","ref":"LEGACY_2092","sha":"b01c43fffe1022ebf564382fcc5e17ab46834336","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"52d369419ecb97385b76474a01e63c6f6c2c0797","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39889"},"html":{"href":"https://github.com/apache/spark/pull/39889"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39889"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39889/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39889/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39889/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b01c43fffe1022ebf564382fcc5e17ab46834336"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39888","id":1229405727,"node_id":"PR_kwDOAQXtWs5JRz4f","html_url":"https://github.com/apache/spark/pull/39888","diff_url":"https://github.com/apache/spark/pull/39888.diff","patch_url":"https://github.com/apache/spark/pull/39888.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39888","number":39888,"state":"closed","locked":false,"title":"[SPARK-42320][SQL] Assign name to _LEGACY_ERROR_TEMP_2188","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to assign name to _LEGACY_ERROR_TEMP_2188, \"CANNOT_RECOGNIZE_HIVE_TYPE\".\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*`","created_at":"2023-02-05T10:42:26Z","updated_at":"2023-04-22T05:48:37Z","closed_at":"2023-02-06T10:48:24Z","merged_at":null,"merge_commit_sha":"e89d3a27f868a48fc61efb79ff3b83b7907301bf","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39888/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39888/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39888/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/be92d4359b010ec4a21b0f096da58d0f0d8477ef","head":{"label":"itholic:LEGACY_2188","ref":"LEGACY_2188","sha":"be92d4359b010ec4a21b0f096da58d0f0d8477ef","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"6bb68b5f75ac883423a68583750258656f381c33","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39888"},"html":{"href":"https://github.com/apache/spark/pull/39888"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39888"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39888/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39888/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39888/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/be92d4359b010ec4a21b0f096da58d0f0d8477ef"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39887","id":1229401069,"node_id":"PR_kwDOAQXtWs5JRyvt","html_url":"https://github.com/apache/spark/pull/39887","diff_url":"https://github.com/apache/spark/pull/39887.diff","patch_url":"https://github.com/apache/spark/pull/39887.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39887","number":39887,"state":"closed","locked":false,"title":"[SPARK-42346][SQL] Rewrite distinct aggregates after subquery merge","user":{"login":"peter-toth","id":7253827,"node_id":"MDQ6VXNlcjcyNTM4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/7253827?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-toth","html_url":"https://github.com/peter-toth","followers_url":"https://api.github.com/users/peter-toth/followers","following_url":"https://api.github.com/users/peter-toth/following{/other_user}","gists_url":"https://api.github.com/users/peter-toth/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-toth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-toth/subscriptions","organizations_url":"https://api.github.com/users/peter-toth/orgs","repos_url":"https://api.github.com/users/peter-toth/repos","events_url":"https://api.github.com/users/peter-toth/events{/privacy}","received_events_url":"https://api.github.com/users/peter-toth/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nUnfortunately https://github.com/apache/spark/pull/32298 introduced a regression from Spark 3.2 to 3.3 as after that change a merged subquery can contain multiple distict type aggregates. Those aggregates need to be rewritten by the `RewriteDistinctAggregates` rule to get the correct results. This PR fixed that. \r\n\r\n### Why are the changes needed?\r\nThe following query:\r\n```\r\nSELECT\r\n  (SELECT count(distinct c1) FROM t1),\r\n  (SELECT count(distinct c2) FROM t1)\r\n```\r\ncurrently fails with:\r\n```\r\njava.lang.IllegalStateException: You hit a query analyzer bug. Please report your query to Spark user mailing list.\r\n\tat org.apache.spark.sql.execution.SparkStrategies$Aggregation$.apply(SparkStrategies.scala:538)\r\n```\r\nbut works again after this PR.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes, the above query works again.\r\n\r\n### How was this patch tested?\r\nAdded new UT.\r\n","created_at":"2023-02-05T10:18:27Z","updated_at":"2023-02-06T13:41:54Z","closed_at":"2023-02-06T12:37:08Z","merged_at":null,"merge_commit_sha":"0aaadf5fba4d68b0ee7da56a8e3a80bc52bf9f28","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39887/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39887/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39887/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/acd4fda0532f24fda67395fe2921cb9d24b2ef80","head":{"label":"peter-toth:SPARK-42346-rewrite-distinct-aggregates-after-subquery-merge","ref":"SPARK-42346-rewrite-distinct-aggregates-after-subquery-merge","sha":"acd4fda0532f24fda67395fe2921cb9d24b2ef80","user":{"login":"peter-toth","id":7253827,"node_id":"MDQ6VXNlcjcyNTM4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/7253827?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-toth","html_url":"https://github.com/peter-toth","followers_url":"https://api.github.com/users/peter-toth/followers","following_url":"https://api.github.com/users/peter-toth/following{/other_user}","gists_url":"https://api.github.com/users/peter-toth/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-toth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-toth/subscriptions","organizations_url":"https://api.github.com/users/peter-toth/orgs","repos_url":"https://api.github.com/users/peter-toth/repos","events_url":"https://api.github.com/users/peter-toth/events{/privacy}","received_events_url":"https://api.github.com/users/peter-toth/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":130546049,"node_id":"MDEwOlJlcG9zaXRvcnkxMzA1NDYwNDk=","name":"spark","full_name":"peter-toth/spark","private":false,"owner":{"login":"peter-toth","id":7253827,"node_id":"MDQ6VXNlcjcyNTM4Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/7253827?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-toth","html_url":"https://github.com/peter-toth","followers_url":"https://api.github.com/users/peter-toth/followers","following_url":"https://api.github.com/users/peter-toth/following{/other_user}","gists_url":"https://api.github.com/users/peter-toth/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-toth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-toth/subscriptions","organizations_url":"https://api.github.com/users/peter-toth/orgs","repos_url":"https://api.github.com/users/peter-toth/repos","events_url":"https://api.github.com/users/peter-toth/events{/privacy}","received_events_url":"https://api.github.com/users/peter-toth/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/peter-toth/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/peter-toth/spark","forks_url":"https://api.github.com/repos/peter-toth/spark/forks","keys_url":"https://api.github.com/repos/peter-toth/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/peter-toth/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/peter-toth/spark/teams","hooks_url":"https://api.github.com/repos/peter-toth/spark/hooks","issue_events_url":"https://api.github.com/repos/peter-toth/spark/issues/events{/number}","events_url":"https://api.github.com/repos/peter-toth/spark/events","assignees_url":"https://api.github.com/repos/peter-toth/spark/assignees{/user}","branches_url":"https://api.github.com/repos/peter-toth/spark/branches{/branch}","tags_url":"https://api.github.com/repos/peter-toth/spark/tags","blobs_url":"https://api.github.com/repos/peter-toth/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/peter-toth/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/peter-toth/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/peter-toth/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/peter-toth/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/peter-toth/spark/languages","stargazers_url":"https://api.github.com/repos/peter-toth/spark/stargazers","contributors_url":"https://api.github.com/repos/peter-toth/spark/contributors","subscribers_url":"https://api.github.com/repos/peter-toth/spark/subscribers","subscription_url":"https://api.github.com/repos/peter-toth/spark/subscription","commits_url":"https://api.github.com/repos/peter-toth/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/peter-toth/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/peter-toth/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/peter-toth/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/peter-toth/spark/contents/{+path}","compare_url":"https://api.github.com/repos/peter-toth/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/peter-toth/spark/merges","archive_url":"https://api.github.com/repos/peter-toth/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/peter-toth/spark/downloads","issues_url":"https://api.github.com/repos/peter-toth/spark/issues{/number}","pulls_url":"https://api.github.com/repos/peter-toth/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/peter-toth/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/peter-toth/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/peter-toth/spark/labels{/name}","releases_url":"https://api.github.com/repos/peter-toth/spark/releases{/id}","deployments_url":"https://api.github.com/repos/peter-toth/spark/deployments","created_at":"2018-04-22T07:43:37Z","updated_at":"2025-01-06T11:44:37Z","pushed_at":"2025-01-07T12:36:36Z","git_url":"git://github.com/peter-toth/spark.git","ssh_url":"git@github.com:peter-toth/spark.git","clone_url":"https://github.com/peter-toth/spark.git","svn_url":"https://github.com/peter-toth/spark","homepage":null,"size":498613,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":3,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"c5c1927d6a137c0e92417a0efad5da62ab253137","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39887"},"html":{"href":"https://github.com/apache/spark/pull/39887"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39887"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39887/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39887/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39887/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/acd4fda0532f24fda67395fe2921cb9d24b2ef80"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39886","id":1229382996,"node_id":"PR_kwDOAQXtWs5JRuVU","html_url":"https://github.com/apache/spark/pull/39886","diff_url":"https://github.com/apache/spark/pull/39886.diff","patch_url":"https://github.com/apache/spark/pull/39886.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39886","number":39886,"state":"closed","locked":false,"title":"[SPARK-42348][SQL] Add new SQLSTATE","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to add new SQLSTATE defined from Databricks to `core/src/main/resources/error/README.md`.\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should use proper SQLSTATE for every SQL error classes.\r\n\r\nOtherwise, it fails on `SparkThrowableSuite.SQLSTATE invariants` test.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo.\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\nThe existing CI should pass.\r\n","created_at":"2023-02-05T08:53:57Z","updated_at":"2023-04-22T05:48:48Z","closed_at":"2023-02-06T02:35:27Z","merged_at":null,"merge_commit_sha":"2281824a16b288d6dfed93d66a43339349d0c658","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39886/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39886/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39886/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/cd0783dba8328bf9cfea7bfaecaddfb1702b627a","head":{"label":"itholic:MISSING_SQLSTATE","ref":"MISSING_SQLSTATE","sha":"cd0783dba8328bf9cfea7bfaecaddfb1702b627a","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"c5c1927d6a137c0e92417a0efad5da62ab253137","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39886"},"html":{"href":"https://github.com/apache/spark/pull/39886"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39886"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39886/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39886/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39886/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/cd0783dba8328bf9cfea7bfaecaddfb1702b627a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39885","id":1229022791,"node_id":"PR_kwDOAQXtWs5JQWZH","html_url":"https://github.com/apache/spark/pull/39885","diff_url":"https://github.com/apache/spark/pull/39885.diff","patch_url":"https://github.com/apache/spark/pull/39885.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39885","number":39885,"state":"closed","locked":false,"title":"[SPARK-42345][SQL] Rename TimestampNTZ inference conf as spark.sql.sources.timestampNTZTypeInference.enabled","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nRename TimestampNTZ data source inference configuration from `spark.sql.inferTimestampNTZInDataSources.enabled` to `spark.sql.sources.timestampNTZTypeInference.enabled`\r\nFor more context on this configuration:\r\nhttps://github.com/apache/spark/pull/39777\r\nhttps://github.com/apache/spark/pull/39812\r\nhttps://github.com/apache/spark/pull/39868\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nSince the configuration is for data source, we can put it under the prefix `spark.sql.sources`. The new naming is consistent with another configuration `spark.sql.sources.partitionColumnTypeInference.enabled`.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n","created_at":"2023-02-04T08:49:00Z","updated_at":"2023-02-05T07:43:53Z","closed_at":"2023-02-05T07:43:53Z","merged_at":null,"merge_commit_sha":"369fcb6a0b0806d2199f48e92b193d1b451717f6","assignee":null,"assignees":[],"requested_reviewers":[{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39885/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39885/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39885/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8d942495f1984c8949d4c9517617aa1f41bcc95b","head":{"label":"gengliangwang:renameConf","ref":"renameConf","sha":"8d942495f1984c8949d4c9517617aa1f41bcc95b","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4760a8bd845292f7d6d6a35320bd80082a76c7c5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39885"},"html":{"href":"https://github.com/apache/spark/pull/39885"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39885"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39885/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39885/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39885/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8d942495f1984c8949d4c9517617aa1f41bcc95b"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39884","id":1228969774,"node_id":"PR_kwDOAQXtWs5JQJcu","html_url":"https://github.com/apache/spark/pull/39884","diff_url":"https://github.com/apache/spark/pull/39884.diff","patch_url":"https://github.com/apache/spark/pull/39884.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39884","number":39884,"state":"closed","locked":false,"title":"[SPARK-42344][K8S] Change the default size of the CONFIG_MAP_MAXSIZE","user":{"login":"nineinfra","id":16333151,"node_id":"MDQ6VXNlcjE2MzMzMTUx","avatar_url":"https://avatars.githubusercontent.com/u/16333151?v=4","gravatar_id":"","url":"https://api.github.com/users/nineinfra","html_url":"https://github.com/nineinfra","followers_url":"https://api.github.com/users/nineinfra/followers","following_url":"https://api.github.com/users/nineinfra/following{/other_user}","gists_url":"https://api.github.com/users/nineinfra/gists{/gist_id}","starred_url":"https://api.github.com/users/nineinfra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nineinfra/subscriptions","organizations_url":"https://api.github.com/users/nineinfra/orgs","repos_url":"https://api.github.com/users/nineinfra/repos","events_url":"https://api.github.com/users/nineinfra/events{/privacy}","received_events_url":"https://api.github.com/users/nineinfra/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"The default size of the CONFIG_MAP_MAXSIZE should not be greater than 1048576\r\n\r\n### What changes were proposed in this pull request?\r\nThis PR changed the default size of the  CONFIG_MAP_MAXSIZE from 1572864（1.5 MiB) to 1048576（1.0 MiB）\r\n\r\n\r\n### Why are the changes needed?\r\nWhen a job is submitted by the spark to the K8S with a configmap , The Spark-Submit will call the K8S‘s POST API \"api/v1/namespaces/default/configmaps\". And the size of the configmaps will be validated by this K8S API,the max value shoud not be greater than 1048576.\r\nIn the previous comment，the explain in https://etcd.io/docs/v3.4/dev-guide/limit/ is:\r\n\"etcd is designed to handle small key value pairs typical for metadata. Larger requests will work, but may increase the latency of other requests. By default, the maximum size of any request is 1.5 MiB. This limit is configurable through --max-request-bytes flag for etcd server.\"\r\nThis explanation is from the perspective of etcd ，not K8S.\r\nSo I think the default value of the configmap in Spark should not be greate than 1048576.\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes.\r\nGenerally, the size of the configmap will not exceed 1572864 or even 1048576.\r\nSo the problem solved here may not be perceived by users.\r\n\r\n\r\n### How was this patch tested?\r\nlocal test\r\n","created_at":"2023-02-04T05:41:38Z","updated_at":"2023-02-05T11:49:18Z","closed_at":"2023-02-05T11:08:07Z","merged_at":null,"merge_commit_sha":"e62d1a542de5dcc6d31d2b85fc80dc0f9f4e4008","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406605057,"node_id":"MDU6TGFiZWwxNDA2NjA1MDU3","url":"https://api.github.com/repos/apache/spark/labels/KUBERNETES","name":"KUBERNETES","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39884/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39884/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39884/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f7f901777749bc1d58635a388f09fd8f04d49eb6","head":{"label":"nineinfra:master","ref":"master","sha":"f7f901777749bc1d58635a388f09fd8f04d49eb6","user":{"login":"nineinfra","id":16333151,"node_id":"MDQ6VXNlcjE2MzMzMTUx","avatar_url":"https://avatars.githubusercontent.com/u/16333151?v=4","gravatar_id":"","url":"https://api.github.com/users/nineinfra","html_url":"https://github.com/nineinfra","followers_url":"https://api.github.com/users/nineinfra/followers","following_url":"https://api.github.com/users/nineinfra/following{/other_user}","gists_url":"https://api.github.com/users/nineinfra/gists{/gist_id}","starred_url":"https://api.github.com/users/nineinfra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nineinfra/subscriptions","organizations_url":"https://api.github.com/users/nineinfra/orgs","repos_url":"https://api.github.com/users/nineinfra/repos","events_url":"https://api.github.com/users/nineinfra/events{/privacy}","received_events_url":"https://api.github.com/users/nineinfra/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":577725148,"node_id":"R_kgDOIm9i3A","name":"spark","full_name":"nineinfra/spark","private":false,"owner":{"login":"nineinfra","id":16333151,"node_id":"MDQ6VXNlcjE2MzMzMTUx","avatar_url":"https://avatars.githubusercontent.com/u/16333151?v=4","gravatar_id":"","url":"https://api.github.com/users/nineinfra","html_url":"https://github.com/nineinfra","followers_url":"https://api.github.com/users/nineinfra/followers","following_url":"https://api.github.com/users/nineinfra/following{/other_user}","gists_url":"https://api.github.com/users/nineinfra/gists{/gist_id}","starred_url":"https://api.github.com/users/nineinfra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nineinfra/subscriptions","organizations_url":"https://api.github.com/users/nineinfra/orgs","repos_url":"https://api.github.com/users/nineinfra/repos","events_url":"https://api.github.com/users/nineinfra/events{/privacy}","received_events_url":"https://api.github.com/users/nineinfra/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/nineinfra/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/nineinfra/spark","forks_url":"https://api.github.com/repos/nineinfra/spark/forks","keys_url":"https://api.github.com/repos/nineinfra/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/nineinfra/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/nineinfra/spark/teams","hooks_url":"https://api.github.com/repos/nineinfra/spark/hooks","issue_events_url":"https://api.github.com/repos/nineinfra/spark/issues/events{/number}","events_url":"https://api.github.com/repos/nineinfra/spark/events","assignees_url":"https://api.github.com/repos/nineinfra/spark/assignees{/user}","branches_url":"https://api.github.com/repos/nineinfra/spark/branches{/branch}","tags_url":"https://api.github.com/repos/nineinfra/spark/tags","blobs_url":"https://api.github.com/repos/nineinfra/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/nineinfra/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/nineinfra/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/nineinfra/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/nineinfra/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/nineinfra/spark/languages","stargazers_url":"https://api.github.com/repos/nineinfra/spark/stargazers","contributors_url":"https://api.github.com/repos/nineinfra/spark/contributors","subscribers_url":"https://api.github.com/repos/nineinfra/spark/subscribers","subscription_url":"https://api.github.com/repos/nineinfra/spark/subscription","commits_url":"https://api.github.com/repos/nineinfra/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/nineinfra/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/nineinfra/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/nineinfra/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/nineinfra/spark/contents/{+path}","compare_url":"https://api.github.com/repos/nineinfra/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/nineinfra/spark/merges","archive_url":"https://api.github.com/repos/nineinfra/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/nineinfra/spark/downloads","issues_url":"https://api.github.com/repos/nineinfra/spark/issues{/number}","pulls_url":"https://api.github.com/repos/nineinfra/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/nineinfra/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/nineinfra/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/nineinfra/spark/labels{/name}","releases_url":"https://api.github.com/repos/nineinfra/spark/releases{/id}","deployments_url":"https://api.github.com/repos/nineinfra/spark/deployments","created_at":"2022-12-13T11:38:18Z","updated_at":"2023-01-09T03:45:14Z","pushed_at":"2023-10-06T04:41:16Z","git_url":"git://github.com/nineinfra/spark.git","ssh_url":"git@github.com:nineinfra/spark.git","clone_url":"https://github.com/nineinfra/spark.git","svn_url":"https://github.com/nineinfra/spark","homepage":"https://spark.apache.org/","size":428549,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4760a8bd845292f7d6d6a35320bd80082a76c7c5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39884"},"html":{"href":"https://github.com/apache/spark/pull/39884"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39884"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39884/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39884/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39884/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f7f901777749bc1d58635a388f09fd8f04d49eb6"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39883","id":1228932848,"node_id":"PR_kwDOAQXtWs5JQAbw","html_url":"https://github.com/apache/spark/pull/39883","diff_url":"https://github.com/apache/spark/pull/39883.diff","patch_url":"https://github.com/apache/spark/pull/39883.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39883","number":39883,"state":"closed","locked":false,"title":"[SPARK-42343][CORE] Ignore `IOException` in `handleBlockRemovalFailure` if SparkContext is stopped","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR aims to suppress verbose `IOException` warnings in `BlockManagerMasterEndpoint.handleBlockRemovalFailure` in case of the stopped `SparkContext`.\r\n\r\n### Why are the changes needed?\r\n\r\nAlthough we ignore these kind of exceptions during `SparkContext.stop`, this PR can prevent the misleading error messages like the following.\r\n```\r\n23/02/04 01:26:05 INFO SparkUI: Stopped Spark web UI at http://driver-svc.default.svc:4040\r\n23/02/04 01:26:05 INFO KubernetesClusterSchedulerBackend: Shutting down all executors\r\n23/02/04 01:26:05 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Asking each executor to shut down\r\n23/02/04 01:26:05 WARN ExecutorPodsWatchSnapshotSource: Kubernetes client has been closed.\r\n23/02/04 01:26:05 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /172.31.215.139:47148 is closed\r\n23/02/04 01:26:05 WARN BlockManagerMasterEndpoint: Error trying to remove shuffle 0 from block manager BlockManagerId(3, 172.31.215.139, 37477, None)\r\njava.io.IOException: Connection from /172.31.215.139:47148 closed\r\n\tat org.apache.spark.network.client.TransportResponseHandler.channelInactive(TransportResponseHandler.java:147)\r\n\tat org.apache.spark.network.server.TransportChannelHandler.channelInactive(TransportChannelHandler.java:117)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:241)\r\n\tat io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)\r\n\tat io.netty.handler.timeout.IdleStateHandler.channelInactive(IdleStateHandler.java:277)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:241)\r\n\tat io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)\r\n\tat org.apache.spark.network.util.TransportFrameDecoder.channelInactive(TransportFrameDecoder.java:225)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:241)\r\n\tat io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)\r\n\tat io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)\r\n\tat io.netty.channel.AbstractChannel$AbstractUnsafe$8.run(AbstractChannel.java:831)\r\n\tat io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:497)\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\r\n\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\r\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\n```\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, but this PR changes `log` ond and this happens during `SparkContext.stop` and this \r\n\r\n### How was this patch tested?\r\n\r\nManual review.","created_at":"2023-02-04T03:23:37Z","updated_at":"2023-02-05T05:16:50Z","closed_at":"2023-02-05T05:16:09Z","merged_at":null,"merge_commit_sha":"2b2acb86e7a30e31fde1740707eb052883a66fde","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39883/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39883/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39883/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/904402e8737ab94775411b95fa08a1dc21b5cd2a","head":{"label":"dongjoon-hyun:SPARK-42343","ref":"SPARK-42343","sha":"904402e8737ab94775411b95fa08a1dc21b5cd2a","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"4760a8bd845292f7d6d6a35320bd80082a76c7c5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39883"},"html":{"href":"https://github.com/apache/spark/pull/39883"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39883"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39883/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39883/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39883/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/904402e8737ab94775411b95fa08a1dc21b5cd2a"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39882","id":1228898727,"node_id":"PR_kwDOAQXtWs5JP4Gn","html_url":"https://github.com/apache/spark/pull/39882","diff_url":"https://github.com/apache/spark/pull/39882.diff","patch_url":"https://github.com/apache/spark/pull/39882.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39882","number":39882,"state":"closed","locked":false,"title":"[SPARK-42342][PYTHON][CONNECT] Introduce base hierarchy to exceptions","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nIntroduces base hierarchy to exceptions.\r\n\r\nAs a common hierarchy for users, base exception classes are subclasses of `PySparkException`.\r\nThe concrete classes for both PySpark and Spark Connect inherits the base classes that should not be exposed to users.\r\n\r\n### Why are the changes needed?\r\n\r\nCurrently exception class hierarchy is separated between PySpark and Spark Connect.\r\n\r\nIf users want to check the exception type, they need to switch the error classes based on whether they are running on PySpark or Spark Connect, but it's not ideal.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo. Users still can use the existing exception classes to check the exception type.\r\n\r\n### How was this patch tested?\r\n\r\nUpdated tests.\r\n","created_at":"2023-02-04T01:32:27Z","updated_at":"2023-02-08T11:46:30Z","closed_at":"2023-02-08T11:46:30Z","merged_at":null,"merge_commit_sha":"ea70867ec5743d411ce5c7213e6c6bd6c24ef031","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39882/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39882/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39882/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/673d2de773a3c05e3e1325e727d31a7aa403186d","head":{"label":"ueshin:issues/SPARK-42342/exceptions","ref":"issues/SPARK-42342/exceptions","sha":"673d2de773a3c05e3e1325e727d31a7aa403186d","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":17234665,"node_id":"MDEwOlJlcG9zaXRvcnkxNzIzNDY2NQ==","name":"apache-spark","full_name":"ueshin/apache-spark","private":false,"owner":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ueshin/apache-spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/ueshin/apache-spark","forks_url":"https://api.github.com/repos/ueshin/apache-spark/forks","keys_url":"https://api.github.com/repos/ueshin/apache-spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ueshin/apache-spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ueshin/apache-spark/teams","hooks_url":"https://api.github.com/repos/ueshin/apache-spark/hooks","issue_events_url":"https://api.github.com/repos/ueshin/apache-spark/issues/events{/number}","events_url":"https://api.github.com/repos/ueshin/apache-spark/events","assignees_url":"https://api.github.com/repos/ueshin/apache-spark/assignees{/user}","branches_url":"https://api.github.com/repos/ueshin/apache-spark/branches{/branch}","tags_url":"https://api.github.com/repos/ueshin/apache-spark/tags","blobs_url":"https://api.github.com/repos/ueshin/apache-spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ueshin/apache-spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ueshin/apache-spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ueshin/apache-spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ueshin/apache-spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ueshin/apache-spark/languages","stargazers_url":"https://api.github.com/repos/ueshin/apache-spark/stargazers","contributors_url":"https://api.github.com/repos/ueshin/apache-spark/contributors","subscribers_url":"https://api.github.com/repos/ueshin/apache-spark/subscribers","subscription_url":"https://api.github.com/repos/ueshin/apache-spark/subscription","commits_url":"https://api.github.com/repos/ueshin/apache-spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ueshin/apache-spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ueshin/apache-spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ueshin/apache-spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ueshin/apache-spark/contents/{+path}","compare_url":"https://api.github.com/repos/ueshin/apache-spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ueshin/apache-spark/merges","archive_url":"https://api.github.com/repos/ueshin/apache-spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ueshin/apache-spark/downloads","issues_url":"https://api.github.com/repos/ueshin/apache-spark/issues{/number}","pulls_url":"https://api.github.com/repos/ueshin/apache-spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ueshin/apache-spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ueshin/apache-spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ueshin/apache-spark/labels{/name}","releases_url":"https://api.github.com/repos/ueshin/apache-spark/releases{/id}","deployments_url":"https://api.github.com/repos/ueshin/apache-spark/deployments","created_at":"2014-02-27T03:10:47Z","updated_at":"2025-02-07T02:07:18Z","pushed_at":"2025-02-07T19:29:05Z","git_url":"git://github.com/ueshin/apache-spark.git","ssh_url":"git@github.com:ueshin/apache-spark.git","clone_url":"https://github.com/ueshin/apache-spark.git","svn_url":"https://github.com/ueshin/apache-spark","homepage":null,"size":484941,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":8,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":8,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"54b5cf687b838a5ed9af43d566ef3c7320fb37d8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39882"},"html":{"href":"https://github.com/apache/spark/pull/39882"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39882"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39882/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39882/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39882/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/673d2de773a3c05e3e1325e727d31a7aa403186d"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39881","id":1228883282,"node_id":"PR_kwDOAQXtWs5JP0VS","html_url":"https://github.com/apache/spark/pull/39881","diff_url":"https://github.com/apache/spark/pull/39881.diff","patch_url":"https://github.com/apache/spark/pull/39881.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39881","number":39881,"state":"closed","locked":false,"title":"[SPARK-42341][SQL][TESTS] Fix JoinSelectionHelperSuite and PlanStabilitySuite to use explicit broadcast threshold","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR fixes `JoinSelectionHelperSuite` and `PlanStabilitySuite` to use explicit broadcast threshold according to the test assumption.\r\n\r\n### Why are the changes needed?\r\n\r\nTo be independent and clear in the tests.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo. This is a test-only PR.\r\n\r\n### How was this patch tested?\r\n\r\nPass the CIs.","created_at":"2023-02-04T00:52:59Z","updated_at":"2023-02-04T18:11:47Z","closed_at":"2023-02-04T18:11:13Z","merged_at":null,"merge_commit_sha":"2da49691ed31a694c9ce5707d96cb2051c877def","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39881/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39881/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39881/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a48e107173899e55e92392d5e635ae8973f34d65","head":{"label":"dongjoon-hyun:SPARK-42341","ref":"SPARK-42341","sha":"a48e107173899e55e92392d5e635ae8973f34d65","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":null},"base":{"label":"apache:master","ref":"master","sha":"4760a8bd845292f7d6d6a35320bd80082a76c7c5","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39881"},"html":{"href":"https://github.com/apache/spark/pull/39881"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39881"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39881/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39881/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39881/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a48e107173899e55e92392d5e635ae8973f34d65"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39880","id":1228337453,"node_id":"PR_kwDOAQXtWs5JNvEt","html_url":"https://github.com/apache/spark/pull/39880","diff_url":"https://github.com/apache/spark/pull/39880.diff","patch_url":"https://github.com/apache/spark/pull/39880.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39880","number":39880,"state":"closed","locked":false,"title":"typo: StogeLevel -> StorageLevel","user":{"login":"SiarheiFedartsou","id":266271,"node_id":"MDQ6VXNlcjI2NjI3MQ==","avatar_url":"https://avatars.githubusercontent.com/u/266271?v=4","gravatar_id":"","url":"https://api.github.com/users/SiarheiFedartsou","html_url":"https://github.com/SiarheiFedartsou","followers_url":"https://api.github.com/users/SiarheiFedartsou/followers","following_url":"https://api.github.com/users/SiarheiFedartsou/following{/other_user}","gists_url":"https://api.github.com/users/SiarheiFedartsou/gists{/gist_id}","starred_url":"https://api.github.com/users/SiarheiFedartsou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SiarheiFedartsou/subscriptions","organizations_url":"https://api.github.com/users/SiarheiFedartsou/orgs","repos_url":"https://api.github.com/users/SiarheiFedartsou/repos","events_url":"https://api.github.com/users/SiarheiFedartsou/events{/privacy}","received_events_url":"https://api.github.com/users/SiarheiFedartsou/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nJust a typo fix.\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\nJust to make things cleaner.\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n\r\n### How was this patch tested?\r\nIt seems no testing required.\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n","created_at":"2023-02-03T15:58:35Z","updated_at":"2023-04-01T19:24:01Z","closed_at":"2023-04-01T19:23:57Z","merged_at":null,"merge_commit_sha":"aa8c200df78325d0c9cf2dcb02f2a94d637f06ed","assignee":null,"assignees":[],"requested_reviewers":[{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4138679613,"node_id":"LA_kwDOAQXtWs72rz09","url":"https://api.github.com/repos/apache/spark/labels/PANDAS%20API%20ON%20SPARK","name":"PANDAS API ON SPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39880/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39880/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39880/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9e45ef24289afc37cf74236ac28384d1b1f5224f","head":{"label":"SiarheiFedartsou:fix/type-stogelevel-storagelevel","ref":"fix/type-stogelevel-storagelevel","sha":"9e45ef24289afc37cf74236ac28384d1b1f5224f","user":{"login":"SiarheiFedartsou","id":266271,"node_id":"MDQ6VXNlcjI2NjI3MQ==","avatar_url":"https://avatars.githubusercontent.com/u/266271?v=4","gravatar_id":"","url":"https://api.github.com/users/SiarheiFedartsou","html_url":"https://github.com/SiarheiFedartsou","followers_url":"https://api.github.com/users/SiarheiFedartsou/followers","following_url":"https://api.github.com/users/SiarheiFedartsou/following{/other_user}","gists_url":"https://api.github.com/users/SiarheiFedartsou/gists{/gist_id}","starred_url":"https://api.github.com/users/SiarheiFedartsou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SiarheiFedartsou/subscriptions","organizations_url":"https://api.github.com/users/SiarheiFedartsou/orgs","repos_url":"https://api.github.com/users/SiarheiFedartsou/repos","events_url":"https://api.github.com/users/SiarheiFedartsou/events{/privacy}","received_events_url":"https://api.github.com/users/SiarheiFedartsou/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":597090057,"node_id":"R_kgDOI5bfCQ","name":"spark","full_name":"SiarheiFedartsou/spark","private":false,"owner":{"login":"SiarheiFedartsou","id":266271,"node_id":"MDQ6VXNlcjI2NjI3MQ==","avatar_url":"https://avatars.githubusercontent.com/u/266271?v=4","gravatar_id":"","url":"https://api.github.com/users/SiarheiFedartsou","html_url":"https://github.com/SiarheiFedartsou","followers_url":"https://api.github.com/users/SiarheiFedartsou/followers","following_url":"https://api.github.com/users/SiarheiFedartsou/following{/other_user}","gists_url":"https://api.github.com/users/SiarheiFedartsou/gists{/gist_id}","starred_url":"https://api.github.com/users/SiarheiFedartsou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SiarheiFedartsou/subscriptions","organizations_url":"https://api.github.com/users/SiarheiFedartsou/orgs","repos_url":"https://api.github.com/users/SiarheiFedartsou/repos","events_url":"https://api.github.com/users/SiarheiFedartsou/events{/privacy}","received_events_url":"https://api.github.com/users/SiarheiFedartsou/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/SiarheiFedartsou/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/SiarheiFedartsou/spark","forks_url":"https://api.github.com/repos/SiarheiFedartsou/spark/forks","keys_url":"https://api.github.com/repos/SiarheiFedartsou/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/SiarheiFedartsou/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/SiarheiFedartsou/spark/teams","hooks_url":"https://api.github.com/repos/SiarheiFedartsou/spark/hooks","issue_events_url":"https://api.github.com/repos/SiarheiFedartsou/spark/issues/events{/number}","events_url":"https://api.github.com/repos/SiarheiFedartsou/spark/events","assignees_url":"https://api.github.com/repos/SiarheiFedartsou/spark/assignees{/user}","branches_url":"https://api.github.com/repos/SiarheiFedartsou/spark/branches{/branch}","tags_url":"https://api.github.com/repos/SiarheiFedartsou/spark/tags","blobs_url":"https://api.github.com/repos/SiarheiFedartsou/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/SiarheiFedartsou/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/SiarheiFedartsou/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/SiarheiFedartsou/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/SiarheiFedartsou/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/SiarheiFedartsou/spark/languages","stargazers_url":"https://api.github.com/repos/SiarheiFedartsou/spark/stargazers","contributors_url":"https://api.github.com/repos/SiarheiFedartsou/spark/contributors","subscribers_url":"https://api.github.com/repos/SiarheiFedartsou/spark/subscribers","subscription_url":"https://api.github.com/repos/SiarheiFedartsou/spark/subscription","commits_url":"https://api.github.com/repos/SiarheiFedartsou/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/SiarheiFedartsou/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/SiarheiFedartsou/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/SiarheiFedartsou/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/SiarheiFedartsou/spark/contents/{+path}","compare_url":"https://api.github.com/repos/SiarheiFedartsou/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/SiarheiFedartsou/spark/merges","archive_url":"https://api.github.com/repos/SiarheiFedartsou/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/SiarheiFedartsou/spark/downloads","issues_url":"https://api.github.com/repos/SiarheiFedartsou/spark/issues{/number}","pulls_url":"https://api.github.com/repos/SiarheiFedartsou/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/SiarheiFedartsou/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/SiarheiFedartsou/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/SiarheiFedartsou/spark/labels{/name}","releases_url":"https://api.github.com/repos/SiarheiFedartsou/spark/releases{/id}","deployments_url":"https://api.github.com/repos/SiarheiFedartsou/spark/deployments","created_at":"2023-02-03T15:55:50Z","updated_at":"2023-02-03T15:59:29Z","pushed_at":"2023-02-09T14:06:46Z","git_url":"git://github.com/SiarheiFedartsou/spark.git","ssh_url":"git@github.com:SiarheiFedartsou/spark.git","clone_url":"https://github.com/SiarheiFedartsou/spark.git","svn_url":"https://github.com/SiarheiFedartsou/spark","homepage":"https://spark.apache.org/","size":401236,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"02b39f0b880a2ecf63167355d9644e91c98588a8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39880"},"html":{"href":"https://github.com/apache/spark/pull/39880"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39880"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39880/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39880/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39880/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9e45ef24289afc37cf74236ac28384d1b1f5224f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39879","id":1228195020,"node_id":"PR_kwDOAQXtWs5JNMTM","html_url":"https://github.com/apache/spark/pull/39879","diff_url":"https://github.com/apache/spark/pull/39879.diff","patch_url":"https://github.com/apache/spark/pull/39879.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39879","number":39879,"state":"closed","locked":false,"title":"[SPARK-42336][CORE] Use `getOrElse()` instead of `contains()` in ResourceAllocator","user":{"login":"smallzhongfeng","id":84573424,"node_id":"MDQ6VXNlcjg0NTczNDI0","avatar_url":"https://avatars.githubusercontent.com/u/84573424?v=4","gravatar_id":"","url":"https://api.github.com/users/smallzhongfeng","html_url":"https://github.com/smallzhongfeng","followers_url":"https://api.github.com/users/smallzhongfeng/followers","following_url":"https://api.github.com/users/smallzhongfeng/following{/other_user}","gists_url":"https://api.github.com/users/smallzhongfeng/gists{/gist_id}","starred_url":"https://api.github.com/users/smallzhongfeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallzhongfeng/subscriptions","organizations_url":"https://api.github.com/users/smallzhongfeng/orgs","repos_url":"https://api.github.com/users/smallzhongfeng/repos","events_url":"https://api.github.com/users/smallzhongfeng/events{/privacy}","received_events_url":"https://api.github.com/users/smallzhongfeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nUse `.getOrElse(address, throw new SparkException(...))` instead of one `contains` in `addressAvailabilityMap`‘s `require` and `release`.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nImproving performance.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nOrigin uts.","created_at":"2023-02-03T14:11:33Z","updated_at":"2023-02-06T03:09:47Z","closed_at":"2023-02-06T02:55:03Z","merged_at":null,"merge_commit_sha":"9a17a0ea14c55d76f592a6e8e39c0a4e22130436","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39879/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39879/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39879/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/70bd61aab60c5c9d472c6d9c9705283d66c41eab","head":{"label":"smallzhongfeng:SPARK-42336","ref":"SPARK-42336","sha":"70bd61aab60c5c9d472c6d9c9705283d66c41eab","user":{"login":"smallzhongfeng","id":84573424,"node_id":"MDQ6VXNlcjg0NTczNDI0","avatar_url":"https://avatars.githubusercontent.com/u/84573424?v=4","gravatar_id":"","url":"https://api.github.com/users/smallzhongfeng","html_url":"https://github.com/smallzhongfeng","followers_url":"https://api.github.com/users/smallzhongfeng/followers","following_url":"https://api.github.com/users/smallzhongfeng/following{/other_user}","gists_url":"https://api.github.com/users/smallzhongfeng/gists{/gist_id}","starred_url":"https://api.github.com/users/smallzhongfeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallzhongfeng/subscriptions","organizations_url":"https://api.github.com/users/smallzhongfeng/orgs","repos_url":"https://api.github.com/users/smallzhongfeng/repos","events_url":"https://api.github.com/users/smallzhongfeng/events{/privacy}","received_events_url":"https://api.github.com/users/smallzhongfeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":439328511,"node_id":"R_kgDOGi-e_w","name":"spark","full_name":"smallzhongfeng/spark","private":false,"owner":{"login":"smallzhongfeng","id":84573424,"node_id":"MDQ6VXNlcjg0NTczNDI0","avatar_url":"https://avatars.githubusercontent.com/u/84573424?v=4","gravatar_id":"","url":"https://api.github.com/users/smallzhongfeng","html_url":"https://github.com/smallzhongfeng","followers_url":"https://api.github.com/users/smallzhongfeng/followers","following_url":"https://api.github.com/users/smallzhongfeng/following{/other_user}","gists_url":"https://api.github.com/users/smallzhongfeng/gists{/gist_id}","starred_url":"https://api.github.com/users/smallzhongfeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallzhongfeng/subscriptions","organizations_url":"https://api.github.com/users/smallzhongfeng/orgs","repos_url":"https://api.github.com/users/smallzhongfeng/repos","events_url":"https://api.github.com/users/smallzhongfeng/events{/privacy}","received_events_url":"https://api.github.com/users/smallzhongfeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/smallzhongfeng/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/smallzhongfeng/spark","forks_url":"https://api.github.com/repos/smallzhongfeng/spark/forks","keys_url":"https://api.github.com/repos/smallzhongfeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/smallzhongfeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/smallzhongfeng/spark/teams","hooks_url":"https://api.github.com/repos/smallzhongfeng/spark/hooks","issue_events_url":"https://api.github.com/repos/smallzhongfeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/smallzhongfeng/spark/events","assignees_url":"https://api.github.com/repos/smallzhongfeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/smallzhongfeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/smallzhongfeng/spark/tags","blobs_url":"https://api.github.com/repos/smallzhongfeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/smallzhongfeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/smallzhongfeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/smallzhongfeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/smallzhongfeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/smallzhongfeng/spark/languages","stargazers_url":"https://api.github.com/repos/smallzhongfeng/spark/stargazers","contributors_url":"https://api.github.com/repos/smallzhongfeng/spark/contributors","subscribers_url":"https://api.github.com/repos/smallzhongfeng/spark/subscribers","subscription_url":"https://api.github.com/repos/smallzhongfeng/spark/subscription","commits_url":"https://api.github.com/repos/smallzhongfeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/smallzhongfeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/smallzhongfeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/smallzhongfeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/smallzhongfeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/smallzhongfeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/smallzhongfeng/spark/merges","archive_url":"https://api.github.com/repos/smallzhongfeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/smallzhongfeng/spark/downloads","issues_url":"https://api.github.com/repos/smallzhongfeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/smallzhongfeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/smallzhongfeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/smallzhongfeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/smallzhongfeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/smallzhongfeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/smallzhongfeng/spark/deployments","created_at":"2021-12-17T12:42:00Z","updated_at":"2022-08-01T17:21:29Z","pushed_at":"2023-03-28T06:46:48Z","git_url":"git://github.com/smallzhongfeng/spark.git","ssh_url":"git@github.com:smallzhongfeng/spark.git","clone_url":"https://github.com/smallzhongfeng/spark.git","svn_url":"https://github.com/smallzhongfeng/spark","homepage":"https://spark.apache.org/","size":452195,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"02b39f0b880a2ecf63167355d9644e91c98588a8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39879"},"html":{"href":"https://github.com/apache/spark/pull/39879"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39879"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39879/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39879/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39879/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/70bd61aab60c5c9d472c6d9c9705283d66c41eab"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39878","id":1227968976,"node_id":"PR_kwDOAQXtWs5JMVHQ","html_url":"https://github.com/apache/spark/pull/39878","diff_url":"https://github.com/apache/spark/pull/39878.diff","patch_url":"https://github.com/apache/spark/pull/39878.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39878","number":39878,"state":"closed","locked":false,"title":"[SPARK-42335][SQL] Pass the comment option through to univocity if users set it explicitly in CSV dataSource","user":{"login":"wayneguow","id":16032294,"node_id":"MDQ6VXNlcjE2MDMyMjk0","avatar_url":"https://avatars.githubusercontent.com/u/16032294?v=4","gravatar_id":"","url":"https://api.github.com/users/wayneguow","html_url":"https://github.com/wayneguow","followers_url":"https://api.github.com/users/wayneguow/followers","following_url":"https://api.github.com/users/wayneguow/following{/other_user}","gists_url":"https://api.github.com/users/wayneguow/gists{/gist_id}","starred_url":"https://api.github.com/users/wayneguow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wayneguow/subscriptions","organizations_url":"https://api.github.com/users/wayneguow/orgs","repos_url":"https://api.github.com/users/wayneguow/repos","events_url":"https://api.github.com/users/wayneguow/events{/privacy}","received_events_url":"https://api.github.com/users/wayneguow/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nPass the comment option through to univocity if users set it explicitly in CSV dataSource.\r\n\r\n### Why are the changes needed?\r\nIn #29516 , in order to fix some bugs, univocity-parsers was upgrade from 2.8.3 to 2.9.0, it also involved a new feature of univocity-parsers that quoting values of the first column that start with the comment character. It made a breaking for users downstream that handing a whole row as input.\r\nBefore this change:\r\n#abc,1\r\nAfter this change:\r\n\"#abc\",1\r\nWe change the related `isCommentSet` check logic to enable users to keep behavior as before.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes, a little. If users set comment option as '\\^@' explicitly, now they should remove it to keep comment option unset.\r\n\r\n### How was this patch tested?\r\nAdd a full new test.\r\n","created_at":"2023-02-03T10:55:44Z","updated_at":"2023-02-08T21:12:55Z","closed_at":"2023-02-08T21:12:55Z","merged_at":null,"merge_commit_sha":"374e9d0cc467c3700635e31a1bb40c4bf3ccfc49","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39878/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39878/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39878/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1cb42db1334519a7e42cfad1077adfddaafbe640","head":{"label":"wayneguow:comment","ref":"comment","sha":"1cb42db1334519a7e42cfad1077adfddaafbe640","user":{"login":"wayneguow","id":16032294,"node_id":"MDQ6VXNlcjE2MDMyMjk0","avatar_url":"https://avatars.githubusercontent.com/u/16032294?v=4","gravatar_id":"","url":"https://api.github.com/users/wayneguow","html_url":"https://github.com/wayneguow","followers_url":"https://api.github.com/users/wayneguow/followers","following_url":"https://api.github.com/users/wayneguow/following{/other_user}","gists_url":"https://api.github.com/users/wayneguow/gists{/gist_id}","starred_url":"https://api.github.com/users/wayneguow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wayneguow/subscriptions","organizations_url":"https://api.github.com/users/wayneguow/orgs","repos_url":"https://api.github.com/users/wayneguow/repos","events_url":"https://api.github.com/users/wayneguow/events{/privacy}","received_events_url":"https://api.github.com/users/wayneguow/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":436644142,"node_id":"R_kgDOGgapLg","name":"spark","full_name":"wayneguow/spark","private":false,"owner":{"login":"wayneguow","id":16032294,"node_id":"MDQ6VXNlcjE2MDMyMjk0","avatar_url":"https://avatars.githubusercontent.com/u/16032294?v=4","gravatar_id":"","url":"https://api.github.com/users/wayneguow","html_url":"https://github.com/wayneguow","followers_url":"https://api.github.com/users/wayneguow/followers","following_url":"https://api.github.com/users/wayneguow/following{/other_user}","gists_url":"https://api.github.com/users/wayneguow/gists{/gist_id}","starred_url":"https://api.github.com/users/wayneguow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wayneguow/subscriptions","organizations_url":"https://api.github.com/users/wayneguow/orgs","repos_url":"https://api.github.com/users/wayneguow/repos","events_url":"https://api.github.com/users/wayneguow/events{/privacy}","received_events_url":"https://api.github.com/users/wayneguow/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/wayneguow/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/wayneguow/spark","forks_url":"https://api.github.com/repos/wayneguow/spark/forks","keys_url":"https://api.github.com/repos/wayneguow/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/wayneguow/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/wayneguow/spark/teams","hooks_url":"https://api.github.com/repos/wayneguow/spark/hooks","issue_events_url":"https://api.github.com/repos/wayneguow/spark/issues/events{/number}","events_url":"https://api.github.com/repos/wayneguow/spark/events","assignees_url":"https://api.github.com/repos/wayneguow/spark/assignees{/user}","branches_url":"https://api.github.com/repos/wayneguow/spark/branches{/branch}","tags_url":"https://api.github.com/repos/wayneguow/spark/tags","blobs_url":"https://api.github.com/repos/wayneguow/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/wayneguow/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/wayneguow/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/wayneguow/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/wayneguow/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/wayneguow/spark/languages","stargazers_url":"https://api.github.com/repos/wayneguow/spark/stargazers","contributors_url":"https://api.github.com/repos/wayneguow/spark/contributors","subscribers_url":"https://api.github.com/repos/wayneguow/spark/subscribers","subscription_url":"https://api.github.com/repos/wayneguow/spark/subscription","commits_url":"https://api.github.com/repos/wayneguow/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/wayneguow/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/wayneguow/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/wayneguow/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/wayneguow/spark/contents/{+path}","compare_url":"https://api.github.com/repos/wayneguow/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/wayneguow/spark/merges","archive_url":"https://api.github.com/repos/wayneguow/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/wayneguow/spark/downloads","issues_url":"https://api.github.com/repos/wayneguow/spark/issues{/number}","pulls_url":"https://api.github.com/repos/wayneguow/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/wayneguow/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/wayneguow/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/wayneguow/spark/labels{/name}","releases_url":"https://api.github.com/repos/wayneguow/spark/releases{/id}","deployments_url":"https://api.github.com/repos/wayneguow/spark/deployments","created_at":"2021-12-09T14:20:45Z","updated_at":"2024-12-23T09:38:57Z","pushed_at":"2025-02-09T10:48:02Z","git_url":"git://github.com/wayneguow/spark.git","ssh_url":"git@github.com:wayneguow/spark.git","clone_url":"https://github.com/wayneguow/spark.git","svn_url":"https://github.com/wayneguow/spark","homepage":"https://spark.apache.org/","size":475066,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a3c6b6b0232ddd3f09a2ed4b5e6a2f6e538c6733","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39878"},"html":{"href":"https://github.com/apache/spark/pull/39878"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39878"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39878/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39878/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39878/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1cb42db1334519a7e42cfad1077adfddaafbe640"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39877","id":1227882794,"node_id":"PR_kwDOAQXtWs5JMAEq","html_url":"https://github.com/apache/spark/pull/39877","diff_url":"https://github.com/apache/spark/pull/39877.diff","patch_url":"https://github.com/apache/spark/pull/39877.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39877","number":39877,"state":"closed","locked":false,"title":"[SPARK-42306][SQL] Integrate `_LEGACY_ERROR_TEMP_1317` into `UNRESOLVED_COLUMN.WITH_SUGGESTION`","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to integrate `_LEGACY_ERROR_TEMP_1317` into `UNRESOLVED_COLUMN.WITH_SUGGESTION`.\r\n\r\n**_LEGACY_ERROR_TEMP_1317**\r\n```json\r\n  \"_LEGACY_ERROR_TEMP_1317\" : {\r\n    \"message\" : [\r\n      \"Cannot resolve column name \\\"<colName>\\\" among (<fieldsStr>)<extraMsg>\"\r\n    ]\r\n  },\r\n```\r\n\r\n**UNRESOLVED_COLUMN.WITH_SUGGESTION**\r\n```json\r\n  \"UNRESOLVED_COLUMN\" : {\r\n    \"message\" : [\r\n      \"A column or function parameter with name <objectName> cannot be resolved.\"\r\n    ],\r\n    \"subClass\" : {\r\n      \"WITHOUT_SUGGESTION\" : {\r\n        \"message\" : [\r\n          \"\"\r\n        ]\r\n      },\r\n      \"WITH_SUGGESTION\" : {\r\n        \"message\" : [\r\n          \"Did you mean one of the following? [<proposal>].\"\r\n        ]\r\n      }\r\n    },\r\n    \"sqlState\" : \"42703\"\r\n  },\r\n```\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*\"`","created_at":"2023-02-03T09:49:34Z","updated_at":"2023-04-22T05:48:32Z","closed_at":"2023-02-07T06:45:20Z","merged_at":null,"merge_commit_sha":"7051e203e2291eb118bed5ec4c22e717ec62dc60","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39877/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39877/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39877/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/13d7b7a71c1b71e2b8f65c2442a766f801465366","head":{"label":"itholic:LEGACY_1317","ref":"LEGACY_1317","sha":"13d7b7a71c1b71e2b8f65c2442a766f801465366","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"286d3364ab258e68b4dd0df8bc0980645119d222","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39877"},"html":{"href":"https://github.com/apache/spark/pull/39877"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39877"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39877/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39877/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39877/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/13d7b7a71c1b71e2b8f65c2442a766f801465366"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39876","id":1227838637,"node_id":"PR_kwDOAQXtWs5JL1St","html_url":"https://github.com/apache/spark/pull/39876","diff_url":"https://github.com/apache/spark/pull/39876.diff","patch_url":"https://github.com/apache/spark/pull/39876.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39876","number":39876,"state":"closed","locked":false,"title":"[SPARK-42333][SQL] Change log level to debug when fetching result set from SparkExecuteStatementOperation","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nChange log level from info to debug when fetching result set from `SparkExecuteStatementOperation`.\r\n\r\n\r\n### Why are the changes needed?\r\n\r\nAvoid generating too many logs:\r\n<img width=\"1230\" alt=\"image\" src=\"https://user-images.githubusercontent.com/5399861/216561187-6ad00458-d196-4f3a-a314-b2f309aec482.png\">\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n\r\n### How was this patch tested?\r\n\r\nUnit test.","created_at":"2023-02-03T09:21:28Z","updated_at":"2023-02-03T18:47:21Z","closed_at":"2023-02-03T18:01:18Z","merged_at":null,"merge_commit_sha":"ff3bb2434b3677f22a50f8c59dd4d4fea879fcde","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39876/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39876/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39876/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ed7fcaec3850ab6c3e3a4d1831b07b282dd1293b","head":{"label":"wangyum:SPARK-42333","ref":"SPARK-42333","sha":"ed7fcaec3850ab6c3e3a4d1831b07b282dd1293b","user":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":467759455,"node_id":"R_kgDOG-FxXw","name":"spark","full_name":"wangyum/spark","private":false,"owner":{"login":"wangyum","id":5399861,"node_id":"MDQ6VXNlcjUzOTk4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/5399861?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyum","html_url":"https://github.com/wangyum","followers_url":"https://api.github.com/users/wangyum/followers","following_url":"https://api.github.com/users/wangyum/following{/other_user}","gists_url":"https://api.github.com/users/wangyum/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyum/subscriptions","organizations_url":"https://api.github.com/users/wangyum/orgs","repos_url":"https://api.github.com/users/wangyum/repos","events_url":"https://api.github.com/users/wangyum/events{/privacy}","received_events_url":"https://api.github.com/users/wangyum/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/wangyum/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/wangyum/spark","forks_url":"https://api.github.com/repos/wangyum/spark/forks","keys_url":"https://api.github.com/repos/wangyum/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/wangyum/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/wangyum/spark/teams","hooks_url":"https://api.github.com/repos/wangyum/spark/hooks","issue_events_url":"https://api.github.com/repos/wangyum/spark/issues/events{/number}","events_url":"https://api.github.com/repos/wangyum/spark/events","assignees_url":"https://api.github.com/repos/wangyum/spark/assignees{/user}","branches_url":"https://api.github.com/repos/wangyum/spark/branches{/branch}","tags_url":"https://api.github.com/repos/wangyum/spark/tags","blobs_url":"https://api.github.com/repos/wangyum/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/wangyum/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/wangyum/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/wangyum/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/wangyum/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/wangyum/spark/languages","stargazers_url":"https://api.github.com/repos/wangyum/spark/stargazers","contributors_url":"https://api.github.com/repos/wangyum/spark/contributors","subscribers_url":"https://api.github.com/repos/wangyum/spark/subscribers","subscription_url":"https://api.github.com/repos/wangyum/spark/subscription","commits_url":"https://api.github.com/repos/wangyum/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/wangyum/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/wangyum/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/wangyum/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/wangyum/spark/contents/{+path}","compare_url":"https://api.github.com/repos/wangyum/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/wangyum/spark/merges","archive_url":"https://api.github.com/repos/wangyum/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/wangyum/spark/downloads","issues_url":"https://api.github.com/repos/wangyum/spark/issues{/number}","pulls_url":"https://api.github.com/repos/wangyum/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/wangyum/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/wangyum/spark/labels{/name}","releases_url":"https://api.github.com/repos/wangyum/spark/releases{/id}","deployments_url":"https://api.github.com/repos/wangyum/spark/deployments","created_at":"2022-03-09T03:11:29Z","updated_at":"2025-02-09T07:30:39Z","pushed_at":"2025-02-09T07:30:08Z","git_url":"git://github.com/wangyum/spark.git","ssh_url":"git@github.com:wangyum/spark.git","clone_url":"https://github.com/wangyum/spark.git","svn_url":"https://github.com/wangyum/spark","homepage":"https://spark.apache.org/","size":487127,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":8,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":3,"open_issues":8,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a3c6b6b0232ddd3f09a2ed4b5e6a2f6e538c6733","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39876"},"html":{"href":"https://github.com/apache/spark/pull/39876"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39876"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39876/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39876/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39876/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ed7fcaec3850ab6c3e3a4d1831b07b282dd1293b"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39875","id":1227829145,"node_id":"PR_kwDOAQXtWs5JLy-Z","html_url":"https://github.com/apache/spark/pull/39875","diff_url":"https://github.com/apache/spark/pull/39875.diff","patch_url":"https://github.com/apache/spark/pull/39875.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39875","number":39875,"state":"closed","locked":false,"title":"[SPARK-42305][SQL] Integrate `_LEGACY_ERROR_TEMP_1229` into `DECIMAL_PRECISION_EXCEEDS_MAX_PRECISION`","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to integrate `_LEGACY_ERROR_TEMP_1229` into `DECIMAL_PRECISION_EXCEEDS_MAX_PRECISION`.\r\n\r\n**_LEGACY_ERROR_TEMP_1229**\r\n```json\r\n  \"_LEGACY_ERROR_TEMP_1229\" : {\r\n    \"message\" : [\r\n      \"<decimalType> can only support precision up to <precision>.\"\r\n    ]\r\n  },\r\n```\r\n\r\n**DECIMAL_PRECISION_EXCEEDS_MAX_PRECISION**\r\n```json\r\n  \"DECIMAL_PRECISION_EXCEEDS_MAX_PRECISION\" : {\r\n    \"message\" : [\r\n      \"Decimal precision <precision> exceeds max precision <maxPrecision>.\"\r\n    ],\r\n    \"sqlState\" : \"22003\"\r\n  },\r\n```\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*\"`","created_at":"2023-02-03T09:16:47Z","updated_at":"2023-04-22T05:47:45Z","closed_at":"2023-02-08T14:23:52Z","merged_at":null,"merge_commit_sha":"0b8cef527fd3f8be5c96d4fa5d81ebcfc6aea7c3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39875/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39875/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39875/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/dc82486aa94890ccf946eb937a567a5845078163","head":{"label":"itholic:LEGACY_1229","ref":"LEGACY_1229","sha":"dc82486aa94890ccf946eb937a567a5845078163","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"53c1c682acd619c6b3a4beeea53766dda08c7350","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39875"},"html":{"href":"https://github.com/apache/spark/pull/39875"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39875"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39875/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39875/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39875/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/dc82486aa94890ccf946eb937a567a5845078163"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39874","id":1227822168,"node_id":"PR_kwDOAQXtWs5JLxRY","html_url":"https://github.com/apache/spark/pull/39874","diff_url":"https://github.com/apache/spark/pull/39874.diff","patch_url":"https://github.com/apache/spark/pull/39874.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39874","number":39874,"state":"closed","locked":false,"title":"[SPARK-42334][CONNECT][BUILD] Make sure connect client assembly and sql package is built before running client tests - SBT","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n`build/sbt clean \"connect-client-jvm/test\"` will fail after SPARK-42172 merged, so this pr make sure sbt assembles the connect client assembly jar and sbt package the sql jar before we run `CompatibilitySuite` of client module.\r\n\r\n\r\n\r\n### Why are the changes needed?\r\nSimilar as SPARK-42284, it makes it easier to develop and test the JVM client for Spark Connect.\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nManually tested.\r\n\r\n```\r\nbuild/sbt clean \"connect-client-jvm/test\"\r\n```\r\n\r\n**Before**\r\n\r\n```\r\n[info] - compatibility MiMa tests *** FAILED *** (34 milliseconds)\r\n[info]   java.lang.AssertionError: assertion failed: Failed to find the jar inside folder: /Users/yangjie01/SourceCode/git/spark-mine-sbt/connector/connect/client/jvm/target\r\n[info]   at scala.Predef$.assert(Predef.scala:223)\r\n[info]   at org.apache.spark.sql.connect.client.util.IntegrationTestUtils$.findJar(IntegrationTestUtils.scala:67)\r\n[info]   at org.apache.spark.sql.connect.client.CompatibilitySuite.clientJar$lzycompute(CompatibilitySuite.scala:57)\r\n[info]   at org.apache.spark.sql.connect.client.CompatibilitySuite.clientJar(CompatibilitySuite.scala:53)\r\n[info]   at org.apache.spark.sql.connect.client.CompatibilitySuite.$anonfun$new$1(CompatibilitySuite.scala:69)\r\n....\r\n[info] *** 2 TESTS FAILED ***\r\n[error] Failed tests:\r\n[error] \torg.apache.spark.sql.connect.client.CompatibilitySuite\r\n[error] (connect-client-jvm / Test / test) sbt.TestsFailedException: Tests unsuccessful\r\n[error] Total time: 196 s (03:16), completed 2023-2-3 17:20:40\r\n```\r\n\r\n**After**\r\n\r\n```\r\n[info] Run completed in 20 seconds, 652 milliseconds.\r\n[info] Total number of tests run: 31\r\n[info] Suites: completed 6, aborted 0\r\n[info] Tests: succeeded 31, failed 0, canceled 0, ignored 0, pending 0\r\n[info] All tests passed.\r\n[success] Total time: 230 s (03:50), completed 2023-2-3 17:35:37\r\n```","created_at":"2023-02-03T09:12:58Z","updated_at":"2023-02-06T09:24:09Z","closed_at":"2023-02-05T01:42:46Z","merged_at":null,"merge_commit_sha":"270c57191096b48b885db9db925cafe304010491","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39874/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39874/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39874/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3a70ba1068739567d8d6157853b99a1e8420b71a","head":{"label":"LuciferYang:make-test","ref":"make-test","sha":"3a70ba1068739567d8d6157853b99a1e8420b71a","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a3c6b6b0232ddd3f09a2ed4b5e6a2f6e538c6733","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39874"},"html":{"href":"https://github.com/apache/spark/pull/39874"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39874"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39874/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39874/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39874/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3a70ba1068739567d8d6157853b99a1e8420b71a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39873","id":1227786404,"node_id":"PR_kwDOAQXtWs5JLoik","html_url":"https://github.com/apache/spark/pull/39873","diff_url":"https://github.com/apache/spark/pull/39873.diff","patch_url":"https://github.com/apache/spark/pull/39873.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39873","number":39873,"state":"closed","locked":false,"title":"[SPARK-42303][SQL] Assign name to _LEGACY_ERROR_TEMP_1326","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to assign name to _LEGACY_ERROR_TEMP_1326, \"CANNOT_MODIFY_CONFIG\".\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*\"`","created_at":"2023-02-03T08:44:25Z","updated_at":"2023-04-22T05:47:44Z","closed_at":"2023-02-08T14:06:17Z","merged_at":null,"merge_commit_sha":"a244861ce80217d1549470400a2dfd75a2419a44","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39873/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39873/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39873/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/eee1345ada59f872ffcb4af801eda5373bd74e2a","head":{"label":"itholic:LEGACY_1326","ref":"LEGACY_1326","sha":"eee1345ada59f872ffcb4af801eda5373bd74e2a","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"5225a3224f8339f13b1d917dc4ba7c63dd713552","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39873"},"html":{"href":"https://github.com/apache/spark/pull/39873"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39873"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39873/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39873/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39873/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/eee1345ada59f872ffcb4af801eda5373bd74e2a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39872","id":1227698223,"node_id":"PR_kwDOAQXtWs5JLTAv","html_url":"https://github.com/apache/spark/pull/39872","diff_url":"https://github.com/apache/spark/pull/39872.diff","patch_url":"https://github.com/apache/spark/pull/39872.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39872","number":39872,"state":"closed","locked":false,"title":"[SPARK-42302][SQL] Assign name to _LEGACY_ERROR_TEMP_2135","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to assign name to _LEGACY_ERROR_TEMP_2135, \"FAILED_PARSE_EMPTY_STRING\".\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*\"`","created_at":"2023-02-03T07:17:52Z","updated_at":"2023-04-22T05:48:38Z","closed_at":"2023-02-06T10:51:49Z","merged_at":null,"merge_commit_sha":"2e9b9fd3b839dd63cdafbfebeacf7fb7292485ba","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39872/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39872/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39872/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/37582f87e702fe1f1385fdc95524725ceeb9b685","head":{"label":"itholic:LEGACY_2135","ref":"LEGACY_2135","sha":"37582f87e702fe1f1385fdc95524725ceeb9b685","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"c5c1927d6a137c0e92417a0efad5da62ab253137","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39872"},"html":{"href":"https://github.com/apache/spark/pull/39872"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39872"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39872/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39872/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39872/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/37582f87e702fe1f1385fdc95524725ceeb9b685"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39871","id":1227677074,"node_id":"PR_kwDOAQXtWs5JLN2S","html_url":"https://github.com/apache/spark/pull/39871","diff_url":"https://github.com/apache/spark/pull/39871.diff","patch_url":"https://github.com/apache/spark/pull/39871.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39871","number":39871,"state":"closed","locked":false,"title":"[SPARK-42301][SQL] Assign name to _LEGACY_ERROR_TEMP_1129","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to assign name to _LEGACY_ERROR_TEMP_1129, \"UNABLE_TO_INFER_SCHEMA\".\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*\"`","created_at":"2023-02-03T06:55:26Z","updated_at":"2023-04-22T05:47:50Z","closed_at":"2023-02-08T01:36:13Z","merged_at":null,"merge_commit_sha":"0ec2946b88ff95a3d096f18a81be8bac2c5266cf","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1984361638,"node_id":"MDU6TGFiZWwxOTg0MzYxNjM4","url":"https://api.github.com/repos/apache/spark/labels/R","name":"R","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39871/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39871/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39871/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5e81bb1acd90a1ff6423dfd8f56c604e0d282bbd","head":{"label":"itholic:LEGACY_1129","ref":"LEGACY_1129","sha":"5e81bb1acd90a1ff6423dfd8f56c604e0d282bbd","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"286d3364ab258e68b4dd0df8bc0980645119d222","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39871"},"html":{"href":"https://github.com/apache/spark/pull/39871"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39871"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39871/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39871/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39871/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5e81bb1acd90a1ff6423dfd8f56c604e0d282bbd"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39870","id":1227662742,"node_id":"PR_kwDOAQXtWs5JLKWW","html_url":"https://github.com/apache/spark/pull/39870","diff_url":"https://github.com/apache/spark/pull/39870.diff","patch_url":"https://github.com/apache/spark/pull/39870.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39870","number":39870,"state":"closed","locked":false,"title":"[SPARK-42331][SQL] Fix metadata col can not been resolved","user":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis pr makes metadata output consistent during analysis by checking the output and reuse these if exists.\r\n\r\nThis pr also deduplicates the metadata output when merging into the output.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nLet's say a process of resolving metadata:\r\n```\r\nProject (_metadata.file_size)\r\n  File (_metadata.file_size > 0)\r\n    Relation\r\n```\r\n\r\n1. `ResolveReferences` resolves _metadata.file_size for `Filter`\r\n2. `ResolveReferences` can not resolve _metadata.file_size for `Project`, due to Filter is not resolved (data type does not match)\r\n3. then `AddMetadataColumns` will merge metadata output into output\r\n4. the next round of `ResolveReferences` can not resolve _metadata.file_size for `Project` since we filter not the confict names(output already contains the metadata output), see code:\r\n    ```\r\n        def isOutputColumn(col: MetadataColumn): Boolean = {\r\n          outputNames.exists(name => resolve(col.name, name))\r\n        }\r\n        // filter out metadata columns that have names conflicting with output columns. if the table\r\n        // has a column \"line\" and the table can produce a metadata column called \"line\", then the\r\n        // data column should be returned, not the metadata column.\r\n        hasMeta.metadataColumns.filterNot(isOutputColumn).toAttributes\r\n   ```\r\n   And we also can not skip metadata column during filter confict name, otherwise the new generated metadata attribute will have different expr id with previous.\r\n\r\nOne failed example:\r\n```scala\r\nSELECT _metadata.row_index  FROM t WHERE _metadata.row_index >= 0;\r\n```\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nyes, bug fix\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nadd test for v1, v2 and streaming relation","created_at":"2023-02-03T06:37:08Z","updated_at":"2023-02-13T11:22:39Z","closed_at":"2023-02-13T04:43:50Z","merged_at":null,"merge_commit_sha":"ea1bd05316f43be4878d39384ba7466fe7349e11","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39870/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39870/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39870/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5ba6565dffce2797d4bd36bc3f2e1b66e4c3a176","head":{"label":"ulysses-you:SPARK-42331","ref":"SPARK-42331","sha":"5ba6565dffce2797d4bd36bc3f2e1b66e4c3a176","user":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":195747855,"node_id":"MDEwOlJlcG9zaXRvcnkxOTU3NDc4NTU=","name":"spark","full_name":"ulysses-you/spark","private":false,"owner":{"login":"ulysses-you","id":12025282,"node_id":"MDQ6VXNlcjEyMDI1Mjgy","avatar_url":"https://avatars.githubusercontent.com/u/12025282?v=4","gravatar_id":"","url":"https://api.github.com/users/ulysses-you","html_url":"https://github.com/ulysses-you","followers_url":"https://api.github.com/users/ulysses-you/followers","following_url":"https://api.github.com/users/ulysses-you/following{/other_user}","gists_url":"https://api.github.com/users/ulysses-you/gists{/gist_id}","starred_url":"https://api.github.com/users/ulysses-you/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulysses-you/subscriptions","organizations_url":"https://api.github.com/users/ulysses-you/orgs","repos_url":"https://api.github.com/users/ulysses-you/repos","events_url":"https://api.github.com/users/ulysses-you/events{/privacy}","received_events_url":"https://api.github.com/users/ulysses-you/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ulysses-you/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/ulysses-you/spark","forks_url":"https://api.github.com/repos/ulysses-you/spark/forks","keys_url":"https://api.github.com/repos/ulysses-you/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ulysses-you/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ulysses-you/spark/teams","hooks_url":"https://api.github.com/repos/ulysses-you/spark/hooks","issue_events_url":"https://api.github.com/repos/ulysses-you/spark/issues/events{/number}","events_url":"https://api.github.com/repos/ulysses-you/spark/events","assignees_url":"https://api.github.com/repos/ulysses-you/spark/assignees{/user}","branches_url":"https://api.github.com/repos/ulysses-you/spark/branches{/branch}","tags_url":"https://api.github.com/repos/ulysses-you/spark/tags","blobs_url":"https://api.github.com/repos/ulysses-you/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ulysses-you/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ulysses-you/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ulysses-you/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ulysses-you/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ulysses-you/spark/languages","stargazers_url":"https://api.github.com/repos/ulysses-you/spark/stargazers","contributors_url":"https://api.github.com/repos/ulysses-you/spark/contributors","subscribers_url":"https://api.github.com/repos/ulysses-you/spark/subscribers","subscription_url":"https://api.github.com/repos/ulysses-you/spark/subscription","commits_url":"https://api.github.com/repos/ulysses-you/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ulysses-you/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ulysses-you/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ulysses-you/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ulysses-you/spark/contents/{+path}","compare_url":"https://api.github.com/repos/ulysses-you/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ulysses-you/spark/merges","archive_url":"https://api.github.com/repos/ulysses-you/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ulysses-you/spark/downloads","issues_url":"https://api.github.com/repos/ulysses-you/spark/issues{/number}","pulls_url":"https://api.github.com/repos/ulysses-you/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ulysses-you/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ulysses-you/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ulysses-you/spark/labels{/name}","releases_url":"https://api.github.com/repos/ulysses-you/spark/releases{/id}","deployments_url":"https://api.github.com/repos/ulysses-you/spark/deployments","created_at":"2019-07-08T06:11:57Z","updated_at":"2022-01-10T01:34:59Z","pushed_at":"2024-08-13T23:12:37Z","git_url":"git://github.com/ulysses-you/spark.git","ssh_url":"git@github.com:ulysses-you/spark.git","clone_url":"https://github.com/ulysses-you/spark.git","svn_url":"https://github.com/ulysses-you/spark","homepage":"","size":399300,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a8d69132fb33cc5a7ff365715840ba99c6514c49","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39870"},"html":{"href":"https://github.com/apache/spark/pull/39870"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39870"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39870/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39870/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39870/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5ba6565dffce2797d4bd36bc3f2e1b66e4c3a176"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39869","id":1227619225,"node_id":"PR_kwDOAQXtWs5JK_uZ","html_url":"https://github.com/apache/spark/pull/39869","diff_url":"https://github.com/apache/spark/pull/39869.diff","patch_url":"https://github.com/apache/spark/pull/39869.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39869","number":39869,"state":"closed","locked":false,"title":"[SPARK-42297][SQL] Assign name to _LEGACY_ERROR_TEMP_2412","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to assign name to _LEGACY_ERROR_TEMP_2412, \"UNSUPPORTED_EXPR_FOR_WINDOW\".\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should assign proper name to _LEGACY_ERROR_TEMP_*\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n`./build/sbt \"sql/testOnly org.apache.spark.sql.SQLQueryTestSuite*\"`","created_at":"2023-02-03T05:44:48Z","updated_at":"2023-04-22T05:48:47Z","closed_at":"2023-02-04T09:00:05Z","merged_at":null,"merge_commit_sha":"9d4158d640047a9c8cbb6acd9d7f0f72cb5be1bd","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39869/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39869/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39869/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/90a3ddc3a473e81cfeaa86f15d3fb5d40f714b99","head":{"label":"itholic:LEGACY_2412","ref":"LEGACY_2412","sha":"90a3ddc3a473e81cfeaa86f15d3fb5d40f714b99","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"c5f72b3e2086d66c72699778915d2ab6ee64a6eb","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39869"},"html":{"href":"https://github.com/apache/spark/pull/39869"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39869"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39869/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39869/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39869/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/90a3ddc3a473e81cfeaa86f15d3fb5d40f714b99"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39868","id":1227588248,"node_id":"PR_kwDOAQXtWs5JK4KY","html_url":"https://github.com/apache/spark/pull/39868","diff_url":"https://github.com/apache/spark/pull/39868.diff","patch_url":"https://github.com/apache/spark/pull/39868.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39868","number":39868,"state":"closed","locked":false,"title":"[SPARK-42296][SQL] Apply spark.sql.inferTimestampNTZInDataSources.enabled on JDBC data source","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nSimliar to https://github.com/apache/spark/pull/39777 and https://github.com/apache/spark/pull/39812, this PR proposes to use `spark.sql.inferTimestampNTZInDataSources.enabled` to control the behavior of timestamp type inference on JDBC data sources.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nUnify the TimestampNTZ type inference behavior over data sources. In JDBC/JSON/CSV data sources, a column can be Timestamp type or TimestampNTZ type. We need a lightweight configuration to control the behavior. \r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo, TimestampNTZ is not released yet.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nUTs","created_at":"2023-02-03T05:01:15Z","updated_at":"2023-02-03T18:06:32Z","closed_at":"2023-02-03T18:06:32Z","merged_at":null,"merge_commit_sha":"9c3b937a18b046e8faf25f7c4aa064f1d2123c7f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39868/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39868/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39868/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ecf0e3b852648f765e5c8cdd1301bbf632d7d089","head":{"label":"gengliangwang:jdbcNTZ","ref":"jdbcNTZ","sha":"ecf0e3b852648f765e5c8cdd1301bbf632d7d089","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4d26c0ad0c9feb3dd25e0166246a688b095fb51e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39868"},"html":{"href":"https://github.com/apache/spark/pull/39868"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39868"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39868/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39868/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39868/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ecf0e3b852648f765e5c8cdd1301bbf632d7d089"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39867","id":1227578198,"node_id":"PR_kwDOAQXtWs5JK1tW","html_url":"https://github.com/apache/spark/pull/39867","diff_url":"https://github.com/apache/spark/pull/39867.diff","patch_url":"https://github.com/apache/spark/pull/39867.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39867","number":39867,"state":"closed","locked":false,"title":"[SPARK-41985][SQL][FOLLOWUP] Remove alias in GROUP BY only when the expr is resolved","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis is a followup of https://github.com/apache/spark/pull/39508 to fix a regression. We should not remove aliases from grouping expressions if they are not resolved, as the alias may be necessary for resolution, such as `CreateNamedStruct`.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nfix a regression\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nno\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nnew test","created_at":"2023-02-03T04:48:19Z","updated_at":"2023-02-03T12:40:41Z","closed_at":"2023-02-03T12:40:41Z","merged_at":null,"merge_commit_sha":"7c26c3946006d81a29af8f48bb9c13e35d73bac8","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39867/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39867/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39867/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f21aa9a78e1bae06111f7e0c603a6b8f254a6d0e","head":{"label":"cloud-fan:column","ref":"column","sha":"f21aa9a78e1bae06111f7e0c603a6b8f254a6d0e","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4d26c0ad0c9feb3dd25e0166246a688b095fb51e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39867"},"html":{"href":"https://github.com/apache/spark/pull/39867"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39867"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39867/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39867/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39867/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f21aa9a78e1bae06111f7e0c603a6b8f254a6d0e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39866","id":1227500593,"node_id":"PR_kwDOAQXtWs5JKiwx","html_url":"https://github.com/apache/spark/pull/39866","diff_url":"https://github.com/apache/spark/pull/39866.diff","patch_url":"https://github.com/apache/spark/pull/39866.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39866","number":39866,"state":"closed","locked":false,"title":"[SPARK-42287][CONNECT][BUILD] Fix shading so that the JVM client jar can include all 3rd-party dependencies in the runtime.","user":{"login":"zhenlineo","id":4190164,"node_id":"MDQ6VXNlcjQxOTAxNjQ=","avatar_url":"https://avatars.githubusercontent.com/u/4190164?v=4","gravatar_id":"","url":"https://api.github.com/users/zhenlineo","html_url":"https://github.com/zhenlineo","followers_url":"https://api.github.com/users/zhenlineo/followers","following_url":"https://api.github.com/users/zhenlineo/following{/other_user}","gists_url":"https://api.github.com/users/zhenlineo/gists{/gist_id}","starred_url":"https://api.github.com/users/zhenlineo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhenlineo/subscriptions","organizations_url":"https://api.github.com/users/zhenlineo/orgs","repos_url":"https://api.github.com/users/zhenlineo/repos","events_url":"https://api.github.com/users/zhenlineo/events{/privacy}","received_events_url":"https://api.github.com/users/zhenlineo/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nFix the JVM client dependencies and shading result.\r\nThe common jar should not be shaded. The shading should be done in client or server. \r\nThe common jar shall depends on minimal dependency if possible. \r\nThe client jar should provides all compiled dependencies out of the box, including netty etc. \r\nThe client sbt and mvn shall produce the same shading result. \r\n\r\nThe current client dependency summary:\r\n```\r\n[INFO] --- maven-dependency-plugin:3.3.0:tree (default-cli) @ spark-connect-client-jvm_2.12 ---\r\n[INFO] org.apache.spark:spark-connect-client-jvm_2.12:jar:3.5.0-SNAPSHOT\r\n[INFO] +- org.apache.spark:spark-connect-common_2.12:jar:3.5.0-SNAPSHOT:compile\r\n[INFO] |  +- org.scala-lang:scala-library:jar:2.12.17:compile\r\n[INFO] |  +- io.grpc:grpc-netty:jar:1.47.0:compile\r\n[INFO] |  |  +- io.grpc:grpc-core:jar:1.47.0:compile\r\n[INFO] |  |  |  +- com.google.code.gson:gson:jar:2.9.0:runtime\r\n[INFO] |  |  |  +- com.google.android:annotations:jar:4.1.1.4:runtime\r\n[INFO] |  |  |  \\- org.codehaus.mojo:animal-sniffer-annotations:jar:1.19:runtime\r\n[INFO] |  |  \\- io.perfmark:perfmark-api:jar:0.25.0:runtime\r\n[INFO] |  +- io.grpc:grpc-protobuf:jar:1.47.0:compile\r\n[INFO] |  |  +- io.grpc:grpc-api:jar:1.47.0:compile\r\n[INFO] |  |  |  \\- io.grpc:grpc-context:jar:1.47.0:compile\r\n[INFO] |  |  +- com.google.api.grpc:proto-google-common-protos:jar:2.0.1:compile\r\n[INFO] |  |  \\- io.grpc:grpc-protobuf-lite:jar:1.47.0:compile\r\n[INFO] |  +- io.grpc:grpc-services:jar:1.47.0:compile\r\n[INFO] |  |  \\- com.google.protobuf:protobuf-java-util:jar:3.19.2:runtime\r\n[INFO] |  \\- io.grpc:grpc-stub:jar:1.47.0:compile\r\n[INFO] +- com.google.protobuf:protobuf-java:jar:3.21.12:compile\r\n[INFO] +- com.google.guava:guava:jar:31.0.1-jre:compile\r\n[INFO] |  +- com.google.guava:failureaccess:jar:1.0.1:compile\r\n[INFO] |  +- com.google.guava:listenablefuture:jar:9999.0-empty-to-avoid-conflict-with-guava:compile\r\n[INFO] |  +- com.google.code.findbugs:jsr305:jar:3.0.0:compile\r\n[INFO] |  +- org.checkerframework:checker-qual:jar:3.12.0:compile\r\n[INFO] |  +- com.google.errorprone:error_prone_annotations:jar:2.7.1:compile\r\n[INFO] |  \\- com.google.j2objc:j2objc-annotations:jar:1.3:compile\r\n[INFO] +- io.netty:netty-codec-http2:jar:4.1.87.Final:compile\r\n[INFO] |  +- io.netty:netty-common:jar:4.1.87.Final:compile\r\n[INFO] |  +- io.netty:netty-buffer:jar:4.1.87.Final:compile\r\n[INFO] |  +- io.netty:netty-transport:jar:4.1.87.Final:compile\r\n[INFO] |  |  \\- io.netty:netty-resolver:jar:4.1.87.Final:compile\r\n[INFO] |  +- io.netty:netty-codec:jar:4.1.87.Final:compile\r\n[INFO] |  +- io.netty:netty-handler:jar:4.1.87.Final:compile\r\n[INFO] |  \\- io.netty:netty-codec-http:jar:4.1.87.Final:compile\r\n[INFO] +- io.netty:netty-handler-proxy:jar:4.1.87.Final:compile\r\n[INFO] |  \\- io.netty:netty-codec-socks:jar:4.1.87.Final:compile\r\n[INFO] +- io.netty:netty-transport-native-unix-common:jar:4.1.87.Final:compile\r\n[INFO] +- org.spark-project.spark:unused:jar:1.0.0:compile\r\n```\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nFix the client jar package.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nExisting tests.","created_at":"2023-02-03T02:48:03Z","updated_at":"2023-02-16T18:26:09Z","closed_at":"2023-02-16T18:26:09Z","merged_at":null,"merge_commit_sha":"d5acc3c30e7ba963689208ad3a61f1cf89833cdd","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39866/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39866/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39866/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b73edcc36cef5e072e41f69bba3555c8c95371b7","head":{"label":"zhenlineo:fix-jars","ref":"fix-jars","sha":"b73edcc36cef5e072e41f69bba3555c8c95371b7","user":{"login":"zhenlineo","id":4190164,"node_id":"MDQ6VXNlcjQxOTAxNjQ=","avatar_url":"https://avatars.githubusercontent.com/u/4190164?v=4","gravatar_id":"","url":"https://api.github.com/users/zhenlineo","html_url":"https://github.com/zhenlineo","followers_url":"https://api.github.com/users/zhenlineo/followers","following_url":"https://api.github.com/users/zhenlineo/following{/other_user}","gists_url":"https://api.github.com/users/zhenlineo/gists{/gist_id}","starred_url":"https://api.github.com/users/zhenlineo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhenlineo/subscriptions","organizations_url":"https://api.github.com/users/zhenlineo/orgs","repos_url":"https://api.github.com/users/zhenlineo/repos","events_url":"https://api.github.com/users/zhenlineo/events{/privacy}","received_events_url":"https://api.github.com/users/zhenlineo/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":464980742,"node_id":"R_kgDOG7cLBg","name":"spark","full_name":"zhenlineo/spark","private":false,"owner":{"login":"zhenlineo","id":4190164,"node_id":"MDQ6VXNlcjQxOTAxNjQ=","avatar_url":"https://avatars.githubusercontent.com/u/4190164?v=4","gravatar_id":"","url":"https://api.github.com/users/zhenlineo","html_url":"https://github.com/zhenlineo","followers_url":"https://api.github.com/users/zhenlineo/followers","following_url":"https://api.github.com/users/zhenlineo/following{/other_user}","gists_url":"https://api.github.com/users/zhenlineo/gists{/gist_id}","starred_url":"https://api.github.com/users/zhenlineo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhenlineo/subscriptions","organizations_url":"https://api.github.com/users/zhenlineo/orgs","repos_url":"https://api.github.com/users/zhenlineo/repos","events_url":"https://api.github.com/users/zhenlineo/events{/privacy}","received_events_url":"https://api.github.com/users/zhenlineo/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhenlineo/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/zhenlineo/spark","forks_url":"https://api.github.com/repos/zhenlineo/spark/forks","keys_url":"https://api.github.com/repos/zhenlineo/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhenlineo/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhenlineo/spark/teams","hooks_url":"https://api.github.com/repos/zhenlineo/spark/hooks","issue_events_url":"https://api.github.com/repos/zhenlineo/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhenlineo/spark/events","assignees_url":"https://api.github.com/repos/zhenlineo/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhenlineo/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhenlineo/spark/tags","blobs_url":"https://api.github.com/repos/zhenlineo/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhenlineo/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhenlineo/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhenlineo/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhenlineo/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhenlineo/spark/languages","stargazers_url":"https://api.github.com/repos/zhenlineo/spark/stargazers","contributors_url":"https://api.github.com/repos/zhenlineo/spark/contributors","subscribers_url":"https://api.github.com/repos/zhenlineo/spark/subscribers","subscription_url":"https://api.github.com/repos/zhenlineo/spark/subscription","commits_url":"https://api.github.com/repos/zhenlineo/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhenlineo/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhenlineo/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhenlineo/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhenlineo/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhenlineo/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhenlineo/spark/merges","archive_url":"https://api.github.com/repos/zhenlineo/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhenlineo/spark/downloads","issues_url":"https://api.github.com/repos/zhenlineo/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhenlineo/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhenlineo/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhenlineo/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhenlineo/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhenlineo/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhenlineo/spark/deployments","created_at":"2022-03-01T16:55:20Z","updated_at":"2022-03-02T15:44:38Z","pushed_at":"2023-10-26T21:51:49Z","git_url":"git://github.com/zhenlineo/spark.git","ssh_url":"git@github.com:zhenlineo/spark.git","clone_url":"https://github.com/zhenlineo/spark.git","svn_url":"https://github.com/zhenlineo/spark","homepage":"https://spark.apache.org/","size":426321,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"6f47ac43e55c332f63876cf4f8ecf1b41b277651","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39866"},"html":{"href":"https://github.com/apache/spark/pull/39866"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39866"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39866/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39866/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39866/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b73edcc36cef5e072e41f69bba3555c8c95371b7"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39865","id":1227459461,"node_id":"PR_kwDOAQXtWs5JKYuF","html_url":"https://github.com/apache/spark/pull/39865","diff_url":"https://github.com/apache/spark/pull/39865.diff","patch_url":"https://github.com/apache/spark/pull/39865.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39865","number":39865,"state":"closed","locked":false,"title":"[SPARK-42052][SQL] Codegen Support for HiveSimpleUDF","user":{"login":"panbingkun","id":15246973,"node_id":"MDQ6VXNlcjE1MjQ2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/15246973?v=4","gravatar_id":"","url":"https://api.github.com/users/panbingkun","html_url":"https://github.com/panbingkun","followers_url":"https://api.github.com/users/panbingkun/followers","following_url":"https://api.github.com/users/panbingkun/following{/other_user}","gists_url":"https://api.github.com/users/panbingkun/gists{/gist_id}","starred_url":"https://api.github.com/users/panbingkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panbingkun/subscriptions","organizations_url":"https://api.github.com/users/panbingkun/orgs","repos_url":"https://api.github.com/users/panbingkun/repos","events_url":"https://api.github.com/users/panbingkun/events{/privacy}","received_events_url":"https://api.github.com/users/panbingkun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nAs a subtask of [SPARK-42050](https://issues.apache.org/jira/browse/SPARK-42050), this PR adds Codegen Support for HiveSimpleUDF\r\n\r\n### Why are the changes needed?\r\nImprove codegen coverage and performance\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nNew UT & Pass GA.","created_at":"2023-02-03T01:58:07Z","updated_at":"2023-05-14T00:10:46Z","closed_at":"2023-05-14T00:10:46Z","merged_at":null,"merge_commit_sha":"a30b0bedcfc1ea31a29303363cf656afd62da3f8","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39865/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39865/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39865/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/140013b7fffea0e6d6ea986de4b967455203c070","head":{"label":"panbingkun:SPARK-42052","ref":"SPARK-42052","sha":"140013b7fffea0e6d6ea986de4b967455203c070","user":{"login":"panbingkun","id":15246973,"node_id":"MDQ6VXNlcjE1MjQ2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/15246973?v=4","gravatar_id":"","url":"https://api.github.com/users/panbingkun","html_url":"https://github.com/panbingkun","followers_url":"https://api.github.com/users/panbingkun/followers","following_url":"https://api.github.com/users/panbingkun/following{/other_user}","gists_url":"https://api.github.com/users/panbingkun/gists{/gist_id}","starred_url":"https://api.github.com/users/panbingkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panbingkun/subscriptions","organizations_url":"https://api.github.com/users/panbingkun/orgs","repos_url":"https://api.github.com/users/panbingkun/repos","events_url":"https://api.github.com/users/panbingkun/events{/privacy}","received_events_url":"https://api.github.com/users/panbingkun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":481429011,"node_id":"R_kgDOHLIGEw","name":"spark","full_name":"panbingkun/spark","private":false,"owner":{"login":"panbingkun","id":15246973,"node_id":"MDQ6VXNlcjE1MjQ2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/15246973?v=4","gravatar_id":"","url":"https://api.github.com/users/panbingkun","html_url":"https://github.com/panbingkun","followers_url":"https://api.github.com/users/panbingkun/followers","following_url":"https://api.github.com/users/panbingkun/following{/other_user}","gists_url":"https://api.github.com/users/panbingkun/gists{/gist_id}","starred_url":"https://api.github.com/users/panbingkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panbingkun/subscriptions","organizations_url":"https://api.github.com/users/panbingkun/orgs","repos_url":"https://api.github.com/users/panbingkun/repos","events_url":"https://api.github.com/users/panbingkun/events{/privacy}","received_events_url":"https://api.github.com/users/panbingkun/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/panbingkun/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/panbingkun/spark","forks_url":"https://api.github.com/repos/panbingkun/spark/forks","keys_url":"https://api.github.com/repos/panbingkun/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/panbingkun/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/panbingkun/spark/teams","hooks_url":"https://api.github.com/repos/panbingkun/spark/hooks","issue_events_url":"https://api.github.com/repos/panbingkun/spark/issues/events{/number}","events_url":"https://api.github.com/repos/panbingkun/spark/events","assignees_url":"https://api.github.com/repos/panbingkun/spark/assignees{/user}","branches_url":"https://api.github.com/repos/panbingkun/spark/branches{/branch}","tags_url":"https://api.github.com/repos/panbingkun/spark/tags","blobs_url":"https://api.github.com/repos/panbingkun/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/panbingkun/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/panbingkun/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/panbingkun/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/panbingkun/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/panbingkun/spark/languages","stargazers_url":"https://api.github.com/repos/panbingkun/spark/stargazers","contributors_url":"https://api.github.com/repos/panbingkun/spark/contributors","subscribers_url":"https://api.github.com/repos/panbingkun/spark/subscribers","subscription_url":"https://api.github.com/repos/panbingkun/spark/subscription","commits_url":"https://api.github.com/repos/panbingkun/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/panbingkun/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/panbingkun/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/panbingkun/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/panbingkun/spark/contents/{+path}","compare_url":"https://api.github.com/repos/panbingkun/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/panbingkun/spark/merges","archive_url":"https://api.github.com/repos/panbingkun/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/panbingkun/spark/downloads","issues_url":"https://api.github.com/repos/panbingkun/spark/issues{/number}","pulls_url":"https://api.github.com/repos/panbingkun/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/panbingkun/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/panbingkun/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/panbingkun/spark/labels{/name}","releases_url":"https://api.github.com/repos/panbingkun/spark/releases{/id}","deployments_url":"https://api.github.com/repos/panbingkun/spark/deployments","created_at":"2022-04-14T01:38:25Z","updated_at":"2025-02-05T01:36:40Z","pushed_at":"2025-02-05T01:36:19Z","git_url":"git://github.com/panbingkun/spark.git","ssh_url":"git@github.com:panbingkun/spark.git","clone_url":"https://github.com/panbingkun/spark.git","svn_url":"https://github.com/panbingkun/spark","homepage":"https://spark.apache.org/","size":497912,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"4d26c0ad0c9feb3dd25e0166246a688b095fb51e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39865"},"html":{"href":"https://github.com/apache/spark/pull/39865"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39865"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39865/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39865/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39865/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/140013b7fffea0e6d6ea986de4b967455203c070"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39864","id":1227318078,"node_id":"PR_kwDOAQXtWs5JJ2M-","html_url":"https://github.com/apache/spark/pull/39864","diff_url":"https://github.com/apache/spark/pull/39864.diff","patch_url":"https://github.com/apache/spark/pull/39864.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39864","number":39864,"state":"closed","locked":false,"title":"[SPARK-42295][CONNECT][TEST] Tear down the test cleanly","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nTears down the test cleanly.\r\n\r\n### Why are the changes needed?\r\n\r\nCurrently `SparkConnectSQLTestCase` doesn't tear down cleanly but calling `setUpClass` instead.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nManually.","created_at":"2023-02-02T22:28:18Z","updated_at":"2023-02-03T00:24:53Z","closed_at":"2023-02-03T00:24:53Z","merged_at":null,"merge_commit_sha":"5c34730b544e6a6260aaf13dedc146b1d6ad315b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39864/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39864/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39864/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f1368c11b71a3860ecd5469f63b3b0ab1c96a8a7","head":{"label":"ueshin:issues/SPARK-42295/tearDownClass","ref":"issues/SPARK-42295/tearDownClass","sha":"f1368c11b71a3860ecd5469f63b3b0ab1c96a8a7","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":17234665,"node_id":"MDEwOlJlcG9zaXRvcnkxNzIzNDY2NQ==","name":"apache-spark","full_name":"ueshin/apache-spark","private":false,"owner":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ueshin/apache-spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/ueshin/apache-spark","forks_url":"https://api.github.com/repos/ueshin/apache-spark/forks","keys_url":"https://api.github.com/repos/ueshin/apache-spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ueshin/apache-spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ueshin/apache-spark/teams","hooks_url":"https://api.github.com/repos/ueshin/apache-spark/hooks","issue_events_url":"https://api.github.com/repos/ueshin/apache-spark/issues/events{/number}","events_url":"https://api.github.com/repos/ueshin/apache-spark/events","assignees_url":"https://api.github.com/repos/ueshin/apache-spark/assignees{/user}","branches_url":"https://api.github.com/repos/ueshin/apache-spark/branches{/branch}","tags_url":"https://api.github.com/repos/ueshin/apache-spark/tags","blobs_url":"https://api.github.com/repos/ueshin/apache-spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ueshin/apache-spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ueshin/apache-spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ueshin/apache-spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ueshin/apache-spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ueshin/apache-spark/languages","stargazers_url":"https://api.github.com/repos/ueshin/apache-spark/stargazers","contributors_url":"https://api.github.com/repos/ueshin/apache-spark/contributors","subscribers_url":"https://api.github.com/repos/ueshin/apache-spark/subscribers","subscription_url":"https://api.github.com/repos/ueshin/apache-spark/subscription","commits_url":"https://api.github.com/repos/ueshin/apache-spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ueshin/apache-spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ueshin/apache-spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ueshin/apache-spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ueshin/apache-spark/contents/{+path}","compare_url":"https://api.github.com/repos/ueshin/apache-spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ueshin/apache-spark/merges","archive_url":"https://api.github.com/repos/ueshin/apache-spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ueshin/apache-spark/downloads","issues_url":"https://api.github.com/repos/ueshin/apache-spark/issues{/number}","pulls_url":"https://api.github.com/repos/ueshin/apache-spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ueshin/apache-spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ueshin/apache-spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ueshin/apache-spark/labels{/name}","releases_url":"https://api.github.com/repos/ueshin/apache-spark/releases{/id}","deployments_url":"https://api.github.com/repos/ueshin/apache-spark/deployments","created_at":"2014-02-27T03:10:47Z","updated_at":"2025-02-07T02:07:18Z","pushed_at":"2025-02-07T19:29:05Z","git_url":"git://github.com/ueshin/apache-spark.git","ssh_url":"git@github.com:ueshin/apache-spark.git","clone_url":"https://github.com/ueshin/apache-spark.git","svn_url":"https://github.com/ueshin/apache-spark","homepage":null,"size":484941,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":8,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":8,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"15971a0e6f8fb21d5c6effa55ed0b313cd03ec07","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39864"},"html":{"href":"https://github.com/apache/spark/pull/39864"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39864"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39864/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39864/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39864/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f1368c11b71a3860ecd5469f63b3b0ab1c96a8a7"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39863","id":1227210791,"node_id":"PR_kwDOAQXtWs5JJcAn","html_url":"https://github.com/apache/spark/pull/39863","diff_url":"https://github.com/apache/spark/pull/39863.diff","patch_url":"https://github.com/apache/spark/pull/39863.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39863","number":39863,"state":"closed","locked":false,"title":"[SPARK-42294][SQL] Include column default values in DESCRIBE output for V2 tables","user":{"login":"dtenedor","id":99207096,"node_id":"U_kgDOBenHuA","avatar_url":"https://avatars.githubusercontent.com/u/99207096?v=4","gravatar_id":"","url":"https://api.github.com/users/dtenedor","html_url":"https://github.com/dtenedor","followers_url":"https://api.github.com/users/dtenedor/followers","following_url":"https://api.github.com/users/dtenedor/following{/other_user}","gists_url":"https://api.github.com/users/dtenedor/gists{/gist_id}","starred_url":"https://api.github.com/users/dtenedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dtenedor/subscriptions","organizations_url":"https://api.github.com/users/dtenedor/orgs","repos_url":"https://api.github.com/users/dtenedor/repos","events_url":"https://api.github.com/users/dtenedor/events{/privacy}","received_events_url":"https://api.github.com/users/dtenedor/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nInclude column default values in DESCRIBE output for V2 tables.\r\n\r\nThis was previously implemented for V1 tables, but missed V2 tables.\r\n\r\n### Why are the changes needed?\r\n\r\nDESCRIBE commands make it easier to work with tables by inspecting their metadata.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, it adds more information to DESCRIBE commands for tables with default column values.\r\n\r\n### How was this patch tested?\r\n\r\nThis PR adds unit test coverage.","created_at":"2023-02-02T20:47:20Z","updated_at":"2023-02-03T05:11:35Z","closed_at":"2023-02-03T05:11:35Z","merged_at":null,"merge_commit_sha":"0f99b4d2064ef41828df50dcceb820ad48609bdb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39863/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39863/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39863/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d1494f181450150732a083127ab126ca1f1eacb0","head":{"label":"dtenedor:descibe-defaults-v2","ref":"descibe-defaults-v2","sha":"d1494f181450150732a083127ab126ca1f1eacb0","user":{"login":"dtenedor","id":99207096,"node_id":"U_kgDOBenHuA","avatar_url":"https://avatars.githubusercontent.com/u/99207096?v=4","gravatar_id":"","url":"https://api.github.com/users/dtenedor","html_url":"https://github.com/dtenedor","followers_url":"https://api.github.com/users/dtenedor/followers","following_url":"https://api.github.com/users/dtenedor/following{/other_user}","gists_url":"https://api.github.com/users/dtenedor/gists{/gist_id}","starred_url":"https://api.github.com/users/dtenedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dtenedor/subscriptions","organizations_url":"https://api.github.com/users/dtenedor/orgs","repos_url":"https://api.github.com/users/dtenedor/repos","events_url":"https://api.github.com/users/dtenedor/events{/privacy}","received_events_url":"https://api.github.com/users/dtenedor/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":592933002,"node_id":"R_kgDOI1dwig","name":"spark","full_name":"dtenedor/spark","private":false,"owner":{"login":"dtenedor","id":99207096,"node_id":"U_kgDOBenHuA","avatar_url":"https://avatars.githubusercontent.com/u/99207096?v=4","gravatar_id":"","url":"https://api.github.com/users/dtenedor","html_url":"https://github.com/dtenedor","followers_url":"https://api.github.com/users/dtenedor/followers","following_url":"https://api.github.com/users/dtenedor/following{/other_user}","gists_url":"https://api.github.com/users/dtenedor/gists{/gist_id}","starred_url":"https://api.github.com/users/dtenedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dtenedor/subscriptions","organizations_url":"https://api.github.com/users/dtenedor/orgs","repos_url":"https://api.github.com/users/dtenedor/repos","events_url":"https://api.github.com/users/dtenedor/events{/privacy}","received_events_url":"https://api.github.com/users/dtenedor/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dtenedor/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/dtenedor/spark","forks_url":"https://api.github.com/repos/dtenedor/spark/forks","keys_url":"https://api.github.com/repos/dtenedor/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dtenedor/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dtenedor/spark/teams","hooks_url":"https://api.github.com/repos/dtenedor/spark/hooks","issue_events_url":"https://api.github.com/repos/dtenedor/spark/issues/events{/number}","events_url":"https://api.github.com/repos/dtenedor/spark/events","assignees_url":"https://api.github.com/repos/dtenedor/spark/assignees{/user}","branches_url":"https://api.github.com/repos/dtenedor/spark/branches{/branch}","tags_url":"https://api.github.com/repos/dtenedor/spark/tags","blobs_url":"https://api.github.com/repos/dtenedor/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dtenedor/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dtenedor/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/dtenedor/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dtenedor/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/dtenedor/spark/languages","stargazers_url":"https://api.github.com/repos/dtenedor/spark/stargazers","contributors_url":"https://api.github.com/repos/dtenedor/spark/contributors","subscribers_url":"https://api.github.com/repos/dtenedor/spark/subscribers","subscription_url":"https://api.github.com/repos/dtenedor/spark/subscription","commits_url":"https://api.github.com/repos/dtenedor/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/dtenedor/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/dtenedor/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/dtenedor/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/dtenedor/spark/contents/{+path}","compare_url":"https://api.github.com/repos/dtenedor/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dtenedor/spark/merges","archive_url":"https://api.github.com/repos/dtenedor/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dtenedor/spark/downloads","issues_url":"https://api.github.com/repos/dtenedor/spark/issues{/number}","pulls_url":"https://api.github.com/repos/dtenedor/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/dtenedor/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/dtenedor/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dtenedor/spark/labels{/name}","releases_url":"https://api.github.com/repos/dtenedor/spark/releases{/id}","deployments_url":"https://api.github.com/repos/dtenedor/spark/deployments","created_at":"2023-01-24T21:00:57Z","updated_at":"2025-01-17T22:49:32Z","pushed_at":"2025-01-17T22:48:49Z","git_url":"git://github.com/dtenedor/spark.git","ssh_url":"git@github.com:dtenedor/spark.git","clone_url":"https://github.com/dtenedor/spark.git","svn_url":"https://github.com/dtenedor/spark","homepage":"https://spark.apache.org/","size":423104,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"15971a0e6f8fb21d5c6effa55ed0b313cd03ec07","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39863"},"html":{"href":"https://github.com/apache/spark/pull/39863"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39863"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39863/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39863/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39863/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d1494f181450150732a083127ab126ca1f1eacb0"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39862","id":1227114229,"node_id":"PR_kwDOAQXtWs5JJEb1","html_url":"https://github.com/apache/spark/pull/39862","diff_url":"https://github.com/apache/spark/pull/39862.diff","patch_url":"https://github.com/apache/spark/pull/39862.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39862","number":39862,"state":"closed","locked":false,"title":"[MINOR][CORE][PYTHON][SQL][PS] Fix argument name in error message","user":{"login":"deepyaman","id":14007150,"node_id":"MDQ6VXNlcjE0MDA3MTUw","avatar_url":"https://avatars.githubusercontent.com/u/14007150?v=4","gravatar_id":"","url":"https://api.github.com/users/deepyaman","html_url":"https://github.com/deepyaman","followers_url":"https://api.github.com/users/deepyaman/followers","following_url":"https://api.github.com/users/deepyaman/following{/other_user}","gists_url":"https://api.github.com/users/deepyaman/gists{/gist_id}","starred_url":"https://api.github.com/users/deepyaman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepyaman/subscriptions","organizations_url":"https://api.github.com/users/deepyaman/orgs","repos_url":"https://api.github.com/users/deepyaman/repos","events_url":"https://api.github.com/users/deepyaman/events{/privacy}","received_events_url":"https://api.github.com/users/deepyaman/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nChange the error message to reference \"by\" instead of \"on\" when validation \"on\" argument\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nThe error message references the wrong argument name\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nYes\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nUpdated the existing unit test","created_at":"2023-02-02T19:23:59Z","updated_at":"2023-02-03T08:07:01Z","closed_at":"2023-02-03T01:00:15Z","merged_at":null,"merge_commit_sha":"cdc8b9f5060d5aeaadc7ff90d12197a5808a939d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4138679613,"node_id":"LA_kwDOAQXtWs72rz09","url":"https://api.github.com/repos/apache/spark/labels/PANDAS%20API%20ON%20SPARK","name":"PANDAS API ON SPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39862/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39862/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39862/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1a34867b137db5fa95da6f563e2730fbffcf2266","head":{"label":"deepyaman:patch-4","ref":"patch-4","sha":"1a34867b137db5fa95da6f563e2730fbffcf2266","user":{"login":"deepyaman","id":14007150,"node_id":"MDQ6VXNlcjE0MDA3MTUw","avatar_url":"https://avatars.githubusercontent.com/u/14007150?v=4","gravatar_id":"","url":"https://api.github.com/users/deepyaman","html_url":"https://github.com/deepyaman","followers_url":"https://api.github.com/users/deepyaman/followers","following_url":"https://api.github.com/users/deepyaman/following{/other_user}","gists_url":"https://api.github.com/users/deepyaman/gists{/gist_id}","starred_url":"https://api.github.com/users/deepyaman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepyaman/subscriptions","organizations_url":"https://api.github.com/users/deepyaman/orgs","repos_url":"https://api.github.com/users/deepyaman/repos","events_url":"https://api.github.com/users/deepyaman/events{/privacy}","received_events_url":"https://api.github.com/users/deepyaman/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":162627166,"node_id":"MDEwOlJlcG9zaXRvcnkxNjI2MjcxNjY=","name":"spark","full_name":"deepyaman/spark","private":false,"owner":{"login":"deepyaman","id":14007150,"node_id":"MDQ6VXNlcjE0MDA3MTUw","avatar_url":"https://avatars.githubusercontent.com/u/14007150?v=4","gravatar_id":"","url":"https://api.github.com/users/deepyaman","html_url":"https://github.com/deepyaman","followers_url":"https://api.github.com/users/deepyaman/followers","following_url":"https://api.github.com/users/deepyaman/following{/other_user}","gists_url":"https://api.github.com/users/deepyaman/gists{/gist_id}","starred_url":"https://api.github.com/users/deepyaman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepyaman/subscriptions","organizations_url":"https://api.github.com/users/deepyaman/orgs","repos_url":"https://api.github.com/users/deepyaman/repos","events_url":"https://api.github.com/users/deepyaman/events{/privacy}","received_events_url":"https://api.github.com/users/deepyaman/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/deepyaman/spark","description":"Apache Spark","fork":true,"url":"https://api.github.com/repos/deepyaman/spark","forks_url":"https://api.github.com/repos/deepyaman/spark/forks","keys_url":"https://api.github.com/repos/deepyaman/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/deepyaman/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/deepyaman/spark/teams","hooks_url":"https://api.github.com/repos/deepyaman/spark/hooks","issue_events_url":"https://api.github.com/repos/deepyaman/spark/issues/events{/number}","events_url":"https://api.github.com/repos/deepyaman/spark/events","assignees_url":"https://api.github.com/repos/deepyaman/spark/assignees{/user}","branches_url":"https://api.github.com/repos/deepyaman/spark/branches{/branch}","tags_url":"https://api.github.com/repos/deepyaman/spark/tags","blobs_url":"https://api.github.com/repos/deepyaman/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/deepyaman/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/deepyaman/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/deepyaman/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/deepyaman/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/deepyaman/spark/languages","stargazers_url":"https://api.github.com/repos/deepyaman/spark/stargazers","contributors_url":"https://api.github.com/repos/deepyaman/spark/contributors","subscribers_url":"https://api.github.com/repos/deepyaman/spark/subscribers","subscription_url":"https://api.github.com/repos/deepyaman/spark/subscription","commits_url":"https://api.github.com/repos/deepyaman/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/deepyaman/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/deepyaman/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/deepyaman/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/deepyaman/spark/contents/{+path}","compare_url":"https://api.github.com/repos/deepyaman/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/deepyaman/spark/merges","archive_url":"https://api.github.com/repos/deepyaman/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/deepyaman/spark/downloads","issues_url":"https://api.github.com/repos/deepyaman/spark/issues{/number}","pulls_url":"https://api.github.com/repos/deepyaman/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/deepyaman/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/deepyaman/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/deepyaman/spark/labels{/name}","releases_url":"https://api.github.com/repos/deepyaman/spark/releases{/id}","deployments_url":"https://api.github.com/repos/deepyaman/spark/deployments","created_at":"2018-12-20T20:16:14Z","updated_at":"2018-12-20T20:16:45Z","pushed_at":"2023-06-20T17:55:52Z","git_url":"git://github.com/deepyaman/spark.git","ssh_url":"git@github.com:deepyaman/spark.git","clone_url":"https://github.com/deepyaman/spark.git","svn_url":"https://github.com/deepyaman/spark","homepage":"","size":288440,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"15971a0e6f8fb21d5c6effa55ed0b313cd03ec07","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39862"},"html":{"href":"https://github.com/apache/spark/pull/39862"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39862"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39862/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39862/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39862/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1a34867b137db5fa95da6f563e2730fbffcf2266"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39861","id":1226588640,"node_id":"PR_kwDOAQXtWs5JHEHg","html_url":"https://github.com/apache/spark/pull/39861","diff_url":"https://github.com/apache/spark/pull/39861.diff","patch_url":"https://github.com/apache/spark/pull/39861.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39861","number":39861,"state":"closed","locked":false,"title":"[WIP][SPARK-42291] Enable dropping of columns for non V2 tables","user":{"login":"yeachan153","id":30076090,"node_id":"MDQ6VXNlcjMwMDc2MDkw","avatar_url":"https://avatars.githubusercontent.com/u/30076090?v=4","gravatar_id":"","url":"https://api.github.com/users/yeachan153","html_url":"https://github.com/yeachan153","followers_url":"https://api.github.com/users/yeachan153/followers","following_url":"https://api.github.com/users/yeachan153/following{/other_user}","gists_url":"https://api.github.com/users/yeachan153/gists{/gist_id}","starred_url":"https://api.github.com/users/yeachan153/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeachan153/subscriptions","organizations_url":"https://api.github.com/users/yeachan153/orgs","repos_url":"https://api.github.com/users/yeachan153/repos","events_url":"https://api.github.com/users/yeachan153/events{/privacy}","received_events_url":"https://api.github.com/users/yeachan153/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"Add support to drop columns in non V2 tables.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nBuilt the jars in 3.2.0 and dropped columns using alter table:\r\n```sql\r\nALTER TABLE lake.foo DROP COLUMNS (`a`, `b`);\r\nALTER TABLE lake.foo DROP COLUMNS (`a`)\r\nALTER TABLE lake.foo DROP COLUMN `a`\r\n```\r\n\r\nTested on Spark 3.2.0 with an external hive metastore; the underlying data is in parquet format in cloud storage. Also affects the latest version.","created_at":"2023-02-02T13:23:27Z","updated_at":"2023-05-20T00:17:21Z","closed_at":"2023-05-20T00:17:21Z","merged_at":null,"merge_commit_sha":"9a3079d5aefe7abfbf56ba24af0e2ec8af7f5e73","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1753478521,"node_id":"MDU6TGFiZWwxNzUzNDc4NTIx","url":"https://api.github.com/repos/apache/spark/labels/Stale","name":"Stale","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39861/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39861/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39861/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2b8564cbc0c021624d666dd1505e6737384fa4e5","head":{"label":"yeachan153:SPARK-42291-allow-drop-operation-on-non-v2-tables","ref":"SPARK-42291-allow-drop-operation-on-non-v2-tables","sha":"2b8564cbc0c021624d666dd1505e6737384fa4e5","user":{"login":"yeachan153","id":30076090,"node_id":"MDQ6VXNlcjMwMDc2MDkw","avatar_url":"https://avatars.githubusercontent.com/u/30076090?v=4","gravatar_id":"","url":"https://api.github.com/users/yeachan153","html_url":"https://github.com/yeachan153","followers_url":"https://api.github.com/users/yeachan153/followers","following_url":"https://api.github.com/users/yeachan153/following{/other_user}","gists_url":"https://api.github.com/users/yeachan153/gists{/gist_id}","starred_url":"https://api.github.com/users/yeachan153/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeachan153/subscriptions","organizations_url":"https://api.github.com/users/yeachan153/orgs","repos_url":"https://api.github.com/users/yeachan153/repos","events_url":"https://api.github.com/users/yeachan153/events{/privacy}","received_events_url":"https://api.github.com/users/yeachan153/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":596526422,"node_id":"R_kgDOI45FVg","name":"spark","full_name":"yeachan153/spark","private":false,"owner":{"login":"yeachan153","id":30076090,"node_id":"MDQ6VXNlcjMwMDc2MDkw","avatar_url":"https://avatars.githubusercontent.com/u/30076090?v=4","gravatar_id":"","url":"https://api.github.com/users/yeachan153","html_url":"https://github.com/yeachan153","followers_url":"https://api.github.com/users/yeachan153/followers","following_url":"https://api.github.com/users/yeachan153/following{/other_user}","gists_url":"https://api.github.com/users/yeachan153/gists{/gist_id}","starred_url":"https://api.github.com/users/yeachan153/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeachan153/subscriptions","organizations_url":"https://api.github.com/users/yeachan153/orgs","repos_url":"https://api.github.com/users/yeachan153/repos","events_url":"https://api.github.com/users/yeachan153/events{/privacy}","received_events_url":"https://api.github.com/users/yeachan153/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yeachan153/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/yeachan153/spark","forks_url":"https://api.github.com/repos/yeachan153/spark/forks","keys_url":"https://api.github.com/repos/yeachan153/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yeachan153/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yeachan153/spark/teams","hooks_url":"https://api.github.com/repos/yeachan153/spark/hooks","issue_events_url":"https://api.github.com/repos/yeachan153/spark/issues/events{/number}","events_url":"https://api.github.com/repos/yeachan153/spark/events","assignees_url":"https://api.github.com/repos/yeachan153/spark/assignees{/user}","branches_url":"https://api.github.com/repos/yeachan153/spark/branches{/branch}","tags_url":"https://api.github.com/repos/yeachan153/spark/tags","blobs_url":"https://api.github.com/repos/yeachan153/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yeachan153/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yeachan153/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/yeachan153/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yeachan153/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/yeachan153/spark/languages","stargazers_url":"https://api.github.com/repos/yeachan153/spark/stargazers","contributors_url":"https://api.github.com/repos/yeachan153/spark/contributors","subscribers_url":"https://api.github.com/repos/yeachan153/spark/subscribers","subscription_url":"https://api.github.com/repos/yeachan153/spark/subscription","commits_url":"https://api.github.com/repos/yeachan153/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/yeachan153/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/yeachan153/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/yeachan153/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/yeachan153/spark/contents/{+path}","compare_url":"https://api.github.com/repos/yeachan153/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yeachan153/spark/merges","archive_url":"https://api.github.com/repos/yeachan153/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yeachan153/spark/downloads","issues_url":"https://api.github.com/repos/yeachan153/spark/issues{/number}","pulls_url":"https://api.github.com/repos/yeachan153/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/yeachan153/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/yeachan153/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yeachan153/spark/labels{/name}","releases_url":"https://api.github.com/repos/yeachan153/spark/releases{/id}","deployments_url":"https://api.github.com/repos/yeachan153/spark/deployments","created_at":"2023-02-02T11:31:44Z","updated_at":"2024-06-12T10:27:32Z","pushed_at":"2024-06-13T13:19:04Z","git_url":"git://github.com/yeachan153/spark.git","ssh_url":"git@github.com:yeachan153/spark.git","clone_url":"https://github.com/yeachan153/spark.git","svn_url":"https://github.com/yeachan153/spark","homepage":"https://spark.apache.org/","size":397179,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1cae312a74a2e6e2d82e87c09c208380be1a09fb","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39861"},"html":{"href":"https://github.com/apache/spark/pull/39861"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39861"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39861/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39861/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39861/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2b8564cbc0c021624d666dd1505e6737384fa4e5"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39860","id":1226474153,"node_id":"PR_kwDOAQXtWs5JGoKp","html_url":"https://github.com/apache/spark/pull/39860","diff_url":"https://github.com/apache/spark/pull/39860.diff","patch_url":"https://github.com/apache/spark/pull/39860.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39860","number":39860,"state":"closed","locked":false,"title":"[SPARK-42210][CONNECT][PYTHON] Standardize registered pickled Python UDFs","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nStandardize registered pickled Python UDFs, specifically, implement `spark.udf.register()`.\r\n\r\n### Why are the changes needed?\r\nTo reach parity with vanilla PySpark.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes. `spark.udf.register()` is added as shown below:\r\n\r\n```py\r\n>>> spark.udf\r\n<pyspark.sql.connect.udf.UDFRegistration object at 0x7fbca0077dc0>\r\n>>> f = spark.udf.register(\"f\", lambda x: x+1, \"int\")\r\n>>> f\r\n<function <lambda> at 0x7fbc905e5e50>\r\n>>> spark.sql(\"SELECT f(id) FROM range(2)\").collect()\r\n[Row(f(id)=1), Row(f(id)=2)] \r\n```\r\n\r\n### How was this patch tested?\r\nUnit tests.\r\n\r\nSPARK-41661","created_at":"2023-02-02T12:09:45Z","updated_at":"2023-12-19T02:23:11Z","closed_at":"2023-02-09T10:18:26Z","merged_at":null,"merge_commit_sha":"7375a2f6aa188560bcaf2859f3929c35c0881b01","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39860/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39860/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39860/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b4ba54875438c8333534e2467cff568db8576950","head":{"label":"xinrong-meng:connect_registered_udf","ref":"connect_registered_udf","sha":"b4ba54875438c8333534e2467cff568db8576950","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":335786381,"node_id":"MDEwOlJlcG9zaXRvcnkzMzU3ODYzODE=","name":"spark","full_name":"xinrong-meng/spark","private":false,"owner":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xinrong-meng/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xinrong-meng/spark","forks_url":"https://api.github.com/repos/xinrong-meng/spark/forks","keys_url":"https://api.github.com/repos/xinrong-meng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xinrong-meng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xinrong-meng/spark/teams","hooks_url":"https://api.github.com/repos/xinrong-meng/spark/hooks","issue_events_url":"https://api.github.com/repos/xinrong-meng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xinrong-meng/spark/events","assignees_url":"https://api.github.com/repos/xinrong-meng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xinrong-meng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xinrong-meng/spark/tags","blobs_url":"https://api.github.com/repos/xinrong-meng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xinrong-meng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xinrong-meng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xinrong-meng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xinrong-meng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xinrong-meng/spark/languages","stargazers_url":"https://api.github.com/repos/xinrong-meng/spark/stargazers","contributors_url":"https://api.github.com/repos/xinrong-meng/spark/contributors","subscribers_url":"https://api.github.com/repos/xinrong-meng/spark/subscribers","subscription_url":"https://api.github.com/repos/xinrong-meng/spark/subscription","commits_url":"https://api.github.com/repos/xinrong-meng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xinrong-meng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xinrong-meng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xinrong-meng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xinrong-meng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xinrong-meng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xinrong-meng/spark/merges","archive_url":"https://api.github.com/repos/xinrong-meng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xinrong-meng/spark/downloads","issues_url":"https://api.github.com/repos/xinrong-meng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xinrong-meng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xinrong-meng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xinrong-meng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xinrong-meng/spark/labels{/name}","releases_url":"https://api.github.com/repos/xinrong-meng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xinrong-meng/spark/deployments","created_at":"2021-02-03T23:47:29Z","updated_at":"2024-09-27T08:09:06Z","pushed_at":"2025-02-08T02:14:33Z","git_url":"git://github.com/xinrong-meng/spark.git","ssh_url":"git@github.com:xinrong-meng/spark.git","clone_url":"https://github.com/xinrong-meng/spark.git","svn_url":"https://github.com/xinrong-meng/spark","homepage":"https://spark.apache.org/","size":469811,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":2,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"bdf56c483574d347e5c283273c170377f20d0f10","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39860"},"html":{"href":"https://github.com/apache/spark/pull/39860"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39860"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39860/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39860/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39860/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b4ba54875438c8333534e2467cff568db8576950"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39859","id":1226100275,"node_id":"PR_kwDOAQXtWs5JFM4z","html_url":"https://github.com/apache/spark/pull/39859","diff_url":"https://github.com/apache/spark/pull/39859.diff","patch_url":"https://github.com/apache/spark/pull/39859.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39859","number":39859,"state":"closed","locked":false,"title":"[SPARK-42158][SQL][3.4] Integrate _LEGACY_ERROR_TEMP_1003 into FIELD_NOT_FOUND","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nbackport for https://github.com/apache/spark/pull/39706\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWe should want to include PRs related to error classes into Spark 3.4.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\nThe CI should pass.\r\n","created_at":"2023-02-02T07:45:20Z","updated_at":"2023-04-22T05:48:45Z","closed_at":"2023-02-03T04:53:56Z","merged_at":null,"merge_commit_sha":"704305597afd8cec03eabeffaded0963dc7642c7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39859/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39859/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39859/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ff446f20b08eb4c6c439038002ed84cca7083cde","head":{"label":"itholic:cherry-pick-1003","ref":"cherry-pick-1003","sha":"ff446f20b08eb4c6c439038002ed84cca7083cde","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:branch-3.4","ref":"branch-3.4","sha":"8dae1245e32f9e51c8178e03ab3a1c20c856a621","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39859"},"html":{"href":"https://github.com/apache/spark/pull/39859"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39859"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39859/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39859/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39859/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ff446f20b08eb4c6c439038002ed84cca7083cde"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39858","id":1226028344,"node_id":"PR_kwDOAQXtWs5JE7U4","html_url":"https://github.com/apache/spark/pull/39858","diff_url":"https://github.com/apache/spark/pull/39858.diff","patch_url":"https://github.com/apache/spark/pull/39858.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39858","number":39858,"state":"closed","locked":false,"title":"[SPARK-42288] Expose file path if reading failed","user":{"login":"yikf","id":51110188,"node_id":"MDQ6VXNlcjUxMTEwMTg4","avatar_url":"https://avatars.githubusercontent.com/u/51110188?v=4","gravatar_id":"","url":"https://api.github.com/users/yikf","html_url":"https://github.com/yikf","followers_url":"https://api.github.com/users/yikf/followers","following_url":"https://api.github.com/users/yikf/following{/other_user}","gists_url":"https://api.github.com/users/yikf/gists{/gist_id}","starred_url":"https://api.github.com/users/yikf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yikf/subscriptions","organizations_url":"https://api.github.com/users/yikf/orgs","repos_url":"https://api.github.com/users/yikf/repos","events_url":"https://api.github.com/users/yikf/events{/privacy}","received_events_url":"https://api.github.com/users/yikf/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n`MalformedInputException` may be thrown because the decompression failed when reading the file. In this case, the error message does not contain the file name. If the file name is included, it is easier to locate the problem.\r\n\r\n```log\r\norg.apache.spark.SparkException: Job aborted due to stage failure: Task 41 in stage 15641.0 failed 10 times, most recent failure: Lost task 41.9 in stage 15641.0 (TID 6287211) (hostname executor 58): io.airlift.compress.MalformedInputException: Malformed input: offset=65075\r\n\tat io.airlift.compress.snappy.SnappyRawDecompressor.uncompressAll(SnappyRawDecompressor.java:108)\r\n\tat io.airlift.compress.snappy.SnappyRawDecompressor.decompress(SnappyRawDecompressor.java:53)\r\n\tat io.airlift.compress.snappy.SnappyDecompressor.decompress(SnappyDecompressor.java:45)\r\n\tat org.apache.orc.impl.AircompressorCodec.decompress(AircompressorCodec.java:94)\r\n\tat org.apache.orc.impl.SnappyCodec.decompress(SnappyCodec.java:45)\r\n\tat org.apache.orc.impl.InStream$CompressedStream.readHeader(InStream.java:495)\r\n\tat org.apache.orc.impl.InStream$CompressedStream.ensureUncompressed(InStream.java:522)\r\n\tat org.apache.orc.impl.InStream$CompressedStream.read(InStream.java:509)\r\n\tat org.apache.orc.impl.SerializationUtils.readRemainingLongs(SerializationUtils.java:1102)\r\n\tat org.apache.orc.impl.SerializationUtils.unrolledUnPackBytes(SerializationUtils.java:1094)\r\n\tat org.apache.orc.impl.SerializationUtils.unrolledUnPack32(SerializationUtils.java:1059)\r\n\tat org.apache.orc.impl.SerializationUtils.readInts(SerializationUtils.java:925)\r\n\tat org.apache.orc.impl.RunLengthIntegerReaderV2.readDirectValues(RunLengthIntegerReaderV2.java:268)\r\n\tat org.apache.orc.impl.RunLengthIntegerReaderV2.readValues(RunLengthIntegerReaderV2.java:69)\r\n\tat org.apache.orc.impl.RunLengthIntegerReaderV2.next(RunLengthIntegerReaderV2.java:323)\r\n\tat org.apache.orc.impl.RunLengthIntegerReaderV2.nextVector(RunLengthIntegerReaderV2.java:373)\r\n\tat org.apache.orc.impl.TreeReaderFactory$LongTreeReader.nextVector(TreeReaderFactory.java:641)\r\n\tat org.apache.orc.impl.TreeReaderFactory$StructTreeReader.nextBatch(TreeReaderFactory.java:2047)\r\n\tat org.apache.orc.impl.RecordReaderImpl.nextBatch(RecordReaderImpl.java:1219)\r\n\tat org.apache.spark.sql.execution.datasources.orc.OrcColumnarBatchReader.nextBatch(OrcColumnarBatchReader.java:197)\r\n\tat org.apache.spark.sql.execution.datasources.orc.OrcColumnarBatchReader.nextKeyValue(OrcColumnarBatchReader.java:99)\r\n\tat org.apache.spark.sql.execution.datasources.RecordReaderIterator.hasNext(RecordReaderIterator.scala:39)\r\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:93)\r\n\tat org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:522)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage8.columnartorow_nextBatch_0$(Unknown Source)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage8.agg_doAggregateWithKeys_0$(Unknown Source)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage8.processNext(Unknown Source)\r\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\r\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:759)\r\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\r\n\tat org.apache.spark.shuffle.sort.UnsafeShuffleWriter.write(UnsafeShuffleWriter.java:179)\r\n\tat org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)\r\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)\r\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:510)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1491)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:513)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\n```\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nit is easier to locate the problem.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nExist tests & GA","created_at":"2023-02-02T06:37:30Z","updated_at":"2023-02-03T05:42:13Z","closed_at":"2023-02-03T05:42:13Z","merged_at":null,"merge_commit_sha":"0aa1d3bd524d50f053c43c267168a7ae5cddc7eb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39858/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39858/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39858/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/983d69ed6a363e4a1917815784244a997a5edafd","head":{"label":"yikf:file-scan-error","ref":"file-scan-error","sha":"983d69ed6a363e4a1917815784244a997a5edafd","user":{"login":"yikf","id":51110188,"node_id":"MDQ6VXNlcjUxMTEwMTg4","avatar_url":"https://avatars.githubusercontent.com/u/51110188?v=4","gravatar_id":"","url":"https://api.github.com/users/yikf","html_url":"https://github.com/yikf","followers_url":"https://api.github.com/users/yikf/followers","following_url":"https://api.github.com/users/yikf/following{/other_user}","gists_url":"https://api.github.com/users/yikf/gists{/gist_id}","starred_url":"https://api.github.com/users/yikf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yikf/subscriptions","organizations_url":"https://api.github.com/users/yikf/orgs","repos_url":"https://api.github.com/users/yikf/repos","events_url":"https://api.github.com/users/yikf/events{/privacy}","received_events_url":"https://api.github.com/users/yikf/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":536485368,"node_id":"R_kgDOH_od-A","name":"spark","full_name":"yikf/spark","private":false,"owner":{"login":"yikf","id":51110188,"node_id":"MDQ6VXNlcjUxMTEwMTg4","avatar_url":"https://avatars.githubusercontent.com/u/51110188?v=4","gravatar_id":"","url":"https://api.github.com/users/yikf","html_url":"https://github.com/yikf","followers_url":"https://api.github.com/users/yikf/followers","following_url":"https://api.github.com/users/yikf/following{/other_user}","gists_url":"https://api.github.com/users/yikf/gists{/gist_id}","starred_url":"https://api.github.com/users/yikf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yikf/subscriptions","organizations_url":"https://api.github.com/users/yikf/orgs","repos_url":"https://api.github.com/users/yikf/repos","events_url":"https://api.github.com/users/yikf/events{/privacy}","received_events_url":"https://api.github.com/users/yikf/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yikf/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/yikf/spark","forks_url":"https://api.github.com/repos/yikf/spark/forks","keys_url":"https://api.github.com/repos/yikf/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yikf/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yikf/spark/teams","hooks_url":"https://api.github.com/repos/yikf/spark/hooks","issue_events_url":"https://api.github.com/repos/yikf/spark/issues/events{/number}","events_url":"https://api.github.com/repos/yikf/spark/events","assignees_url":"https://api.github.com/repos/yikf/spark/assignees{/user}","branches_url":"https://api.github.com/repos/yikf/spark/branches{/branch}","tags_url":"https://api.github.com/repos/yikf/spark/tags","blobs_url":"https://api.github.com/repos/yikf/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yikf/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yikf/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/yikf/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yikf/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/yikf/spark/languages","stargazers_url":"https://api.github.com/repos/yikf/spark/stargazers","contributors_url":"https://api.github.com/repos/yikf/spark/contributors","subscribers_url":"https://api.github.com/repos/yikf/spark/subscribers","subscription_url":"https://api.github.com/repos/yikf/spark/subscription","commits_url":"https://api.github.com/repos/yikf/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/yikf/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/yikf/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/yikf/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/yikf/spark/contents/{+path}","compare_url":"https://api.github.com/repos/yikf/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yikf/spark/merges","archive_url":"https://api.github.com/repos/yikf/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yikf/spark/downloads","issues_url":"https://api.github.com/repos/yikf/spark/issues{/number}","pulls_url":"https://api.github.com/repos/yikf/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/yikf/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/yikf/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yikf/spark/labels{/name}","releases_url":"https://api.github.com/repos/yikf/spark/releases{/id}","deployments_url":"https://api.github.com/repos/yikf/spark/deployments","created_at":"2022-09-14T08:34:04Z","updated_at":"2025-02-09T00:58:36Z","pushed_at":"2025-02-09T00:58:30Z","git_url":"git://github.com/yikf/spark.git","ssh_url":"git@github.com:yikf/spark.git","clone_url":"https://github.com/yikf/spark.git","svn_url":"https://github.com/yikf/spark","homepage":"https://spark.apache.org/","size":439373,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"6dd88d6cb6cc4ed7b677f63449767853bc8e71cb","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39858"},"html":{"href":"https://github.com/apache/spark/pull/39858"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39858"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39858/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39858/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39858/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/983d69ed6a363e4a1917815784244a997a5edafd"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39857","id":1225971094,"node_id":"PR_kwDOAQXtWs5JEtWW","html_url":"https://github.com/apache/spark/pull/39857","diff_url":"https://github.com/apache/spark/pull/39857.diff","patch_url":"https://github.com/apache/spark/pull/39857.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39857","number":39857,"state":"closed","locked":false,"title":"[WIP][SPARK-42287][CONNECT][BUILD] Optimize the packaging strategy of connect  client module","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis pr aims to optimizes the packaging strategy of `connect-client-jvm` module. The main work includes:\r\n\r\n- Shade `perfmark-api` to `connect-client-jvm` : `perfmark-api` is used by `grpc`（such as `grpc.internal.ClientCallImpl`） and it is not the default dependency of Spark(not in spark-client jars directory), shade it can simplify user use of `connect-client-jvm`.\r\n\r\n- Make `sbt-assembly` and `maven-shade` package same jars for `connect-client-jvm`: \r\n\r\nmaven shade just include the following jars:\r\n\r\n```\r\n[INFO] --- maven-shade-plugin:3.2.4:shade (default) @ spark-connect-client-jvm_2.12 ---\r\n[INFO] Including org.apache.spark:spark-connect-common_2.12:jar:3.5.0-SNAPSHOT in the shaded jar.\r\n[INFO] Including com.google.guava:failureaccess:jar:1.0.1 in the shaded jar.\r\n[INFO] Including io.grpc:grpc-netty:jar:1.47.0 in the shaded jar.\r\n[INFO] Including io.grpc:grpc-core:jar:1.47.0 in the shaded jar.\r\n[INFO] Including io.perfmark:perfmark-api:jar:0.25.0 in the shaded jar.\r\n[INFO] Including io.grpc:grpc-protobuf:jar:1.47.0 in the shaded jar.\r\n[INFO] Including io.grpc:grpc-api:jar:1.47.0 in the shaded jar.\r\n[INFO] Including io.grpc:grpc-context:jar:1.47.0 in the shaded jar.\r\n[INFO] Including io.grpc:grpc-protobuf-lite:jar:1.47.0 in the shaded jar.\r\n[INFO] Including io.grpc:grpc-services:jar:1.47.0 in the shaded jar.\r\n[INFO] Including com.google.protobuf:protobuf-java-util:jar:3.19.2 in the shaded jar.\r\n[INFO] Including io.grpc:grpc-stub:jar:1.47.0 in the shaded jar.\r\n[INFO] Including com.google.protobuf:protobuf-java:jar:3.21.12 in the shaded jar.\r\n[INFO] Including com.google.guava:guava:jar:31.0.1-jre in the shaded jar.\r\n[INFO] Including com.google.guava:listenablefuture:jar:9999.0-empty-to-avoid-conflict-with-guava in the shaded jar.\r\n```\r\n\r\nbut `sbt-assembly` it too fat(178MB) and  pack more jars, such as `hadoop`, `roaringbitmap`, `rocksdb` and so on and they are not relocation, so this pr change the result of `assembly / assemblyExcludedJars` refer to maven's behavior.\r\n\r\n\r\n### Why are the changes needed?\r\n1. Shade `perfmark-api` to `connect-client-jvm` to simplify user use of `connect-client-jvm`\r\n2. Make `sbt-assembly` and `maven-shade` package same jars for `connect-client-jvm`\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n- Pass GitHub Actions\r\n- Manually check `sbt-assembly` and `maven-shade` result","created_at":"2023-02-02T05:42:03Z","updated_at":"2023-02-03T07:45:19Z","closed_at":"2023-02-03T07:45:19Z","merged_at":null,"merge_commit_sha":"77b96df40146fba178d71128396d4d44939482e6","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":true,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39857/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39857/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39857/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/6b0d1af368fb84a8ff5ce28e159ddd8a3c8510b2","head":{"label":"LuciferYang:sbt-connect-client-assembly","ref":"sbt-connect-client-assembly","sha":"6b0d1af368fb84a8ff5ce28e159ddd8a3c8510b2","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"ca20e40b0c5e92eebc8bb322c2c3a8d9857b9658","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39857"},"html":{"href":"https://github.com/apache/spark/pull/39857"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39857"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39857/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39857/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39857/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/6b0d1af368fb84a8ff5ce28e159ddd8a3c8510b2"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39856","id":1225561641,"node_id":"PR_kwDOAQXtWs5JDJYp","html_url":"https://github.com/apache/spark/pull/39856","diff_url":"https://github.com/apache/spark/pull/39856.diff","patch_url":"https://github.com/apache/spark/pull/39856.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39856","number":39856,"state":"closed","locked":false,"title":"[SPARK-42285][SQL] Introduce conf spark.sql.parquet.inferTimestampNTZ.enabled for TimestampNTZ inference on Parquet","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nIntroduces conf `spark.sql.parquet.inferTimestampNTZ.enabled` for TimestampNTZ inference on Parquet. When enabled, Parquet timestamp columns with annotation isAdjustedToUTC = false are inferred as TIMESTAMP_NTZ type during schema inference. Otherwise, all the Parquet timestamp columns are inferred as TIMESTAMP_LTZ types. Note that Spark writes the output schema into Parquet's footer metadata on file writing and leverages it on file reading. Thus this configuration only affects the schema inference on Parquet files which are not written by Spark.\r\n\r\nThis PR also removes the configuration `spark.sql.parquet.timestampNTZ.enabled`. The configuration is \"heavy\". When false, Spark can't write TimestampNTZ columns to Parquet files.\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nThe only compatibility issue for supporting TimestampNTZ on the Parquet data source is about schema inference on the files which are not written by Spark. Thus we can simply have a flag about it.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo, TimestampNTZ is not released yet.\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nUT","created_at":"2023-02-01T21:54:41Z","updated_at":"2023-02-02T05:54:19Z","closed_at":"2023-02-02T05:53:19Z","merged_at":null,"merge_commit_sha":"1122d2cdc6e87884338449cefe64bbdc3cee55c3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39856/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39856/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39856/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9064e3df2be7b2f1710e07c065b780eafa1d8d45","head":{"label":"gengliangwang:inferParuqetTimestampNTZ","ref":"inferParuqetTimestampNTZ","sha":"9064e3df2be7b2f1710e07c065b780eafa1d8d45","user":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":95047635,"node_id":"MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==","name":"spark","full_name":"gengliangwang/spark","private":false,"owner":{"login":"gengliangwang","id":1097932,"node_id":"MDQ6VXNlcjEwOTc5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1097932?v=4","gravatar_id":"","url":"https://api.github.com/users/gengliangwang","html_url":"https://github.com/gengliangwang","followers_url":"https://api.github.com/users/gengliangwang/followers","following_url":"https://api.github.com/users/gengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/gengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/gengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gengliangwang/subscriptions","organizations_url":"https://api.github.com/users/gengliangwang/orgs","repos_url":"https://api.github.com/users/gengliangwang/repos","events_url":"https://api.github.com/users/gengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/gengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/gengliangwang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/gengliangwang/spark","forks_url":"https://api.github.com/repos/gengliangwang/spark/forks","keys_url":"https://api.github.com/repos/gengliangwang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/gengliangwang/spark/teams","hooks_url":"https://api.github.com/repos/gengliangwang/spark/hooks","issue_events_url":"https://api.github.com/repos/gengliangwang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/gengliangwang/spark/events","assignees_url":"https://api.github.com/repos/gengliangwang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/gengliangwang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/gengliangwang/spark/tags","blobs_url":"https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/gengliangwang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/gengliangwang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/gengliangwang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/gengliangwang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/gengliangwang/spark/languages","stargazers_url":"https://api.github.com/repos/gengliangwang/spark/stargazers","contributors_url":"https://api.github.com/repos/gengliangwang/spark/contributors","subscribers_url":"https://api.github.com/repos/gengliangwang/spark/subscribers","subscription_url":"https://api.github.com/repos/gengliangwang/spark/subscription","commits_url":"https://api.github.com/repos/gengliangwang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/gengliangwang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/gengliangwang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/gengliangwang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/gengliangwang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/gengliangwang/spark/merges","archive_url":"https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/gengliangwang/spark/downloads","issues_url":"https://api.github.com/repos/gengliangwang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/gengliangwang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/gengliangwang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/gengliangwang/spark/labels{/name}","releases_url":"https://api.github.com/repos/gengliangwang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/gengliangwang/spark/deployments","created_at":"2017-06-21T21:26:20Z","updated_at":"2022-01-05T09:39:12Z","pushed_at":"2025-02-07T19:52:00Z","git_url":"git://github.com/gengliangwang/spark.git","ssh_url":"git@github.com:gengliangwang/spark.git","clone_url":"https://github.com/gengliangwang/spark.git","svn_url":"https://github.com/gengliangwang/spark","homepage":null,"size":481326,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fb9d706784557ef0fe9e17d59b7096374658954e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39856"},"html":{"href":"https://github.com/apache/spark/pull/39856"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39856"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39856/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39856/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39856/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9064e3df2be7b2f1710e07c065b780eafa1d8d45"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39855","id":1225431895,"node_id":"PR_kwDOAQXtWs5JCptX","html_url":"https://github.com/apache/spark/pull/39855","diff_url":"https://github.com/apache/spark/pull/39855.diff","patch_url":"https://github.com/apache/spark/pull/39855.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39855","number":39855,"state":"closed","locked":false,"title":"[SPARK-42286][SQL] Fallback to previous codegen code path for complex expr with CAST","user":{"login":"RunyaoChen","id":114445704,"node_id":"U_kgDOBtJNiA","avatar_url":"https://avatars.githubusercontent.com/u/114445704?v=4","gravatar_id":"","url":"https://api.github.com/users/RunyaoChen","html_url":"https://github.com/RunyaoChen","followers_url":"https://api.github.com/users/RunyaoChen/followers","following_url":"https://api.github.com/users/RunyaoChen/following{/other_user}","gists_url":"https://api.github.com/users/RunyaoChen/gists{/gist_id}","starred_url":"https://api.github.com/users/RunyaoChen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RunyaoChen/subscriptions","organizations_url":"https://api.github.com/users/RunyaoChen/orgs","repos_url":"https://api.github.com/users/RunyaoChen/repos","events_url":"https://api.github.com/users/RunyaoChen/events{/privacy}","received_events_url":"https://api.github.com/users/RunyaoChen/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR fixes the internal error `Child is not Cast or ExpressionProxy of Cast` for valid `CaseWhen` expr with `Cast` expr in its branches.\r\n\r\nSpecifically, after SPARK-39865, an improved error msg for overflow exception during table insert was introduced. The improvement covers `Cast` expr and `ExpressionProxy` expr, but `CaseWhen` and other complex ones are not covered. An example below hits an internal error today.\r\n```\r\ncreate table t1 as select x FROM values (1), (2), (3) as tab(x);\r\ncreate table t2 (x Decimal(9, 0));\r\ninsert into t2 select 0 - (case when x = 1 then 1 else x end) from t1 where x = 1;\r\n```\r\nTo fix the query failure, we decide to fall back to the previous handling if the expr is not a simple `Cast` expr or `ExpressionProxy` expr.\r\n\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n\r\nTo fix the query regression introduced in SPARK-39865.\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo. We just fall back to the previous error msg if the expression involving `Cast` is not a simple one.\r\n\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\n- Added Unit test.\r\n- Removed one test case for the `Child is not Cast or ExpressionProxy of Cast` internal error, as now we do not check if the child has a `Cast` expression and fall back to the previous error message.\r\n\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n","created_at":"2023-02-01T20:05:44Z","updated_at":"2023-02-23T06:40:03Z","closed_at":"2023-02-03T05:06:26Z","merged_at":null,"merge_commit_sha":"781397a8df5348cbff57885c2cf2402708fdaa7f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39855/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39855/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39855/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/0e5f71b8d3b019aaad7a3526199916c94121d90a","head":{"label":"RunyaoChen:fallback_cast_codegen","ref":"fallback_cast_codegen","sha":"0e5f71b8d3b019aaad7a3526199916c94121d90a","user":{"login":"RunyaoChen","id":114445704,"node_id":"U_kgDOBtJNiA","avatar_url":"https://avatars.githubusercontent.com/u/114445704?v=4","gravatar_id":"","url":"https://api.github.com/users/RunyaoChen","html_url":"https://github.com/RunyaoChen","followers_url":"https://api.github.com/users/RunyaoChen/followers","following_url":"https://api.github.com/users/RunyaoChen/following{/other_user}","gists_url":"https://api.github.com/users/RunyaoChen/gists{/gist_id}","starred_url":"https://api.github.com/users/RunyaoChen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RunyaoChen/subscriptions","organizations_url":"https://api.github.com/users/RunyaoChen/orgs","repos_url":"https://api.github.com/users/RunyaoChen/repos","events_url":"https://api.github.com/users/RunyaoChen/events{/privacy}","received_events_url":"https://api.github.com/users/RunyaoChen/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":591534378,"node_id":"R_kgDOI0IZKg","name":"spark","full_name":"RunyaoChen/spark","private":false,"owner":{"login":"RunyaoChen","id":114445704,"node_id":"U_kgDOBtJNiA","avatar_url":"https://avatars.githubusercontent.com/u/114445704?v=4","gravatar_id":"","url":"https://api.github.com/users/RunyaoChen","html_url":"https://github.com/RunyaoChen","followers_url":"https://api.github.com/users/RunyaoChen/followers","following_url":"https://api.github.com/users/RunyaoChen/following{/other_user}","gists_url":"https://api.github.com/users/RunyaoChen/gists{/gist_id}","starred_url":"https://api.github.com/users/RunyaoChen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RunyaoChen/subscriptions","organizations_url":"https://api.github.com/users/RunyaoChen/orgs","repos_url":"https://api.github.com/users/RunyaoChen/repos","events_url":"https://api.github.com/users/RunyaoChen/events{/privacy}","received_events_url":"https://api.github.com/users/RunyaoChen/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/RunyaoChen/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/RunyaoChen/spark","forks_url":"https://api.github.com/repos/RunyaoChen/spark/forks","keys_url":"https://api.github.com/repos/RunyaoChen/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/RunyaoChen/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/RunyaoChen/spark/teams","hooks_url":"https://api.github.com/repos/RunyaoChen/spark/hooks","issue_events_url":"https://api.github.com/repos/RunyaoChen/spark/issues/events{/number}","events_url":"https://api.github.com/repos/RunyaoChen/spark/events","assignees_url":"https://api.github.com/repos/RunyaoChen/spark/assignees{/user}","branches_url":"https://api.github.com/repos/RunyaoChen/spark/branches{/branch}","tags_url":"https://api.github.com/repos/RunyaoChen/spark/tags","blobs_url":"https://api.github.com/repos/RunyaoChen/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/RunyaoChen/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/RunyaoChen/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/RunyaoChen/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/RunyaoChen/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/RunyaoChen/spark/languages","stargazers_url":"https://api.github.com/repos/RunyaoChen/spark/stargazers","contributors_url":"https://api.github.com/repos/RunyaoChen/spark/contributors","subscribers_url":"https://api.github.com/repos/RunyaoChen/spark/subscribers","subscription_url":"https://api.github.com/repos/RunyaoChen/spark/subscription","commits_url":"https://api.github.com/repos/RunyaoChen/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/RunyaoChen/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/RunyaoChen/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/RunyaoChen/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/RunyaoChen/spark/contents/{+path}","compare_url":"https://api.github.com/repos/RunyaoChen/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/RunyaoChen/spark/merges","archive_url":"https://api.github.com/repos/RunyaoChen/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/RunyaoChen/spark/downloads","issues_url":"https://api.github.com/repos/RunyaoChen/spark/issues{/number}","pulls_url":"https://api.github.com/repos/RunyaoChen/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/RunyaoChen/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/RunyaoChen/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/RunyaoChen/spark/labels{/name}","releases_url":"https://api.github.com/repos/RunyaoChen/spark/releases{/id}","deployments_url":"https://api.github.com/repos/RunyaoChen/spark/deployments","created_at":"2023-01-21T02:10:59Z","updated_at":"2023-01-23T19:04:30Z","pushed_at":"2023-07-24T18:32:28Z","git_url":"git://github.com/RunyaoChen/spark.git","ssh_url":"git@github.com:RunyaoChen/spark.git","clone_url":"https://github.com/RunyaoChen/spark.git","svn_url":"https://github.com/RunyaoChen/spark","homepage":"https://spark.apache.org/","size":373190,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fb9d706784557ef0fe9e17d59b7096374658954e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39855"},"html":{"href":"https://github.com/apache/spark/pull/39855"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39855"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39855/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39855/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39855/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/0e5f71b8d3b019aaad7a3526199916c94121d90a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39854","id":1225179865,"node_id":"PR_kwDOAQXtWs5JBsLZ","html_url":"https://github.com/apache/spark/pull/39854","diff_url":"https://github.com/apache/spark/pull/39854.diff","patch_url":"https://github.com/apache/spark/pull/39854.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39854","number":39854,"state":"closed","locked":false,"title":"[SPARK-42284][CONNECT] Make sure connect server assembly is built before running client tests - SBT","user":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR makes sure SBT assembles the connect server assembly jar before we run client tests.\r\n\r\n### Why are the changes needed?\r\nIt makes it easier to develop and test the JVM client for Spark Connect.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nManually tested.","created_at":"2023-02-01T16:51:03Z","updated_at":"2023-02-02T01:08:35Z","closed_at":"2023-02-02T01:08:35Z","merged_at":null,"merge_commit_sha":"db99ba7cccf70cbc249fa3f82dedb54d65e985f4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39854/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39854/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39854/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/741db8ea1b3b0ce4d9ea06f312086f607736a279","head":{"label":"hvanhovell:SPARK-42284","ref":"SPARK-42284","sha":"741db8ea1b3b0ce4d9ea06f312086f607736a279","user":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":35900688,"node_id":"MDEwOlJlcG9zaXRvcnkzNTkwMDY4OA==","name":"spark","full_name":"hvanhovell/spark","private":false,"owner":{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/hvanhovell/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/hvanhovell/spark","forks_url":"https://api.github.com/repos/hvanhovell/spark/forks","keys_url":"https://api.github.com/repos/hvanhovell/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/hvanhovell/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/hvanhovell/spark/teams","hooks_url":"https://api.github.com/repos/hvanhovell/spark/hooks","issue_events_url":"https://api.github.com/repos/hvanhovell/spark/issues/events{/number}","events_url":"https://api.github.com/repos/hvanhovell/spark/events","assignees_url":"https://api.github.com/repos/hvanhovell/spark/assignees{/user}","branches_url":"https://api.github.com/repos/hvanhovell/spark/branches{/branch}","tags_url":"https://api.github.com/repos/hvanhovell/spark/tags","blobs_url":"https://api.github.com/repos/hvanhovell/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/hvanhovell/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/hvanhovell/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/hvanhovell/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/hvanhovell/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/hvanhovell/spark/languages","stargazers_url":"https://api.github.com/repos/hvanhovell/spark/stargazers","contributors_url":"https://api.github.com/repos/hvanhovell/spark/contributors","subscribers_url":"https://api.github.com/repos/hvanhovell/spark/subscribers","subscription_url":"https://api.github.com/repos/hvanhovell/spark/subscription","commits_url":"https://api.github.com/repos/hvanhovell/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/hvanhovell/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/hvanhovell/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/hvanhovell/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/hvanhovell/spark/contents/{+path}","compare_url":"https://api.github.com/repos/hvanhovell/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/hvanhovell/spark/merges","archive_url":"https://api.github.com/repos/hvanhovell/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/hvanhovell/spark/downloads","issues_url":"https://api.github.com/repos/hvanhovell/spark/issues{/number}","pulls_url":"https://api.github.com/repos/hvanhovell/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/hvanhovell/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/hvanhovell/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/hvanhovell/spark/labels{/name}","releases_url":"https://api.github.com/repos/hvanhovell/spark/releases{/id}","deployments_url":"https://api.github.com/repos/hvanhovell/spark/deployments","created_at":"2015-05-19T18:29:31Z","updated_at":"2024-11-14T19:45:14Z","pushed_at":"2025-02-06T16:48:48Z","git_url":"git://github.com/hvanhovell/spark.git","ssh_url":"git@github.com:hvanhovell/spark.git","clone_url":"https://github.com/hvanhovell/spark.git","svn_url":"https://github.com/hvanhovell/spark","homepage":null,"size":447542,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"40ca27cd6e561a746c3a8f5653ccd525ddaada96","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39854"},"html":{"href":"https://github.com/apache/spark/pull/39854"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39854"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39854/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39854/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39854/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/741db8ea1b3b0ce4d9ea06f312086f607736a279"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39853","id":1224938734,"node_id":"PR_kwDOAQXtWs5JAxTu","html_url":"https://github.com/apache/spark/pull/39853","diff_url":"https://github.com/apache/spark/pull/39853.diff","patch_url":"https://github.com/apache/spark/pull/39853.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39853","number":39853,"state":"closed","locked":false,"title":"WIP watermark propagate simulator","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'core/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n","created_at":"2023-02-01T14:06:18Z","updated_at":"2023-02-02T02:29:20Z","closed_at":"2023-02-02T02:29:20Z","merged_at":null,"merge_commit_sha":"a66da38cc0eba79250f15a0c621c0a3a25581eb9","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":true,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39853/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39853/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39853/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b8116c3687f9a8577e01acad71c098c3c69a4d2b","head":{"label":"HeartSaVioR:WIP-watermark-propagate-simulator","ref":"WIP-watermark-propagate-simulator","sha":"b8116c3687f9a8577e01acad71c098c3c69a4d2b","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":27994296,"node_id":"MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==","name":"spark","full_name":"HeartSaVioR/spark","private":false,"owner":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HeartSaVioR/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HeartSaVioR/spark","forks_url":"https://api.github.com/repos/HeartSaVioR/spark/forks","keys_url":"https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HeartSaVioR/spark/teams","hooks_url":"https://api.github.com/repos/HeartSaVioR/spark/hooks","issue_events_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HeartSaVioR/spark/events","assignees_url":"https://api.github.com/repos/HeartSaVioR/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HeartSaVioR/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HeartSaVioR/spark/tags","blobs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HeartSaVioR/spark/languages","stargazers_url":"https://api.github.com/repos/HeartSaVioR/spark/stargazers","contributors_url":"https://api.github.com/repos/HeartSaVioR/spark/contributors","subscribers_url":"https://api.github.com/repos/HeartSaVioR/spark/subscribers","subscription_url":"https://api.github.com/repos/HeartSaVioR/spark/subscription","commits_url":"https://api.github.com/repos/HeartSaVioR/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HeartSaVioR/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HeartSaVioR/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HeartSaVioR/spark/merges","archive_url":"https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HeartSaVioR/spark/downloads","issues_url":"https://api.github.com/repos/HeartSaVioR/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HeartSaVioR/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HeartSaVioR/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HeartSaVioR/spark/labels{/name}","releases_url":"https://api.github.com/repos/HeartSaVioR/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HeartSaVioR/spark/deployments","created_at":"2014-12-14T12:56:04Z","updated_at":"2024-10-21T04:36:36Z","pushed_at":"2025-01-08T06:13:27Z","git_url":"git://github.com/HeartSaVioR/spark.git","ssh_url":"git@github.com:HeartSaVioR/spark.git","clone_url":"https://github.com/HeartSaVioR/spark.git","svn_url":"https://github.com/HeartSaVioR/spark","homepage":null,"size":456164,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":1,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"20eb54661e5bf6e2e350b8311007a63f7beabc7a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39853"},"html":{"href":"https://github.com/apache/spark/pull/39853"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39853"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39853/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39853/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39853/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b8116c3687f9a8577e01acad71c098c3c69a4d2b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/39852","id":1224923310,"node_id":"PR_kwDOAQXtWs5JAtiu","html_url":"https://github.com/apache/spark/pull/39852","diff_url":"https://github.com/apache/spark/pull/39852.diff","patch_url":"https://github.com/apache/spark/pull/39852.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/39852","number":39852,"state":"closed","locked":false,"title":"[SPARK-42281][PYTHON][DOCS] Update Debugging PySpark documents to show error message properly","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to update examples in [Debugging PySpark](https://spark.apache.org/docs/latest/api/python/development/debugging.html#debugging-pyspark).\r\n\r\n### Why are the changes needed?\r\n\r\nBecause the examples described in [Debugging PySpark](https://spark.apache.org/docs/latest/api/python/development/debugging.html#debugging-pyspark) don't match with current PySpark error framework.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nDocument update\r\n\r\n### How was this patch tested?\r\n\r\nmanually test by building the document in local.","created_at":"2023-02-01T13:57:21Z","updated_at":"2023-04-22T05:48:53Z","closed_at":"2023-02-02T09:05:36Z","merged_at":null,"merge_commit_sha":"fec2744bf129895a9ad5a5cc58732c24ea4c2749","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/39852/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/39852/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/39852/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c4a22fe1a9dc238c9fa2b006a01d9e685e0a9f9a","head":{"label":"itholic:fix_develop_doc","ref":"fix_develop_doc","sha":"c4a22fe1a9dc238c9fa2b006a01d9e685e0a9f9a","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"20eb54661e5bf6e2e350b8311007a63f7beabc7a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/39852"},"html":{"href":"https://github.com/apache/spark/pull/39852"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/39852"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/39852/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/39852/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/39852/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c4a22fe1a9dc238c9fa2b006a01d9e685e0a9f9a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null}]