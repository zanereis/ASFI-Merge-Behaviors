[{"url":"https://api.github.com/repos/apache/spark/pulls/49358","id":2260885021,"node_id":"PR_kwDOAQXtWs6Gwl4d","html_url":"https://github.com/apache/spark/pull/49358","diff_url":"https://github.com/apache/spark/pull/49358.diff","patch_url":"https://github.com/apache/spark/pull/49358.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49358","number":49358,"state":"closed","locked":false,"title":"[SPARK-50728][BUILD] Update ORC to 2.1.0","user":{"login":"williamhyun","id":62487364,"node_id":"MDQ6VXNlcjYyNDg3MzY0","avatar_url":"https://avatars.githubusercontent.com/u/62487364?v=4","gravatar_id":"","url":"https://api.github.com/users/williamhyun","html_url":"https://github.com/williamhyun","followers_url":"https://api.github.com/users/williamhyun/followers","following_url":"https://api.github.com/users/williamhyun/following{/other_user}","gists_url":"https://api.github.com/users/williamhyun/gists{/gist_id}","starred_url":"https://api.github.com/users/williamhyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/williamhyun/subscriptions","organizations_url":"https://api.github.com/users/williamhyun/orgs","repos_url":"https://api.github.com/users/williamhyun/repos","events_url":"https://api.github.com/users/williamhyun/events{/privacy}","received_events_url":"https://api.github.com/users/williamhyun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR aims to upgrade ORC to 2.1.0.\r\n\r\n### Why are the changes needed?\r\nTo use the most recent version. \r\n- https://github.com/apache/orc/releases/tag/v2.1.0\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n\r\n### How was this patch tested?\r\nPass the CIs.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.\r\n","created_at":"2025-01-05T20:58:15Z","updated_at":"2025-01-10T16:30:55Z","closed_at":"2025-01-10T16:30:31Z","merged_at":null,"merge_commit_sha":"7252a4976164511d1acadcc5ee24a85adaa2ed96","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49358/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49358/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49358/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/66a901d5c7195b3511ea75fb9c9ecfab66fcb3e5","head":{"label":"williamhyun:SPARK-50728","ref":"SPARK-50728","sha":"66a901d5c7195b3511ea75fb9c9ecfab66fcb3e5","user":{"login":"williamhyun","id":62487364,"node_id":"MDQ6VXNlcjYyNDg3MzY0","avatar_url":"https://avatars.githubusercontent.com/u/62487364?v=4","gravatar_id":"","url":"https://api.github.com/users/williamhyun","html_url":"https://github.com/williamhyun","followers_url":"https://api.github.com/users/williamhyun/followers","following_url":"https://api.github.com/users/williamhyun/following{/other_user}","gists_url":"https://api.github.com/users/williamhyun/gists{/gist_id}","starred_url":"https://api.github.com/users/williamhyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/williamhyun/subscriptions","organizations_url":"https://api.github.com/users/williamhyun/orgs","repos_url":"https://api.github.com/users/williamhyun/repos","events_url":"https://api.github.com/users/williamhyun/events{/privacy}","received_events_url":"https://api.github.com/users/williamhyun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":589763392,"node_id":"R_kgDOIycTQA","name":"spark","full_name":"williamhyun/spark","private":false,"owner":{"login":"williamhyun","id":62487364,"node_id":"MDQ6VXNlcjYyNDg3MzY0","avatar_url":"https://avatars.githubusercontent.com/u/62487364?v=4","gravatar_id":"","url":"https://api.github.com/users/williamhyun","html_url":"https://github.com/williamhyun","followers_url":"https://api.github.com/users/williamhyun/followers","following_url":"https://api.github.com/users/williamhyun/following{/other_user}","gists_url":"https://api.github.com/users/williamhyun/gists{/gist_id}","starred_url":"https://api.github.com/users/williamhyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/williamhyun/subscriptions","organizations_url":"https://api.github.com/users/williamhyun/orgs","repos_url":"https://api.github.com/users/williamhyun/repos","events_url":"https://api.github.com/users/williamhyun/events{/privacy}","received_events_url":"https://api.github.com/users/williamhyun/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/williamhyun/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/williamhyun/spark","forks_url":"https://api.github.com/repos/williamhyun/spark/forks","keys_url":"https://api.github.com/repos/williamhyun/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/williamhyun/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/williamhyun/spark/teams","hooks_url":"https://api.github.com/repos/williamhyun/spark/hooks","issue_events_url":"https://api.github.com/repos/williamhyun/spark/issues/events{/number}","events_url":"https://api.github.com/repos/williamhyun/spark/events","assignees_url":"https://api.github.com/repos/williamhyun/spark/assignees{/user}","branches_url":"https://api.github.com/repos/williamhyun/spark/branches{/branch}","tags_url":"https://api.github.com/repos/williamhyun/spark/tags","blobs_url":"https://api.github.com/repos/williamhyun/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/williamhyun/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/williamhyun/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/williamhyun/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/williamhyun/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/williamhyun/spark/languages","stargazers_url":"https://api.github.com/repos/williamhyun/spark/stargazers","contributors_url":"https://api.github.com/repos/williamhyun/spark/contributors","subscribers_url":"https://api.github.com/repos/williamhyun/spark/subscribers","subscription_url":"https://api.github.com/repos/williamhyun/spark/subscription","commits_url":"https://api.github.com/repos/williamhyun/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/williamhyun/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/williamhyun/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/williamhyun/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/williamhyun/spark/contents/{+path}","compare_url":"https://api.github.com/repos/williamhyun/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/williamhyun/spark/merges","archive_url":"https://api.github.com/repos/williamhyun/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/williamhyun/spark/downloads","issues_url":"https://api.github.com/repos/williamhyun/spark/issues{/number}","pulls_url":"https://api.github.com/repos/williamhyun/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/williamhyun/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/williamhyun/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/williamhyun/spark/labels{/name}","releases_url":"https://api.github.com/repos/williamhyun/spark/releases{/id}","deployments_url":"https://api.github.com/repos/williamhyun/spark/deployments","created_at":"2023-01-16T21:57:59Z","updated_at":"2025-01-08T03:02:33Z","pushed_at":"2025-01-10T08:04:36Z","git_url":"git://github.com/williamhyun/spark.git","ssh_url":"git@github.com:williamhyun/spark.git","clone_url":"https://github.com/williamhyun/spark.git","svn_url":"https://github.com/williamhyun/spark","homepage":"https://spark.apache.org/","size":474108,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"91f3fdd25852b43095dd5273358fc394ffd11b66","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49358"},"html":{"href":"https://github.com/apache/spark/pull/49358"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49358"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49358/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49358/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49358/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/66a901d5c7195b3511ea75fb9c9ecfab66fcb3e5"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49357","id":2260871302,"node_id":"PR_kwDOAQXtWs6GwiiG","html_url":"https://github.com/apache/spark/pull/49357","diff_url":"https://github.com/apache/spark/pull/49357.diff","patch_url":"https://github.com/apache/spark/pull/49357.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49357","number":49357,"state":"closed","locked":false,"title":"[SPARK-50716][CORE][FOLLOWUP] Fix the scenario in `JavaUtils#deleteRecursivelyUsingJavaIO` where `BasicFileAttributes` cannot be read.","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR adds protection against IOException (IOE) scenarios when reading the `BasicFileAttributes` of a file in the `deleteRecursivelyUsingJavaIO` method: it catches the IOE and returns null, and silently handles the scenario where `fileAttributes` is null in the subsequent logic.\r\n\r\n\r\n### Why are the changes needed?\r\nWhen the inode itself does not exist, it is impossible to read its `BasicFileAttributes`, and an IOException (IOE) will be thrown, which caused the failure of the MacOS daily test:\r\n- https://github.com/apache/spark/actions/runs/12622568770/job/35170636435\r\n\r\n```\r\n- JobArtifactSet uses resources from SparkContext *** FAILED ***\r\n  java.nio.file.NoSuchFileException: /Users/runner/work/spark/spark/core/target/tmp/spark-6a6b2d5d-1371-4801-a6c4-59dc9d69c2f2/userFiles-e450317a-136c-49ff-8099-9e8282c766b5/testFile661537940680128228.zip\r\n  at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)\r\n  at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)\r\n  at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)\r\n  at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:55)\r\n  at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171)\r\n  at java.base/java.nio.file.Files.readAttributes(Files.java:1853)\r\n  at org.apache.spark.network.util.JavaUtils.deleteRecursivelyUsingJavaIO(JavaUtils.java:130)\r\n  at org.apache.spark.network.util.JavaUtils.deleteRecursively(JavaUtils.java:123)\r\n  at org.apache.spark.network.util.JavaUtils.deleteRecursively(JavaUtils.java:94)\r\n  at org.apache.spark.util.SparkFileUtils.deleteRecursively(SparkFileUtils.scala:121)\r\n  ...\r\n```\r\n\r\nhttps://github.com/apache/spark/pull/49347 aimed to fix the cleanup of symbolic links by moving the operation to read `BasicFileAttributes` before `!file.exists` to add a check for broken symbolic links. However, in Spark, there is a logic that first cleans up the potentially existing destination path before overwriting it. The target path being cleaned up may itself be a non-existent inode, such as:\r\n\r\nhttps://github.com/apache/spark/blob/91f3fdd25852b43095dd5273358fc394ffd11b66/core/src/main/scala/org/apache/spark/SparkContext.scala#L1879-L1888\r\n\r\nTherefore, additional protection is needed for this scenario to maintain compatibility with the old behavior.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n- Pass Github Actions\r\n- Pass MacOs 15 & Java 21 Github Actions: https://github.com/LuciferYang/spark/runs/35170478542\r\n- Pass Macos PySpark Github Actions: https://github.com/LuciferYang/spark/runs/35178442154\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2025-01-05T20:05:36Z","updated_at":"2025-01-07T16:36:39Z","closed_at":"2025-01-06T16:48:01Z","merged_at":null,"merge_commit_sha":"6fe38ee32f5498ec4e5873134ec2c84c15462195","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49357/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49357/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49357/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b6791cddb42943c4133d0a3cc8df72d6d91ee577","head":{"label":"LuciferYang:SPARK-50716-FOLLOWUP","ref":"SPARK-50716-FOLLOWUP","sha":"b6791cddb42943c4133d0a3cc8df72d6d91ee577","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"91f3fdd25852b43095dd5273358fc394ffd11b66","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49357"},"html":{"href":"https://github.com/apache/spark/pull/49357"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49357"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49357/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49357/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49357/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b6791cddb42943c4133d0a3cc8df72d6d91ee577"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49356","id":2260761212,"node_id":"PR_kwDOAQXtWs6GwHp8","html_url":"https://github.com/apache/spark/pull/49356","diff_url":"https://github.com/apache/spark/pull/49356.diff","patch_url":"https://github.com/apache/spark/pull/49356.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49356","number":49356,"state":"closed","locked":false,"title":"[SPARK-50578][PYTHON][SS][FOLLOWUP] Remove unnecessary if block","user":{"login":"tedyu","id":235188,"node_id":"MDQ6VXNlcjIzNTE4OA==","avatar_url":"https://avatars.githubusercontent.com/u/235188?v=4","gravatar_id":"","url":"https://api.github.com/users/tedyu","html_url":"https://github.com/tedyu","followers_url":"https://api.github.com/users/tedyu/followers","following_url":"https://api.github.com/users/tedyu/following{/other_user}","gists_url":"https://api.github.com/users/tedyu/gists{/gist_id}","starred_url":"https://api.github.com/users/tedyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tedyu/subscriptions","organizations_url":"https://api.github.com/users/tedyu/orgs","repos_url":"https://api.github.com/users/tedyu/repos","events_url":"https://api.github.com/users/tedyu/events{/privacy}","received_events_url":"https://api.github.com/users/tedyu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR removes the `if` block at the beginning of the while loop since `InterruptedException` is handled in the try / catch block.\r\n\r\n### Why are the changes needed?\r\nThis change makes the code easier to follow.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nExisting Java 21 daily tests\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.","created_at":"2025-01-05T14:10:53Z","updated_at":"2025-01-05T16:23:33Z","closed_at":"2025-01-05T16:08:16Z","merged_at":null,"merge_commit_sha":"ce66106f72b538dbf5fc5a04c6eee84aeb3331c7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49356/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49356/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49356/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1f5591144517224ab540c2a50cf3ee4c164e9aa3","head":{"label":"tedyu:tws-if","ref":"tws-if","sha":"1f5591144517224ab540c2a50cf3ee4c164e9aa3","user":{"login":"tedyu","id":235188,"node_id":"MDQ6VXNlcjIzNTE4OA==","avatar_url":"https://avatars.githubusercontent.com/u/235188?v=4","gravatar_id":"","url":"https://api.github.com/users/tedyu","html_url":"https://github.com/tedyu","followers_url":"https://api.github.com/users/tedyu/followers","following_url":"https://api.github.com/users/tedyu/following{/other_user}","gists_url":"https://api.github.com/users/tedyu/gists{/gist_id}","starred_url":"https://api.github.com/users/tedyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tedyu/subscriptions","organizations_url":"https://api.github.com/users/tedyu/orgs","repos_url":"https://api.github.com/users/tedyu/repos","events_url":"https://api.github.com/users/tedyu/events{/privacy}","received_events_url":"https://api.github.com/users/tedyu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":325822007,"node_id":"MDEwOlJlcG9zaXRvcnkzMjU4MjIwMDc=","name":"spark","full_name":"tedyu/spark","private":false,"owner":{"login":"tedyu","id":235188,"node_id":"MDQ6VXNlcjIzNTE4OA==","avatar_url":"https://avatars.githubusercontent.com/u/235188?v=4","gravatar_id":"","url":"https://api.github.com/users/tedyu","html_url":"https://github.com/tedyu","followers_url":"https://api.github.com/users/tedyu/followers","following_url":"https://api.github.com/users/tedyu/following{/other_user}","gists_url":"https://api.github.com/users/tedyu/gists{/gist_id}","starred_url":"https://api.github.com/users/tedyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tedyu/subscriptions","organizations_url":"https://api.github.com/users/tedyu/orgs","repos_url":"https://api.github.com/users/tedyu/repos","events_url":"https://api.github.com/users/tedyu/events{/privacy}","received_events_url":"https://api.github.com/users/tedyu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/tedyu/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/tedyu/spark","forks_url":"https://api.github.com/repos/tedyu/spark/forks","keys_url":"https://api.github.com/repos/tedyu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/tedyu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/tedyu/spark/teams","hooks_url":"https://api.github.com/repos/tedyu/spark/hooks","issue_events_url":"https://api.github.com/repos/tedyu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/tedyu/spark/events","assignees_url":"https://api.github.com/repos/tedyu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/tedyu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/tedyu/spark/tags","blobs_url":"https://api.github.com/repos/tedyu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/tedyu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/tedyu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/tedyu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/tedyu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/tedyu/spark/languages","stargazers_url":"https://api.github.com/repos/tedyu/spark/stargazers","contributors_url":"https://api.github.com/repos/tedyu/spark/contributors","subscribers_url":"https://api.github.com/repos/tedyu/spark/subscribers","subscription_url":"https://api.github.com/repos/tedyu/spark/subscription","commits_url":"https://api.github.com/repos/tedyu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/tedyu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/tedyu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/tedyu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/tedyu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/tedyu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/tedyu/spark/merges","archive_url":"https://api.github.com/repos/tedyu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/tedyu/spark/downloads","issues_url":"https://api.github.com/repos/tedyu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/tedyu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/tedyu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/tedyu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/tedyu/spark/labels{/name}","releases_url":"https://api.github.com/repos/tedyu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/tedyu/spark/deployments","created_at":"2020-12-31T15:02:53Z","updated_at":"2024-08-20T17:49:00Z","pushed_at":"2025-01-05T16:23:32Z","git_url":"git://github.com/tedyu/spark.git","ssh_url":"git@github.com:tedyu/spark.git","clone_url":"https://github.com/tedyu/spark.git","svn_url":"https://github.com/tedyu/spark","homepage":"https://spark.apache.org/","size":455362,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"0d0fa86a03119608159078b0f6474db96485a80f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49356"},"html":{"href":"https://github.com/apache/spark/pull/49356"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49356"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49356/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49356/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49356/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1f5591144517224ab540c2a50cf3ee4c164e9aa3"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49355","id":2260192769,"node_id":"PR_kwDOAQXtWs6Gt84B","html_url":"https://github.com/apache/spark/pull/49355","diff_url":"https://github.com/apache/spark/pull/49355.diff","patch_url":"https://github.com/apache/spark/pull/49355.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49355","number":49355,"state":"closed","locked":false,"title":"[SPARK-XXXXX][CORE] Skip task serialization for local executor backend","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nThis patch removes task serialization when scheduling tasks for local executor backend. The tasks are directly passed to the local executor to run.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nSpark serializes tasks and attaches serialized tasks in task description before submitting tasks to executors. For remote executor backends, this is necessary. But for local executor backend, it runs in same JVM with master. It seems that task serialization for local executor backend is not necessary.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\nManual test local mode.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\n\r\nNo\r\n","created_at":"2025-01-04T08:08:50Z","updated_at":"2025-01-06T09:00:02Z","closed_at":"2025-01-06T09:00:01Z","merged_at":null,"merge_commit_sha":"5fac9be07920e318d7ee9760ec06c15adc492d33","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1984378631,"node_id":"MDU6TGFiZWwxOTg0Mzc4NjMx","url":"https://api.github.com/repos/apache/spark/labels/DSTREAM","name":"DSTREAM","color":"ededed","default":false,"description":null}],"milestone":null,"draft":true,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49355/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49355/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49355/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8a05526e1998bba790d9e3e60cf89a2f6df2cef4","head":{"label":"viirya:local_task_ser","ref":"local_task_ser","sha":"8a05526e1998bba790d9e3e60cf89a2f6df2cef4","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"dccb129ea045cfab36d8eb7a6525a6875c46e184","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49355"},"html":{"href":"https://github.com/apache/spark/pull/49355"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49355"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49355/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49355/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49355/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8a05526e1998bba790d9e3e60cf89a2f6df2cef4"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49354","id":2259965382,"node_id":"PR_kwDOAQXtWs6GtFXG","html_url":"https://github.com/apache/spark/pull/49354","diff_url":"https://github.com/apache/spark/pull/49354.diff","patch_url":"https://github.com/apache/spark/pull/49354.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49354","number":49354,"state":"closed","locked":false,"title":"[SPARK-50578][PYTHON][SS][FOLLOWUP] Change to use `Thread.interrupt` instead of `Thread.stop` to interrupt the execution of TransformWithStateInPandasPythonPreInitRunner#daemonThread.","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR change to use `Thread.interrupt()` instead of `Thread.stop()` to attempt to interrupt the execution of `TransformWithStateInPandasPythonPreInitRunner#daemonThread`. \r\n\r\nAdditionally, logic has been added in `TransformWithStateInPandasStateServer#run` to respond to the interrupt by setting the `CLOSED` state and exiting.\r\n\r\n\r\n### Why are the changes needed?\r\nThe `Thread.stop` method in Java 21 directly throws an `UnsupportedOperationException`, which led to the failure of the Java 21 daily tests:\r\n\r\n- https://github.com/apache/spark/actions/runs/12511573912/job/34903859772\r\n- https://github.com/apache/spark/actions/runs/12523542188/job/34933207012\r\n- https://github.com/apache/spark/actions/runs/12592534465/job/35097321533\r\n\r\n![image](https://github.com/user-attachments/assets/75cef6d7-d66a-4652-b01d-38412d6db3b0)\r\n\r\nSo the primary purpose of this change is to restore the daily tests for Java 21.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n- Pass GitHub Actions\r\n- Pass Java 21 GitHub Action test: https://github.com/LuciferYang/spark/actions/runs/12606699142/job/35137180872\r\n\r\n![image](https://github.com/user-attachments/assets/9e5e8b08-d167-4f7a-959c-8ebe6e22f9bc)\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo","created_at":"2025-01-04T02:29:01Z","updated_at":"2025-01-05T14:11:42Z","closed_at":"2025-01-04T21:30:36Z","merged_at":null,"merge_commit_sha":"f913e4f8aec74e39b7aa3e0bb3d52b2031327251","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49354/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49354/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49354/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/24d170138246003a19f2e4893334a54446cc773b","head":{"label":"LuciferYang:java21-test-2","ref":"java21-test-2","sha":"24d170138246003a19f2e4893334a54446cc773b","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"dccb129ea045cfab36d8eb7a6525a6875c46e184","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49354"},"html":{"href":"https://github.com/apache/spark/pull/49354"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49354"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49354/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49354/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49354/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/24d170138246003a19f2e4893334a54446cc773b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49353","id":2259628356,"node_id":"PR_kwDOAQXtWs6GrzFE","html_url":"https://github.com/apache/spark/pull/49353","diff_url":"https://github.com/apache/spark/pull/49353.diff","patch_url":"https://github.com/apache/spark/pull/49353.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49353","number":49353,"state":"closed","locked":false,"title":"[SPARK-50614][SQL] Revert API change for shredding","user":{"login":"cashmand","id":54722026,"node_id":"MDQ6VXNlcjU0NzIyMDI2","avatar_url":"https://avatars.githubusercontent.com/u/54722026?v=4","gravatar_id":"","url":"https://api.github.com/users/cashmand","html_url":"https://github.com/cashmand","followers_url":"https://api.github.com/users/cashmand/followers","following_url":"https://api.github.com/users/cashmand/following{/other_user}","gists_url":"https://api.github.com/users/cashmand/gists{/gist_id}","starred_url":"https://api.github.com/users/cashmand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cashmand/subscriptions","organizations_url":"https://api.github.com/users/cashmand/orgs","repos_url":"https://api.github.com/users/cashmand/repos","events_url":"https://api.github.com/users/cashmand/events{/privacy}","received_events_url":"https://api.github.com/users/cashmand/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nhttps://github.com/apache/spark/pull/49234 changed the `setSchema` method of ParquetWriteSupport to add a shredding schema parameter. To avoid the risk of breaking libraries that call `setSchema`, this PR instead creates a separate `setShreddingSchema` method to set the shredding schema. If not called, shredding will not be used.\r\n\r\n### Why are the changes needed?\r\n\r\nAvoid breaking API.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo, the feature has not been released yet.\r\n\r\n### How was this patch tested?\r\n\r\nExisting unit tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2025-01-03T18:23:36Z","updated_at":"2025-01-06T02:33:07Z","closed_at":"2025-01-06T02:33:07Z","merged_at":null,"merge_commit_sha":"e286a7a3fd8c9b3b7c4372c04a278afadc5654e0","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49353/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49353/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49353/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a987292f9c998cc6dd79d08a030ea420c4e35655","head":{"label":"cashmand:fix_set_schema","ref":"fix_set_schema","sha":"a987292f9c998cc6dd79d08a030ea420c4e35655","user":{"login":"cashmand","id":54722026,"node_id":"MDQ6VXNlcjU0NzIyMDI2","avatar_url":"https://avatars.githubusercontent.com/u/54722026?v=4","gravatar_id":"","url":"https://api.github.com/users/cashmand","html_url":"https://github.com/cashmand","followers_url":"https://api.github.com/users/cashmand/followers","following_url":"https://api.github.com/users/cashmand/following{/other_user}","gists_url":"https://api.github.com/users/cashmand/gists{/gist_id}","starred_url":"https://api.github.com/users/cashmand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cashmand/subscriptions","organizations_url":"https://api.github.com/users/cashmand/orgs","repos_url":"https://api.github.com/users/cashmand/repos","events_url":"https://api.github.com/users/cashmand/events{/privacy}","received_events_url":"https://api.github.com/users/cashmand/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":469837514,"node_id":"R_kgDOHAEmyg","name":"spark","full_name":"cashmand/spark","private":false,"owner":{"login":"cashmand","id":54722026,"node_id":"MDQ6VXNlcjU0NzIyMDI2","avatar_url":"https://avatars.githubusercontent.com/u/54722026?v=4","gravatar_id":"","url":"https://api.github.com/users/cashmand","html_url":"https://github.com/cashmand","followers_url":"https://api.github.com/users/cashmand/followers","following_url":"https://api.github.com/users/cashmand/following{/other_user}","gists_url":"https://api.github.com/users/cashmand/gists{/gist_id}","starred_url":"https://api.github.com/users/cashmand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cashmand/subscriptions","organizations_url":"https://api.github.com/users/cashmand/orgs","repos_url":"https://api.github.com/users/cashmand/repos","events_url":"https://api.github.com/users/cashmand/events{/privacy}","received_events_url":"https://api.github.com/users/cashmand/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cashmand/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/cashmand/spark","forks_url":"https://api.github.com/repos/cashmand/spark/forks","keys_url":"https://api.github.com/repos/cashmand/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cashmand/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cashmand/spark/teams","hooks_url":"https://api.github.com/repos/cashmand/spark/hooks","issue_events_url":"https://api.github.com/repos/cashmand/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cashmand/spark/events","assignees_url":"https://api.github.com/repos/cashmand/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cashmand/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cashmand/spark/tags","blobs_url":"https://api.github.com/repos/cashmand/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cashmand/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cashmand/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cashmand/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cashmand/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cashmand/spark/languages","stargazers_url":"https://api.github.com/repos/cashmand/spark/stargazers","contributors_url":"https://api.github.com/repos/cashmand/spark/contributors","subscribers_url":"https://api.github.com/repos/cashmand/spark/subscribers","subscription_url":"https://api.github.com/repos/cashmand/spark/subscription","commits_url":"https://api.github.com/repos/cashmand/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cashmand/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cashmand/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cashmand/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cashmand/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cashmand/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cashmand/spark/merges","archive_url":"https://api.github.com/repos/cashmand/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cashmand/spark/downloads","issues_url":"https://api.github.com/repos/cashmand/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cashmand/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cashmand/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cashmand/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cashmand/spark/labels{/name}","releases_url":"https://api.github.com/repos/cashmand/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cashmand/spark/deployments","created_at":"2022-03-14T17:28:00Z","updated_at":"2023-01-23T21:24:49Z","pushed_at":"2025-01-03T18:17:55Z","git_url":"git://github.com/cashmand/spark.git","ssh_url":"git@github.com:cashmand/spark.git","clone_url":"https://github.com/cashmand/spark.git","svn_url":"https://github.com/cashmand/spark","homepage":"https://spark.apache.org/","size":461006,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"dccb129ea045cfab36d8eb7a6525a6875c46e184","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49353"},"html":{"href":"https://github.com/apache/spark/pull/49353"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49353"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49353/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49353/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49353/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a987292f9c998cc6dd79d08a030ea420c4e35655"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49352","id":2259574160,"node_id":"PR_kwDOAQXtWs6Grl2Q","html_url":"https://github.com/apache/spark/pull/49352","diff_url":"https://github.com/apache/spark/pull/49352.diff","patch_url":"https://github.com/apache/spark/pull/49352.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49352","number":49352,"state":"closed","locked":false,"title":"[SPARK-50722][SQL] Trace the lineage of CTE references","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis is a follow-up of https://github.com/apache/spark/pull/48284 to make the CTE inline decision smarter.\r\n\r\nThis is a very complicated issue so we need to provide some background. A CTE relation can only be referenced by other CTE relations that are defined after it in the same `WithCTE` (sibling CTE relations can contain nested `WithCTE` that reference this CTE relation), or by the main query of this `WithCTE`. Following this definition, let's look at some examples.\r\n\r\nCase 0:\r\n```\r\nWITH\r\nt1 AS (...),\r\nt2 AS (...)\r\nSELECT t1\r\n```\r\n`t1` is referenced but `t2` is not. There is no connection between `t1` and `t2`.\r\n\r\n---\r\n\r\nCase 1:\r\n```\r\nWITH\r\nt1 AS (...),\r\nt2 AS (SELECT * FROM t1)\r\n```\r\nThis is clear that `t2` references `t1`.\r\n\r\n---\r\n\r\nCase 2:\r\n```\r\nWITH\r\nt1 AS (...),\r\nt2 AS (\r\n  WITH\r\n    t3 AS (SELECT * FROM t1)\r\n)\r\n```\r\nThis is also clear that `t3` references `t1`, and `t2` also references `t1` but indirectly via `t3`.\r\n\r\n---\r\n\r\nCase 3:\r\n```\r\nWITH\r\nt1 AS (\r\n  WITH\r\n    t2 AS (...),\r\n    t3 AS (SELECT * t2)\r\n  SELECT t3\r\n)\r\n```\r\n`t3` references `t2`, but `t1` references no one. It contains the whole `WithCTE` that defines `t2` and `t3`, but \"contains\" is not \"reference\".\r\n\r\n---\r\n\r\nAs you can see, CTE reference has a lineage, which this PR uses to update the ref counts: A CTE relation keeps track of all the relations it references directly, so that when this CTE relation is optimized out, we can decrease the ref counts for the relations it references. However, the referenced CTE relations may come from outer CTEs, and we track the lineage of the reference up to the `WithCTE` that defines the being-referenced CTE relation. If any relation on the lineage is optimized out, we will trace down to the bottom-most CTE relation that triggers direct reference, and adjust the ref counts.\r\n\r\nFor the case 2 above, `t3`'s `outgoingRefs` contains `t1`, but `t2`'s `outgoingRefs` does not. Since `t1` is defined in the same `WithCTE` of `t2`, so the reference lineage is `t2` -> `t3` -> `t1`. `t2` will put `t3` into its `indirectOutgoingRefSources`. If `t2` is referenced but `t3` is not, we will still decrease the ref count of `t1`. If `t2` is not referenced but `t3` is, we will still decrease the ref count of `t1`, because we will find `t3` in `t2`'s `indirectOutgoingRefSources`. If neither of `t2` and `t3` is referenced, we will decrease the ref count of `t1` twice, but the second decrement will be noop as `t3` will clear its `outgoingRefs` after one decrement.\r\n\r\nFor the case 3 above, `t3`'s `outgoingRefs` contains `t2`, and that's all. If `t1` is not referenced, we don't update any ref count, but just remove `t1` from the main query plan. If `t3` is not referenced, we update ref count as usual.\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nMake sure we can inline CTE when we should.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nno\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nnew tests\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nno","created_at":"2025-01-03T17:31:24Z","updated_at":"2025-01-08T01:12:59Z","closed_at":"2025-01-08T01:12:58Z","merged_at":null,"merge_commit_sha":null,"assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49352/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49352/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49352/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/76000f66dcd44019af562b73bd6ee8f578264ed2","head":{"label":"cloud-fan:cte","ref":"cte","sha":"76000f66dcd44019af562b73bd6ee8f578264ed2","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"dccb129ea045cfab36d8eb7a6525a6875c46e184","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49352"},"html":{"href":"https://github.com/apache/spark/pull/49352"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49352"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49352/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49352/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49352/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/76000f66dcd44019af562b73bd6ee8f578264ed2"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49351","id":2259573050,"node_id":"PR_kwDOAQXtWs6Grlk6","html_url":"https://github.com/apache/spark/pull/49351","diff_url":"https://github.com/apache/spark/pull/49351.diff","patch_url":"https://github.com/apache/spark/pull/49351.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49351","number":49351,"state":"closed","locked":false,"title":"[SPARK-50739][SQL] Recursive CTE. Analyzer changes to unravel and resolve the recursion components.","user":{"login":"nemanjapetr-db","id":174345839,"node_id":"U_kgDOCmRObw","avatar_url":"https://avatars.githubusercontent.com/u/174345839?v=4","gravatar_id":"","url":"https://api.github.com/users/nemanjapetr-db","html_url":"https://github.com/nemanjapetr-db","followers_url":"https://api.github.com/users/nemanjapetr-db/followers","following_url":"https://api.github.com/users/nemanjapetr-db/following{/other_user}","gists_url":"https://api.github.com/users/nemanjapetr-db/gists{/gist_id}","starred_url":"https://api.github.com/users/nemanjapetr-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nemanjapetr-db/subscriptions","organizations_url":"https://api.github.com/users/nemanjapetr-db/orgs","repos_url":"https://api.github.com/users/nemanjapetr-db/repos","events_url":"https://api.github.com/users/nemanjapetr-db/events{/privacy}","received_events_url":"https://api.github.com/users/nemanjapetr-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nInstruction for reviewers https://docs.google.com/document/d/1qcEJxqoXcr5cSt6HgIQjWQSqhfkSaVYkoDHsg5oxXp4/edit\r\nIntroduction of UnionLoop and UnionLoopRef logical plan classes. Changes in ResolveWithCTE.scala to have the analyzer grok recursive anchors. Specifically we substitute CTERelationRef with UnionLoopRef, and Union with UnionLoop. We untangle the dead loop in resolving where recursive CTE reference is referring to an unresolved CTE definition, which itself cannot be resolved as one of its descendants is an unresolved CTE reference. \r\n\r\n### Why are the changes needed?\r\nSupport for the recursive CTE.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nProposed changes in this PR are no-op. Tested\r\n./build/sbt \"test:testOnly org.apache.spark.sql.SQLQueryTestSuite\"\r\n./build/sbt \"test:testOnly *PlanParserSuite\"\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo","created_at":"2025-01-03T17:30:19Z","updated_at":"2025-01-17T16:53:32Z","closed_at":"2025-01-17T15:26:19Z","merged_at":null,"merge_commit_sha":"06ccdc2c7bb5b3155857bf33511182972149a96b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49351/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49351/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49351/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e3cabd5462e467dc40551fcc8ba804d895e446b6","head":{"label":"nemanjapetr-db:nemanjapetr-db/rcte3","ref":"nemanjapetr-db/rcte3","sha":"e3cabd5462e467dc40551fcc8ba804d895e446b6","user":{"login":"nemanjapetr-db","id":174345839,"node_id":"U_kgDOCmRObw","avatar_url":"https://avatars.githubusercontent.com/u/174345839?v=4","gravatar_id":"","url":"https://api.github.com/users/nemanjapetr-db","html_url":"https://github.com/nemanjapetr-db","followers_url":"https://api.github.com/users/nemanjapetr-db/followers","following_url":"https://api.github.com/users/nemanjapetr-db/following{/other_user}","gists_url":"https://api.github.com/users/nemanjapetr-db/gists{/gist_id}","starred_url":"https://api.github.com/users/nemanjapetr-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nemanjapetr-db/subscriptions","organizations_url":"https://api.github.com/users/nemanjapetr-db/orgs","repos_url":"https://api.github.com/users/nemanjapetr-db/repos","events_url":"https://api.github.com/users/nemanjapetr-db/events{/privacy}","received_events_url":"https://api.github.com/users/nemanjapetr-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":838897302,"node_id":"R_kgDOMgCOlg","name":"spark","full_name":"nemanjapetr-db/spark","private":false,"owner":{"login":"nemanjapetr-db","id":174345839,"node_id":"U_kgDOCmRObw","avatar_url":"https://avatars.githubusercontent.com/u/174345839?v=4","gravatar_id":"","url":"https://api.github.com/users/nemanjapetr-db","html_url":"https://github.com/nemanjapetr-db","followers_url":"https://api.github.com/users/nemanjapetr-db/followers","following_url":"https://api.github.com/users/nemanjapetr-db/following{/other_user}","gists_url":"https://api.github.com/users/nemanjapetr-db/gists{/gist_id}","starred_url":"https://api.github.com/users/nemanjapetr-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nemanjapetr-db/subscriptions","organizations_url":"https://api.github.com/users/nemanjapetr-db/orgs","repos_url":"https://api.github.com/users/nemanjapetr-db/repos","events_url":"https://api.github.com/users/nemanjapetr-db/events{/privacy}","received_events_url":"https://api.github.com/users/nemanjapetr-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/nemanjapetr-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/nemanjapetr-db/spark","forks_url":"https://api.github.com/repos/nemanjapetr-db/spark/forks","keys_url":"https://api.github.com/repos/nemanjapetr-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/nemanjapetr-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/nemanjapetr-db/spark/teams","hooks_url":"https://api.github.com/repos/nemanjapetr-db/spark/hooks","issue_events_url":"https://api.github.com/repos/nemanjapetr-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/nemanjapetr-db/spark/events","assignees_url":"https://api.github.com/repos/nemanjapetr-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/nemanjapetr-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/nemanjapetr-db/spark/tags","blobs_url":"https://api.github.com/repos/nemanjapetr-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/nemanjapetr-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/nemanjapetr-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/nemanjapetr-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/nemanjapetr-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/nemanjapetr-db/spark/languages","stargazers_url":"https://api.github.com/repos/nemanjapetr-db/spark/stargazers","contributors_url":"https://api.github.com/repos/nemanjapetr-db/spark/contributors","subscribers_url":"https://api.github.com/repos/nemanjapetr-db/spark/subscribers","subscription_url":"https://api.github.com/repos/nemanjapetr-db/spark/subscription","commits_url":"https://api.github.com/repos/nemanjapetr-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/nemanjapetr-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/nemanjapetr-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/nemanjapetr-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/nemanjapetr-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/nemanjapetr-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/nemanjapetr-db/spark/merges","archive_url":"https://api.github.com/repos/nemanjapetr-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/nemanjapetr-db/spark/downloads","issues_url":"https://api.github.com/repos/nemanjapetr-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/nemanjapetr-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/nemanjapetr-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/nemanjapetr-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/nemanjapetr-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/nemanjapetr-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/nemanjapetr-db/spark/deployments","created_at":"2024-08-06T14:54:53Z","updated_at":"2025-01-17T16:50:41Z","pushed_at":"2025-01-17T16:53:31Z","git_url":"git://github.com/nemanjapetr-db/spark.git","ssh_url":"git@github.com:nemanjapetr-db/spark.git","clone_url":"https://github.com/nemanjapetr-db/spark.git","svn_url":"https://github.com/nemanjapetr-db/spark","homepage":"https://spark.apache.org/","size":420804,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2721a50234b05db3e59b5a37225f9358978a4590","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49351"},"html":{"href":"https://github.com/apache/spark/pull/49351"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49351"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49351/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49351/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49351/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e3cabd5462e467dc40551fcc8ba804d895e446b6"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49350","id":2258932010,"node_id":"PR_kwDOAQXtWs6GpJEq","html_url":"https://github.com/apache/spark/pull/49350","diff_url":"https://github.com/apache/spark/pull/49350.diff","patch_url":"https://github.com/apache/spark/pull/49350.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49350","number":49350,"state":"open","locked":false,"title":"[SPARK-50720][CORE] Support external shuffle service enablement in local-cluster mode","user":{"login":"Ngone51","id":16397174,"node_id":"MDQ6VXNlcjE2Mzk3MTc0","avatar_url":"https://avatars.githubusercontent.com/u/16397174?v=4","gravatar_id":"","url":"https://api.github.com/users/Ngone51","html_url":"https://github.com/Ngone51","followers_url":"https://api.github.com/users/Ngone51/followers","following_url":"https://api.github.com/users/Ngone51/following{/other_user}","gists_url":"https://api.github.com/users/Ngone51/gists{/gist_id}","starred_url":"https://api.github.com/users/Ngone51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ngone51/subscriptions","organizations_url":"https://api.github.com/users/Ngone51/orgs","repos_url":"https://api.github.com/users/Ngone51/repos","events_url":"https://api.github.com/users/Ngone51/events{/privacy}","received_events_url":"https://api.github.com/users/Ngone51/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nThis PR supports external shuffle service enablement in local-cluster mode. Unlike the real cluster, where there is only one external shuffle service in each node, there could be multiple shuffle service in a local cluster. To support this, we have to use the dynamic port rather than the fixed port (`spark.shuffle.service.port`) to start the shuffle servieces. And so, worker would pass this dynamic port via a environment variable (`TESTING_EXTERNAL_SHUFFLE_SERVICE_PORT`) to the executor process since the fixed shuffle service port is no-longer valid. This also becomes an issue to `BlockManagerMaster`, which could also not use the fixed port anymore. So this PR adds a new RPC `GetShuffleServicePort` for retrieving the dynamic port from executor to driver. Another similar issue is that `DBProvider` uses the fixed persist file name in shuffle service. This PR changes it be unique by inserting a uuid under test mode only.\r\n\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nThis allows Spark developers to test features (e.g., shuffle data / rdd fetch via shuffle service) with the real external shuffle service, which is more close to the production environment.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nNo.\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\nUpdated `ExternalShuffleServiceSuite` (removed the mock of the external shuffle service).\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\n\r\nNo.\r\n","created_at":"2025-01-03T09:04:25Z","updated_at":"2025-01-18T14:11:45Z","closed_at":null,"merged_at":null,"merge_commit_sha":"acd3c5da88a09c660febf45a562626a1af588eb1","assignee":null,"assignees":[],"requested_reviewers":[{"login":"mridulm","id":1591700,"node_id":"MDQ6VXNlcjE1OTE3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/1591700?v=4","gravatar_id":"","url":"https://api.github.com/users/mridulm","html_url":"https://github.com/mridulm","followers_url":"https://api.github.com/users/mridulm/followers","following_url":"https://api.github.com/users/mridulm/following{/other_user}","gists_url":"https://api.github.com/users/mridulm/gists{/gist_id}","starred_url":"https://api.github.com/users/mridulm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mridulm/subscriptions","organizations_url":"https://api.github.com/users/mridulm/orgs","repos_url":"https://api.github.com/users/mridulm/repos","events_url":"https://api.github.com/users/mridulm/events{/privacy}","received_events_url":"https://api.github.com/users/mridulm/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"JoshRosen","id":50748,"node_id":"MDQ6VXNlcjUwNzQ4","avatar_url":"https://avatars.githubusercontent.com/u/50748?v=4","gravatar_id":"","url":"https://api.github.com/users/JoshRosen","html_url":"https://github.com/JoshRosen","followers_url":"https://api.github.com/users/JoshRosen/followers","following_url":"https://api.github.com/users/JoshRosen/following{/other_user}","gists_url":"https://api.github.com/users/JoshRosen/gists{/gist_id}","starred_url":"https://api.github.com/users/JoshRosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JoshRosen/subscriptions","organizations_url":"https://api.github.com/users/JoshRosen/orgs","repos_url":"https://api.github.com/users/JoshRosen/repos","events_url":"https://api.github.com/users/JoshRosen/events{/privacy}","received_events_url":"https://api.github.com/users/JoshRosen/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49350/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49350/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49350/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/1df18313b84b5398a575a4b64c0a4c067915495f","head":{"label":"Ngone51:test-ess","ref":"test-ess","sha":"1df18313b84b5398a575a4b64c0a4c067915495f","user":{"login":"Ngone51","id":16397174,"node_id":"MDQ6VXNlcjE2Mzk3MTc0","avatar_url":"https://avatars.githubusercontent.com/u/16397174?v=4","gravatar_id":"","url":"https://api.github.com/users/Ngone51","html_url":"https://github.com/Ngone51","followers_url":"https://api.github.com/users/Ngone51/followers","following_url":"https://api.github.com/users/Ngone51/following{/other_user}","gists_url":"https://api.github.com/users/Ngone51/gists{/gist_id}","starred_url":"https://api.github.com/users/Ngone51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ngone51/subscriptions","organizations_url":"https://api.github.com/users/Ngone51/orgs","repos_url":"https://api.github.com/users/Ngone51/repos","events_url":"https://api.github.com/users/Ngone51/events{/privacy}","received_events_url":"https://api.github.com/users/Ngone51/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":114185286,"node_id":"MDEwOlJlcG9zaXRvcnkxMTQxODUyODY=","name":"spark","full_name":"Ngone51/spark","private":false,"owner":{"login":"Ngone51","id":16397174,"node_id":"MDQ6VXNlcjE2Mzk3MTc0","avatar_url":"https://avatars.githubusercontent.com/u/16397174?v=4","gravatar_id":"","url":"https://api.github.com/users/Ngone51","html_url":"https://github.com/Ngone51","followers_url":"https://api.github.com/users/Ngone51/followers","following_url":"https://api.github.com/users/Ngone51/following{/other_user}","gists_url":"https://api.github.com/users/Ngone51/gists{/gist_id}","starred_url":"https://api.github.com/users/Ngone51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ngone51/subscriptions","organizations_url":"https://api.github.com/users/Ngone51/orgs","repos_url":"https://api.github.com/users/Ngone51/repos","events_url":"https://api.github.com/users/Ngone51/events{/privacy}","received_events_url":"https://api.github.com/users/Ngone51/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Ngone51/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/Ngone51/spark","forks_url":"https://api.github.com/repos/Ngone51/spark/forks","keys_url":"https://api.github.com/repos/Ngone51/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Ngone51/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Ngone51/spark/teams","hooks_url":"https://api.github.com/repos/Ngone51/spark/hooks","issue_events_url":"https://api.github.com/repos/Ngone51/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Ngone51/spark/events","assignees_url":"https://api.github.com/repos/Ngone51/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Ngone51/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Ngone51/spark/tags","blobs_url":"https://api.github.com/repos/Ngone51/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Ngone51/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Ngone51/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Ngone51/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Ngone51/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Ngone51/spark/languages","stargazers_url":"https://api.github.com/repos/Ngone51/spark/stargazers","contributors_url":"https://api.github.com/repos/Ngone51/spark/contributors","subscribers_url":"https://api.github.com/repos/Ngone51/spark/subscribers","subscription_url":"https://api.github.com/repos/Ngone51/spark/subscription","commits_url":"https://api.github.com/repos/Ngone51/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Ngone51/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Ngone51/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Ngone51/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Ngone51/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Ngone51/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Ngone51/spark/merges","archive_url":"https://api.github.com/repos/Ngone51/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Ngone51/spark/downloads","issues_url":"https://api.github.com/repos/Ngone51/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Ngone51/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Ngone51/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Ngone51/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Ngone51/spark/labels{/name}","releases_url":"https://api.github.com/repos/Ngone51/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Ngone51/spark/deployments","created_at":"2017-12-14T01:05:22Z","updated_at":"2021-11-09T15:33:30Z","pushed_at":"2025-01-23T04:25:21Z","git_url":"git://github.com/Ngone51/spark.git","ssh_url":"git@github.com:Ngone51/spark.git","clone_url":"https://github.com/Ngone51/spark.git","svn_url":"https://github.com/Ngone51/spark","homepage":null,"size":478226,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"dff46cfeabfbdd01e2ced84a75137239cf640da9","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49350"},"html":{"href":"https://github.com/apache/spark/pull/49350"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49350"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49350/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49350/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49350/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/1df18313b84b5398a575a4b64c0a4c067915495f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49349","id":2258729681,"node_id":"PR_kwDOAQXtWs6GoXrR","html_url":"https://github.com/apache/spark/pull/49349","diff_url":"https://github.com/apache/spark/pull/49349.diff","patch_url":"https://github.com/apache/spark/pull/49349.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49349","number":49349,"state":"closed","locked":false,"title":"[SPARK-50717][PS][DOCS] Update doc and add examples for `from_pandas`","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to update doc and add examples for `from_pandas`\r\n\r\n### Why are the changes needed?\r\n\r\nImprove documentation\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo API changes\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nThe existing CI should pass\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nNo","created_at":"2025-01-03T05:18:11Z","updated_at":"2025-01-03T07:54:20Z","closed_at":"2025-01-03T07:53:31Z","merged_at":null,"merge_commit_sha":"f55c3014cc1199fec7f867227af1b877a5daf892","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4138679613,"node_id":"LA_kwDOAQXtWs72rz09","url":"https://api.github.com/repos/apache/spark/labels/PANDAS%20API%20ON%20SPARK","name":"PANDAS API ON SPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49349/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49349/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49349/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e761c8ecdc1013d984f98c427ec1d3fac55d99b8","head":{"label":"itholic:SPARK-50717","ref":"SPARK-50717","sha":"e761c8ecdc1013d984f98c427ec1d3fac55d99b8","user":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":445423122,"node_id":"R_kgDOGoyeEg","name":"spark","full_name":"itholic/spark","private":false,"owner":{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/itholic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/itholic/spark","forks_url":"https://api.github.com/repos/itholic/spark/forks","keys_url":"https://api.github.com/repos/itholic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/itholic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/itholic/spark/teams","hooks_url":"https://api.github.com/repos/itholic/spark/hooks","issue_events_url":"https://api.github.com/repos/itholic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/itholic/spark/events","assignees_url":"https://api.github.com/repos/itholic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/itholic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/itholic/spark/tags","blobs_url":"https://api.github.com/repos/itholic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/itholic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/itholic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/itholic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/itholic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/itholic/spark/languages","stargazers_url":"https://api.github.com/repos/itholic/spark/stargazers","contributors_url":"https://api.github.com/repos/itholic/spark/contributors","subscribers_url":"https://api.github.com/repos/itholic/spark/subscribers","subscription_url":"https://api.github.com/repos/itholic/spark/subscription","commits_url":"https://api.github.com/repos/itholic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/itholic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/itholic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/itholic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/itholic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/itholic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/itholic/spark/merges","archive_url":"https://api.github.com/repos/itholic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/itholic/spark/downloads","issues_url":"https://api.github.com/repos/itholic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/itholic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/itholic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/itholic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/itholic/spark/labels{/name}","releases_url":"https://api.github.com/repos/itholic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/itholic/spark/deployments","created_at":"2022-01-07T06:35:10Z","updated_at":"2025-01-23T06:13:52Z","pushed_at":"2025-01-23T06:47:35Z","git_url":"git://github.com/itholic/spark.git","ssh_url":"git@github.com:itholic/spark.git","clone_url":"https://github.com/itholic/spark.git","svn_url":"https://github.com/itholic/spark","homepage":"https://spark.apache.org/","size":459393,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a3a8d1ca668aae61f672c84a8873960edb8ab37b","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49349"},"html":{"href":"https://github.com/apache/spark/pull/49349"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49349"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49349/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49349/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49349/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e761c8ecdc1013d984f98c427ec1d3fac55d99b8"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49348","id":2258683895,"node_id":"PR_kwDOAQXtWs6GoMf3","html_url":"https://github.com/apache/spark/pull/49348","diff_url":"https://github.com/apache/spark/pull/49348.diff","patch_url":"https://github.com/apache/spark/pull/49348.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49348","number":49348,"state":"closed","locked":false,"title":"[SPARK-50703][PYTHON] Refine the docstring of regexp_replace, regexp_substr, and regexp_instr","user":{"login":"drexler-sky","id":193304905,"node_id":"U_kgDOC4WZSQ","avatar_url":"https://avatars.githubusercontent.com/u/193304905?v=4","gravatar_id":"","url":"https://api.github.com/users/drexler-sky","html_url":"https://github.com/drexler-sky","followers_url":"https://api.github.com/users/drexler-sky/followers","following_url":"https://api.github.com/users/drexler-sky/following{/other_user}","gists_url":"https://api.github.com/users/drexler-sky/gists{/gist_id}","starred_url":"https://api.github.com/users/drexler-sky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drexler-sky/subscriptions","organizations_url":"https://api.github.com/users/drexler-sky/orgs","repos_url":"https://api.github.com/users/drexler-sky/repos","events_url":"https://api.github.com/users/drexler-sky/events{/privacy}","received_events_url":"https://api.github.com/users/drexler-sky/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n\r\n<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nRefined docstring for `regexp_replace`, `regexp_substr`, and `regexp_instr`.\r\n\r\n\r\n### Why are the changes needed?\r\nto improve docs and test coverage\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\ndoc-only changes\r\n\r\n\r\n### How was this patch tested?\r\ndoctests\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2025-01-03T04:00:47Z","updated_at":"2025-01-06T03:14:09Z","closed_at":"2025-01-06T02:16:22Z","merged_at":null,"merge_commit_sha":"f99f5e1465ada020678bdc64716e2bb8e51cf79b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49348/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49348/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49348/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/850128744d8952ceac680e89e6a5aa480c05f634","head":{"label":"drexler-sky:docstring2","ref":"docstring2","sha":"850128744d8952ceac680e89e6a5aa480c05f634","user":{"login":"drexler-sky","id":193304905,"node_id":"U_kgDOC4WZSQ","avatar_url":"https://avatars.githubusercontent.com/u/193304905?v=4","gravatar_id":"","url":"https://api.github.com/users/drexler-sky","html_url":"https://github.com/drexler-sky","followers_url":"https://api.github.com/users/drexler-sky/followers","following_url":"https://api.github.com/users/drexler-sky/following{/other_user}","gists_url":"https://api.github.com/users/drexler-sky/gists{/gist_id}","starred_url":"https://api.github.com/users/drexler-sky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drexler-sky/subscriptions","organizations_url":"https://api.github.com/users/drexler-sky/orgs","repos_url":"https://api.github.com/users/drexler-sky/repos","events_url":"https://api.github.com/users/drexler-sky/events{/privacy}","received_events_url":"https://api.github.com/users/drexler-sky/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":910384156,"node_id":"R_kgDONkNcHA","name":"spark","full_name":"drexler-sky/spark","private":false,"owner":{"login":"drexler-sky","id":193304905,"node_id":"U_kgDOC4WZSQ","avatar_url":"https://avatars.githubusercontent.com/u/193304905?v=4","gravatar_id":"","url":"https://api.github.com/users/drexler-sky","html_url":"https://github.com/drexler-sky","followers_url":"https://api.github.com/users/drexler-sky/followers","following_url":"https://api.github.com/users/drexler-sky/following{/other_user}","gists_url":"https://api.github.com/users/drexler-sky/gists{/gist_id}","starred_url":"https://api.github.com/users/drexler-sky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drexler-sky/subscriptions","organizations_url":"https://api.github.com/users/drexler-sky/orgs","repos_url":"https://api.github.com/users/drexler-sky/repos","events_url":"https://api.github.com/users/drexler-sky/events{/privacy}","received_events_url":"https://api.github.com/users/drexler-sky/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/drexler-sky/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/drexler-sky/spark","forks_url":"https://api.github.com/repos/drexler-sky/spark/forks","keys_url":"https://api.github.com/repos/drexler-sky/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/drexler-sky/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/drexler-sky/spark/teams","hooks_url":"https://api.github.com/repos/drexler-sky/spark/hooks","issue_events_url":"https://api.github.com/repos/drexler-sky/spark/issues/events{/number}","events_url":"https://api.github.com/repos/drexler-sky/spark/events","assignees_url":"https://api.github.com/repos/drexler-sky/spark/assignees{/user}","branches_url":"https://api.github.com/repos/drexler-sky/spark/branches{/branch}","tags_url":"https://api.github.com/repos/drexler-sky/spark/tags","blobs_url":"https://api.github.com/repos/drexler-sky/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/drexler-sky/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/drexler-sky/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/drexler-sky/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/drexler-sky/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/drexler-sky/spark/languages","stargazers_url":"https://api.github.com/repos/drexler-sky/spark/stargazers","contributors_url":"https://api.github.com/repos/drexler-sky/spark/contributors","subscribers_url":"https://api.github.com/repos/drexler-sky/spark/subscribers","subscription_url":"https://api.github.com/repos/drexler-sky/spark/subscription","commits_url":"https://api.github.com/repos/drexler-sky/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/drexler-sky/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/drexler-sky/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/drexler-sky/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/drexler-sky/spark/contents/{+path}","compare_url":"https://api.github.com/repos/drexler-sky/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/drexler-sky/spark/merges","archive_url":"https://api.github.com/repos/drexler-sky/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/drexler-sky/spark/downloads","issues_url":"https://api.github.com/repos/drexler-sky/spark/issues{/number}","pulls_url":"https://api.github.com/repos/drexler-sky/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/drexler-sky/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/drexler-sky/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/drexler-sky/spark/labels{/name}","releases_url":"https://api.github.com/repos/drexler-sky/spark/releases{/id}","deployments_url":"https://api.github.com/repos/drexler-sky/spark/deployments","created_at":"2024-12-31T06:10:04Z","updated_at":"2024-12-31T06:10:04Z","pushed_at":"2025-01-14T01:19:12Z","git_url":"git://github.com/drexler-sky/spark.git","ssh_url":"git@github.com:drexler-sky/spark.git","clone_url":"https://github.com/drexler-sky/spark.git","svn_url":"https://github.com/drexler-sky/spark","homepage":"https://spark.apache.org/","size":419545,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fa0c9954aa4d4281c31aaaf26b94e699699bb469","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49348"},"html":{"href":"https://github.com/apache/spark/pull/49348"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49348"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49348/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49348/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49348/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/850128744d8952ceac680e89e6a5aa480c05f634"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49347","id":2258638323,"node_id":"PR_kwDOAQXtWs6GoBXz","html_url":"https://github.com/apache/spark/pull/49347","diff_url":"https://github.com/apache/spark/pull/49347.diff","patch_url":"https://github.com/apache/spark/pull/49347.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49347","number":49347,"state":"closed","locked":false,"title":"[SPARK-50716][CORE] Fix the cleanup logic for symbolic links in `JavaUtils.deleteRecursivelyUsingJavaIO` method","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nTo address the cleanup logic for symbolic links in the `JavaUtils.deleteRecursivelyUsingJavaIO` method, the following changes have been made in this pr:\r\n\r\n1. Change to use `Files.readAttributes(file.toPath(), BasicFileAttributes.class, LinkOption.NOFOLLOW_LINKS)` to read the `BasicFileAttributes` of the file. By specifying `LinkOption.NOFOLLOW_LINKS`, the attributes of the symbolic link itself are read, rather than those of the file it points to. This allows us to use `fileAttributes.isSymbolicLink()` to check if a file is a symbolic link.\r\n\r\n2. After the above change, it is no longer possible for `fileAttributes.isDirectory()` and `fileAttributes.isSymbolicLink()` to be true simultaneously. Therefore, when `fileAttributes.isDirectory()` is true, there is no need to check `!fileAttributes.isSymbolicLink()`.\r\n\r\n3. When `fileAttributes.isSymbolicLink()` is true, deletion behavior for the symbolic link has been added.\r\n\r\n4. When `!file.exists()` is true, an additional check for `!fileAttributes.isSymbolicLink()` has been added. This is because for a broken symbolic link, `file.exists()` will also return false, but in such cases, we should proceed with the cleanup.\r\n\r\n5. The previously handwritten `isSymlink` method in JavaUtils has been removed, as it is no longer needed after the above changes.\r\n\r\n\r\n### Why are the changes needed?\r\nFix the cleanup logic for symbolic links in `JavaUtils.deleteRecursivelyUsingJavaIO` method.\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n- Pass GitHub Actions\r\n- New test cases have been added\r\n- Check with existing test cases which named `PipedRDDSuite`:\r\n\r\nRun `build/sbt \"core/testOnly org.apache.spark.rdd.PipedRDDSuite\"`\r\n\r\nBefore\r\n\r\n```\r\ngit status\r\nOn branch upmaster\r\nYour branch is up to date with 'upstream/master'.\r\n\r\nUntracked files:\r\n  (use \"git add <file>...\" to include in what will be committed)\r\n    core/tasks/\r\n\r\nls -l core/tasks \r\ntotal 0\r\ndrwxr-xr-x  5 yangjie01  staff  160  1  3 18:15 099f2492-acef-4556-8a34-1318dccf7ad2\r\ndrwxr-xr-x  5 yangjie01  staff  160  1  3 18:15 47d46196-2f7b-4c7b-acf3-7e1d26584c12\r\ndrwxr-xr-x  5 yangjie01  staff  160  1  3 18:15 5e23fe20-1e3f-49b8-8404-5cd3b1033e37\r\ndrwxr-xr-x  5 yangjie01  staff  160  1  3 18:15 a2cbf5a9-3ebf-4332-be87-c9501830750e\r\ndrwxr-xr-x  5 yangjie01  staff  160  1  3 18:15 ddf45bf5-d0fa-4970-9094-930f382b675c\r\ndrwxr-xr-x  5 yangjie01  staff  160  1  3 18:15 e25fe5ad-a0be-48d0-81f6-605542f447b5\r\n\r\n\r\nls -l core/tasks/099f2492-acef-4556-8a34-1318dccf7ad2\r\ntotal 0\r\nlrwxr-xr-x  1 yangjie01  staff  59  1  3 18:15 benchmarks -> /Users/yangjie01/SourceCode/git/spark-sbt/core/./benchmarks\r\nlrwxr-xr-x  1 yangjie01  staff  52  1  3 18:15 src -> /Users/yangjie01/SourceCode/git/spark-sbt/core/./src\r\nlrwxr-xr-x  1 yangjie01  staff  55  1  3 18:15 target -> /Users/yangjie01/SourceCode/git/spark-sbt/core/./target\r\n```\r\n\r\nWe noticed that symbolic links are left behind after the tests, even though manual cleanup has been invoked in the test code:\r\n\r\nhttps://github.com/apache/spark/blob/b210f422b0078d535eddc696ebba8d92f67b81fb/core/src/test/scala/org/apache/spark/rdd/PipedRDDSuite.scala#L214-L232\r\n\r\nAfter\r\n\r\n```\r\ngit status\r\nOn branch deleteRecursivelyUsingJavaIO-SymbolicLink\r\nYour branch is up to date with 'origin/deleteRecursivelyUsingJavaIO-SymbolicLink'.\r\n\r\nnothing to commit, working tree clean\r\n```\r\n\r\nWe observe that there are no residual symbolic links left after the tests.\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2025-01-03T02:28:11Z","updated_at":"2025-01-05T18:47:30Z","closed_at":"2025-01-04T21:28:28Z","merged_at":null,"merge_commit_sha":"9d764c6ba7a6c3b10a1cc6dc868721109710e848","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49347/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49347/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49347/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d759af340d51e5862372277b73329b51cc1762e4","head":{"label":"LuciferYang:deleteRecursivelyUsingJavaIO-SymbolicLink","ref":"deleteRecursivelyUsingJavaIO-SymbolicLink","sha":"d759af340d51e5862372277b73329b51cc1762e4","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a3a8d1ca668aae61f672c84a8873960edb8ab37b","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49347"},"html":{"href":"https://github.com/apache/spark/pull/49347"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49347"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49347/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49347/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49347/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d759af340d51e5862372277b73329b51cc1762e4"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49346","id":2258610102,"node_id":"PR_kwDOAQXtWs6Gn6e2","html_url":"https://github.com/apache/spark/pull/49346","diff_url":"https://github.com/apache/spark/pull/49346.diff","patch_url":"https://github.com/apache/spark/pull/49346.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49346","number":49346,"state":"closed","locked":false,"title":"[SPARK-50715][PYTHON][CONNECT] `SparkSession.Builder` sets the configs in batch","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n`SparkSession.Builder` sets the configs in batch\r\n\r\n### Why are the changes needed?\r\nI notice that there are practice workflows with 500+ configs, existing implementation always set the configs one by one, and thus cause 500+ `Config` RPCs.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo, internal change\r\n\r\n### How was this patch tested?\r\nExisting CI\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2025-01-03T01:28:37Z","updated_at":"2025-01-03T04:41:00Z","closed_at":"2025-01-03T04:40:20Z","merged_at":null,"merge_commit_sha":"fc6edc2eea6267ceef21faf31d824db96d128bfc","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49346/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49346/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49346/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e681433002e62623c9f827f8a201528a667bc638","head":{"label":"zhengruifeng:py_connect_set_all","ref":"py_connect_set_all","sha":"e681433002e62623c9f827f8a201528a667bc638","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"fa0c9954aa4d4281c31aaaf26b94e699699bb469","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49346"},"html":{"href":"https://github.com/apache/spark/pull/49346"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49346"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49346/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49346/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49346/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e681433002e62623c9f827f8a201528a667bc638"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49345","id":2258301553,"node_id":"PR_kwDOAQXtWs6GmvJx","html_url":"https://github.com/apache/spark/pull/49345","diff_url":"https://github.com/apache/spark/pull/49345.diff","patch_url":"https://github.com/apache/spark/pull/49345.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49345","number":49345,"state":"closed","locked":false,"title":"[SPARK-50614][SQL] Fix shredding debug message","user":{"login":"cashmand","id":54722026,"node_id":"MDQ6VXNlcjU0NzIyMDI2","avatar_url":"https://avatars.githubusercontent.com/u/54722026?v=4","gravatar_id":"","url":"https://api.github.com/users/cashmand","html_url":"https://github.com/cashmand","followers_url":"https://api.github.com/users/cashmand/followers","following_url":"https://api.github.com/users/cashmand/following{/other_user}","gists_url":"https://api.github.com/users/cashmand/gists{/gist_id}","starred_url":"https://api.github.com/users/cashmand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cashmand/subscriptions","organizations_url":"https://api.github.com/users/cashmand/orgs","repos_url":"https://api.github.com/users/cashmand/repos","events_url":"https://api.github.com/users/cashmand/events{/privacy}","received_events_url":"https://api.github.com/users/cashmand/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n\r\nA debug message added in https://github.com/apache/spark/pull/49234 was missing a brace. As a result, the message was printing the non-pretty string representation of the struct, followed by the string `.prettyJson}`. This PR fixes it.\r\n\r\n### Why are the changes needed?\r\n\r\nCleaner debug messages.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nManually verified in spark-shell that the message looks wrong without the change, and correct with the change.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2025-01-02T19:07:12Z","updated_at":"2025-01-03T01:10:48Z","closed_at":"2025-01-03T01:10:48Z","merged_at":null,"merge_commit_sha":"4b15c03ffb906ba91c9d824f78ac2aa970e6641d","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49345/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49345/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49345/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e214666b92c05722d938b62bb9b6609e6463448d","head":{"label":"cashmand:fix_debug_msg","ref":"fix_debug_msg","sha":"e214666b92c05722d938b62bb9b6609e6463448d","user":{"login":"cashmand","id":54722026,"node_id":"MDQ6VXNlcjU0NzIyMDI2","avatar_url":"https://avatars.githubusercontent.com/u/54722026?v=4","gravatar_id":"","url":"https://api.github.com/users/cashmand","html_url":"https://github.com/cashmand","followers_url":"https://api.github.com/users/cashmand/followers","following_url":"https://api.github.com/users/cashmand/following{/other_user}","gists_url":"https://api.github.com/users/cashmand/gists{/gist_id}","starred_url":"https://api.github.com/users/cashmand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cashmand/subscriptions","organizations_url":"https://api.github.com/users/cashmand/orgs","repos_url":"https://api.github.com/users/cashmand/repos","events_url":"https://api.github.com/users/cashmand/events{/privacy}","received_events_url":"https://api.github.com/users/cashmand/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":469837514,"node_id":"R_kgDOHAEmyg","name":"spark","full_name":"cashmand/spark","private":false,"owner":{"login":"cashmand","id":54722026,"node_id":"MDQ6VXNlcjU0NzIyMDI2","avatar_url":"https://avatars.githubusercontent.com/u/54722026?v=4","gravatar_id":"","url":"https://api.github.com/users/cashmand","html_url":"https://github.com/cashmand","followers_url":"https://api.github.com/users/cashmand/followers","following_url":"https://api.github.com/users/cashmand/following{/other_user}","gists_url":"https://api.github.com/users/cashmand/gists{/gist_id}","starred_url":"https://api.github.com/users/cashmand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cashmand/subscriptions","organizations_url":"https://api.github.com/users/cashmand/orgs","repos_url":"https://api.github.com/users/cashmand/repos","events_url":"https://api.github.com/users/cashmand/events{/privacy}","received_events_url":"https://api.github.com/users/cashmand/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cashmand/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/cashmand/spark","forks_url":"https://api.github.com/repos/cashmand/spark/forks","keys_url":"https://api.github.com/repos/cashmand/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cashmand/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cashmand/spark/teams","hooks_url":"https://api.github.com/repos/cashmand/spark/hooks","issue_events_url":"https://api.github.com/repos/cashmand/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cashmand/spark/events","assignees_url":"https://api.github.com/repos/cashmand/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cashmand/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cashmand/spark/tags","blobs_url":"https://api.github.com/repos/cashmand/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cashmand/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cashmand/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cashmand/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cashmand/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cashmand/spark/languages","stargazers_url":"https://api.github.com/repos/cashmand/spark/stargazers","contributors_url":"https://api.github.com/repos/cashmand/spark/contributors","subscribers_url":"https://api.github.com/repos/cashmand/spark/subscribers","subscription_url":"https://api.github.com/repos/cashmand/spark/subscription","commits_url":"https://api.github.com/repos/cashmand/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cashmand/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cashmand/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cashmand/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cashmand/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cashmand/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cashmand/spark/merges","archive_url":"https://api.github.com/repos/cashmand/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cashmand/spark/downloads","issues_url":"https://api.github.com/repos/cashmand/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cashmand/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cashmand/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cashmand/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cashmand/spark/labels{/name}","releases_url":"https://api.github.com/repos/cashmand/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cashmand/spark/deployments","created_at":"2022-03-14T17:28:00Z","updated_at":"2023-01-23T21:24:49Z","pushed_at":"2025-01-03T18:17:55Z","git_url":"git://github.com/cashmand/spark.git","ssh_url":"git@github.com:cashmand/spark.git","clone_url":"https://github.com/cashmand/spark.git","svn_url":"https://github.com/cashmand/spark","homepage":"https://spark.apache.org/","size":461006,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"c374c00432bd28b98b7623481b7985aa7bc7624a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49345"},"html":{"href":"https://github.com/apache/spark/pull/49345"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49345"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49345/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49345/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49345/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e214666b92c05722d938b62bb9b6609e6463448d"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49344","id":2257357153,"node_id":"PR_kwDOAQXtWs6GjIlh","html_url":"https://github.com/apache/spark/pull/49344","diff_url":"https://github.com/apache/spark/pull/49344.diff","patch_url":"https://github.com/apache/spark/pull/49344.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49344","number":49344,"state":"closed","locked":false,"title":"[SPARK-50711][PS][DOCS] Upgrade the minimum version of Pandas in PS to 2.2.0","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n\r\n### What changes were proposed in this pull request?\r\nUpgrade the minimum version of Pandas in PS to 2.2.0\r\n\r\nBut the version used in `require_minimum_pandas_version` is still 2.0.0, because currently this function is used in both PS and non-PS modules.\r\n\r\n### Why are the changes needed?\r\nActually, PS with Pandas < 2.2.0 has already been broken in master branch\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo, doc-only\r\n\r\n\r\n### How was this patch tested?\r\nCI\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2025-01-02T04:34:55Z","updated_at":"2025-01-02T08:43:46Z","closed_at":"2025-01-02T08:43:21Z","merged_at":null,"merge_commit_sha":"f4a2c087024842a5643a67c7f4b8faca01b7520c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49344/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49344/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49344/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ee288a8ef57116b842445245e0736b5ec044aa17","head":{"label":"zhengruifeng:ps_pd_mini","ref":"ps_pd_mini","sha":"ee288a8ef57116b842445245e0736b5ec044aa17","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"721a41794e113c4372598ceb5e8176f73c911764","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49344"},"html":{"href":"https://github.com/apache/spark/pull/49344"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49344"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49344/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49344/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49344/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ee288a8ef57116b842445245e0736b5ec044aa17"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49343","id":2257355743,"node_id":"PR_kwDOAQXtWs6GjIPf","html_url":"https://github.com/apache/spark/pull/49343","diff_url":"https://github.com/apache/spark/pull/49343.diff","patch_url":"https://github.com/apache/spark/pull/49343.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49343","number":49343,"state":"closed","locked":false,"title":"[SPARK-50712][INFRA][PS][TESTS] Add a daily build for Pandas API on Spark with old dependencies","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nAdd a daily build for Pandas API on Spark with old dependencies\r\n\r\n### Why are the changes needed?\r\nThe PS part requires a newer version of Pandas\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo, infra-only\r\n\r\n\r\n### How was this patch tested?\r\nPR builder with \r\n```\r\ndefault: '{\"PYSPARK_IMAGE_TO_TEST\": \"python-ps-minimum\", \"PYTHON_TO_TEST\": \"python3.9\"}'\r\n\r\ndefault: '{\"pyspark\": \"true\", \"pyspark-pandas\": \"true\"}'\r\n```\r\n\r\nhttps://github.com/zhengruifeng/spark/runs/35054863846\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\n","created_at":"2025-01-02T04:31:46Z","updated_at":"2025-01-02T08:45:09Z","closed_at":"2025-01-02T08:44:30Z","merged_at":null,"merge_commit_sha":"22d391c5b2fc3577d4d15d6e10e8032ee8fccf8e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1982110661,"node_id":"MDU6TGFiZWwxOTgyMTEwNjYx","url":"https://api.github.com/repos/apache/spark/labels/INFRA","name":"INFRA","color":"ededed","default":false,"description":null},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4138679613,"node_id":"LA_kwDOAQXtWs72rz09","url":"https://api.github.com/repos/apache/spark/labels/PANDAS%20API%20ON%20SPARK","name":"PANDAS API ON SPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49343/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49343/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49343/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/61ccd18775270201b85874d4f37cc1d68b2b1bfc","head":{"label":"zhengruifeng:infra_ps_mini","ref":"infra_ps_mini","sha":"61ccd18775270201b85874d4f37cc1d68b2b1bfc","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"721a41794e113c4372598ceb5e8176f73c911764","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49343"},"html":{"href":"https://github.com/apache/spark/pull/49343"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49343"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49343/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49343/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49343/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/61ccd18775270201b85874d4f37cc1d68b2b1bfc"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49342","id":2257015365,"node_id":"PR_kwDOAQXtWs6Gh1JF","html_url":"https://github.com/apache/spark/pull/49342","diff_url":"https://github.com/apache/spark/pull/49342.diff","patch_url":"https://github.com/apache/spark/pull/49342.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49342","number":49342,"state":"closed","locked":false,"title":"[SPARK-50710][CONNECT] Add support for optional client reconnection to sessions after release ","user":{"login":"vicennial","id":21010250,"node_id":"MDQ6VXNlcjIxMDEwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/21010250?v=4","gravatar_id":"","url":"https://api.github.com/users/vicennial","html_url":"https://github.com/vicennial","followers_url":"https://api.github.com/users/vicennial/followers","following_url":"https://api.github.com/users/vicennial/following{/other_user}","gists_url":"https://api.github.com/users/vicennial/gists{/gist_id}","starred_url":"https://api.github.com/users/vicennial/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vicennial/subscriptions","organizations_url":"https://api.github.com/users/vicennial/orgs","repos_url":"https://api.github.com/users/vicennial/repos","events_url":"https://api.github.com/users/vicennial/events{/privacy}","received_events_url":"https://api.github.com/users/vicennial/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nAdds a new boolean `allow_reconnect` field to `ReleaseSessionRequest`.\r\nWhen set to `true` in the request, the server will not place the session in the `closedSessionsCache` of `SparkConnectSessionManager`. \r\nThe session's clean-up process is unmodified.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCurrently, the connect server will, by default, tombstone all sessions that have either been released explicitly (through a `ReleaseSession` request) or cleaned up due to inactivity/idleness in periodic checks.\r\n\r\nTombstoning prevents clients from reconnecting with the same `userId` and `sessionId`. This mechanism ensures that clients do not accidentally end up with a 'fresh' server-side session, which may be disastrous/fatal as all previously held state is lost (e.g., Temporary views, temporary UDFs, modified configs, current catalog, etc.).\r\n\r\n \r\n\r\nConsider a client that runs simple non-state dependant queries (e.g `select count from ...`), perhaps sparsely during the lifetime of the application. Such a client may prefer to opt out of tombstoning for the following reasons:\r\n\r\n- Queries do not depend on any custom server-side state.\r\n- Modifying `userId`/`sessionId` on each reconnect may be inconvenient for tracking/observability purposes. \r\n- On resource-constrained servers, clients may want to minimize their memory footprint by explicitly releasing their state, especially when they believe their requests are sparsely spread out.\r\n  \r\n\r\nCurrently, the only way to allow clients to reconnect is to set `spark.connect.session.manager.closedSessionsTombstonesSize` to `0`. However, this is not ideal as it would allow all clients to reconnect, which as previously pointed out, may be dangerous.\r\n \r\nAs an improvement, allowing specific clients to explicitly signal/request the reconnection possibility addresses the needs mentioned earlier.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nYes. \r\n\r\nWhen the client releases a session with `allow_reconnect` set to `true`, a reconnection will lead to the server generation a fresh session and not result in an error like `[INVALID_HANDLE.SESSION_CLOSED] The handle 271dab46-a9a0-4458-ad3a-71442eaa9a21 is invalid. Session was closed. SQLSTATE: HY000`\r\n\r\nFull example (gRPC based):\r\n\r\n#### Default/`allow_reconnect` set to `false`\r\n\r\nCreate a session via a `Config` request:\r\n```gRPC\r\n{\r\n    \"operation\": {\r\n        \"get\": {\r\n            \"keys\": [\"spark.sql.ansi.enabled\"]\r\n        }\r\n    },\r\n    \"session_id\": \"271dab46-a9a0-4458-ad3a-71442eaa9a21\",\r\n    \"user_context\": {\r\n        \"user_id\": \"vicennial\",\r\n        \"user_name\": \"Akhil\"\r\n    }\r\n}\r\n```\r\n\r\nRelease session via `ReleaseSession` request:\r\n```\r\n{\r\n    \"session_id\": \"271dab46-a9a0-4458-ad3a-71442eaa9a21\",\r\n    \"user_context\": {\r\n        \"user_id\": \"vicennial\",\r\n        \"user_name\": \"Akhil\"\r\n    },\r\n    \"allow_reconnect\": false\r\n}\r\n```\r\n\r\nRetry the earlier config request, the error `[INVALID_HANDLE.SESSION_CLOSED] The handle 271dab46-a9a0-4458-ad3a-71442eaa9a21 is invalid. Session was closed. SQLSTATE: HY000` is hit.\r\n\r\n\r\n#### Default/`allow_reconnect` set to `true`\r\nCreate a session via a `Config` request:\r\n```gRPC\r\n{\r\n    \"operation\": {\r\n        \"get\": {\r\n            \"keys\": [\"spark.sql.ansi.enabled\"]\r\n        }\r\n    },\r\n    \"session_id\": \"ff1410b9-0a75-4634-820a-b46c14f30896\",\r\n    \"user_context\": {\r\n        \"user_id\": \"vicennial\",\r\n        \"user_name\": \"Akhil\"\r\n    }\r\n}\r\n```\r\n\r\nRelease session via `ReleaseSession` request:\r\n```\r\n{\r\n    \"session_id\": \"ff1410b9-0a75-4634-820a-b46c14f30896\",\r\n    \"user_context\": {\r\n        \"user_id\": \"vicennial\",\r\n        \"user_name\": \"Akhil\"\r\n    },\r\n    \"allow_reconnect\": true\r\n}\r\n```\r\n\r\nRetry the earlier config request, the request goes through and it can be noted the `server_side_session_id` in the response of the last config request is different from the first one as a new server side session was generated.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nNew unit test + existing tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nNo.","created_at":"2025-01-01T11:53:45Z","updated_at":"2025-01-03T00:13:02Z","closed_at":"2025-01-03T00:13:02Z","merged_at":null,"merge_commit_sha":"64ccdf5404d7d63f40fd25286326be3f26de877b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49342/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49342/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49342/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c0dce1d44dc3e0f61a8297c5e31ea974d2cad50a","head":{"label":"vicennial:allowReconnect","ref":"allowReconnect","sha":"c0dce1d44dc3e0f61a8297c5e31ea974d2cad50a","user":{"login":"vicennial","id":21010250,"node_id":"MDQ6VXNlcjIxMDEwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/21010250?v=4","gravatar_id":"","url":"https://api.github.com/users/vicennial","html_url":"https://github.com/vicennial","followers_url":"https://api.github.com/users/vicennial/followers","following_url":"https://api.github.com/users/vicennial/following{/other_user}","gists_url":"https://api.github.com/users/vicennial/gists{/gist_id}","starred_url":"https://api.github.com/users/vicennial/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vicennial/subscriptions","organizations_url":"https://api.github.com/users/vicennial/orgs","repos_url":"https://api.github.com/users/vicennial/repos","events_url":"https://api.github.com/users/vicennial/events{/privacy}","received_events_url":"https://api.github.com/users/vicennial/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":402021456,"node_id":"MDEwOlJlcG9zaXRvcnk0MDIwMjE0NTY=","name":"spark","full_name":"vicennial/spark","private":false,"owner":{"login":"vicennial","id":21010250,"node_id":"MDQ6VXNlcjIxMDEwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/21010250?v=4","gravatar_id":"","url":"https://api.github.com/users/vicennial","html_url":"https://github.com/vicennial","followers_url":"https://api.github.com/users/vicennial/followers","following_url":"https://api.github.com/users/vicennial/following{/other_user}","gists_url":"https://api.github.com/users/vicennial/gists{/gist_id}","starred_url":"https://api.github.com/users/vicennial/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vicennial/subscriptions","organizations_url":"https://api.github.com/users/vicennial/orgs","repos_url":"https://api.github.com/users/vicennial/repos","events_url":"https://api.github.com/users/vicennial/events{/privacy}","received_events_url":"https://api.github.com/users/vicennial/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vicennial/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/vicennial/spark","forks_url":"https://api.github.com/repos/vicennial/spark/forks","keys_url":"https://api.github.com/repos/vicennial/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vicennial/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vicennial/spark/teams","hooks_url":"https://api.github.com/repos/vicennial/spark/hooks","issue_events_url":"https://api.github.com/repos/vicennial/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vicennial/spark/events","assignees_url":"https://api.github.com/repos/vicennial/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vicennial/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vicennial/spark/tags","blobs_url":"https://api.github.com/repos/vicennial/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vicennial/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vicennial/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vicennial/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vicennial/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vicennial/spark/languages","stargazers_url":"https://api.github.com/repos/vicennial/spark/stargazers","contributors_url":"https://api.github.com/repos/vicennial/spark/contributors","subscribers_url":"https://api.github.com/repos/vicennial/spark/subscribers","subscription_url":"https://api.github.com/repos/vicennial/spark/subscription","commits_url":"https://api.github.com/repos/vicennial/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vicennial/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vicennial/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vicennial/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vicennial/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vicennial/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vicennial/spark/merges","archive_url":"https://api.github.com/repos/vicennial/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vicennial/spark/downloads","issues_url":"https://api.github.com/repos/vicennial/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vicennial/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vicennial/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vicennial/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vicennial/spark/labels{/name}","releases_url":"https://api.github.com/repos/vicennial/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vicennial/spark/deployments","created_at":"2021-09-01T10:32:35Z","updated_at":"2022-11-28T12:17:58Z","pushed_at":"2025-02-07T09:29:37Z","git_url":"git://github.com/vicennial/spark.git","ssh_url":"git@github.com:vicennial/spark.git","clone_url":"https://github.com/vicennial/spark.git","svn_url":"https://github.com/vicennial/spark","homepage":"https://spark.apache.org/","size":466428,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1c79b54ac9346fd25a5b1732675a308425e190e3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49342"},"html":{"href":"https://github.com/apache/spark/pull/49342"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49342"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49342/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49342/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49342/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c0dce1d44dc3e0f61a8297c5e31ea974d2cad50a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49341","id":2256388840,"node_id":"PR_kwDOAQXtWs6GfcLo","html_url":"https://github.com/apache/spark/pull/49341","diff_url":"https://github.com/apache/spark/pull/49341.diff","patch_url":"https://github.com/apache/spark/pull/49341.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49341","number":49341,"state":"closed","locked":false,"title":"[SPARK-50708][CONNECT] Delete Artifact resources on GC of `ArtifactManager` instance","user":{"login":"vicennial","id":21010250,"node_id":"MDQ6VXNlcjIxMDEwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/21010250?v=4","gravatar_id":"","url":"https://api.github.com/users/vicennial","html_url":"https://github.com/vicennial","followers_url":"https://api.github.com/users/vicennial/followers","following_url":"https://api.github.com/users/vicennial/following{/other_user}","gists_url":"https://api.github.com/users/vicennial/gists{/gist_id}","starred_url":"https://api.github.com/users/vicennial/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vicennial/subscriptions","organizations_url":"https://api.github.com/users/vicennial/orgs","repos_url":"https://api.github.com/users/vicennial/repos","events_url":"https://api.github.com/users/vicennial/events{/privacy}","received_events_url":"https://api.github.com/users/vicennial/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nRegisters a `java.lang.ref.Cleaner` for `ArtifactManager`. `ArtifactManager#cleanUpResources` is further made thread-safe and swallows FileSystem exceptions in order to let the remaining cleanup go through.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCurrently, an instance of ArtifactManager's resources isn't cleaned up automatically during its GC. Previously, Artifact Manager was only used in Spark Connect, where its lifetime was controlled by the Spark Connect Session which would manually call `ArtifactManager#cleanUpResources` when it itself is closed.\r\n\r\nWith the recent changes allowing the artifact manager to be used in 'Classic Spark', we should GC related resources when the SparkSession gets GCed (and thus, the ArtifactManager instance is no longer reachable)\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nNo.","created_at":"2024-12-31T11:59:13Z","updated_at":"2025-01-06T14:10:50Z","closed_at":"2025-01-06T10:33:14Z","merged_at":null,"merge_commit_sha":"3de1c0b7303fd1b2f41d5b66f8e244a027ea6e5b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49341/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49341/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49341/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/570dbcfb9210c9c4eeb464986ed038791e2f294d","head":{"label":"vicennial:artifactGC","ref":"artifactGC","sha":"570dbcfb9210c9c4eeb464986ed038791e2f294d","user":{"login":"vicennial","id":21010250,"node_id":"MDQ6VXNlcjIxMDEwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/21010250?v=4","gravatar_id":"","url":"https://api.github.com/users/vicennial","html_url":"https://github.com/vicennial","followers_url":"https://api.github.com/users/vicennial/followers","following_url":"https://api.github.com/users/vicennial/following{/other_user}","gists_url":"https://api.github.com/users/vicennial/gists{/gist_id}","starred_url":"https://api.github.com/users/vicennial/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vicennial/subscriptions","organizations_url":"https://api.github.com/users/vicennial/orgs","repos_url":"https://api.github.com/users/vicennial/repos","events_url":"https://api.github.com/users/vicennial/events{/privacy}","received_events_url":"https://api.github.com/users/vicennial/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":402021456,"node_id":"MDEwOlJlcG9zaXRvcnk0MDIwMjE0NTY=","name":"spark","full_name":"vicennial/spark","private":false,"owner":{"login":"vicennial","id":21010250,"node_id":"MDQ6VXNlcjIxMDEwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/21010250?v=4","gravatar_id":"","url":"https://api.github.com/users/vicennial","html_url":"https://github.com/vicennial","followers_url":"https://api.github.com/users/vicennial/followers","following_url":"https://api.github.com/users/vicennial/following{/other_user}","gists_url":"https://api.github.com/users/vicennial/gists{/gist_id}","starred_url":"https://api.github.com/users/vicennial/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vicennial/subscriptions","organizations_url":"https://api.github.com/users/vicennial/orgs","repos_url":"https://api.github.com/users/vicennial/repos","events_url":"https://api.github.com/users/vicennial/events{/privacy}","received_events_url":"https://api.github.com/users/vicennial/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vicennial/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/vicennial/spark","forks_url":"https://api.github.com/repos/vicennial/spark/forks","keys_url":"https://api.github.com/repos/vicennial/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vicennial/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vicennial/spark/teams","hooks_url":"https://api.github.com/repos/vicennial/spark/hooks","issue_events_url":"https://api.github.com/repos/vicennial/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vicennial/spark/events","assignees_url":"https://api.github.com/repos/vicennial/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vicennial/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vicennial/spark/tags","blobs_url":"https://api.github.com/repos/vicennial/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vicennial/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vicennial/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vicennial/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vicennial/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vicennial/spark/languages","stargazers_url":"https://api.github.com/repos/vicennial/spark/stargazers","contributors_url":"https://api.github.com/repos/vicennial/spark/contributors","subscribers_url":"https://api.github.com/repos/vicennial/spark/subscribers","subscription_url":"https://api.github.com/repos/vicennial/spark/subscription","commits_url":"https://api.github.com/repos/vicennial/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vicennial/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vicennial/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vicennial/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vicennial/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vicennial/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vicennial/spark/merges","archive_url":"https://api.github.com/repos/vicennial/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vicennial/spark/downloads","issues_url":"https://api.github.com/repos/vicennial/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vicennial/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vicennial/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vicennial/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vicennial/spark/labels{/name}","releases_url":"https://api.github.com/repos/vicennial/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vicennial/spark/deployments","created_at":"2021-09-01T10:32:35Z","updated_at":"2022-11-28T12:17:58Z","pushed_at":"2025-02-07T09:29:37Z","git_url":"git://github.com/vicennial/spark.git","ssh_url":"git@github.com:vicennial/spark.git","clone_url":"https://github.com/vicennial/spark.git","svn_url":"https://github.com/vicennial/spark","homepage":"https://spark.apache.org/","size":466428,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"e1fb18d7a3d41c01eae46b79a08670d878bbbbd6","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49341"},"html":{"href":"https://github.com/apache/spark/pull/49341"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49341"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49341/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49341/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49341/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/570dbcfb9210c9c4eeb464986ed038791e2f294d"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49340","id":2256340428,"node_id":"PR_kwDOAQXtWs6GfQXM","html_url":"https://github.com/apache/spark/pull/49340","diff_url":"https://github.com/apache/spark/pull/49340.diff","patch_url":"https://github.com/apache/spark/pull/49340.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49340","number":49340,"state":"closed","locked":false,"title":"[SPARK-50707][SQL] Enable casting to/from char/varchar","user":{"login":"jovanm-db","id":184946754,"node_id":"U_kgDOCwYQQg","avatar_url":"https://avatars.githubusercontent.com/u/184946754?v=4","gravatar_id":"","url":"https://api.github.com/users/jovanm-db","html_url":"https://github.com/jovanm-db","followers_url":"https://api.github.com/users/jovanm-db/followers","following_url":"https://api.github.com/users/jovanm-db/following{/other_user}","gists_url":"https://api.github.com/users/jovanm-db/gists{/gist_id}","starred_url":"https://api.github.com/users/jovanm-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jovanm-db/subscriptions","organizations_url":"https://api.github.com/users/jovanm-db/orgs","repos_url":"https://api.github.com/users/jovanm-db/repos","events_url":"https://api.github.com/users/jovanm-db/events{/privacy}","received_events_url":"https://api.github.com/users/jovanm-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nEnable casting to/from char/varchar.\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\nCurrently `cast` does not work correctly. It always casts to `StringType`. This PR enables casting to `CharType` and `VarcharType`. This only applies when `spark.sql.preserveCharVarcharTypeInfo` is set to `true`. \r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo. \r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\nAdded tests in:\r\n- `CharVarcharTestSuite`\r\n- `CastSuiteBase`\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo. \r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\n","created_at":"2024-12-31T10:58:13Z","updated_at":"2025-01-12T20:39:44Z","closed_at":"2025-01-10T13:26:52Z","merged_at":null,"merge_commit_sha":"e3cd3d800d555db2f6fdfd78daef2445749589f7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49340/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49340/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49340/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/dbebe153896c261eecbff88c1561dce1480a69be","head":{"label":"jovanm-db:char_varchar_cast","ref":"char_varchar_cast","sha":"dbebe153896c261eecbff88c1561dce1480a69be","user":{"login":"jovanm-db","id":184946754,"node_id":"U_kgDOCwYQQg","avatar_url":"https://avatars.githubusercontent.com/u/184946754?v=4","gravatar_id":"","url":"https://api.github.com/users/jovanm-db","html_url":"https://github.com/jovanm-db","followers_url":"https://api.github.com/users/jovanm-db/followers","following_url":"https://api.github.com/users/jovanm-db/following{/other_user}","gists_url":"https://api.github.com/users/jovanm-db/gists{/gist_id}","starred_url":"https://api.github.com/users/jovanm-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jovanm-db/subscriptions","organizations_url":"https://api.github.com/users/jovanm-db/orgs","repos_url":"https://api.github.com/users/jovanm-db/repos","events_url":"https://api.github.com/users/jovanm-db/events{/privacy}","received_events_url":"https://api.github.com/users/jovanm-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":873523318,"node_id":"R_kgDONBDodg","name":"spark","full_name":"jovanm-db/spark","private":false,"owner":{"login":"jovanm-db","id":184946754,"node_id":"U_kgDOCwYQQg","avatar_url":"https://avatars.githubusercontent.com/u/184946754?v=4","gravatar_id":"","url":"https://api.github.com/users/jovanm-db","html_url":"https://github.com/jovanm-db","followers_url":"https://api.github.com/users/jovanm-db/followers","following_url":"https://api.github.com/users/jovanm-db/following{/other_user}","gists_url":"https://api.github.com/users/jovanm-db/gists{/gist_id}","starred_url":"https://api.github.com/users/jovanm-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jovanm-db/subscriptions","organizations_url":"https://api.github.com/users/jovanm-db/orgs","repos_url":"https://api.github.com/users/jovanm-db/repos","events_url":"https://api.github.com/users/jovanm-db/events{/privacy}","received_events_url":"https://api.github.com/users/jovanm-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/jovanm-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/jovanm-db/spark","forks_url":"https://api.github.com/repos/jovanm-db/spark/forks","keys_url":"https://api.github.com/repos/jovanm-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/jovanm-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/jovanm-db/spark/teams","hooks_url":"https://api.github.com/repos/jovanm-db/spark/hooks","issue_events_url":"https://api.github.com/repos/jovanm-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/jovanm-db/spark/events","assignees_url":"https://api.github.com/repos/jovanm-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/jovanm-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/jovanm-db/spark/tags","blobs_url":"https://api.github.com/repos/jovanm-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/jovanm-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/jovanm-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/jovanm-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/jovanm-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/jovanm-db/spark/languages","stargazers_url":"https://api.github.com/repos/jovanm-db/spark/stargazers","contributors_url":"https://api.github.com/repos/jovanm-db/spark/contributors","subscribers_url":"https://api.github.com/repos/jovanm-db/spark/subscribers","subscription_url":"https://api.github.com/repos/jovanm-db/spark/subscription","commits_url":"https://api.github.com/repos/jovanm-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/jovanm-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/jovanm-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/jovanm-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/jovanm-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/jovanm-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/jovanm-db/spark/merges","archive_url":"https://api.github.com/repos/jovanm-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/jovanm-db/spark/downloads","issues_url":"https://api.github.com/repos/jovanm-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/jovanm-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/jovanm-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/jovanm-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/jovanm-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/jovanm-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/jovanm-db/spark/deployments","created_at":"2024-10-16T10:04:50Z","updated_at":"2025-01-31T15:09:15Z","pushed_at":"2025-01-31T15:10:04Z","git_url":"git://github.com/jovanm-db/spark.git","ssh_url":"git@github.com:jovanm-db/spark.git","clone_url":"https://github.com/jovanm-db/spark.git","svn_url":"https://github.com/jovanm-db/spark","homepage":"https://spark.apache.org/","size":422699,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"ceb7583ed394989b8d1f14350bce58a2d291acd8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49340"},"html":{"href":"https://github.com/apache/spark/pull/49340"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49340"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49340/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49340/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49340/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/dbebe153896c261eecbff88c1561dce1480a69be"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49339","id":2256325886,"node_id":"PR_kwDOAQXtWs6GfMz-","html_url":"https://github.com/apache/spark/pull/49339","diff_url":"https://github.com/apache/spark/pull/49339.diff","patch_url":"https://github.com/apache/spark/pull/49339.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49339","number":49339,"state":"open","locked":false,"title":"[SPARK-49230][Connect][SQL] Do not return UnboundRowEncoder when not needed","user":{"login":"xupefei","id":1687847,"node_id":"MDQ6VXNlcjE2ODc4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1687847?v=4","gravatar_id":"","url":"https://api.github.com/users/xupefei","html_url":"https://github.com/xupefei","followers_url":"https://api.github.com/users/xupefei/followers","following_url":"https://api.github.com/users/xupefei/following{/other_user}","gists_url":"https://api.github.com/users/xupefei/gists{/gist_id}","starred_url":"https://api.github.com/users/xupefei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xupefei/subscriptions","organizations_url":"https://api.github.com/users/xupefei/orgs","repos_url":"https://api.github.com/users/xupefei/repos","events_url":"https://api.github.com/users/xupefei/events{/privacy}","received_events_url":"https://api.github.com/users/xupefei/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR corrects the `isRowEncoderSupported` logic of `encoderFor` method. Now when the flag is off, `encoderFor` method will not return an `UnboundRowEncoder` but instead throws an exception. To get back to the old behaviour, used one of the following two method instead:\r\n\r\n- `encoderFor(..., isRowEncoderSupported = true)`\r\n- `encoderForWithRowEncoderSupport(...)`\r\n\r\nTo avoid breaking existing use cases, this PR changes some calls of `encoderFor` to `encoderForWithRowEncoderSupport` when the input type involves generic `T`, since `T` can be a `Row`.\r\n\r\n### Why are the changes needed?\r\n\r\nCode cleanup.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo. This method is used internally.\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2024-12-31T10:40:39Z","updated_at":"2025-01-30T19:37:47Z","closed_at":null,"merged_at":null,"merge_commit_sha":"7a43faf1fe5b3288a6a36d1a9f235893e2069c97","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49339/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49339/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49339/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f357c611af3a0f6aa342854384eb4a7c2a9d1e3f","head":{"label":"xupefei:no-row-encoder","ref":"no-row-encoder","sha":"f357c611af3a0f6aa342854384eb4a7c2a9d1e3f","user":{"login":"xupefei","id":1687847,"node_id":"MDQ6VXNlcjE2ODc4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1687847?v=4","gravatar_id":"","url":"https://api.github.com/users/xupefei","html_url":"https://github.com/xupefei","followers_url":"https://api.github.com/users/xupefei/followers","following_url":"https://api.github.com/users/xupefei/following{/other_user}","gists_url":"https://api.github.com/users/xupefei/gists{/gist_id}","starred_url":"https://api.github.com/users/xupefei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xupefei/subscriptions","organizations_url":"https://api.github.com/users/xupefei/orgs","repos_url":"https://api.github.com/users/xupefei/repos","events_url":"https://api.github.com/users/xupefei/events{/privacy}","received_events_url":"https://api.github.com/users/xupefei/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":777257207,"node_id":"R_kgDOLlQA9w","name":"spark","full_name":"xupefei/spark","private":false,"owner":{"login":"xupefei","id":1687847,"node_id":"MDQ6VXNlcjE2ODc4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1687847?v=4","gravatar_id":"","url":"https://api.github.com/users/xupefei","html_url":"https://github.com/xupefei","followers_url":"https://api.github.com/users/xupefei/followers","following_url":"https://api.github.com/users/xupefei/following{/other_user}","gists_url":"https://api.github.com/users/xupefei/gists{/gist_id}","starred_url":"https://api.github.com/users/xupefei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xupefei/subscriptions","organizations_url":"https://api.github.com/users/xupefei/orgs","repos_url":"https://api.github.com/users/xupefei/repos","events_url":"https://api.github.com/users/xupefei/events{/privacy}","received_events_url":"https://api.github.com/users/xupefei/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xupefei/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xupefei/spark","forks_url":"https://api.github.com/repos/xupefei/spark/forks","keys_url":"https://api.github.com/repos/xupefei/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xupefei/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xupefei/spark/teams","hooks_url":"https://api.github.com/repos/xupefei/spark/hooks","issue_events_url":"https://api.github.com/repos/xupefei/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xupefei/spark/events","assignees_url":"https://api.github.com/repos/xupefei/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xupefei/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xupefei/spark/tags","blobs_url":"https://api.github.com/repos/xupefei/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xupefei/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xupefei/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xupefei/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xupefei/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xupefei/spark/languages","stargazers_url":"https://api.github.com/repos/xupefei/spark/stargazers","contributors_url":"https://api.github.com/repos/xupefei/spark/contributors","subscribers_url":"https://api.github.com/repos/xupefei/spark/subscribers","subscription_url":"https://api.github.com/repos/xupefei/spark/subscription","commits_url":"https://api.github.com/repos/xupefei/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xupefei/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xupefei/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xupefei/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xupefei/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xupefei/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xupefei/spark/merges","archive_url":"https://api.github.com/repos/xupefei/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xupefei/spark/downloads","issues_url":"https://api.github.com/repos/xupefei/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xupefei/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xupefei/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xupefei/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xupefei/spark/labels{/name}","releases_url":"https://api.github.com/repos/xupefei/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xupefei/spark/deployments","created_at":"2024-03-25T14:06:50Z","updated_at":"2024-11-22T14:19:33Z","pushed_at":"2025-02-06T21:18:51Z","git_url":"git://github.com/xupefei/spark.git","ssh_url":"git@github.com:xupefei/spark.git","clone_url":"https://github.com/xupefei/spark.git","svn_url":"https://github.com/xupefei/spark","homepage":"https://spark.apache.org/","size":420345,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"96adcc442112870f685cd9628fb95add00856d1b","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49339"},"html":{"href":"https://github.com/apache/spark/pull/49339"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49339"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49339/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49339/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49339/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f357c611af3a0f6aa342854384eb4a7c2a9d1e3f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49338","id":2256186995,"node_id":"PR_kwDOAQXtWs6Geq5z","html_url":"https://github.com/apache/spark/pull/49338","diff_url":"https://github.com/apache/spark/pull/49338.diff","patch_url":"https://github.com/apache/spark/pull/49338.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49338","number":49338,"state":"closed","locked":false,"title":"[SPARK-50702][PYTHON] Refine the docstring of regexp_count, regexp_extract and regexp_extract_all","user":{"login":"drexler-sky","id":193304905,"node_id":"U_kgDOC4WZSQ","avatar_url":"https://avatars.githubusercontent.com/u/193304905?v=4","gravatar_id":"","url":"https://api.github.com/users/drexler-sky","html_url":"https://github.com/drexler-sky","followers_url":"https://api.github.com/users/drexler-sky/followers","following_url":"https://api.github.com/users/drexler-sky/following{/other_user}","gists_url":"https://api.github.com/users/drexler-sky/gists{/gist_id}","starred_url":"https://api.github.com/users/drexler-sky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drexler-sky/subscriptions","organizations_url":"https://api.github.com/users/drexler-sky/orgs","repos_url":"https://api.github.com/users/drexler-sky/repos","events_url":"https://api.github.com/users/drexler-sky/events{/privacy}","received_events_url":"https://api.github.com/users/drexler-sky/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n\r\n<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nRefine the docstring for `regexp_count`, `regexp_extract` and `regexp_extract_all`.\r\n\r\n\r\n\r\n### Why are the changes needed?\r\nto improve docs and test coverage\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\ndoc-only changes\r\n\r\n\r\n### How was this patch tested?\r\nnew doctests\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nno\r\n","created_at":"2024-12-31T07:50:20Z","updated_at":"2025-01-03T03:56:41Z","closed_at":"2025-01-02T04:12:32Z","merged_at":null,"merge_commit_sha":"65bc3d71ac4e850d725caa0e92533da69dd00140","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49338/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49338/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49338/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c3568af5181cb8370fe3c949e034e97311f1e3bf","head":{"label":"drexler-sky:docstring","ref":"docstring","sha":"c3568af5181cb8370fe3c949e034e97311f1e3bf","user":{"login":"drexler-sky","id":193304905,"node_id":"U_kgDOC4WZSQ","avatar_url":"https://avatars.githubusercontent.com/u/193304905?v=4","gravatar_id":"","url":"https://api.github.com/users/drexler-sky","html_url":"https://github.com/drexler-sky","followers_url":"https://api.github.com/users/drexler-sky/followers","following_url":"https://api.github.com/users/drexler-sky/following{/other_user}","gists_url":"https://api.github.com/users/drexler-sky/gists{/gist_id}","starred_url":"https://api.github.com/users/drexler-sky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drexler-sky/subscriptions","organizations_url":"https://api.github.com/users/drexler-sky/orgs","repos_url":"https://api.github.com/users/drexler-sky/repos","events_url":"https://api.github.com/users/drexler-sky/events{/privacy}","received_events_url":"https://api.github.com/users/drexler-sky/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":910384156,"node_id":"R_kgDONkNcHA","name":"spark","full_name":"drexler-sky/spark","private":false,"owner":{"login":"drexler-sky","id":193304905,"node_id":"U_kgDOC4WZSQ","avatar_url":"https://avatars.githubusercontent.com/u/193304905?v=4","gravatar_id":"","url":"https://api.github.com/users/drexler-sky","html_url":"https://github.com/drexler-sky","followers_url":"https://api.github.com/users/drexler-sky/followers","following_url":"https://api.github.com/users/drexler-sky/following{/other_user}","gists_url":"https://api.github.com/users/drexler-sky/gists{/gist_id}","starred_url":"https://api.github.com/users/drexler-sky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drexler-sky/subscriptions","organizations_url":"https://api.github.com/users/drexler-sky/orgs","repos_url":"https://api.github.com/users/drexler-sky/repos","events_url":"https://api.github.com/users/drexler-sky/events{/privacy}","received_events_url":"https://api.github.com/users/drexler-sky/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/drexler-sky/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/drexler-sky/spark","forks_url":"https://api.github.com/repos/drexler-sky/spark/forks","keys_url":"https://api.github.com/repos/drexler-sky/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/drexler-sky/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/drexler-sky/spark/teams","hooks_url":"https://api.github.com/repos/drexler-sky/spark/hooks","issue_events_url":"https://api.github.com/repos/drexler-sky/spark/issues/events{/number}","events_url":"https://api.github.com/repos/drexler-sky/spark/events","assignees_url":"https://api.github.com/repos/drexler-sky/spark/assignees{/user}","branches_url":"https://api.github.com/repos/drexler-sky/spark/branches{/branch}","tags_url":"https://api.github.com/repos/drexler-sky/spark/tags","blobs_url":"https://api.github.com/repos/drexler-sky/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/drexler-sky/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/drexler-sky/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/drexler-sky/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/drexler-sky/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/drexler-sky/spark/languages","stargazers_url":"https://api.github.com/repos/drexler-sky/spark/stargazers","contributors_url":"https://api.github.com/repos/drexler-sky/spark/contributors","subscribers_url":"https://api.github.com/repos/drexler-sky/spark/subscribers","subscription_url":"https://api.github.com/repos/drexler-sky/spark/subscription","commits_url":"https://api.github.com/repos/drexler-sky/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/drexler-sky/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/drexler-sky/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/drexler-sky/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/drexler-sky/spark/contents/{+path}","compare_url":"https://api.github.com/repos/drexler-sky/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/drexler-sky/spark/merges","archive_url":"https://api.github.com/repos/drexler-sky/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/drexler-sky/spark/downloads","issues_url":"https://api.github.com/repos/drexler-sky/spark/issues{/number}","pulls_url":"https://api.github.com/repos/drexler-sky/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/drexler-sky/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/drexler-sky/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/drexler-sky/spark/labels{/name}","releases_url":"https://api.github.com/repos/drexler-sky/spark/releases{/id}","deployments_url":"https://api.github.com/repos/drexler-sky/spark/deployments","created_at":"2024-12-31T06:10:04Z","updated_at":"2024-12-31T06:10:04Z","pushed_at":"2025-01-14T01:19:12Z","git_url":"git://github.com/drexler-sky/spark.git","ssh_url":"git@github.com:drexler-sky/spark.git","clone_url":"https://github.com/drexler-sky/spark.git","svn_url":"https://github.com/drexler-sky/spark","homepage":"https://spark.apache.org/","size":419545,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"8a09817bf94892bf0e946e414f1d54d1ebad5f35","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49338"},"html":{"href":"https://github.com/apache/spark/pull/49338"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49338"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49338/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49338/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49338/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c3568af5181cb8370fe3c949e034e97311f1e3bf"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49337","id":2256097045,"node_id":"PR_kwDOAQXtWs6GeU8V","html_url":"https://github.com/apache/spark/pull/49337","diff_url":"https://github.com/apache/spark/pull/49337.diff","patch_url":"https://github.com/apache/spark/pull/49337.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49337","number":49337,"state":"closed","locked":false,"title":"[SPARK-50706][PYTHON][TESTS] Skip test_value_state_ttl_expiration in Coverage build","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to skip `test_value_state_ttl_expiration` in Coverage build for now.\r\n\r\n### Why are the changes needed?\r\n\r\nTo make the build passing for now. It fails when the Coverage is on (https://github.com/apache/spark/actions/runs/12544995465/job/34978553717):\r\n\r\n```\r\n======================================================================\r\nERROR [12.848s]: test_value_state_ttl_expiration (pyspark.sql.tests.pandas.test_pandas_transform_with_state.TransformWithStateInPandasTests.test_value_state_ttl_expiration)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/__w/spark/spark/python/pyspark/sql/tests/pandas/test_pandas_transform_with_state.py\", line 403, in test_value_state_ttl_expiration\r\n    q.processAllAvailable()\r\n  File \"/__w/spark/spark/python/pyspark/sql/streaming/query.py\", line 351, in processAllAvailable\r\n    return self._jsq.processAllAvailable()\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/__w/spark/spark/python/lib/py4j-0.10.9.8-src.zip/py4j/java_gateway.py\", line 1355, in __call__\r\n    return_value = get_return_value(\r\n                   ^^^^^^^^^^^^^^^^^\r\n  File \"/__w/spark/spark/python/pyspark/errors/exceptions/captured.py\", line 253, in deco\r\n    raise converted from None\r\npyspark.errors.exceptions.captured.StreamingQueryException: [STREAM_FAILED] Query [id = 623e9008-52cb-4b9d-9343-432e7bd855bb, runId = cc06b909-37fd-4acd-98ff-8809b9df92c7] terminated with exception: [FOREACH_BATCH_USER_FUNCTION_ERROR] An error occurred in the user provided function in foreach batch sink. Reason: An exception was raised by the Python Proxy. Return Message: Traceback (most recent call last):\r\n  File \"/__w/spark/spark/python/lib/py4j-0.10.9.8-src.zip/py4j/clientserver.py\", line 641, in _call_proxy\r\n    return_value = getattr(self.pool[obj_id], method)(*params)\r\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/__w/spark/spark/python/pyspark/sql/utils.py\", line 157, in call\r\n    raise e\r\n  File \"/__w/spark/spark/python/pyspark/sql/utils.py\", line 154, in call\r\n    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)\r\n  File \"/__w/spark/spark/python/pyspark/sql/tests/pandas/test_pandas_transform_with_state.py\", line 334, in check_results\r\n    assertDataFrameEqual(\r\n  File \"/__w/spark/spark/python/pyspark/testing/utils.py\", line 1074, in assertDataFrameEqual\r\n    assert_rows_equal(actual_list, expected_list, maxErrors=maxErrors, showOnlyDiff=showOnlyDiff)\r\n  File \"/__w/spark/spark/python/pyspark/testing/utils.py\", line 1030, in assert_rows_equal\r\n    raise PySparkAssertionError(\r\npyspark.errors.exceptions.base.PySparkAssertionError: [DIFFERENT_ROWS] Results do not match: ( 75.00000 % )\r\n*** actual ***\r\n  Row(id='count-0', count=2)\r\n  Row(id='count-1', count=2)\r\n! Row(id='ttl-count-0', count=1)\r\n! Row(id='ttl-count-1', count=1)\r\n! Row(id='ttl-list-state-count-0', count=1)\r\n! Row(id='ttl-list-state-count-1', count=1)\r\n! Row(id='ttl-map-state-count-0', count=1)\r\n! Row(id='ttl-map-state-count-1', count=1)\r\n\r\n\r\n*** expected ***\r\n  Row(id='count-0', count=2)\r\n  Row(id='count-1', count=2)\r\n! Row(id='ttl-count-0', count=2)\r\n! Row(id='ttl-count-1', count=2)\r\n! Row(id='ttl-list-state-count-0', count=3)\r\n! Row(id='ttl-list-state-count-1', count=3)\r\n! Row(id='ttl-map-state-count-0', count=2)\r\n! Row(id='ttl-map-state-count-1', count=2)\r\n```\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo, test-only.\r\n\r\n### How was this patch tested?\r\n\r\nWill monitor the Coverage build.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.\r\n","created_at":"2024-12-31T05:28:43Z","updated_at":"2024-12-31T08:42:16Z","closed_at":"2024-12-31T07:43:33Z","merged_at":null,"merge_commit_sha":"0f717eefa54f847207def7ef449cf2a7034f5f21","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49337/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49337/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49337/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f8f1bf0610ebabaa9c8fd41da5229cb678e05762","head":{"label":"HyukjinKwon:SPARK-50706","ref":"SPARK-50706","sha":"f8f1bf0610ebabaa9c8fd41da5229cb678e05762","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"6099de7f5995b438335a5a545d5cf62dd3d68f0d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49337"},"html":{"href":"https://github.com/apache/spark/pull/49337"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49337"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49337/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49337/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49337/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f8f1bf0610ebabaa9c8fd41da5229cb678e05762"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49336","id":2255858499,"node_id":"PR_kwDOAQXtWs6GdatD","html_url":"https://github.com/apache/spark/pull/49336","diff_url":"https://github.com/apache/spark/pull/49336.diff","patch_url":"https://github.com/apache/spark/pull/49336.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49336","number":49336,"state":"closed","locked":false,"title":"[SPARK-50694][SQL] Support renames in subqueries","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nSupports renames in subqueries:\r\n\r\n- `sub.toDF(...)`\r\n- `sub.alias(...)`\r\n\r\n### Why are the changes needed?\r\n\r\nWhen the query is used as a subquery by adding `col.outer()`, `toDF` or `alias` doesn't work because they need analyzed plans.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, those APIs are available in subqueries.\r\n\r\n### How was this patch tested?\r\n\r\nAdded / modified the related tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.\r\n","created_at":"2024-12-30T21:04:29Z","updated_at":"2025-01-06T20:27:53Z","closed_at":"2025-01-06T20:27:53Z","merged_at":null,"merge_commit_sha":"96f5a4a528b5a72782a227af2b4c91a5a11122be","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49336/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49336/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49336/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/077d197f5ead720c5243bd51836bb327a3ed305f","head":{"label":"ueshin:issues/SPARK-50694/renames","ref":"issues/SPARK-50694/renames","sha":"077d197f5ead720c5243bd51836bb327a3ed305f","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":17234665,"node_id":"MDEwOlJlcG9zaXRvcnkxNzIzNDY2NQ==","name":"apache-spark","full_name":"ueshin/apache-spark","private":false,"owner":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ueshin/apache-spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/ueshin/apache-spark","forks_url":"https://api.github.com/repos/ueshin/apache-spark/forks","keys_url":"https://api.github.com/repos/ueshin/apache-spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ueshin/apache-spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ueshin/apache-spark/teams","hooks_url":"https://api.github.com/repos/ueshin/apache-spark/hooks","issue_events_url":"https://api.github.com/repos/ueshin/apache-spark/issues/events{/number}","events_url":"https://api.github.com/repos/ueshin/apache-spark/events","assignees_url":"https://api.github.com/repos/ueshin/apache-spark/assignees{/user}","branches_url":"https://api.github.com/repos/ueshin/apache-spark/branches{/branch}","tags_url":"https://api.github.com/repos/ueshin/apache-spark/tags","blobs_url":"https://api.github.com/repos/ueshin/apache-spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ueshin/apache-spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ueshin/apache-spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ueshin/apache-spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ueshin/apache-spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ueshin/apache-spark/languages","stargazers_url":"https://api.github.com/repos/ueshin/apache-spark/stargazers","contributors_url":"https://api.github.com/repos/ueshin/apache-spark/contributors","subscribers_url":"https://api.github.com/repos/ueshin/apache-spark/subscribers","subscription_url":"https://api.github.com/repos/ueshin/apache-spark/subscription","commits_url":"https://api.github.com/repos/ueshin/apache-spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ueshin/apache-spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ueshin/apache-spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ueshin/apache-spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ueshin/apache-spark/contents/{+path}","compare_url":"https://api.github.com/repos/ueshin/apache-spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ueshin/apache-spark/merges","archive_url":"https://api.github.com/repos/ueshin/apache-spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ueshin/apache-spark/downloads","issues_url":"https://api.github.com/repos/ueshin/apache-spark/issues{/number}","pulls_url":"https://api.github.com/repos/ueshin/apache-spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ueshin/apache-spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ueshin/apache-spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ueshin/apache-spark/labels{/name}","releases_url":"https://api.github.com/repos/ueshin/apache-spark/releases{/id}","deployments_url":"https://api.github.com/repos/ueshin/apache-spark/deployments","created_at":"2014-02-27T03:10:47Z","updated_at":"2025-02-07T02:07:18Z","pushed_at":"2025-02-07T19:29:05Z","git_url":"git://github.com/ueshin/apache-spark.git","ssh_url":"git@github.com:ueshin/apache-spark.git","clone_url":"https://github.com/ueshin/apache-spark.git","svn_url":"https://github.com/ueshin/apache-spark","homepage":null,"size":484941,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":8,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":8,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"43a9b88991b22757c1b5ae40d3fc7efcdb893d82","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49336"},"html":{"href":"https://github.com/apache/spark/pull/49336"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49336"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49336/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49336/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49336/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/077d197f5ead720c5243bd51836bb327a3ed305f"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49335","id":2255458067,"node_id":"PR_kwDOAQXtWs6Gb48T","html_url":"https://github.com/apache/spark/pull/49335","diff_url":"https://github.com/apache/spark/pull/49335.diff","patch_url":"https://github.com/apache/spark/pull/49335.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49335","number":49335,"state":"open","locked":false,"title":"[SPARK-50704][SQL] Support more pushdown functions for MySQL connector","user":{"login":"sunxiaoguang","id":3982329,"node_id":"MDQ6VXNlcjM5ODIzMjk=","avatar_url":"https://avatars.githubusercontent.com/u/3982329?v=4","gravatar_id":"","url":"https://api.github.com/users/sunxiaoguang","html_url":"https://github.com/sunxiaoguang","followers_url":"https://api.github.com/users/sunxiaoguang/followers","following_url":"https://api.github.com/users/sunxiaoguang/following{/other_user}","gists_url":"https://api.github.com/users/sunxiaoguang/gists{/gist_id}","starred_url":"https://api.github.com/users/sunxiaoguang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunxiaoguang/subscriptions","organizations_url":"https://api.github.com/users/sunxiaoguang/orgs","repos_url":"https://api.github.com/users/sunxiaoguang/repos","events_url":"https://api.github.com/users/sunxiaoguang/events{/privacy}","received_events_url":"https://api.github.com/users/sunxiaoguang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR tries to implement more pushdown functions for MySQL connector. \r\n```SQL\r\nABS COALESCE GREATEST LEAST RAND LOG10 LOG2 LN EXP POWER SQRT SIN COS TAN COT ASIN ACOS ATAN\r\nATAN2 DEGREES RADIANS SIGN SUBSTRING UPPER LOWER SHA1 SHA2 MD5 CRC32 BIT_LENGTH CHAR_LENGTH CONCAT\r\n```\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nThere are Spark SQL functions having the same function signature and similar semantic in MySQL. This PR tries to support these SQL functions in pushdown and added integration tests to make sure it works for valid types.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n'No'\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nIntegration tests added.\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\n'No'","created_at":"2024-12-30T13:48:45Z","updated_at":"2025-01-12T10:16:13Z","closed_at":null,"merged_at":null,"merge_commit_sha":"0c393b04e3c24de0ee1b266f9f29ca3d63f40ca8","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49335/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49335/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49335/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/604a1e306820844f2dfb7d0fe0f37bd1159536c4","head":{"label":"sunxiaoguang:more_mysql_pushdown_functions","ref":"more_mysql_pushdown_functions","sha":"604a1e306820844f2dfb7d0fe0f37bd1159536c4","user":{"login":"sunxiaoguang","id":3982329,"node_id":"MDQ6VXNlcjM5ODIzMjk=","avatar_url":"https://avatars.githubusercontent.com/u/3982329?v=4","gravatar_id":"","url":"https://api.github.com/users/sunxiaoguang","html_url":"https://github.com/sunxiaoguang","followers_url":"https://api.github.com/users/sunxiaoguang/followers","following_url":"https://api.github.com/users/sunxiaoguang/following{/other_user}","gists_url":"https://api.github.com/users/sunxiaoguang/gists{/gist_id}","starred_url":"https://api.github.com/users/sunxiaoguang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunxiaoguang/subscriptions","organizations_url":"https://api.github.com/users/sunxiaoguang/orgs","repos_url":"https://api.github.com/users/sunxiaoguang/repos","events_url":"https://api.github.com/users/sunxiaoguang/events{/privacy}","received_events_url":"https://api.github.com/users/sunxiaoguang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":910043299,"node_id":"R_kgDONj4oow","name":"spark","full_name":"sunxiaoguang/spark","private":false,"owner":{"login":"sunxiaoguang","id":3982329,"node_id":"MDQ6VXNlcjM5ODIzMjk=","avatar_url":"https://avatars.githubusercontent.com/u/3982329?v=4","gravatar_id":"","url":"https://api.github.com/users/sunxiaoguang","html_url":"https://github.com/sunxiaoguang","followers_url":"https://api.github.com/users/sunxiaoguang/followers","following_url":"https://api.github.com/users/sunxiaoguang/following{/other_user}","gists_url":"https://api.github.com/users/sunxiaoguang/gists{/gist_id}","starred_url":"https://api.github.com/users/sunxiaoguang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunxiaoguang/subscriptions","organizations_url":"https://api.github.com/users/sunxiaoguang/orgs","repos_url":"https://api.github.com/users/sunxiaoguang/repos","events_url":"https://api.github.com/users/sunxiaoguang/events{/privacy}","received_events_url":"https://api.github.com/users/sunxiaoguang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sunxiaoguang/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/sunxiaoguang/spark","forks_url":"https://api.github.com/repos/sunxiaoguang/spark/forks","keys_url":"https://api.github.com/repos/sunxiaoguang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sunxiaoguang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sunxiaoguang/spark/teams","hooks_url":"https://api.github.com/repos/sunxiaoguang/spark/hooks","issue_events_url":"https://api.github.com/repos/sunxiaoguang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sunxiaoguang/spark/events","assignees_url":"https://api.github.com/repos/sunxiaoguang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sunxiaoguang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sunxiaoguang/spark/tags","blobs_url":"https://api.github.com/repos/sunxiaoguang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sunxiaoguang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sunxiaoguang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sunxiaoguang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sunxiaoguang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sunxiaoguang/spark/languages","stargazers_url":"https://api.github.com/repos/sunxiaoguang/spark/stargazers","contributors_url":"https://api.github.com/repos/sunxiaoguang/spark/contributors","subscribers_url":"https://api.github.com/repos/sunxiaoguang/spark/subscribers","subscription_url":"https://api.github.com/repos/sunxiaoguang/spark/subscription","commits_url":"https://api.github.com/repos/sunxiaoguang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sunxiaoguang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sunxiaoguang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sunxiaoguang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sunxiaoguang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sunxiaoguang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sunxiaoguang/spark/merges","archive_url":"https://api.github.com/repos/sunxiaoguang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sunxiaoguang/spark/downloads","issues_url":"https://api.github.com/repos/sunxiaoguang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sunxiaoguang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sunxiaoguang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sunxiaoguang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sunxiaoguang/spark/labels{/name}","releases_url":"https://api.github.com/repos/sunxiaoguang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sunxiaoguang/spark/deployments","created_at":"2024-12-30T10:59:08Z","updated_at":"2024-12-30T10:59:08Z","pushed_at":"2025-01-31T03:54:46Z","git_url":"git://github.com/sunxiaoguang/spark.git","ssh_url":"git@github.com:sunxiaoguang/spark.git","clone_url":"https://github.com/sunxiaoguang/spark.git","svn_url":"https://github.com/sunxiaoguang/spark","homepage":"https://spark.apache.org/","size":419317,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f0f850dc21ecf928995736daf8b790082e099221","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49335"},"html":{"href":"https://github.com/apache/spark/pull/49335"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49335"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49335/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49335/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49335/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/604a1e306820844f2dfb7d0fe0f37bd1159536c4"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49334","id":2255234981,"node_id":"PR_kwDOAQXtWs6GbCel","html_url":"https://github.com/apache/spark/pull/49334","diff_url":"https://github.com/apache/spark/pull/49334.diff","patch_url":"https://github.com/apache/spark/pull/49334.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49334","number":49334,"state":"closed","locked":false,"title":"[SPARK-50689][SQL][FOLLOWUP] Enforce deterministic ordering in LCA aggregate lists","user":{"login":"mihailotim-db","id":174342191,"node_id":"U_kgDOCmRALw","avatar_url":"https://avatars.githubusercontent.com/u/174342191?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailotim-db","html_url":"https://github.com/mihailotim-db","followers_url":"https://api.github.com/users/mihailotim-db/followers","following_url":"https://api.github.com/users/mihailotim-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailotim-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailotim-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailotim-db/subscriptions","organizations_url":"https://api.github.com/users/mihailotim-db/orgs","repos_url":"https://api.github.com/users/mihailotim-db/repos","events_url":"https://api.github.com/users/mihailotim-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailotim-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nUsing `Set` to produce aggregate lists may result in those aggregates being non-deterministic. Instead we switch to using `LinkedHashSet`.\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nIt's better for the analyzer to produce stable query plans, regardless of the java/scala versions.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nexisting tests\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nno","created_at":"2024-12-30T10:24:41Z","updated_at":"2024-12-31T00:18:56Z","closed_at":"2024-12-31T00:18:56Z","merged_at":null,"merge_commit_sha":"ad224ec19333806e32fbad1fba83440dcaa1cf21","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49334/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49334/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49334/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8ae6d34adead1fb223e45ba3d0ecf269077a1594","head":{"label":"mihailotim-db:mihailotim-db/lca_followup","ref":"mihailotim-db/lca_followup","sha":"8ae6d34adead1fb223e45ba3d0ecf269077a1594","user":{"login":"mihailotim-db","id":174342191,"node_id":"U_kgDOCmRALw","avatar_url":"https://avatars.githubusercontent.com/u/174342191?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailotim-db","html_url":"https://github.com/mihailotim-db","followers_url":"https://api.github.com/users/mihailotim-db/followers","following_url":"https://api.github.com/users/mihailotim-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailotim-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailotim-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailotim-db/subscriptions","organizations_url":"https://api.github.com/users/mihailotim-db/orgs","repos_url":"https://api.github.com/users/mihailotim-db/repos","events_url":"https://api.github.com/users/mihailotim-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailotim-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":823540258,"node_id":"R_kgDOMRY6Ig","name":"spark","full_name":"mihailotim-db/spark","private":false,"owner":{"login":"mihailotim-db","id":174342191,"node_id":"U_kgDOCmRALw","avatar_url":"https://avatars.githubusercontent.com/u/174342191?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailotim-db","html_url":"https://github.com/mihailotim-db","followers_url":"https://api.github.com/users/mihailotim-db/followers","following_url":"https://api.github.com/users/mihailotim-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailotim-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailotim-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailotim-db/subscriptions","organizations_url":"https://api.github.com/users/mihailotim-db/orgs","repos_url":"https://api.github.com/users/mihailotim-db/repos","events_url":"https://api.github.com/users/mihailotim-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailotim-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/mihailotim-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/mihailotim-db/spark","forks_url":"https://api.github.com/repos/mihailotim-db/spark/forks","keys_url":"https://api.github.com/repos/mihailotim-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/mihailotim-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/mihailotim-db/spark/teams","hooks_url":"https://api.github.com/repos/mihailotim-db/spark/hooks","issue_events_url":"https://api.github.com/repos/mihailotim-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/mihailotim-db/spark/events","assignees_url":"https://api.github.com/repos/mihailotim-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/mihailotim-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/mihailotim-db/spark/tags","blobs_url":"https://api.github.com/repos/mihailotim-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/mihailotim-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/mihailotim-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/mihailotim-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/mihailotim-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/mihailotim-db/spark/languages","stargazers_url":"https://api.github.com/repos/mihailotim-db/spark/stargazers","contributors_url":"https://api.github.com/repos/mihailotim-db/spark/contributors","subscribers_url":"https://api.github.com/repos/mihailotim-db/spark/subscribers","subscription_url":"https://api.github.com/repos/mihailotim-db/spark/subscription","commits_url":"https://api.github.com/repos/mihailotim-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/mihailotim-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/mihailotim-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/mihailotim-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/mihailotim-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/mihailotim-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/mihailotim-db/spark/merges","archive_url":"https://api.github.com/repos/mihailotim-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/mihailotim-db/spark/downloads","issues_url":"https://api.github.com/repos/mihailotim-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/mihailotim-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/mihailotim-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/mihailotim-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/mihailotim-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/mihailotim-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/mihailotim-db/spark/deployments","created_at":"2024-07-03T08:18:27Z","updated_at":"2024-08-21T14:53:45Z","pushed_at":"2025-02-04T16:22:41Z","git_url":"git://github.com/mihailotim-db/spark.git","ssh_url":"git@github.com:mihailotim-db/spark.git","clone_url":"https://github.com/mihailotim-db/spark.git","svn_url":"https://github.com/mihailotim-db/spark","homepage":"https://spark.apache.org/","size":423337,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7d5aaaad61f2e2f843a982bb565ceb1578812eef","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49334"},"html":{"href":"https://github.com/apache/spark/pull/49334"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49334"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49334/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49334/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49334/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8ae6d34adead1fb223e45ba3d0ecf269077a1594"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49333","id":2255176486,"node_id":"PR_kwDOAQXtWs6Ga0Mm","html_url":"https://github.com/apache/spark/pull/49333","diff_url":"https://github.com/apache/spark/pull/49333.diff","patch_url":"https://github.com/apache/spark/pull/49333.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49333","number":49333,"state":"closed","locked":false,"title":"[SPARK-50701][PYTHON] Make plotting require the minimum plotly version","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nMake plotting require the minimum plotly version\r\n\r\n### Why are the changes needed?\r\nthe `minimum_plotly_version = \"4.8\"` didn't take effect in existing implementation\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nCI\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2024-12-30T09:30:40Z","updated_at":"2024-12-31T07:49:55Z","closed_at":"2024-12-31T07:49:23Z","merged_at":null,"merge_commit_sha":"7403dbc26c0d50c00b46f1fbb32e97100c35703e","assignee":null,"assignees":[],"requested_reviewers":[{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49333/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49333/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49333/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7fc680948f3b739d03c5381f427d9eb922063293","head":{"label":"zhengruifeng:py_plot_minimum_version","ref":"py_plot_minimum_version","sha":"7fc680948f3b739d03c5381f427d9eb922063293","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7d5aaaad61f2e2f843a982bb565ceb1578812eef","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49333"},"html":{"href":"https://github.com/apache/spark/pull/49333"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49333"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49333/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49333/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49333/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7fc680948f3b739d03c5381f427d9eb922063293"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49332","id":2255068895,"node_id":"PR_kwDOAQXtWs6GaZ7f","html_url":"https://github.com/apache/spark/pull/49332","diff_url":"https://github.com/apache/spark/pull/49332.diff","patch_url":"https://github.com/apache/spark/pull/49332.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49332","number":49332,"state":"closed","locked":false,"title":"[SPARK-50700][SQL] `spark.sql.catalog.spark_catalog` supports `builtin` magic value","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR adds a magic value `builtin`(and sets it to the default value) for `spark.sql.catalog.spark_catalog`.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCurrently, `spark.sql.catalog.spark_catalog` is optional and has `None` as the default value. When `spark.sql.catalog.spark_catalog=a.bad.catalog.impl` is wrongly set in `spark-defaults.conf`, the user has no way to overwrite it in `spark-submit`.\r\n\r\nNote that, explicitly setting it to `o.a.s.sql.execution.datasources.v2.V2SessionCatalog` does not work either, because `V2SessionCatalog` does not have a zero-args constructor.\r\n```\r\nspark-submit \\\r\n  --conf spark.sql.catalog.spark_catalog=org.apache.spark.sql.execution.datasources.v2.V2SessionCatalog \\\r\n  ...\r\n```\r\n\r\nTo fix the above issue, similar to what we did for `spark.sql.hive.metastore.jars`, just use \"builtin\" to represent the built-in `V2SessionCatalog`.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo change for default behavior, and users are allowed to use  `spark.sql.catalog.spark_catalog=builtin` to set `spark_catalog` as the built-in `V2SessionCatalog`.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nCode in UTs like\r\n```\r\n// unset this config to use the default v2 session catalog.\r\nspark.conf.unset(V2_SESSION_CATALOG_IMPLEMENTATION.key)\r\n```\r\nare replaced with\r\n```\r\nspark.conf.set(V2_SESSION_CATALOG_IMPLEMENTATION, \"builtin\")\r\n```\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nNo.","created_at":"2024-12-30T07:50:16Z","updated_at":"2025-01-06T03:29:46Z","closed_at":"2025-01-06T03:28:58Z","merged_at":null,"merge_commit_sha":"922d70ee3d8f8116df27e2b8c94e6f3b2c809cbc","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49332/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49332/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49332/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e4491c38c609094c70659ec64b2683c11d8c1dd9","head":{"label":"pan3793:SPARK-50700","ref":"SPARK-50700","sha":"e4491c38c609094c70659ec64b2683c11d8c1dd9","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":275650396,"node_id":"MDEwOlJlcG9zaXRvcnkyNzU2NTAzOTY=","name":"spark","full_name":"pan3793/spark","private":false,"owner":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pan3793/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/pan3793/spark","forks_url":"https://api.github.com/repos/pan3793/spark/forks","keys_url":"https://api.github.com/repos/pan3793/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pan3793/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pan3793/spark/teams","hooks_url":"https://api.github.com/repos/pan3793/spark/hooks","issue_events_url":"https://api.github.com/repos/pan3793/spark/issues/events{/number}","events_url":"https://api.github.com/repos/pan3793/spark/events","assignees_url":"https://api.github.com/repos/pan3793/spark/assignees{/user}","branches_url":"https://api.github.com/repos/pan3793/spark/branches{/branch}","tags_url":"https://api.github.com/repos/pan3793/spark/tags","blobs_url":"https://api.github.com/repos/pan3793/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pan3793/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pan3793/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/pan3793/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pan3793/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/pan3793/spark/languages","stargazers_url":"https://api.github.com/repos/pan3793/spark/stargazers","contributors_url":"https://api.github.com/repos/pan3793/spark/contributors","subscribers_url":"https://api.github.com/repos/pan3793/spark/subscribers","subscription_url":"https://api.github.com/repos/pan3793/spark/subscription","commits_url":"https://api.github.com/repos/pan3793/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/pan3793/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/pan3793/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/pan3793/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/pan3793/spark/contents/{+path}","compare_url":"https://api.github.com/repos/pan3793/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pan3793/spark/merges","archive_url":"https://api.github.com/repos/pan3793/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pan3793/spark/downloads","issues_url":"https://api.github.com/repos/pan3793/spark/issues{/number}","pulls_url":"https://api.github.com/repos/pan3793/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/pan3793/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/pan3793/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pan3793/spark/labels{/name}","releases_url":"https://api.github.com/repos/pan3793/spark/releases{/id}","deployments_url":"https://api.github.com/repos/pan3793/spark/deployments","created_at":"2020-06-28T19:04:17Z","updated_at":"2024-06-11T02:32:11Z","pushed_at":"2025-01-16T02:34:50Z","git_url":"git://github.com/pan3793/spark.git","ssh_url":"git@github.com:pan3793/spark.git","clone_url":"https://github.com/pan3793/spark.git","svn_url":"https://github.com/pan3793/spark","homepage":"https://spark.apache.org/","size":473459,"stargazers_count":4,"watchers_count":4,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":3,"open_issues":0,"watchers":4,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7d5aaaad61f2e2f843a982bb565ceb1578812eef","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49332"},"html":{"href":"https://github.com/apache/spark/pull/49332"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49332"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49332/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49332/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49332/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e4491c38c609094c70659ec64b2683c11d8c1dd9"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49331","id":2255029170,"node_id":"PR_kwDOAQXtWs6GaQOy","html_url":"https://github.com/apache/spark/pull/49331","diff_url":"https://github.com/apache/spark/pull/49331.diff","patch_url":"https://github.com/apache/spark/pull/49331.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49331","number":49331,"state":"closed","locked":false,"title":"[SPARK-50699][PYTHON] Parse and generate DDL string with a specified session","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nParse and generate DDL string with a specified session\r\n\r\n### Why are the changes needed?\r\nIn `_parse_datatype_string` and `toDDL`, a `SparkSession` or `SparkContext` is always needed.\r\nIn most cases, the session is already present, so we can avoid creating or fetching the activate session.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nCI\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo","created_at":"2024-12-30T07:03:21Z","updated_at":"2024-12-31T00:50:22Z","closed_at":"2024-12-31T00:11:47Z","merged_at":null,"merge_commit_sha":"b02a385bf3341f5633c9117d2dcda13fc047bc19","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4138679613,"node_id":"LA_kwDOAQXtWs72rz09","url":"https://api.github.com/repos/apache/spark/labels/PANDAS%20API%20ON%20SPARK","name":"PANDAS API ON SPARK","color":"ededed","default":false,"description":null},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49331/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49331/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49331/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5e9acaae2e80cc7b0ef2577c6da0343fd055320e","head":{"label":"zhengruifeng:py_session_ddl_json","ref":"py_session_ddl_json","sha":"5e9acaae2e80cc7b0ef2577c6da0343fd055320e","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7d5aaaad61f2e2f843a982bb565ceb1578812eef","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49331"},"html":{"href":"https://github.com/apache/spark/pull/49331"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49331"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49331/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49331/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49331/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5e9acaae2e80cc7b0ef2577c6da0343fd055320e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49330","id":2254969320,"node_id":"PR_kwDOAQXtWs6GaBno","html_url":"https://github.com/apache/spark/pull/49330","diff_url":"https://github.com/apache/spark/pull/49330.diff","patch_url":"https://github.com/apache/spark/pull/49330.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49330","number":49330,"state":"closed","locked":false,"title":"[SPARK-50697][SQL] Enable tail-recursion wherever possible","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis pr adds `scala.annotation.tailrec` inspected by IDE (IntelliJ),  these are new cases after Spark 4.0.\r\n\r\n\r\n### Why are the changes needed?\r\nTo improve performance.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n Pass GItHub Actions\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n No","created_at":"2024-12-30T06:00:53Z","updated_at":"2024-12-31T05:17:33Z","closed_at":"2024-12-31T05:12:01Z","merged_at":null,"merge_commit_sha":"0e130667845a7fb3b88dcad8ee7ce7d92fae2ffd","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49330/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49330/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49330/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d7b3cef2bfdcfed6e6e73ce8c896ee23ef067ff6","head":{"label":"LuciferYang:tailrec-master","ref":"tailrec-master","sha":"d7b3cef2bfdcfed6e6e73ce8c896ee23ef067ff6","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"c4145db09ffeb0d0f9714a517ff9bacb018483e3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49330"},"html":{"href":"https://github.com/apache/spark/pull/49330"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49330"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49330/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49330/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49330/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d7b3cef2bfdcfed6e6e73ce8c896ee23ef067ff6"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49329","id":2254485323,"node_id":"PR_kwDOAQXtWs6GYLdL","html_url":"https://github.com/apache/spark/pull/49329","diff_url":"https://github.com/apache/spark/pull/49329.diff","patch_url":"https://github.com/apache/spark/pull/49329.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49329","number":49329,"state":"closed","locked":false,"title":"[SPARK-50695][SQL] Alter table with properties check for empty string","user":{"login":"xuzifu666","id":10645422,"node_id":"MDQ6VXNlcjEwNjQ1NDIy","avatar_url":"https://avatars.githubusercontent.com/u/10645422?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzifu666","html_url":"https://github.com/xuzifu666","followers_url":"https://api.github.com/users/xuzifu666/followers","following_url":"https://api.github.com/users/xuzifu666/following{/other_user}","gists_url":"https://api.github.com/users/xuzifu666/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzifu666/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzifu666/subscriptions","organizations_url":"https://api.github.com/users/xuzifu666/orgs","repos_url":"https://api.github.com/users/xuzifu666/repos","events_url":"https://api.github.com/users/xuzifu666/events{/privacy}","received_events_url":"https://api.github.com/users/xuzifu666/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nAlter table with set properties check for key value\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nCurrently sparksql not gurad for empty key properties such as '' = 'bb' which is not right\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nDDLSuite: Test alter table command with empty key\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nNo","created_at":"2024-12-29T06:03:56Z","updated_at":"2024-12-30T03:08:35Z","closed_at":"2024-12-30T02:58:02Z","merged_at":null,"merge_commit_sha":"13ca4bb07bc3bd7c627f10aece5b2bc8f9ac7a2a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49329/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49329/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49329/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5bf23ae267f1cb04169b4472c1e0548223b8e292","head":{"label":"xuzifu666:alter_optizime","ref":"alter_optizime","sha":"5bf23ae267f1cb04169b4472c1e0548223b8e292","user":{"login":"xuzifu666","id":10645422,"node_id":"MDQ6VXNlcjEwNjQ1NDIy","avatar_url":"https://avatars.githubusercontent.com/u/10645422?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzifu666","html_url":"https://github.com/xuzifu666","followers_url":"https://api.github.com/users/xuzifu666/followers","following_url":"https://api.github.com/users/xuzifu666/following{/other_user}","gists_url":"https://api.github.com/users/xuzifu666/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzifu666/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzifu666/subscriptions","organizations_url":"https://api.github.com/users/xuzifu666/orgs","repos_url":"https://api.github.com/users/xuzifu666/repos","events_url":"https://api.github.com/users/xuzifu666/events{/privacy}","received_events_url":"https://api.github.com/users/xuzifu666/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":442395878,"node_id":"R_kgDOGl5s5g","name":"spark-1","full_name":"xuzifu666/spark-1","private":false,"owner":{"login":"xuzifu666","id":10645422,"node_id":"MDQ6VXNlcjEwNjQ1NDIy","avatar_url":"https://avatars.githubusercontent.com/u/10645422?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzifu666","html_url":"https://github.com/xuzifu666","followers_url":"https://api.github.com/users/xuzifu666/followers","following_url":"https://api.github.com/users/xuzifu666/following{/other_user}","gists_url":"https://api.github.com/users/xuzifu666/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzifu666/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzifu666/subscriptions","organizations_url":"https://api.github.com/users/xuzifu666/orgs","repos_url":"https://api.github.com/users/xuzifu666/repos","events_url":"https://api.github.com/users/xuzifu666/events{/privacy}","received_events_url":"https://api.github.com/users/xuzifu666/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xuzifu666/spark-1","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xuzifu666/spark-1","forks_url":"https://api.github.com/repos/xuzifu666/spark-1/forks","keys_url":"https://api.github.com/repos/xuzifu666/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xuzifu666/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xuzifu666/spark-1/teams","hooks_url":"https://api.github.com/repos/xuzifu666/spark-1/hooks","issue_events_url":"https://api.github.com/repos/xuzifu666/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/xuzifu666/spark-1/events","assignees_url":"https://api.github.com/repos/xuzifu666/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/xuzifu666/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/xuzifu666/spark-1/tags","blobs_url":"https://api.github.com/repos/xuzifu666/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xuzifu666/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xuzifu666/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/xuzifu666/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xuzifu666/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/xuzifu666/spark-1/languages","stargazers_url":"https://api.github.com/repos/xuzifu666/spark-1/stargazers","contributors_url":"https://api.github.com/repos/xuzifu666/spark-1/contributors","subscribers_url":"https://api.github.com/repos/xuzifu666/spark-1/subscribers","subscription_url":"https://api.github.com/repos/xuzifu666/spark-1/subscription","commits_url":"https://api.github.com/repos/xuzifu666/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/xuzifu666/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/xuzifu666/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/xuzifu666/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/xuzifu666/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/xuzifu666/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xuzifu666/spark-1/merges","archive_url":"https://api.github.com/repos/xuzifu666/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xuzifu666/spark-1/downloads","issues_url":"https://api.github.com/repos/xuzifu666/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/xuzifu666/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/xuzifu666/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/xuzifu666/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xuzifu666/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/xuzifu666/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/xuzifu666/spark-1/deployments","created_at":"2021-12-28T08:14:59Z","updated_at":"2024-12-23T01:59:22Z","pushed_at":"2024-12-29T06:02:10Z","git_url":"git://github.com/xuzifu666/spark-1.git","ssh_url":"git@github.com:xuzifu666/spark-1.git","clone_url":"https://github.com/xuzifu666/spark-1.git","svn_url":"https://github.com/xuzifu666/spark-1","homepage":"https://spark.apache.org/","size":458950,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"31cb8113f12ca9a568d05bb940078abb7ae118c7","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49329"},"html":{"href":"https://github.com/apache/spark/pull/49329"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49329"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49329/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49329/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49329/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5bf23ae267f1cb04169b4472c1e0548223b8e292"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49328","id":2253944424,"node_id":"PR_kwDOAQXtWs6GWHZo","html_url":"https://github.com/apache/spark/pull/49328","diff_url":"https://github.com/apache/spark/pull/49328.diff","patch_url":"https://github.com/apache/spark/pull/49328.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49328","number":49328,"state":"closed","locked":false,"title":"When aliasMap doesn't contain alias, throw exception","user":{"login":"tedyu","id":235188,"node_id":"MDQ6VXNlcjIzNTE4OA==","avatar_url":"https://avatars.githubusercontent.com/u/235188?v=4","gravatar_id":"","url":"https://api.github.com/users/tedyu","html_url":"https://github.com/tedyu","followers_url":"https://api.github.com/users/tedyu/followers","following_url":"https://api.github.com/users/tedyu/following{/other_user}","gists_url":"https://api.github.com/users/tedyu/gists{/gist_id}","starred_url":"https://api.github.com/users/tedyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tedyu/subscriptions","organizations_url":"https://api.github.com/users/tedyu/orgs","repos_url":"https://api.github.com/users/tedyu/repos","events_url":"https://api.github.com/users/tedyu/events{/privacy}","received_events_url":"https://api.github.com/users/tedyu/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n### What changes were proposed in this pull request?\r\nWhen encountering unresolved alias, throw exception.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.","created_at":"2024-12-28T05:46:57Z","updated_at":"2024-12-28T12:55:23Z","closed_at":"2024-12-28T12:55:23Z","merged_at":null,"merge_commit_sha":"2ddd26fc9ff220e55d79d1d8295aa1de202b2dd5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49328/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49328/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49328/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e923bbad9ee7b9051e6c13c2c06d51d5f67f62cc","head":{"label":"tedyu:unresolv","ref":"unresolv","sha":"e923bbad9ee7b9051e6c13c2c06d51d5f67f62cc","user":{"login":"tedyu","id":235188,"node_id":"MDQ6VXNlcjIzNTE4OA==","avatar_url":"https://avatars.githubusercontent.com/u/235188?v=4","gravatar_id":"","url":"https://api.github.com/users/tedyu","html_url":"https://github.com/tedyu","followers_url":"https://api.github.com/users/tedyu/followers","following_url":"https://api.github.com/users/tedyu/following{/other_user}","gists_url":"https://api.github.com/users/tedyu/gists{/gist_id}","starred_url":"https://api.github.com/users/tedyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tedyu/subscriptions","organizations_url":"https://api.github.com/users/tedyu/orgs","repos_url":"https://api.github.com/users/tedyu/repos","events_url":"https://api.github.com/users/tedyu/events{/privacy}","received_events_url":"https://api.github.com/users/tedyu/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":325822007,"node_id":"MDEwOlJlcG9zaXRvcnkzMjU4MjIwMDc=","name":"spark","full_name":"tedyu/spark","private":false,"owner":{"login":"tedyu","id":235188,"node_id":"MDQ6VXNlcjIzNTE4OA==","avatar_url":"https://avatars.githubusercontent.com/u/235188?v=4","gravatar_id":"","url":"https://api.github.com/users/tedyu","html_url":"https://github.com/tedyu","followers_url":"https://api.github.com/users/tedyu/followers","following_url":"https://api.github.com/users/tedyu/following{/other_user}","gists_url":"https://api.github.com/users/tedyu/gists{/gist_id}","starred_url":"https://api.github.com/users/tedyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tedyu/subscriptions","organizations_url":"https://api.github.com/users/tedyu/orgs","repos_url":"https://api.github.com/users/tedyu/repos","events_url":"https://api.github.com/users/tedyu/events{/privacy}","received_events_url":"https://api.github.com/users/tedyu/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/tedyu/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/tedyu/spark","forks_url":"https://api.github.com/repos/tedyu/spark/forks","keys_url":"https://api.github.com/repos/tedyu/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/tedyu/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/tedyu/spark/teams","hooks_url":"https://api.github.com/repos/tedyu/spark/hooks","issue_events_url":"https://api.github.com/repos/tedyu/spark/issues/events{/number}","events_url":"https://api.github.com/repos/tedyu/spark/events","assignees_url":"https://api.github.com/repos/tedyu/spark/assignees{/user}","branches_url":"https://api.github.com/repos/tedyu/spark/branches{/branch}","tags_url":"https://api.github.com/repos/tedyu/spark/tags","blobs_url":"https://api.github.com/repos/tedyu/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/tedyu/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/tedyu/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/tedyu/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/tedyu/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/tedyu/spark/languages","stargazers_url":"https://api.github.com/repos/tedyu/spark/stargazers","contributors_url":"https://api.github.com/repos/tedyu/spark/contributors","subscribers_url":"https://api.github.com/repos/tedyu/spark/subscribers","subscription_url":"https://api.github.com/repos/tedyu/spark/subscription","commits_url":"https://api.github.com/repos/tedyu/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/tedyu/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/tedyu/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/tedyu/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/tedyu/spark/contents/{+path}","compare_url":"https://api.github.com/repos/tedyu/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/tedyu/spark/merges","archive_url":"https://api.github.com/repos/tedyu/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/tedyu/spark/downloads","issues_url":"https://api.github.com/repos/tedyu/spark/issues{/number}","pulls_url":"https://api.github.com/repos/tedyu/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/tedyu/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/tedyu/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/tedyu/spark/labels{/name}","releases_url":"https://api.github.com/repos/tedyu/spark/releases{/id}","deployments_url":"https://api.github.com/repos/tedyu/spark/deployments","created_at":"2020-12-31T15:02:53Z","updated_at":"2024-08-20T17:49:00Z","pushed_at":"2025-01-05T16:23:32Z","git_url":"git://github.com/tedyu/spark.git","ssh_url":"git@github.com:tedyu/spark.git","clone_url":"https://github.com/tedyu/spark.git","svn_url":"https://github.com/tedyu/spark","homepage":"https://spark.apache.org/","size":455362,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"af53ee455e217ec59313555df33ebb4b038f76c7","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49328"},"html":{"href":"https://github.com/apache/spark/pull/49328"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49328"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49328/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49328/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49328/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e923bbad9ee7b9051e6c13c2c06d51d5f67f62cc"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49327","id":2253787600,"node_id":"PR_kwDOAQXtWs6GVhHQ","html_url":"https://github.com/apache/spark/pull/49327","diff_url":"https://github.com/apache/spark/pull/49327.diff","patch_url":"https://github.com/apache/spark/pull/49327.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49327","number":49327,"state":"closed","locked":false,"title":"[SPARK-50693][CONNECT] The inputs for TypedScalaUdf should be analyzed","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nFixes `SparkConnectPlanner` to analyze the inputs for `TypedScalaUdf`.\r\n\r\n### Why are the changes needed?\r\n\r\nThe inputs for `TypedScalaUdf` should be analyzed.\r\n\r\nFor example:\r\n\r\n```scala\r\nval df = Seq((\"a\", 10), (\"a\", 20), (\"b\", 1), (\"b\", 2), (\"c\", 1)).toDF(\"c1\", \"c2\")\r\ndf.select(\"*\").filter(r => r.getInt(1) > 5)\r\n```\r\n\r\nfails with:\r\n\r\n```\r\norg.apache.spark.SparkException: [INTERNAL_ERROR] Invalid call to toAttribute on unresolved object SQLSTATE: XX000\r\n  at org.apache.spark.sql.catalyst.analysis.Star.toAttribute(unresolved.scala:438)\r\n  at org.apache.spark.sql.catalyst.plans.logical.Project.$anonfun$output$1(basicLogicalOperators.scala:74)\r\n  at scala.collection.immutable.List.map(List.scala:247)\r\n  at scala.collection.immutable.List.map(List.scala:79)\r\n  at org.apache.spark.sql.catalyst.plans.logical.Project.output(basicLogicalOperators.scala:74)\r\n  at org.apache.spark.sql.connect.planner.SparkConnectPlanner.transformTypedFilter(SparkConnectPlanner.scala:1460)\r\n  at org.apache.spark.sql.connect.planner.SparkConnectPlanner.transformFilter(SparkConnectPlanner.scala:1437)\r\n...\r\n```\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nThe failure will not appear.\r\n\r\n### How was this patch tested?\r\n\r\nAdded the related tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.\r\n","created_at":"2024-12-27T22:31:27Z","updated_at":"2024-12-30T19:50:33Z","closed_at":"2024-12-30T19:50:33Z","merged_at":null,"merge_commit_sha":"6e235a04084a422c8a88cd6845eaaa3df9dfef85","assignee":null,"assignees":[],"requested_reviewers":[{"login":"hvanhovell","id":9616802,"node_id":"MDQ6VXNlcjk2MTY4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/9616802?v=4","gravatar_id":"","url":"https://api.github.com/users/hvanhovell","html_url":"https://github.com/hvanhovell","followers_url":"https://api.github.com/users/hvanhovell/followers","following_url":"https://api.github.com/users/hvanhovell/following{/other_user}","gists_url":"https://api.github.com/users/hvanhovell/gists{/gist_id}","starred_url":"https://api.github.com/users/hvanhovell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hvanhovell/subscriptions","organizations_url":"https://api.github.com/users/hvanhovell/orgs","repos_url":"https://api.github.com/users/hvanhovell/repos","events_url":"https://api.github.com/users/hvanhovell/events{/privacy}","received_events_url":"https://api.github.com/users/hvanhovell/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49327/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49327/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49327/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/61632c38a4fca3c7ee27057162065e66c22f78c1","head":{"label":"ueshin:issues/SPARK-50693/typed_scala_udf","ref":"issues/SPARK-50693/typed_scala_udf","sha":"61632c38a4fca3c7ee27057162065e66c22f78c1","user":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":17234665,"node_id":"MDEwOlJlcG9zaXRvcnkxNzIzNDY2NQ==","name":"apache-spark","full_name":"ueshin/apache-spark","private":false,"owner":{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ueshin/apache-spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/ueshin/apache-spark","forks_url":"https://api.github.com/repos/ueshin/apache-spark/forks","keys_url":"https://api.github.com/repos/ueshin/apache-spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ueshin/apache-spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ueshin/apache-spark/teams","hooks_url":"https://api.github.com/repos/ueshin/apache-spark/hooks","issue_events_url":"https://api.github.com/repos/ueshin/apache-spark/issues/events{/number}","events_url":"https://api.github.com/repos/ueshin/apache-spark/events","assignees_url":"https://api.github.com/repos/ueshin/apache-spark/assignees{/user}","branches_url":"https://api.github.com/repos/ueshin/apache-spark/branches{/branch}","tags_url":"https://api.github.com/repos/ueshin/apache-spark/tags","blobs_url":"https://api.github.com/repos/ueshin/apache-spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ueshin/apache-spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ueshin/apache-spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ueshin/apache-spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ueshin/apache-spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ueshin/apache-spark/languages","stargazers_url":"https://api.github.com/repos/ueshin/apache-spark/stargazers","contributors_url":"https://api.github.com/repos/ueshin/apache-spark/contributors","subscribers_url":"https://api.github.com/repos/ueshin/apache-spark/subscribers","subscription_url":"https://api.github.com/repos/ueshin/apache-spark/subscription","commits_url":"https://api.github.com/repos/ueshin/apache-spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ueshin/apache-spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ueshin/apache-spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ueshin/apache-spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ueshin/apache-spark/contents/{+path}","compare_url":"https://api.github.com/repos/ueshin/apache-spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ueshin/apache-spark/merges","archive_url":"https://api.github.com/repos/ueshin/apache-spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ueshin/apache-spark/downloads","issues_url":"https://api.github.com/repos/ueshin/apache-spark/issues{/number}","pulls_url":"https://api.github.com/repos/ueshin/apache-spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ueshin/apache-spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ueshin/apache-spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ueshin/apache-spark/labels{/name}","releases_url":"https://api.github.com/repos/ueshin/apache-spark/releases{/id}","deployments_url":"https://api.github.com/repos/ueshin/apache-spark/deployments","created_at":"2014-02-27T03:10:47Z","updated_at":"2025-02-07T02:07:18Z","pushed_at":"2025-02-07T19:29:05Z","git_url":"git://github.com/ueshin/apache-spark.git","ssh_url":"git@github.com:ueshin/apache-spark.git","clone_url":"https://github.com/ueshin/apache-spark.git","svn_url":"https://github.com/ueshin/apache-spark","homepage":null,"size":484941,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":8,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":8,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"af53ee455e217ec59313555df33ebb4b038f76c7","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49327"},"html":{"href":"https://github.com/apache/spark/pull/49327"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49327"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49327/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49327/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49327/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/61632c38a4fca3c7ee27057162065e66c22f78c1"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49326","id":2253786580,"node_id":"PR_kwDOAQXtWs6GVg3U","html_url":"https://github.com/apache/spark/pull/49326","diff_url":"https://github.com/apache/spark/pull/49326.diff","patch_url":"https://github.com/apache/spark/pull/49326.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49326","number":49326,"state":"open","locked":false,"title":"[SPARK-47854][PYTHON][CONNECT] Avoid shadowing python built-ins in python function variable naming","user":{"login":"skanderboudawara","id":108568261,"node_id":"U_kgDOBniexQ","avatar_url":"https://avatars.githubusercontent.com/u/108568261?v=4","gravatar_id":"","url":"https://api.github.com/users/skanderboudawara","html_url":"https://github.com/skanderboudawara","followers_url":"https://api.github.com/users/skanderboudawara/followers","following_url":"https://api.github.com/users/skanderboudawara/following{/other_user}","gists_url":"https://api.github.com/users/skanderboudawara/gists{/gist_id}","starred_url":"https://api.github.com/users/skanderboudawara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skanderboudawara/subscriptions","organizations_url":"https://api.github.com/users/skanderboudawara/orgs","repos_url":"https://api.github.com/users/skanderboudawara/repos","events_url":"https://api.github.com/users/skanderboudawara/events{/privacy}","received_events_url":"https://api.github.com/users/skanderboudawara/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"# What changes were proposed in this pull request?\n\nChange all the functions parameters shadowing python built-in to a distinguished ones.\n\nWhy are the changes needed?\n\nAs mentionned in the Jira ticket\n```\n# breaks:\nfoo(str=\"x\", bar=\"y\")\n\n# okay:\nfoo(\"x\", bar=\"y\")\n```\n\nDoes this PR introduce any user-facing change?\n\nYes.\n\nHow was this patch tested?\n\nGithub actions\n\nWas this patch authored or co-authored using generative AI tooling?\n\nNo","created_at":"2024-12-27T22:29:04Z","updated_at":"2025-01-05T11:46:31Z","closed_at":null,"merged_at":null,"merge_commit_sha":null,"assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49326/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49326/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49326/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/dae6790b02cb5be473b739acda0c7c9d944b8d90","head":{"label":"skanderboudawara:dev_sbu_SPARK-47854","ref":"dev_sbu_SPARK-47854","sha":"dae6790b02cb5be473b739acda0c7c9d944b8d90","user":{"login":"skanderboudawara","id":108568261,"node_id":"U_kgDOBniexQ","avatar_url":"https://avatars.githubusercontent.com/u/108568261?v=4","gravatar_id":"","url":"https://api.github.com/users/skanderboudawara","html_url":"https://github.com/skanderboudawara","followers_url":"https://api.github.com/users/skanderboudawara/followers","following_url":"https://api.github.com/users/skanderboudawara/following{/other_user}","gists_url":"https://api.github.com/users/skanderboudawara/gists{/gist_id}","starred_url":"https://api.github.com/users/skanderboudawara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skanderboudawara/subscriptions","organizations_url":"https://api.github.com/users/skanderboudawara/orgs","repos_url":"https://api.github.com/users/skanderboudawara/repos","events_url":"https://api.github.com/users/skanderboudawara/events{/privacy}","received_events_url":"https://api.github.com/users/skanderboudawara/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":908967190,"node_id":"R_kgDONi29Fg","name":"spark","full_name":"skanderboudawara/spark","private":false,"owner":{"login":"skanderboudawara","id":108568261,"node_id":"U_kgDOBniexQ","avatar_url":"https://avatars.githubusercontent.com/u/108568261?v=4","gravatar_id":"","url":"https://api.github.com/users/skanderboudawara","html_url":"https://github.com/skanderboudawara","followers_url":"https://api.github.com/users/skanderboudawara/followers","following_url":"https://api.github.com/users/skanderboudawara/following{/other_user}","gists_url":"https://api.github.com/users/skanderboudawara/gists{/gist_id}","starred_url":"https://api.github.com/users/skanderboudawara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skanderboudawara/subscriptions","organizations_url":"https://api.github.com/users/skanderboudawara/orgs","repos_url":"https://api.github.com/users/skanderboudawara/repos","events_url":"https://api.github.com/users/skanderboudawara/events{/privacy}","received_events_url":"https://api.github.com/users/skanderboudawara/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/skanderboudawara/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/skanderboudawara/spark","forks_url":"https://api.github.com/repos/skanderboudawara/spark/forks","keys_url":"https://api.github.com/repos/skanderboudawara/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/skanderboudawara/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/skanderboudawara/spark/teams","hooks_url":"https://api.github.com/repos/skanderboudawara/spark/hooks","issue_events_url":"https://api.github.com/repos/skanderboudawara/spark/issues/events{/number}","events_url":"https://api.github.com/repos/skanderboudawara/spark/events","assignees_url":"https://api.github.com/repos/skanderboudawara/spark/assignees{/user}","branches_url":"https://api.github.com/repos/skanderboudawara/spark/branches{/branch}","tags_url":"https://api.github.com/repos/skanderboudawara/spark/tags","blobs_url":"https://api.github.com/repos/skanderboudawara/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/skanderboudawara/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/skanderboudawara/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/skanderboudawara/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/skanderboudawara/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/skanderboudawara/spark/languages","stargazers_url":"https://api.github.com/repos/skanderboudawara/spark/stargazers","contributors_url":"https://api.github.com/repos/skanderboudawara/spark/contributors","subscribers_url":"https://api.github.com/repos/skanderboudawara/spark/subscribers","subscription_url":"https://api.github.com/repos/skanderboudawara/spark/subscription","commits_url":"https://api.github.com/repos/skanderboudawara/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/skanderboudawara/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/skanderboudawara/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/skanderboudawara/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/skanderboudawara/spark/contents/{+path}","compare_url":"https://api.github.com/repos/skanderboudawara/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/skanderboudawara/spark/merges","archive_url":"https://api.github.com/repos/skanderboudawara/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/skanderboudawara/spark/downloads","issues_url":"https://api.github.com/repos/skanderboudawara/spark/issues{/number}","pulls_url":"https://api.github.com/repos/skanderboudawara/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/skanderboudawara/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/skanderboudawara/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/skanderboudawara/spark/labels{/name}","releases_url":"https://api.github.com/repos/skanderboudawara/spark/releases{/id}","deployments_url":"https://api.github.com/repos/skanderboudawara/spark/deployments","created_at":"2024-12-27T12:14:29Z","updated_at":"2025-01-04T10:03:32Z","pushed_at":"2025-01-05T11:46:30Z","git_url":"git://github.com/skanderboudawara/spark.git","ssh_url":"git@github.com:skanderboudawara/spark.git","clone_url":"https://github.com/skanderboudawara/spark.git","svn_url":"https://github.com/skanderboudawara/spark","homepage":"https://spark.apache.org/","size":418603,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"0d0fa86a03119608159078b0f6474db96485a80f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49326"},"html":{"href":"https://github.com/apache/spark/pull/49326"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49326"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49326/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49326/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49326/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/dae6790b02cb5be473b739acda0c7c9d944b8d90"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49325","id":2253616173,"node_id":"PR_kwDOAQXtWs6GU3Qt","html_url":"https://github.com/apache/spark/pull/49325","diff_url":"https://github.com/apache/spark/pull/49325.diff","patch_url":"https://github.com/apache/spark/pull/49325.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49325","number":49325,"state":"closed","locked":false,"title":"[SPARK-50692] Add RPAD pushdown support","user":{"login":"andrej-db","id":159923197,"node_id":"U_kgDOCYg7_Q","avatar_url":"https://avatars.githubusercontent.com/u/159923197?v=4","gravatar_id":"","url":"https://api.github.com/users/andrej-db","html_url":"https://github.com/andrej-db","followers_url":"https://api.github.com/users/andrej-db/followers","following_url":"https://api.github.com/users/andrej-db/following{/other_user}","gists_url":"https://api.github.com/users/andrej-db/gists{/gist_id}","starred_url":"https://api.github.com/users/andrej-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrej-db/subscriptions","organizations_url":"https://api.github.com/users/andrej-db/orgs","repos_url":"https://api.github.com/users/andrej-db/repos","events_url":"https://api.github.com/users/andrej-db/events{/privacy}","received_events_url":"https://api.github.com/users/andrej-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR makes RPAD and LPAD functions translatable across connectors. Individual connectors can now support them via their dialects.\r\n\r\n### Why are the changes needed?\r\nWhen trying to compare CHAR(...) and a literal, Spark injects a RPAD function to make the CHAR parameter the same length. This behaviour is per ANSI standard.\r\n\r\nThe problem is that RPAD is not only an unsupported, but an untranslatable function. This prevents CHAR + literal comparison pushdown.\r\n\r\nSolution is to support RPAD pushdowns and implement it when needed.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nThis PR only introduces the ability to support the RPAD pushdown. Individual connectors will have their own tests.\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2024-12-27T17:34:45Z","updated_at":"2024-12-31T08:27:46Z","closed_at":"2024-12-31T08:27:45Z","merged_at":null,"merge_commit_sha":"bc2637ed78b2c35dcacd8ec95d3e83396eb11f3f","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49325/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49325/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49325/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8eae831ea9e2088fea582638c99a4646c78706d3","head":{"label":"andrej-db:SPARK-50692-RPAD","ref":"SPARK-50692-RPAD","sha":"8eae831ea9e2088fea582638c99a4646c78706d3","user":{"login":"andrej-db","id":159923197,"node_id":"U_kgDOCYg7_Q","avatar_url":"https://avatars.githubusercontent.com/u/159923197?v=4","gravatar_id":"","url":"https://api.github.com/users/andrej-db","html_url":"https://github.com/andrej-db","followers_url":"https://api.github.com/users/andrej-db/followers","following_url":"https://api.github.com/users/andrej-db/following{/other_user}","gists_url":"https://api.github.com/users/andrej-db/gists{/gist_id}","starred_url":"https://api.github.com/users/andrej-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrej-db/subscriptions","organizations_url":"https://api.github.com/users/andrej-db/orgs","repos_url":"https://api.github.com/users/andrej-db/repos","events_url":"https://api.github.com/users/andrej-db/events{/privacy}","received_events_url":"https://api.github.com/users/andrej-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":760417345,"node_id":"R_kgDOLVMMQQ","name":"spark","full_name":"andrej-db/spark","private":false,"owner":{"login":"andrej-db","id":159923197,"node_id":"U_kgDOCYg7_Q","avatar_url":"https://avatars.githubusercontent.com/u/159923197?v=4","gravatar_id":"","url":"https://api.github.com/users/andrej-db","html_url":"https://github.com/andrej-db","followers_url":"https://api.github.com/users/andrej-db/followers","following_url":"https://api.github.com/users/andrej-db/following{/other_user}","gists_url":"https://api.github.com/users/andrej-db/gists{/gist_id}","starred_url":"https://api.github.com/users/andrej-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrej-db/subscriptions","organizations_url":"https://api.github.com/users/andrej-db/orgs","repos_url":"https://api.github.com/users/andrej-db/repos","events_url":"https://api.github.com/users/andrej-db/events{/privacy}","received_events_url":"https://api.github.com/users/andrej-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/andrej-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/andrej-db/spark","forks_url":"https://api.github.com/repos/andrej-db/spark/forks","keys_url":"https://api.github.com/repos/andrej-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/andrej-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/andrej-db/spark/teams","hooks_url":"https://api.github.com/repos/andrej-db/spark/hooks","issue_events_url":"https://api.github.com/repos/andrej-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/andrej-db/spark/events","assignees_url":"https://api.github.com/repos/andrej-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/andrej-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/andrej-db/spark/tags","blobs_url":"https://api.github.com/repos/andrej-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/andrej-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/andrej-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/andrej-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/andrej-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/andrej-db/spark/languages","stargazers_url":"https://api.github.com/repos/andrej-db/spark/stargazers","contributors_url":"https://api.github.com/repos/andrej-db/spark/contributors","subscribers_url":"https://api.github.com/repos/andrej-db/spark/subscribers","subscription_url":"https://api.github.com/repos/andrej-db/spark/subscription","commits_url":"https://api.github.com/repos/andrej-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/andrej-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/andrej-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/andrej-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/andrej-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/andrej-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/andrej-db/spark/merges","archive_url":"https://api.github.com/repos/andrej-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/andrej-db/spark/downloads","issues_url":"https://api.github.com/repos/andrej-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/andrej-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/andrej-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/andrej-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/andrej-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/andrej-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/andrej-db/spark/deployments","created_at":"2024-02-20T11:36:13Z","updated_at":"2024-10-23T08:51:24Z","pushed_at":"2024-12-30T12:11:33Z","git_url":"git://github.com/andrej-db/spark.git","ssh_url":"git@github.com:andrej-db/spark.git","clone_url":"https://github.com/andrej-db/spark.git","svn_url":"https://github.com/andrej-db/spark","homepage":"https://spark.apache.org/","size":480201,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"af53ee455e217ec59313555df33ebb4b038f76c7","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49325"},"html":{"href":"https://github.com/apache/spark/pull/49325"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49325"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49325/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49325/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49325/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8eae831ea9e2088fea582638c99a4646c78706d3"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49324","id":2253572662,"node_id":"PR_kwDOAQXtWs6GUso2","html_url":"https://github.com/apache/spark/pull/49324","diff_url":"https://github.com/apache/spark/pull/49324.diff","patch_url":"https://github.com/apache/spark/pull/49324.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49324","number":49324,"state":"closed","locked":false,"title":"[SPARK-49229][Connect] Deduplicate Scala UDF handling in the SparkConnectPlanner","user":{"login":"xupefei","id":1687847,"node_id":"MDQ6VXNlcjE2ODc4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1687847?v=4","gravatar_id":"","url":"https://api.github.com/users/xupefei","html_url":"https://github.com/xupefei","followers_url":"https://api.github.com/users/xupefei/followers","following_url":"https://api.github.com/users/xupefei/following{/other_user}","gists_url":"https://api.github.com/users/xupefei/gists{/gist_id}","starred_url":"https://api.github.com/users/xupefei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xupefei/subscriptions","organizations_url":"https://api.github.com/users/xupefei/orgs","repos_url":"https://api.github.com/users/xupefei/repos","events_url":"https://api.github.com/users/xupefei/events{/privacy}","received_events_url":"https://api.github.com/users/xupefei/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR removes some duplicate codes from `transformScalaFunction` and `transformScalaUDF` methods of `SparkConnectPlanner`.\r\n\r\n\r\n### Why are the changes needed?\r\n\r\nKeep the code tidy.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2024-12-27T16:37:29Z","updated_at":"2024-12-31T09:35:24Z","closed_at":"2024-12-31T00:14:23Z","merged_at":null,"merge_commit_sha":"c9096b1b1d464bcfd4cfb4e94ba78b1805212468","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49324/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49324/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49324/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/624f54b476aaf7827f9f26226105b569cb44d2a4","head":{"label":"xupefei:udf-handling-deduplicate","ref":"udf-handling-deduplicate","sha":"624f54b476aaf7827f9f26226105b569cb44d2a4","user":{"login":"xupefei","id":1687847,"node_id":"MDQ6VXNlcjE2ODc4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1687847?v=4","gravatar_id":"","url":"https://api.github.com/users/xupefei","html_url":"https://github.com/xupefei","followers_url":"https://api.github.com/users/xupefei/followers","following_url":"https://api.github.com/users/xupefei/following{/other_user}","gists_url":"https://api.github.com/users/xupefei/gists{/gist_id}","starred_url":"https://api.github.com/users/xupefei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xupefei/subscriptions","organizations_url":"https://api.github.com/users/xupefei/orgs","repos_url":"https://api.github.com/users/xupefei/repos","events_url":"https://api.github.com/users/xupefei/events{/privacy}","received_events_url":"https://api.github.com/users/xupefei/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":777257207,"node_id":"R_kgDOLlQA9w","name":"spark","full_name":"xupefei/spark","private":false,"owner":{"login":"xupefei","id":1687847,"node_id":"MDQ6VXNlcjE2ODc4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1687847?v=4","gravatar_id":"","url":"https://api.github.com/users/xupefei","html_url":"https://github.com/xupefei","followers_url":"https://api.github.com/users/xupefei/followers","following_url":"https://api.github.com/users/xupefei/following{/other_user}","gists_url":"https://api.github.com/users/xupefei/gists{/gist_id}","starred_url":"https://api.github.com/users/xupefei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xupefei/subscriptions","organizations_url":"https://api.github.com/users/xupefei/orgs","repos_url":"https://api.github.com/users/xupefei/repos","events_url":"https://api.github.com/users/xupefei/events{/privacy}","received_events_url":"https://api.github.com/users/xupefei/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xupefei/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xupefei/spark","forks_url":"https://api.github.com/repos/xupefei/spark/forks","keys_url":"https://api.github.com/repos/xupefei/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xupefei/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xupefei/spark/teams","hooks_url":"https://api.github.com/repos/xupefei/spark/hooks","issue_events_url":"https://api.github.com/repos/xupefei/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xupefei/spark/events","assignees_url":"https://api.github.com/repos/xupefei/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xupefei/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xupefei/spark/tags","blobs_url":"https://api.github.com/repos/xupefei/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xupefei/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xupefei/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xupefei/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xupefei/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xupefei/spark/languages","stargazers_url":"https://api.github.com/repos/xupefei/spark/stargazers","contributors_url":"https://api.github.com/repos/xupefei/spark/contributors","subscribers_url":"https://api.github.com/repos/xupefei/spark/subscribers","subscription_url":"https://api.github.com/repos/xupefei/spark/subscription","commits_url":"https://api.github.com/repos/xupefei/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xupefei/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xupefei/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xupefei/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xupefei/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xupefei/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xupefei/spark/merges","archive_url":"https://api.github.com/repos/xupefei/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xupefei/spark/downloads","issues_url":"https://api.github.com/repos/xupefei/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xupefei/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xupefei/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xupefei/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xupefei/spark/labels{/name}","releases_url":"https://api.github.com/repos/xupefei/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xupefei/spark/deployments","created_at":"2024-03-25T14:06:50Z","updated_at":"2024-11-22T14:19:33Z","pushed_at":"2025-02-06T21:18:51Z","git_url":"git://github.com/xupefei/spark.git","ssh_url":"git@github.com:xupefei/spark.git","clone_url":"https://github.com/xupefei/spark.git","svn_url":"https://github.com/xupefei/spark","homepage":"https://spark.apache.org/","size":420345,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"af53ee455e217ec59313555df33ebb4b038f76c7","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49324"},"html":{"href":"https://github.com/apache/spark/pull/49324"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49324"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49324/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49324/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49324/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/624f54b476aaf7827f9f26226105b569cb44d2a4"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49323","id":2253509619,"node_id":"PR_kwDOAQXtWs6GUdPz","html_url":"https://github.com/apache/spark/pull/49323","diff_url":"https://github.com/apache/spark/pull/49323.diff","patch_url":"https://github.com/apache/spark/pull/49323.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49323","number":49323,"state":"closed","locked":false,"title":"[SPARK-50661][CONNECT][SS] Fix Spark Connect Scala foreachBatch impl. to support Dataset[T].","user":{"login":"haiyangsun-db","id":75672016,"node_id":"MDQ6VXNlcjc1NjcyMDE2","avatar_url":"https://avatars.githubusercontent.com/u/75672016?v=4","gravatar_id":"","url":"https://api.github.com/users/haiyangsun-db","html_url":"https://github.com/haiyangsun-db","followers_url":"https://api.github.com/users/haiyangsun-db/followers","following_url":"https://api.github.com/users/haiyangsun-db/following{/other_user}","gists_url":"https://api.github.com/users/haiyangsun-db/gists{/gist_id}","starred_url":"https://api.github.com/users/haiyangsun-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haiyangsun-db/subscriptions","organizations_url":"https://api.github.com/users/haiyangsun-db/orgs","repos_url":"https://api.github.com/users/haiyangsun-db/repos","events_url":"https://api.github.com/users/haiyangsun-db/events{/privacy}","received_events_url":"https://api.github.com/users/haiyangsun-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nThis PR fixes incorrect implementation of Scala Streaming foreachBatch when the input dataset is not a DataFrame (but a Dataset[T]) in spark connect mode. \r\n\r\n**Note** that this only affects `Scala`.\r\n\r\nIn `DataStreamWriter`:\r\n- serialize foreachBatch function together with the dataset's encoder.\r\n- reuse ForeachWriterPacket for foreachBatch as both are sink operations and only require a function/writer object and the encoder of the input. Optionally, we could rename `ForeachWriterPacket` to something more general for both cases.\r\n\r\nIn `SparkConnectPlanner` / `StreamingForeachBatchHelper`\r\n- Use the encoder passed from the client to recover the Dataset[T] object to properly call the foreachBatch function.\r\n\r\n\r\n### Why are the changes needed?\r\nWithout the fix, Scala foreachBatch will fail or give wrong results when the input dataset is not a DataFrame.\r\n\r\nBelow is a simple reproduction:\r\n\r\n```\r\nimport org.apache.spark.sql._\r\nspark.range(10).write.format(\"parquet\").mode(\"overwrite\").save(\"/tmp/test\")\r\n\r\nval q = spark.readStream.format(\"parquet\").schema(\"id LONG\").load(\"/tmp/test\").as[java.lang.Long].writeStream.foreachBatch((ds: Dataset[java.lang.Long], batchId: Long) => println(ds.collect().map(_.asInstanceOf[Long]).sum)).start()\r\n\r\nThread.sleep(1000)\r\nq.stop()\r\n```\r\n\r\nThe code above should output 45 in the foreachBatch function. Without the fix, the code will fail because the foreachBatch function will be called with a DataFrame object instead of Dataset[java.lang.Long].\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes, this PR includes fixes to the Spark Connect client (we add the encoder to the foreachBatch function during serialization) around the foreachBatch API.\r\n\r\n### How was this patch tested?\r\n1. Run end-to-end test with spark-shell (with spark connect server and client running in connect mode).\r\n2. New / updated unit tests that would have failed without the fix.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.\r\n","created_at":"2024-12-27T15:23:14Z","updated_at":"2024-12-28T07:21:03Z","closed_at":"2024-12-28T07:21:03Z","merged_at":null,"merge_commit_sha":"821a0b9303ed4eb8b0ef315d453c01d2b57b0259","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49323/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49323/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49323/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2fbd4e996630c8b4dab1adcbe6cd25ca50d51baf","head":{"label":"haiyangsun-db:SPARK-50661","ref":"SPARK-50661","sha":"2fbd4e996630c8b4dab1adcbe6cd25ca50d51baf","user":{"login":"haiyangsun-db","id":75672016,"node_id":"MDQ6VXNlcjc1NjcyMDE2","avatar_url":"https://avatars.githubusercontent.com/u/75672016?v=4","gravatar_id":"","url":"https://api.github.com/users/haiyangsun-db","html_url":"https://github.com/haiyangsun-db","followers_url":"https://api.github.com/users/haiyangsun-db/followers","following_url":"https://api.github.com/users/haiyangsun-db/following{/other_user}","gists_url":"https://api.github.com/users/haiyangsun-db/gists{/gist_id}","starred_url":"https://api.github.com/users/haiyangsun-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haiyangsun-db/subscriptions","organizations_url":"https://api.github.com/users/haiyangsun-db/orgs","repos_url":"https://api.github.com/users/haiyangsun-db/repos","events_url":"https://api.github.com/users/haiyangsun-db/events{/privacy}","received_events_url":"https://api.github.com/users/haiyangsun-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":374987428,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ5ODc0Mjg=","name":"spark","full_name":"haiyangsun-db/spark","private":false,"owner":{"login":"haiyangsun-db","id":75672016,"node_id":"MDQ6VXNlcjc1NjcyMDE2","avatar_url":"https://avatars.githubusercontent.com/u/75672016?v=4","gravatar_id":"","url":"https://api.github.com/users/haiyangsun-db","html_url":"https://github.com/haiyangsun-db","followers_url":"https://api.github.com/users/haiyangsun-db/followers","following_url":"https://api.github.com/users/haiyangsun-db/following{/other_user}","gists_url":"https://api.github.com/users/haiyangsun-db/gists{/gist_id}","starred_url":"https://api.github.com/users/haiyangsun-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haiyangsun-db/subscriptions","organizations_url":"https://api.github.com/users/haiyangsun-db/orgs","repos_url":"https://api.github.com/users/haiyangsun-db/repos","events_url":"https://api.github.com/users/haiyangsun-db/events{/privacy}","received_events_url":"https://api.github.com/users/haiyangsun-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/haiyangsun-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/haiyangsun-db/spark","forks_url":"https://api.github.com/repos/haiyangsun-db/spark/forks","keys_url":"https://api.github.com/repos/haiyangsun-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/haiyangsun-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/haiyangsun-db/spark/teams","hooks_url":"https://api.github.com/repos/haiyangsun-db/spark/hooks","issue_events_url":"https://api.github.com/repos/haiyangsun-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/haiyangsun-db/spark/events","assignees_url":"https://api.github.com/repos/haiyangsun-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/haiyangsun-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/haiyangsun-db/spark/tags","blobs_url":"https://api.github.com/repos/haiyangsun-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/haiyangsun-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/haiyangsun-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/haiyangsun-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/haiyangsun-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/haiyangsun-db/spark/languages","stargazers_url":"https://api.github.com/repos/haiyangsun-db/spark/stargazers","contributors_url":"https://api.github.com/repos/haiyangsun-db/spark/contributors","subscribers_url":"https://api.github.com/repos/haiyangsun-db/spark/subscribers","subscription_url":"https://api.github.com/repos/haiyangsun-db/spark/subscription","commits_url":"https://api.github.com/repos/haiyangsun-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/haiyangsun-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/haiyangsun-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/haiyangsun-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/haiyangsun-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/haiyangsun-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/haiyangsun-db/spark/merges","archive_url":"https://api.github.com/repos/haiyangsun-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/haiyangsun-db/spark/downloads","issues_url":"https://api.github.com/repos/haiyangsun-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/haiyangsun-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/haiyangsun-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/haiyangsun-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/haiyangsun-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/haiyangsun-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/haiyangsun-db/spark/deployments","created_at":"2021-06-08T11:39:54Z","updated_at":"2024-12-27T14:57:28Z","pushed_at":"2024-12-27T23:08:56Z","git_url":"git://github.com/haiyangsun-db/spark.git","ssh_url":"git@github.com:haiyangsun-db/spark.git","clone_url":"https://github.com/haiyangsun-db/spark.git","svn_url":"https://github.com/haiyangsun-db/spark","homepage":"https://spark.apache.org/","size":455182,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"af53ee455e217ec59313555df33ebb4b038f76c7","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49323"},"html":{"href":"https://github.com/apache/spark/pull/49323"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49323"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49323/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49323/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49323/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2fbd4e996630c8b4dab1adcbe6cd25ca50d51baf"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49322","id":2253506362,"node_id":"PR_kwDOAQXtWs6GUcc6","html_url":"https://github.com/apache/spark/pull/49322","diff_url":"https://github.com/apache/spark/pull/49322.diff","patch_url":"https://github.com/apache/spark/pull/49322.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49322","number":49322,"state":"closed","locked":false,"title":"[SPARK-50691][SQL][FOLLOWUP] Use UnsafeProjection for LocalRelation rows instead of ComparableLocalRelation","user":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nUse `UnsafeProjection` for `LocalRelation` rows instead of `ComparableLocalRelation`.\r\n\r\n### Why are the changes needed?\r\n\r\n`UnsafeRow.equals` compares the whole byte sequence under it, so it's a convenient way to compare all kind of row values, including `ArrayBasedMapData`.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nExisting test.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\ncopilot.nvim.","created_at":"2024-12-27T15:19:23Z","updated_at":"2024-12-30T12:41:29Z","closed_at":"2024-12-30T12:41:29Z","merged_at":null,"merge_commit_sha":"2077f0d25bde36ae9c53ef04ed0db93ec9dfb6c4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49322/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49322/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49322/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c87fef099572b5236ed71ac890a683770c9d0bb7","head":{"label":"vladimirg-db:vladimirg-db/update-comparable-local-relation-to-cover-unsafe-row","ref":"vladimirg-db/update-comparable-local-relation-to-cover-unsafe-row","sha":"c87fef099572b5236ed71ac890a683770c9d0bb7","user":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":833519707,"node_id":"R_kgDOMa6AWw","name":"spark","full_name":"vladimirg-db/spark","private":false,"owner":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vladimirg-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/vladimirg-db/spark","forks_url":"https://api.github.com/repos/vladimirg-db/spark/forks","keys_url":"https://api.github.com/repos/vladimirg-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vladimirg-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vladimirg-db/spark/teams","hooks_url":"https://api.github.com/repos/vladimirg-db/spark/hooks","issue_events_url":"https://api.github.com/repos/vladimirg-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vladimirg-db/spark/events","assignees_url":"https://api.github.com/repos/vladimirg-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vladimirg-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vladimirg-db/spark/tags","blobs_url":"https://api.github.com/repos/vladimirg-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vladimirg-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vladimirg-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vladimirg-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vladimirg-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vladimirg-db/spark/languages","stargazers_url":"https://api.github.com/repos/vladimirg-db/spark/stargazers","contributors_url":"https://api.github.com/repos/vladimirg-db/spark/contributors","subscribers_url":"https://api.github.com/repos/vladimirg-db/spark/subscribers","subscription_url":"https://api.github.com/repos/vladimirg-db/spark/subscription","commits_url":"https://api.github.com/repos/vladimirg-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vladimirg-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vladimirg-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vladimirg-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vladimirg-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vladimirg-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vladimirg-db/spark/merges","archive_url":"https://api.github.com/repos/vladimirg-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vladimirg-db/spark/downloads","issues_url":"https://api.github.com/repos/vladimirg-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vladimirg-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vladimirg-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vladimirg-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vladimirg-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/vladimirg-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vladimirg-db/spark/deployments","created_at":"2024-07-25T08:13:07Z","updated_at":"2025-02-09T11:09:18Z","pushed_at":"2025-02-09T15:06:47Z","git_url":"git://github.com/vladimirg-db/spark.git","ssh_url":"git@github.com:vladimirg-db/spark.git","clone_url":"https://github.com/vladimirg-db/spark.git","svn_url":"https://github.com/vladimirg-db/spark","homepage":"https://spark.apache.org/","size":424040,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7d5aaaad61f2e2f843a982bb565ceb1578812eef","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49322"},"html":{"href":"https://github.com/apache/spark/pull/49322"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49322"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49322/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49322/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49322/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c87fef099572b5236ed71ac890a683770c9d0bb7"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49321","id":2253452657,"node_id":"PR_kwDOAQXtWs6GUPVx","html_url":"https://github.com/apache/spark/pull/49321","diff_url":"https://github.com/apache/spark/pull/49321.diff","patch_url":"https://github.com/apache/spark/pull/49321.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49321","number":49321,"state":"closed","locked":false,"title":"[SPARK-50690][SQL] Fix discrepancy in DESCRIBE TABLE view query output columns quoting","user":{"login":"asl3","id":68875504,"node_id":"MDQ6VXNlcjY4ODc1NTA0","avatar_url":"https://avatars.githubusercontent.com/u/68875504?v=4","gravatar_id":"","url":"https://api.github.com/users/asl3","html_url":"https://github.com/asl3","followers_url":"https://api.github.com/users/asl3/followers","following_url":"https://api.github.com/users/asl3/following{/other_user}","gists_url":"https://api.github.com/users/asl3/gists{/gist_id}","starred_url":"https://api.github.com/users/asl3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asl3/subscriptions","organizations_url":"https://api.github.com/users/asl3/orgs","repos_url":"https://api.github.com/users/asl3/repos","events_url":"https://api.github.com/users/asl3/events{/privacy}","received_events_url":"https://api.github.com/users/asl3/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nPreviously, the `DESCRIBE TABLE` SQL command displayed column lists such as bucket and sort columns as so:\r\n\r\n```\r\nBucket Columns          [`a`]                                       \r\nSort Columns            [`b`] \r\n```\r\n \r\nHowever view query output columns were not quoted:\r\n\r\n```\r\nView Query Output Columns      [c1] \r\n```\r\n\r\nThis PR fixes the discrepancy by quoting the view query output columns with ``:\r\n\r\n```\r\nView Query Output Columns      [`c1`] \r\n```\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nThe change ensures cohesive `DESCRIBE TABLE` output, which can improve parsing and readability.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\nYes, this modifies the view query output columns portion of the `DESCRIBE TABLE` output.\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\nExisting SQL tests, including golden file output\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\n\r\nNo\r\n","created_at":"2024-12-27T14:18:04Z","updated_at":"2024-12-28T07:24:11Z","closed_at":"2024-12-28T07:24:11Z","merged_at":null,"merge_commit_sha":"86ac551ee162cfe828c07a1e3302f8590bf10707","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49321/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49321/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49321/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f1aec88f11271fac9648708e398d028e542dfcdc","head":{"label":"asl3:asl3/describe-viewqueryoutputcolumns","ref":"asl3/describe-viewqueryoutputcolumns","sha":"f1aec88f11271fac9648708e398d028e542dfcdc","user":{"login":"asl3","id":68875504,"node_id":"MDQ6VXNlcjY4ODc1NTA0","avatar_url":"https://avatars.githubusercontent.com/u/68875504?v=4","gravatar_id":"","url":"https://api.github.com/users/asl3","html_url":"https://github.com/asl3","followers_url":"https://api.github.com/users/asl3/followers","following_url":"https://api.github.com/users/asl3/following{/other_user}","gists_url":"https://api.github.com/users/asl3/gists{/gist_id}","starred_url":"https://api.github.com/users/asl3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asl3/subscriptions","organizations_url":"https://api.github.com/users/asl3/orgs","repos_url":"https://api.github.com/users/asl3/repos","events_url":"https://api.github.com/users/asl3/events{/privacy}","received_events_url":"https://api.github.com/users/asl3/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":645574658,"node_id":"R_kgDOJnqwAg","name":"spark","full_name":"asl3/spark","private":false,"owner":{"login":"asl3","id":68875504,"node_id":"MDQ6VXNlcjY4ODc1NTA0","avatar_url":"https://avatars.githubusercontent.com/u/68875504?v=4","gravatar_id":"","url":"https://api.github.com/users/asl3","html_url":"https://github.com/asl3","followers_url":"https://api.github.com/users/asl3/followers","following_url":"https://api.github.com/users/asl3/following{/other_user}","gists_url":"https://api.github.com/users/asl3/gists{/gist_id}","starred_url":"https://api.github.com/users/asl3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asl3/subscriptions","organizations_url":"https://api.github.com/users/asl3/orgs","repos_url":"https://api.github.com/users/asl3/repos","events_url":"https://api.github.com/users/asl3/events{/privacy}","received_events_url":"https://api.github.com/users/asl3/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/asl3/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/asl3/spark","forks_url":"https://api.github.com/repos/asl3/spark/forks","keys_url":"https://api.github.com/repos/asl3/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/asl3/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/asl3/spark/teams","hooks_url":"https://api.github.com/repos/asl3/spark/hooks","issue_events_url":"https://api.github.com/repos/asl3/spark/issues/events{/number}","events_url":"https://api.github.com/repos/asl3/spark/events","assignees_url":"https://api.github.com/repos/asl3/spark/assignees{/user}","branches_url":"https://api.github.com/repos/asl3/spark/branches{/branch}","tags_url":"https://api.github.com/repos/asl3/spark/tags","blobs_url":"https://api.github.com/repos/asl3/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/asl3/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/asl3/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/asl3/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/asl3/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/asl3/spark/languages","stargazers_url":"https://api.github.com/repos/asl3/spark/stargazers","contributors_url":"https://api.github.com/repos/asl3/spark/contributors","subscribers_url":"https://api.github.com/repos/asl3/spark/subscribers","subscription_url":"https://api.github.com/repos/asl3/spark/subscription","commits_url":"https://api.github.com/repos/asl3/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/asl3/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/asl3/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/asl3/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/asl3/spark/contents/{+path}","compare_url":"https://api.github.com/repos/asl3/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/asl3/spark/merges","archive_url":"https://api.github.com/repos/asl3/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/asl3/spark/downloads","issues_url":"https://api.github.com/repos/asl3/spark/issues{/number}","pulls_url":"https://api.github.com/repos/asl3/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/asl3/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/asl3/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/asl3/spark/labels{/name}","releases_url":"https://api.github.com/repos/asl3/spark/releases{/id}","deployments_url":"https://api.github.com/repos/asl3/spark/deployments","created_at":"2023-05-26T00:58:40Z","updated_at":"2025-02-05T16:23:39Z","pushed_at":"2025-02-05T21:07:02Z","git_url":"git://github.com/asl3/spark.git","ssh_url":"git@github.com:asl3/spark.git","clone_url":"https://github.com/asl3/spark.git","svn_url":"https://github.com/asl3/spark","homepage":"https://spark.apache.org/","size":430786,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"939129ec01af7f7b6dbec737f2d4149d2fc0d9a3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49321"},"html":{"href":"https://github.com/apache/spark/pull/49321"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49321"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49321/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49321/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49321/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f1aec88f11271fac9648708e398d028e542dfcdc"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49320","id":2253413939,"node_id":"PR_kwDOAQXtWs6GUF4z","html_url":"https://github.com/apache/spark/pull/49320","diff_url":"https://github.com/apache/spark/pull/49320.diff","patch_url":"https://github.com/apache/spark/pull/49320.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49320","number":49320,"state":"closed","locked":false,"title":"[SPARK-50696][PYTHON] Optimize Py4J call for DDL parse method","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nOptimize the DDL parse method in Python\r\n\r\n\r\n### Why are the changes needed?\r\nto reduce the Py4J calls\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nExisting tests\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2024-12-27T13:35:30Z","updated_at":"2024-12-30T02:04:35Z","closed_at":"2024-12-30T01:46:45Z","merged_at":null,"merge_commit_sha":"509655108c0f62f8a6c6b4a0a09e269ff637d440","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49320/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49320/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49320/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3281cb74e0ae020384cc18e14e71abb14c955bcb","head":{"label":"zhengruifeng:py_opt_ddl","ref":"py_opt_ddl","sha":"3281cb74e0ae020384cc18e14e71abb14c955bcb","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"939129ec01af7f7b6dbec737f2d4149d2fc0d9a3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49320"},"html":{"href":"https://github.com/apache/spark/pull/49320"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49320"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49320/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49320/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49320/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3281cb74e0ae020384cc18e14e71abb14c955bcb"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49319","id":2253353632,"node_id":"PR_kwDOAQXtWs6GT3Kg","html_url":"https://github.com/apache/spark/pull/49319","diff_url":"https://github.com/apache/spark/pull/49319.diff","patch_url":"https://github.com/apache/spark/pull/49319.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49319","number":49319,"state":"closed","locked":false,"title":"[SPARK-50689][SQL] Enforce deterministic ordering in LCA project lists","user":{"login":"mihailotim-db","id":174342191,"node_id":"U_kgDOCmRALw","avatar_url":"https://avatars.githubusercontent.com/u/174342191?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailotim-db","html_url":"https://github.com/mihailotim-db","followers_url":"https://api.github.com/users/mihailotim-db/followers","following_url":"https://api.github.com/users/mihailotim-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailotim-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailotim-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailotim-db/subscriptions","organizations_url":"https://api.github.com/users/mihailotim-db/orgs","repos_url":"https://api.github.com/users/mihailotim-db/repos","events_url":"https://api.github.com/users/mihailotim-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailotim-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nUsing `Set` to produce project lists may result in those projects being non-deterministic. Instead we switch to using `LinkedHashSet`.\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nIt's better for the analyzer to produce stable query plans, regardless of the java/scala versions.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nexisting tests\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nno","created_at":"2024-12-27T12:32:27Z","updated_at":"2024-12-30T10:24:51Z","closed_at":"2024-12-27T15:19:05Z","merged_at":null,"merge_commit_sha":"6cd6a84399791e1f0d92526cebe4133dcfd08d23","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49319/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49319/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49319/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d7fc8f7b85e58d09d5b7afb6a42867ffecfa0d9c","head":{"label":"mihailotim-db:mihailotim-db/linked_set_lca","ref":"mihailotim-db/linked_set_lca","sha":"d7fc8f7b85e58d09d5b7afb6a42867ffecfa0d9c","user":{"login":"mihailotim-db","id":174342191,"node_id":"U_kgDOCmRALw","avatar_url":"https://avatars.githubusercontent.com/u/174342191?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailotim-db","html_url":"https://github.com/mihailotim-db","followers_url":"https://api.github.com/users/mihailotim-db/followers","following_url":"https://api.github.com/users/mihailotim-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailotim-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailotim-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailotim-db/subscriptions","organizations_url":"https://api.github.com/users/mihailotim-db/orgs","repos_url":"https://api.github.com/users/mihailotim-db/repos","events_url":"https://api.github.com/users/mihailotim-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailotim-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":823540258,"node_id":"R_kgDOMRY6Ig","name":"spark","full_name":"mihailotim-db/spark","private":false,"owner":{"login":"mihailotim-db","id":174342191,"node_id":"U_kgDOCmRALw","avatar_url":"https://avatars.githubusercontent.com/u/174342191?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailotim-db","html_url":"https://github.com/mihailotim-db","followers_url":"https://api.github.com/users/mihailotim-db/followers","following_url":"https://api.github.com/users/mihailotim-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailotim-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailotim-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailotim-db/subscriptions","organizations_url":"https://api.github.com/users/mihailotim-db/orgs","repos_url":"https://api.github.com/users/mihailotim-db/repos","events_url":"https://api.github.com/users/mihailotim-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailotim-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/mihailotim-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/mihailotim-db/spark","forks_url":"https://api.github.com/repos/mihailotim-db/spark/forks","keys_url":"https://api.github.com/repos/mihailotim-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/mihailotim-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/mihailotim-db/spark/teams","hooks_url":"https://api.github.com/repos/mihailotim-db/spark/hooks","issue_events_url":"https://api.github.com/repos/mihailotim-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/mihailotim-db/spark/events","assignees_url":"https://api.github.com/repos/mihailotim-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/mihailotim-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/mihailotim-db/spark/tags","blobs_url":"https://api.github.com/repos/mihailotim-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/mihailotim-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/mihailotim-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/mihailotim-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/mihailotim-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/mihailotim-db/spark/languages","stargazers_url":"https://api.github.com/repos/mihailotim-db/spark/stargazers","contributors_url":"https://api.github.com/repos/mihailotim-db/spark/contributors","subscribers_url":"https://api.github.com/repos/mihailotim-db/spark/subscribers","subscription_url":"https://api.github.com/repos/mihailotim-db/spark/subscription","commits_url":"https://api.github.com/repos/mihailotim-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/mihailotim-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/mihailotim-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/mihailotim-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/mihailotim-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/mihailotim-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/mihailotim-db/spark/merges","archive_url":"https://api.github.com/repos/mihailotim-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/mihailotim-db/spark/downloads","issues_url":"https://api.github.com/repos/mihailotim-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/mihailotim-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/mihailotim-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/mihailotim-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/mihailotim-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/mihailotim-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/mihailotim-db/spark/deployments","created_at":"2024-07-03T08:18:27Z","updated_at":"2024-08-21T14:53:45Z","pushed_at":"2025-02-04T16:22:41Z","git_url":"git://github.com/mihailotim-db/spark.git","ssh_url":"git@github.com:mihailotim-db/spark.git","clone_url":"https://github.com/mihailotim-db/spark.git","svn_url":"https://github.com/mihailotim-db/spark","homepage":"https://spark.apache.org/","size":423337,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"939129ec01af7f7b6dbec737f2d4149d2fc0d9a3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49319"},"html":{"href":"https://github.com/apache/spark/pull/49319"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49319"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49319/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49319/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49319/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d7fc8f7b85e58d09d5b7afb6a42867ffecfa0d9c"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49318","id":2253353192,"node_id":"PR_kwDOAQXtWs6GT3Do","html_url":"https://github.com/apache/spark/pull/49318","diff_url":"https://github.com/apache/spark/pull/49318.diff","patch_url":"https://github.com/apache/spark/pull/49318.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49318","number":49318,"state":"open","locked":false,"title":"[SPARK-48665][PYTHON][CONNECT] Support providing a dict in pyspark lit to create a map. ","user":{"login":"skanderboudawara","id":108568261,"node_id":"U_kgDOBniexQ","avatar_url":"https://avatars.githubusercontent.com/u/108568261?v=4","gravatar_id":"","url":"https://api.github.com/users/skanderboudawara","html_url":"https://github.com/skanderboudawara","followers_url":"https://api.github.com/users/skanderboudawara/followers","following_url":"https://api.github.com/users/skanderboudawara/following{/other_user}","gists_url":"https://api.github.com/users/skanderboudawara/gists{/gist_id}","starred_url":"https://api.github.com/users/skanderboudawara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skanderboudawara/subscriptions","organizations_url":"https://api.github.com/users/skanderboudawara/orgs","repos_url":"https://api.github.com/users/skanderboudawara/repos","events_url":"https://api.github.com/users/skanderboudawara/events{/privacy}","received_events_url":"https://api.github.com/users/skanderboudawara/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"# What changes were proposed in this pull request?\r\n\r\nReopening the [PR ](https://github.com/apache/spark/pull/47031)done by [Ronserruya](https://github.com/Ronserruya)  and addidng small changes.\r\n\r\nAdded the option to provide a dict to `pyspark.sql.functions.lit` in order to create a map\r\n\r\n## Why are the changes needed?\r\n\r\nTo make it easier to create a map in pyspark.\r\nCurrently, it is only possible via `create_map` which requires a sequence of key,value,key,value...\r\nScala already supports such functionality using `typedLit`\r\n\r\nA [similar PR](https://github.com/apache/spark/pull/37722) was done in the past to add similar functionality for the creating of an array using a list, so I tried to follow all the changes done there as well.\r\n\r\n## Does this PR introduce any user-facing change?\r\n\r\nYes, docstring of `lit` was edited, and new functionality was added\r\n\r\nBefore:\r\n```\r\nfrom pyspark.sql import functions as F\r\nF.lit({\"a\":1})\r\n# pyspark.errors.exceptions.captured.SparkRuntimeException: [UNSUPPORTED_FEATURE.LITERAL_TYPE] The feature is not supported: Literal for '{asd=2}' of class java.util.HashMap.\r\n```\r\nAfter:\r\n```\r\nfrom pyspark.sql import functions as F\r\nF.lit({\"a\":1, \"b\": 2})\r\n# Column<'map(a, 1, b, 2)'>\r\n```\r\n## How was this patch tested?\r\n\r\nManual tests + unittest in CI\r\n\r\n## Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo","created_at":"2024-12-27T12:31:56Z","updated_at":"2025-01-14T10:06:24Z","closed_at":null,"merged_at":null,"merge_commit_sha":null,"assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49318/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49318/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49318/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/45e7be55d3f77c28bd4152c10ab015077ba9d1ed","head":{"label":"skanderboudawara:dev_sbu_SPARK-48665","ref":"dev_sbu_SPARK-48665","sha":"45e7be55d3f77c28bd4152c10ab015077ba9d1ed","user":{"login":"skanderboudawara","id":108568261,"node_id":"U_kgDOBniexQ","avatar_url":"https://avatars.githubusercontent.com/u/108568261?v=4","gravatar_id":"","url":"https://api.github.com/users/skanderboudawara","html_url":"https://github.com/skanderboudawara","followers_url":"https://api.github.com/users/skanderboudawara/followers","following_url":"https://api.github.com/users/skanderboudawara/following{/other_user}","gists_url":"https://api.github.com/users/skanderboudawara/gists{/gist_id}","starred_url":"https://api.github.com/users/skanderboudawara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skanderboudawara/subscriptions","organizations_url":"https://api.github.com/users/skanderboudawara/orgs","repos_url":"https://api.github.com/users/skanderboudawara/repos","events_url":"https://api.github.com/users/skanderboudawara/events{/privacy}","received_events_url":"https://api.github.com/users/skanderboudawara/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":908967190,"node_id":"R_kgDONi29Fg","name":"spark","full_name":"skanderboudawara/spark","private":false,"owner":{"login":"skanderboudawara","id":108568261,"node_id":"U_kgDOBniexQ","avatar_url":"https://avatars.githubusercontent.com/u/108568261?v=4","gravatar_id":"","url":"https://api.github.com/users/skanderboudawara","html_url":"https://github.com/skanderboudawara","followers_url":"https://api.github.com/users/skanderboudawara/followers","following_url":"https://api.github.com/users/skanderboudawara/following{/other_user}","gists_url":"https://api.github.com/users/skanderboudawara/gists{/gist_id}","starred_url":"https://api.github.com/users/skanderboudawara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skanderboudawara/subscriptions","organizations_url":"https://api.github.com/users/skanderboudawara/orgs","repos_url":"https://api.github.com/users/skanderboudawara/repos","events_url":"https://api.github.com/users/skanderboudawara/events{/privacy}","received_events_url":"https://api.github.com/users/skanderboudawara/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/skanderboudawara/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/skanderboudawara/spark","forks_url":"https://api.github.com/repos/skanderboudawara/spark/forks","keys_url":"https://api.github.com/repos/skanderboudawara/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/skanderboudawara/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/skanderboudawara/spark/teams","hooks_url":"https://api.github.com/repos/skanderboudawara/spark/hooks","issue_events_url":"https://api.github.com/repos/skanderboudawara/spark/issues/events{/number}","events_url":"https://api.github.com/repos/skanderboudawara/spark/events","assignees_url":"https://api.github.com/repos/skanderboudawara/spark/assignees{/user}","branches_url":"https://api.github.com/repos/skanderboudawara/spark/branches{/branch}","tags_url":"https://api.github.com/repos/skanderboudawara/spark/tags","blobs_url":"https://api.github.com/repos/skanderboudawara/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/skanderboudawara/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/skanderboudawara/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/skanderboudawara/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/skanderboudawara/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/skanderboudawara/spark/languages","stargazers_url":"https://api.github.com/repos/skanderboudawara/spark/stargazers","contributors_url":"https://api.github.com/repos/skanderboudawara/spark/contributors","subscribers_url":"https://api.github.com/repos/skanderboudawara/spark/subscribers","subscription_url":"https://api.github.com/repos/skanderboudawara/spark/subscription","commits_url":"https://api.github.com/repos/skanderboudawara/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/skanderboudawara/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/skanderboudawara/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/skanderboudawara/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/skanderboudawara/spark/contents/{+path}","compare_url":"https://api.github.com/repos/skanderboudawara/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/skanderboudawara/spark/merges","archive_url":"https://api.github.com/repos/skanderboudawara/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/skanderboudawara/spark/downloads","issues_url":"https://api.github.com/repos/skanderboudawara/spark/issues{/number}","pulls_url":"https://api.github.com/repos/skanderboudawara/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/skanderboudawara/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/skanderboudawara/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/skanderboudawara/spark/labels{/name}","releases_url":"https://api.github.com/repos/skanderboudawara/spark/releases{/id}","deployments_url":"https://api.github.com/repos/skanderboudawara/spark/deployments","created_at":"2024-12-27T12:14:29Z","updated_at":"2025-01-04T10:03:32Z","pushed_at":"2025-01-05T11:46:30Z","git_url":"git://github.com/skanderboudawara/spark.git","ssh_url":"git@github.com:skanderboudawara/spark.git","clone_url":"https://github.com/skanderboudawara/spark.git","svn_url":"https://github.com/skanderboudawara/spark","homepage":"https://spark.apache.org/","size":418603,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"939129ec01af7f7b6dbec737f2d4149d2fc0d9a3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49318"},"html":{"href":"https://github.com/apache/spark/pull/49318"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49318"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49318/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49318/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49318/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/45e7be55d3f77c28bd4152c10ab015077ba9d1ed"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49317","id":2253245116,"node_id":"PR_kwDOAQXtWs6GTcq8","html_url":"https://github.com/apache/spark/pull/49317","diff_url":"https://github.com/apache/spark/pull/49317.diff","patch_url":"https://github.com/apache/spark/pull/49317.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49317","number":49317,"state":"closed","locked":false,"title":"[SPARK-50688][SQL] Eliminate ambiguity for rowTag missing in xml write path","user":{"login":"yaooqinn","id":8326978,"node_id":"MDQ6VXNlcjgzMjY5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/8326978?v=4","gravatar_id":"","url":"https://api.github.com/users/yaooqinn","html_url":"https://github.com/yaooqinn","followers_url":"https://api.github.com/users/yaooqinn/followers","following_url":"https://api.github.com/users/yaooqinn/following{/other_user}","gists_url":"https://api.github.com/users/yaooqinn/gists{/gist_id}","starred_url":"https://api.github.com/users/yaooqinn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yaooqinn/subscriptions","organizations_url":"https://api.github.com/users/yaooqinn/orgs","repos_url":"https://api.github.com/users/yaooqinn/repos","events_url":"https://api.github.com/users/yaooqinn/events{/privacy}","received_events_url":"https://api.github.com/users/yaooqinn/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n### What changes were proposed in this pull request?\r\n\r\nThis PR eliminates ambiguity for rowTag missing in the XML write path, the `rowTag` is a must for both read and write.\r\n\r\n### Why are the changes needed?\r\n\r\nbugfix\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nyes, error msg changing\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nnew tests\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nno","created_at":"2024-12-27T10:31:26Z","updated_at":"2024-12-30T02:22:48Z","closed_at":"2024-12-30T02:22:48Z","merged_at":null,"merge_commit_sha":"6873eb7fe9d868e4cfc6b57ef91e459950412c22","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49317/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49317/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49317/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ddfbfb9826573d0a9cf7509997300370192841a6","head":{"label":"yaooqinn:SPARK-50688","ref":"SPARK-50688","sha":"ddfbfb9826573d0a9cf7509997300370192841a6","user":{"login":"yaooqinn","id":8326978,"node_id":"MDQ6VXNlcjgzMjY5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/8326978?v=4","gravatar_id":"","url":"https://api.github.com/users/yaooqinn","html_url":"https://github.com/yaooqinn","followers_url":"https://api.github.com/users/yaooqinn/followers","following_url":"https://api.github.com/users/yaooqinn/following{/other_user}","gists_url":"https://api.github.com/users/yaooqinn/gists{/gist_id}","starred_url":"https://api.github.com/users/yaooqinn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yaooqinn/subscriptions","organizations_url":"https://api.github.com/users/yaooqinn/orgs","repos_url":"https://api.github.com/users/yaooqinn/repos","events_url":"https://api.github.com/users/yaooqinn/events{/privacy}","received_events_url":"https://api.github.com/users/yaooqinn/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":357976080,"node_id":"MDEwOlJlcG9zaXRvcnkzNTc5NzYwODA=","name":"spark","full_name":"yaooqinn/spark","private":false,"owner":{"login":"yaooqinn","id":8326978,"node_id":"MDQ6VXNlcjgzMjY5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/8326978?v=4","gravatar_id":"","url":"https://api.github.com/users/yaooqinn","html_url":"https://github.com/yaooqinn","followers_url":"https://api.github.com/users/yaooqinn/followers","following_url":"https://api.github.com/users/yaooqinn/following{/other_user}","gists_url":"https://api.github.com/users/yaooqinn/gists{/gist_id}","starred_url":"https://api.github.com/users/yaooqinn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yaooqinn/subscriptions","organizations_url":"https://api.github.com/users/yaooqinn/orgs","repos_url":"https://api.github.com/users/yaooqinn/repos","events_url":"https://api.github.com/users/yaooqinn/events{/privacy}","received_events_url":"https://api.github.com/users/yaooqinn/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yaooqinn/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/yaooqinn/spark","forks_url":"https://api.github.com/repos/yaooqinn/spark/forks","keys_url":"https://api.github.com/repos/yaooqinn/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yaooqinn/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yaooqinn/spark/teams","hooks_url":"https://api.github.com/repos/yaooqinn/spark/hooks","issue_events_url":"https://api.github.com/repos/yaooqinn/spark/issues/events{/number}","events_url":"https://api.github.com/repos/yaooqinn/spark/events","assignees_url":"https://api.github.com/repos/yaooqinn/spark/assignees{/user}","branches_url":"https://api.github.com/repos/yaooqinn/spark/branches{/branch}","tags_url":"https://api.github.com/repos/yaooqinn/spark/tags","blobs_url":"https://api.github.com/repos/yaooqinn/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yaooqinn/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yaooqinn/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/yaooqinn/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yaooqinn/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/yaooqinn/spark/languages","stargazers_url":"https://api.github.com/repos/yaooqinn/spark/stargazers","contributors_url":"https://api.github.com/repos/yaooqinn/spark/contributors","subscribers_url":"https://api.github.com/repos/yaooqinn/spark/subscribers","subscription_url":"https://api.github.com/repos/yaooqinn/spark/subscription","commits_url":"https://api.github.com/repos/yaooqinn/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/yaooqinn/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/yaooqinn/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/yaooqinn/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/yaooqinn/spark/contents/{+path}","compare_url":"https://api.github.com/repos/yaooqinn/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yaooqinn/spark/merges","archive_url":"https://api.github.com/repos/yaooqinn/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yaooqinn/spark/downloads","issues_url":"https://api.github.com/repos/yaooqinn/spark/issues{/number}","pulls_url":"https://api.github.com/repos/yaooqinn/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/yaooqinn/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/yaooqinn/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yaooqinn/spark/labels{/name}","releases_url":"https://api.github.com/repos/yaooqinn/spark/releases{/id}","deployments_url":"https://api.github.com/repos/yaooqinn/spark/deployments","created_at":"2021-04-14T16:44:36Z","updated_at":"2024-11-05T08:03:33Z","pushed_at":"2025-01-24T02:12:30Z","git_url":"git://github.com/yaooqinn/spark.git","ssh_url":"git@github.com:yaooqinn/spark.git","clone_url":"https://github.com/yaooqinn/spark.git","svn_url":"https://github.com/yaooqinn/spark","homepage":"https://spark.apache.org/","size":468287,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"939129ec01af7f7b6dbec737f2d4149d2fc0d9a3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49317"},"html":{"href":"https://github.com/apache/spark/pull/49317"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49317"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49317/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49317/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49317/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ddfbfb9826573d0a9cf7509997300370192841a6"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49316","id":2253234543,"node_id":"PR_kwDOAQXtWs6GTaFv","html_url":"https://github.com/apache/spark/pull/49316","diff_url":"https://github.com/apache/spark/pull/49316.diff","patch_url":"https://github.com/apache/spark/pull/49316.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49316","number":49316,"state":"closed","locked":false,"title":"[MINOR][DOCS] Fix miss semicolon on describe sql example","user":{"login":"camilesing","id":11649145,"node_id":"MDQ6VXNlcjExNjQ5MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/11649145?v=4","gravatar_id":"","url":"https://api.github.com/users/camilesing","html_url":"https://github.com/camilesing","followers_url":"https://api.github.com/users/camilesing/followers","following_url":"https://api.github.com/users/camilesing/following{/other_user}","gists_url":"https://api.github.com/users/camilesing/gists{/gist_id}","starred_url":"https://api.github.com/users/camilesing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/camilesing/subscriptions","organizations_url":"https://api.github.com/users/camilesing/orgs","repos_url":"https://api.github.com/users/camilesing/repos","events_url":"https://api.github.com/users/camilesing/events{/privacy}","received_events_url":"https://api.github.com/users/camilesing/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n \r\nfix miss semicolon on describe SQL example\r\n\r\n### Why are the changes needed?\r\n \r\ndescribe SQL example miss semicolon\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes. the patch fix docs miss semicolon SQL.\r\n\r\n\r\n### How was this patch tested?\r\n\r\nManually by inspecting generated docs.\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2024-12-27T10:23:24Z","updated_at":"2025-01-10T10:22:50Z","closed_at":"2025-01-10T10:22:49Z","merged_at":null,"merge_commit_sha":"bf1cdf749827785bcc3c74a42f04a15d70b797e4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49316/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49316/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49316/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a172ed9f3d2366e68ff051bf7614e16bf75dd89e","head":{"label":"camilesing:fix_docs_miss_semicolon","ref":"fix_docs_miss_semicolon","sha":"a172ed9f3d2366e68ff051bf7614e16bf75dd89e","user":{"login":"camilesing","id":11649145,"node_id":"MDQ6VXNlcjExNjQ5MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/11649145?v=4","gravatar_id":"","url":"https://api.github.com/users/camilesing","html_url":"https://github.com/camilesing","followers_url":"https://api.github.com/users/camilesing/followers","following_url":"https://api.github.com/users/camilesing/following{/other_user}","gists_url":"https://api.github.com/users/camilesing/gists{/gist_id}","starred_url":"https://api.github.com/users/camilesing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/camilesing/subscriptions","organizations_url":"https://api.github.com/users/camilesing/orgs","repos_url":"https://api.github.com/users/camilesing/repos","events_url":"https://api.github.com/users/camilesing/events{/privacy}","received_events_url":"https://api.github.com/users/camilesing/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":891933091,"node_id":"R_kgDONSnRow","name":"spark","full_name":"camilesing/spark","private":false,"owner":{"login":"camilesing","id":11649145,"node_id":"MDQ6VXNlcjExNjQ5MTQ1","avatar_url":"https://avatars.githubusercontent.com/u/11649145?v=4","gravatar_id":"","url":"https://api.github.com/users/camilesing","html_url":"https://github.com/camilesing","followers_url":"https://api.github.com/users/camilesing/followers","following_url":"https://api.github.com/users/camilesing/following{/other_user}","gists_url":"https://api.github.com/users/camilesing/gists{/gist_id}","starred_url":"https://api.github.com/users/camilesing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/camilesing/subscriptions","organizations_url":"https://api.github.com/users/camilesing/orgs","repos_url":"https://api.github.com/users/camilesing/repos","events_url":"https://api.github.com/users/camilesing/events{/privacy}","received_events_url":"https://api.github.com/users/camilesing/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/camilesing/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/camilesing/spark","forks_url":"https://api.github.com/repos/camilesing/spark/forks","keys_url":"https://api.github.com/repos/camilesing/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/camilesing/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/camilesing/spark/teams","hooks_url":"https://api.github.com/repos/camilesing/spark/hooks","issue_events_url":"https://api.github.com/repos/camilesing/spark/issues/events{/number}","events_url":"https://api.github.com/repos/camilesing/spark/events","assignees_url":"https://api.github.com/repos/camilesing/spark/assignees{/user}","branches_url":"https://api.github.com/repos/camilesing/spark/branches{/branch}","tags_url":"https://api.github.com/repos/camilesing/spark/tags","blobs_url":"https://api.github.com/repos/camilesing/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/camilesing/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/camilesing/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/camilesing/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/camilesing/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/camilesing/spark/languages","stargazers_url":"https://api.github.com/repos/camilesing/spark/stargazers","contributors_url":"https://api.github.com/repos/camilesing/spark/contributors","subscribers_url":"https://api.github.com/repos/camilesing/spark/subscribers","subscription_url":"https://api.github.com/repos/camilesing/spark/subscription","commits_url":"https://api.github.com/repos/camilesing/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/camilesing/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/camilesing/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/camilesing/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/camilesing/spark/contents/{+path}","compare_url":"https://api.github.com/repos/camilesing/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/camilesing/spark/merges","archive_url":"https://api.github.com/repos/camilesing/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/camilesing/spark/downloads","issues_url":"https://api.github.com/repos/camilesing/spark/issues{/number}","pulls_url":"https://api.github.com/repos/camilesing/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/camilesing/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/camilesing/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/camilesing/spark/labels{/name}","releases_url":"https://api.github.com/repos/camilesing/spark/releases{/id}","deployments_url":"https://api.github.com/repos/camilesing/spark/deployments","created_at":"2024-11-21T08:09:26Z","updated_at":"2024-11-21T08:09:26Z","pushed_at":"2025-01-18T04:14:20Z","git_url":"git://github.com/camilesing/spark.git","ssh_url":"git@github.com:camilesing/spark.git","clone_url":"https://github.com/camilesing/spark.git","svn_url":"https://github.com/camilesing/spark","homepage":"https://spark.apache.org/","size":420896,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"939129ec01af7f7b6dbec737f2d4149d2fc0d9a3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49316"},"html":{"href":"https://github.com/apache/spark/pull/49316"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49316"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49316/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49316/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49316/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a172ed9f3d2366e68ff051bf7614e16bf75dd89e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49315","id":2253105759,"node_id":"PR_kwDOAQXtWs6GS6pf","html_url":"https://github.com/apache/spark/pull/49315","diff_url":"https://github.com/apache/spark/pull/49315.diff","patch_url":"https://github.com/apache/spark/pull/49315.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49315","number":49315,"state":"closed","locked":false,"title":"[SPARK-50687][PYTHON] Optimize the logic to get stack traces for DataFrameQueryContext","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to optimize the logic to get stack traces for DataFrameQueryContext by avoid using `inspect.getframeinfo` that is slow.\r\n\r\n```\r\n     8000    0.019    0.000    0.976    0.000 inspect.py:1658()\r\n```\r\n\r\n### Why are the changes needed?\r\n\r\nThe main overhead is from `inspect.getframeinfo` so this PR directly uses the frames from `inspect.currentframe`\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nIt improves the performance of `DataFrameQueryContext`.\r\n\r\n### How was this patch tested?\r\n\r\nManually tested as below:\r\n\r\n```python\r\nimport cProfile\r\n\r\nfrom pyspark.sql.functions import col\r\n\r\n\r\ndef foo():\r\n    for _ in range(1000):\r\n        col(\"id\")\r\n\r\n\r\ncProfile.run('foo()', sort='tottime')\r\n```\r\n\r\n**Before:**\r\n\r\n```\r\n         5793561 function calls (5789561 primitive calls) in 3.615 seconds\r\n\r\n   Ordered by: internal time\r\n\r\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n    27000    1.784    0.000    1.784    0.000 {method 'recv_into' of '_socket.socket' objects}\r\n     1000    0.413    0.000    0.787    0.001 inspect.py:969(getmodule)\r\n   969000    0.137    0.000    0.171    0.000 inspect.py:283(ismodule)\r\n    27000    0.135    0.000    0.135    0.000 {method 'sendall' of '_socket.socket' objects}\r\n   967000    0.097    0.000    0.097    0.000 {built-in method builtins.hasattr}\r\n    27000    0.080    0.000    2.125    0.000 clientserver.py:523(send_command)\r\n     8000    0.063    0.000    0.063    0.000 {built-in method builtins.next}\r\n     1000    0.061    0.000    0.061    0.000 {built-in method posix.getcwd}\r\n  1266556    0.051    0.000    0.056    0.000 {built-in method builtins.isinstance}\r\n   935000    0.036    0.000    0.036    0.000 {method 'get' of 'dict' objects}\r\n    27000    0.033    0.000    2.213    0.000 java_gateway.py:1015(send_command)\r\n    54778    0.032    0.000    0.039    0.000 protocol.py:214(smart_decode)\r\n    24000    0.025    0.000    0.030    0.000 inspect.py:1790(_shadowed_dict)\r\n```\r\n\r\n**After:**\r\n\r\n```\r\n         1575042 function calls (1573042 primitive calls) in 2.094 seconds\r\n\r\n   Ordered by: internal time\r\n\r\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n    27000    1.175    0.000    1.175    0.000 {method 'recv_into' of '_socket.socket' objects}\r\n    27000    0.101    0.000    1.504    0.000 clientserver.py:523(send_command)\r\n    27000    0.067    0.000    0.067    0.000 {method 'sendall' of '_socket.socket' objects}\r\n    54852    0.039    0.000    0.048    0.000 protocol.py:214(smart_decode)\r\n    27000    0.038    0.000    1.607    0.000 java_gateway.py:1015(send_command)\r\n    24000    0.029    0.000    0.035    0.000 inspect.py:1790(_shadowed_dict)\r\n    27000    0.027    0.000    1.223    0.000 socket.py:692(readinto)\r\n    27000    0.025    0.000    1.249    0.000 {method 'readline' of '_io.BufferedReader' objects}\r\n     9000    0.020    0.000    0.195    0.000 java_gateway.py:1290(_get_args)\r\n    27000    0.020    0.000    0.035    0.000 clientserver.py:271(_get_connection)\r\n    54000    0.020    0.000    0.036    0.000 __init__.py:1467(debug)\r\n    ...\r\n```\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo","created_at":"2024-12-27T08:02:42Z","updated_at":"2024-12-27T10:08:42Z","closed_at":"2024-12-27T10:08:42Z","merged_at":null,"merge_commit_sha":"127c11af07430dda43855af5ea77c12fdeb1b4f8","assignee":null,"assignees":[],"requested_reviewers":[{"login":"ueshin","id":506656,"node_id":"MDQ6VXNlcjUwNjY1Ng==","avatar_url":"https://avatars.githubusercontent.com/u/506656?v=4","gravatar_id":"","url":"https://api.github.com/users/ueshin","html_url":"https://github.com/ueshin","followers_url":"https://api.github.com/users/ueshin/followers","following_url":"https://api.github.com/users/ueshin/following{/other_user}","gists_url":"https://api.github.com/users/ueshin/gists{/gist_id}","starred_url":"https://api.github.com/users/ueshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ueshin/subscriptions","organizations_url":"https://api.github.com/users/ueshin/orgs","repos_url":"https://api.github.com/users/ueshin/repos","events_url":"https://api.github.com/users/ueshin/events{/privacy}","received_events_url":"https://api.github.com/users/ueshin/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49315/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49315/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49315/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c79610e7e5e7cbba07ab22f4d3ff7111c0463c06","head":{"label":"HyukjinKwon:optimize-get-frame","ref":"optimize-get-frame","sha":"c79610e7e5e7cbba07ab22f4d3ff7111c0463c06","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2d320aaa420feeb646def7f5aeffaa02fa68508e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49315"},"html":{"href":"https://github.com/apache/spark/pull/49315"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49315"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49315/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49315/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49315/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c79610e7e5e7cbba07ab22f4d3ff7111c0463c06"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49314","id":2253087789,"node_id":"PR_kwDOAQXtWs6GS2Qt","html_url":"https://github.com/apache/spark/pull/49314","diff_url":"https://github.com/apache/spark/pull/49314.diff","patch_url":"https://github.com/apache/spark/pull/49314.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49314","number":49314,"state":"open","locked":false,"title":" [SPARK-50686][SQL] Hash to sort aggregation fallback -  memory usage optimization","user":{"login":"akupchinskiy","id":110655003,"node_id":"U_kgDOBph2Gw","avatar_url":"https://avatars.githubusercontent.com/u/110655003?v=4","gravatar_id":"","url":"https://api.github.com/users/akupchinskiy","html_url":"https://github.com/akupchinskiy","followers_url":"https://api.github.com/users/akupchinskiy/followers","following_url":"https://api.github.com/users/akupchinskiy/following{/other_user}","gists_url":"https://api.github.com/users/akupchinskiy/gists{/gist_id}","starred_url":"https://api.github.com/users/akupchinskiy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akupchinskiy/subscriptions","organizations_url":"https://api.github.com/users/akupchinskiy/orgs","repos_url":"https://api.github.com/users/akupchinskiy/repos","events_url":"https://api.github.com/users/akupchinskiy/events{/privacy}","received_events_url":"https://api.github.com/users/akupchinskiy/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nAdded deallocation of internal array which is redundant in certain hash to sort aggregation fallback scenarios\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nUnder memory pressure, allocation of new internal structures is oom-prone. So, it is better to get rid of all the redundant structures at that point to reduce the risk. \r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nUnsafeKVExternalSuite spilling tests have been adjusted to the reduced spilled memory introduced by the change.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nNo","created_at":"2024-12-27T07:40:38Z","updated_at":"2024-12-27T13:00:48Z","closed_at":null,"merged_at":null,"merge_commit_sha":"64b99572078972810f8cc77ccc2e3b0f10375bb0","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49314/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49314/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49314/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7f8db0c23140418a06212fb371a299b9104dd413","head":{"label":"akupchinskiy:aggregation-memory-usage-optimization","ref":"aggregation-memory-usage-optimization","sha":"7f8db0c23140418a06212fb371a299b9104dd413","user":{"login":"akupchinskiy","id":110655003,"node_id":"U_kgDOBph2Gw","avatar_url":"https://avatars.githubusercontent.com/u/110655003?v=4","gravatar_id":"","url":"https://api.github.com/users/akupchinskiy","html_url":"https://github.com/akupchinskiy","followers_url":"https://api.github.com/users/akupchinskiy/followers","following_url":"https://api.github.com/users/akupchinskiy/following{/other_user}","gists_url":"https://api.github.com/users/akupchinskiy/gists{/gist_id}","starred_url":"https://api.github.com/users/akupchinskiy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akupchinskiy/subscriptions","organizations_url":"https://api.github.com/users/akupchinskiy/orgs","repos_url":"https://api.github.com/users/akupchinskiy/repos","events_url":"https://api.github.com/users/akupchinskiy/events{/privacy}","received_events_url":"https://api.github.com/users/akupchinskiy/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":907810894,"node_id":"R_kgDONhwYTg","name":"spark","full_name":"akupchinskiy/spark","private":false,"owner":{"login":"akupchinskiy","id":110655003,"node_id":"U_kgDOBph2Gw","avatar_url":"https://avatars.githubusercontent.com/u/110655003?v=4","gravatar_id":"","url":"https://api.github.com/users/akupchinskiy","html_url":"https://github.com/akupchinskiy","followers_url":"https://api.github.com/users/akupchinskiy/followers","following_url":"https://api.github.com/users/akupchinskiy/following{/other_user}","gists_url":"https://api.github.com/users/akupchinskiy/gists{/gist_id}","starred_url":"https://api.github.com/users/akupchinskiy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akupchinskiy/subscriptions","organizations_url":"https://api.github.com/users/akupchinskiy/orgs","repos_url":"https://api.github.com/users/akupchinskiy/repos","events_url":"https://api.github.com/users/akupchinskiy/events{/privacy}","received_events_url":"https://api.github.com/users/akupchinskiy/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/akupchinskiy/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/akupchinskiy/spark","forks_url":"https://api.github.com/repos/akupchinskiy/spark/forks","keys_url":"https://api.github.com/repos/akupchinskiy/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/akupchinskiy/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/akupchinskiy/spark/teams","hooks_url":"https://api.github.com/repos/akupchinskiy/spark/hooks","issue_events_url":"https://api.github.com/repos/akupchinskiy/spark/issues/events{/number}","events_url":"https://api.github.com/repos/akupchinskiy/spark/events","assignees_url":"https://api.github.com/repos/akupchinskiy/spark/assignees{/user}","branches_url":"https://api.github.com/repos/akupchinskiy/spark/branches{/branch}","tags_url":"https://api.github.com/repos/akupchinskiy/spark/tags","blobs_url":"https://api.github.com/repos/akupchinskiy/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/akupchinskiy/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/akupchinskiy/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/akupchinskiy/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/akupchinskiy/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/akupchinskiy/spark/languages","stargazers_url":"https://api.github.com/repos/akupchinskiy/spark/stargazers","contributors_url":"https://api.github.com/repos/akupchinskiy/spark/contributors","subscribers_url":"https://api.github.com/repos/akupchinskiy/spark/subscribers","subscription_url":"https://api.github.com/repos/akupchinskiy/spark/subscription","commits_url":"https://api.github.com/repos/akupchinskiy/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/akupchinskiy/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/akupchinskiy/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/akupchinskiy/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/akupchinskiy/spark/contents/{+path}","compare_url":"https://api.github.com/repos/akupchinskiy/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/akupchinskiy/spark/merges","archive_url":"https://api.github.com/repos/akupchinskiy/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/akupchinskiy/spark/downloads","issues_url":"https://api.github.com/repos/akupchinskiy/spark/issues{/number}","pulls_url":"https://api.github.com/repos/akupchinskiy/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/akupchinskiy/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/akupchinskiy/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/akupchinskiy/spark/labels{/name}","releases_url":"https://api.github.com/repos/akupchinskiy/spark/releases{/id}","deployments_url":"https://api.github.com/repos/akupchinskiy/spark/deployments","created_at":"2024-12-24T12:53:13Z","updated_at":"2024-12-26T05:36:11Z","pushed_at":"2024-12-27T13:00:47Z","git_url":"git://github.com/akupchinskiy/spark.git","ssh_url":"git@github.com:akupchinskiy/spark.git","clone_url":"https://github.com/akupchinskiy/spark.git","svn_url":"https://github.com/akupchinskiy/spark","homepage":"https://spark.apache.org/","size":417991,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"939129ec01af7f7b6dbec737f2d4149d2fc0d9a3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49314"},"html":{"href":"https://github.com/apache/spark/pull/49314"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49314"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49314/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49314/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49314/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7f8db0c23140418a06212fb371a299b9104dd413"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49313","id":2253038233,"node_id":"PR_kwDOAQXtWs6GSqKZ","html_url":"https://github.com/apache/spark/pull/49313","diff_url":"https://github.com/apache/spark/pull/49313.diff","patch_url":"https://github.com/apache/spark/pull/49313.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49313","number":49313,"state":"closed","locked":false,"title":"[SPARK-50685][PYTHON] Improve Py4J performance by leveraging getattr","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis Pr proposes to improve Py4J performance by leveraging `getattr`, see also https://github.com/apache/spark/pull/46809\r\n\r\nThis PR fixes Core, SQL, ML and Structured Streaming. Tests codes, MLLib and DStream are not affected.\r\n\r\n### Why are the changes needed?\r\n\r\nTo reduce the overhead of Py4J calls.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nManually tested as demonstrated in https://github.com/apache/spark/pull/49312\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.\r\n","created_at":"2024-12-27T06:41:05Z","updated_at":"2024-12-27T09:59:41Z","closed_at":"2024-12-27T09:59:41Z","merged_at":null,"merge_commit_sha":"2e88e695ef6da48dcb4be830ad69bb062d706eba","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1405801475,"node_id":"MDU6TGFiZWwxNDA1ODAxNDc1","url":"https://api.github.com/repos/apache/spark/labels/ML","name":"ML","color":"ededed","default":false,"description":null},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49313/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49313/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49313/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/983aaf94c6e704b20740ad08f33bb6fc25c331fd","head":{"label":"HyukjinKwon:SPARK-50685","ref":"SPARK-50685","sha":"983aaf94c6e704b20740ad08f33bb6fc25c331fd","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"b309db092cbb67fedb7cec9ab0ebcd07d8d95b04","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49313"},"html":{"href":"https://github.com/apache/spark/pull/49313"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49313"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49313/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49313/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49313/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/983aaf94c6e704b20740ad08f33bb6fc25c331fd"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49312","id":2253020544,"node_id":"PR_kwDOAQXtWs6GSl2A","html_url":"https://github.com/apache/spark/pull/49312","diff_url":"https://github.com/apache/spark/pull/49312.diff","patch_url":"https://github.com/apache/spark/pull/49312.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49312","number":49312,"state":"closed","locked":false,"title":"[SPARK-50684][PYTHON] Improve Py4J performance in DataFrameQueryContext","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to improve Py4J performance in DataFrameQueryContext by reducing the number of Py4J calls. The same logic in https://github.com/apache/spark/pull/46809 applies here.\r\n\r\n### Why are the changes needed?\r\n\r\nIn order to remove the overhead of Py4J, and speed up.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, it improves the performance of `DataFrameQueryContext`.\r\n\r\n### How was this patch tested?\r\n\r\nManually via:\r\n\r\n```python\r\nimport cProfile\r\n\r\nfrom pyspark.sql.functions import col\r\n\r\n\r\ndef foo():\r\n    for _ in range(1000):\r\n        col(\"id\")\r\n\r\n\r\ncProfile.run('foo()', sort='tottime')\r\n```\r\n\r\n**Before:**\r\n\r\n```\r\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n    27014    2.008    0.000    2.008    0.000 {method 'recv_into' of '_socket.socket' objects}\r\n1009/1000    0.421    0.000    0.861    0.001 inspect.py:969(getmodule)\r\n   969976    0.138    0.000    0.173    0.000 inspect.py:283(ismodule)\r\n    27014    0.128    0.000    0.128    0.000 {method 'sendall' of '_socket.socket' objects}\r\n968691/968655    0.108    0.000    0.110    0.000 {built-in method builtins.hasattr}\r\n    27014    0.078    0.000    2.340    0.000 clientserver.py:523(send_command)\r\n```\r\n\r\n**After:**\r\n\r\n```\r\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n    21014    1.423    0.000    1.423    0.000 {method 'recv_into' of '_socket.socket' objects}\r\n1009/1000    0.423    0.000    0.851    0.001 inspect.py:969(getmodule)\r\n   969976    0.137    0.000    0.171    0.000 inspect.py:283(ismodule)\r\n    21014    0.117    0.000    0.117    0.000 {method 'sendall' of '_socket.socket' objects}\r\n968691/968655    0.104    0.000    0.106    0.000 {built-in method builtins.hasattr}\r\n     8002    0.066    0.000    0.066    0.000 {built-in method builtins.next}\r\n```\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2024-12-27T06:18:01Z","updated_at":"2024-12-27T08:22:50Z","closed_at":"2024-12-27T08:22:50Z","merged_at":null,"merge_commit_sha":"f10a5402d480ea74c25d21ddf2e8f2aa00f358e7","assignee":null,"assignees":[],"requested_reviewers":[{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49312/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49312/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49312/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f238a913bdeabc05811ec6b27af1f8ed5c8e8f88","head":{"label":"HyukjinKwon:improve-performance-origin","ref":"improve-performance-origin","sha":"f238a913bdeabc05811ec6b27af1f8ed5c8e8f88","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"b309db092cbb67fedb7cec9ab0ebcd07d8d95b04","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49312"},"html":{"href":"https://github.com/apache/spark/pull/49312"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49312"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49312/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49312/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49312/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f238a913bdeabc05811ec6b27af1f8ed5c8e8f88"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49311","id":2253011545,"node_id":"PR_kwDOAQXtWs6GSjpZ","html_url":"https://github.com/apache/spark/pull/49311","diff_url":"https://github.com/apache/spark/pull/49311.diff","patch_url":"https://github.com/apache/spark/pull/49311.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49311","number":49311,"state":"closed","locked":false,"title":"[SPARK-50310][CONNECT][PYTHON][FOLLOW-UP] Delay is_debugging_enabled call after modules are initialized ","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR is a retry of https://github.com/apache/spark/pull/49054 that avoids hacky monkey patch.\r\n\r\n### Why are the changes needed?\r\n\r\n- This disables DataFrameQueryContext for `pyspark.sql.functions` too\r\n- It avoids circular import in pyspark-connect package.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, after this followup, `spark.python.sql.dataFrameDebugging.enabled` also works with `pyspark.sql.functions.*`.\r\n\r\n### How was this patch tested?\r\n\r\nManually ran profilers:\r\n\r\n```python\r\nimport cProfile\r\n\r\nfrom pyspark.sql.functions import col\r\n\r\n\r\ndef foo():\r\n    for _ in range(1000):\r\n        col(\"id\")\r\n\r\n\r\ncProfile.run('foo()', sort='tottime')\r\n```\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2024-12-27T06:05:37Z","updated_at":"2024-12-27T06:08:01Z","closed_at":"2024-12-27T06:08:00Z","merged_at":null,"merge_commit_sha":"7f43bd502ab45fe2f4bd0878ed91fd2db2e5218b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49311/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49311/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49311/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/47790d6e8a412f670c005fa3cb5f739afd0c0045","head":{"label":"HyukjinKwon:SPARK-50310-followup","ref":"SPARK-50310-followup","sha":"47790d6e8a412f670c005fa3cb5f739afd0c0045","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"1a1fcd61322b3cf9713e987a16882d7ddf666d2e","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49311"},"html":{"href":"https://github.com/apache/spark/pull/49311"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49311"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49311/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49311/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49311/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/47790d6e8a412f670c005fa3cb5f739afd0c0045"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49310","id":2252994740,"node_id":"PR_kwDOAQXtWs6GSfi0","html_url":"https://github.com/apache/spark/pull/49310","diff_url":"https://github.com/apache/spark/pull/49310.diff","patch_url":"https://github.com/apache/spark/pull/49310.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49310","number":49310,"state":"closed","locked":false,"title":"[SPARK-50683][SQL] Inline the common expression in With if used once","user":{"login":"zml1206","id":5275075,"node_id":"MDQ6VXNlcjUyNzUwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/5275075?v=4","gravatar_id":"","url":"https://api.github.com/users/zml1206","html_url":"https://github.com/zml1206","followers_url":"https://api.github.com/users/zml1206/followers","following_url":"https://api.github.com/users/zml1206/following{/other_user}","gists_url":"https://api.github.com/users/zml1206/gists{/gist_id}","starred_url":"https://api.github.com/users/zml1206/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zml1206/subscriptions","organizations_url":"https://api.github.com/users/zml1206/orgs","repos_url":"https://api.github.com/users/zml1206/repos","events_url":"https://api.github.com/users/zml1206/events{/privacy}","received_events_url":"https://api.github.com/users/zml1206/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n\r\n### What changes were proposed in this pull request?\r\nAs title.\r\n\r\n\r\n### Why are the changes needed?\r\n\r\nSimplify plan and reduce unnecessary project.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n\r\n### How was this patch tested?\r\nUT.\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.\r\n","created_at":"2024-12-27T05:40:39Z","updated_at":"2025-01-02T04:37:23Z","closed_at":"2025-01-02T04:37:23Z","merged_at":null,"merge_commit_sha":"5da70cf2915f04b432579853fe61a80200ca9f19","assignee":null,"assignees":[],"requested_reviewers":[{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49310/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49310/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49310/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/afd9c481c11a27fd9fab244e95a5511ebe66afd9","head":{"label":"zml1206:with","ref":"with","sha":"afd9c481c11a27fd9fab244e95a5511ebe66afd9","user":{"login":"zml1206","id":5275075,"node_id":"MDQ6VXNlcjUyNzUwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/5275075?v=4","gravatar_id":"","url":"https://api.github.com/users/zml1206","html_url":"https://github.com/zml1206","followers_url":"https://api.github.com/users/zml1206/followers","following_url":"https://api.github.com/users/zml1206/following{/other_user}","gists_url":"https://api.github.com/users/zml1206/gists{/gist_id}","starred_url":"https://api.github.com/users/zml1206/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zml1206/subscriptions","organizations_url":"https://api.github.com/users/zml1206/orgs","repos_url":"https://api.github.com/users/zml1206/repos","events_url":"https://api.github.com/users/zml1206/events{/privacy}","received_events_url":"https://api.github.com/users/zml1206/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":500757268,"node_id":"R_kgDOHdjzFA","name":"spark","full_name":"zml1206/spark","private":false,"owner":{"login":"zml1206","id":5275075,"node_id":"MDQ6VXNlcjUyNzUwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/5275075?v=4","gravatar_id":"","url":"https://api.github.com/users/zml1206","html_url":"https://github.com/zml1206","followers_url":"https://api.github.com/users/zml1206/followers","following_url":"https://api.github.com/users/zml1206/following{/other_user}","gists_url":"https://api.github.com/users/zml1206/gists{/gist_id}","starred_url":"https://api.github.com/users/zml1206/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zml1206/subscriptions","organizations_url":"https://api.github.com/users/zml1206/orgs","repos_url":"https://api.github.com/users/zml1206/repos","events_url":"https://api.github.com/users/zml1206/events{/privacy}","received_events_url":"https://api.github.com/users/zml1206/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zml1206/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/zml1206/spark","forks_url":"https://api.github.com/repos/zml1206/spark/forks","keys_url":"https://api.github.com/repos/zml1206/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zml1206/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zml1206/spark/teams","hooks_url":"https://api.github.com/repos/zml1206/spark/hooks","issue_events_url":"https://api.github.com/repos/zml1206/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zml1206/spark/events","assignees_url":"https://api.github.com/repos/zml1206/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zml1206/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zml1206/spark/tags","blobs_url":"https://api.github.com/repos/zml1206/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zml1206/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zml1206/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zml1206/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zml1206/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zml1206/spark/languages","stargazers_url":"https://api.github.com/repos/zml1206/spark/stargazers","contributors_url":"https://api.github.com/repos/zml1206/spark/contributors","subscribers_url":"https://api.github.com/repos/zml1206/spark/subscribers","subscription_url":"https://api.github.com/repos/zml1206/spark/subscription","commits_url":"https://api.github.com/repos/zml1206/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zml1206/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zml1206/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zml1206/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zml1206/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zml1206/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zml1206/spark/merges","archive_url":"https://api.github.com/repos/zml1206/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zml1206/spark/downloads","issues_url":"https://api.github.com/repos/zml1206/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zml1206/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zml1206/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zml1206/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zml1206/spark/labels{/name}","releases_url":"https://api.github.com/repos/zml1206/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zml1206/spark/deployments","created_at":"2022-06-07T08:38:18Z","updated_at":"2022-06-07T07:07:21Z","pushed_at":"2025-01-16T03:49:36Z","git_url":"git://github.com/zml1206/spark.git","ssh_url":"git@github.com:zml1206/spark.git","clone_url":"https://github.com/zml1206/spark.git","svn_url":"https://github.com/zml1206/spark","homepage":"https://spark.apache.org/","size":479169,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"59fb88733433ef76eb33004a6b82e0472da5485f","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49310"},"html":{"href":"https://github.com/apache/spark/pull/49310"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49310"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49310/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49310/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49310/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/afd9c481c11a27fd9fab244e95a5511ebe66afd9"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49309","id":2252935041,"node_id":"PR_kwDOAQXtWs6GSQ-B","html_url":"https://github.com/apache/spark/pull/49309","diff_url":"https://github.com/apache/spark/pull/49309.diff","patch_url":"https://github.com/apache/spark/pull/49309.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49309","number":49309,"state":"closed","locked":false,"title":"[SPARK-50682][SQL] Inner Alias should be canonicalized","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR fixes plan canonicalization to normalize the expr ID of inner Aliases to 0. We should not assume that all inner Aliases will be removed by the analyzer, as Alias with metadata won't be removed.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTo avoid cache misses that should not happen.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nno, table cache is a perf feature.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\na new test\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nno","created_at":"2024-12-27T03:55:43Z","updated_at":"2024-12-27T06:08:33Z","closed_at":"2024-12-27T06:08:33Z","merged_at":null,"merge_commit_sha":"876ac1690c8ec8b48d4b83453ad01697e495f48e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49309/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49309/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49309/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2bc0d77c2ba47cec6c1c0f57a56fa581c79b13ef","head":{"label":"cloud-fan:alias","ref":"alias","sha":"2bc0d77c2ba47cec6c1c0f57a56fa581c79b13ef","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"789702b629884d5f0bd68c35f1b06afcf7668565","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49309"},"html":{"href":"https://github.com/apache/spark/pull/49309"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49309"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49309/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49309/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49309/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2bc0d77c2ba47cec6c1c0f57a56fa581c79b13ef"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49308","id":2252910946,"node_id":"PR_kwDOAQXtWs6GSLFi","html_url":"https://github.com/apache/spark/pull/49308","diff_url":"https://github.com/apache/spark/pull/49308.diff","patch_url":"https://github.com/apache/spark/pull/49308.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49308","number":49308,"state":"closed","locked":false,"title":"[MINOR][PYTHON] Leverage functools.cached_property in `DataFrame`","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to replace manual cached property with `functools.cached_property` in DataFrame.\r\n\r\n### Why are the changes needed?\r\n\r\nTo reduce code.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.\r\n","created_at":"2024-12-27T03:03:45Z","updated_at":"2024-12-27T05:14:18Z","closed_at":"2024-12-27T05:14:18Z","merged_at":null,"merge_commit_sha":"b2b565faf7d36ee9d74a27896aa8a8d57b16d7e3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49308/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49308/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49308/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f8564fe90a1d1209edb38946e9fac698d1aa1adf","head":{"label":"HyukjinKwon:dataframe-cached-property","ref":"dataframe-cached-property","sha":"f8564fe90a1d1209edb38946e9fac698d1aa1adf","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"783b3e351d510a2805e1c85592446e64412a2c2d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49308"},"html":{"href":"https://github.com/apache/spark/pull/49308"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49308"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49308/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49308/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49308/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f8564fe90a1d1209edb38946e9fac698d1aa1adf"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49307","id":2252907879,"node_id":"PR_kwDOAQXtWs6GSKVn","html_url":"https://github.com/apache/spark/pull/49307","diff_url":"https://github.com/apache/spark/pull/49307.diff","patch_url":"https://github.com/apache/spark/pull/49307.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49307","number":49307,"state":"closed","locked":false,"title":"[MINOR][PYTHON] Leverage functools.cached_property in `ImageSchema`","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to replace manual cached property with `functools.cached_property` in `ImageSchema`.\r\n\r\n### Why are the changes needed?\r\n\r\nTo reduce code.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.\r\n","created_at":"2024-12-27T02:57:31Z","updated_at":"2024-12-27T03:51:34Z","closed_at":"2024-12-27T03:51:34Z","merged_at":null,"merge_commit_sha":"6b8fc0c6afe8f793c44f5476ed75d8e9fc1b7b36","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405801475,"node_id":"MDU6TGFiZWwxNDA1ODAxNDc1","url":"https://api.github.com/repos/apache/spark/labels/ML","name":"ML","color":"ededed","default":false,"description":null},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49307/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49307/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49307/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b5672ddf480b84019fc61fc672ab527300119dbb","head":{"label":"HyukjinKwon:image-cached-property","ref":"image-cached-property","sha":"b5672ddf480b84019fc61fc672ab527300119dbb","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"783b3e351d510a2805e1c85592446e64412a2c2d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49307"},"html":{"href":"https://github.com/apache/spark/pull/49307"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49307"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49307/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49307/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49307/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b5672ddf480b84019fc61fc672ab527300119dbb"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49306","id":2252902974,"node_id":"PR_kwDOAQXtWs6GSJI-","html_url":"https://github.com/apache/spark/pull/49306","diff_url":"https://github.com/apache/spark/pull/49306.diff","patch_url":"https://github.com/apache/spark/pull/49306.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49306","number":49306,"state":"closed","locked":false,"title":"[MINOR][PYTHON] Leverage functools.cached_property in `SparkSession`","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to replace manual cached property with `functools.cached_property` in SparkSession.\r\n\r\n### Why are the changes needed?\r\n\r\nTo reduce code.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.\r\n","created_at":"2024-12-27T02:47:40Z","updated_at":"2024-12-27T04:13:48Z","closed_at":"2024-12-27T04:13:48Z","merged_at":null,"merge_commit_sha":"cc9a623c2db6e5c9df0efcdb2170ccd02a3b6907","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49306/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49306/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49306/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a1fa012c5572d82c50514e4f616133954973cf3c","head":{"label":"HyukjinKwon:use-cached-property","ref":"use-cached-property","sha":"a1fa012c5572d82c50514e4f616133954973cf3c","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"783b3e351d510a2805e1c85592446e64412a2c2d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49306"},"html":{"href":"https://github.com/apache/spark/pull/49306"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49306"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49306/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49306/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49306/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a1fa012c5572d82c50514e4f616133954973cf3c"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49305","id":2252890100,"node_id":"PR_kwDOAQXtWs6GSF_0","html_url":"https://github.com/apache/spark/pull/49305","diff_url":"https://github.com/apache/spark/pull/49305.diff","patch_url":"https://github.com/apache/spark/pull/49305.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49305","number":49305,"state":"closed","locked":false,"title":"[SPARK-50681][PYTHON][CONNECT] Cache the parsed schema for MapInXXX and ApplyInXXX","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nCache the parsed schema for MapInXXX and ApplyInXXX\r\n\r\n\r\n### Why are the changes needed?\r\nThe specified schema for MapInXXX and ApplyInXXX has been cached when the schema is `StructType`.\r\n\r\nFor a `str` schema, it is parsed in `UserDefinedFunction.returnType` but will not be cached.\r\nIn this case, we can move this parse ahead so it can be cached in MapInXXX and ApplyInXXX\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno\r\n\r\n\r\n### How was this patch tested?\r\nadded test\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nno","created_at":"2024-12-27T02:20:12Z","updated_at":"2024-12-27T05:10:18Z","closed_at":"2024-12-27T05:09:55Z","merged_at":null,"merge_commit_sha":"a3d5ad4ce1b78e60a7df43733340956b9c530bc9","assignee":null,"assignees":[],"requested_reviewers":[{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49305/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49305/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49305/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/cc488846ca73f34453b4e34cbc0515004dd1c5d7","head":{"label":"zhengruifeng:py_cache_ddl","ref":"py_cache_ddl","sha":"cc488846ca73f34453b4e34cbc0515004dd1c5d7","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"783b3e351d510a2805e1c85592446e64412a2c2d","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49305"},"html":{"href":"https://github.com/apache/spark/pull/49305"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49305"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49305/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49305/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49305/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/cc488846ca73f34453b4e34cbc0515004dd1c5d7"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49304","id":2252848988,"node_id":"PR_kwDOAQXtWs6GR79c","html_url":"https://github.com/apache/spark/pull/49304","diff_url":"https://github.com/apache/spark/pull/49304.diff","patch_url":"https://github.com/apache/spark/pull/49304.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49304","number":49304,"state":"open","locked":false,"title":"[SPARK-50655][SS] Move virtual col family related mapping into db layer instead of encoder","user":{"login":"anishshri-db","id":100322362,"node_id":"U_kgDOBfrMOg","avatar_url":"https://avatars.githubusercontent.com/u/100322362?v=4","gravatar_id":"","url":"https://api.github.com/users/anishshri-db","html_url":"https://github.com/anishshri-db","followers_url":"https://api.github.com/users/anishshri-db/followers","following_url":"https://api.github.com/users/anishshri-db/following{/other_user}","gists_url":"https://api.github.com/users/anishshri-db/gists{/gist_id}","starred_url":"https://api.github.com/users/anishshri-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anishshri-db/subscriptions","organizations_url":"https://api.github.com/users/anishshri-db/orgs","repos_url":"https://api.github.com/users/anishshri-db/repos","events_url":"https://api.github.com/users/anishshri-db/events{/privacy}","received_events_url":"https://api.github.com/users/anishshri-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nMove virt col family related mapping into db layer instead of encoder\r\n\r\n### Why are the changes needed?\r\nKeep abstraction clear around ownership and also expose internal/non-internal key metrics correctly.\r\nWith this change, we have the following:\r\n- encoder is only responsible for managing encoding based on type such as noPrefix, prefix, range etc\r\n- the onus of maintaining virtual col families is now with the underlying DB layer\r\n- this layer can now also expose metrics for internal as well as non-internal column families\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nExisting Unit tests and added unit tests\r\n\r\n```\r\n[info] Run completed in 8 minutes, 48 seconds.\r\n[info] Total number of tests run: 305\r\n[info] Suites: completed 1, aborted 0\r\n[info] Tests: succeeded 305, failed 0, canceled 0, ignored 0, pending 0\r\n[info] All tests passed.\r\n```\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2024-12-27T00:39:20Z","updated_at":"2025-02-08T01:18:45Z","closed_at":null,"merged_at":null,"merge_commit_sha":"ec9c8ca15898391db00bb7e53f747152dfdd88e9","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49304/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49304/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49304/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/fa95eeeedf5104265b1549c548691272a5fa7d11","head":{"label":"anishshri-db:task/SPARK-50655","ref":"task/SPARK-50655","sha":"fa95eeeedf5104265b1549c548691272a5fa7d11","user":{"login":"anishshri-db","id":100322362,"node_id":"U_kgDOBfrMOg","avatar_url":"https://avatars.githubusercontent.com/u/100322362?v=4","gravatar_id":"","url":"https://api.github.com/users/anishshri-db","html_url":"https://github.com/anishshri-db","followers_url":"https://api.github.com/users/anishshri-db/followers","following_url":"https://api.github.com/users/anishshri-db/following{/other_user}","gists_url":"https://api.github.com/users/anishshri-db/gists{/gist_id}","starred_url":"https://api.github.com/users/anishshri-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anishshri-db/subscriptions","organizations_url":"https://api.github.com/users/anishshri-db/orgs","repos_url":"https://api.github.com/users/anishshri-db/repos","events_url":"https://api.github.com/users/anishshri-db/events{/privacy}","received_events_url":"https://api.github.com/users/anishshri-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":477925242,"node_id":"R_kgDOHHyPeg","name":"spark","full_name":"anishshri-db/spark","private":false,"owner":{"login":"anishshri-db","id":100322362,"node_id":"U_kgDOBfrMOg","avatar_url":"https://avatars.githubusercontent.com/u/100322362?v=4","gravatar_id":"","url":"https://api.github.com/users/anishshri-db","html_url":"https://github.com/anishshri-db","followers_url":"https://api.github.com/users/anishshri-db/followers","following_url":"https://api.github.com/users/anishshri-db/following{/other_user}","gists_url":"https://api.github.com/users/anishshri-db/gists{/gist_id}","starred_url":"https://api.github.com/users/anishshri-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anishshri-db/subscriptions","organizations_url":"https://api.github.com/users/anishshri-db/orgs","repos_url":"https://api.github.com/users/anishshri-db/repos","events_url":"https://api.github.com/users/anishshri-db/events{/privacy}","received_events_url":"https://api.github.com/users/anishshri-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/anishshri-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/anishshri-db/spark","forks_url":"https://api.github.com/repos/anishshri-db/spark/forks","keys_url":"https://api.github.com/repos/anishshri-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/anishshri-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/anishshri-db/spark/teams","hooks_url":"https://api.github.com/repos/anishshri-db/spark/hooks","issue_events_url":"https://api.github.com/repos/anishshri-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/anishshri-db/spark/events","assignees_url":"https://api.github.com/repos/anishshri-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/anishshri-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/anishshri-db/spark/tags","blobs_url":"https://api.github.com/repos/anishshri-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/anishshri-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/anishshri-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/anishshri-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/anishshri-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/anishshri-db/spark/languages","stargazers_url":"https://api.github.com/repos/anishshri-db/spark/stargazers","contributors_url":"https://api.github.com/repos/anishshri-db/spark/contributors","subscribers_url":"https://api.github.com/repos/anishshri-db/spark/subscribers","subscription_url":"https://api.github.com/repos/anishshri-db/spark/subscription","commits_url":"https://api.github.com/repos/anishshri-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/anishshri-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/anishshri-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/anishshri-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/anishshri-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/anishshri-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/anishshri-db/spark/merges","archive_url":"https://api.github.com/repos/anishshri-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/anishshri-db/spark/downloads","issues_url":"https://api.github.com/repos/anishshri-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/anishshri-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/anishshri-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/anishshri-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/anishshri-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/anishshri-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/anishshri-db/spark/deployments","created_at":"2022-04-05T00:49:09Z","updated_at":"2025-02-07T06:48:07Z","pushed_at":"2025-02-08T01:18:11Z","git_url":"git://github.com/anishshri-db/spark.git","ssh_url":"git@github.com:anishshri-db/spark.git","clone_url":"https://github.com/anishshri-db/spark.git","svn_url":"https://github.com/anishshri-db/spark","homepage":"https://spark.apache.org/","size":468506,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a01ae99d5e90571f3a82e0c91ebe14f29848628c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49304"},"html":{"href":"https://github.com/apache/spark/pull/49304"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49304"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49304/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49304/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49304/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/fa95eeeedf5104265b1549c548691272a5fa7d11"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49303","id":2252495006,"node_id":"PR_kwDOAQXtWs6GQlie","html_url":"https://github.com/apache/spark/pull/49303","diff_url":"https://github.com/apache/spark/pull/49303.diff","patch_url":"https://github.com/apache/spark/pull/49303.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49303","number":49303,"state":"closed","locked":false,"title":"[SPARK-50679][SQL] Duplicated common expressions in different With should be projected only once","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nSometimes we may need to duplicate the `With` expression with some shared common expressions. This PR improves the `With` rewriting rule to recognize it and only project the duplicated common expressions once.\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nProduce better plans.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nno\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\na new test\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nno","created_at":"2024-12-26T14:30:09Z","updated_at":"2024-12-27T04:52:23Z","closed_at":"2024-12-27T04:52:23Z","merged_at":null,"merge_commit_sha":"1a8f4c863b61c1659fd7a0cf0fa72a033c6e0ae3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49303/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49303/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49303/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c0f2cc8b6eb51e7ad02364eed68e68d5775411e8","head":{"label":"cloud-fan:with","ref":"with","sha":"c0f2cc8b6eb51e7ad02364eed68e68d5775411e8","user":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19689699,"node_id":"MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==","name":"spark","full_name":"cloud-fan/spark","private":false,"owner":{"login":"cloud-fan","id":3182036,"node_id":"MDQ6VXNlcjMxODIwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/3182036?v=4","gravatar_id":"","url":"https://api.github.com/users/cloud-fan","html_url":"https://github.com/cloud-fan","followers_url":"https://api.github.com/users/cloud-fan/followers","following_url":"https://api.github.com/users/cloud-fan/following{/other_user}","gists_url":"https://api.github.com/users/cloud-fan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloud-fan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloud-fan/subscriptions","organizations_url":"https://api.github.com/users/cloud-fan/orgs","repos_url":"https://api.github.com/users/cloud-fan/repos","events_url":"https://api.github.com/users/cloud-fan/events{/privacy}","received_events_url":"https://api.github.com/users/cloud-fan/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/cloud-fan/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/cloud-fan/spark","forks_url":"https://api.github.com/repos/cloud-fan/spark/forks","keys_url":"https://api.github.com/repos/cloud-fan/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/cloud-fan/spark/teams","hooks_url":"https://api.github.com/repos/cloud-fan/spark/hooks","issue_events_url":"https://api.github.com/repos/cloud-fan/spark/issues/events{/number}","events_url":"https://api.github.com/repos/cloud-fan/spark/events","assignees_url":"https://api.github.com/repos/cloud-fan/spark/assignees{/user}","branches_url":"https://api.github.com/repos/cloud-fan/spark/branches{/branch}","tags_url":"https://api.github.com/repos/cloud-fan/spark/tags","blobs_url":"https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/cloud-fan/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/cloud-fan/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/cloud-fan/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/cloud-fan/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/cloud-fan/spark/languages","stargazers_url":"https://api.github.com/repos/cloud-fan/spark/stargazers","contributors_url":"https://api.github.com/repos/cloud-fan/spark/contributors","subscribers_url":"https://api.github.com/repos/cloud-fan/spark/subscribers","subscription_url":"https://api.github.com/repos/cloud-fan/spark/subscription","commits_url":"https://api.github.com/repos/cloud-fan/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/cloud-fan/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/cloud-fan/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/cloud-fan/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/cloud-fan/spark/contents/{+path}","compare_url":"https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/cloud-fan/spark/merges","archive_url":"https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/cloud-fan/spark/downloads","issues_url":"https://api.github.com/repos/cloud-fan/spark/issues{/number}","pulls_url":"https://api.github.com/repos/cloud-fan/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/cloud-fan/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/cloud-fan/spark/labels{/name}","releases_url":"https://api.github.com/repos/cloud-fan/spark/releases{/id}","deployments_url":"https://api.github.com/repos/cloud-fan/spark/deployments","created_at":"2014-05-12T07:32:26Z","updated_at":"2022-06-21T07:59:41Z","pushed_at":"2025-02-07T13:15:09Z","git_url":"git://github.com/cloud-fan/spark.git","ssh_url":"git@github.com:cloud-fan/spark.git","clone_url":"https://github.com/cloud-fan/spark.git","svn_url":"https://github.com/cloud-fan/spark","homepage":null,"size":467110,"stargazers_count":3,"watchers_count":3,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2,"open_issues":0,"watchers":3,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"d3022e99ce08c68f2a59b279f0cdbe4948365757","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49303"},"html":{"href":"https://github.com/apache/spark/pull/49303"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49303"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49303/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49303/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49303/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c0f2cc8b6eb51e7ad02364eed68e68d5775411e8"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49302","id":2252366084,"node_id":"PR_kwDOAQXtWs6GQGEE","html_url":"https://github.com/apache/spark/pull/49302","diff_url":"https://github.com/apache/spark/pull/49302.diff","patch_url":"https://github.com/apache/spark/pull/49302.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49302","number":49302,"state":"closed","locked":false,"title":"[SPARK-50678][BUILD] Clean up outdated style check rules related to Guava","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThe version of Guava being used by Spark is 33.3.1 now, so this pr cleans up the outdated check rules from `dev/checkstyle.xml` and `scalastyle-config.xml`\r\n-  The current version of Guava no longer has the `Objects.toStringHelper` method, so this check rule is no longer needed\r\n- CVE-2020-8908 has been fixed after version 32.0.0, so the related check is no longer needed\r\n- CVE-2023-2976 has been fixed after version 32.0.0, so the related check is no longer needed\r\n- CVE-2018-10237 has been fixed after version 24.1.1, so the related check is no longer needed\r\n\r\n### Why are the changes needed?\r\nClean up outdated style check rules related to Guava\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nPass Github Actions\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo","created_at":"2024-12-26T12:11:30Z","updated_at":"2025-01-03T17:54:55Z","closed_at":"2025-01-03T16:15:18Z","merged_at":null,"merge_commit_sha":"b1d0e53db8ac959f8a722c1b1094acfe92b6b661","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49302/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49302/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49302/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/aa8dfae31c6667105d8ec0a5a969dcd9b4f590bb","head":{"label":"LuciferYang:checkstyle-outdated","ref":"checkstyle-outdated","sha":"aa8dfae31c6667105d8ec0a5a969dcd9b4f590bb","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"3f333a0820a991a7642632a49e430843840b75ee","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49302"},"html":{"href":"https://github.com/apache/spark/pull/49302"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49302"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49302/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49302/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49302/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/aa8dfae31c6667105d8ec0a5a969dcd9b4f590bb"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49301","id":2252320451,"node_id":"PR_kwDOAQXtWs6GP67D","html_url":"https://github.com/apache/spark/pull/49301","diff_url":"https://github.com/apache/spark/pull/49301.diff","patch_url":"https://github.com/apache/spark/pull/49301.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49301","number":49301,"state":"closed","locked":false,"title":"[SPARK-50677][BUILD] Upgrade jupiter-interface to 0.13.3 and Junit5 to 5.11.4","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis pr aims to upgrade `jupiter-interface` from 0.13.1 to 0.13.3 and Junit5 to the latest versionPlatform 1.11.4 + Jupiter 5.11.4.\r\n\r\n### Why are the changes needed?\r\nThe new version of `jupiter-interface` brings two fixes:\r\n\r\n- https://github.com/sbt/sbt-jupiter-interface/pull/126\r\n- https://github.com/sbt/sbt-jupiter-interface/pull/128\r\n\r\nThe full release notes of `jupiter-interface` as follows:\r\n\r\n- https://github.com/sbt/sbt-jupiter-interface/releases/tag/v0.13.3\r\n\r\nand the full release notes between Junit 5.11.3 to 5.11.4 as follows:\r\n\r\n- https://junit.org/junit5/docs/5.11.4/release-notes/#release-notes-5.11.4\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### How was this patch tested?\r\nPass GitHub Actions\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2024-12-26T11:16:48Z","updated_at":"2024-12-27T05:30:33Z","closed_at":"2024-12-27T01:39:33Z","merged_at":null,"merge_commit_sha":"2693ea9b0b38b1917b7fcb4c2d0c45326bebf303","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49301/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49301/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49301/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c294b1d949aa629251ac7d4a6812dd49f5862321","head":{"label":"LuciferYang:SPARK-50677","ref":"SPARK-50677","sha":"c294b1d949aa629251ac7d4a6812dd49f5862321","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"92948e73713f6f6629e1610ed0975fa8e619f1a8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49301"},"html":{"href":"https://github.com/apache/spark/pull/49301"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49301"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49301/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49301/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49301/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c294b1d949aa629251ac7d4a6812dd49f5862321"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49300","id":2252296805,"node_id":"PR_kwDOAQXtWs6GP1Jl","html_url":"https://github.com/apache/spark/pull/49300","diff_url":"https://github.com/apache/spark/pull/49300.diff","patch_url":"https://github.com/apache/spark/pull/49300.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49300","number":49300,"state":"closed","locked":false,"title":"[SPARK-50676][SQL] Remove unused `private lazy val mapValueContainsNull` from `ElementAt`","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nSPARK-33460 added `mapValueContainsNull` to `ElementAt`, but after SPARK-40066, this private lazy val is no longer used, so this pr removes it from `ElementAt`.\r\n\r\n### Why are the changes needed?\r\nCleanup unused code.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n\r\n### How was this patch tested?\r\nPass GitHub Actions\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo","created_at":"2024-12-26T10:50:00Z","updated_at":"2024-12-28T07:52:11Z","closed_at":"2024-12-28T07:51:36Z","merged_at":null,"merge_commit_sha":"9ae2ce50930d676866cca1aae16c5afc68b25ff0","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49300/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49300/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49300/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7e1b2ad893874c99a4874bb5a9301661b42dcd48","head":{"label":"LuciferYang:SPARK-50676","ref":"SPARK-50676","sha":"7e1b2ad893874c99a4874bb5a9301661b42dcd48","user":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":104327447,"node_id":"MDEwOlJlcG9zaXRvcnkxMDQzMjc0NDc=","name":"spark","full_name":"LuciferYang/spark","private":false,"owner":{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/LuciferYang/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/LuciferYang/spark","forks_url":"https://api.github.com/repos/LuciferYang/spark/forks","keys_url":"https://api.github.com/repos/LuciferYang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/LuciferYang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/LuciferYang/spark/teams","hooks_url":"https://api.github.com/repos/LuciferYang/spark/hooks","issue_events_url":"https://api.github.com/repos/LuciferYang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/LuciferYang/spark/events","assignees_url":"https://api.github.com/repos/LuciferYang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/LuciferYang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/LuciferYang/spark/tags","blobs_url":"https://api.github.com/repos/LuciferYang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/LuciferYang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/LuciferYang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/LuciferYang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/LuciferYang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/LuciferYang/spark/languages","stargazers_url":"https://api.github.com/repos/LuciferYang/spark/stargazers","contributors_url":"https://api.github.com/repos/LuciferYang/spark/contributors","subscribers_url":"https://api.github.com/repos/LuciferYang/spark/subscribers","subscription_url":"https://api.github.com/repos/LuciferYang/spark/subscription","commits_url":"https://api.github.com/repos/LuciferYang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/LuciferYang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/LuciferYang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/LuciferYang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/LuciferYang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/LuciferYang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/LuciferYang/spark/merges","archive_url":"https://api.github.com/repos/LuciferYang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/LuciferYang/spark/downloads","issues_url":"https://api.github.com/repos/LuciferYang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/LuciferYang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/LuciferYang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/LuciferYang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/LuciferYang/spark/labels{/name}","releases_url":"https://api.github.com/repos/LuciferYang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/LuciferYang/spark/deployments","created_at":"2017-09-21T09:20:50Z","updated_at":"2025-01-28T10:58:52Z","pushed_at":"2025-02-07T09:06:28Z","git_url":"git://github.com/LuciferYang/spark.git","ssh_url":"git@github.com:LuciferYang/spark.git","clone_url":"https://github.com/LuciferYang/spark.git","svn_url":"https://github.com/LuciferYang/spark","homepage":null,"size":478124,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"92948e73713f6f6629e1610ed0975fa8e619f1a8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49300"},"html":{"href":"https://github.com/apache/spark/pull/49300"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49300"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49300/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49300/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49300/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7e1b2ad893874c99a4874bb5a9301661b42dcd48"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49299","id":2252167689,"node_id":"PR_kwDOAQXtWs6GPVoJ","html_url":"https://github.com/apache/spark/pull/49299","diff_url":"https://github.com/apache/spark/pull/49299.diff","patch_url":"https://github.com/apache/spark/pull/49299.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49299","number":49299,"state":"closed","locked":false,"title":"[SPARK-50674][PYTHON] Fix check for terminate method existence in UDTF evaluation","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nFix check for terminate method existence in UDTF evaluation\r\n\r\n### Why are the changes needed?\r\nTo ensure that UDTFs without a terminate method can still be used with partitioning without causing an AttributeError.\r\n\r\nPreviously, udtf with partitioning will raise an AttributeError if the terminate method is not defined, as shown below\r\n```py\r\n>>> from pyspark.sql.functions import udtf\r\n>>> from pyspark.sql import Row\r\n>>> \r\n>>> @udtf(returnType=\"a: int\")\r\n... class TestUDTF:\r\n...     def eval(self, row: Row):\r\n...             if row[0] > 5:\r\n...                     yield row[0],\r\n... \r\n>>> spark.udtf.register(\"test_udtf\", TestUDTF)\r\n<pyspark.sql.udtf.UserDefinedTableFunction object at 0x10298a1d0>\r\n>>> spark.sql(\"SELECT * FROM test_udtf(TABLE (SELECT id FROM range(0, 8)) PARTITION BY id)\").show()\r\norg.apache.spark.api.python.PythonException: Traceback (most recent call last):\r\n...\r\n  File \"...pyspark/worker.py\", line 1052, in eval\r\n    if self._udtf.terminate is not None:\r\nAttributeError: 'TestUDTF' object has no attribute 'terminate'\r\n```\r\n\r\nHowever, the terminate method is not required in such cases.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.\r\n","created_at":"2024-12-26T08:41:18Z","updated_at":"2024-12-30T03:35:32Z","closed_at":"2024-12-27T10:11:44Z","merged_at":null,"merge_commit_sha":"356cd2dab61302c0d233c324de60c0b4f03489be","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49299/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49299/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49299/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/f0fb8ea842757cdaebf1d2d55067c7a5b471931d","head":{"label":"xinrong-meng:udtf_terminate","ref":"udtf_terminate","sha":"f0fb8ea842757cdaebf1d2d55067c7a5b471931d","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":335786381,"node_id":"MDEwOlJlcG9zaXRvcnkzMzU3ODYzODE=","name":"spark","full_name":"xinrong-meng/spark","private":false,"owner":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xinrong-meng/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xinrong-meng/spark","forks_url":"https://api.github.com/repos/xinrong-meng/spark/forks","keys_url":"https://api.github.com/repos/xinrong-meng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xinrong-meng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xinrong-meng/spark/teams","hooks_url":"https://api.github.com/repos/xinrong-meng/spark/hooks","issue_events_url":"https://api.github.com/repos/xinrong-meng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xinrong-meng/spark/events","assignees_url":"https://api.github.com/repos/xinrong-meng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xinrong-meng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xinrong-meng/spark/tags","blobs_url":"https://api.github.com/repos/xinrong-meng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xinrong-meng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xinrong-meng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xinrong-meng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xinrong-meng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xinrong-meng/spark/languages","stargazers_url":"https://api.github.com/repos/xinrong-meng/spark/stargazers","contributors_url":"https://api.github.com/repos/xinrong-meng/spark/contributors","subscribers_url":"https://api.github.com/repos/xinrong-meng/spark/subscribers","subscription_url":"https://api.github.com/repos/xinrong-meng/spark/subscription","commits_url":"https://api.github.com/repos/xinrong-meng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xinrong-meng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xinrong-meng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xinrong-meng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xinrong-meng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xinrong-meng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xinrong-meng/spark/merges","archive_url":"https://api.github.com/repos/xinrong-meng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xinrong-meng/spark/downloads","issues_url":"https://api.github.com/repos/xinrong-meng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xinrong-meng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xinrong-meng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xinrong-meng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xinrong-meng/spark/labels{/name}","releases_url":"https://api.github.com/repos/xinrong-meng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xinrong-meng/spark/deployments","created_at":"2021-02-03T23:47:29Z","updated_at":"2024-09-27T08:09:06Z","pushed_at":"2025-02-08T02:14:33Z","git_url":"git://github.com/xinrong-meng/spark.git","ssh_url":"git@github.com:xinrong-meng/spark.git","clone_url":"https://github.com/xinrong-meng/spark.git","svn_url":"https://github.com/xinrong-meng/spark","homepage":"https://spark.apache.org/","size":469811,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":2,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7a4114cdf9948480d86ec7c870f7a2fa4939cc67","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49299"},"html":{"href":"https://github.com/apache/spark/pull/49299"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49299"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49299/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49299/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49299/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/f0fb8ea842757cdaebf1d2d55067c7a5b471931d"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49298","id":2252140487,"node_id":"PR_kwDOAQXtWs6GPO_H","html_url":"https://github.com/apache/spark/pull/49298","diff_url":"https://github.com/apache/spark/pull/49298.diff","patch_url":"https://github.com/apache/spark/pull/49298.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49298","number":49298,"state":"closed","locked":false,"title":"[SPARK-50673][ML] Avoid traversing model coefficients twice in `Word2VecModel` constructor","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nAvoid traversing model twice in `Word2VecModel` constructor\r\n\r\n\r\n### Why are the changes needed?\r\nIn public constructor `def this(model: Map[String, Array[Float]])`,\r\nthe implementation traverses the model coefficients (which is a Map) twice to build the `Word2VecModel`, for `wordIndex` and `wordVectors`, respectively.\r\n\r\nI am not sure whether it might be problematic, since the two traversals needs the same ordering. \r\n\r\nGenerating the result with single pass can guarantee the correctness, anyway.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno\r\n\r\n\r\n### How was this patch tested?\r\nexisting tests\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nno","created_at":"2024-12-26T08:11:43Z","updated_at":"2024-12-27T00:32:05Z","closed_at":"2024-12-27T00:31:42Z","merged_at":null,"merge_commit_sha":"bac1909af2be9cdd755d9af25f678803c07f7315","assignee":null,"assignees":[],"requested_reviewers":[{"login":"WeichenXu123","id":19235986,"node_id":"MDQ6VXNlcjE5MjM1OTg2","avatar_url":"https://avatars.githubusercontent.com/u/19235986?v=4","gravatar_id":"","url":"https://api.github.com/users/WeichenXu123","html_url":"https://github.com/WeichenXu123","followers_url":"https://api.github.com/users/WeichenXu123/followers","following_url":"https://api.github.com/users/WeichenXu123/following{/other_user}","gists_url":"https://api.github.com/users/WeichenXu123/gists{/gist_id}","starred_url":"https://api.github.com/users/WeichenXu123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WeichenXu123/subscriptions","organizations_url":"https://api.github.com/users/WeichenXu123/orgs","repos_url":"https://api.github.com/users/WeichenXu123/repos","events_url":"https://api.github.com/users/WeichenXu123/events{/privacy}","received_events_url":"https://api.github.com/users/WeichenXu123/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405803268,"node_id":"MDU6TGFiZWwxNDA1ODAzMjY4","url":"https://api.github.com/repos/apache/spark/labels/MLLIB","name":"MLLIB","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49298/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49298/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49298/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ff4d2493154c6e5606655bb9524a903defe7f637","head":{"label":"zhengruifeng:ml_w2v_build","ref":"ml_w2v_build","sha":"ff4d2493154c6e5606655bb9524a903defe7f637","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7a4114cdf9948480d86ec7c870f7a2fa4939cc67","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49298"},"html":{"href":"https://github.com/apache/spark/pull/49298"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49298"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49298/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49298/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49298/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ff4d2493154c6e5606655bb9524a903defe7f637"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49297","id":2252075146,"node_id":"PR_kwDOAQXtWs6GO_CK","html_url":"https://github.com/apache/spark/pull/49297","diff_url":"https://github.com/apache/spark/pull/49297.diff","patch_url":"https://github.com/apache/spark/pull/49297.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49297","number":49297,"state":"closed","locked":false,"title":"[DO-NOT-MERGE] Pythonic approach of setting Spark SQL configurations","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes Pythonic approach of setting Spark SQL configurations as below.\r\n\r\n**Get/set/unset the configurations**\r\n\r\n```python\r\n>>> spark.conf[\"spark.sql.optimizer.runtime.rowLevelOperationGroupFilter.enabled\"] = \"false\"\r\n>>> spark.conf[\"spark.sql.optimizer.runtime.rowLevelOperationGroupFilter.enabled\"]\r\n'false'\r\n>>> spark.conf.spark.sql.optimizer.runtime.rowLevelOperationGroupFilter.enabled = \"true\"\r\n>>> spark.conf.spark.sql.optimizer.runtime.rowLevelOperationGroupFilter.enabled\r\n'true'\r\n```\r\n\r\n```python\r\n>>> spark.conf[\"spark.sql.optimizer.runtime.rowLevelOperationGroupFilter.enabled\"] = \"false\"\r\n>>> spark.conf[\"spark.sql.optimizer.runtime.rowLevelOperationGroupFilter.enabled\"]\r\n'false'\r\n>>> del spark.conf[\"spark.sql.optimizer.runtime.rowLevelOperationGroupFilter.enabled\"]\r\n>>> spark.conf[\"spark.sql.optimizer.runtime.rowLevelOperationGroupFilter.enabled\"]\r\n'true'\r\n```\r\n\r\n\r\n**List sub configurations**\r\n\r\n```python\r\n>>> dir(spark.conf[\"spark.sql.optimizer\"])\r\n['avoidCollapseUDFWithExpensiveExpr', 'collapseProjectAlwaysInline', 'dynamicPartitionPruning.enabled', 'enableCsvExpressionOptimization', 'enableJsonExpressionOptimization', 'excludedRules', 'ptimizer.excludedRules', 'runtime.bloomFilter.applicationSideScanSizeThreshold', 'runtime.bloomFilter.creationSideThreshold', 'runtime.bloomFilter.enabled', 'runtime.bloomFilter.expectedNumItems', 'runtime.bloomFilter.maxNumBits', 'runtime.bloomFilter.maxNumItems', 'runtime.bloomFilter.numBits', 'runtime.rowLevelOperationGroupFilter.enabled', 'runtimeFilter.number.threshold']\r\n>>> dir(spark.conf.spark.sql.optimizer)\r\n['avoidCollapseUDFWithExpensiveExpr', 'collapseProjectAlwaysInline', 'dynamicPartitionPruning.enabled', 'enableCsvExpressionOptimization', 'enableJsonExpressionOptimization', 'excludedRules', 'ptimizer.excludedRules', 'runtime.bloomFilter.applicationSideScanSizeThreshold', 'runtime.bloomFilter.creationSideThreshold', 'runtime.bloomFilter.enabled', 'runtime.bloomFilter.expectedNumItems', 'runtime.bloomFilter.maxNumBits', 'runtime.bloomFilter.maxNumItems', 'runtime.bloomFilter.numBits', 'runtime.rowLevelOperationGroupFilter.enabled', 'runtimeFilter.number.threshold']\r\n```\r\n\r\n**Get documentation from the configuration**\r\n\r\n```python\r\n>>> spark.conf[\"spark.sql.optimizer.runtime.rowLevelOperationGroupFilter.enabled\"].desc()\r\n\"Enables runtime group filtering for group-based row-level operations. Data sources that replace groups of data (e.g. files, partitions) may prune entire groups using provided data source filters when planning a row-level operation scan. However, such filtering is limited as not all expressions can be converted into data source filters and some expressions can only be evaluated by Spark (e.g. subqueries). Since rewriting groups is expensive, Spark can execute a query at runtime to find what records match the condition of the row-level operation. The information about matching records will be passed back to the row-level operation scan, allowing data sources to discard groups that don't have to be rewritten.\"\r\n```\r\n\r\n```python\r\n>>> spark.conf.spark.sql.optimizer.runtime.rowLevelOperationGroupFilter.enabled.version()\r\n'3.4.0'\r\n```\r\n\r\n\r\n### Why are the changes needed?\r\n\r\nTo provide Pythonic ways of setting options. This is also supported in pandas as a reference (https://pandas.pydata.org/docs/user_guide/options.html).\r\n\r\nThis should be pretty useful for interactive shell users in a way that they do not have to open a SQL configuration documentation, and check configurations and their documentation.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nYes, it provides users more Pythonic way of setting SQL configurations as demonstrated above.\r\n\r\n### How was this patch tested?\r\n\r\nTBD\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.\r\n","created_at":"2024-12-26T06:58:53Z","updated_at":"2025-02-05T05:39:26Z","closed_at":"2025-02-05T05:39:26Z","merged_at":null,"merge_commit_sha":"1f2dcf0060b828a4d0e1328a799a52a17b60071a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":true,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49297/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49297/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49297/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/87ef983cbdf74ca1c0d545854e411ce834b75a3d","head":{"label":"HyukjinKwon:poc-string","ref":"poc-string","sha":"87ef983cbdf74ca1c0d545854e411ce834b75a3d","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"b309db092cbb67fedb7cec9ab0ebcd07d8d95b04","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49297"},"html":{"href":"https://github.com/apache/spark/pull/49297"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49297"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49297/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49297/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49297/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/87ef983cbdf74ca1c0d545854e411ce834b75a3d"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49296","id":2252054410,"node_id":"PR_kwDOAQXtWs6GO5-K","html_url":"https://github.com/apache/spark/pull/49296","diff_url":"https://github.com/apache/spark/pull/49296.diff","patch_url":"https://github.com/apache/spark/pull/49296.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49296","number":49296,"state":"closed","locked":false,"title":"[SPARK-50671][BUILD] Error compiling spark-protobuf module using user-defined protoc","user":{"login":"morvenhuang","id":7865928,"node_id":"MDQ6VXNlcjc4NjU5Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/7865928?v=4","gravatar_id":"","url":"https://api.github.com/users/morvenhuang","html_url":"https://github.com/morvenhuang","followers_url":"https://api.github.com/users/morvenhuang/followers","following_url":"https://api.github.com/users/morvenhuang/following{/other_user}","gists_url":"https://api.github.com/users/morvenhuang/gists{/gist_id}","starred_url":"https://api.github.com/users/morvenhuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/morvenhuang/subscriptions","organizations_url":"https://api.github.com/users/morvenhuang/orgs","repos_url":"https://api.github.com/users/morvenhuang/repos","events_url":"https://api.github.com/users/morvenhuang/events{/privacy}","received_events_url":"https://api.github.com/users/morvenhuang/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nPeople may use user-defined protoc(as below) for various reasons, for example, if they're on macOS 11, they have to use it since the default version of protoc and protoc-gen-grpc-java plugin do not work on macOS 11. \r\n\r\n```\r\n$ export SPARK_PROTOC_EXEC_PATH=/Users/foobar/dev/protoc-4.29.1/protoc\r\n$ export CONNECT_PLUGIN_EXEC_PATH=/Users/foobar/dev/protoc-gen-grpc-java-1.59.1/protoc-gen-grpc-java\r\n$ ./build/mvn -DskipTests clean package -Puser-defined-protoc -DskipDefaultProtoc\r\n```\r\n\r\nBut this results in compilation failure:\r\n\r\n```\r\n[ERROR] Failed to execute goal com.github.os72:protoc-jar-maven-plugin:3.11.4:run (default) on project spark-protobuf_2.13: Execution default of goal com.github.os72:protoc-jar-maven-plugin:3.11.4:run failed: Cannot read the array length because \"<local6>\" is null\r\n```\r\n\r\nThis PR aims to fix this compilation failure, the error is caused by `protocol-jar-maven-plugin` bug:\r\n\r\n- os72/protoc-jar-maven-plugin#104\r\n\r\n\r\n### Why are the changes needed?\r\nBefore:\r\n```\r\n$ export SPARK_PROTOC_EXEC_PATH=/Users/foobar/dev/protoc-4.29.1/protoc\r\n$ export CONNECT_PLUGIN_EXEC_PATH=/Users/foobar/dev/protoc-gen-grpc-java-1.59.1/protoc-gen-grpc-java\r\n$ ./build/mvn -DskipTests clean package -Puser-defined-protoc -DskipDefaultProtoc\r\n...\r\n[ERROR] Failed to execute goal com.github.os72:protoc-jar-maven-plugin:3.11.4:run (default) on project spark-protobuf_2.13: Execution default of goal com.github.os72:protoc-jar-maven-plugin:3.11.4:run failed: Cannot read the array length because \"<local6>\" is null\r\n```\r\n\r\nAfter:\r\n```\r\n$ export SPARK_PROTOC_EXEC_PATH=/Users/foobar/dev/protoc-4.29.1/protoc\r\n$ export CONNECT_PLUGIN_EXEC_PATH=/Users/foobar/dev/protoc-gen-grpc-java-1.59.1/protoc-gen-grpc-java\r\n$ ./build/mvn -DskipTests clean package -Puser-defined-protoc -DskipDefaultProtoc\r\n...\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Reactor Summary for Spark Project Parent POM 4.0.0-SNAPSHOT:\r\n[INFO]\r\n[INFO] Spark Project Parent POM ........................... SUCCESS [  7.539 s]\r\n[INFO] Spark Project Tags ................................. SUCCESS [  7.527 s]\r\n[INFO] Spark Project Sketch ............................... SUCCESS [  8.413 s]\r\n[INFO] Spark Project Common Utils ......................... SUCCESS [ 29.923 s]\r\n[INFO] Spark Project Local DB ............................. SUCCESS [ 10.732 s]\r\n[INFO] Spark Project Networking ........................... SUCCESS [ 16.691 s]\r\n[INFO] Spark Project Shuffle Streaming Service ............ SUCCESS [ 12.653 s]\r\n[INFO] Spark Project Variant .............................. SUCCESS [  5.262 s]\r\n[INFO] Spark Project Unsafe ............................... SUCCESS [ 16.246 s]\r\n[INFO] Spark Project Connect Shims ........................ SUCCESS [  4.356 s]\r\n[INFO] Spark Project Launcher ............................. SUCCESS [  8.666 s]\r\n[INFO] Spark Project Core ................................. SUCCESS [02:56 min]\r\n[INFO] Spark Project ML Local Library ..................... SUCCESS [ 30.063 s]\r\n[INFO] Spark Project GraphX ............................... SUCCESS [ 33.989 s]\r\n[INFO] Spark Project Streaming ............................ SUCCESS [ 51.897 s]\r\n[INFO] Spark Project SQL API .............................. SUCCESS [ 39.508 s]\r\n[INFO] Spark Project Catalyst ............................. SUCCESS [03:15 min]\r\n[INFO] Spark Project SQL .................................. SUCCESS [04:56 min]\r\n[INFO] Spark Project ML Library ........................... SUCCESS [02:30 min]\r\n[INFO] Spark Project Tools ................................ SUCCESS [  4.463 s]\r\n[INFO] Spark Project Hive ................................. SUCCESS [01:33 min]\r\n[INFO] Spark Project Connect Common ....................... SUCCESS [ 55.308 s]\r\n[INFO] Spark Avro ......................................... SUCCESS [ 33.350 s]\r\n[INFO] Spark Protobuf ..................................... SUCCESS [ 38.981 s]\r\n[INFO] Spark Project REPL ................................. SUCCESS [ 21.165 s]\r\n[INFO] Spark Project Connect Server ....................... SUCCESS [ 58.033 s]\r\n[INFO] Spark Project Connect Client ....................... SUCCESS [ 59.078 s]\r\n[INFO] Spark Project Assembly ............................. SUCCESS [  6.703 s]\r\n[INFO] Kafka 0.10+ Token Provider for Streaming ........... SUCCESS [ 20.047 s]\r\n[INFO] Spark Integration for Kafka 0.10 ................... SUCCESS [ 26.882 s]\r\n[INFO] Kafka 0.10+ Source for Structured Streaming ........ SUCCESS [ 41.397 s]\r\n[INFO] Spark Project Examples ............................. SUCCESS [ 41.308 s]\r\n[INFO] Spark Integration for Kafka 0.10 Assembly .......... SUCCESS [ 11.300 s]\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] BUILD SUCCESS\r\n```\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n\r\n### How was this patch tested?\r\nRun command:\r\n```\r\n$ export SPARK_PROTOC_EXEC_PATH=/Users/foobar/dev/protoc-4.29.1/protoc\r\n$ export CONNECT_PLUGIN_EXEC_PATH=/Users/foobar/dev/protoc-gen-grpc-java-1.59.1/protoc-gen-grpc-java\r\n$ ./build/mvn -DskipTests clean package -Puser-defined-protoc -DskipDefaultProtoc\r\n```\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.\r\n","created_at":"2024-12-26T06:33:19Z","updated_at":"2025-01-06T08:36:13Z","closed_at":"2025-01-06T08:24:18Z","merged_at":null,"merge_commit_sha":"bcfab28302a26ba376c863e3cfb070169520c0da","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":4654282764,"node_id":"LA_kwDOAQXtWs8AAAABFWq4DA","url":"https://api.github.com/repos/apache/spark/labels/PROTOBUF","name":"PROTOBUF","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49296/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49296/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49296/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/af23a6a52df570f7eac0d71721dc69a466418dfa","head":{"label":"morvenhuang:SPARK-50671","ref":"SPARK-50671","sha":"af23a6a52df570f7eac0d71721dc69a466418dfa","user":{"login":"morvenhuang","id":7865928,"node_id":"MDQ6VXNlcjc4NjU5Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/7865928?v=4","gravatar_id":"","url":"https://api.github.com/users/morvenhuang","html_url":"https://github.com/morvenhuang","followers_url":"https://api.github.com/users/morvenhuang/followers","following_url":"https://api.github.com/users/morvenhuang/following{/other_user}","gists_url":"https://api.github.com/users/morvenhuang/gists{/gist_id}","starred_url":"https://api.github.com/users/morvenhuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/morvenhuang/subscriptions","organizations_url":"https://api.github.com/users/morvenhuang/orgs","repos_url":"https://api.github.com/users/morvenhuang/repos","events_url":"https://api.github.com/users/morvenhuang/events{/privacy}","received_events_url":"https://api.github.com/users/morvenhuang/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":459084771,"node_id":"R_kgDOG10T4w","name":"spark","full_name":"morvenhuang/spark","private":false,"owner":{"login":"morvenhuang","id":7865928,"node_id":"MDQ6VXNlcjc4NjU5Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/7865928?v=4","gravatar_id":"","url":"https://api.github.com/users/morvenhuang","html_url":"https://github.com/morvenhuang","followers_url":"https://api.github.com/users/morvenhuang/followers","following_url":"https://api.github.com/users/morvenhuang/following{/other_user}","gists_url":"https://api.github.com/users/morvenhuang/gists{/gist_id}","starred_url":"https://api.github.com/users/morvenhuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/morvenhuang/subscriptions","organizations_url":"https://api.github.com/users/morvenhuang/orgs","repos_url":"https://api.github.com/users/morvenhuang/repos","events_url":"https://api.github.com/users/morvenhuang/events{/privacy}","received_events_url":"https://api.github.com/users/morvenhuang/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/morvenhuang/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/morvenhuang/spark","forks_url":"https://api.github.com/repos/morvenhuang/spark/forks","keys_url":"https://api.github.com/repos/morvenhuang/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/morvenhuang/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/morvenhuang/spark/teams","hooks_url":"https://api.github.com/repos/morvenhuang/spark/hooks","issue_events_url":"https://api.github.com/repos/morvenhuang/spark/issues/events{/number}","events_url":"https://api.github.com/repos/morvenhuang/spark/events","assignees_url":"https://api.github.com/repos/morvenhuang/spark/assignees{/user}","branches_url":"https://api.github.com/repos/morvenhuang/spark/branches{/branch}","tags_url":"https://api.github.com/repos/morvenhuang/spark/tags","blobs_url":"https://api.github.com/repos/morvenhuang/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/morvenhuang/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/morvenhuang/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/morvenhuang/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/morvenhuang/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/morvenhuang/spark/languages","stargazers_url":"https://api.github.com/repos/morvenhuang/spark/stargazers","contributors_url":"https://api.github.com/repos/morvenhuang/spark/contributors","subscribers_url":"https://api.github.com/repos/morvenhuang/spark/subscribers","subscription_url":"https://api.github.com/repos/morvenhuang/spark/subscription","commits_url":"https://api.github.com/repos/morvenhuang/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/morvenhuang/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/morvenhuang/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/morvenhuang/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/morvenhuang/spark/contents/{+path}","compare_url":"https://api.github.com/repos/morvenhuang/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/morvenhuang/spark/merges","archive_url":"https://api.github.com/repos/morvenhuang/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/morvenhuang/spark/downloads","issues_url":"https://api.github.com/repos/morvenhuang/spark/issues{/number}","pulls_url":"https://api.github.com/repos/morvenhuang/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/morvenhuang/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/morvenhuang/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/morvenhuang/spark/labels{/name}","releases_url":"https://api.github.com/repos/morvenhuang/spark/releases{/id}","deployments_url":"https://api.github.com/repos/morvenhuang/spark/deployments","created_at":"2022-02-14T08:57:14Z","updated_at":"2025-01-06T08:39:39Z","pushed_at":"2025-01-06T08:39:22Z","git_url":"git://github.com/morvenhuang/spark.git","ssh_url":"git@github.com:morvenhuang/spark.git","clone_url":"https://github.com/morvenhuang/spark.git","svn_url":"https://github.com/morvenhuang/spark","homepage":"https://spark.apache.org/","size":460789,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"ac91a7d3eac92d57963e6cefd0d35705e5afd296","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49296"},"html":{"href":"https://github.com/apache/spark/pull/49296"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49296"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49296/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49296/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49296/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/af23a6a52df570f7eac0d71721dc69a466418dfa"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49295","id":2252054186,"node_id":"PR_kwDOAQXtWs6GO56q","html_url":"https://github.com/apache/spark/pull/49295","diff_url":"https://github.com/apache/spark/pull/49295.diff","patch_url":"https://github.com/apache/spark/pull/49295.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49295","number":49295,"state":"open","locked":false,"title":"[SPARK-48458][SQL] Data loss in dynamic override fix","user":{"login":"akupchinskiy","id":110655003,"node_id":"U_kgDOBph2Gw","avatar_url":"https://avatars.githubusercontent.com/u/110655003?v=4","gravatar_id":"","url":"https://api.github.com/users/akupchinskiy","html_url":"https://github.com/akupchinskiy","followers_url":"https://api.github.com/users/akupchinskiy/followers","following_url":"https://api.github.com/users/akupchinskiy/following{/other_user}","gists_url":"https://api.github.com/users/akupchinskiy/gists{/gist_id}","starred_url":"https://api.github.com/users/akupchinskiy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akupchinskiy/subscriptions","organizations_url":"https://api.github.com/users/akupchinskiy/orgs","repos_url":"https://api.github.com/users/akupchinskiy/repos","events_url":"https://api.github.com/users/akupchinskiy/events{/privacy}","received_events_url":"https://api.github.com/users/akupchinskiy/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\nIn the run of InsertIntoHadoopFsRelationCommand, we should proactively detect if the spark session was stopped and fail fast in such cases, before any cleaning directories actions start. \r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nWhen the dynamic partition override mode is turned on, there is a data corruption risk if a spark session is stopped in unlucky time for any reason.  \r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\nRun [the exemplary gist](https://gist.github.com/akupchinskiy/b5f31781d59e5c0e9b172e7de40132cd) on the top a local build: \r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nNo","created_at":"2024-12-26T06:33:00Z","updated_at":"2024-12-26T06:36:19Z","closed_at":null,"merged_at":null,"merge_commit_sha":null,"assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49295/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49295/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49295/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/218b91958e5275a5b7f79ab00e39ec2f0c3bc836","head":{"label":"akupchinskiy:data-loss-in-dynamic-override-fix","ref":"data-loss-in-dynamic-override-fix","sha":"218b91958e5275a5b7f79ab00e39ec2f0c3bc836","user":{"login":"akupchinskiy","id":110655003,"node_id":"U_kgDOBph2Gw","avatar_url":"https://avatars.githubusercontent.com/u/110655003?v=4","gravatar_id":"","url":"https://api.github.com/users/akupchinskiy","html_url":"https://github.com/akupchinskiy","followers_url":"https://api.github.com/users/akupchinskiy/followers","following_url":"https://api.github.com/users/akupchinskiy/following{/other_user}","gists_url":"https://api.github.com/users/akupchinskiy/gists{/gist_id}","starred_url":"https://api.github.com/users/akupchinskiy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akupchinskiy/subscriptions","organizations_url":"https://api.github.com/users/akupchinskiy/orgs","repos_url":"https://api.github.com/users/akupchinskiy/repos","events_url":"https://api.github.com/users/akupchinskiy/events{/privacy}","received_events_url":"https://api.github.com/users/akupchinskiy/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":907810894,"node_id":"R_kgDONhwYTg","name":"spark","full_name":"akupchinskiy/spark","private":false,"owner":{"login":"akupchinskiy","id":110655003,"node_id":"U_kgDOBph2Gw","avatar_url":"https://avatars.githubusercontent.com/u/110655003?v=4","gravatar_id":"","url":"https://api.github.com/users/akupchinskiy","html_url":"https://github.com/akupchinskiy","followers_url":"https://api.github.com/users/akupchinskiy/followers","following_url":"https://api.github.com/users/akupchinskiy/following{/other_user}","gists_url":"https://api.github.com/users/akupchinskiy/gists{/gist_id}","starred_url":"https://api.github.com/users/akupchinskiy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akupchinskiy/subscriptions","organizations_url":"https://api.github.com/users/akupchinskiy/orgs","repos_url":"https://api.github.com/users/akupchinskiy/repos","events_url":"https://api.github.com/users/akupchinskiy/events{/privacy}","received_events_url":"https://api.github.com/users/akupchinskiy/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/akupchinskiy/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/akupchinskiy/spark","forks_url":"https://api.github.com/repos/akupchinskiy/spark/forks","keys_url":"https://api.github.com/repos/akupchinskiy/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/akupchinskiy/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/akupchinskiy/spark/teams","hooks_url":"https://api.github.com/repos/akupchinskiy/spark/hooks","issue_events_url":"https://api.github.com/repos/akupchinskiy/spark/issues/events{/number}","events_url":"https://api.github.com/repos/akupchinskiy/spark/events","assignees_url":"https://api.github.com/repos/akupchinskiy/spark/assignees{/user}","branches_url":"https://api.github.com/repos/akupchinskiy/spark/branches{/branch}","tags_url":"https://api.github.com/repos/akupchinskiy/spark/tags","blobs_url":"https://api.github.com/repos/akupchinskiy/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/akupchinskiy/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/akupchinskiy/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/akupchinskiy/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/akupchinskiy/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/akupchinskiy/spark/languages","stargazers_url":"https://api.github.com/repos/akupchinskiy/spark/stargazers","contributors_url":"https://api.github.com/repos/akupchinskiy/spark/contributors","subscribers_url":"https://api.github.com/repos/akupchinskiy/spark/subscribers","subscription_url":"https://api.github.com/repos/akupchinskiy/spark/subscription","commits_url":"https://api.github.com/repos/akupchinskiy/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/akupchinskiy/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/akupchinskiy/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/akupchinskiy/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/akupchinskiy/spark/contents/{+path}","compare_url":"https://api.github.com/repos/akupchinskiy/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/akupchinskiy/spark/merges","archive_url":"https://api.github.com/repos/akupchinskiy/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/akupchinskiy/spark/downloads","issues_url":"https://api.github.com/repos/akupchinskiy/spark/issues{/number}","pulls_url":"https://api.github.com/repos/akupchinskiy/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/akupchinskiy/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/akupchinskiy/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/akupchinskiy/spark/labels{/name}","releases_url":"https://api.github.com/repos/akupchinskiy/spark/releases{/id}","deployments_url":"https://api.github.com/repos/akupchinskiy/spark/deployments","created_at":"2024-12-24T12:53:13Z","updated_at":"2024-12-26T05:36:11Z","pushed_at":"2024-12-27T13:00:47Z","git_url":"git://github.com/akupchinskiy/spark.git","ssh_url":"git@github.com:akupchinskiy/spark.git","clone_url":"https://github.com/akupchinskiy/spark.git","svn_url":"https://github.com/akupchinskiy/spark","homepage":"https://spark.apache.org/","size":417991,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"ac91a7d3eac92d57963e6cefd0d35705e5afd296","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49295"},"html":{"href":"https://github.com/apache/spark/pull/49295"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49295"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49295/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49295/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49295/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/218b91958e5275a5b7f79ab00e39ec2f0c3bc836"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49294","id":2252051539,"node_id":"PR_kwDOAQXtWs6GO5RT","html_url":"https://github.com/apache/spark/pull/49294","diff_url":"https://github.com/apache/spark/pull/49294.diff","patch_url":"https://github.com/apache/spark/pull/49294.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49294","number":49294,"state":"closed","locked":false,"title":"[SPARK-50672][PYTHON][TESTS] Make `openpyxl` optional in PySpark Tests","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nMake `openpyxl` optional in PySpark Tests\r\n\r\n\r\n### Why are the changes needed?\r\n`openpyxl` is an optional dependency of pandas, also optional to pyspark\r\n\r\nthe test should not fail without it.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno, test only\r\n\r\n\r\n### How was this patch tested?\r\nmanually check\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nno\r\n","created_at":"2024-12-26T06:29:32Z","updated_at":"2024-12-26T13:22:36Z","closed_at":"2024-12-26T13:22:01Z","merged_at":null,"merge_commit_sha":"03b89f12039c0a69df5d999063b109481795d9d3","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4138679613,"node_id":"LA_kwDOAQXtWs72rz09","url":"https://api.github.com/repos/apache/spark/labels/PANDAS%20API%20ON%20SPARK","name":"PANDAS API ON SPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49294/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49294/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49294/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8018a1fccdbb6ca8368504453fb750d08e860fdd","head":{"label":"zhengruifeng:optional_openpyxl","ref":"optional_openpyxl","sha":"8018a1fccdbb6ca8368504453fb750d08e860fdd","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"ac91a7d3eac92d57963e6cefd0d35705e5afd296","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49294"},"html":{"href":"https://github.com/apache/spark/pull/49294"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49294"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49294/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49294/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49294/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8018a1fccdbb6ca8368504453fb750d08e860fdd"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49293","id":2251853985,"node_id":"PR_kwDOAQXtWs6GOJCh","html_url":"https://github.com/apache/spark/pull/49293","diff_url":"https://github.com/apache/spark/pull/49293.diff","patch_url":"https://github.com/apache/spark/pull/49293.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49293","number":49293,"state":"closed","locked":false,"title":"[SPARK-50644][FOLLOWUP][SQL] Fix scalar cast in the shredded reader.","user":{"login":"chenhao-db","id":122326661,"node_id":"U_kgDOB0qOhQ","avatar_url":"https://avatars.githubusercontent.com/u/122326661?v=4","gravatar_id":"","url":"https://api.github.com/users/chenhao-db","html_url":"https://github.com/chenhao-db","followers_url":"https://api.github.com/users/chenhao-db/followers","following_url":"https://api.github.com/users/chenhao-db/following{/other_user}","gists_url":"https://api.github.com/users/chenhao-db/gists{/gist_id}","starred_url":"https://api.github.com/users/chenhao-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenhao-db/subscriptions","organizations_url":"https://api.github.com/users/chenhao-db/orgs","repos_url":"https://api.github.com/users/chenhao-db/repos","events_url":"https://api.github.com/users/chenhao-db/events{/privacy}","received_events_url":"https://api.github.com/users/chenhao-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nWe mostly use the `Cast` expression to implement the cast, but we need some custom logic for certain type combinations. We already have special handling for `long/decimal -> timestamp` in `VariantGet.cast`, so we should do the same thing in `ScalarCastHelper` to ensure consistency. `ScalarCastHelper` also needs special handling for `decimal -> string` to strip any trailing zeros.\r\n\r\n### Why are the changes needed?\r\n\r\nTo ensure that cast on shredded variant has the same semantics as cast on unshredded variant.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nUnit tests. They would fail without the change.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2024-12-25T22:43:45Z","updated_at":"2024-12-26T07:24:30Z","closed_at":"2024-12-26T07:24:30Z","merged_at":null,"merge_commit_sha":"a76a7f49a77ecd71392ff1b454c12ffc4df61f65","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49293/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49293/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49293/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9fafdfa878af3658e6e204a24ab3d44696a11071","head":{"label":"chenhao-db:fix_shredded_cast","ref":"fix_shredded_cast","sha":"9fafdfa878af3658e6e204a24ab3d44696a11071","user":{"login":"chenhao-db","id":122326661,"node_id":"U_kgDOB0qOhQ","avatar_url":"https://avatars.githubusercontent.com/u/122326661?v=4","gravatar_id":"","url":"https://api.github.com/users/chenhao-db","html_url":"https://github.com/chenhao-db","followers_url":"https://api.github.com/users/chenhao-db/followers","following_url":"https://api.github.com/users/chenhao-db/following{/other_user}","gists_url":"https://api.github.com/users/chenhao-db/gists{/gist_id}","starred_url":"https://api.github.com/users/chenhao-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenhao-db/subscriptions","organizations_url":"https://api.github.com/users/chenhao-db/orgs","repos_url":"https://api.github.com/users/chenhao-db/repos","events_url":"https://api.github.com/users/chenhao-db/events{/privacy}","received_events_url":"https://api.github.com/users/chenhao-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":608298960,"node_id":"R_kgDOJEHn0A","name":"oss","full_name":"chenhao-db/oss","private":false,"owner":{"login":"chenhao-db","id":122326661,"node_id":"U_kgDOB0qOhQ","avatar_url":"https://avatars.githubusercontent.com/u/122326661?v=4","gravatar_id":"","url":"https://api.github.com/users/chenhao-db","html_url":"https://github.com/chenhao-db","followers_url":"https://api.github.com/users/chenhao-db/followers","following_url":"https://api.github.com/users/chenhao-db/following{/other_user}","gists_url":"https://api.github.com/users/chenhao-db/gists{/gist_id}","starred_url":"https://api.github.com/users/chenhao-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenhao-db/subscriptions","organizations_url":"https://api.github.com/users/chenhao-db/orgs","repos_url":"https://api.github.com/users/chenhao-db/repos","events_url":"https://api.github.com/users/chenhao-db/events{/privacy}","received_events_url":"https://api.github.com/users/chenhao-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/chenhao-db/oss","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/chenhao-db/oss","forks_url":"https://api.github.com/repos/chenhao-db/oss/forks","keys_url":"https://api.github.com/repos/chenhao-db/oss/keys{/key_id}","collaborators_url":"https://api.github.com/repos/chenhao-db/oss/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/chenhao-db/oss/teams","hooks_url":"https://api.github.com/repos/chenhao-db/oss/hooks","issue_events_url":"https://api.github.com/repos/chenhao-db/oss/issues/events{/number}","events_url":"https://api.github.com/repos/chenhao-db/oss/events","assignees_url":"https://api.github.com/repos/chenhao-db/oss/assignees{/user}","branches_url":"https://api.github.com/repos/chenhao-db/oss/branches{/branch}","tags_url":"https://api.github.com/repos/chenhao-db/oss/tags","blobs_url":"https://api.github.com/repos/chenhao-db/oss/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/chenhao-db/oss/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/chenhao-db/oss/git/refs{/sha}","trees_url":"https://api.github.com/repos/chenhao-db/oss/git/trees{/sha}","statuses_url":"https://api.github.com/repos/chenhao-db/oss/statuses/{sha}","languages_url":"https://api.github.com/repos/chenhao-db/oss/languages","stargazers_url":"https://api.github.com/repos/chenhao-db/oss/stargazers","contributors_url":"https://api.github.com/repos/chenhao-db/oss/contributors","subscribers_url":"https://api.github.com/repos/chenhao-db/oss/subscribers","subscription_url":"https://api.github.com/repos/chenhao-db/oss/subscription","commits_url":"https://api.github.com/repos/chenhao-db/oss/commits{/sha}","git_commits_url":"https://api.github.com/repos/chenhao-db/oss/git/commits{/sha}","comments_url":"https://api.github.com/repos/chenhao-db/oss/comments{/number}","issue_comment_url":"https://api.github.com/repos/chenhao-db/oss/issues/comments{/number}","contents_url":"https://api.github.com/repos/chenhao-db/oss/contents/{+path}","compare_url":"https://api.github.com/repos/chenhao-db/oss/compare/{base}...{head}","merges_url":"https://api.github.com/repos/chenhao-db/oss/merges","archive_url":"https://api.github.com/repos/chenhao-db/oss/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/chenhao-db/oss/downloads","issues_url":"https://api.github.com/repos/chenhao-db/oss/issues{/number}","pulls_url":"https://api.github.com/repos/chenhao-db/oss/pulls{/number}","milestones_url":"https://api.github.com/repos/chenhao-db/oss/milestones{/number}","notifications_url":"https://api.github.com/repos/chenhao-db/oss/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/chenhao-db/oss/labels{/name}","releases_url":"https://api.github.com/repos/chenhao-db/oss/releases{/id}","deployments_url":"https://api.github.com/repos/chenhao-db/oss/deployments","created_at":"2023-03-01T18:22:10Z","updated_at":"2024-03-22T19:41:59Z","pushed_at":"2025-01-06T21:11:31Z","git_url":"git://github.com/chenhao-db/oss.git","ssh_url":"git@github.com:chenhao-db/oss.git","clone_url":"https://github.com/chenhao-db/oss.git","svn_url":"https://github.com/chenhao-db/oss","homepage":"https://spark.apache.org/","size":430222,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"9c9bdab64a4ca96fb648b19608d1b4def61c90ab","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49293"},"html":{"href":"https://github.com/apache/spark/pull/49293"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49293"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49293/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49293/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49293/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9fafdfa878af3658e6e204a24ab3d44696a11071"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49292","id":2251838003,"node_id":"PR_kwDOAQXtWs6GOFIz","html_url":"https://github.com/apache/spark/pull/49292","diff_url":"https://github.com/apache/spark/pull/49292.diff","patch_url":"https://github.com/apache/spark/pull/49292.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49292","number":49292,"state":"open","locked":false,"title":"[SPARK-48334] [CORE] Release RpcEnv when SparkContext Initialization Fails","user":{"login":"soumasish","id":8686095,"node_id":"MDQ6VXNlcjg2ODYwOTU=","avatar_url":"https://avatars.githubusercontent.com/u/8686095?v=4","gravatar_id":"","url":"https://api.github.com/users/soumasish","html_url":"https://github.com/soumasish","followers_url":"https://api.github.com/users/soumasish/followers","following_url":"https://api.github.com/users/soumasish/following{/other_user}","gists_url":"https://api.github.com/users/soumasish/gists{/gist_id}","starred_url":"https://api.github.com/users/soumasish/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/soumasish/subscriptions","organizations_url":"https://api.github.com/users/soumasish/orgs","repos_url":"https://api.github.com/users/soumasish/repos","events_url":"https://api.github.com/users/soumasish/events{/privacy}","received_events_url":"https://api.github.com/users/soumasish/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nIf a SparkContext fails during initialization (for example, due to invalid Spark configs), the drivers RpcEnv may have already started but never gets stopped, because SparkContexts _env field is still null and _env.stop() is not invoked in the catch block. As a result, the RPC server port remains bound indefinitely in that process. This PR adds logic to ensure that if the RPC server is partially created and a SparkContext constructor error occurs, we properly shut down the RpcEnv so it does not remain open.\r\n\r\n### Why are the changes needed?\r\n- Fixes a resource leak where an RPC port remains bound if SparkContexts initialization fails.\r\n- Ensures consistent cleanup in error scenarios, preventing indefinite port binding for a failed SparkContext.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo. Internal fix only; no visible API changes.\r\n\r\n### How was this patch tested?\r\n- WIP\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2024-12-25T21:13:24Z","updated_at":"2025-01-08T14:53:43Z","closed_at":null,"merged_at":null,"merge_commit_sha":"96887ee00b4e8b6f422a7adc5f2ca05103f0ca8c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":true,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49292/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49292/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49292/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/3ac8861cad3e9115fbc080d1a53852c51cc7e07b","head":{"label":"soumasish:SPARK-48334","ref":"SPARK-48334","sha":"3ac8861cad3e9115fbc080d1a53852c51cc7e07b","user":{"login":"soumasish","id":8686095,"node_id":"MDQ6VXNlcjg2ODYwOTU=","avatar_url":"https://avatars.githubusercontent.com/u/8686095?v=4","gravatar_id":"","url":"https://api.github.com/users/soumasish","html_url":"https://github.com/soumasish","followers_url":"https://api.github.com/users/soumasish/followers","following_url":"https://api.github.com/users/soumasish/following{/other_user}","gists_url":"https://api.github.com/users/soumasish/gists{/gist_id}","starred_url":"https://api.github.com/users/soumasish/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/soumasish/subscriptions","organizations_url":"https://api.github.com/users/soumasish/orgs","repos_url":"https://api.github.com/users/soumasish/repos","events_url":"https://api.github.com/users/soumasish/events{/privacy}","received_events_url":"https://api.github.com/users/soumasish/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":146815011,"node_id":"MDEwOlJlcG9zaXRvcnkxNDY4MTUwMTE=","name":"spark","full_name":"soumasish/spark","private":false,"owner":{"login":"soumasish","id":8686095,"node_id":"MDQ6VXNlcjg2ODYwOTU=","avatar_url":"https://avatars.githubusercontent.com/u/8686095?v=4","gravatar_id":"","url":"https://api.github.com/users/soumasish","html_url":"https://github.com/soumasish","followers_url":"https://api.github.com/users/soumasish/followers","following_url":"https://api.github.com/users/soumasish/following{/other_user}","gists_url":"https://api.github.com/users/soumasish/gists{/gist_id}","starred_url":"https://api.github.com/users/soumasish/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/soumasish/subscriptions","organizations_url":"https://api.github.com/users/soumasish/orgs","repos_url":"https://api.github.com/users/soumasish/repos","events_url":"https://api.github.com/users/soumasish/events{/privacy}","received_events_url":"https://api.github.com/users/soumasish/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/soumasish/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/soumasish/spark","forks_url":"https://api.github.com/repos/soumasish/spark/forks","keys_url":"https://api.github.com/repos/soumasish/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/soumasish/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/soumasish/spark/teams","hooks_url":"https://api.github.com/repos/soumasish/spark/hooks","issue_events_url":"https://api.github.com/repos/soumasish/spark/issues/events{/number}","events_url":"https://api.github.com/repos/soumasish/spark/events","assignees_url":"https://api.github.com/repos/soumasish/spark/assignees{/user}","branches_url":"https://api.github.com/repos/soumasish/spark/branches{/branch}","tags_url":"https://api.github.com/repos/soumasish/spark/tags","blobs_url":"https://api.github.com/repos/soumasish/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/soumasish/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/soumasish/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/soumasish/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/soumasish/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/soumasish/spark/languages","stargazers_url":"https://api.github.com/repos/soumasish/spark/stargazers","contributors_url":"https://api.github.com/repos/soumasish/spark/contributors","subscribers_url":"https://api.github.com/repos/soumasish/spark/subscribers","subscription_url":"https://api.github.com/repos/soumasish/spark/subscription","commits_url":"https://api.github.com/repos/soumasish/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/soumasish/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/soumasish/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/soumasish/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/soumasish/spark/contents/{+path}","compare_url":"https://api.github.com/repos/soumasish/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/soumasish/spark/merges","archive_url":"https://api.github.com/repos/soumasish/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/soumasish/spark/downloads","issues_url":"https://api.github.com/repos/soumasish/spark/issues{/number}","pulls_url":"https://api.github.com/repos/soumasish/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/soumasish/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/soumasish/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/soumasish/spark/labels{/name}","releases_url":"https://api.github.com/repos/soumasish/spark/releases{/id}","deployments_url":"https://api.github.com/repos/soumasish/spark/deployments","created_at":"2018-08-30T22:54:27Z","updated_at":"2024-11-22T21:38:26Z","pushed_at":"2024-12-25T21:07:22Z","git_url":"git://github.com/soumasish/spark.git","ssh_url":"git@github.com:soumasish/spark.git","clone_url":"https://github.com/soumasish/spark.git","svn_url":"https://github.com/soumasish/spark","homepage":null,"size":438715,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"9c9bdab64a4ca96fb648b19608d1b4def61c90ab","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49292"},"html":{"href":"https://github.com/apache/spark/pull/49292"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49292"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49292/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49292/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49292/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/3ac8861cad3e9115fbc080d1a53852c51cc7e07b"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49291","id":2251729884,"node_id":"PR_kwDOAQXtWs6GNqvc","html_url":"https://github.com/apache/spark/pull/49291","diff_url":"https://github.com/apache/spark/pull/49291.diff","patch_url":"https://github.com/apache/spark/pull/49291.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49291","number":49291,"state":"closed","locked":false,"title":"[SPARK-50669][SQL] Change the signature of TimestampAdd expression","user":{"login":"stevomitric","id":16582560,"node_id":"MDQ6VXNlcjE2NTgyNTYw","avatar_url":"https://avatars.githubusercontent.com/u/16582560?v=4","gravatar_id":"","url":"https://api.github.com/users/stevomitric","html_url":"https://github.com/stevomitric","followers_url":"https://api.github.com/users/stevomitric/followers","following_url":"https://api.github.com/users/stevomitric/following{/other_user}","gists_url":"https://api.github.com/users/stevomitric/gists{/gist_id}","starred_url":"https://api.github.com/users/stevomitric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevomitric/subscriptions","organizations_url":"https://api.github.com/users/stevomitric/orgs","repos_url":"https://api.github.com/users/stevomitric/repos","events_url":"https://api.github.com/users/stevomitric/events{/privacy}","received_events_url":"https://api.github.com/users/stevomitric/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nIn this PR the signature of `TimestampAdd` function was changed from `IntegerType` to `LongType` for quantity parameter.\r\n\r\n\r\n### Why are the changes needed?\r\nTo allow long types to be passed to timestamp_add function. Currently passing anything larger then `Int32.MaxValue` will cause a cast overflow exception. There is no need to restrict this method to only in32 values.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes, the following query passes:\r\n```sql\r\nselect\r\n  timestampadd(\r\n    millisecond,\r\n    1733011227403,\r\n    timestamp '1970-01-01T00:00:00.000Z'\r\n  )\r\n```\r\nAbove query now returns `2024-12-01T00:00:27.000+00:00` instead of throwing a cast exception.\r\n\r\n\r\n### How was this patch tested?\r\nNew tests in this PR.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2024-12-25T14:26:26Z","updated_at":"2024-12-27T01:23:35Z","closed_at":"2024-12-27T01:23:35Z","merged_at":null,"merge_commit_sha":"8a5781a6a80b2c4ab8b04ca75ae0cbf1b68d98f4","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49291/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49291/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49291/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ded753bdc3145767a292fbf475a2ba1cc0b30294","head":{"label":"stevomitric:stevomitric/timestampadd-long","ref":"stevomitric/timestampadd-long","sha":"ded753bdc3145767a292fbf475a2ba1cc0b30294","user":{"login":"stevomitric","id":16582560,"node_id":"MDQ6VXNlcjE2NTgyNTYw","avatar_url":"https://avatars.githubusercontent.com/u/16582560?v=4","gravatar_id":"","url":"https://api.github.com/users/stevomitric","html_url":"https://github.com/stevomitric","followers_url":"https://api.github.com/users/stevomitric/followers","following_url":"https://api.github.com/users/stevomitric/following{/other_user}","gists_url":"https://api.github.com/users/stevomitric/gists{/gist_id}","starred_url":"https://api.github.com/users/stevomitric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevomitric/subscriptions","organizations_url":"https://api.github.com/users/stevomitric/orgs","repos_url":"https://api.github.com/users/stevomitric/repos","events_url":"https://api.github.com/users/stevomitric/events{/privacy}","received_events_url":"https://api.github.com/users/stevomitric/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":768027483,"node_id":"R_kgDOLccrWw","name":"spark","full_name":"stevomitric/spark","private":false,"owner":{"login":"stevomitric","id":16582560,"node_id":"MDQ6VXNlcjE2NTgyNTYw","avatar_url":"https://avatars.githubusercontent.com/u/16582560?v=4","gravatar_id":"","url":"https://api.github.com/users/stevomitric","html_url":"https://github.com/stevomitric","followers_url":"https://api.github.com/users/stevomitric/followers","following_url":"https://api.github.com/users/stevomitric/following{/other_user}","gists_url":"https://api.github.com/users/stevomitric/gists{/gist_id}","starred_url":"https://api.github.com/users/stevomitric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevomitric/subscriptions","organizations_url":"https://api.github.com/users/stevomitric/orgs","repos_url":"https://api.github.com/users/stevomitric/repos","events_url":"https://api.github.com/users/stevomitric/events{/privacy}","received_events_url":"https://api.github.com/users/stevomitric/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/stevomitric/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/stevomitric/spark","forks_url":"https://api.github.com/repos/stevomitric/spark/forks","keys_url":"https://api.github.com/repos/stevomitric/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/stevomitric/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/stevomitric/spark/teams","hooks_url":"https://api.github.com/repos/stevomitric/spark/hooks","issue_events_url":"https://api.github.com/repos/stevomitric/spark/issues/events{/number}","events_url":"https://api.github.com/repos/stevomitric/spark/events","assignees_url":"https://api.github.com/repos/stevomitric/spark/assignees{/user}","branches_url":"https://api.github.com/repos/stevomitric/spark/branches{/branch}","tags_url":"https://api.github.com/repos/stevomitric/spark/tags","blobs_url":"https://api.github.com/repos/stevomitric/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/stevomitric/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/stevomitric/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/stevomitric/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/stevomitric/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/stevomitric/spark/languages","stargazers_url":"https://api.github.com/repos/stevomitric/spark/stargazers","contributors_url":"https://api.github.com/repos/stevomitric/spark/contributors","subscribers_url":"https://api.github.com/repos/stevomitric/spark/subscribers","subscription_url":"https://api.github.com/repos/stevomitric/spark/subscription","commits_url":"https://api.github.com/repos/stevomitric/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/stevomitric/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/stevomitric/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/stevomitric/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/stevomitric/spark/contents/{+path}","compare_url":"https://api.github.com/repos/stevomitric/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/stevomitric/spark/merges","archive_url":"https://api.github.com/repos/stevomitric/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/stevomitric/spark/downloads","issues_url":"https://api.github.com/repos/stevomitric/spark/issues{/number}","pulls_url":"https://api.github.com/repos/stevomitric/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/stevomitric/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/stevomitric/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/stevomitric/spark/labels{/name}","releases_url":"https://api.github.com/repos/stevomitric/spark/releases{/id}","deployments_url":"https://api.github.com/repos/stevomitric/spark/deployments","created_at":"2024-03-06T10:37:34Z","updated_at":"2025-01-15T16:32:49Z","pushed_at":"2025-01-20T12:09:34Z","git_url":"git://github.com/stevomitric/spark.git","ssh_url":"git@github.com:stevomitric/spark.git","clone_url":"https://github.com/stevomitric/spark.git","svn_url":"https://github.com/stevomitric/spark","homepage":"https://spark.apache.org/","size":420092,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"ef4be07fdad9c8078e22d4f3f068fee1b81cf967","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49291"},"html":{"href":"https://github.com/apache/spark/pull/49291"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49291"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49291/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49291/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49291/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ded753bdc3145767a292fbf475a2ba1cc0b30294"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49290","id":2251523269,"node_id":"PR_kwDOAQXtWs6GM4TF","html_url":"https://github.com/apache/spark/pull/49290","diff_url":"https://github.com/apache/spark/pull/49290.diff","patch_url":"https://github.com/apache/spark/pull/49290.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49290","number":49290,"state":"closed","locked":false,"title":"[SPARK-49632][SQL][FOLLOW-UP] Fix suggestion for `to_date` function","user":{"login":"mihailom-db","id":159067682,"node_id":"U_kgDOCXsuIg","avatar_url":"https://avatars.githubusercontent.com/u/159067682?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailom-db","html_url":"https://github.com/mihailom-db","followers_url":"https://api.github.com/users/mihailom-db/followers","following_url":"https://api.github.com/users/mihailom-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailom-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailom-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailom-db/subscriptions","organizations_url":"https://api.github.com/users/mihailom-db/orgs","repos_url":"https://api.github.com/users/mihailom-db/repos","events_url":"https://api.github.com/users/mihailom-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailom-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nChange of suggested function on failure from `try_to_timestamp` to `try_to_date` for `to_date` function.\r\n\r\n\r\n### Why are the changes needed?\r\nIn original PR https://github.com/apache/spark/pull/49227 we removed ANSI suggestion and left only a suggestion of try function to use. In case of `to_date`, use of `try_to_date` is more appropriate.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes\r\n\r\n\r\n### How was this patch tested?\r\nExisting tests scope error message change.\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.\r\n","created_at":"2024-12-25T07:48:43Z","updated_at":"2024-12-26T02:40:03Z","closed_at":"2024-12-26T02:40:03Z","merged_at":null,"merge_commit_sha":"4fd084bd7a1457c72d73b0cf7296e92ae0d1f8af","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49290/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49290/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49290/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b930b555a54fe945ededb4c1eb938e1c7c6a5437","head":{"label":"mihailom-db:cannot-parse-timestamp-follow-up","ref":"cannot-parse-timestamp-follow-up","sha":"b930b555a54fe945ededb4c1eb938e1c7c6a5437","user":{"login":"mihailom-db","id":159067682,"node_id":"U_kgDOCXsuIg","avatar_url":"https://avatars.githubusercontent.com/u/159067682?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailom-db","html_url":"https://github.com/mihailom-db","followers_url":"https://api.github.com/users/mihailom-db/followers","following_url":"https://api.github.com/users/mihailom-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailom-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailom-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailom-db/subscriptions","organizations_url":"https://api.github.com/users/mihailom-db/orgs","repos_url":"https://api.github.com/users/mihailom-db/repos","events_url":"https://api.github.com/users/mihailom-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailom-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":756245919,"node_id":"R_kgDOLRNlnw","name":"spark","full_name":"mihailom-db/spark","private":false,"owner":{"login":"mihailom-db","id":159067682,"node_id":"U_kgDOCXsuIg","avatar_url":"https://avatars.githubusercontent.com/u/159067682?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailom-db","html_url":"https://github.com/mihailom-db","followers_url":"https://api.github.com/users/mihailom-db/followers","following_url":"https://api.github.com/users/mihailom-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailom-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailom-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailom-db/subscriptions","organizations_url":"https://api.github.com/users/mihailom-db/orgs","repos_url":"https://api.github.com/users/mihailom-db/repos","events_url":"https://api.github.com/users/mihailom-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailom-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/mihailom-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/mihailom-db/spark","forks_url":"https://api.github.com/repos/mihailom-db/spark/forks","keys_url":"https://api.github.com/repos/mihailom-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/mihailom-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/mihailom-db/spark/teams","hooks_url":"https://api.github.com/repos/mihailom-db/spark/hooks","issue_events_url":"https://api.github.com/repos/mihailom-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/mihailom-db/spark/events","assignees_url":"https://api.github.com/repos/mihailom-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/mihailom-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/mihailom-db/spark/tags","blobs_url":"https://api.github.com/repos/mihailom-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/mihailom-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/mihailom-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/mihailom-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/mihailom-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/mihailom-db/spark/languages","stargazers_url":"https://api.github.com/repos/mihailom-db/spark/stargazers","contributors_url":"https://api.github.com/repos/mihailom-db/spark/contributors","subscribers_url":"https://api.github.com/repos/mihailom-db/spark/subscribers","subscription_url":"https://api.github.com/repos/mihailom-db/spark/subscription","commits_url":"https://api.github.com/repos/mihailom-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/mihailom-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/mihailom-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/mihailom-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/mihailom-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/mihailom-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/mihailom-db/spark/merges","archive_url":"https://api.github.com/repos/mihailom-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/mihailom-db/spark/downloads","issues_url":"https://api.github.com/repos/mihailom-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/mihailom-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/mihailom-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/mihailom-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/mihailom-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/mihailom-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/mihailom-db/spark/deployments","created_at":"2024-02-12T09:25:57Z","updated_at":"2024-08-05T08:15:59Z","pushed_at":"2024-12-25T11:37:24Z","git_url":"git://github.com/mihailom-db/spark.git","ssh_url":"git@github.com:mihailom-db/spark.git","clone_url":"https://github.com/mihailom-db/spark.git","svn_url":"https://github.com/mihailom-db/spark","homepage":"https://spark.apache.org/","size":480966,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"241454253a73b7dfe641d85784d8855504ca59b7","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49290"},"html":{"href":"https://github.com/apache/spark/pull/49290"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49290"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49290/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49290/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49290/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b930b555a54fe945ededb4c1eb938e1c7c6a5437"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49289","id":2251510974,"node_id":"PR_kwDOAQXtWs6GM1S-","html_url":"https://github.com/apache/spark/pull/49289","diff_url":"https://github.com/apache/spark/pull/49289.diff","patch_url":"https://github.com/apache/spark/pull/49289.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49289","number":49289,"state":"closed","locked":false,"title":"Add Python Arrow UDF concurrency mode","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\n","created_at":"2024-12-25T07:27:01Z","updated_at":"2024-12-26T00:01:43Z","closed_at":"2024-12-26T00:01:43Z","merged_at":null,"merge_commit_sha":"29801e1d25e81c0cb6e8402e1520dd496f5cf1a0","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":true,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49289/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49289/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49289/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/7681e7258ee188fbff7ab76cdbd9e6a19aa8b52c","head":{"label":"viirya:async_process","ref":"async_process","sha":"7681e7258ee188fbff7ab76cdbd9e6a19aa8b52c","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"ef4be07fdad9c8078e22d4f3f068fee1b81cf967","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49289"},"html":{"href":"https://github.com/apache/spark/pull/49289"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49289"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49289/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49289/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49289/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/7681e7258ee188fbff7ab76cdbd9e6a19aa8b52c"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49288","id":2251414863,"node_id":"PR_kwDOAQXtWs6GMd1P","html_url":"https://github.com/apache/spark/pull/49288","diff_url":"https://github.com/apache/spark/pull/49288.diff","patch_url":"https://github.com/apache/spark/pull/49288.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49288","number":49288,"state":"closed","locked":false,"title":"[SPARK-50667][PYTHON][TESTS] Make `jinja2` optional in PySpark Tests","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nMake `jinja2` optional in PySpark Tests\r\n\r\n\r\n### Why are the changes needed?\r\n`jinja2` is an optional dependency of `pandas`\r\n\r\nhttps://pypi.org/pypi/pandas/2.2.0/json\r\n\r\n```\r\n'jinja2>=3.1.2; extra == \"output-formatting\"'\r\n```\r\n\r\n\r\n\r\nIt is not a mandatory requirement of pyspark, so PySpark tests should succeed even it is not installed\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno, test-only\r\n\r\n\r\n### How was this patch tested?\r\nmanually test after uninstalling it\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nno","created_at":"2024-12-25T03:36:56Z","updated_at":"2024-12-26T03:56:08Z","closed_at":"2024-12-26T03:40:33Z","merged_at":null,"merge_commit_sha":"f0c340ce15857758d139658e2977d3ada1317eb8","assignee":null,"assignees":[],"requested_reviewers":[{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4138679613,"node_id":"LA_kwDOAQXtWs72rz09","url":"https://api.github.com/repos/apache/spark/labels/PANDAS%20API%20ON%20SPARK","name":"PANDAS API ON SPARK","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49288/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49288/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49288/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d25afa597002f36c1f42b0f5be111985b314dbe6","head":{"label":"zhengruifeng:optional_jinja2","ref":"optional_jinja2","sha":"d25afa597002f36c1f42b0f5be111985b314dbe6","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f9e117e01672e65034ea96672e0f137d835ddcb0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49288"},"html":{"href":"https://github.com/apache/spark/pull/49288"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49288"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49288/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49288/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49288/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d25afa597002f36c1f42b0f5be111985b314dbe6"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49287","id":2251331569,"node_id":"PR_kwDOAQXtWs6GMJfx","html_url":"https://github.com/apache/spark/pull/49287","diff_url":"https://github.com/apache/spark/pull/49287.diff","patch_url":"https://github.com/apache/spark/pull/49287.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49287","number":49287,"state":"closed","locked":false,"title":"[SPARK-50665][SQL] Substitute LocalRelation with ComparableLocalRelation in NormalizePlan","user":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nSubstitute `LocalRelation` with `ComparableLocalRelation` in `NormalizePlan`.\r\n\r\n`ComparableLocalRelation` has `Seq[Seq[Expression]]` instead of `Seq[InternalRow]`. The conversion happens through `Literal`s.\r\n\r\n### Why are the changes needed?\r\n\r\n`LocalRelation`'s data field is incomparable if it contains maps, because `ArrayBasedMapData` doesn't define `equals`: https://github.com/apache/spark/pull/13847\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo. This is to compare logical plans in the single-pass Analyzer.\r\n\r\n### How was this patch tested?\r\n\r\nN/A\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\ncopilot.nvim.","created_at":"2024-12-24T23:02:11Z","updated_at":"2024-12-26T02:52:07Z","closed_at":"2024-12-26T02:52:07Z","merged_at":null,"merge_commit_sha":"24c15924cda1fd08b22d6e0f8ec233babf0c187c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49287/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49287/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49287/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/da832dad6b1601eb31595005dd72fa93715b9a60","head":{"label":"vladimirg-db:vladimirg-db/normalize-local-relation","ref":"vladimirg-db/normalize-local-relation","sha":"da832dad6b1601eb31595005dd72fa93715b9a60","user":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":833519707,"node_id":"R_kgDOMa6AWw","name":"spark","full_name":"vladimirg-db/spark","private":false,"owner":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vladimirg-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/vladimirg-db/spark","forks_url":"https://api.github.com/repos/vladimirg-db/spark/forks","keys_url":"https://api.github.com/repos/vladimirg-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vladimirg-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vladimirg-db/spark/teams","hooks_url":"https://api.github.com/repos/vladimirg-db/spark/hooks","issue_events_url":"https://api.github.com/repos/vladimirg-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vladimirg-db/spark/events","assignees_url":"https://api.github.com/repos/vladimirg-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vladimirg-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vladimirg-db/spark/tags","blobs_url":"https://api.github.com/repos/vladimirg-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vladimirg-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vladimirg-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vladimirg-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vladimirg-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vladimirg-db/spark/languages","stargazers_url":"https://api.github.com/repos/vladimirg-db/spark/stargazers","contributors_url":"https://api.github.com/repos/vladimirg-db/spark/contributors","subscribers_url":"https://api.github.com/repos/vladimirg-db/spark/subscribers","subscription_url":"https://api.github.com/repos/vladimirg-db/spark/subscription","commits_url":"https://api.github.com/repos/vladimirg-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vladimirg-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vladimirg-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vladimirg-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vladimirg-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vladimirg-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vladimirg-db/spark/merges","archive_url":"https://api.github.com/repos/vladimirg-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vladimirg-db/spark/downloads","issues_url":"https://api.github.com/repos/vladimirg-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vladimirg-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vladimirg-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vladimirg-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vladimirg-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/vladimirg-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vladimirg-db/spark/deployments","created_at":"2024-07-25T08:13:07Z","updated_at":"2025-02-09T11:09:18Z","pushed_at":"2025-02-09T15:06:47Z","git_url":"git://github.com/vladimirg-db/spark.git","ssh_url":"git@github.com:vladimirg-db/spark.git","clone_url":"https://github.com/vladimirg-db/spark.git","svn_url":"https://github.com/vladimirg-db/spark","homepage":"https://spark.apache.org/","size":424040,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"ef4be07fdad9c8078e22d4f3f068fee1b81cf967","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49287"},"html":{"href":"https://github.com/apache/spark/pull/49287"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49287"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49287/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49287/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49287/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/da832dad6b1601eb31595005dd72fa93715b9a60"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49286","id":2251046361,"node_id":"PR_kwDOAQXtWs6GLD3Z","html_url":"https://github.com/apache/spark/pull/49286","diff_url":"https://github.com/apache/spark/pull/49286.diff","patch_url":"https://github.com/apache/spark/pull/49286.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49286","number":49286,"state":"open","locked":false,"title":"[SPARK-50662][PYTHON][WINDOWS] Escape ampersands in command arguments on windows","user":{"login":"Nassizouz","id":121959756,"node_id":"U_kgDOB0T1TA","avatar_url":"https://avatars.githubusercontent.com/u/121959756?v=4","gravatar_id":"","url":"https://api.github.com/users/Nassizouz","html_url":"https://github.com/Nassizouz","followers_url":"https://api.github.com/users/Nassizouz/followers","following_url":"https://api.github.com/users/Nassizouz/following{/other_user}","gists_url":"https://api.github.com/users/Nassizouz/gists{/gist_id}","starred_url":"https://api.github.com/users/Nassizouz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Nassizouz/subscriptions","organizations_url":"https://api.github.com/users/Nassizouz/orgs","repos_url":"https://api.github.com/users/Nassizouz/repos","events_url":"https://api.github.com/users/Nassizouz/events{/privacy}","received_events_url":"https://api.github.com/users/Nassizouz/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nChanging `java_gateway.py` and verious .cmd files so ampersands will be escaped using triple carets (^^^) on windows system\r\n\r\n\r\n### Why are the changes needed?\r\nOn windows system, spark-submit is operated by running a chain .cmd files, this flow didn't handled ampersands (&) correctly so in each step, if the arguments that were passed to the next .cmd file/java contained an ampersand, the flags were truncated up to the location of the first ampersand\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nYes\r\nThe previous behaviour couldn't handle configs with parameters, and the new one can\r\n\r\n\r\n### How was this patch tested?\r\nThis patch was tested on multiple windows machines across the company that work at\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2024-12-24T14:32:27Z","updated_at":"2024-12-25T09:18:37Z","closed_at":null,"merged_at":null,"merge_commit_sha":"13f10ddd718f488b66b56d16f03204880b77e4ae","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1445212545,"node_id":"MDU6TGFiZWwxNDQ1MjEyNTQ1","url":"https://api.github.com/repos/apache/spark/labels/SPARK%20SUBMIT","name":"SPARK SUBMIT","color":"ededed","default":false,"description":null},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982015569,"node_id":"MDU6TGFiZWwxOTgyMDE1NTY5","url":"https://api.github.com/repos/apache/spark/labels/WINDOWS","name":"WINDOWS","color":"ededed","default":false,"description":null},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49286/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49286/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49286/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/13dde7fcff89f05a136272836baa501f82c33a35","head":{"label":"Nassizouz:escape-ampersand-on-windows","ref":"escape-ampersand-on-windows","sha":"13dde7fcff89f05a136272836baa501f82c33a35","user":{"login":"Nassizouz","id":121959756,"node_id":"U_kgDOB0T1TA","avatar_url":"https://avatars.githubusercontent.com/u/121959756?v=4","gravatar_id":"","url":"https://api.github.com/users/Nassizouz","html_url":"https://github.com/Nassizouz","followers_url":"https://api.github.com/users/Nassizouz/followers","following_url":"https://api.github.com/users/Nassizouz/following{/other_user}","gists_url":"https://api.github.com/users/Nassizouz/gists{/gist_id}","starred_url":"https://api.github.com/users/Nassizouz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Nassizouz/subscriptions","organizations_url":"https://api.github.com/users/Nassizouz/orgs","repos_url":"https://api.github.com/users/Nassizouz/repos","events_url":"https://api.github.com/users/Nassizouz/events{/privacy}","received_events_url":"https://api.github.com/users/Nassizouz/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":906960646,"node_id":"R_kgDONg8fBg","name":"spark","full_name":"Nassizouz/spark","private":false,"owner":{"login":"Nassizouz","id":121959756,"node_id":"U_kgDOB0T1TA","avatar_url":"https://avatars.githubusercontent.com/u/121959756?v=4","gravatar_id":"","url":"https://api.github.com/users/Nassizouz","html_url":"https://github.com/Nassizouz","followers_url":"https://api.github.com/users/Nassizouz/followers","following_url":"https://api.github.com/users/Nassizouz/following{/other_user}","gists_url":"https://api.github.com/users/Nassizouz/gists{/gist_id}","starred_url":"https://api.github.com/users/Nassizouz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Nassizouz/subscriptions","organizations_url":"https://api.github.com/users/Nassizouz/orgs","repos_url":"https://api.github.com/users/Nassizouz/repos","events_url":"https://api.github.com/users/Nassizouz/events{/privacy}","received_events_url":"https://api.github.com/users/Nassizouz/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Nassizouz/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/Nassizouz/spark","forks_url":"https://api.github.com/repos/Nassizouz/spark/forks","keys_url":"https://api.github.com/repos/Nassizouz/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Nassizouz/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Nassizouz/spark/teams","hooks_url":"https://api.github.com/repos/Nassizouz/spark/hooks","issue_events_url":"https://api.github.com/repos/Nassizouz/spark/issues/events{/number}","events_url":"https://api.github.com/repos/Nassizouz/spark/events","assignees_url":"https://api.github.com/repos/Nassizouz/spark/assignees{/user}","branches_url":"https://api.github.com/repos/Nassizouz/spark/branches{/branch}","tags_url":"https://api.github.com/repos/Nassizouz/spark/tags","blobs_url":"https://api.github.com/repos/Nassizouz/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Nassizouz/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Nassizouz/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/Nassizouz/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Nassizouz/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/Nassizouz/spark/languages","stargazers_url":"https://api.github.com/repos/Nassizouz/spark/stargazers","contributors_url":"https://api.github.com/repos/Nassizouz/spark/contributors","subscribers_url":"https://api.github.com/repos/Nassizouz/spark/subscribers","subscription_url":"https://api.github.com/repos/Nassizouz/spark/subscription","commits_url":"https://api.github.com/repos/Nassizouz/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/Nassizouz/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/Nassizouz/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/Nassizouz/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/Nassizouz/spark/contents/{+path}","compare_url":"https://api.github.com/repos/Nassizouz/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Nassizouz/spark/merges","archive_url":"https://api.github.com/repos/Nassizouz/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Nassizouz/spark/downloads","issues_url":"https://api.github.com/repos/Nassizouz/spark/issues{/number}","pulls_url":"https://api.github.com/repos/Nassizouz/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/Nassizouz/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/Nassizouz/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Nassizouz/spark/labels{/name}","releases_url":"https://api.github.com/repos/Nassizouz/spark/releases{/id}","deployments_url":"https://api.github.com/repos/Nassizouz/spark/deployments","created_at":"2024-12-22T12:31:30Z","updated_at":"2024-12-22T12:31:30Z","pushed_at":"2024-12-25T09:18:36Z","git_url":"git://github.com/Nassizouz/spark.git","ssh_url":"git@github.com:Nassizouz/spark.git","clone_url":"https://github.com/Nassizouz/spark.git","svn_url":"https://github.com/Nassizouz/spark","homepage":"https://spark.apache.org/","size":417329,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2c1c4d2614ae1ff902c244209f7ec3c79102d3e0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49286"},"html":{"href":"https://github.com/apache/spark/pull/49286"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49286"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49286/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49286/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49286/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/13dde7fcff89f05a136272836baa501f82c33a35"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49285","id":2250953733,"node_id":"PR_kwDOAQXtWs6GKtQF","html_url":"https://github.com/apache/spark/pull/49285","diff_url":"https://github.com/apache/spark/pull/49285.diff","patch_url":"https://github.com/apache/spark/pull/49285.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49285","number":49285,"state":"closed","locked":false,"title":"[SPARK-50612][SQL][FOLLOWUP] Put normalization of inner project lists under a flag","user":{"login":"mihailotim-db","id":174342191,"node_id":"U_kgDOCmRALw","avatar_url":"https://avatars.githubusercontent.com/u/174342191?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailotim-db","html_url":"https://github.com/mihailotim-db","followers_url":"https://api.github.com/users/mihailotim-db/followers","following_url":"https://api.github.com/users/mihailotim-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailotim-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailotim-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailotim-db/subscriptions","organizations_url":"https://api.github.com/users/mihailotim-db/orgs","repos_url":"https://api.github.com/users/mihailotim-db/repos","events_url":"https://api.github.com/users/mihailotim-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailotim-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nPut the change made in https://github.com/apache/spark/pull/49230 under a flag so that it can be only turned on for single-pass analyzer. This is done in order to protect the Optimizer, in case Optimizer expects certain ordering in the inner project lists.\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\nModified existing tests.\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\n","created_at":"2024-12-24T12:57:07Z","updated_at":"2025-01-13T08:16:23Z","closed_at":"2025-01-13T08:16:22Z","merged_at":null,"merge_commit_sha":null,"assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49285/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49285/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49285/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9165fea63ae77cd69dfa9d4f224cda1a8cba939b","head":{"label":"mihailotim-db:mihailotim-db/normalize_project_list_flag","ref":"mihailotim-db/normalize_project_list_flag","sha":"9165fea63ae77cd69dfa9d4f224cda1a8cba939b","user":{"login":"mihailotim-db","id":174342191,"node_id":"U_kgDOCmRALw","avatar_url":"https://avatars.githubusercontent.com/u/174342191?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailotim-db","html_url":"https://github.com/mihailotim-db","followers_url":"https://api.github.com/users/mihailotim-db/followers","following_url":"https://api.github.com/users/mihailotim-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailotim-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailotim-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailotim-db/subscriptions","organizations_url":"https://api.github.com/users/mihailotim-db/orgs","repos_url":"https://api.github.com/users/mihailotim-db/repos","events_url":"https://api.github.com/users/mihailotim-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailotim-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":823540258,"node_id":"R_kgDOMRY6Ig","name":"spark","full_name":"mihailotim-db/spark","private":false,"owner":{"login":"mihailotim-db","id":174342191,"node_id":"U_kgDOCmRALw","avatar_url":"https://avatars.githubusercontent.com/u/174342191?v=4","gravatar_id":"","url":"https://api.github.com/users/mihailotim-db","html_url":"https://github.com/mihailotim-db","followers_url":"https://api.github.com/users/mihailotim-db/followers","following_url":"https://api.github.com/users/mihailotim-db/following{/other_user}","gists_url":"https://api.github.com/users/mihailotim-db/gists{/gist_id}","starred_url":"https://api.github.com/users/mihailotim-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mihailotim-db/subscriptions","organizations_url":"https://api.github.com/users/mihailotim-db/orgs","repos_url":"https://api.github.com/users/mihailotim-db/repos","events_url":"https://api.github.com/users/mihailotim-db/events{/privacy}","received_events_url":"https://api.github.com/users/mihailotim-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/mihailotim-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/mihailotim-db/spark","forks_url":"https://api.github.com/repos/mihailotim-db/spark/forks","keys_url":"https://api.github.com/repos/mihailotim-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/mihailotim-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/mihailotim-db/spark/teams","hooks_url":"https://api.github.com/repos/mihailotim-db/spark/hooks","issue_events_url":"https://api.github.com/repos/mihailotim-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/mihailotim-db/spark/events","assignees_url":"https://api.github.com/repos/mihailotim-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/mihailotim-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/mihailotim-db/spark/tags","blobs_url":"https://api.github.com/repos/mihailotim-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/mihailotim-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/mihailotim-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/mihailotim-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/mihailotim-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/mihailotim-db/spark/languages","stargazers_url":"https://api.github.com/repos/mihailotim-db/spark/stargazers","contributors_url":"https://api.github.com/repos/mihailotim-db/spark/contributors","subscribers_url":"https://api.github.com/repos/mihailotim-db/spark/subscribers","subscription_url":"https://api.github.com/repos/mihailotim-db/spark/subscription","commits_url":"https://api.github.com/repos/mihailotim-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/mihailotim-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/mihailotim-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/mihailotim-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/mihailotim-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/mihailotim-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/mihailotim-db/spark/merges","archive_url":"https://api.github.com/repos/mihailotim-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/mihailotim-db/spark/downloads","issues_url":"https://api.github.com/repos/mihailotim-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/mihailotim-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/mihailotim-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/mihailotim-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/mihailotim-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/mihailotim-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/mihailotim-db/spark/deployments","created_at":"2024-07-03T08:18:27Z","updated_at":"2024-08-21T14:53:45Z","pushed_at":"2025-02-04T16:22:41Z","git_url":"git://github.com/mihailotim-db/spark.git","ssh_url":"git@github.com:mihailotim-db/spark.git","clone_url":"https://github.com/mihailotim-db/spark.git","svn_url":"https://github.com/mihailotim-db/spark","homepage":"https://spark.apache.org/","size":423337,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2c1c4d2614ae1ff902c244209f7ec3c79102d3e0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49285"},"html":{"href":"https://github.com/apache/spark/pull/49285"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49285"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49285/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49285/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49285/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9165fea63ae77cd69dfa9d4f224cda1a8cba939b"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49284","id":2250883802,"node_id":"PR_kwDOAQXtWs6GKcLa","html_url":"https://github.com/apache/spark/pull/49284","diff_url":"https://github.com/apache/spark/pull/49284.diff","patch_url":"https://github.com/apache/spark/pull/49284.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49284","number":49284,"state":"closed","locked":false,"title":"[SPARK-50659][SQL] Move Union-related errors to QueryCompilationErrors","user":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nMove Union-related `NUM_COLUMNS_MISMATCH` and `INCOMPATIBLE_COLUMN_TYPE` errors to `QueryCompilationErrors`.\r\n\r\n### Why are the changes needed?\r\n\r\nTo improve the code health and to reuse those in the single-pass Analyzer.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2024-12-24T11:49:55Z","updated_at":"2024-12-25T03:13:48Z","closed_at":"2024-12-25T03:13:48Z","merged_at":null,"merge_commit_sha":"42890c1cda0e727ec6d60920d488a29f36cf2010","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49284/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49284/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49284/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/55a985bf9e05da4cd39de0947939524bd860dc71","head":{"label":"vladimirg-db:vladimirg-db/move-union-related-errors-to-query-compilation-errors","ref":"vladimirg-db/move-union-related-errors-to-query-compilation-errors","sha":"55a985bf9e05da4cd39de0947939524bd860dc71","user":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":833519707,"node_id":"R_kgDOMa6AWw","name":"spark","full_name":"vladimirg-db/spark","private":false,"owner":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vladimirg-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/vladimirg-db/spark","forks_url":"https://api.github.com/repos/vladimirg-db/spark/forks","keys_url":"https://api.github.com/repos/vladimirg-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vladimirg-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vladimirg-db/spark/teams","hooks_url":"https://api.github.com/repos/vladimirg-db/spark/hooks","issue_events_url":"https://api.github.com/repos/vladimirg-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vladimirg-db/spark/events","assignees_url":"https://api.github.com/repos/vladimirg-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vladimirg-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vladimirg-db/spark/tags","blobs_url":"https://api.github.com/repos/vladimirg-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vladimirg-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vladimirg-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vladimirg-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vladimirg-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vladimirg-db/spark/languages","stargazers_url":"https://api.github.com/repos/vladimirg-db/spark/stargazers","contributors_url":"https://api.github.com/repos/vladimirg-db/spark/contributors","subscribers_url":"https://api.github.com/repos/vladimirg-db/spark/subscribers","subscription_url":"https://api.github.com/repos/vladimirg-db/spark/subscription","commits_url":"https://api.github.com/repos/vladimirg-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vladimirg-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vladimirg-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vladimirg-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vladimirg-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vladimirg-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vladimirg-db/spark/merges","archive_url":"https://api.github.com/repos/vladimirg-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vladimirg-db/spark/downloads","issues_url":"https://api.github.com/repos/vladimirg-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vladimirg-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vladimirg-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vladimirg-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vladimirg-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/vladimirg-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vladimirg-db/spark/deployments","created_at":"2024-07-25T08:13:07Z","updated_at":"2025-02-09T11:09:18Z","pushed_at":"2025-02-09T15:06:47Z","git_url":"git://github.com/vladimirg-db/spark.git","ssh_url":"git@github.com:vladimirg-db/spark.git","clone_url":"https://github.com/vladimirg-db/spark.git","svn_url":"https://github.com/vladimirg-db/spark","homepage":"https://spark.apache.org/","size":424040,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2c1c4d2614ae1ff902c244209f7ec3c79102d3e0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49284"},"html":{"href":"https://github.com/apache/spark/pull/49284"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49284"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49284/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49284/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49284/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/55a985bf9e05da4cd39de0947939524bd860dc71"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49283","id":2250833067,"node_id":"PR_kwDOAQXtWs6GKPyr","html_url":"https://github.com/apache/spark/pull/49283","diff_url":"https://github.com/apache/spark/pull/49283.diff","patch_url":"https://github.com/apache/spark/pull/49283.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49283","number":49283,"state":"closed","locked":false,"title":"[SPARK-50659][SQL] Refactor Union output computation out to reuse it in the single-pass Analyzer","user":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nRefactor `computeOutput` out to the `Union` companion object.\r\n\r\n### Why are the changes needed?\r\n\r\nTo reuse this piece of code in the single-pass Analyzer.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2024-12-24T11:01:15Z","updated_at":"2024-12-25T06:37:10Z","closed_at":"2024-12-25T06:37:10Z","merged_at":null,"merge_commit_sha":"2a447b2c68fa0a1ce5a9bf2947a69284a0c3e73e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49283/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49283/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49283/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/895ae37d9b9009a1bd6afdde7302a6f56439a90f","head":{"label":"vladimirg-db:vladimirg-db/refactor-out-union-compute-output-to-use-in-single-pass-analyzer","ref":"vladimirg-db/refactor-out-union-compute-output-to-use-in-single-pass-analyzer","sha":"895ae37d9b9009a1bd6afdde7302a6f56439a90f","user":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":833519707,"node_id":"R_kgDOMa6AWw","name":"spark","full_name":"vladimirg-db/spark","private":false,"owner":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vladimirg-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/vladimirg-db/spark","forks_url":"https://api.github.com/repos/vladimirg-db/spark/forks","keys_url":"https://api.github.com/repos/vladimirg-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vladimirg-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vladimirg-db/spark/teams","hooks_url":"https://api.github.com/repos/vladimirg-db/spark/hooks","issue_events_url":"https://api.github.com/repos/vladimirg-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vladimirg-db/spark/events","assignees_url":"https://api.github.com/repos/vladimirg-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vladimirg-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vladimirg-db/spark/tags","blobs_url":"https://api.github.com/repos/vladimirg-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vladimirg-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vladimirg-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vladimirg-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vladimirg-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vladimirg-db/spark/languages","stargazers_url":"https://api.github.com/repos/vladimirg-db/spark/stargazers","contributors_url":"https://api.github.com/repos/vladimirg-db/spark/contributors","subscribers_url":"https://api.github.com/repos/vladimirg-db/spark/subscribers","subscription_url":"https://api.github.com/repos/vladimirg-db/spark/subscription","commits_url":"https://api.github.com/repos/vladimirg-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vladimirg-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vladimirg-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vladimirg-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vladimirg-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vladimirg-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vladimirg-db/spark/merges","archive_url":"https://api.github.com/repos/vladimirg-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vladimirg-db/spark/downloads","issues_url":"https://api.github.com/repos/vladimirg-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vladimirg-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vladimirg-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vladimirg-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vladimirg-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/vladimirg-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vladimirg-db/spark/deployments","created_at":"2024-07-25T08:13:07Z","updated_at":"2025-02-09T11:09:18Z","pushed_at":"2025-02-09T15:06:47Z","git_url":"git://github.com/vladimirg-db/spark.git","ssh_url":"git@github.com:vladimirg-db/spark.git","clone_url":"https://github.com/vladimirg-db/spark.git","svn_url":"https://github.com/vladimirg-db/spark","homepage":"https://spark.apache.org/","size":424040,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2c1c4d2614ae1ff902c244209f7ec3c79102d3e0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49283"},"html":{"href":"https://github.com/apache/spark/pull/49283"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49283"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49283/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49283/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49283/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/895ae37d9b9009a1bd6afdde7302a6f56439a90f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49282","id":2250732009,"node_id":"PR_kwDOAQXtWs6GJ3Hp","html_url":"https://github.com/apache/spark/pull/49282","diff_url":"https://github.com/apache/spark/pull/49282.diff","patch_url":"https://github.com/apache/spark/pull/49282.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49282","number":49282,"state":"closed","locked":false,"title":"[SPARK-50657][PYTHON] Upgrade the minimum version of `pyarrow` to 11.0.0","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nUpgrade the minimum version of `pyarrow` to 11.0.0\r\n\r\n\r\n### Why are the changes needed?\r\naccording to my test in https://github.com/apache/spark/pull/49267, pyspark with `pyarrow=10.0.0` has already been broken\r\n\r\n- pyspark-sql failed\r\n- pyspark-connect failed\r\n- pyspark-pandas failed\r\n\r\nsee https://github.com/zhengruifeng/spark/actions/runs/12464102622/job/34787749014\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\ndoc changes\r\n\r\n\r\n### How was this patch tested?\r\nci\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nno\r\n","created_at":"2024-12-24T09:33:36Z","updated_at":"2024-12-25T23:46:35Z","closed_at":"2024-12-25T20:11:51Z","merged_at":null,"merge_commit_sha":"771e050a5357ff1cf11c0523c6d517ecc3d2795a","assignee":null,"assignees":[],"requested_reviewers":[{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49282/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49282/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49282/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/fbb9f4fa44cd64e32243fde6069ede0b06a5cd3a","head":{"label":"zhengruifeng:mini_arrow_11","ref":"mini_arrow_11","sha":"fbb9f4fa44cd64e32243fde6069ede0b06a5cd3a","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2c1c4d2614ae1ff902c244209f7ec3c79102d3e0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49282"},"html":{"href":"https://github.com/apache/spark/pull/49282"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49282"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49282/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49282/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49282/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/fbb9f4fa44cd64e32243fde6069ede0b06a5cd3a"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49281","id":2250668042,"node_id":"PR_kwDOAQXtWs6GJngK","html_url":"https://github.com/apache/spark/pull/49281","diff_url":"https://github.com/apache/spark/pull/49281.diff","patch_url":"https://github.com/apache/spark/pull/49281.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49281","number":49281,"state":"closed","locked":false,"title":"[SPARK-50590][INFRA][FOLLOW-UP] Further skip unnecessary image build by the job modules","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nFurther skip unnecessary image build by the job modules\r\n\r\n\r\n### Why are the changes needed?\r\ne.g. in a case where `sparkr` is not enabled, do not need to build the corresponding image\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno, infra-only\r\n\r\n\r\n### How was this patch tested?\r\npr builder\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nno","created_at":"2024-12-24T08:37:04Z","updated_at":"2024-12-25T07:16:51Z","closed_at":"2024-12-25T07:16:36Z","merged_at":null,"merge_commit_sha":"a01f9c2dd2e1c282b7d800e2f32e4472e8c57b9b","assignee":null,"assignees":[],"requested_reviewers":[{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1982110661,"node_id":"MDU6TGFiZWwxOTgyMTEwNjYx","url":"https://api.github.com/repos/apache/spark/labels/INFRA","name":"INFRA","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49281/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49281/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49281/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ba86d8070d2f8310a4359c0b81ed8636dc25f934","head":{"label":"zhengruifeng:infra_further_skip","ref":"infra_further_skip","sha":"ba86d8070d2f8310a4359c0b81ed8636dc25f934","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2c1c4d2614ae1ff902c244209f7ec3c79102d3e0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49281"},"html":{"href":"https://github.com/apache/spark/pull/49281"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49281"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49281/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49281/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49281/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ba86d8070d2f8310a4359c0b81ed8636dc25f934"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49280","id":2250566521,"node_id":"PR_kwDOAQXtWs6GJOt5","html_url":"https://github.com/apache/spark/pull/49280","diff_url":"https://github.com/apache/spark/pull/49280.diff","patch_url":"https://github.com/apache/spark/pull/49280.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49280","number":49280,"state":"closed","locked":false,"title":"[MINOR][SQL][DOCS] Fix spacing with SQL configuration documentation","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR proposes to fix spacing with SQL configuration documentation.\r\n\r\n### Why are the changes needed?\r\n\r\nFor correct documentation.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nTrivial but yes. It affects spacing in user-facing documentation at https://spark.apache.org/docs/latest/configuration.html. \r\n\r\n### How was this patch tested?\r\n\r\nManually checked.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.\r\n","created_at":"2024-12-24T07:00:26Z","updated_at":"2024-12-25T04:03:48Z","closed_at":"2024-12-25T04:03:36Z","merged_at":null,"merge_commit_sha":"7171245bf6bb0d4b0e6ec436e2fd6c651c9c0318","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49280/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49280/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49280/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5278b6a64b260e0708b1a90713ef11b61d71a5f6","head":{"label":"HyukjinKwon:minor-spaces","ref":"minor-spaces","sha":"5278b6a64b260e0708b1a90713ef11b61d71a5f6","user":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":42300713,"node_id":"MDEwOlJlcG9zaXRvcnk0MjMwMDcxMw==","name":"spark","full_name":"HyukjinKwon/spark","private":false,"owner":{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/HyukjinKwon/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/HyukjinKwon/spark","forks_url":"https://api.github.com/repos/HyukjinKwon/spark/forks","keys_url":"https://api.github.com/repos/HyukjinKwon/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/HyukjinKwon/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/HyukjinKwon/spark/teams","hooks_url":"https://api.github.com/repos/HyukjinKwon/spark/hooks","issue_events_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/events{/number}","events_url":"https://api.github.com/repos/HyukjinKwon/spark/events","assignees_url":"https://api.github.com/repos/HyukjinKwon/spark/assignees{/user}","branches_url":"https://api.github.com/repos/HyukjinKwon/spark/branches{/branch}","tags_url":"https://api.github.com/repos/HyukjinKwon/spark/tags","blobs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/HyukjinKwon/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/HyukjinKwon/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/HyukjinKwon/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/HyukjinKwon/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/HyukjinKwon/spark/languages","stargazers_url":"https://api.github.com/repos/HyukjinKwon/spark/stargazers","contributors_url":"https://api.github.com/repos/HyukjinKwon/spark/contributors","subscribers_url":"https://api.github.com/repos/HyukjinKwon/spark/subscribers","subscription_url":"https://api.github.com/repos/HyukjinKwon/spark/subscription","commits_url":"https://api.github.com/repos/HyukjinKwon/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/HyukjinKwon/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/HyukjinKwon/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/HyukjinKwon/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/HyukjinKwon/spark/contents/{+path}","compare_url":"https://api.github.com/repos/HyukjinKwon/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/HyukjinKwon/spark/merges","archive_url":"https://api.github.com/repos/HyukjinKwon/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/HyukjinKwon/spark/downloads","issues_url":"https://api.github.com/repos/HyukjinKwon/spark/issues{/number}","pulls_url":"https://api.github.com/repos/HyukjinKwon/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/HyukjinKwon/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/HyukjinKwon/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/HyukjinKwon/spark/labels{/name}","releases_url":"https://api.github.com/repos/HyukjinKwon/spark/releases{/id}","deployments_url":"https://api.github.com/repos/HyukjinKwon/spark/deployments","created_at":"2015-09-11T09:47:43Z","updated_at":"2025-02-08T05:04:02Z","pushed_at":"2025-02-08T05:03:28Z","git_url":"git://github.com/HyukjinKwon/spark.git","ssh_url":"git@github.com:HyukjinKwon/spark.git","clone_url":"https://github.com/HyukjinKwon/spark.git","svn_url":"https://github.com/HyukjinKwon/spark","homepage":null,"size":441550,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2c1c4d2614ae1ff902c244209f7ec3c79102d3e0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49280"},"html":{"href":"https://github.com/apache/spark/pull/49280"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49280"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49280/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49280/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49280/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5278b6a64b260e0708b1a90713ef11b61d71a5f6"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49279","id":2250376846,"node_id":"PR_kwDOAQXtWs6GIgaO","html_url":"https://github.com/apache/spark/pull/49279","diff_url":"https://github.com/apache/spark/pull/49279.diff","patch_url":"https://github.com/apache/spark/pull/49279.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49279","number":49279,"state":"closed","locked":false,"title":"[MINOR][INFRA] Skip step `List Python packages` when `PYTHON_TO_TEST` is not specified","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nSkip step `List Python packages` when `PYTHON_TO_TEST` is not specified\r\n\r\n\r\n### Why are the changes needed?\r\nin 3.5 daily build, the `PYTHON_TO_TEST` is empty\r\n\r\nhttps://github.com/apache/spark/actions/runs/12465764579/job/34792186424\r\n\r\n![image](https://github.com/user-attachments/assets/d7da529c-8273-4065-9bef-a29a93ab53aa)\r\n\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno, infra-only\r\n\r\n\r\n### How was this patch tested?\r\nwill manually check\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nno\r\n","created_at":"2024-12-24T02:59:07Z","updated_at":"2024-12-24T04:22:31Z","closed_at":"2024-12-24T04:22:17Z","merged_at":null,"merge_commit_sha":"dc2dc68b09debcd58980550c205a644cf4fd2afb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1982110661,"node_id":"MDU6TGFiZWwxOTgyMTEwNjYx","url":"https://api.github.com/repos/apache/spark/labels/INFRA","name":"INFRA","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49279/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49279/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49279/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/02617ce1f38cbb99f5b79bb9777b1d5b03940796","head":{"label":"zhengruifeng:infra_skip_list","ref":"infra_skip_list","sha":"02617ce1f38cbb99f5b79bb9777b1d5b03940796","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"debae7173e87f55eb30d9ea50eb69fb571157cf3","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49279"},"html":{"href":"https://github.com/apache/spark/pull/49279"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49279"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49279/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49279/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49279/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/02617ce1f38cbb99f5b79bb9777b1d5b03940796"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49278","id":2250305899,"node_id":"PR_kwDOAQXtWs6GIPFr","html_url":"https://github.com/apache/spark/pull/49278","diff_url":"https://github.com/apache/spark/pull/49278.diff","patch_url":"https://github.com/apache/spark/pull/49278.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49278","number":49278,"state":"closed","locked":false,"title":"[SPARK-50654][SS] CommitMetadata should set stateUniqueIds to None in V1","user":{"login":"WweiL","id":10248890,"node_id":"MDQ6VXNlcjEwMjQ4ODkw","avatar_url":"https://avatars.githubusercontent.com/u/10248890?v=4","gravatar_id":"","url":"https://api.github.com/users/WweiL","html_url":"https://github.com/WweiL","followers_url":"https://api.github.com/users/WweiL/followers","following_url":"https://api.github.com/users/WweiL/following{/other_user}","gists_url":"https://api.github.com/users/WweiL/gists{/gist_id}","starred_url":"https://api.github.com/users/WweiL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WweiL/subscriptions","organizations_url":"https://api.github.com/users/WweiL/orgs","repos_url":"https://api.github.com/users/WweiL/repos","events_url":"https://api.github.com/users/WweiL/events{/privacy}","received_events_url":"https://api.github.com/users/WweiL/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nPer request from this comment, https://github.com/apache/spark/pull/48355/files#r1866546734, we will put `None` in the `stateUniqueIds` of `CommitMetadata` when in V1. So now the logic is as follows:\r\n\r\n1. In V1, `CommitMetadata.stateUniqueIds = None` for all stateful and stateless queries\r\n2. In V2, `CommitMetadata.stateUniqueIds = Some(Map.empty)` for stateless queries\r\n3. In V2, `CommitMetadata.stateUniqueIds = Some(<non-empty-map>)` for stateful queries\r\n\r\nAlso removed the legacy test as a side effect\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  5. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nFollow up\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nUnit tests\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nNo","created_at":"2024-12-24T01:09:16Z","updated_at":"2025-01-16T02:54:26Z","closed_at":"2025-01-16T02:54:26Z","merged_at":null,"merge_commit_sha":"3684235e8d6aed2c4f0222317f85663fbdb8a85b","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49278/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49278/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49278/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2903653f9f5c295b145655dda71a9e643568af60","head":{"label":"WweiL:microbatchExecution-commitlog-none","ref":"microbatchExecution-commitlog-none","sha":"2903653f9f5c295b145655dda71a9e643568af60","user":{"login":"WweiL","id":10248890,"node_id":"MDQ6VXNlcjEwMjQ4ODkw","avatar_url":"https://avatars.githubusercontent.com/u/10248890?v=4","gravatar_id":"","url":"https://api.github.com/users/WweiL","html_url":"https://github.com/WweiL","followers_url":"https://api.github.com/users/WweiL/followers","following_url":"https://api.github.com/users/WweiL/following{/other_user}","gists_url":"https://api.github.com/users/WweiL/gists{/gist_id}","starred_url":"https://api.github.com/users/WweiL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WweiL/subscriptions","organizations_url":"https://api.github.com/users/WweiL/orgs","repos_url":"https://api.github.com/users/WweiL/repos","events_url":"https://api.github.com/users/WweiL/events{/privacy}","received_events_url":"https://api.github.com/users/WweiL/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":538656848,"node_id":"R_kgDOIBtAUA","name":"oss-spark","full_name":"WweiL/oss-spark","private":false,"owner":{"login":"WweiL","id":10248890,"node_id":"MDQ6VXNlcjEwMjQ4ODkw","avatar_url":"https://avatars.githubusercontent.com/u/10248890?v=4","gravatar_id":"","url":"https://api.github.com/users/WweiL","html_url":"https://github.com/WweiL","followers_url":"https://api.github.com/users/WweiL/followers","following_url":"https://api.github.com/users/WweiL/following{/other_user}","gists_url":"https://api.github.com/users/WweiL/gists{/gist_id}","starred_url":"https://api.github.com/users/WweiL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WweiL/subscriptions","organizations_url":"https://api.github.com/users/WweiL/orgs","repos_url":"https://api.github.com/users/WweiL/repos","events_url":"https://api.github.com/users/WweiL/events{/privacy}","received_events_url":"https://api.github.com/users/WweiL/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/WweiL/oss-spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/WweiL/oss-spark","forks_url":"https://api.github.com/repos/WweiL/oss-spark/forks","keys_url":"https://api.github.com/repos/WweiL/oss-spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/WweiL/oss-spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/WweiL/oss-spark/teams","hooks_url":"https://api.github.com/repos/WweiL/oss-spark/hooks","issue_events_url":"https://api.github.com/repos/WweiL/oss-spark/issues/events{/number}","events_url":"https://api.github.com/repos/WweiL/oss-spark/events","assignees_url":"https://api.github.com/repos/WweiL/oss-spark/assignees{/user}","branches_url":"https://api.github.com/repos/WweiL/oss-spark/branches{/branch}","tags_url":"https://api.github.com/repos/WweiL/oss-spark/tags","blobs_url":"https://api.github.com/repos/WweiL/oss-spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/WweiL/oss-spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/WweiL/oss-spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/WweiL/oss-spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/WweiL/oss-spark/statuses/{sha}","languages_url":"https://api.github.com/repos/WweiL/oss-spark/languages","stargazers_url":"https://api.github.com/repos/WweiL/oss-spark/stargazers","contributors_url":"https://api.github.com/repos/WweiL/oss-spark/contributors","subscribers_url":"https://api.github.com/repos/WweiL/oss-spark/subscribers","subscription_url":"https://api.github.com/repos/WweiL/oss-spark/subscription","commits_url":"https://api.github.com/repos/WweiL/oss-spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/WweiL/oss-spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/WweiL/oss-spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/WweiL/oss-spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/WweiL/oss-spark/contents/{+path}","compare_url":"https://api.github.com/repos/WweiL/oss-spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/WweiL/oss-spark/merges","archive_url":"https://api.github.com/repos/WweiL/oss-spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/WweiL/oss-spark/downloads","issues_url":"https://api.github.com/repos/WweiL/oss-spark/issues{/number}","pulls_url":"https://api.github.com/repos/WweiL/oss-spark/pulls{/number}","milestones_url":"https://api.github.com/repos/WweiL/oss-spark/milestones{/number}","notifications_url":"https://api.github.com/repos/WweiL/oss-spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/WweiL/oss-spark/labels{/name}","releases_url":"https://api.github.com/repos/WweiL/oss-spark/releases{/id}","deployments_url":"https://api.github.com/repos/WweiL/oss-spark/deployments","created_at":"2022-09-19T19:05:16Z","updated_at":"2022-09-19T22:58:14Z","pushed_at":"2025-02-05T00:30:37Z","git_url":"git://github.com/WweiL/oss-spark.git","ssh_url":"git@github.com:WweiL/oss-spark.git","clone_url":"https://github.com/WweiL/oss-spark.git","svn_url":"https://github.com/WweiL/oss-spark","homepage":"https://spark.apache.org/","size":431552,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"3a84dfc776ae1f1ab2cde1f8d4076c9582b69069","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49278"},"html":{"href":"https://github.com/apache/spark/pull/49278"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49278"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49278/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49278/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49278/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2903653f9f5c295b145655dda71a9e643568af60"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49277","id":2250016152,"node_id":"PR_kwDOAQXtWs6GHIWY","html_url":"https://github.com/apache/spark/pull/49277","diff_url":"https://github.com/apache/spark/pull/49277.diff","patch_url":"https://github.com/apache/spark/pull/49277.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49277","number":49277,"state":"closed","locked":false,"title":"[SPARK-50714][SQL][SS] Enable schema evolution for TransformWithState when Avro encoding is used","user":{"login":"ericm-db","id":132308037,"node_id":"U_kgDOB-LcRQ","avatar_url":"https://avatars.githubusercontent.com/u/132308037?v=4","gravatar_id":"","url":"https://api.github.com/users/ericm-db","html_url":"https://github.com/ericm-db","followers_url":"https://api.github.com/users/ericm-db/followers","following_url":"https://api.github.com/users/ericm-db/following{/other_user}","gists_url":"https://api.github.com/users/ericm-db/gists{/gist_id}","starred_url":"https://api.github.com/users/ericm-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ericm-db/subscriptions","organizations_url":"https://api.github.com/users/ericm-db/orgs","repos_url":"https://api.github.com/users/ericm-db/repos","events_url":"https://api.github.com/users/ericm-db/events{/privacy}","received_events_url":"https://api.github.com/users/ericm-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis PR introduces stateful schema evolution for the TransformWithState operator when Avro is used.\r\nWe modified the StateStoreColumnFamilySchema and the StateSchemaV3 file to keep track of the key schema and value schema id in order to support versioning and lookups of schemas across query restarts.\r\nThe AvroStateEncoder now takes a StateSchemaProvider, which allows it to look up all of the active schemas in the StateStore for a given column family, allowing it to pass reader and writer schemas to the AvroEncoder class.\r\nWe have also added changes so that the StateDataSource can read from these rows with schema ID\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nSchema evolution is a critical feature for stateful stream processing applications that need to handle changing data schemas over time.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nYes - this change allows stateful schema evolution that was not previously possible for the TransformWithState operator.\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nUnit and Integration tests in RocksDBStateStoreSuite and TransformWithStateSuite\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\n","created_at":"2024-12-23T19:32:53Z","updated_at":"2025-01-17T01:02:57Z","closed_at":"2025-01-17T01:02:57Z","merged_at":null,"merge_commit_sha":"b63336a4aa9b55e8f18ec68757032283ef2cec97","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49277/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49277/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49277/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/88b11de4b37494df6fadd2b79869f2720bdc0c47","head":{"label":"ericm-db:ssm","ref":"ssm","sha":"88b11de4b37494df6fadd2b79869f2720bdc0c47","user":{"login":"ericm-db","id":132308037,"node_id":"U_kgDOB-LcRQ","avatar_url":"https://avatars.githubusercontent.com/u/132308037?v=4","gravatar_id":"","url":"https://api.github.com/users/ericm-db","html_url":"https://github.com/ericm-db","followers_url":"https://api.github.com/users/ericm-db/followers","following_url":"https://api.github.com/users/ericm-db/following{/other_user}","gists_url":"https://api.github.com/users/ericm-db/gists{/gist_id}","starred_url":"https://api.github.com/users/ericm-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ericm-db/subscriptions","organizations_url":"https://api.github.com/users/ericm-db/orgs","repos_url":"https://api.github.com/users/ericm-db/repos","events_url":"https://api.github.com/users/ericm-db/events{/privacy}","received_events_url":"https://api.github.com/users/ericm-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":642041202,"node_id":"R_kgDOJkTFcg","name":"spark","full_name":"ericm-db/spark","private":false,"owner":{"login":"ericm-db","id":132308037,"node_id":"U_kgDOB-LcRQ","avatar_url":"https://avatars.githubusercontent.com/u/132308037?v=4","gravatar_id":"","url":"https://api.github.com/users/ericm-db","html_url":"https://github.com/ericm-db","followers_url":"https://api.github.com/users/ericm-db/followers","following_url":"https://api.github.com/users/ericm-db/following{/other_user}","gists_url":"https://api.github.com/users/ericm-db/gists{/gist_id}","starred_url":"https://api.github.com/users/ericm-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ericm-db/subscriptions","organizations_url":"https://api.github.com/users/ericm-db/orgs","repos_url":"https://api.github.com/users/ericm-db/repos","events_url":"https://api.github.com/users/ericm-db/events{/privacy}","received_events_url":"https://api.github.com/users/ericm-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ericm-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/ericm-db/spark","forks_url":"https://api.github.com/repos/ericm-db/spark/forks","keys_url":"https://api.github.com/repos/ericm-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ericm-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ericm-db/spark/teams","hooks_url":"https://api.github.com/repos/ericm-db/spark/hooks","issue_events_url":"https://api.github.com/repos/ericm-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/ericm-db/spark/events","assignees_url":"https://api.github.com/repos/ericm-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/ericm-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/ericm-db/spark/tags","blobs_url":"https://api.github.com/repos/ericm-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ericm-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ericm-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/ericm-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ericm-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/ericm-db/spark/languages","stargazers_url":"https://api.github.com/repos/ericm-db/spark/stargazers","contributors_url":"https://api.github.com/repos/ericm-db/spark/contributors","subscribers_url":"https://api.github.com/repos/ericm-db/spark/subscribers","subscription_url":"https://api.github.com/repos/ericm-db/spark/subscription","commits_url":"https://api.github.com/repos/ericm-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/ericm-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/ericm-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/ericm-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/ericm-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/ericm-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ericm-db/spark/merges","archive_url":"https://api.github.com/repos/ericm-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ericm-db/spark/downloads","issues_url":"https://api.github.com/repos/ericm-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/ericm-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/ericm-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/ericm-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ericm-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/ericm-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/ericm-db/spark/deployments","created_at":"2023-05-17T17:32:51Z","updated_at":"2024-10-22T17:11:59Z","pushed_at":"2025-02-07T20:14:46Z","git_url":"git://github.com/ericm-db/spark.git","ssh_url":"git@github.com:ericm-db/spark.git","clone_url":"https://github.com/ericm-db/spark.git","svn_url":"https://github.com/ericm-db/spark","homepage":"https://spark.apache.org/","size":426711,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"dabf227959698884d32b60c99136a090e598a89c","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49277"},"html":{"href":"https://github.com/apache/spark/pull/49277"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49277"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49277/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49277/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49277/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/88b11de4b37494df6fadd2b79869f2720bdc0c47"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49276","id":2250015713,"node_id":"PR_kwDOAQXtWs6GHIPh","html_url":"https://github.com/apache/spark/pull/49276","diff_url":"https://github.com/apache/spark/pull/49276.diff","patch_url":"https://github.com/apache/spark/pull/49276.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49276","number":49276,"state":"open","locked":false,"title":"[SPARK-50639][SQL] Improve warning logging in CacheManager","user":{"login":"vrozov","id":12200381,"node_id":"MDQ6VXNlcjEyMjAwMzgx","avatar_url":"https://avatars.githubusercontent.com/u/12200381?v=4","gravatar_id":"","url":"https://api.github.com/users/vrozov","html_url":"https://github.com/vrozov","followers_url":"https://api.github.com/users/vrozov/followers","following_url":"https://api.github.com/users/vrozov/following{/other_user}","gists_url":"https://api.github.com/users/vrozov/gists{/gist_id}","starred_url":"https://api.github.com/users/vrozov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vrozov/subscriptions","organizations_url":"https://api.github.com/users/vrozov/orgs","repos_url":"https://api.github.com/users/vrozov/repos","events_url":"https://api.github.com/users/vrozov/events{/privacy}","received_events_url":"https://api.github.com/users/vrozov/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThe change improves warning logging in the CacheManager by:\r\n1. Adds logical plan info to the existing warning messages.\r\n2. Logs warning message in case an attempt is made to remove data from the cache, but data is not present.\r\n\r\n### Why are the changes needed?\r\n\r\nThe change helps to identify incorrect calls to `Dataset.persist()` and `Dataset.unpersist()` as in \r\n```\r\nDataset<Row> dataset = ...\r\nDataset<Row> dataset1 = dataset.withColumn(...);\r\nDataset<Row> dataset2 = dataset1.withColumn(...);\r\ndataset.persist(); // OK\r\ndataset1.persist(); // OK\r\ndataset.persist(); // currently logs warning without logical plan details\r\ndataset.unpersist(); // OK\r\ndataset.unpersist(); // no warning\r\ndataset2.unpersist(); // no warning, the actual call should be on dataset1\r\n```\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nUsers may see warning messages like:\r\n\r\n```\r\n23.12.2024 19:15:03.840 WARN  [pool-30-thread-1] org.apache.spark.sql.execution.CacheManager - An attempt was made to cache data even though the data had already been cached. Please un-cache data or clear cache first.\r\nLogical plan:\r\nRelation [i#0] JDBCRelation(test_table) [numPartitions=1]\r\n```\r\nand\r\n```\r\n23.12.2024 19:15:04.207 WARN  [pool-30-thread-1] org.apache.spark.sql.execution.CacheManager - Data has not been previously cached or it was removed from the cache already.\r\nLogical plan:\r\nProject [i#0, i#0 AS year#6]\r\n+- Relation [i#0] JDBCRelation(test_table) [numPartitions=1]\r\n```\r\n\r\n### How was this patch tested?\r\n\r\nThe change modifies warning log messages.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.\r\n","created_at":"2024-12-23T19:32:27Z","updated_at":"2025-02-06T13:19:57Z","closed_at":null,"merged_at":null,"merge_commit_sha":"89792f78303032bab50ccbce6406bcef7fc94af0","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49276/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49276/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49276/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c6d02c38b720e25ac7c6c53a75674b894f05684b","head":{"label":"vrozov:Warning","ref":"Warning","sha":"c6d02c38b720e25ac7c6c53a75674b894f05684b","user":{"login":"vrozov","id":12200381,"node_id":"MDQ6VXNlcjEyMjAwMzgx","avatar_url":"https://avatars.githubusercontent.com/u/12200381?v=4","gravatar_id":"","url":"https://api.github.com/users/vrozov","html_url":"https://github.com/vrozov","followers_url":"https://api.github.com/users/vrozov/followers","following_url":"https://api.github.com/users/vrozov/following{/other_user}","gists_url":"https://api.github.com/users/vrozov/gists{/gist_id}","starred_url":"https://api.github.com/users/vrozov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vrozov/subscriptions","organizations_url":"https://api.github.com/users/vrozov/orgs","repos_url":"https://api.github.com/users/vrozov/repos","events_url":"https://api.github.com/users/vrozov/events{/privacy}","received_events_url":"https://api.github.com/users/vrozov/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":899688964,"node_id":"R_kgDONaAqBA","name":"spark","full_name":"vrozov/spark","private":false,"owner":{"login":"vrozov","id":12200381,"node_id":"MDQ6VXNlcjEyMjAwMzgx","avatar_url":"https://avatars.githubusercontent.com/u/12200381?v=4","gravatar_id":"","url":"https://api.github.com/users/vrozov","html_url":"https://github.com/vrozov","followers_url":"https://api.github.com/users/vrozov/followers","following_url":"https://api.github.com/users/vrozov/following{/other_user}","gists_url":"https://api.github.com/users/vrozov/gists{/gist_id}","starred_url":"https://api.github.com/users/vrozov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vrozov/subscriptions","organizations_url":"https://api.github.com/users/vrozov/orgs","repos_url":"https://api.github.com/users/vrozov/repos","events_url":"https://api.github.com/users/vrozov/events{/privacy}","received_events_url":"https://api.github.com/users/vrozov/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vrozov/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/vrozov/spark","forks_url":"https://api.github.com/repos/vrozov/spark/forks","keys_url":"https://api.github.com/repos/vrozov/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vrozov/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vrozov/spark/teams","hooks_url":"https://api.github.com/repos/vrozov/spark/hooks","issue_events_url":"https://api.github.com/repos/vrozov/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vrozov/spark/events","assignees_url":"https://api.github.com/repos/vrozov/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vrozov/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vrozov/spark/tags","blobs_url":"https://api.github.com/repos/vrozov/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vrozov/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vrozov/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vrozov/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vrozov/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vrozov/spark/languages","stargazers_url":"https://api.github.com/repos/vrozov/spark/stargazers","contributors_url":"https://api.github.com/repos/vrozov/spark/contributors","subscribers_url":"https://api.github.com/repos/vrozov/spark/subscribers","subscription_url":"https://api.github.com/repos/vrozov/spark/subscription","commits_url":"https://api.github.com/repos/vrozov/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vrozov/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vrozov/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vrozov/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vrozov/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vrozov/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vrozov/spark/merges","archive_url":"https://api.github.com/repos/vrozov/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vrozov/spark/downloads","issues_url":"https://api.github.com/repos/vrozov/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vrozov/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vrozov/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vrozov/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vrozov/spark/labels{/name}","releases_url":"https://api.github.com/repos/vrozov/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vrozov/spark/deployments","created_at":"2024-12-06T19:50:01Z","updated_at":"2025-02-07T17:52:14Z","pushed_at":"2025-02-07T17:52:07Z","git_url":"git://github.com/vrozov/spark.git","ssh_url":"git@github.com:vrozov/spark.git","clone_url":"https://github.com/vrozov/spark.git","svn_url":"https://github.com/vrozov/spark","homepage":"https://spark.apache.org/","size":487507,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"80cdc1562b66384ca1d295a00dc5c01545e5faf8","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49276"},"html":{"href":"https://github.com/apache/spark/pull/49276"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49276"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49276/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49276/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49276/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c6d02c38b720e25ac7c6c53a75674b894f05684b"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49275","id":2249898142,"node_id":"PR_kwDOAQXtWs6GGrie","html_url":"https://github.com/apache/spark/pull/49275","diff_url":"https://github.com/apache/spark/pull/49275.diff","patch_url":"https://github.com/apache/spark/pull/49275.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49275","number":49275,"state":"closed","locked":false,"title":"[SPARK-50652][SS] Add checks to RocksDB V2 backward compatibility","user":{"login":"WweiL","id":10248890,"node_id":"MDQ6VXNlcjEwMjQ4ODkw","avatar_url":"https://avatars.githubusercontent.com/u/10248890?v=4","gravatar_id":"","url":"https://api.github.com/users/WweiL","html_url":"https://github.com/WweiL","followers_url":"https://api.github.com/users/WweiL/followers","following_url":"https://api.github.com/users/WweiL/following{/other_user}","gists_url":"https://api.github.com/users/WweiL/gists{/gist_id}","starred_url":"https://api.github.com/users/WweiL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WweiL/subscriptions","organizations_url":"https://api.github.com/users/WweiL/orgs","repos_url":"https://api.github.com/users/WweiL/repos","events_url":"https://api.github.com/users/WweiL/events{/privacy}","received_events_url":"https://api.github.com/users/WweiL/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nCurrently in rocksDB level, v2 -> v1 backward compatibility is not supported. This PR adds a exact version check in commit log level for this purpose. \r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nFor compatibility check\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nModify test cases and filed followups \r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nNo","created_at":"2024-12-23T17:43:06Z","updated_at":"2025-01-17T21:44:28Z","closed_at":"2025-01-17T21:44:28Z","merged_at":null,"merge_commit_sha":"01bc5f3c5f2ee72c8b0e2157071b41567f34a70a","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49275/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49275/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49275/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8da1108d63f08c04b6b8c51ad25e6da6bd21e0d5","head":{"label":"WweiL:commit-log-version-followup","ref":"commit-log-version-followup","sha":"8da1108d63f08c04b6b8c51ad25e6da6bd21e0d5","user":{"login":"WweiL","id":10248890,"node_id":"MDQ6VXNlcjEwMjQ4ODkw","avatar_url":"https://avatars.githubusercontent.com/u/10248890?v=4","gravatar_id":"","url":"https://api.github.com/users/WweiL","html_url":"https://github.com/WweiL","followers_url":"https://api.github.com/users/WweiL/followers","following_url":"https://api.github.com/users/WweiL/following{/other_user}","gists_url":"https://api.github.com/users/WweiL/gists{/gist_id}","starred_url":"https://api.github.com/users/WweiL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WweiL/subscriptions","organizations_url":"https://api.github.com/users/WweiL/orgs","repos_url":"https://api.github.com/users/WweiL/repos","events_url":"https://api.github.com/users/WweiL/events{/privacy}","received_events_url":"https://api.github.com/users/WweiL/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":538656848,"node_id":"R_kgDOIBtAUA","name":"oss-spark","full_name":"WweiL/oss-spark","private":false,"owner":{"login":"WweiL","id":10248890,"node_id":"MDQ6VXNlcjEwMjQ4ODkw","avatar_url":"https://avatars.githubusercontent.com/u/10248890?v=4","gravatar_id":"","url":"https://api.github.com/users/WweiL","html_url":"https://github.com/WweiL","followers_url":"https://api.github.com/users/WweiL/followers","following_url":"https://api.github.com/users/WweiL/following{/other_user}","gists_url":"https://api.github.com/users/WweiL/gists{/gist_id}","starred_url":"https://api.github.com/users/WweiL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WweiL/subscriptions","organizations_url":"https://api.github.com/users/WweiL/orgs","repos_url":"https://api.github.com/users/WweiL/repos","events_url":"https://api.github.com/users/WweiL/events{/privacy}","received_events_url":"https://api.github.com/users/WweiL/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/WweiL/oss-spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/WweiL/oss-spark","forks_url":"https://api.github.com/repos/WweiL/oss-spark/forks","keys_url":"https://api.github.com/repos/WweiL/oss-spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/WweiL/oss-spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/WweiL/oss-spark/teams","hooks_url":"https://api.github.com/repos/WweiL/oss-spark/hooks","issue_events_url":"https://api.github.com/repos/WweiL/oss-spark/issues/events{/number}","events_url":"https://api.github.com/repos/WweiL/oss-spark/events","assignees_url":"https://api.github.com/repos/WweiL/oss-spark/assignees{/user}","branches_url":"https://api.github.com/repos/WweiL/oss-spark/branches{/branch}","tags_url":"https://api.github.com/repos/WweiL/oss-spark/tags","blobs_url":"https://api.github.com/repos/WweiL/oss-spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/WweiL/oss-spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/WweiL/oss-spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/WweiL/oss-spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/WweiL/oss-spark/statuses/{sha}","languages_url":"https://api.github.com/repos/WweiL/oss-spark/languages","stargazers_url":"https://api.github.com/repos/WweiL/oss-spark/stargazers","contributors_url":"https://api.github.com/repos/WweiL/oss-spark/contributors","subscribers_url":"https://api.github.com/repos/WweiL/oss-spark/subscribers","subscription_url":"https://api.github.com/repos/WweiL/oss-spark/subscription","commits_url":"https://api.github.com/repos/WweiL/oss-spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/WweiL/oss-spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/WweiL/oss-spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/WweiL/oss-spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/WweiL/oss-spark/contents/{+path}","compare_url":"https://api.github.com/repos/WweiL/oss-spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/WweiL/oss-spark/merges","archive_url":"https://api.github.com/repos/WweiL/oss-spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/WweiL/oss-spark/downloads","issues_url":"https://api.github.com/repos/WweiL/oss-spark/issues{/number}","pulls_url":"https://api.github.com/repos/WweiL/oss-spark/pulls{/number}","milestones_url":"https://api.github.com/repos/WweiL/oss-spark/milestones{/number}","notifications_url":"https://api.github.com/repos/WweiL/oss-spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/WweiL/oss-spark/labels{/name}","releases_url":"https://api.github.com/repos/WweiL/oss-spark/releases{/id}","deployments_url":"https://api.github.com/repos/WweiL/oss-spark/deployments","created_at":"2022-09-19T19:05:16Z","updated_at":"2022-09-19T22:58:14Z","pushed_at":"2025-02-05T00:30:37Z","git_url":"git://github.com/WweiL/oss-spark.git","ssh_url":"git@github.com:WweiL/oss-spark.git","clone_url":"https://github.com/WweiL/oss-spark.git","svn_url":"https://github.com/WweiL/oss-spark","homepage":"https://spark.apache.org/","size":431552,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"11d758f481419fc4490de04103d14a7ad8758e47","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49275"},"html":{"href":"https://github.com/apache/spark/pull/49275"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49275"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49275/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49275/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49275/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8da1108d63f08c04b6b8c51ad25e6da6bd21e0d5"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49274","id":2249798552,"node_id":"PR_kwDOAQXtWs6GGTOY","html_url":"https://github.com/apache/spark/pull/49274","diff_url":"https://github.com/apache/spark/pull/49274.diff","patch_url":"https://github.com/apache/spark/pull/49274.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49274","number":49274,"state":"closed","locked":false,"title":"[SPARK-49087][SQL][CONNECT] Distinguish UnresolvedFunction calling internal functions","user":{"login":"xupefei","id":1687847,"node_id":"MDQ6VXNlcjE2ODc4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1687847?v=4","gravatar_id":"","url":"https://api.github.com/users/xupefei","html_url":"https://github.com/xupefei","followers_url":"https://api.github.com/users/xupefei/followers","following_url":"https://api.github.com/users/xupefei/following{/other_user}","gists_url":"https://api.github.com/users/xupefei/gists{/gist_id}","starred_url":"https://api.github.com/users/xupefei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xupefei/subscriptions","organizations_url":"https://api.github.com/users/xupefei/orgs","repos_url":"https://api.github.com/users/xupefei/repos","events_url":"https://api.github.com/users/xupefei/events{/privacy}","received_events_url":"https://api.github.com/users/xupefei/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nThis PR introduces a new Protobuf field `is_internal` to `UnresolvedFunction` message. This field is used to carry the info on whether an `UnresolvedFunction` is calling an internal function (using the `Column#internalFn` API), so that the Connect server could act appropriately:\r\n\r\n- If `true`, then (inside Catalyst) mark the function as internal.\r\n- If `false`, then mark the function as external (public or user-defined).\r\n- (Current behaviour) If not set, then look it up in the internal registry: mark as \"internal\" if found, \"external\" otherwise.\r\n\r\nTODO: [SPARK-50658](https://issues.apache.org/jira/browse/SPARK-50658): apply the same change to the Spark Connect Python client.\r\n\r\n### Why are the changes needed?\r\n\r\nTidy up the code and make our first-party Connect client adhere to the best practices.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNope.\r\n\r\n### How was this patch tested?\r\n\r\nNew test is added.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nCopilot helped generate protobuf comments and repeated test codes.","created_at":"2024-12-23T16:25:15Z","updated_at":"2025-01-03T08:15:36Z","closed_at":"2025-01-03T08:15:36Z","merged_at":null,"merge_commit_sha":"4a774d23bef5a8e38754d29e6c8832d4ee526f66","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49274/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49274/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49274/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/9a810aab816358567d8ce0ac9691cd6acc4fc47e","head":{"label":"xupefei:internal-fn","ref":"internal-fn","sha":"9a810aab816358567d8ce0ac9691cd6acc4fc47e","user":{"login":"xupefei","id":1687847,"node_id":"MDQ6VXNlcjE2ODc4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1687847?v=4","gravatar_id":"","url":"https://api.github.com/users/xupefei","html_url":"https://github.com/xupefei","followers_url":"https://api.github.com/users/xupefei/followers","following_url":"https://api.github.com/users/xupefei/following{/other_user}","gists_url":"https://api.github.com/users/xupefei/gists{/gist_id}","starred_url":"https://api.github.com/users/xupefei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xupefei/subscriptions","organizations_url":"https://api.github.com/users/xupefei/orgs","repos_url":"https://api.github.com/users/xupefei/repos","events_url":"https://api.github.com/users/xupefei/events{/privacy}","received_events_url":"https://api.github.com/users/xupefei/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":777257207,"node_id":"R_kgDOLlQA9w","name":"spark","full_name":"xupefei/spark","private":false,"owner":{"login":"xupefei","id":1687847,"node_id":"MDQ6VXNlcjE2ODc4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1687847?v=4","gravatar_id":"","url":"https://api.github.com/users/xupefei","html_url":"https://github.com/xupefei","followers_url":"https://api.github.com/users/xupefei/followers","following_url":"https://api.github.com/users/xupefei/following{/other_user}","gists_url":"https://api.github.com/users/xupefei/gists{/gist_id}","starred_url":"https://api.github.com/users/xupefei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xupefei/subscriptions","organizations_url":"https://api.github.com/users/xupefei/orgs","repos_url":"https://api.github.com/users/xupefei/repos","events_url":"https://api.github.com/users/xupefei/events{/privacy}","received_events_url":"https://api.github.com/users/xupefei/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xupefei/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xupefei/spark","forks_url":"https://api.github.com/repos/xupefei/spark/forks","keys_url":"https://api.github.com/repos/xupefei/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xupefei/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xupefei/spark/teams","hooks_url":"https://api.github.com/repos/xupefei/spark/hooks","issue_events_url":"https://api.github.com/repos/xupefei/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xupefei/spark/events","assignees_url":"https://api.github.com/repos/xupefei/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xupefei/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xupefei/spark/tags","blobs_url":"https://api.github.com/repos/xupefei/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xupefei/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xupefei/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xupefei/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xupefei/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xupefei/spark/languages","stargazers_url":"https://api.github.com/repos/xupefei/spark/stargazers","contributors_url":"https://api.github.com/repos/xupefei/spark/contributors","subscribers_url":"https://api.github.com/repos/xupefei/spark/subscribers","subscription_url":"https://api.github.com/repos/xupefei/spark/subscription","commits_url":"https://api.github.com/repos/xupefei/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xupefei/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xupefei/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xupefei/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xupefei/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xupefei/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xupefei/spark/merges","archive_url":"https://api.github.com/repos/xupefei/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xupefei/spark/downloads","issues_url":"https://api.github.com/repos/xupefei/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xupefei/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xupefei/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xupefei/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xupefei/spark/labels{/name}","releases_url":"https://api.github.com/repos/xupefei/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xupefei/spark/deployments","created_at":"2024-03-25T14:06:50Z","updated_at":"2024-11-22T14:19:33Z","pushed_at":"2025-02-06T21:18:51Z","git_url":"git://github.com/xupefei/spark.git","ssh_url":"git@github.com:xupefei/spark.git","clone_url":"https://github.com/xupefei/spark.git","svn_url":"https://github.com/xupefei/spark","homepage":"https://spark.apache.org/","size":420345,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"c374c00432bd28b98b7623481b7985aa7bc7624a","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49274"},"html":{"href":"https://github.com/apache/spark/pull/49274"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49274"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49274/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49274/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49274/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/9a810aab816358567d8ce0ac9691cd6acc4fc47e"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49273","id":2249762687,"node_id":"PR_kwDOAQXtWs6GGKd_","html_url":"https://github.com/apache/spark/pull/49273","diff_url":"https://github.com/apache/spark/pull/49273.diff","patch_url":"https://github.com/apache/spark/pull/49273.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49273","number":49273,"state":"closed","locked":false,"title":"[SPARK-50651][SQL][DOCS] Add note about octal representation for characters","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThis PR modifies `docs/sql-ref-literals.md` to mention about octal representation for characters.\r\nCurrently there is no mention of it anywhere.\r\n\r\nThis change includes a trivial typo too which is in the same file.\r\n\r\n### Why are the changes needed?\r\nIt's a public feature.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nBuilt the doc, then confirmed the result.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.\r\n","created_at":"2024-12-23T16:00:22Z","updated_at":"2024-12-24T02:19:25Z","closed_at":"2024-12-24T02:11:53Z","merged_at":null,"merge_commit_sha":"854e49df550a2233c4f428610c96b0d86db5fdd7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981471081,"node_id":"MDU6TGFiZWwxOTgxNDcxMDgx","url":"https://api.github.com/repos/apache/spark/labels/DOCS","name":"DOCS","color":"79CE54","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49273/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49273/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49273/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/e6a87012d1b86e4974846d3d580113a57c8837e8","head":{"label":"sarutak:octal-representation","ref":"octal-representation","sha":"e6a87012d1b86e4974846d3d580113a57c8837e8","user":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":19300892,"node_id":"MDEwOlJlcG9zaXRvcnkxOTMwMDg5Mg==","name":"spark","full_name":"sarutak/spark","private":false,"owner":{"login":"sarutak","id":4736016,"node_id":"MDQ6VXNlcjQ3MzYwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/4736016?v=4","gravatar_id":"","url":"https://api.github.com/users/sarutak","html_url":"https://github.com/sarutak","followers_url":"https://api.github.com/users/sarutak/followers","following_url":"https://api.github.com/users/sarutak/following{/other_user}","gists_url":"https://api.github.com/users/sarutak/gists{/gist_id}","starred_url":"https://api.github.com/users/sarutak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarutak/subscriptions","organizations_url":"https://api.github.com/users/sarutak/orgs","repos_url":"https://api.github.com/users/sarutak/repos","events_url":"https://api.github.com/users/sarutak/events{/privacy}","received_events_url":"https://api.github.com/users/sarutak/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sarutak/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/sarutak/spark","forks_url":"https://api.github.com/repos/sarutak/spark/forks","keys_url":"https://api.github.com/repos/sarutak/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sarutak/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sarutak/spark/teams","hooks_url":"https://api.github.com/repos/sarutak/spark/hooks","issue_events_url":"https://api.github.com/repos/sarutak/spark/issues/events{/number}","events_url":"https://api.github.com/repos/sarutak/spark/events","assignees_url":"https://api.github.com/repos/sarutak/spark/assignees{/user}","branches_url":"https://api.github.com/repos/sarutak/spark/branches{/branch}","tags_url":"https://api.github.com/repos/sarutak/spark/tags","blobs_url":"https://api.github.com/repos/sarutak/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sarutak/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sarutak/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/sarutak/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sarutak/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/sarutak/spark/languages","stargazers_url":"https://api.github.com/repos/sarutak/spark/stargazers","contributors_url":"https://api.github.com/repos/sarutak/spark/contributors","subscribers_url":"https://api.github.com/repos/sarutak/spark/subscribers","subscription_url":"https://api.github.com/repos/sarutak/spark/subscription","commits_url":"https://api.github.com/repos/sarutak/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/sarutak/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/sarutak/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/sarutak/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/sarutak/spark/contents/{+path}","compare_url":"https://api.github.com/repos/sarutak/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sarutak/spark/merges","archive_url":"https://api.github.com/repos/sarutak/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sarutak/spark/downloads","issues_url":"https://api.github.com/repos/sarutak/spark/issues{/number}","pulls_url":"https://api.github.com/repos/sarutak/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/sarutak/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/sarutak/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sarutak/spark/labels{/name}","releases_url":"https://api.github.com/repos/sarutak/spark/releases{/id}","deployments_url":"https://api.github.com/repos/sarutak/spark/deployments","created_at":"2014-04-30T04:35:03Z","updated_at":"2021-11-06T06:43:35Z","pushed_at":"2025-01-23T16:33:44Z","git_url":"git://github.com/sarutak/spark.git","ssh_url":"git@github.com:sarutak/spark.git","clone_url":"https://github.com/sarutak/spark.git","svn_url":"https://github.com/sarutak/spark","homepage":null,"size":467531,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7cd5c4a1d1eb56fa92c10696bdbd8450d357b128","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49273"},"html":{"href":"https://github.com/apache/spark/pull/49273"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49273"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49273/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49273/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49273/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/e6a87012d1b86e4974846d3d580113a57c8837e8"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49272","id":2249684562,"node_id":"PR_kwDOAQXtWs6GF3ZS","html_url":"https://github.com/apache/spark/pull/49272","diff_url":"https://github.com/apache/spark/pull/49272.diff","patch_url":"https://github.com/apache/spark/pull/49272.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49272","number":49272,"state":"closed","locked":false,"title":"[SPARK-50360][SS][FOLLOWUP][TESTS] Changelog reader test improvements","user":{"login":"WweiL","id":10248890,"node_id":"MDQ6VXNlcjEwMjQ4ODkw","avatar_url":"https://avatars.githubusercontent.com/u/10248890?v=4","gravatar_id":"","url":"https://api.github.com/users/WweiL","html_url":"https://github.com/WweiL","followers_url":"https://api.github.com/users/WweiL/followers","following_url":"https://api.github.com/users/WweiL/following{/other_user}","gists_url":"https://api.github.com/users/WweiL/gists{/gist_id}","starred_url":"https://api.github.com/users/WweiL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WweiL/subscriptions","organizations_url":"https://api.github.com/users/WweiL/orgs","repos_url":"https://api.github.com/users/WweiL/repos","events_url":"https://api.github.com/users/WweiL/events{/privacy}","received_events_url":"https://api.github.com/users/WweiL/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nIn some test cases added by https://github.com/apache/spark/pull/48880, `changelogReader.closeIfNeeded()` is called before `assert(entries.size == expectedEntries.size)`, while `entries` are defined as `entries = changelogReader.toSeq`, which triggers the read. \r\n\r\nSo the logic is\r\n```\r\nentries = changelogReader.toSeq\r\nchangelogReader.closeIfNeeded()\r\nassert(entries.size == expectedEntries.size)\r\n```\r\n\r\nThis is fine in most cases, but we find out that in certain environments, the `toSeq` is lazily evaluated; therefore, not until the `assert`, the actual read won't be triggered. To be extra safe, change the order of the above logic to be the following:\r\n\r\n```\r\nentries = changelogReader.toSeq\r\nassert(entries.size == expectedEntries.size)\r\nchangelogReader.closeIfNeeded()\r\n```\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nTest case improvement\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nNo\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nTest only change\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nNo","created_at":"2024-12-23T15:07:25Z","updated_at":"2024-12-25T08:59:39Z","closed_at":"2024-12-25T08:59:39Z","merged_at":null,"merge_commit_sha":"bbad037e555651faf269faba013a6e49a074f5a7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49272/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49272/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49272/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/8d8a7ea3504bfa91d57a165540cd3e2320186ae6","head":{"label":"WweiL:rocksdb-closeifneeded","ref":"rocksdb-closeifneeded","sha":"8d8a7ea3504bfa91d57a165540cd3e2320186ae6","user":{"login":"WweiL","id":10248890,"node_id":"MDQ6VXNlcjEwMjQ4ODkw","avatar_url":"https://avatars.githubusercontent.com/u/10248890?v=4","gravatar_id":"","url":"https://api.github.com/users/WweiL","html_url":"https://github.com/WweiL","followers_url":"https://api.github.com/users/WweiL/followers","following_url":"https://api.github.com/users/WweiL/following{/other_user}","gists_url":"https://api.github.com/users/WweiL/gists{/gist_id}","starred_url":"https://api.github.com/users/WweiL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WweiL/subscriptions","organizations_url":"https://api.github.com/users/WweiL/orgs","repos_url":"https://api.github.com/users/WweiL/repos","events_url":"https://api.github.com/users/WweiL/events{/privacy}","received_events_url":"https://api.github.com/users/WweiL/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":538656848,"node_id":"R_kgDOIBtAUA","name":"oss-spark","full_name":"WweiL/oss-spark","private":false,"owner":{"login":"WweiL","id":10248890,"node_id":"MDQ6VXNlcjEwMjQ4ODkw","avatar_url":"https://avatars.githubusercontent.com/u/10248890?v=4","gravatar_id":"","url":"https://api.github.com/users/WweiL","html_url":"https://github.com/WweiL","followers_url":"https://api.github.com/users/WweiL/followers","following_url":"https://api.github.com/users/WweiL/following{/other_user}","gists_url":"https://api.github.com/users/WweiL/gists{/gist_id}","starred_url":"https://api.github.com/users/WweiL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WweiL/subscriptions","organizations_url":"https://api.github.com/users/WweiL/orgs","repos_url":"https://api.github.com/users/WweiL/repos","events_url":"https://api.github.com/users/WweiL/events{/privacy}","received_events_url":"https://api.github.com/users/WweiL/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/WweiL/oss-spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/WweiL/oss-spark","forks_url":"https://api.github.com/repos/WweiL/oss-spark/forks","keys_url":"https://api.github.com/repos/WweiL/oss-spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/WweiL/oss-spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/WweiL/oss-spark/teams","hooks_url":"https://api.github.com/repos/WweiL/oss-spark/hooks","issue_events_url":"https://api.github.com/repos/WweiL/oss-spark/issues/events{/number}","events_url":"https://api.github.com/repos/WweiL/oss-spark/events","assignees_url":"https://api.github.com/repos/WweiL/oss-spark/assignees{/user}","branches_url":"https://api.github.com/repos/WweiL/oss-spark/branches{/branch}","tags_url":"https://api.github.com/repos/WweiL/oss-spark/tags","blobs_url":"https://api.github.com/repos/WweiL/oss-spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/WweiL/oss-spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/WweiL/oss-spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/WweiL/oss-spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/WweiL/oss-spark/statuses/{sha}","languages_url":"https://api.github.com/repos/WweiL/oss-spark/languages","stargazers_url":"https://api.github.com/repos/WweiL/oss-spark/stargazers","contributors_url":"https://api.github.com/repos/WweiL/oss-spark/contributors","subscribers_url":"https://api.github.com/repos/WweiL/oss-spark/subscribers","subscription_url":"https://api.github.com/repos/WweiL/oss-spark/subscription","commits_url":"https://api.github.com/repos/WweiL/oss-spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/WweiL/oss-spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/WweiL/oss-spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/WweiL/oss-spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/WweiL/oss-spark/contents/{+path}","compare_url":"https://api.github.com/repos/WweiL/oss-spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/WweiL/oss-spark/merges","archive_url":"https://api.github.com/repos/WweiL/oss-spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/WweiL/oss-spark/downloads","issues_url":"https://api.github.com/repos/WweiL/oss-spark/issues{/number}","pulls_url":"https://api.github.com/repos/WweiL/oss-spark/pulls{/number}","milestones_url":"https://api.github.com/repos/WweiL/oss-spark/milestones{/number}","notifications_url":"https://api.github.com/repos/WweiL/oss-spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/WweiL/oss-spark/labels{/name}","releases_url":"https://api.github.com/repos/WweiL/oss-spark/releases{/id}","deployments_url":"https://api.github.com/repos/WweiL/oss-spark/deployments","created_at":"2022-09-19T19:05:16Z","updated_at":"2022-09-19T22:58:14Z","pushed_at":"2025-02-05T00:30:37Z","git_url":"git://github.com/WweiL/oss-spark.git","ssh_url":"git@github.com:WweiL/oss-spark.git","clone_url":"https://github.com/WweiL/oss-spark.git","svn_url":"https://github.com/WweiL/oss-spark","homepage":"https://spark.apache.org/","size":431552,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7cd5c4a1d1eb56fa92c10696bdbd8450d357b128","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49272"},"html":{"href":"https://github.com/apache/spark/pull/49272"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49272"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49272/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49272/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49272/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/8d8a7ea3504bfa91d57a165540cd3e2320186ae6"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49271","id":2249547950,"node_id":"PR_kwDOAQXtWs6GFWCu","html_url":"https://github.com/apache/spark/pull/49271","diff_url":"https://github.com/apache/spark/pull/49271.diff","patch_url":"https://github.com/apache/spark/pull/49271.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49271","number":49271,"state":"closed","locked":false,"title":"[SPARK-50650][SQL] Improve logging in single-pass Analyzer","user":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\n1. Log initial unresolved plans. This was we see the full plan, and track the downwards traversal.\r\n2. Log expression tree changes in the same manner as operator tree changes.\r\n\r\n### Why are the changes needed?\r\n\r\nTo make single-pass Analyzer debugging easier.\r\n\r\nExamples:\r\n![image](https://github.com/user-attachments/assets/507c3daf-0fe2-48a9-a66c-73e038550511)\r\n\r\n![image](https://github.com/user-attachments/assets/8d8c9fbc-7371-4d29-a8c5-71aba57a65e5)\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2024-12-23T13:38:21Z","updated_at":"2024-12-26T02:50:44Z","closed_at":"2024-12-26T02:50:44Z","merged_at":null,"merge_commit_sha":"fab675f664d1b2630361d5dab82062763f23ccef","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49271/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49271/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49271/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/a70fb641c5f67ac27b8703fbbb0f1f525d74c0fa","head":{"label":"vladimirg-db:vladimirg-db/single-pass-analyzer/improve-plan-logger","ref":"vladimirg-db/single-pass-analyzer/improve-plan-logger","sha":"a70fb641c5f67ac27b8703fbbb0f1f525d74c0fa","user":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":833519707,"node_id":"R_kgDOMa6AWw","name":"spark","full_name":"vladimirg-db/spark","private":false,"owner":{"login":"vladimirg-db","id":166514719,"node_id":"U_kgDOCezQHw","avatar_url":"https://avatars.githubusercontent.com/u/166514719?v=4","gravatar_id":"","url":"https://api.github.com/users/vladimirg-db","html_url":"https://github.com/vladimirg-db","followers_url":"https://api.github.com/users/vladimirg-db/followers","following_url":"https://api.github.com/users/vladimirg-db/following{/other_user}","gists_url":"https://api.github.com/users/vladimirg-db/gists{/gist_id}","starred_url":"https://api.github.com/users/vladimirg-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vladimirg-db/subscriptions","organizations_url":"https://api.github.com/users/vladimirg-db/orgs","repos_url":"https://api.github.com/users/vladimirg-db/repos","events_url":"https://api.github.com/users/vladimirg-db/events{/privacy}","received_events_url":"https://api.github.com/users/vladimirg-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/vladimirg-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/vladimirg-db/spark","forks_url":"https://api.github.com/repos/vladimirg-db/spark/forks","keys_url":"https://api.github.com/repos/vladimirg-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vladimirg-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vladimirg-db/spark/teams","hooks_url":"https://api.github.com/repos/vladimirg-db/spark/hooks","issue_events_url":"https://api.github.com/repos/vladimirg-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/vladimirg-db/spark/events","assignees_url":"https://api.github.com/repos/vladimirg-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/vladimirg-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/vladimirg-db/spark/tags","blobs_url":"https://api.github.com/repos/vladimirg-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vladimirg-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vladimirg-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/vladimirg-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vladimirg-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/vladimirg-db/spark/languages","stargazers_url":"https://api.github.com/repos/vladimirg-db/spark/stargazers","contributors_url":"https://api.github.com/repos/vladimirg-db/spark/contributors","subscribers_url":"https://api.github.com/repos/vladimirg-db/spark/subscribers","subscription_url":"https://api.github.com/repos/vladimirg-db/spark/subscription","commits_url":"https://api.github.com/repos/vladimirg-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/vladimirg-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/vladimirg-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/vladimirg-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/vladimirg-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/vladimirg-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vladimirg-db/spark/merges","archive_url":"https://api.github.com/repos/vladimirg-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vladimirg-db/spark/downloads","issues_url":"https://api.github.com/repos/vladimirg-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/vladimirg-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/vladimirg-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/vladimirg-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vladimirg-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/vladimirg-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/vladimirg-db/spark/deployments","created_at":"2024-07-25T08:13:07Z","updated_at":"2025-02-09T11:09:18Z","pushed_at":"2025-02-09T15:06:47Z","git_url":"git://github.com/vladimirg-db/spark.git","ssh_url":"git@github.com:vladimirg-db/spark.git","clone_url":"https://github.com/vladimirg-db/spark.git","svn_url":"https://github.com/vladimirg-db/spark","homepage":"https://spark.apache.org/","size":424040,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2c1c4d2614ae1ff902c244209f7ec3c79102d3e0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49271"},"html":{"href":"https://github.com/apache/spark/pull/49271"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49271"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49271/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49271/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49271/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/a70fb641c5f67ac27b8703fbbb0f1f525d74c0fa"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49270","id":2249353895,"node_id":"PR_kwDOAQXtWs6GEmqn","html_url":"https://github.com/apache/spark/pull/49270","diff_url":"https://github.com/apache/spark/pull/49270.diff","patch_url":"https://github.com/apache/spark/pull/49270.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49270","number":49270,"state":"closed","locked":false,"title":"[SPARK-50648][CORE] Cleanup zombie tasks in non-running stages when the job is cancelled","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\nThis is a problem that Spark always had. See the following section for the scenario when the problem occurs.\r\n\r\n When cancel a job, some tasks may be still running. \r\nThe reason is that when `DAGScheduler#handleTaskCompletion` encounters FetchFailed, `markStageAsFinished` will be called to remove the stage in `DAGScheduler#runningStages` (see https://github.com/apache/spark/blob/7cd5c4a1d1eb56fa92c10696bdbd8450d357b128/core/src/main/scala/org/apache/spark/scheduler/DAGScheduler.scala#L2059) and don't `killAllTaskAttempts`.\r\nBut `DAGScheduler#cancelRunningIndependentStages` only find `runningStages`, this will leave zombie shuffle tasks, occupying cluster resources.\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\nAssume a job is stage1-> stage2, when FetchFailed occurs during the stage 2, the stage1 and stage2  will resubmit (stage2 may still have some tasks running even if stage2 is resubmitted , this is as expected, because these tasks may eventually succeed and avoid retry)\r\n\r\nBut during the execution of the stage1-retry , if the SQL is canceled, the tasks in stage1 and stage1-retry can all be killed, but the tasks previously running in stage2 are still running and can't be killed. These tasks can greatly affect cluster stability and occupy resources.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n","created_at":"2024-12-23T11:31:52Z","updated_at":"2024-12-31T14:39:44Z","closed_at":"2024-12-31T12:20:48Z","merged_at":null,"merge_commit_sha":"38141c1ec48dcb643bb713311ab7041fa78edfb7","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49270/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49270/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49270/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/5bad1fd5e2a1f615fbef0ed8f0276aa8cec60fc3","head":{"label":"yabola:zombie-task-when-shuffle-retry","ref":"zombie-task-when-shuffle-retry","sha":"5bad1fd5e2a1f615fbef0ed8f0276aa8cec60fc3","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":750190560,"node_id":"R_kgDOLLb_4A","name":"spark","full_name":"yabola/spark","private":false,"owner":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yabola/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/yabola/spark","forks_url":"https://api.github.com/repos/yabola/spark/forks","keys_url":"https://api.github.com/repos/yabola/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yabola/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yabola/spark/teams","hooks_url":"https://api.github.com/repos/yabola/spark/hooks","issue_events_url":"https://api.github.com/repos/yabola/spark/issues/events{/number}","events_url":"https://api.github.com/repos/yabola/spark/events","assignees_url":"https://api.github.com/repos/yabola/spark/assignees{/user}","branches_url":"https://api.github.com/repos/yabola/spark/branches{/branch}","tags_url":"https://api.github.com/repos/yabola/spark/tags","blobs_url":"https://api.github.com/repos/yabola/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yabola/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yabola/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/yabola/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yabola/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/yabola/spark/languages","stargazers_url":"https://api.github.com/repos/yabola/spark/stargazers","contributors_url":"https://api.github.com/repos/yabola/spark/contributors","subscribers_url":"https://api.github.com/repos/yabola/spark/subscribers","subscription_url":"https://api.github.com/repos/yabola/spark/subscription","commits_url":"https://api.github.com/repos/yabola/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/yabola/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/yabola/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/yabola/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/yabola/spark/contents/{+path}","compare_url":"https://api.github.com/repos/yabola/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yabola/spark/merges","archive_url":"https://api.github.com/repos/yabola/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yabola/spark/downloads","issues_url":"https://api.github.com/repos/yabola/spark/issues{/number}","pulls_url":"https://api.github.com/repos/yabola/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/yabola/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/yabola/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yabola/spark/labels{/name}","releases_url":"https://api.github.com/repos/yabola/spark/releases{/id}","deployments_url":"https://api.github.com/repos/yabola/spark/deployments","created_at":"2024-01-30T06:48:16Z","updated_at":"2025-02-06T13:01:40Z","pushed_at":"2025-02-06T13:48:49Z","git_url":"git://github.com/yabola/spark.git","ssh_url":"git@github.com:yabola/spark.git","clone_url":"https://github.com/yabola/spark.git","svn_url":"https://github.com/yabola/spark","homepage":"https://spark.apache.org/","size":423774,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7cd5c4a1d1eb56fa92c10696bdbd8450d357b128","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49270"},"html":{"href":"https://github.com/apache/spark/pull/49270"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49270"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49270/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49270/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49270/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/5bad1fd5e2a1f615fbef0ed8f0276aa8cec60fc3"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49269","id":2249145289,"node_id":"PR_kwDOAQXtWs6GDzvJ","html_url":"https://github.com/apache/spark/pull/49269","diff_url":"https://github.com/apache/spark/pull/49269.diff","patch_url":"https://github.com/apache/spark/pull/49269.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49269","number":49269,"state":"closed","locked":false,"title":"[SPARK-50649] Fix inconsistencies with casting between different collations","user":{"login":"stefankandic","id":154237371,"node_id":"U_kgDOCTF5uw","avatar_url":"https://avatars.githubusercontent.com/u/154237371?v=4","gravatar_id":"","url":"https://api.github.com/users/stefankandic","html_url":"https://github.com/stefankandic","followers_url":"https://api.github.com/users/stefankandic/followers","following_url":"https://api.github.com/users/stefankandic/following{/other_user}","gists_url":"https://api.github.com/users/stefankandic/gists{/gist_id}","starred_url":"https://api.github.com/users/stefankandic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefankandic/subscriptions","organizations_url":"https://api.github.com/users/stefankandic/orgs","repos_url":"https://api.github.com/users/stefankandic/repos","events_url":"https://api.github.com/users/stefankandic/events{/privacy}","received_events_url":"https://api.github.com/users/stefankandic/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nFixing the inconsistent behavior of casts between different collations. Currently, we are allowed to do casts between them in dataframe API but not in the SQL API. I propose allowing casts in SQL as well (we are already allowing them for complex types anyways).\r\n\r\nAlso, this means changing the behavior or `CAST(x AS STRING)` which was previously not altering the collation of `x`, and will now change it to the default collation.\r\n\r\n\r\n### Why are the changes needed?\r\nTo make collation casts between the dataframe and SQL api consistent.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n\r\n### How was this patch tested?\r\nAdded new unit tests for the dataframe API which we didn't have before and also updated the existing tests for the SQL API to match the new behavior.\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.\r\n","created_at":"2024-12-23T09:29:32Z","updated_at":"2024-12-24T06:49:43Z","closed_at":"2024-12-24T06:49:43Z","merged_at":null,"merge_commit_sha":"acd32e3c2b729a6bbb754f6c0f030178467fb46e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49269/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49269/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49269/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/cadab10bb677c0291d0266950205a191306dae6f","head":{"label":"stefankandic:changeCastBehavior","ref":"changeCastBehavior","sha":"cadab10bb677c0291d0266950205a191306dae6f","user":{"login":"stefankandic","id":154237371,"node_id":"U_kgDOCTF5uw","avatar_url":"https://avatars.githubusercontent.com/u/154237371?v=4","gravatar_id":"","url":"https://api.github.com/users/stefankandic","html_url":"https://github.com/stefankandic","followers_url":"https://api.github.com/users/stefankandic/followers","following_url":"https://api.github.com/users/stefankandic/following{/other_user}","gists_url":"https://api.github.com/users/stefankandic/gists{/gist_id}","starred_url":"https://api.github.com/users/stefankandic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefankandic/subscriptions","organizations_url":"https://api.github.com/users/stefankandic/orgs","repos_url":"https://api.github.com/users/stefankandic/repos","events_url":"https://api.github.com/users/stefankandic/events{/privacy}","received_events_url":"https://api.github.com/users/stefankandic/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":734708961,"node_id":"R_kgDOK8rE4Q","name":"spark","full_name":"stefankandic/spark","private":false,"owner":{"login":"stefankandic","id":154237371,"node_id":"U_kgDOCTF5uw","avatar_url":"https://avatars.githubusercontent.com/u/154237371?v=4","gravatar_id":"","url":"https://api.github.com/users/stefankandic","html_url":"https://github.com/stefankandic","followers_url":"https://api.github.com/users/stefankandic/followers","following_url":"https://api.github.com/users/stefankandic/following{/other_user}","gists_url":"https://api.github.com/users/stefankandic/gists{/gist_id}","starred_url":"https://api.github.com/users/stefankandic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefankandic/subscriptions","organizations_url":"https://api.github.com/users/stefankandic/orgs","repos_url":"https://api.github.com/users/stefankandic/repos","events_url":"https://api.github.com/users/stefankandic/events{/privacy}","received_events_url":"https://api.github.com/users/stefankandic/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/stefankandic/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/stefankandic/spark","forks_url":"https://api.github.com/repos/stefankandic/spark/forks","keys_url":"https://api.github.com/repos/stefankandic/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/stefankandic/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/stefankandic/spark/teams","hooks_url":"https://api.github.com/repos/stefankandic/spark/hooks","issue_events_url":"https://api.github.com/repos/stefankandic/spark/issues/events{/number}","events_url":"https://api.github.com/repos/stefankandic/spark/events","assignees_url":"https://api.github.com/repos/stefankandic/spark/assignees{/user}","branches_url":"https://api.github.com/repos/stefankandic/spark/branches{/branch}","tags_url":"https://api.github.com/repos/stefankandic/spark/tags","blobs_url":"https://api.github.com/repos/stefankandic/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/stefankandic/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/stefankandic/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/stefankandic/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/stefankandic/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/stefankandic/spark/languages","stargazers_url":"https://api.github.com/repos/stefankandic/spark/stargazers","contributors_url":"https://api.github.com/repos/stefankandic/spark/contributors","subscribers_url":"https://api.github.com/repos/stefankandic/spark/subscribers","subscription_url":"https://api.github.com/repos/stefankandic/spark/subscription","commits_url":"https://api.github.com/repos/stefankandic/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/stefankandic/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/stefankandic/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/stefankandic/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/stefankandic/spark/contents/{+path}","compare_url":"https://api.github.com/repos/stefankandic/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/stefankandic/spark/merges","archive_url":"https://api.github.com/repos/stefankandic/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/stefankandic/spark/downloads","issues_url":"https://api.github.com/repos/stefankandic/spark/issues{/number}","pulls_url":"https://api.github.com/repos/stefankandic/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/stefankandic/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/stefankandic/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/stefankandic/spark/labels{/name}","releases_url":"https://api.github.com/repos/stefankandic/spark/releases{/id}","deployments_url":"https://api.github.com/repos/stefankandic/spark/deployments","created_at":"2023-12-22T11:54:18Z","updated_at":"2024-10-23T17:40:10Z","pushed_at":"2025-02-04T22:21:43Z","git_url":"git://github.com/stefankandic/spark.git","ssh_url":"git@github.com:stefankandic/spark.git","clone_url":"https://github.com/stefankandic/spark.git","svn_url":"https://github.com/stefankandic/spark","homepage":"https://spark.apache.org/","size":434684,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7cd5c4a1d1eb56fa92c10696bdbd8450d357b128","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49269"},"html":{"href":"https://github.com/apache/spark/pull/49269"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49269"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49269/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49269/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49269/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/cadab10bb677c0291d0266950205a191306dae6f"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49268","id":2249053091,"node_id":"PR_kwDOAQXtWs6GDdOj","html_url":"https://github.com/apache/spark/pull/49268","diff_url":"https://github.com/apache/spark/pull/49268.diff","patch_url":"https://github.com/apache/spark/pull/49268.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49268","number":49268,"state":"closed","locked":false,"title":"[SPARK-49530][PYTHON] Support pie subplots in pyspark plotting","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nSupport pie subplots in pyspark plotting.\r\n\r\n### Why are the changes needed?\r\nAPI parity with pandas.DataFrame.plot.pie, see [here](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.plot.pie.html)\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nPie subplots are supported as shown below:\r\n\r\n```py\r\n>>> from datetime import datetime\r\n>>> data = [\r\n...             (3, 5, 20, datetime(2018, 1, 31)),\r\n...             (2, 5, 42, datetime(2018, 2, 28)),\r\n...             (3, 6, 28, datetime(2018, 3, 31)),\r\n...             (9, 12, 62, datetime(2018, 4, 30)),\r\n...         ]\r\n>>> columns = [\"sales\", \"signups\", \"visits\", \"date\"]\r\n>>> df = spark.createDataFrame(data, columns)\r\n>>> fig = df.plot(kind=\"pie\", x=\"date\", subplots=True)\r\n>>> fig.show()\r\n```\r\n![newplot (2)](https://github.com/user-attachments/assets/2b019c6a-82da-4c12-b1ff-096786801f56)\r\n\r\n\r\n### How was this patch tested?\r\nUnit tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.\r\n","created_at":"2024-12-23T08:31:12Z","updated_at":"2024-12-26T06:06:48Z","closed_at":"2024-12-24T00:47:55Z","merged_at":null,"merge_commit_sha":"32509d954090f0022b9374b81705186ae1c19936","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49268/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49268/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49268/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/d6f2fc650af0130bc402b212b582cf619ab1b168","head":{"label":"xinrong-meng:pie_subplot","ref":"pie_subplot","sha":"d6f2fc650af0130bc402b212b582cf619ab1b168","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":335786381,"node_id":"MDEwOlJlcG9zaXRvcnkzMzU3ODYzODE=","name":"spark","full_name":"xinrong-meng/spark","private":false,"owner":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xinrong-meng/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xinrong-meng/spark","forks_url":"https://api.github.com/repos/xinrong-meng/spark/forks","keys_url":"https://api.github.com/repos/xinrong-meng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xinrong-meng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xinrong-meng/spark/teams","hooks_url":"https://api.github.com/repos/xinrong-meng/spark/hooks","issue_events_url":"https://api.github.com/repos/xinrong-meng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xinrong-meng/spark/events","assignees_url":"https://api.github.com/repos/xinrong-meng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xinrong-meng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xinrong-meng/spark/tags","blobs_url":"https://api.github.com/repos/xinrong-meng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xinrong-meng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xinrong-meng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xinrong-meng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xinrong-meng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xinrong-meng/spark/languages","stargazers_url":"https://api.github.com/repos/xinrong-meng/spark/stargazers","contributors_url":"https://api.github.com/repos/xinrong-meng/spark/contributors","subscribers_url":"https://api.github.com/repos/xinrong-meng/spark/subscribers","subscription_url":"https://api.github.com/repos/xinrong-meng/spark/subscription","commits_url":"https://api.github.com/repos/xinrong-meng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xinrong-meng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xinrong-meng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xinrong-meng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xinrong-meng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xinrong-meng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xinrong-meng/spark/merges","archive_url":"https://api.github.com/repos/xinrong-meng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xinrong-meng/spark/downloads","issues_url":"https://api.github.com/repos/xinrong-meng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xinrong-meng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xinrong-meng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xinrong-meng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xinrong-meng/spark/labels{/name}","releases_url":"https://api.github.com/repos/xinrong-meng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xinrong-meng/spark/deployments","created_at":"2021-02-03T23:47:29Z","updated_at":"2024-09-27T08:09:06Z","pushed_at":"2025-02-08T02:14:33Z","git_url":"git://github.com/xinrong-meng/spark.git","ssh_url":"git@github.com:xinrong-meng/spark.git","clone_url":"https://github.com/xinrong-meng/spark.git","svn_url":"https://github.com/xinrong-meng/spark","homepage":"https://spark.apache.org/","size":469811,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":2,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7cd5c4a1d1eb56fa92c10696bdbd8450d357b128","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49268"},"html":{"href":"https://github.com/apache/spark/pull/49268"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49268"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49268/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49268/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49268/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/d6f2fc650af0130bc402b212b582cf619ab1b168"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49267","id":2248795788,"node_id":"PR_kwDOAQXtWs6GCeaM","html_url":"https://github.com/apache/spark/pull/49267","diff_url":"https://github.com/apache/spark/pull/49267.diff","patch_url":"https://github.com/apache/spark/pull/49267.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49267","number":49267,"state":"closed","locked":false,"title":"[SPARK-50647][INFRA] Add a daily build for PySpark with old dependencies","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nAdd a daily build for PySpark with old dependencies\r\n\r\n### Why are the changes needed?\r\nto guard the installation described in https://apache.github.io/spark/api/python/getting_started/install.html\r\n\r\nThe installation guide is outdated:\r\n\r\n- pyspark-sql/connect requires\r\n-- pyarrow>=11.0\r\n-- numpy>=1.21\r\n-- pandas>=2.0.0\r\n\r\n- pyspark-pandas requires a even new versions of pandas/pyarrow/numpy\r\n-- pyarrow>=11.0\r\n-- numpy>=1.22.4\r\n-- pandas>=2.2.0\r\n\r\nThis PR excludes PS: we can either\r\n\r\n- make PS works in the old versions, and then add it in this workflow;\r\n- or upgrade the minimum requirements, and add a separate workflow for it;\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno, infra-only\r\n\r\n\r\n### How was this patch tested?\r\nPR build with \r\n```\r\nenvs:\r\ndefault: '{\"PYSPARK_IMAGE_TO_TEST\": \"python-minimum\", \"PYTHON_TO_TEST\": \"python3.9\"}'\r\n\r\njobs:\r\ndefault: '{\"pyspark\": \"true\"}'\r\n```\r\n\r\nhttps://github.com/zhengruifeng/spark/runs/34827211339\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nno","created_at":"2024-12-23T04:50:32Z","updated_at":"2024-12-26T01:27:57Z","closed_at":"2024-12-26T01:27:30Z","merged_at":null,"merge_commit_sha":"409c2426c6a952900d0e9ce46f3bd7508e7dd108","assignee":null,"assignees":[],"requested_reviewers":[{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"itholic","id":44108233,"node_id":"MDQ6VXNlcjQ0MTA4MjMz","avatar_url":"https://avatars.githubusercontent.com/u/44108233?v=4","gravatar_id":"","url":"https://api.github.com/users/itholic","html_url":"https://github.com/itholic","followers_url":"https://api.github.com/users/itholic/followers","following_url":"https://api.github.com/users/itholic/following{/other_user}","gists_url":"https://api.github.com/users/itholic/gists{/gist_id}","starred_url":"https://api.github.com/users/itholic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itholic/subscriptions","organizations_url":"https://api.github.com/users/itholic/orgs","repos_url":"https://api.github.com/users/itholic/repos","events_url":"https://api.github.com/users/itholic/events{/privacy}","received_events_url":"https://api.github.com/users/itholic/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null},{"id":1982110661,"node_id":"MDU6TGFiZWwxOTgyMTEwNjYx","url":"https://api.github.com/repos/apache/spark/labels/INFRA","name":"INFRA","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49267/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49267/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49267/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/ef1ebfeb64cb1a567e225292f1a3bf2549a95313","head":{"label":"zhengruifeng:infra_py_old","ref":"infra_py_old","sha":"ef1ebfeb64cb1a567e225292f1a3bf2549a95313","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"2c1c4d2614ae1ff902c244209f7ec3c79102d3e0","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49267"},"html":{"href":"https://github.com/apache/spark/pull/49267"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49267"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49267/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49267/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49267/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/ef1ebfeb64cb1a567e225292f1a3bf2549a95313"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49266","id":2248757736,"node_id":"PR_kwDOAQXtWs6GCVHo","html_url":"https://github.com/apache/spark/pull/49266","diff_url":"https://github.com/apache/spark/pull/49266.diff","patch_url":"https://github.com/apache/spark/pull/49266.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49266","number":49266,"state":"closed","locked":false,"title":"[SPARK-50527][INFRA][FOLLOW-UP] Python 3.12 image clean up","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nPython 3.12 image clean up\r\n\r\n\r\n### Why are the changes needed?\r\n`python3.12` was installed twice\r\n\r\nno similar issue were found in other new images\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno, infra-only\r\n\r\n\r\n### How was this patch tested?\r\nCI, will monitor the Python 3.12 daily build\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nno\r\n","created_at":"2024-12-23T04:14:17Z","updated_at":"2024-12-23T04:16:22Z","closed_at":"2024-12-23T04:16:09Z","merged_at":null,"merge_commit_sha":"bccca3a4d06c7f957d28104874739f64de5b3836","assignee":null,"assignees":[],"requested_reviewers":[{"login":"LuciferYang","id":1475305,"node_id":"MDQ6VXNlcjE0NzUzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1475305?v=4","gravatar_id":"","url":"https://api.github.com/users/LuciferYang","html_url":"https://github.com/LuciferYang","followers_url":"https://api.github.com/users/LuciferYang/followers","following_url":"https://api.github.com/users/LuciferYang/following{/other_user}","gists_url":"https://api.github.com/users/LuciferYang/gists{/gist_id}","starred_url":"https://api.github.com/users/LuciferYang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuciferYang/subscriptions","organizations_url":"https://api.github.com/users/LuciferYang/orgs","repos_url":"https://api.github.com/users/LuciferYang/repos","events_url":"https://api.github.com/users/LuciferYang/events{/privacy}","received_events_url":"https://api.github.com/users/LuciferYang/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1406627200,"node_id":"MDU6TGFiZWwxNDA2NjI3MjAw","url":"https://api.github.com/repos/apache/spark/labels/BUILD","name":"BUILD","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49266/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49266/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49266/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/c19abcf76083db460b521927cd92f9b836e4dcac","head":{"label":"zhengruifeng:infra_12_cleanup","ref":"infra_12_cleanup","sha":"c19abcf76083db460b521927cd92f9b836e4dcac","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f8fd398439d02fae865be09bce81207f54a98efb","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49266"},"html":{"href":"https://github.com/apache/spark/pull/49266"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49266"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49266/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49266/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49266/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/c19abcf76083db460b521927cd92f9b836e4dcac"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49265","id":2248696158,"node_id":"PR_kwDOAQXtWs6GCGFe","html_url":"https://github.com/apache/spark/pull/49265","diff_url":"https://github.com/apache/spark/pull/49265.diff","patch_url":"https://github.com/apache/spark/pull/49265.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49265","number":49265,"state":"closed","locked":false,"title":"[SPARK-50646][PYTHON][DOCS] Document explicit style of pyspark plotting","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nDocument explicit style of pyspark plotting.\r\n\r\n### Why are the changes needed?\r\nTo improve documentation by explicitly showing both chaining (df.plot.line(...)) and explicit (df.plot(kind=\"line\", ...)) styles, ensuring clarity for users\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n### How was this patch tested?\r\nExisting tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.","created_at":"2024-12-23T02:54:19Z","updated_at":"2024-12-23T05:21:50Z","closed_at":"2024-12-23T05:21:32Z","merged_at":null,"merge_commit_sha":"59c1b4027c53b4c9a4e80ea15e13ef6c3512c427","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49265/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49265/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49265/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/eeb0c2fa2a66085d2237fab93103cd9bad839c14","head":{"label":"xinrong-meng:pyplot","ref":"pyplot","sha":"eeb0c2fa2a66085d2237fab93103cd9bad839c14","user":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":335786381,"node_id":"MDEwOlJlcG9zaXRvcnkzMzU3ODYzODE=","name":"spark","full_name":"xinrong-meng/spark","private":false,"owner":{"login":"xinrong-meng","id":47337188,"node_id":"MDQ6VXNlcjQ3MzM3MTg4","avatar_url":"https://avatars.githubusercontent.com/u/47337188?v=4","gravatar_id":"","url":"https://api.github.com/users/xinrong-meng","html_url":"https://github.com/xinrong-meng","followers_url":"https://api.github.com/users/xinrong-meng/followers","following_url":"https://api.github.com/users/xinrong-meng/following{/other_user}","gists_url":"https://api.github.com/users/xinrong-meng/gists{/gist_id}","starred_url":"https://api.github.com/users/xinrong-meng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinrong-meng/subscriptions","organizations_url":"https://api.github.com/users/xinrong-meng/orgs","repos_url":"https://api.github.com/users/xinrong-meng/repos","events_url":"https://api.github.com/users/xinrong-meng/events{/privacy}","received_events_url":"https://api.github.com/users/xinrong-meng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/xinrong-meng/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/xinrong-meng/spark","forks_url":"https://api.github.com/repos/xinrong-meng/spark/forks","keys_url":"https://api.github.com/repos/xinrong-meng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/xinrong-meng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/xinrong-meng/spark/teams","hooks_url":"https://api.github.com/repos/xinrong-meng/spark/hooks","issue_events_url":"https://api.github.com/repos/xinrong-meng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/xinrong-meng/spark/events","assignees_url":"https://api.github.com/repos/xinrong-meng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/xinrong-meng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/xinrong-meng/spark/tags","blobs_url":"https://api.github.com/repos/xinrong-meng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/xinrong-meng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/xinrong-meng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/xinrong-meng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/xinrong-meng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/xinrong-meng/spark/languages","stargazers_url":"https://api.github.com/repos/xinrong-meng/spark/stargazers","contributors_url":"https://api.github.com/repos/xinrong-meng/spark/contributors","subscribers_url":"https://api.github.com/repos/xinrong-meng/spark/subscribers","subscription_url":"https://api.github.com/repos/xinrong-meng/spark/subscription","commits_url":"https://api.github.com/repos/xinrong-meng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/xinrong-meng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/xinrong-meng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/xinrong-meng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/xinrong-meng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/xinrong-meng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/xinrong-meng/spark/merges","archive_url":"https://api.github.com/repos/xinrong-meng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/xinrong-meng/spark/downloads","issues_url":"https://api.github.com/repos/xinrong-meng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/xinrong-meng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/xinrong-meng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/xinrong-meng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/xinrong-meng/spark/labels{/name}","releases_url":"https://api.github.com/repos/xinrong-meng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/xinrong-meng/spark/deployments","created_at":"2021-02-03T23:47:29Z","updated_at":"2024-09-27T08:09:06Z","pushed_at":"2025-02-08T02:14:33Z","git_url":"git://github.com/xinrong-meng/spark.git","ssh_url":"git@github.com:xinrong-meng/spark.git","clone_url":"https://github.com/xinrong-meng/spark.git","svn_url":"https://github.com/xinrong-meng/spark","homepage":"https://spark.apache.org/","size":469811,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":1,"open_issues":2,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f6f6dae726e5c5125baab5bb6a73535fa1494dfd","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49265"},"html":{"href":"https://github.com/apache/spark/pull/49265"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49265"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49265/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49265/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49265/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/eeb0c2fa2a66085d2237fab93103cd9bad839c14"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49264","id":2248655040,"node_id":"PR_kwDOAQXtWs6GB8DA","html_url":"https://github.com/apache/spark/pull/49264","diff_url":"https://github.com/apache/spark/pull/49264.diff","patch_url":"https://github.com/apache/spark/pull/49264.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49264","number":49264,"state":"closed","locked":false,"title":"[SPARK-50645][INFRA] Make more daily builds able to manually trigger","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nsimilar to https://github.com/apache/spark/pull/49207, make the rest daily builds able to be executed manually\r\n\r\n\r\n### Why are the changes needed?\r\nre-run failed tests in a daily build won't fetch the latest code changes, so somethimes we don't have a quick way to test daily build in time.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nno, infra-only\r\n\r\n\r\n### How was this patch tested?\r\nwill manually check after merge\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nno\r\n","created_at":"2024-12-23T02:03:07Z","updated_at":"2024-12-23T03:06:43Z","closed_at":"2024-12-23T03:06:15Z","merged_at":null,"merge_commit_sha":"a9b41bbb2759a464f5417009f9ea5aad42142f38","assignee":null,"assignees":[],"requested_reviewers":[{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"HyukjinKwon","id":6477701,"node_id":"MDQ6VXNlcjY0Nzc3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6477701?v=4","gravatar_id":"","url":"https://api.github.com/users/HyukjinKwon","html_url":"https://github.com/HyukjinKwon","followers_url":"https://api.github.com/users/HyukjinKwon/followers","following_url":"https://api.github.com/users/HyukjinKwon/following{/other_user}","gists_url":"https://api.github.com/users/HyukjinKwon/gists{/gist_id}","starred_url":"https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HyukjinKwon/subscriptions","organizations_url":"https://api.github.com/users/HyukjinKwon/orgs","repos_url":"https://api.github.com/users/HyukjinKwon/repos","events_url":"https://api.github.com/users/HyukjinKwon/events{/privacy}","received_events_url":"https://api.github.com/users/HyukjinKwon/received_events","type":"User","user_view_type":"public","site_admin":false}],"requested_teams":[],"labels":[{"id":1982110661,"node_id":"MDU6TGFiZWwxOTgyMTEwNjYx","url":"https://api.github.com/repos/apache/spark/labels/INFRA","name":"INFRA","color":"ededed","default":false,"description":null}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49264/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49264/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49264/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2fa1e170d6debad505cbe69eb0ff6fabb91743cc","head":{"label":"zhengruifeng:add_manually_trigger","ref":"add_manually_trigger","sha":"2fa1e170d6debad505cbe69eb0ff6fabb91743cc","user":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":51584791,"node_id":"MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==","name":"spark","full_name":"zhengruifeng/spark","private":false,"owner":{"login":"zhengruifeng","id":7322292,"node_id":"MDQ6VXNlcjczMjIyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/7322292?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengruifeng","html_url":"https://github.com/zhengruifeng","followers_url":"https://api.github.com/users/zhengruifeng/followers","following_url":"https://api.github.com/users/zhengruifeng/following{/other_user}","gists_url":"https://api.github.com/users/zhengruifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengruifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengruifeng/subscriptions","organizations_url":"https://api.github.com/users/zhengruifeng/orgs","repos_url":"https://api.github.com/users/zhengruifeng/repos","events_url":"https://api.github.com/users/zhengruifeng/events{/privacy}","received_events_url":"https://api.github.com/users/zhengruifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/zhengruifeng/spark","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/zhengruifeng/spark","forks_url":"https://api.github.com/repos/zhengruifeng/spark/forks","keys_url":"https://api.github.com/repos/zhengruifeng/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/zhengruifeng/spark/teams","hooks_url":"https://api.github.com/repos/zhengruifeng/spark/hooks","issue_events_url":"https://api.github.com/repos/zhengruifeng/spark/issues/events{/number}","events_url":"https://api.github.com/repos/zhengruifeng/spark/events","assignees_url":"https://api.github.com/repos/zhengruifeng/spark/assignees{/user}","branches_url":"https://api.github.com/repos/zhengruifeng/spark/branches{/branch}","tags_url":"https://api.github.com/repos/zhengruifeng/spark/tags","blobs_url":"https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/zhengruifeng/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/zhengruifeng/spark/languages","stargazers_url":"https://api.github.com/repos/zhengruifeng/spark/stargazers","contributors_url":"https://api.github.com/repos/zhengruifeng/spark/contributors","subscribers_url":"https://api.github.com/repos/zhengruifeng/spark/subscribers","subscription_url":"https://api.github.com/repos/zhengruifeng/spark/subscription","commits_url":"https://api.github.com/repos/zhengruifeng/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/zhengruifeng/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/zhengruifeng/spark/contents/{+path}","compare_url":"https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/zhengruifeng/spark/merges","archive_url":"https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/zhengruifeng/spark/downloads","issues_url":"https://api.github.com/repos/zhengruifeng/spark/issues{/number}","pulls_url":"https://api.github.com/repos/zhengruifeng/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/zhengruifeng/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/zhengruifeng/spark/labels{/name}","releases_url":"https://api.github.com/repos/zhengruifeng/spark/releases{/id}","deployments_url":"https://api.github.com/repos/zhengruifeng/spark/deployments","created_at":"2016-02-12T11:58:00Z","updated_at":"2025-02-09T01:55:22Z","pushed_at":"2025-02-09T01:55:17Z","git_url":"git://github.com/zhengruifeng/spark.git","ssh_url":"git@github.com:zhengruifeng/spark.git","clone_url":"https://github.com/zhengruifeng/spark.git","svn_url":"https://github.com/zhengruifeng/spark","homepage":null,"size":434785,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":6,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"f6f6dae726e5c5125baab5bb6a73535fa1494dfd","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49264"},"html":{"href":"https://github.com/apache/spark/pull/49264"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49264"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49264/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49264/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49264/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2fa1e170d6debad505cbe69eb0ff6fabb91743cc"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49263","id":2248166682,"node_id":"PR_kwDOAQXtWs6GAE0a","html_url":"https://github.com/apache/spark/pull/49263","diff_url":"https://github.com/apache/spark/pull/49263.diff","patch_url":"https://github.com/apache/spark/pull/49263.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49263","number":49263,"state":"closed","locked":false,"title":"[SPARK-50644][SQL] Read variant struct in Parquet reader.","user":{"login":"chenhao-db","id":122326661,"node_id":"U_kgDOB0qOhQ","avatar_url":"https://avatars.githubusercontent.com/u/122326661?v=4","gravatar_id":"","url":"https://api.github.com/users/chenhao-db","html_url":"https://github.com/chenhao-db","followers_url":"https://api.github.com/users/chenhao-db/followers","following_url":"https://api.github.com/users/chenhao-db/following{/other_user}","gists_url":"https://api.github.com/users/chenhao-db/gists{/gist_id}","starred_url":"https://api.github.com/users/chenhao-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenhao-db/subscriptions","organizations_url":"https://api.github.com/users/chenhao-db/orgs","repos_url":"https://api.github.com/users/chenhao-db/repos","events_url":"https://api.github.com/users/chenhao-db/events{/privacy}","received_events_url":"https://api.github.com/users/chenhao-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\n\r\nIt adds support for variant struct in Parquet reader. The concept of variant struct was introduced in https://github.com/apache/spark/pull/49235. It includes all the extracted fields from a variant column that the query requests.\r\n\r\n### Why are the changes needed?\r\n\r\nBy producing variant struct in Parquet reader, we can avoid reading/rebuilding the full variant and achieve more efficient variant processing.\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n\r\nNo.\r\n\r\n### How was this patch tested?\r\n\r\nUnit test.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n\r\nNo.","created_at":"2024-12-21T22:40:44Z","updated_at":"2024-12-24T18:57:23Z","closed_at":"2024-12-24T06:54:10Z","merged_at":null,"merge_commit_sha":"722a8923a8c792224739c7884db602a94f3d436e","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49263/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49263/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49263/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/98bfe37d76b88ce748c6c6bb0d5435cf4e2bced1","head":{"label":"chenhao-db:spark_variant_struct_reader","ref":"spark_variant_struct_reader","sha":"98bfe37d76b88ce748c6c6bb0d5435cf4e2bced1","user":{"login":"chenhao-db","id":122326661,"node_id":"U_kgDOB0qOhQ","avatar_url":"https://avatars.githubusercontent.com/u/122326661?v=4","gravatar_id":"","url":"https://api.github.com/users/chenhao-db","html_url":"https://github.com/chenhao-db","followers_url":"https://api.github.com/users/chenhao-db/followers","following_url":"https://api.github.com/users/chenhao-db/following{/other_user}","gists_url":"https://api.github.com/users/chenhao-db/gists{/gist_id}","starred_url":"https://api.github.com/users/chenhao-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenhao-db/subscriptions","organizations_url":"https://api.github.com/users/chenhao-db/orgs","repos_url":"https://api.github.com/users/chenhao-db/repos","events_url":"https://api.github.com/users/chenhao-db/events{/privacy}","received_events_url":"https://api.github.com/users/chenhao-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":608298960,"node_id":"R_kgDOJEHn0A","name":"oss","full_name":"chenhao-db/oss","private":false,"owner":{"login":"chenhao-db","id":122326661,"node_id":"U_kgDOB0qOhQ","avatar_url":"https://avatars.githubusercontent.com/u/122326661?v=4","gravatar_id":"","url":"https://api.github.com/users/chenhao-db","html_url":"https://github.com/chenhao-db","followers_url":"https://api.github.com/users/chenhao-db/followers","following_url":"https://api.github.com/users/chenhao-db/following{/other_user}","gists_url":"https://api.github.com/users/chenhao-db/gists{/gist_id}","starred_url":"https://api.github.com/users/chenhao-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenhao-db/subscriptions","organizations_url":"https://api.github.com/users/chenhao-db/orgs","repos_url":"https://api.github.com/users/chenhao-db/repos","events_url":"https://api.github.com/users/chenhao-db/events{/privacy}","received_events_url":"https://api.github.com/users/chenhao-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/chenhao-db/oss","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/chenhao-db/oss","forks_url":"https://api.github.com/repos/chenhao-db/oss/forks","keys_url":"https://api.github.com/repos/chenhao-db/oss/keys{/key_id}","collaborators_url":"https://api.github.com/repos/chenhao-db/oss/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/chenhao-db/oss/teams","hooks_url":"https://api.github.com/repos/chenhao-db/oss/hooks","issue_events_url":"https://api.github.com/repos/chenhao-db/oss/issues/events{/number}","events_url":"https://api.github.com/repos/chenhao-db/oss/events","assignees_url":"https://api.github.com/repos/chenhao-db/oss/assignees{/user}","branches_url":"https://api.github.com/repos/chenhao-db/oss/branches{/branch}","tags_url":"https://api.github.com/repos/chenhao-db/oss/tags","blobs_url":"https://api.github.com/repos/chenhao-db/oss/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/chenhao-db/oss/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/chenhao-db/oss/git/refs{/sha}","trees_url":"https://api.github.com/repos/chenhao-db/oss/git/trees{/sha}","statuses_url":"https://api.github.com/repos/chenhao-db/oss/statuses/{sha}","languages_url":"https://api.github.com/repos/chenhao-db/oss/languages","stargazers_url":"https://api.github.com/repos/chenhao-db/oss/stargazers","contributors_url":"https://api.github.com/repos/chenhao-db/oss/contributors","subscribers_url":"https://api.github.com/repos/chenhao-db/oss/subscribers","subscription_url":"https://api.github.com/repos/chenhao-db/oss/subscription","commits_url":"https://api.github.com/repos/chenhao-db/oss/commits{/sha}","git_commits_url":"https://api.github.com/repos/chenhao-db/oss/git/commits{/sha}","comments_url":"https://api.github.com/repos/chenhao-db/oss/comments{/number}","issue_comment_url":"https://api.github.com/repos/chenhao-db/oss/issues/comments{/number}","contents_url":"https://api.github.com/repos/chenhao-db/oss/contents/{+path}","compare_url":"https://api.github.com/repos/chenhao-db/oss/compare/{base}...{head}","merges_url":"https://api.github.com/repos/chenhao-db/oss/merges","archive_url":"https://api.github.com/repos/chenhao-db/oss/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/chenhao-db/oss/downloads","issues_url":"https://api.github.com/repos/chenhao-db/oss/issues{/number}","pulls_url":"https://api.github.com/repos/chenhao-db/oss/pulls{/number}","milestones_url":"https://api.github.com/repos/chenhao-db/oss/milestones{/number}","notifications_url":"https://api.github.com/repos/chenhao-db/oss/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/chenhao-db/oss/labels{/name}","releases_url":"https://api.github.com/repos/chenhao-db/oss/releases{/id}","deployments_url":"https://api.github.com/repos/chenhao-db/oss/deployments","created_at":"2023-03-01T18:22:10Z","updated_at":"2024-03-22T19:41:59Z","pushed_at":"2025-01-06T21:11:31Z","git_url":"git://github.com/chenhao-db/oss.git","ssh_url":"git@github.com:chenhao-db/oss.git","clone_url":"https://github.com/chenhao-db/oss.git","svn_url":"https://github.com/chenhao-db/oss","homepage":"https://spark.apache.org/","size":430222,"stargazers_count":0,"watchers_count":0,"language":null,"has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a2e3188b4997001f4dbc1eb364d61ca55d438208","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49263"},"html":{"href":"https://github.com/apache/spark/pull/49263"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49263"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49263/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49263/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49263/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/98bfe37d76b88ce748c6c6bb0d5435cf4e2bced1"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49262","id":2248159306,"node_id":"PR_kwDOAQXtWs6GADBK","html_url":"https://github.com/apache/spark/pull/49262","diff_url":"https://github.com/apache/spark/pull/49262.diff","patch_url":"https://github.com/apache/spark/pull/49262.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49262","number":49262,"state":"closed","locked":false,"title":"[SPARK-xxxxx][PYTHON] Add Python Arrow UDF concurrency mode","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\n","created_at":"2024-12-21T22:04:52Z","updated_at":"2024-12-22T20:13:19Z","closed_at":"2024-12-22T03:22:09Z","merged_at":null,"merge_commit_sha":"c00fbb67b156ed295c32bea91ea09512092962d5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1981527456,"node_id":"MDU6TGFiZWwxOTgxNTI3NDU2","url":"https://api.github.com/repos/apache/spark/labels/CORE","name":"CORE","color":"0E8A16","default":false,"description":""},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""}],"milestone":null,"draft":true,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49262/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49262/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49262/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/30afea78de1b72261ee18bd7bac43448240f395d","head":{"label":"viirya:async_process","ref":"async_process","sha":"30afea78de1b72261ee18bd7bac43448240f395d","user":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":21467907,"node_id":"MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==","name":"spark-1","full_name":"viirya/spark-1","private":false,"owner":{"login":"viirya","id":68855,"node_id":"MDQ6VXNlcjY4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/68855?v=4","gravatar_id":"","url":"https://api.github.com/users/viirya","html_url":"https://github.com/viirya","followers_url":"https://api.github.com/users/viirya/followers","following_url":"https://api.github.com/users/viirya/following{/other_user}","gists_url":"https://api.github.com/users/viirya/gists{/gist_id}","starred_url":"https://api.github.com/users/viirya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viirya/subscriptions","organizations_url":"https://api.github.com/users/viirya/orgs","repos_url":"https://api.github.com/users/viirya/repos","events_url":"https://api.github.com/users/viirya/events{/privacy}","received_events_url":"https://api.github.com/users/viirya/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/viirya/spark-1","description":"Mirror of Apache Spark","fork":true,"url":"https://api.github.com/repos/viirya/spark-1","forks_url":"https://api.github.com/repos/viirya/spark-1/forks","keys_url":"https://api.github.com/repos/viirya/spark-1/keys{/key_id}","collaborators_url":"https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/viirya/spark-1/teams","hooks_url":"https://api.github.com/repos/viirya/spark-1/hooks","issue_events_url":"https://api.github.com/repos/viirya/spark-1/issues/events{/number}","events_url":"https://api.github.com/repos/viirya/spark-1/events","assignees_url":"https://api.github.com/repos/viirya/spark-1/assignees{/user}","branches_url":"https://api.github.com/repos/viirya/spark-1/branches{/branch}","tags_url":"https://api.github.com/repos/viirya/spark-1/tags","blobs_url":"https://api.github.com/repos/viirya/spark-1/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/viirya/spark-1/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/viirya/spark-1/git/refs{/sha}","trees_url":"https://api.github.com/repos/viirya/spark-1/git/trees{/sha}","statuses_url":"https://api.github.com/repos/viirya/spark-1/statuses/{sha}","languages_url":"https://api.github.com/repos/viirya/spark-1/languages","stargazers_url":"https://api.github.com/repos/viirya/spark-1/stargazers","contributors_url":"https://api.github.com/repos/viirya/spark-1/contributors","subscribers_url":"https://api.github.com/repos/viirya/spark-1/subscribers","subscription_url":"https://api.github.com/repos/viirya/spark-1/subscription","commits_url":"https://api.github.com/repos/viirya/spark-1/commits{/sha}","git_commits_url":"https://api.github.com/repos/viirya/spark-1/git/commits{/sha}","comments_url":"https://api.github.com/repos/viirya/spark-1/comments{/number}","issue_comment_url":"https://api.github.com/repos/viirya/spark-1/issues/comments{/number}","contents_url":"https://api.github.com/repos/viirya/spark-1/contents/{+path}","compare_url":"https://api.github.com/repos/viirya/spark-1/compare/{base}...{head}","merges_url":"https://api.github.com/repos/viirya/spark-1/merges","archive_url":"https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/viirya/spark-1/downloads","issues_url":"https://api.github.com/repos/viirya/spark-1/issues{/number}","pulls_url":"https://api.github.com/repos/viirya/spark-1/pulls{/number}","milestones_url":"https://api.github.com/repos/viirya/spark-1/milestones{/number}","notifications_url":"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/viirya/spark-1/labels{/name}","releases_url":"https://api.github.com/repos/viirya/spark-1/releases{/id}","deployments_url":"https://api.github.com/repos/viirya/spark-1/deployments","created_at":"2014-07-03T15:40:08Z","updated_at":"2025-02-01T00:45:46Z","pushed_at":"2025-02-01T00:42:28Z","git_url":"git://github.com/viirya/spark-1.git","ssh_url":"git@github.com:viirya/spark-1.git","clone_url":"https://github.com/viirya/spark-1.git","svn_url":"https://github.com/viirya/spark-1","homepage":null,"size":440683,"stargazers_count":1,"watchers_count":1,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a2e3188b4997001f4dbc1eb364d61ca55d438208","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49262"},"html":{"href":"https://github.com/apache/spark/pull/49262"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49262"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49262/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49262/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49262/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/30afea78de1b72261ee18bd7bac43448240f395d"}},"author_association":"MEMBER","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49261","id":2248109749,"node_id":"PR_kwDOAQXtWs6F_261","html_url":"https://github.com/apache/spark/pull/49261","diff_url":"https://github.com/apache/spark/pull/49261.diff","patch_url":"https://github.com/apache/spark/pull/49261.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49261","number":49261,"state":"open","locked":false,"title":"[SPARK-48568][SQL] Improve Performance of CodeFormatter","user":{"login":"anton-erofeev","id":17137147,"node_id":"MDQ6VXNlcjE3MTM3MTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17137147?v=4","gravatar_id":"","url":"https://api.github.com/users/anton-erofeev","html_url":"https://github.com/anton-erofeev","followers_url":"https://api.github.com/users/anton-erofeev/followers","following_url":"https://api.github.com/users/anton-erofeev/following{/other_user}","gists_url":"https://api.github.com/users/anton-erofeev/gists{/gist_id}","starred_url":"https://api.github.com/users/anton-erofeev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anton-erofeev/subscriptions","organizations_url":"https://api.github.com/users/anton-erofeev/orgs","repos_url":"https://api.github.com/users/anton-erofeev/repos","events_url":"https://api.github.com/users/anton-erofeev/events{/privacy}","received_events_url":"https://api.github.com/users/anton-erofeev/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"\r\n\r\n<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\nReplace scala StringBuilder with java StringBuilder\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n\r\n\r\n### Why are the changes needed?\r\nhttps://issues.apache.org/jira/browse/SPARK-48568\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\n\r\n\r\n### How was this patch tested?\r\nPass github actions\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\n","created_at":"2024-12-21T18:38:28Z","updated_at":"2025-01-09T04:07:40Z","closed_at":null,"merged_at":null,"merge_commit_sha":"681582bccd8c7e30bd91a062c005d470432f9568","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49261/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49261/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49261/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/dd3593c5beb23a515bd759aefb4d0923bd9eec36","head":{"label":"anton-erofeev:SPARK-48568","ref":"SPARK-48568","sha":"dd3593c5beb23a515bd759aefb4d0923bd9eec36","user":{"login":"anton-erofeev","id":17137147,"node_id":"MDQ6VXNlcjE3MTM3MTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17137147?v=4","gravatar_id":"","url":"https://api.github.com/users/anton-erofeev","html_url":"https://github.com/anton-erofeev","followers_url":"https://api.github.com/users/anton-erofeev/followers","following_url":"https://api.github.com/users/anton-erofeev/following{/other_user}","gists_url":"https://api.github.com/users/anton-erofeev/gists{/gist_id}","starred_url":"https://api.github.com/users/anton-erofeev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anton-erofeev/subscriptions","organizations_url":"https://api.github.com/users/anton-erofeev/orgs","repos_url":"https://api.github.com/users/anton-erofeev/repos","events_url":"https://api.github.com/users/anton-erofeev/events{/privacy}","received_events_url":"https://api.github.com/users/anton-erofeev/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":905960433,"node_id":"R_kgDONf_b8Q","name":"spark","full_name":"anton-erofeev/spark","private":false,"owner":{"login":"anton-erofeev","id":17137147,"node_id":"MDQ6VXNlcjE3MTM3MTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17137147?v=4","gravatar_id":"","url":"https://api.github.com/users/anton-erofeev","html_url":"https://github.com/anton-erofeev","followers_url":"https://api.github.com/users/anton-erofeev/followers","following_url":"https://api.github.com/users/anton-erofeev/following{/other_user}","gists_url":"https://api.github.com/users/anton-erofeev/gists{/gist_id}","starred_url":"https://api.github.com/users/anton-erofeev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anton-erofeev/subscriptions","organizations_url":"https://api.github.com/users/anton-erofeev/orgs","repos_url":"https://api.github.com/users/anton-erofeev/repos","events_url":"https://api.github.com/users/anton-erofeev/events{/privacy}","received_events_url":"https://api.github.com/users/anton-erofeev/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/anton-erofeev/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/anton-erofeev/spark","forks_url":"https://api.github.com/repos/anton-erofeev/spark/forks","keys_url":"https://api.github.com/repos/anton-erofeev/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/anton-erofeev/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/anton-erofeev/spark/teams","hooks_url":"https://api.github.com/repos/anton-erofeev/spark/hooks","issue_events_url":"https://api.github.com/repos/anton-erofeev/spark/issues/events{/number}","events_url":"https://api.github.com/repos/anton-erofeev/spark/events","assignees_url":"https://api.github.com/repos/anton-erofeev/spark/assignees{/user}","branches_url":"https://api.github.com/repos/anton-erofeev/spark/branches{/branch}","tags_url":"https://api.github.com/repos/anton-erofeev/spark/tags","blobs_url":"https://api.github.com/repos/anton-erofeev/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/anton-erofeev/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/anton-erofeev/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/anton-erofeev/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/anton-erofeev/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/anton-erofeev/spark/languages","stargazers_url":"https://api.github.com/repos/anton-erofeev/spark/stargazers","contributors_url":"https://api.github.com/repos/anton-erofeev/spark/contributors","subscribers_url":"https://api.github.com/repos/anton-erofeev/spark/subscribers","subscription_url":"https://api.github.com/repos/anton-erofeev/spark/subscription","commits_url":"https://api.github.com/repos/anton-erofeev/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/anton-erofeev/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/anton-erofeev/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/anton-erofeev/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/anton-erofeev/spark/contents/{+path}","compare_url":"https://api.github.com/repos/anton-erofeev/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/anton-erofeev/spark/merges","archive_url":"https://api.github.com/repos/anton-erofeev/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/anton-erofeev/spark/downloads","issues_url":"https://api.github.com/repos/anton-erofeev/spark/issues{/number}","pulls_url":"https://api.github.com/repos/anton-erofeev/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/anton-erofeev/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/anton-erofeev/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/anton-erofeev/spark/labels{/name}","releases_url":"https://api.github.com/repos/anton-erofeev/spark/releases{/id}","deployments_url":"https://api.github.com/repos/anton-erofeev/spark/deployments","created_at":"2024-12-19T21:30:27Z","updated_at":"2024-12-20T17:30:33Z","pushed_at":"2025-01-18T10:20:05Z","git_url":"git://github.com/anton-erofeev/spark.git","ssh_url":"git@github.com:anton-erofeev/spark.git","clone_url":"https://github.com/anton-erofeev/spark.git","svn_url":"https://github.com/anton-erofeev/spark","homepage":"https://spark.apache.org/","size":417165,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a2e3188b4997001f4dbc1eb364d61ca55d438208","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49261"},"html":{"href":"https://github.com/apache/spark/pull/49261"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49261"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49261/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49261/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49261/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/dd3593c5beb23a515bd759aefb4d0923bd9eec36"}},"author_association":"NONE","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49260","id":2247600491,"node_id":"PR_kwDOAQXtWs6F96lr","html_url":"https://github.com/apache/spark/pull/49260","diff_url":"https://github.com/apache/spark/pull/49260.diff","patch_url":"https://github.com/apache/spark/pull/49260.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49260","number":49260,"state":"closed","locked":false,"title":"[SPARK-50642][CONNECT][SS]Fix the state schema for FlatMapGroupsWithState in spark connect when there is no initial state","user":{"login":"huanliwang-db","id":112906573,"node_id":"U_kgDOBrrRTQ","avatar_url":"https://avatars.githubusercontent.com/u/112906573?v=4","gravatar_id":"","url":"https://api.github.com/users/huanliwang-db","html_url":"https://github.com/huanliwang-db","followers_url":"https://api.github.com/users/huanliwang-db/followers","following_url":"https://api.github.com/users/huanliwang-db/following{/other_user}","gists_url":"https://api.github.com/users/huanliwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/huanliwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huanliwang-db/subscriptions","organizations_url":"https://api.github.com/users/huanliwang-db/orgs","repos_url":"https://api.github.com/users/huanliwang-db/repos","events_url":"https://api.github.com/users/huanliwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/huanliwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"In spark connect, when there is no initial state, we derived the state schema from the input:\r\n\r\ncreate the initialDs from the original input: https://github.com/apache/spark/blob/master/sql/connect/server/src/main/scala/org/apache/spark/sql/connect/planner/SparkConnectPlanner.scala#L679-L689\r\nderived the state expression encoder from this `initialDs` which is incorrect: https://github.com/apache/spark/blob/master/sql/connect/server/src/main/scala/org/apache/spark/sql/connect/planner/SparkConnectPlanner.scala#L729\r\n \r\n\r\nOur unit tests fail to cover this case because it doesn't do the state update: https://github.com/apache/spark/blob/master/connector/connect/client/jvm/src/test/scala/org/apache/spark/sql/streaming/FlatMapGroupsWithStateStreamingSuite.scala#L55-L59\r\n\r\nafter changing the `stateFunc` to the following\r\n```\r\nval stateFunc =\r\n  (key: String, values: Iterator[ClickEvent], state: GroupState[ClickState]) => {\r\n    if (state.exists) throw new IllegalArgumentException(\"state.exists should be false\")\r\n    val newState = ClickState(key, values.size)\r\n    state.update(newState)\r\n    Iterator(newState)\r\n  }\r\n``` \r\n\r\nthe test is actually failing with\r\n\r\n\r\n```\r\nCause: org.apache.spark.SparkException: Job aborted due to stage failure: Task 122 in stage 2.0 failed 1 times, most recent failure: Lost task 122.0 in stage 2.0 (TID 12) (192.168.68.84 executor driver): java.lang.ClassCastException: class org.apache.spark.sql.streaming.ClickState cannot be cast to class org.apache.spark.sql.streaming.ClickEvent (org.apache.spark.sql.streaming.ClickState and org.apache.spark.sql.streaming.ClickEvent are in unnamed module of loader 'app')\r\n        at org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.CreateNamedStruct_0$(Unknown Source)\r\n```\r\n \r\n\r\n<!--\r\nThanks for sending a pull request!  Here are some tips for you:\r\n  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html\r\n  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html\r\n  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.\r\n  4. Be sure to keep the PR description updated to reflect all changes.\r\n  5. Please write your PR title to summarize what this PR proposes.\r\n  6. If possible, provide a concise example to reproduce the issue for a faster review.\r\n  7. If you want to add a new configuration, please read the guideline first for naming configurations in\r\n     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.\r\n  8. If you want to add or modify an error type or message, please read the guideline first in\r\n     'common/utils/src/main/resources/error/README.md'.\r\n-->\r\n\r\n### What changes were proposed in this pull request?\r\n<!--\r\nPlease clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. \r\nIf possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.\r\n  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.\r\n  2. If you fix some SQL features, you can provide some references of other DBMSes.\r\n  3. If there is design documentation, please add the link.\r\n  4. If there is a discussion in the mailing list, please add the link.\r\n-->\r\n* introduce a new `state_schema` proto field\r\n* pass the state agnostic encoder to the serialized udf\r\n* pass the state schema to query proto for spark connect\r\n* rebuild the state expression encoder based on the state agnostic encoder and state schema.\r\n\r\n\r\n### Why are the changes needed?\r\n<!--\r\nPlease clarify why the changes are needed. For instance,\r\n  1. If you propose a new API, clarify the use case for a new API.\r\n  2. If you fix a bug, you can clarify why it is a bug.\r\n-->\r\nfix the broken behavior for flatMapGroupsWithState on spark connect\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\n<!--\r\nNote that it means *any* user-facing change including all aspects such as the documentation fix.\r\nIf yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.\r\nIf possible, please also clarify if this is a user-facing change compared to the released Spark versions or within the unreleased branches such as master.\r\nIf no, write 'No'.\r\n-->\r\nyes\r\n\r\n### How was this patch tested?\r\n<!--\r\nIf tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.\r\nIf it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.\r\nIf tests were not added, please describe why they were not added and/or why it was difficult to add.\r\nIf benchmark tests were added, please run the benchmarks in GitHub Actions for the consistent environment, and the instructions could accord to: https://spark.apache.org/developer-tools.html#github-workflow-benchmarks.\r\n-->\r\nmodified the existing unit tests.\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\n<!--\r\nIf generative AI tooling has been used in the process of authoring this patch, please include the\r\nphrase: 'Generated-by: ' followed by the name of the tool and its version.\r\nIf no, write 'No'.\r\nPlease refer to the [ASF Generative Tooling Guidance](https://www.apache.org/legal/generative-tooling.html) for details.\r\n-->\r\nno","created_at":"2024-12-21T03:54:21Z","updated_at":"2025-01-02T03:01:52Z","closed_at":"2025-01-02T03:01:52Z","merged_at":null,"merge_commit_sha":"8966e41ccdea80707aef745ec15660f60905af03","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""},{"id":1406587328,"node_id":"MDU6TGFiZWwxNDA2NTg3MzI4","url":"https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING","name":"STRUCTURED STREAMING","color":"ededed","default":false,"description":null},{"id":1982260031,"node_id":"MDU6TGFiZWwxOTgyMjYwMDMx","url":"https://api.github.com/repos/apache/spark/labels/PYTHON","name":"PYTHON","color":"FBCA04","default":false,"description":""},{"id":4556440342,"node_id":"LA_kwDOAQXtWs8AAAABD5XDFg","url":"https://api.github.com/repos/apache/spark/labels/CONNECT","name":"CONNECT","color":"1D76DB","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49260/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49260/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49260/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/b689c34ee1aa42c14e0c47859c7a275d3dc28e12","head":{"label":"huanliwang-db:huanliwang-db/fmgws-client","ref":"huanliwang-db/fmgws-client","sha":"b689c34ee1aa42c14e0c47859c7a275d3dc28e12","user":{"login":"huanliwang-db","id":112906573,"node_id":"U_kgDOBrrRTQ","avatar_url":"https://avatars.githubusercontent.com/u/112906573?v=4","gravatar_id":"","url":"https://api.github.com/users/huanliwang-db","html_url":"https://github.com/huanliwang-db","followers_url":"https://api.github.com/users/huanliwang-db/followers","following_url":"https://api.github.com/users/huanliwang-db/following{/other_user}","gists_url":"https://api.github.com/users/huanliwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/huanliwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huanliwang-db/subscriptions","organizations_url":"https://api.github.com/users/huanliwang-db/orgs","repos_url":"https://api.github.com/users/huanliwang-db/repos","events_url":"https://api.github.com/users/huanliwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/huanliwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":536868405,"node_id":"R_kgDOH__2NQ","name":"spark","full_name":"huanliwang-db/spark","private":false,"owner":{"login":"huanliwang-db","id":112906573,"node_id":"U_kgDOBrrRTQ","avatar_url":"https://avatars.githubusercontent.com/u/112906573?v=4","gravatar_id":"","url":"https://api.github.com/users/huanliwang-db","html_url":"https://github.com/huanliwang-db","followers_url":"https://api.github.com/users/huanliwang-db/followers","following_url":"https://api.github.com/users/huanliwang-db/following{/other_user}","gists_url":"https://api.github.com/users/huanliwang-db/gists{/gist_id}","starred_url":"https://api.github.com/users/huanliwang-db/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huanliwang-db/subscriptions","organizations_url":"https://api.github.com/users/huanliwang-db/orgs","repos_url":"https://api.github.com/users/huanliwang-db/repos","events_url":"https://api.github.com/users/huanliwang-db/events{/privacy}","received_events_url":"https://api.github.com/users/huanliwang-db/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/huanliwang-db/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/huanliwang-db/spark","forks_url":"https://api.github.com/repos/huanliwang-db/spark/forks","keys_url":"https://api.github.com/repos/huanliwang-db/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/huanliwang-db/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/huanliwang-db/spark/teams","hooks_url":"https://api.github.com/repos/huanliwang-db/spark/hooks","issue_events_url":"https://api.github.com/repos/huanliwang-db/spark/issues/events{/number}","events_url":"https://api.github.com/repos/huanliwang-db/spark/events","assignees_url":"https://api.github.com/repos/huanliwang-db/spark/assignees{/user}","branches_url":"https://api.github.com/repos/huanliwang-db/spark/branches{/branch}","tags_url":"https://api.github.com/repos/huanliwang-db/spark/tags","blobs_url":"https://api.github.com/repos/huanliwang-db/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/huanliwang-db/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/huanliwang-db/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/huanliwang-db/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/huanliwang-db/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/huanliwang-db/spark/languages","stargazers_url":"https://api.github.com/repos/huanliwang-db/spark/stargazers","contributors_url":"https://api.github.com/repos/huanliwang-db/spark/contributors","subscribers_url":"https://api.github.com/repos/huanliwang-db/spark/subscribers","subscription_url":"https://api.github.com/repos/huanliwang-db/spark/subscription","commits_url":"https://api.github.com/repos/huanliwang-db/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/huanliwang-db/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/huanliwang-db/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/huanliwang-db/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/huanliwang-db/spark/contents/{+path}","compare_url":"https://api.github.com/repos/huanliwang-db/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/huanliwang-db/spark/merges","archive_url":"https://api.github.com/repos/huanliwang-db/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/huanliwang-db/spark/downloads","issues_url":"https://api.github.com/repos/huanliwang-db/spark/issues{/number}","pulls_url":"https://api.github.com/repos/huanliwang-db/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/huanliwang-db/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/huanliwang-db/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/huanliwang-db/spark/labels{/name}","releases_url":"https://api.github.com/repos/huanliwang-db/spark/releases{/id}","deployments_url":"https://api.github.com/repos/huanliwang-db/spark/deployments","created_at":"2022-09-15T04:51:05Z","updated_at":"2024-12-21T03:29:39Z","pushed_at":"2024-12-26T23:00:43Z","git_url":"git://github.com/huanliwang-db/spark.git","ssh_url":"git@github.com:huanliwang-db/spark.git","clone_url":"https://github.com/huanliwang-db/spark.git","svn_url":"https://github.com/huanliwang-db/spark","homepage":"https://spark.apache.org/","size":423061,"stargazers_count":0,"watchers_count":0,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":0,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"7cd5c4a1d1eb56fa92c10696bdbd8450d357b128","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49260"},"html":{"href":"https://github.com/apache/spark/pull/49260"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49260"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49260/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49260/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49260/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/b689c34ee1aa42c14e0c47859c7a275d3dc28e12"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null},{"url":"https://api.github.com/repos/apache/spark/pulls/49259","id":2247568561,"node_id":"PR_kwDOAQXtWs6F9yyx","html_url":"https://github.com/apache/spark/pull/49259","diff_url":"https://github.com/apache/spark/pull/49259.diff","patch_url":"https://github.com/apache/spark/pull/49259.patch","issue_url":"https://api.github.com/repos/apache/spark/issues/49259","number":49259,"state":"closed","locked":false,"title":"[SPARK-50641][SQL] Move `GetJsonObjectEvaluator` to `JsonExpressionEvalUtils`","user":{"login":"panbingkun","id":15246973,"node_id":"MDQ6VXNlcjE1MjQ2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/15246973?v=4","gravatar_id":"","url":"https://api.github.com/users/panbingkun","html_url":"https://github.com/panbingkun","followers_url":"https://api.github.com/users/panbingkun/followers","following_url":"https://api.github.com/users/panbingkun/following{/other_user}","gists_url":"https://api.github.com/users/panbingkun/gists{/gist_id}","starred_url":"https://api.github.com/users/panbingkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panbingkun/subscriptions","organizations_url":"https://api.github.com/users/panbingkun/orgs","repos_url":"https://api.github.com/users/panbingkun/repos","events_url":"https://api.github.com/users/panbingkun/events{/privacy}","received_events_url":"https://api.github.com/users/panbingkun/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"### What changes were proposed in this pull request?\r\nThe pr aims to move `GetJsonObjectEvaluator` to `JsonExpressionEvalUtils`.\r\n\r\n\r\n### Why are the changes needed?\r\nMake code clearly.\r\n\r\n\r\n### Does this PR introduce _any_ user-facing change?\r\nNo.\r\n\r\n\r\n### How was this patch tested?\r\n- Pass GA\r\n- Manually test.\r\n\r\n\r\n### Was this patch authored or co-authored using generative AI tooling?\r\nNo.","created_at":"2024-12-21T01:50:32Z","updated_at":"2024-12-23T08:28:37Z","closed_at":"2024-12-23T08:27:11Z","merged_at":null,"merge_commit_sha":"f14c6be830cc1f12a73d719415c4eda2aa00555c","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[{"id":1405794576,"node_id":"MDU6TGFiZWwxNDA1Nzk0NTc2","url":"https://api.github.com/repos/apache/spark/labels/SQL","name":"SQL","color":"E99695","default":false,"description":""}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/spark/pulls/49259/commits","review_comments_url":"https://api.github.com/repos/apache/spark/pulls/49259/comments","review_comment_url":"https://api.github.com/repos/apache/spark/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/spark/issues/49259/comments","statuses_url":"https://api.github.com/repos/apache/spark/statuses/2bee4954de1fb70e2dfd6eb3d69851de24d08a44","head":{"label":"panbingkun:SPARK-50641","ref":"SPARK-50641","sha":"2bee4954de1fb70e2dfd6eb3d69851de24d08a44","user":{"login":"panbingkun","id":15246973,"node_id":"MDQ6VXNlcjE1MjQ2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/15246973?v=4","gravatar_id":"","url":"https://api.github.com/users/panbingkun","html_url":"https://github.com/panbingkun","followers_url":"https://api.github.com/users/panbingkun/followers","following_url":"https://api.github.com/users/panbingkun/following{/other_user}","gists_url":"https://api.github.com/users/panbingkun/gists{/gist_id}","starred_url":"https://api.github.com/users/panbingkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panbingkun/subscriptions","organizations_url":"https://api.github.com/users/panbingkun/orgs","repos_url":"https://api.github.com/users/panbingkun/repos","events_url":"https://api.github.com/users/panbingkun/events{/privacy}","received_events_url":"https://api.github.com/users/panbingkun/received_events","type":"User","user_view_type":"public","site_admin":false},"repo":{"id":481429011,"node_id":"R_kgDOHLIGEw","name":"spark","full_name":"panbingkun/spark","private":false,"owner":{"login":"panbingkun","id":15246973,"node_id":"MDQ6VXNlcjE1MjQ2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/15246973?v=4","gravatar_id":"","url":"https://api.github.com/users/panbingkun","html_url":"https://github.com/panbingkun","followers_url":"https://api.github.com/users/panbingkun/followers","following_url":"https://api.github.com/users/panbingkun/following{/other_user}","gists_url":"https://api.github.com/users/panbingkun/gists{/gist_id}","starred_url":"https://api.github.com/users/panbingkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panbingkun/subscriptions","organizations_url":"https://api.github.com/users/panbingkun/orgs","repos_url":"https://api.github.com/users/panbingkun/repos","events_url":"https://api.github.com/users/panbingkun/events{/privacy}","received_events_url":"https://api.github.com/users/panbingkun/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/panbingkun/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":true,"url":"https://api.github.com/repos/panbingkun/spark","forks_url":"https://api.github.com/repos/panbingkun/spark/forks","keys_url":"https://api.github.com/repos/panbingkun/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/panbingkun/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/panbingkun/spark/teams","hooks_url":"https://api.github.com/repos/panbingkun/spark/hooks","issue_events_url":"https://api.github.com/repos/panbingkun/spark/issues/events{/number}","events_url":"https://api.github.com/repos/panbingkun/spark/events","assignees_url":"https://api.github.com/repos/panbingkun/spark/assignees{/user}","branches_url":"https://api.github.com/repos/panbingkun/spark/branches{/branch}","tags_url":"https://api.github.com/repos/panbingkun/spark/tags","blobs_url":"https://api.github.com/repos/panbingkun/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/panbingkun/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/panbingkun/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/panbingkun/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/panbingkun/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/panbingkun/spark/languages","stargazers_url":"https://api.github.com/repos/panbingkun/spark/stargazers","contributors_url":"https://api.github.com/repos/panbingkun/spark/contributors","subscribers_url":"https://api.github.com/repos/panbingkun/spark/subscribers","subscription_url":"https://api.github.com/repos/panbingkun/spark/subscription","commits_url":"https://api.github.com/repos/panbingkun/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/panbingkun/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/panbingkun/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/panbingkun/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/panbingkun/spark/contents/{+path}","compare_url":"https://api.github.com/repos/panbingkun/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/panbingkun/spark/merges","archive_url":"https://api.github.com/repos/panbingkun/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/panbingkun/spark/downloads","issues_url":"https://api.github.com/repos/panbingkun/spark/issues{/number}","pulls_url":"https://api.github.com/repos/panbingkun/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/panbingkun/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/panbingkun/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/panbingkun/spark/labels{/name}","releases_url":"https://api.github.com/repos/panbingkun/spark/releases{/id}","deployments_url":"https://api.github.com/repos/panbingkun/spark/deployments","created_at":"2022-04-14T01:38:25Z","updated_at":"2025-02-05T01:36:40Z","pushed_at":"2025-02-05T01:36:19Z","git_url":"git://github.com/panbingkun/spark.git","ssh_url":"git@github.com:panbingkun/spark.git","clone_url":"https://github.com/panbingkun/spark.git","svn_url":"https://github.com/panbingkun/spark","homepage":"https://spark.apache.org/","size":497912,"stargazers_count":2,"watchers_count":2,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":4,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":4,"open_issues":0,"watchers":2,"default_branch":"master"}},"base":{"label":"apache:master","ref":"master","sha":"a2e3188b4997001f4dbc1eb364d61ca55d438208","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"repo":{"id":17165658,"node_id":"MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==","name":"spark","full_name":"apache/spark","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/apache/spark","description":"Apache Spark - A unified analytics engine for large-scale data processing","fork":false,"url":"https://api.github.com/repos/apache/spark","forks_url":"https://api.github.com/repos/apache/spark/forks","keys_url":"https://api.github.com/repos/apache/spark/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/spark/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/spark/teams","hooks_url":"https://api.github.com/repos/apache/spark/hooks","issue_events_url":"https://api.github.com/repos/apache/spark/issues/events{/number}","events_url":"https://api.github.com/repos/apache/spark/events","assignees_url":"https://api.github.com/repos/apache/spark/assignees{/user}","branches_url":"https://api.github.com/repos/apache/spark/branches{/branch}","tags_url":"https://api.github.com/repos/apache/spark/tags","blobs_url":"https://api.github.com/repos/apache/spark/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/spark/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/spark/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/spark/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/spark/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/spark/languages","stargazers_url":"https://api.github.com/repos/apache/spark/stargazers","contributors_url":"https://api.github.com/repos/apache/spark/contributors","subscribers_url":"https://api.github.com/repos/apache/spark/subscribers","subscription_url":"https://api.github.com/repos/apache/spark/subscription","commits_url":"https://api.github.com/repos/apache/spark/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/spark/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/spark/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/spark/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/spark/contents/{+path}","compare_url":"https://api.github.com/repos/apache/spark/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/spark/merges","archive_url":"https://api.github.com/repos/apache/spark/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/spark/downloads","issues_url":"https://api.github.com/repos/apache/spark/issues{/number}","pulls_url":"https://api.github.com/repos/apache/spark/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/spark/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/spark/labels{/name}","releases_url":"https://api.github.com/repos/apache/spark/releases{/id}","deployments_url":"https://api.github.com/repos/apache/spark/deployments","created_at":"2014-02-25T08:00:08Z","updated_at":"2025-02-09T19:59:16Z","pushed_at":"2025-02-09T04:19:30Z","git_url":"git://github.com/apache/spark.git","ssh_url":"git@github.com:apache/spark.git","clone_url":"https://github.com/apache/spark.git","svn_url":"https://github.com/apache/spark","homepage":"https://spark.apache.org/","size":488549,"stargazers_count":40497,"watchers_count":40497,"language":"Scala","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":false,"forks_count":28484,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":198,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["big-data","java","jdbc","python","r","scala","spark","sql"],"visibility":"public","forks":28484,"open_issues":198,"watchers":40497,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/spark/pulls/49259"},"html":{"href":"https://github.com/apache/spark/pull/49259"},"issue":{"href":"https://api.github.com/repos/apache/spark/issues/49259"},"comments":{"href":"https://api.github.com/repos/apache/spark/issues/49259/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/spark/pulls/49259/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/spark/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/spark/pulls/49259/commits"},"statuses":{"href":"https://api.github.com/repos/apache/spark/statuses/2bee4954de1fb70e2dfd6eb3d69851de24d08a44"}},"author_association":"CONTRIBUTOR","auto_merge":null,"active_lock_reason":null}]