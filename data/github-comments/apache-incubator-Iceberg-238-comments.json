[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465032019","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1465032019","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1465032019,"node_id":"IC_kwDOCW7NX85XUp1T","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T21:58:17Z","updated_at":"2023-03-11T21:58:17Z","author_association":"COLLABORATOR","body":"Actually one thing is bothering me, can we check, if you pass in a filter that is always true, can we distinguish from always false case?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465032019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465034853","html_url":"https://github.com/apache/iceberg/issues/7071#issuecomment-1465034853","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7071","id":1465034853,"node_id":"IC_kwDOCW7NX85XUqhl","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T22:08:54Z","updated_at":"2023-03-11T22:11:42Z","author_association":"CONTRIBUTOR","body":"Thanks for bringing back this discussion @singhpk234 , I think it makes sense to have the table format itself be able to help determine optimal split sizes because the table format has the statistics to determine good values for a given table.\r\n\r\nI think we just need to define what the user experience + engine integration experience should look like considering `read.split.target-size` is already defined with a default of 128mb. One simple approach that comes to mind is define another table property `read.split.auto-size` which defaults to false. If it's set to true, then `read.split.target-size` should be ignored by the engine, and the engine takes the responsibility for determining optimal split size given the table stats. In the iceberg library there could be a utility for a recommended size based on table stats, and the engine just delegates to the library if they want to use that or they can override if there's something better for the engine based on stats. The downside of this approach is it requires users to update their existing table if they want this behavior, but I think it's acceptable tradeoff because they may have explicitly set a `read.split.target-size` and I think we would have to make this opt-in to avoid any unexpected behavior.\r\n\r\nOver time, as we get confidence in the auto-size behavior for different engines we can make it default to true. Just my initial thoughts, open to others ideas here as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465034853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465059092","html_url":"https://github.com/apache/iceberg/pull/7070#issuecomment-1465059092","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7070","id":1465059092,"node_id":"IC_kwDOCW7NX85XUwcU","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-12T00:36:46Z","updated_at":"2023-03-12T00:36:46Z","author_association":"CONTRIBUTOR","body":"thanks @Fokko for updating the doc","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465059092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465066662","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1465066662","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1465066662,"node_id":"IC_kwDOCW7NX85XUySm","user":{"login":"ludlows","id":6441333,"node_id":"MDQ6VXNlcjY0NDEzMzM=","avatar_url":"https://avatars.githubusercontent.com/u/6441333?v=4","gravatar_id":"","url":"https://api.github.com/users/ludlows","html_url":"https://github.com/ludlows","followers_url":"https://api.github.com/users/ludlows/followers","following_url":"https://api.github.com/users/ludlows/following{/other_user}","gists_url":"https://api.github.com/users/ludlows/gists{/gist_id}","starred_url":"https://api.github.com/users/ludlows/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ludlows/subscriptions","organizations_url":"https://api.github.com/users/ludlows/orgs","repos_url":"https://api.github.com/users/ludlows/repos","events_url":"https://api.github.com/users/ludlows/events{/privacy}","received_events_url":"https://api.github.com/users/ludlows/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-12T01:33:29Z","updated_at":"2023-03-12T01:33:29Z","author_association":"CONTRIBUTOR","body":"we now can tell the `where` filter is always false by checking if the TreeNode set in the LogicalPlan is empty.\r\nit seems that we cannot tell whether the `where` filter is always true using this method.\r\n\r\non the other hand, we execute rewrite actions as normal if we are sure about `where` filter is always true. \r\nand we do nothing if we know `where` filter is false to save time. \r\nit seems that we only need to care about whether `where` is false or not. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465066662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465090060","html_url":"https://github.com/apache/iceberg/issues/6973#issuecomment-1465090060","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6973","id":1465090060,"node_id":"IC_kwDOCW7NX85XU4AM","user":{"login":"JonasJ-ap","id":55990951,"node_id":"MDQ6VXNlcjU1OTkwOTUx","avatar_url":"https://avatars.githubusercontent.com/u/55990951?v=4","gravatar_id":"","url":"https://api.github.com/users/JonasJ-ap","html_url":"https://github.com/JonasJ-ap","followers_url":"https://api.github.com/users/JonasJ-ap/followers","following_url":"https://api.github.com/users/JonasJ-ap/following{/other_user}","gists_url":"https://api.github.com/users/JonasJ-ap/gists{/gist_id}","starred_url":"https://api.github.com/users/JonasJ-ap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JonasJ-ap/subscriptions","organizations_url":"https://api.github.com/users/JonasJ-ap/orgs","repos_url":"https://api.github.com/users/JonasJ-ap/repos","events_url":"https://api.github.com/users/JonasJ-ap/events{/privacy}","received_events_url":"https://api.github.com/users/JonasJ-ap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-12T04:31:49Z","updated_at":"2023-03-12T04:33:28Z","author_association":"CONTRIBUTOR","body":"I would like to share a quick test on reading field metadata from ORC file (from an iceberg table created on AWS Athena engine v3) by pyarrow. It seems that the pa.Schema of the ORC file does not contain any field_id information even though they do exist in the ORC file:\r\n\r\nI first use `orc-tools` to inspect the metadata of the ORC file and find that the field id is stored in `iceberg.id`:\r\n```zsh\r\norc-tools meta /Users/jonasjiang/.CMVolumes/gluetestjonas/warehouse/iceberg_ref/athena_orc_test/data/30f712c8/creation_date=2023-03-11/user_id_bucket=2/20230311_203248_00007_2vuin-316269af-62cb-4bef-8f52-ca2d46bc6397.orc\r\nlog4j:WARN No appenders could be found for logger (org.apache.hadoop.util.Shell).\r\nlog4j:WARN Please initialize the log4j system properly.\r\nlog4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.\r\nProcessing data file /Users/jonasjiang/.CMVolumes/gluetestjonas/warehouse/iceberg_ref/athena_orc_test/data/30f712c8/creation_date=2023-03-11/user_id_bucket=2/20230311_203248_00007_2vuin-316269af-62cb-4bef-8f52-ca2d46bc6397.orc [length: 1104]\r\nStructure for /Users/jonasjiang/.CMVolumes/gluetestjonas/warehouse/iceberg_ref/athena_orc_test/data/30f712c8/creation_date=2023-03-11/user_id_bucket=2/20230311_203248_00007_2vuin-316269af-62cb-4bef-8f52-ca2d46bc6397.orc\r\nFile Version: 0.12 with TRINO_ORIGINAL by Trino \r\nRows: 1\r\nCompression: ZSTD\r\nCompression size: 262144\r\nCalendar: Julian/Gregorian\r\nType: struct<user_id:int,user_name:string,status:string,cost:double,quantity:int,quantity_big:int,creation_date:date,created_at:timestamp,inserted_at:timestamp>\r\nAttributes on root.user_id\r\n  iceberg.id: 1\r\n  iceberg.required: false\r\nAttributes on root.user_name\r\n  iceberg.id: 2\r\n  iceberg.required: false\r\nAttributes on root.status\r\n  iceberg.id: 3\r\n  iceberg.required: false\r\nAttributes on root.cost\r\n  iceberg.id: 4\r\n  iceberg.required: false\r\nAttributes on root.quantity\r\n  iceberg.id: 5\r\n  iceberg.required: false\r\n```\r\n\r\nHowever, when I used the similar way in #7033 to get the pyarrow schema, the field id info get lost:\r\n```python\r\norc_test_path = \"/Users/jonasjiang/.CMVolumes/gluetestjonas/warehouse/iceberg_ref/athena_orc_test/data/30f712c8/creation_date=2023-03-11/user_id_bucket=2/20230311_203248_00007_2vuin-316269af-62cb-4bef-8f52-ca2d46bc6397.orc\"\r\nfs = LocalFileSystem()\r\nwith fs.open_input_file(orc_test_path) as f:\r\n    # print(po.ORCFile(f).read().schema)\r\n    print(ds.OrcFileFormat().make_fragment(f).physical_schema)\r\n```\r\n```zsh\r\nuser_id: int32\r\nuser_name: string\r\nstatus: string\r\ncost: double\r\nquantity: int32\r\nquantity_big: int32\r\ncreation_date: date32[day]\r\ncreated_at: timestamp[ns]\r\ninserted_at: timestamp[ns]\r\n-- schema metadata --\r\npresto_query_id: '20230311_203248_00007_2vuin'\r\ntrino.writer.version: '0.215-16024-g6eec71f'\r\npresto_version: '0.215-16024-g6eec71f'\r\n```\r\nThe pyarrow schema containing field id info should look like:\r\n```zsh\r\nuser_id: int32\r\n  -- field metadata --\r\n  PARQUET:field_id: '1'\r\nuser_name: string\r\n  -- field metadata --\r\n  PARQUET:field_id: '2'\r\nstatus: string\r\n  -- field metadata --\r\n  PARQUET:field_id: '3'\r\n...\r\n```\r\n\r\n It seems even with #6997 merged, we still cannot fully support the ORC file format if we use pyarrow to read it. The name mapping feature may need to be implemented here for conversion from pyarrow schema to iceberg schema.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465090060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465127391","html_url":"https://github.com/apache/iceberg/pull/7070#issuecomment-1465127391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7070","id":1465127391,"node_id":"IC_kwDOCW7NX85XVBHf","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-12T08:43:41Z","updated_at":"2023-03-12T08:43:41Z","author_association":"CONTRIBUTOR","body":"Any time @stevenzwu thanks for the prompt review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465127391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465224207","html_url":"https://github.com/apache/iceberg/pull/7089#issuecomment-1465224207","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7089","id":1465224207,"node_id":"IC_kwDOCW7NX85XVYwP","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-12T15:11:30Z","updated_at":"2023-03-12T15:11:30Z","author_association":"MEMBER","body":"cc: @nastra, @aokolnychyi, @rdblue, @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465224207/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465239889","html_url":"https://github.com/apache/iceberg/pull/7050#issuecomment-1465239889","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7050","id":1465239889,"node_id":"IC_kwDOCW7NX85XVclR","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-12T16:19:45Z","updated_at":"2023-03-12T16:19:45Z","author_association":"CONTRIBUTOR","body":"@rdblue @amogh-jahagirdar thanks for the suggestions, I have addressed all nit comments, and also fixed the scan issue and updated the tests to verify behavior of multiple writes. Could you take another look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465239889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465296404","html_url":"https://github.com/apache/iceberg/pull/7066#issuecomment-1465296404","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7066","id":1465296404,"node_id":"IC_kwDOCW7NX85XVqYU","user":{"login":"JonasJ-ap","id":55990951,"node_id":"MDQ6VXNlcjU1OTkwOTUx","avatar_url":"https://avatars.githubusercontent.com/u/55990951?v=4","gravatar_id":"","url":"https://api.github.com/users/JonasJ-ap","html_url":"https://github.com/JonasJ-ap","followers_url":"https://api.github.com/users/JonasJ-ap/followers","following_url":"https://api.github.com/users/JonasJ-ap/following{/other_user}","gists_url":"https://api.github.com/users/JonasJ-ap/gists{/gist_id}","starred_url":"https://api.github.com/users/JonasJ-ap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JonasJ-ap/subscriptions","organizations_url":"https://api.github.com/users/JonasJ-ap/orgs","repos_url":"https://api.github.com/users/JonasJ-ap/repos","events_url":"https://api.github.com/users/JonasJ-ap/events{/privacy}","received_events_url":"https://api.github.com/users/JonasJ-ap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-12T20:50:38Z","updated_at":"2023-03-12T20:50:38Z","author_association":"CONTRIBUTOR","body":"Thank you very much for your contributions! I leave some comments above.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465296404/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465297880","html_url":"https://github.com/apache/iceberg/issues/6973#issuecomment-1465297880","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6973","id":1465297880,"node_id":"IC_kwDOCW7NX85XVqvY","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-12T20:58:14Z","updated_at":"2023-03-12T20:58:14Z","author_association":"CONTRIBUTOR","body":"@JonasJ-ap I came to the same conclusion. I think this will require some upstream PyArrow patches.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465297880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465308954","html_url":"https://github.com/apache/iceberg/pull/6997#issuecomment-1465308954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6997","id":1465308954,"node_id":"IC_kwDOCW7NX85XVtca","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-12T21:51:09Z","updated_at":"2023-03-12T21:51:09Z","author_association":"CONTRIBUTOR","body":"@JonasJ-ap I think we're good. Thanks so much for this PR and the refactoring of the tests. Let's @rdblue some time to hear if he has any final thoughts before merging.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465308954/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465314466","html_url":"https://github.com/apache/iceberg/issues/6973#issuecomment-1465314466","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6973","id":1465314466,"node_id":"IC_kwDOCW7NX85XVuyi","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-12T22:16:17Z","updated_at":"2023-03-12T22:16:17Z","author_association":"CONTRIBUTOR","body":"I also noticed the following:\r\n```\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n../pyiceberg/table/__init__.py:404: in to_arrow\r\n    return project_table(\r\n../pyiceberg/io/pyarrow.py:586: in project_table\r\n    for table in pool.starmap(\r\n/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/pool.py:372: in starmap\r\n    return self._map_async(func, iterable, starmapstar, chunksize).get()\r\n/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/pool.py:771: in get\r\n    raise self._value\r\n/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/pool.py:125: in worker\r\n    result = (True, func(*args, **kwds))\r\n/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/pool.py:51: in starmapstar\r\n    return list(itertools.starmap(args[0], args[1]))\r\n../pyiceberg/io/pyarrow.py:511: in _file_to_table\r\n    physical_schema = fragment.physical_schema\r\npyarrow/_dataset.pyx:1004: in pyarrow._dataset.Fragment.physical_schema.__get__\r\n    ???\r\npyarrow/error.pxi:144: in pyarrow.lib.pyarrow_internal_check_status\r\n    ???\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\n>   ???\r\nE   pyarrow.lib.ArrowTypeError: Unknown Orc type kind: timestamp with local time zone\r\n\r\npyarrow/error.pxi:123: ArrowTypeError\r\n```\r\nSome polishing to do for ORC","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465314466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465340567","html_url":"https://github.com/apache/iceberg/issues/5753#issuecomment-1465340567","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5753","id":1465340567,"node_id":"IC_kwDOCW7NX85XV1KX","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T00:11:52Z","updated_at":"2023-03-13T00:11:52Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465340567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465340591","html_url":"https://github.com/apache/iceberg/issues/5649#issuecomment-1465340591","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5649","id":1465340591,"node_id":"IC_kwDOCW7NX85XV1Kv","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T00:11:56Z","updated_at":"2023-03-13T00:11:56Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465340591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465342003","html_url":"https://github.com/apache/iceberg/pull/6906#issuecomment-1465342003","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6906","id":1465342003,"node_id":"IC_kwDOCW7NX85XV1gz","user":{"login":"Buktoria","id":3473392,"node_id":"MDQ6VXNlcjM0NzMzOTI=","avatar_url":"https://avatars.githubusercontent.com/u/3473392?v=4","gravatar_id":"","url":"https://api.github.com/users/Buktoria","html_url":"https://github.com/Buktoria","followers_url":"https://api.github.com/users/Buktoria/followers","following_url":"https://api.github.com/users/Buktoria/following{/other_user}","gists_url":"https://api.github.com/users/Buktoria/gists{/gist_id}","starred_url":"https://api.github.com/users/Buktoria/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Buktoria/subscriptions","organizations_url":"https://api.github.com/users/Buktoria/orgs","repos_url":"https://api.github.com/users/Buktoria/repos","events_url":"https://api.github.com/users/Buktoria/events{/privacy}","received_events_url":"https://api.github.com/users/Buktoria/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T00:16:03Z","updated_at":"2023-03-13T00:16:03Z","author_association":"CONTRIBUTOR","body":"@Fokko This PR is ready to be reviewed","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465342003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465583790","html_url":"https://github.com/apache/iceberg/issues/1883#issuecomment-1465583790","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1883","id":1465583790,"node_id":"IC_kwDOCW7NX85XWwiu","user":{"login":"hulin-ola","id":113100635,"node_id":"U_kgDOBr3HWw","avatar_url":"https://avatars.githubusercontent.com/u/113100635?v=4","gravatar_id":"","url":"https://api.github.com/users/hulin-ola","html_url":"https://github.com/hulin-ola","followers_url":"https://api.github.com/users/hulin-ola/followers","following_url":"https://api.github.com/users/hulin-ola/following{/other_user}","gists_url":"https://api.github.com/users/hulin-ola/gists{/gist_id}","starred_url":"https://api.github.com/users/hulin-ola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hulin-ola/subscriptions","organizations_url":"https://api.github.com/users/hulin-ola/orgs","repos_url":"https://api.github.com/users/hulin-ola/repos","events_url":"https://api.github.com/users/hulin-ola/events{/privacy}","received_events_url":"https://api.github.com/users/hulin-ola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T06:29:27Z","updated_at":"2023-03-13T06:29:27Z","author_association":"NONE","body":"ALTER TABLE `hive_catalog`.`test`.`sample` SET ('engine.hive.enabled'='true');\r\n add  above table properties to your table","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465583790/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465638582","html_url":"https://github.com/apache/iceberg/issues/6306#issuecomment-1465638582","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6306","id":1465638582,"node_id":"IC_kwDOCW7NX85XW962","user":{"login":"sweetpythoncode","id":29664369,"node_id":"MDQ6VXNlcjI5NjY0MzY5","avatar_url":"https://avatars.githubusercontent.com/u/29664369?v=4","gravatar_id":"","url":"https://api.github.com/users/sweetpythoncode","html_url":"https://github.com/sweetpythoncode","followers_url":"https://api.github.com/users/sweetpythoncode/followers","following_url":"https://api.github.com/users/sweetpythoncode/following{/other_user}","gists_url":"https://api.github.com/users/sweetpythoncode/gists{/gist_id}","starred_url":"https://api.github.com/users/sweetpythoncode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sweetpythoncode/subscriptions","organizations_url":"https://api.github.com/users/sweetpythoncode/orgs","repos_url":"https://api.github.com/users/sweetpythoncode/repos","events_url":"https://api.github.com/users/sweetpythoncode/events{/privacy}","received_events_url":"https://api.github.com/users/sweetpythoncode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T07:28:35Z","updated_at":"2023-03-13T07:34:47Z","author_association":"NONE","body":"Also would like to use a procedure like this cc @RussellSpitzer @szehon-ho. Now if u want to add these files you should run `delete from table where 1=1` before add files, otherwise, you will have double `record_count` and `file_size` in metadata each time you add ALL files with `(check_duplicate_files => false)`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465638582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465702218","html_url":"https://github.com/apache/iceberg/pull/7081#issuecomment-1465702218","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7081","id":1465702218,"node_id":"IC_kwDOCW7NX85XXNdK","user":{"login":"electrum","id":9230,"node_id":"MDQ6VXNlcjkyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9230?v=4","gravatar_id":"","url":"https://api.github.com/users/electrum","html_url":"https://github.com/electrum","followers_url":"https://api.github.com/users/electrum/followers","following_url":"https://api.github.com/users/electrum/following{/other_user}","gists_url":"https://api.github.com/users/electrum/gists{/gist_id}","starred_url":"https://api.github.com/users/electrum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/electrum/subscriptions","organizations_url":"https://api.github.com/users/electrum/orgs","repos_url":"https://api.github.com/users/electrum/repos","events_url":"https://api.github.com/users/electrum/events{/privacy}","received_events_url":"https://api.github.com/users/electrum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T08:25:19Z","updated_at":"2023-03-13T08:25:19Z","author_association":"CONTRIBUTOR","body":"Replaced by #7087 and #7088","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465702218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465705026","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1465705026","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1465705026,"node_id":"IC_kwDOCW7NX85XXOJC","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T08:27:33Z","updated_at":"2023-03-13T08:27:33Z","author_association":"CONTRIBUTOR","body":"see:https://iceberg.apache.org/docs/latest/flink/#rewrite-files-action","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465705026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465792578","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1465792578","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1465792578,"node_id":"IC_kwDOCW7NX85XXjhC","user":{"login":"luxl6","id":101870212,"node_id":"U_kgDOBhJqhA","avatar_url":"https://avatars.githubusercontent.com/u/101870212?v=4","gravatar_id":"","url":"https://api.github.com/users/luxl6","html_url":"https://github.com/luxl6","followers_url":"https://api.github.com/users/luxl6/followers","following_url":"https://api.github.com/users/luxl6/following{/other_user}","gists_url":"https://api.github.com/users/luxl6/gists{/gist_id}","starred_url":"https://api.github.com/users/luxl6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luxl6/subscriptions","organizations_url":"https://api.github.com/users/luxl6/orgs","repos_url":"https://api.github.com/users/luxl6/repos","events_url":"https://api.github.com/users/luxl6/events{/privacy}","received_events_url":"https://api.github.com/users/luxl6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T09:30:14Z","updated_at":"2023-03-13T09:30:14Z","author_association":"NONE","body":"> 参见：https://iceberg.apache.org/docs/latest/flink/#rewrite-files-action\r\n\r\nException in thread \"main\" org.apache.iceberg.exceptions.NoSuchTableException: Table does not exist at location: s3a://iceberg/flink_db/flink_hb\r\n\tat org.apache.iceberg.hadoop.HadoopTables.load(HadoopTables.java:97)\r\n\tat org.apache.iceberg.flink.TableLoader$HadoopTableLoader.loadTable(TableLoader.java:76)\r\n一直报表不存在，我的catalog用的是jdbc模式存在了pgsql,数据存在了minio里面，这个怎么做呢？？","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465792578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465793922","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1465793922","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1465793922,"node_id":"IC_kwDOCW7NX85XXj2C","user":{"login":"luxl6","id":101870212,"node_id":"U_kgDOBhJqhA","avatar_url":"https://avatars.githubusercontent.com/u/101870212?v=4","gravatar_id":"","url":"https://api.github.com/users/luxl6","html_url":"https://github.com/luxl6","followers_url":"https://api.github.com/users/luxl6/followers","following_url":"https://api.github.com/users/luxl6/following{/other_user}","gists_url":"https://api.github.com/users/luxl6/gists{/gist_id}","starred_url":"https://api.github.com/users/luxl6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luxl6/subscriptions","organizations_url":"https://api.github.com/users/luxl6/orgs","repos_url":"https://api.github.com/users/luxl6/repos","events_url":"https://api.github.com/users/luxl6/events{/privacy}","received_events_url":"https://api.github.com/users/luxl6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T09:31:13Z","updated_at":"2023-03-13T09:31:13Z","author_association":"NONE","body":"> 参见：https://iceberg.apache.org/docs/latest/flink/#rewrite-files-action\r\n\r\n官网这个说的是Hadoop的吧，大佬们，求指教","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465793922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465813401","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1465813401","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1465813401,"node_id":"IC_kwDOCW7NX85XXomZ","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T09:44:47Z","updated_at":"2023-03-13T09:44:47Z","author_association":"CONTRIBUTOR","body":"@luxl6 I suggest you use English. No one here uses Chinese","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465813401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465816702","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1465816702","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1465816702,"node_id":"IC_kwDOCW7NX85XXpZ-","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T09:47:08Z","updated_at":"2023-03-13T09:48:08Z","author_association":"CONTRIBUTOR","body":">官网这个说的是Hadoop的吧，大佬们，求指教\r\n\r\nYou can access minio implementation rewrite using the s3 protocol.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465816702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465862622","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1465862622","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1465862622,"node_id":"IC_kwDOCW7NX85XX0ne","user":{"login":"luxl6","id":101870212,"node_id":"U_kgDOBhJqhA","avatar_url":"https://avatars.githubusercontent.com/u/101870212?v=4","gravatar_id":"","url":"https://api.github.com/users/luxl6","html_url":"https://github.com/luxl6","followers_url":"https://api.github.com/users/luxl6/followers","following_url":"https://api.github.com/users/luxl6/following{/other_user}","gists_url":"https://api.github.com/users/luxl6/gists{/gist_id}","starred_url":"https://api.github.com/users/luxl6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luxl6/subscriptions","organizations_url":"https://api.github.com/users/luxl6/orgs","repos_url":"https://api.github.com/users/luxl6/repos","events_url":"https://api.github.com/users/luxl6/events{/privacy}","received_events_url":"https://api.github.com/users/luxl6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T10:15:09Z","updated_at":"2023-03-13T10:15:09Z","author_association":"NONE","body":"> 参见：https://iceberg.apache.org/docs/latest/flink/#rewrite-files-action\r\n线程 “main” org.apache.iceberg.exceptions.NoSuchTableException： Table 在 location： s3a：//iceberg/flink_db/flink_hb at org.apache.iceberg.hadoop.HadoopTables.load（HadoopTables.java：97）\r\nat org.apache.iceberg.flink.TableLoader$HadoopTableLoader.loadTable（TableLoader.java：76）\r\n\r\n\r\nThe report does not exist, my catalog uses jdbc mode, pgsql exists, and the data exists in minio, how do I merge data? ?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465862622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465864266","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1465864266","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1465864266,"node_id":"IC_kwDOCW7NX85XX1BK","user":{"login":"luxl6","id":101870212,"node_id":"U_kgDOBhJqhA","avatar_url":"https://avatars.githubusercontent.com/u/101870212?v=4","gravatar_id":"","url":"https://api.github.com/users/luxl6","html_url":"https://github.com/luxl6","followers_url":"https://api.github.com/users/luxl6/followers","following_url":"https://api.github.com/users/luxl6/following{/other_user}","gists_url":"https://api.github.com/users/luxl6/gists{/gist_id}","starred_url":"https://api.github.com/users/luxl6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luxl6/subscriptions","organizations_url":"https://api.github.com/users/luxl6/orgs","repos_url":"https://api.github.com/users/luxl6/repos","events_url":"https://api.github.com/users/luxl6/events{/privacy}","received_events_url":"https://api.github.com/users/luxl6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T10:16:16Z","updated_at":"2023-03-13T10:16:16Z","author_association":"NONE","body":"\r\n\r\n\r\n\r\n> 参见：https://iceberg.apache.org/docs/latest/flink/#rewrite-files-action\r\nThe official website is about Hadoop.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465864266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465867360","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1465867360","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1465867360,"node_id":"IC_kwDOCW7NX85XX1xg","user":{"login":"luxl6","id":101870212,"node_id":"U_kgDOBhJqhA","avatar_url":"https://avatars.githubusercontent.com/u/101870212?v=4","gravatar_id":"","url":"https://api.github.com/users/luxl6","html_url":"https://github.com/luxl6","followers_url":"https://api.github.com/users/luxl6/followers","following_url":"https://api.github.com/users/luxl6/following{/other_user}","gists_url":"https://api.github.com/users/luxl6/gists{/gist_id}","starred_url":"https://api.github.com/users/luxl6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luxl6/subscriptions","organizations_url":"https://api.github.com/users/luxl6/orgs","repos_url":"https://api.github.com/users/luxl6/repos","events_url":"https://api.github.com/users/luxl6/events{/privacy}","received_events_url":"https://api.github.com/users/luxl6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T10:18:23Z","updated_at":"2023-03-13T10:18:23Z","author_association":"NONE","body":" org.apache.hadoop.fs.UnsupportedFileSystemException: No FileSystem for scheme \"s3\"\r\n\r\nDoes Hadoop not support the s3 protocol?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465867360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465869105","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1465869105","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1465869105,"node_id":"IC_kwDOCW7NX85XX2Mx","user":{"login":"luxl6","id":101870212,"node_id":"U_kgDOBhJqhA","avatar_url":"https://avatars.githubusercontent.com/u/101870212?v=4","gravatar_id":"","url":"https://api.github.com/users/luxl6","html_url":"https://github.com/luxl6","followers_url":"https://api.github.com/users/luxl6/followers","following_url":"https://api.github.com/users/luxl6/following{/other_user}","gists_url":"https://api.github.com/users/luxl6/gists{/gist_id}","starred_url":"https://api.github.com/users/luxl6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luxl6/subscriptions","organizations_url":"https://api.github.com/users/luxl6/orgs","repos_url":"https://api.github.com/users/luxl6/repos","events_url":"https://api.github.com/users/luxl6/events{/privacy}","received_events_url":"https://api.github.com/users/luxl6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T10:19:17Z","updated_at":"2023-03-13T10:19:17Z","author_association":"NONE","body":"You can access minio implementation rewrite using the s3 protocol.\r\n\r\nHow to do this? ? ask for advice","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465869105/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465869375","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1465869375","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1465869375,"node_id":"IC_kwDOCW7NX85XX2Q_","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T10:19:26Z","updated_at":"2023-03-13T10:19:26Z","author_association":"CONTRIBUTOR","body":"You need aws dependency","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465869375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465880663","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1465880663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1465880663,"node_id":"IC_kwDOCW7NX85XX5BX","user":{"login":"luxl6","id":101870212,"node_id":"U_kgDOBhJqhA","avatar_url":"https://avatars.githubusercontent.com/u/101870212?v=4","gravatar_id":"","url":"https://api.github.com/users/luxl6","html_url":"https://github.com/luxl6","followers_url":"https://api.github.com/users/luxl6/followers","following_url":"https://api.github.com/users/luxl6/following{/other_user}","gists_url":"https://api.github.com/users/luxl6/gists{/gist_id}","starred_url":"https://api.github.com/users/luxl6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luxl6/subscriptions","organizations_url":"https://api.github.com/users/luxl6/orgs","repos_url":"https://api.github.com/users/luxl6/repos","events_url":"https://api.github.com/users/luxl6/events{/privacy}","received_events_url":"https://api.github.com/users/luxl6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T10:27:28Z","updated_at":"2023-03-13T10:27:28Z","author_association":"NONE","body":"> You need aws dependency\r\n\r\n<properties>\r\n        <maven.compiler.source>8</maven.compiler.source>\r\n        <maven.compiler.target>8</maven.compiler.target>\r\n        <scala.version>2.12</scala.version>\r\n        <flink.version>1.15.3</flink.version>\r\n        <hadoop.version>3.3.1</hadoop.version>\r\n    </properties>\r\n\r\n    <dependencies>\r\n        <!-- Flink SQL & Table-->\r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-table-runtime</artifactId>\r\n            <version>${flink.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-table-common</artifactId>\r\n            <version>${flink.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-table-api-java</artifactId>\r\n            <version>${flink.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-table-planner_${scala.version}</artifactId>\r\n            <version>${flink.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n\r\n        <dependency>\r\n            <groupId>junit</groupId>\r\n            <artifactId>junit</artifactId>\r\n            <version>4.11</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n\r\n        <!--        flink 环境包-->\r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-java</artifactId>\r\n            <version>${flink.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-streaming-java</artifactId>\r\n            <version>${flink.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-clients</artifactId>\r\n            <version>${flink.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n\r\n        <!-- https://mvnrepository.com/artifact/org.apache.flink/flink-s3-fs-hadoop -->\r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-s3-fs-hadoop</artifactId>\r\n            <version>${flink.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n\r\n\r\n\r\n        <!--        flink连接jdbc-->\r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-connector-jdbc</artifactId>\r\n            <version>${flink.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n\r\n       \r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-connector-hive_2.12</artifactId>\r\n            <version>${flink.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-table-api-java-bridge</artifactId>\r\n            <version>${flink.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n\r\n        <dependency>\r\n            <groupId>org.apache.hadoop</groupId>\r\n            <artifactId>hadoop-client</artifactId>\r\n            <version>${hadoop.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.hadoop</groupId>\r\n            <artifactId>hadoop-common</artifactId>\r\n            <version>${hadoop.version}</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n\r\n        <!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-hdfs-client -->\r\n        <dependency>\r\n            <groupId>org.apache.hadoop</groupId>\r\n            <artifactId>hadoop-hdfs-client</artifactId>\r\n            <version>${hadoop.version}</version>\r\n        </dependency>\r\n\r\n        <!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-mapreduce-client-core -->\r\n        <dependency>\r\n            <groupId>org.apache.hadoop</groupId>\r\n            <artifactId>hadoop-mapreduce-client-core</artifactId>\r\n            <version>3.3.1</version>\r\n        </dependency>\r\n\r\n\r\n        <!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-aws -->\r\n <dependency>\r\n            <groupId>org.apache.hadoop</groupId>\r\n            <artifactId>hadoop-aws</artifactId>\r\n            <version>${hadoop.version}</version>\r\n        </dependency>\r\n        <!-- https://mvnrepository.com/artifact/com.amazonaws/aws-java-sdk-bundle -->\r\n        <dependency>\r\n            <groupId>com.amazonaws</groupId>\r\n            <artifactId>aws-java-sdk-bundle</artifactId>\r\n            <version>1.11.271</version>\r\n        </dependency>\r\n\r\n\r\n\r\n        <!-- Hive Dependency -->\r\n        <dependency>\r\n            <groupId>org.apache.hive</groupId>\r\n            <artifactId>hive-exec</artifactId>\r\n            <version>2.3.9</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n\r\n\r\n        <!-- mongodb -->\r\n\r\n\r\n        <!-- HBase -->\r\n        <dependency>\r\n            <groupId>org.apache.flink</groupId>\r\n            <artifactId>flink-sql-connector-hbase-2.2</artifactId>\r\n            <version>${flink.version}</version>\r\n            <scope>provided</scope>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.hbase</groupId>\r\n            <artifactId>hbase-server</artifactId>\r\n            <version>1.2.4</version>\r\n            <scope>provided</scope>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.hbase</groupId>\r\n            <artifactId>hbase-client</artifactId>\r\n            <version>1.2.4</version>\r\n            <scope>provided</scope>\r\n        </dependency>\r\n\r\n        <!-- Flink 操作Iceberg 需要的Iceberg依赖 minio连接包-->\r\n        <dependency>\r\n            <groupId>iceberg</groupId>\r\n            <artifactId>iceberg-flink-runtime-1.15</artifactId>\r\n            <version>1.1.0</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>iceberg</groupId>\r\n            <artifactId>bundle</artifactId>\r\n            <version>2.17.257</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>software.amazon.awssdk</groupId>\r\n            <artifactId>url-connection-client</artifactId>\r\n            <version>2.17.257</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n\r\n        <!--      postgresql连接  -->\r\n        <dependency>\r\n            <groupId>org.postgresql</groupId>\r\n            <artifactId>postgresql</artifactId>\r\n            <version>42.5.1</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n        <!--mysql连接        -->\r\n        <dependency>\r\n            <groupId>org.apache</groupId>\r\n            <artifactId>mysql-connector-java</artifactId>\r\n            <version>5.1.48</version>\r\n<!--            <scope>provided</scope>-->\r\n        </dependency>\r\n    </dependencies>\r\n\r\n\r\nThis is all my dependencies, can you see which one is missing","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465880663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465909953","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1465909953","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1465909953,"node_id":"IC_kwDOCW7NX85XYALB","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T10:49:22Z","updated_at":"2023-03-13T10:49:22Z","author_association":"MEMBER","body":">  While the code looks technically correct, this change introduces an unnecessary extra round-trip. Usually, people work on the HEAD of a Nessie branch, which, for most Nessie operations, does not require the client to know the HEAD's commit-ID and pass it back to the server.\r\nIMO the NessieIcebergClient needs to be able to handle the case of referencing the HEAD of a branch for NessieCatalog (and only pass the branch/tag name to the Nessie server), but be able provide an instance of NessieIcebergClient with the expected hash / commit ID for newTableOps, renameTable, dropTable, etc.\r\n\r\n@snazy, @dimas-b, @nastra: I have avoided the unnecessary extra round-trip by fixing it differently than before. Please take a look. Thanks. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465909953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466036908","html_url":"https://github.com/apache/iceberg/pull/6698#issuecomment-1466036908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6698","id":1466036908,"node_id":"IC_kwDOCW7NX85XYfKs","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T12:15:27Z","updated_at":"2023-03-13T12:15:27Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho @nastra for your comments. I've updated the PR. Let me know if I missed anything","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466036908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466089293","html_url":"https://github.com/apache/iceberg/issues/540#issuecomment-1466089293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/540","id":1466089293,"node_id":"IC_kwDOCW7NX85XYr9N","user":{"login":"tabdulradi","id":725206,"node_id":"MDQ6VXNlcjcyNTIwNg==","avatar_url":"https://avatars.githubusercontent.com/u/725206?v=4","gravatar_id":"","url":"https://api.github.com/users/tabdulradi","html_url":"https://github.com/tabdulradi","followers_url":"https://api.github.com/users/tabdulradi/followers","following_url":"https://api.github.com/users/tabdulradi/following{/other_user}","gists_url":"https://api.github.com/users/tabdulradi/gists{/gist_id}","starred_url":"https://api.github.com/users/tabdulradi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tabdulradi/subscriptions","organizations_url":"https://api.github.com/users/tabdulradi/orgs","repos_url":"https://api.github.com/users/tabdulradi/repos","events_url":"https://api.github.com/users/tabdulradi/events{/privacy}","received_events_url":"https://api.github.com/users/tabdulradi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T12:53:14Z","updated_at":"2023-03-13T12:53:14Z","author_association":"NONE","body":"@rdblue This issue can now be closed as it's implemented via https://github.com/apache/iceberg/pull/4154, right?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466089293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466196600","html_url":"https://github.com/apache/iceberg/pull/6962#issuecomment-1466196600","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6962","id":1466196600,"node_id":"IC_kwDOCW7NX85XZGJ4","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T13:59:25Z","updated_at":"2023-03-13T13:59:25Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi could you review this one please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466196600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466210109","html_url":"https://github.com/apache/iceberg/pull/7045#issuecomment-1466210109","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7045","id":1466210109,"node_id":"IC_kwDOCW7NX85XZJc9","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T14:06:51Z","updated_at":"2023-03-13T15:13:36Z","author_association":"MEMBER","body":"Today also people's build is failing \r\n- https://github.com/apache/iceberg/actions/runs/4405031999/jobs/7715415485\r\n- https://github.com/apache/iceberg/actions/runs/4405434484\r\n\r\nI think we need to merge/review this. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466210109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466217487","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1466217487","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1466217487,"node_id":"IC_kwDOCW7NX85XZLQP","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T14:10:55Z","updated_at":"2023-03-13T14:10:55Z","author_association":"MEMBER","body":"> This change adds too many unnecessary code changes. Most of the changes aren't justified, the required fix can likely be achieved with way less changes. The current PR also doesn't clean up renameTable wrt the scope of this PR.\r\n\r\n@snazy: I gave it another try. Please take a look. Also the `renameTable` and `dropTable` was not going via `TableOperations`. So, I have handled it similarly to the existing `commitTable` logic now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466217487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466262033","html_url":"https://github.com/apache/iceberg/issues/7065#issuecomment-1466262033","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7065","id":1466262033,"node_id":"IC_kwDOCW7NX85XZWIR","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T14:36:53Z","updated_at":"2023-03-13T15:35:54Z","author_association":"CONTRIBUTOR","body":"I debugged this test locally, and found that it didn't run `canDeleteWhere`, I think this is because the expression in the test cannot be pushed down, after I changed the expression to `complex.c1 = 2`, it threw the same exception. I think exception is unexpected, since this test case already shows that deleting via filter on nested fields is possible (without running `canDeleteUsingMetadata`). But this exception is thrown because `StrictMetricsEvaluator ` cannot handle nested fields. \r\nI think we can make `StrictMetricsEvaluator` handle nested fileds properly to solve this, I think we can remove the nested fields check in `StrictMetricsEvaluator` directly, it seems safe to me, @rdblue can you please confirm this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466262033/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466262308","html_url":"https://github.com/apache/iceberg/pull/6512#issuecomment-1466262308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6512","id":1466262308,"node_id":"IC_kwDOCW7NX85XZWMk","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T14:37:02Z","updated_at":"2023-03-13T14:37:02Z","author_association":"CONTRIBUTOR","body":"@krvikash looks like CI is failing on this one","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466262308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466336822","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1466336822","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1466336822,"node_id":"IC_kwDOCW7NX85XZoY2","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T15:11:31Z","updated_at":"2023-03-13T15:12:56Z","author_association":"MEMBER","body":"one of the builds failed due to #7023 \r\n\r\nhttps://github.com/apache/iceberg/actions/runs/4405434484\r\n\r\nre-triggering the build. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466336822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466490974","html_url":"https://github.com/apache/iceberg/issues/7095#issuecomment-1466490974","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7095","id":1466490974,"node_id":"IC_kwDOCW7NX85XaOBe","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T16:36:59Z","updated_at":"2023-03-13T16:36:59Z","author_association":"CONTRIBUTOR","body":"I opened https://github.com/apache/iceberg/issues/7040 already a few days ago, so I think we can close this one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466490974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466499835","html_url":"https://github.com/apache/iceberg/issues/7095#issuecomment-1466499835","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7095","id":1466499835,"node_id":"IC_kwDOCW7NX85XaQL7","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T16:42:29Z","updated_at":"2023-03-13T16:42:29Z","author_association":"CONTRIBUTOR","body":"ah I see I overlooked that, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466499835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466571683","html_url":"https://github.com/apache/iceberg/issues/7067#issuecomment-1466571683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7067","id":1466571683,"node_id":"IC_kwDOCW7NX85Xahuj","user":{"login":"asheeshgarg","id":4348671,"node_id":"MDQ6VXNlcjQzNDg2NzE=","avatar_url":"https://avatars.githubusercontent.com/u/4348671?v=4","gravatar_id":"","url":"https://api.github.com/users/asheeshgarg","html_url":"https://github.com/asheeshgarg","followers_url":"https://api.github.com/users/asheeshgarg/followers","following_url":"https://api.github.com/users/asheeshgarg/following{/other_user}","gists_url":"https://api.github.com/users/asheeshgarg/gists{/gist_id}","starred_url":"https://api.github.com/users/asheeshgarg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asheeshgarg/subscriptions","organizations_url":"https://api.github.com/users/asheeshgarg/orgs","repos_url":"https://api.github.com/users/asheeshgarg/repos","events_url":"https://api.github.com/users/asheeshgarg/events{/privacy}","received_events_url":"https://api.github.com/users/asheeshgarg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T17:16:46Z","updated_at":"2023-03-13T17:16:46Z","author_association":"NONE","body":"@Fokko sure schema evolution is definitely a challenge. Interesting to know 0.4.0 support for the partitioning pruning using metadata. Do we have PR where we can see this.\r\nAlso if it will be great to have RUST support for the platform. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466571683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466586171","html_url":"https://github.com/apache/iceberg/pull/7088#issuecomment-1466586171","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7088","id":1466586171,"node_id":"IC_kwDOCW7NX85XalQ7","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T17:25:27Z","updated_at":"2023-03-13T17:25:27Z","author_association":"CONTRIBUTOR","body":"This looks good, except that I think we should pass `SessionContext` rather than the wrapped identity directly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466586171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466587873","html_url":"https://github.com/apache/iceberg/pull/7066#issuecomment-1466587873","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7066","id":1466587873,"node_id":"IC_kwDOCW7NX85Xalrh","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T17:26:23Z","updated_at":"2023-03-13T17:26:23Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar can you take a look at this? Looks we can also close #6847 using this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466587873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466589215","html_url":"https://github.com/apache/iceberg/pull/7087#issuecomment-1466589215","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7087","id":1466589215,"node_id":"IC_kwDOCW7NX85XamAf","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T17:27:20Z","updated_at":"2023-03-13T17:27:20Z","author_association":"CONTRIBUTOR","body":"Thanks, @electrum! Merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466589215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466607782","html_url":"https://github.com/apache/iceberg/pull/7090#issuecomment-1466607782","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7090","id":1466607782,"node_id":"IC_kwDOCW7NX85Xaqim","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T17:40:19Z","updated_at":"2023-03-13T17:40:19Z","author_association":"CONTRIBUTOR","body":"IIUC, is the idea behind this pr to use the primitive type when creating Arrow vectors rather than always using decimal vectors ? \r\n\r\nWondering if it's same as: \r\n\r\n* https://github.com/apache/iceberg/pull/3249\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466607782/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466627951","html_url":"https://github.com/apache/iceberg/pull/4479#issuecomment-1466627951","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4479","id":1466627951,"node_id":"IC_kwDOCW7NX85Xavdv","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T17:51:56Z","updated_at":"2023-03-13T17:51:56Z","author_association":"CONTRIBUTOR","body":"> @singhpk234 it's looking good. Just a few more small changes are suggested. Do you think you'll have time to address them next week. Cheers\r\n\r\nDefinitely @cccs-jc ! Will address these feedback by end of this week as well as raise this against 3.3. Apologies have been keeping busy due to some internal deliverables ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466627951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466632758","html_url":"https://github.com/apache/iceberg/pull/7088#issuecomment-1466632758","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7088","id":1466632758,"node_id":"IC_kwDOCW7NX85Xawo2","user":{"login":"electrum","id":9230,"node_id":"MDQ6VXNlcjkyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9230?v=4","gravatar_id":"","url":"https://api.github.com/users/electrum","html_url":"https://github.com/electrum","followers_url":"https://api.github.com/users/electrum/followers","following_url":"https://api.github.com/users/electrum/following{/other_user}","gists_url":"https://api.github.com/users/electrum/gists{/gist_id}","starred_url":"https://api.github.com/users/electrum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/electrum/subscriptions","organizations_url":"https://api.github.com/users/electrum/orgs","repos_url":"https://api.github.com/users/electrum/repos","events_url":"https://api.github.com/users/electrum/events{/privacy}","received_events_url":"https://api.github.com/users/electrum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T17:55:34Z","updated_at":"2023-03-13T17:55:34Z","author_association":"CONTRIBUTOR","body":"Thanks for the review. Updated.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466632758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466683586","html_url":"https://github.com/apache/iceberg/issues/7094#issuecomment-1466683586","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7094","id":1466683586,"node_id":"IC_kwDOCW7NX85Xa9DC","user":{"login":"liuxiaocs7","id":42756849,"node_id":"MDQ6VXNlcjQyNzU2ODQ5","avatar_url":"https://avatars.githubusercontent.com/u/42756849?v=4","gravatar_id":"","url":"https://api.github.com/users/liuxiaocs7","html_url":"https://github.com/liuxiaocs7","followers_url":"https://api.github.com/users/liuxiaocs7/followers","following_url":"https://api.github.com/users/liuxiaocs7/following{/other_user}","gists_url":"https://api.github.com/users/liuxiaocs7/gists{/gist_id}","starred_url":"https://api.github.com/users/liuxiaocs7/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liuxiaocs7/subscriptions","organizations_url":"https://api.github.com/users/liuxiaocs7/orgs","repos_url":"https://api.github.com/users/liuxiaocs7/repos","events_url":"https://api.github.com/users/liuxiaocs7/events{/privacy}","received_events_url":"https://api.github.com/users/liuxiaocs7/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T18:23:26Z","updated_at":"2023-03-13T18:23:26Z","author_association":"MEMBER","body":"@jackye1995 I would like to work on this. Can you assign it to me?\r\nI think this can start after #6977 is merged, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466683586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466748999","html_url":"https://github.com/apache/iceberg/issues/7094#issuecomment-1466748999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7094","id":1466748999,"node_id":"IC_kwDOCW7NX85XbNBH","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T18:50:41Z","updated_at":"2023-03-13T18:50:41Z","author_association":"CONTRIBUTOR","body":"Sure, we should be merging it very soon, I can assign this to you","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466748999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466985021","html_url":"https://github.com/apache/iceberg/issues/6306#issuecomment-1466985021","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6306","id":1466985021,"node_id":"IC_kwDOCW7NX85XcGo9","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T21:25:23Z","updated_at":"2023-03-13T21:25:59Z","author_association":"COLLABORATOR","body":"Yea at the time, I didn't see a huge use case where a folder has some files already added but not all.  Curious, if you can share the use case.\r\n\r\nYea the problem with things like this is once its implemented, its a bit hard to change.  \r\n\r\nI guess if we really want it , we could have an argument like 'duplicate_file_mode' which would take option 'allow', 'error', 'skip'.  and we could probably deprecate 'check_duplicate'.  Not sure what @RussellSpitzer thinks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1466985021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467048101","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1467048101","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1467048101,"node_id":"IC_kwDOCW7NX85XcWCl","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T22:19:29Z","updated_at":"2023-03-13T22:19:29Z","author_association":"COLLABORATOR","body":"OK I will probably need to look a little more, to be sure its safe.  I will tag @RussellSpitzer as well to take a look, as he seems a little more familiar than me on this area.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467048101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467097023","html_url":"https://github.com/apache/iceberg/pull/6977#issuecomment-1467097023","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6977","id":1467097023,"node_id":"IC_kwDOCW7NX85Xch-_","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T23:05:12Z","updated_at":"2023-03-13T23:05:12Z","author_association":"CONTRIBUTOR","body":"@nastra, @jackye1995 I merged this. It will be a good move, but we have to make sure we are catching the message validation in reviews!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467097023/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467100322","html_url":"https://github.com/apache/iceberg/pull/7046#issuecomment-1467100322","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7046","id":1467100322,"node_id":"IC_kwDOCW7NX85Xciyi","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T23:08:08Z","updated_at":"2023-03-13T23:08:08Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467100322/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467111378","html_url":"https://github.com/apache/iceberg/pull/7050#issuecomment-1467111378","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7050","id":1467111378,"node_id":"IC_kwDOCW7NX85XclfS","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T23:20:22Z","updated_at":"2023-03-13T23:20:22Z","author_association":"CONTRIBUTOR","body":"Thanks @jackye1995! Looks great.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467111378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467126295","html_url":"https://github.com/apache/iceberg/pull/7004#issuecomment-1467126295","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7004","id":1467126295,"node_id":"IC_kwDOCW7NX85XcpIX","user":{"login":"manisin","id":21346391,"node_id":"MDQ6VXNlcjIxMzQ2Mzkx","avatar_url":"https://avatars.githubusercontent.com/u/21346391?v=4","gravatar_id":"","url":"https://api.github.com/users/manisin","html_url":"https://github.com/manisin","followers_url":"https://api.github.com/users/manisin/followers","following_url":"https://api.github.com/users/manisin/following{/other_user}","gists_url":"https://api.github.com/users/manisin/gists{/gist_id}","starred_url":"https://api.github.com/users/manisin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manisin/subscriptions","organizations_url":"https://api.github.com/users/manisin/orgs","repos_url":"https://api.github.com/users/manisin/repos","events_url":"https://api.github.com/users/manisin/events{/privacy}","received_events_url":"https://api.github.com/users/manisin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T23:42:31Z","updated_at":"2023-03-13T23:43:30Z","author_association":"CONTRIBUTOR","body":"> overall this LGTM now. Would be good to setup the yml for running the integration test and the secrets in GH so that we could actually see whether the tests pass\r\n\r\n\r\n\r\nThanks for the review and suggestions @nastra! It would take some wall clock time to get through internal review process for sharing a deployment and onboarding the secrets to github. So, I want to separate out the creation of a new workflow via yml in another PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467126295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467126628","html_url":"https://github.com/apache/iceberg/pull/7090#issuecomment-1467126628","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7090","id":1467126628,"node_id":"IC_kwDOCW7NX85XcpNk","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T23:43:03Z","updated_at":"2023-03-13T23:54:23Z","author_association":"CONTRIBUTOR","body":"@singhpk234 opps...it is similar to my PR (my PR only handles long case). The main problem is how to build java BigInterger. The cost of constructing java `BigDecimal` in the original way is too high. I have a  iceberg benchmark flame graph:\r\n![image](https://user-images.githubusercontent.com/31469905/224855414-411304bb-f160-445a-9cd9-6e2882a5bf72.png)\r\n\r\nActually we can build decimal from `Long`. Spark does the same ( this is why spark is faster than Iceberg), you can see https://github.com/apache/spark/blob/1d2c338c867c69987d8ed1f3666358af54a040e3/sql/core/src/main/java/org/apache/spark/sql/execution/vectorized/WritableColumnVector.java#L395-L408\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467126628/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467151896","html_url":"https://github.com/apache/iceberg/issues/5764#issuecomment-1467151896","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5764","id":1467151896,"node_id":"IC_kwDOCW7NX85XcvYY","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T00:11:14Z","updated_at":"2023-03-14T00:11:14Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467151896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467151941","html_url":"https://github.com/apache/iceberg/issues/5673#issuecomment-1467151941","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5673","id":1467151941,"node_id":"IC_kwDOCW7NX85XcvZF","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T00:11:19Z","updated_at":"2023-03-14T00:11:19Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467151941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467151965","html_url":"https://github.com/apache/iceberg/issues/5630#issuecomment-1467151965","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5630","id":1467151965,"node_id":"IC_kwDOCW7NX85XcvZd","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T00:11:21Z","updated_at":"2023-03-14T00:11:21Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467151965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467195544","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1467195544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1467195544,"node_id":"IC_kwDOCW7NX85Xc6CY","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T01:13:52Z","updated_at":"2023-03-14T01:13:52Z","author_association":"CONTRIBUTOR","body":" hadoop-aws aws-java-sdk-bundle 1.11.271 Does it exist?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467195544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467224585","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1467224585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1467224585,"node_id":"IC_kwDOCW7NX85XdBIJ","user":{"login":"luxl6","id":101870212,"node_id":"U_kgDOBhJqhA","avatar_url":"https://avatars.githubusercontent.com/u/101870212?v=4","gravatar_id":"","url":"https://api.github.com/users/luxl6","html_url":"https://github.com/luxl6","followers_url":"https://api.github.com/users/luxl6/followers","following_url":"https://api.github.com/users/luxl6/following{/other_user}","gists_url":"https://api.github.com/users/luxl6/gists{/gist_id}","starred_url":"https://api.github.com/users/luxl6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luxl6/subscriptions","organizations_url":"https://api.github.com/users/luxl6/orgs","repos_url":"https://api.github.com/users/luxl6/repos","events_url":"https://api.github.com/users/luxl6/events{/privacy}","received_events_url":"https://api.github.com/users/luxl6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T01:54:45Z","updated_at":"2023-03-14T01:54:45Z","author_association":"NONE","body":" <!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-aws -->\r\n        <dependency>\r\n            <groupId>org.apache.hadoop</groupId>\r\n            <artifactId>hadoop-aws</artifactId>\r\n            <version>${hadoop.version}</version>\r\n        </dependency>\r\n        <!-- https://mvnrepository.com/artifact/com.amazonaws/aws-java-sdk-bundle -->\r\n        <dependency>\r\n            <groupId>com.amazonaws</groupId>\r\n            <artifactId>aws-java-sdk-bundle</artifactId>\r\n            <version>1.11.271</version>\r\n        </dependency>\r\n\r\nexist   My Hadoop is 3.3.1\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467224585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467225621","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1467225621","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1467225621,"node_id":"IC_kwDOCW7NX85XdBYV","user":{"login":"luxl6","id":101870212,"node_id":"U_kgDOBhJqhA","avatar_url":"https://avatars.githubusercontent.com/u/101870212?v=4","gravatar_id":"","url":"https://api.github.com/users/luxl6","html_url":"https://github.com/luxl6","followers_url":"https://api.github.com/users/luxl6/followers","following_url":"https://api.github.com/users/luxl6/following{/other_user}","gists_url":"https://api.github.com/users/luxl6/gists{/gist_id}","starred_url":"https://api.github.com/users/luxl6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luxl6/subscriptions","organizations_url":"https://api.github.com/users/luxl6/orgs","repos_url":"https://api.github.com/users/luxl6/repos","events_url":"https://api.github.com/users/luxl6/events{/privacy}","received_events_url":"https://api.github.com/users/luxl6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T01:56:12Z","updated_at":"2023-03-14T01:56:12Z","author_association":"NONE","body":"> hadoop-aws aws-java-sdk-bundle 1.11.271 Does it exist?\r\n\r\nI use flink + iceberg + minio, if I want to merge data, the teacher will teach me","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467225621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467228506","html_url":"https://github.com/apache/iceberg/issues/7023#issuecomment-1467228506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7023","id":1467228506,"node_id":"IC_kwDOCW7NX85XdCFa","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T02:00:03Z","updated_at":"2023-03-14T02:00:03Z","author_association":"MEMBER","body":"reproduced again with --info and --stacktrace \r\n\r\nhttps://github.com/apache/iceberg/pull/7043\r\nhttps://github.com/apache/iceberg/actions/runs/4407525559/jobs/7721312588\r\n\r\nCaused by: java.lang.OutOfMemoryError: Java heap space\r\n\tat org.antlr.v4.runtime.atn.PredictionMode.getConflictingAltSubsets(PredictionMode.java:551)\r\n\tat org.antlr.v4.runtime.atn.PredictionMode.hasSLLConflictTerminatingPrediction(PredictionMode.java:241)\r\n\tat org.antlr.v4.runtime.atn.ParserATNSimulator.computeTargetState(ParserATNSimulator.java:602)\r\n\tat org.antlr.v4.runtime.atn.ParserATNSimulator.execATN(ParserATNSimulator.java:454)\r\n\tat org.antlr.v4.runtime.atn.ParserATNSimulator.adaptivePredict(ParserATNSimulator.java:393)\r\n\tat com.puppycrawl.tools.checkstyle.grammar.java.JavaLanguageParser.classOrInterfaceType(JavaLanguageParser.java:3838)\r\n\t\r\nSo, I guess increasing heap space should solve it in #7045. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467228506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467274274","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1467274274","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1467274274,"node_id":"IC_kwDOCW7NX85XdNQi","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T02:55:01Z","updated_at":"2023-03-14T02:55:01Z","author_association":"CONTRIBUTOR","body":"I think the documentation is very detailed.\r\n\r\nChange the address to the one that accesses minio, change the catalog to the corresponding catalog, and you may need some access-related configuration\r\n\r\n```java\r\nimport org.apache.iceberg.flink.actions.Actions;\r\n \r\nTableLoader tableLoader = TableLoader.fromHadoopTable(\"xxx\");\r\nTable table = tableLoader.loadTable();\r\nRewriteDataFilesActionResult result = Actions.forTable(table)\r\n        .rewriteDataFiles()\r\n        .execute();\r\n\r\n```\r\n\r\nSuch as these, of course, not all of them are necessary, I am just an example\r\n```java\r\n      config.set(\"fs.s3a.impl\", \"org.apache.hadoop.fs.s3a.S3AFileSystem\");\r\n      config.set(\"fs.s3a.path.style.access\", \"true\");\r\n      config.set(\"fs.s3a.connection.ssl.enabled\", \"false\");\r\n      config.set(\"fs.s3a.access.key\", access);\r\n      config.set(\"fs.s3a.secret.key\", secret);\r\n      config.set(\"fs.s3a.endpoint\", endpoint);\r\n      .....\r\n```\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467274274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467275861","html_url":"https://github.com/apache/iceberg/pull/7096#issuecomment-1467275861","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7096","id":1467275861,"node_id":"IC_kwDOCW7NX85XdNpV","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T02:57:37Z","updated_at":"2023-03-14T02:57:37Z","author_association":"CONTRIBUTOR","body":"**Physical plan before modified:**  \r\n\r\n> == Physical Plan ==\r\nAdaptiveSparkPlan isFinalPlan=false\r\n+- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, input[0, java.lang.String, true], true, false, true) AS value#219]\r\n   +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2729/204334828@45ec7633, obj#218: java.lang.String\r\n      +- DeserializeToObject newInstance(class scala.Tuple2), obj#217: scala.Tuple2\r\n         +- **BroadcastHashJoin [_1#211.path], [_2#212.path], LeftOuter, BuildRight, false**\r\n            :- Project [named_struct(authority, authority#62, path, path#63, scheme, scheme#64, uriAsString, uriAsString#65) AS _1#211]\r\n            :  +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getAuthority, true, false, true) AS authority#62, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getPath, true, false, true) AS path#63, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getScheme, true, false, true) AS scheme#64, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getUriAsString, true, false, true) AS uriAsString#65]\r\n            :     +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2729/204334828@1711b63f, obj#61: org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI\r\n            :        +- Scan[obj#52]\r\n            +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, struct<authority:string,path:string,scheme:string,uriAsString:string>, false].path),false), [plan_id=232]\r\n               +- Union\r\n                  :- Project [named_struct(authority, authority#123, path, path#124, scheme, scheme#125, uriAsString, uriAsString#126) AS _2#212]\r\n                  :  +- Filter isnotnull(path#124)\r\n                  :     +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getAuthority, true, false, true) AS authority#123, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getPath, true, false, true) AS path#124, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getScheme, true, false, true) AS scheme#125, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getUriAsString, true, false, true) AS uriAsString#126]\r\n                  :        +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2729/204334828@1c1e78eb, obj#122: org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI\r\n                  :           +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2780/770030446@1eae036e, obj#118: org.apache.iceberg.spark.actions.FileInfo\r\n                  :              +- DeserializeToObject initializejavabean(newInstance(class org.apache.iceberg.spark.actions.ManifestFileBean), (setPath,path#67.toString), (setAddedSnapshotId,staticinvoke(class java.lang.Long, ObjectType(class java.lang.Long), valueOf, addedSnapshotId#227L, true, false, true)), (setContent,staticinvoke(class java.lang.Integer, ObjectType(class java.lang.Integer), valueOf, content#221, true, false, true)), (setPartitionSpecId,staticinvoke(class java.lang.Integer, ObjectType(class java.lang.Integer), valueOf, partitionSpecId#225, true, false, true)), (setLength,staticinvoke(class java.lang.Long, ObjectType(class java.lang.Long), valueOf, length#223L, true, false, true))), obj#117: org.apache.iceberg.spark.actions.ManifestFileBean\r\n                  :                 +- Exchange RoundRobinPartitioning(200), REPARTITION_BY_NUM, [plan_id=200]\r\n                  :                    +- HashAggregate(keys=[path#67], functions=[first(content#66, false), first(length#68L, false), first(partitionSpecId#92, false), first(addedSnapshotId#93L, false)], output=[content#221, path#67, length#223L, partitionSpecId#225, addedSnapshotId#227L])\r\n                  :                       +- HashAggregate(keys=[path#67], functions=[partial_first(content#66, false), partial_first(length#68L, false), partial_first(partitionSpecId#92, false), partial_first(addedSnapshotId#93L, false)], output=[path#67, first#245, valueSet#246, first#247L, valueSet#248, first#249, valueSet#250, first#251L, valueSet#252])\r\n                  :                          +- Project [content#66, path#67, length#68L, partition_spec_id#69 AS partitionSpecId#92, added_snapshot_id#70L AS addedSnapshotId#93L]\r\n                  :                             +- BatchScan[content#66, path#67, length#68L, partition_spec_id#69, added_snapshot_id#70L] file:/tmp/junit7658548847041001892/junit5488406415725968442/#all_manifests (branch=null) [filters=, groupedBy=] RuntimeFilters: []\r\n                  :- Project [named_struct(authority, authority#166, path, path#167, scheme, scheme#168, uriAsString, uriAsString#169) AS _2#228]\r\n                  :  +- Filter isnotnull(path#167)\r\n                  :     +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getAuthority, true, false, true) AS authority#166, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getPath, true, false, true) AS path#167, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getScheme, true, false, true) AS scheme#168, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getUriAsString, true, false, true) AS uriAsString#169]\r\n                  :        +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2729/204334828@29173f02, obj#165: org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI\r\n                  :           +- DeserializeToObject initializejavabean(newInstance(class org.apache.iceberg.spark.actions.FileInfo), (setPath,path#128.toString), (setType,type#153.toString)), obj#164: org.apache.iceberg.spark.actions.FileInfo\r\n                  :              +- Project [path#128, Manifest AS type#153]\r\n                  :                 +- BatchScan[path#128] file:/tmp/junit7658548847041001892/junit5488406415725968442/#all_manifests (branch=null) [filters=, groupedBy=] RuntimeFilters: []\r\n                  :- Project [named_struct(authority, authority#177, path, path#178, scheme, scheme#179, uriAsString, uriAsString#180) AS _2#229]\r\n                  :  +- Filter isnotnull(path#178)\r\n                  :     +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getAuthority, true, false, true) AS authority#177, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getPath, true, false, true) AS path#178, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getScheme, true, false, true) AS scheme#179, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getUriAsString, true, false, true) AS uriAsString#180]\r\n                  :        +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2729/204334828@1b4d4949, obj#176: org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI\r\n                  :           +- DeserializeToObject initializejavabean(newInstance(class org.apache.iceberg.spark.actions.FileInfo), (setPath,path#170.toString), (setType,type#171.toString)), obj#175: org.apache.iceberg.spark.actions.FileInfo\r\n                  :              +- LocalTableScan [path#170, type#171]\r\n                  +- Project [named_struct(authority, authority#188, path, path#189, scheme, scheme#190, uriAsString, uriAsString#191) AS _2#230]\r\n                     +- Filter isnotnull(path#189)\r\n                        +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getAuthority, true, false, true) AS authority#188, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getPath, true, false, true) AS path#189, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getScheme, true, false, true) AS scheme#190, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getUriAsString, true, false, true) AS uriAsString#191]\r\n                           +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2729/204334828@1946579d, obj#187: org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI\r\n                              +- DeserializeToObject initializejavabean(newInstance(class org.apache.iceberg.spark.actions.FileInfo), (setPath,path#181.toString), (setType,type#182.toString)), obj#186: org.apache.iceberg.spark.actions.FileInfo\r\n                                 +- LocalTableScan [path#181, type#182]\r\n\r\n  \r\n  \r\n**Physical plan after modified:**  \r\n> == Physical Plan ==\r\nAdaptiveSparkPlan isFinalPlan=false\r\n+- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, input[0, java.lang.String, true], true, false, true) AS value#219]\r\n   +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2728/869880469@7d1a1ee9, obj#218: java.lang.String\r\n      +- DeserializeToObject newInstance(class scala.Tuple2), obj#217: scala.Tuple2\r\n         +- **SortMergeJoin [_1#211.path], [_2#212.path], LeftOuter**\r\n            :- Sort [_1#211.path ASC NULLS FIRST], false, 0\r\n            :  +- Exchange hashpartitioning(_1#211.path, 200), ENSURE_REQUIREMENTS, [plan_id=233]\r\n            :     +- Project [named_struct(authority, authority#62, path, path#63, scheme, scheme#64, uriAsString, uriAsString#65) AS _1#211]\r\n            :        +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getAuthority, true, false, true) AS authority#62, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getPath, true, false, true) AS path#63, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getScheme, true, false, true) AS scheme#64, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getUriAsString, true, false, true) AS uriAsString#65]\r\n            :           +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2728/869880469@122ff251, obj#61: org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI\r\n            :              +- Scan[obj#52]\r\n            +- Sort [_2#212.path ASC NULLS FIRST], false, 0\r\n               +- Exchange hashpartitioning(_2#212.path, 200), ENSURE_REQUIREMENTS, [plan_id=234]\r\n                  +- Union\r\n                     :- Project [named_struct(authority, authority#123, path, path#124, scheme, scheme#125, uriAsString, uriAsString#126) AS _2#212]\r\n                     :  +- Filter isnotnull(path#124)\r\n                     :     +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getAuthority, true, false, true) AS authority#123, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getPath, true, false, true) AS path#124, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getScheme, true, false, true) AS scheme#125, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getUriAsString, true, false, true) AS uriAsString#126]\r\n                     :        +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2728/869880469@438fc55e, obj#122: org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI\r\n                     :           +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2779/1142936077@56567e9b, obj#118: org.apache.iceberg.spark.actions.FileInfo\r\n                     :              +- DeserializeToObject initializejavabean(newInstance(class org.apache.iceberg.spark.actions.ManifestFileBean), (setPath,path#67.toString), (setAddedSnapshotId,staticinvoke(class java.lang.Long, ObjectType(class java.lang.Long), valueOf, addedSnapshotId#227L, true, false, true)), (setContent,staticinvoke(class java.lang.Integer, ObjectType(class java.lang.Integer), valueOf, content#221, true, false, true)), (setPartitionSpecId,staticinvoke(class java.lang.Integer, ObjectType(class java.lang.Integer), valueOf, partitionSpecId#225, true, false, true)), (setLength,staticinvoke(class java.lang.Long, ObjectType(class java.lang.Long), valueOf, length#223L, true, false, true))), obj#117: org.apache.iceberg.spark.actions.ManifestFileBean\r\n                     :                 +- Exchange RoundRobinPartitioning(200), REPARTITION_BY_NUM, [plan_id=200]\r\n                     :                    +- HashAggregate(keys=[path#67], functions=[first(content#66, false), first(length#68L, false), first(partitionSpecId#92, false), first(addedSnapshotId#93L, false)], output=[content#221, path#67, length#223L, partitionSpecId#225, addedSnapshotId#227L])\r\n                     :                       +- HashAggregate(keys=[path#67], functions=[partial_first(content#66, false), partial_first(length#68L, false), partial_first(partitionSpecId#92, false), partial_first(addedSnapshotId#93L, false)], output=[path#67, first#245, valueSet#246, first#247L, valueSet#248, first#249, valueSet#250, first#251L, valueSet#252])\r\n                     :                          +- Project [content#66, path#67, length#68L, partition_spec_id#69 AS partitionSpecId#92, added_snapshot_id#70L AS addedSnapshotId#93L]\r\n                     :                             +- BatchScan[content#66, path#67, length#68L, partition_spec_id#69, added_snapshot_id#70L] file:/tmp/junit8641658744871490880/junit9101792858122759973/#all_manifests (branch=null) [filters=, groupedBy=] RuntimeFilters: []\r\n                     :- Project [named_struct(authority, authority#166, path, path#167, scheme, scheme#168, uriAsString, uriAsString#169) AS _2#228]\r\n                     :  +- Filter isnotnull(path#167)\r\n                     :     +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getAuthority, true, false, true) AS authority#166, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getPath, true, false, true) AS path#167, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getScheme, true, false, true) AS scheme#168, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getUriAsString, true, false, true) AS uriAsString#169]\r\n                     :        +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2728/869880469@4d121ab6, obj#165: org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI\r\n                     :           +- DeserializeToObject initializejavabean(newInstance(class org.apache.iceberg.spark.actions.FileInfo), (setPath,path#128.toString), (setType,type#153.toString)), obj#164: org.apache.iceberg.spark.actions.FileInfo\r\n                     :              +- Project [path#128, Manifest AS type#153]\r\n                     :                 +- BatchScan[path#128] file:/tmp/junit8641658744871490880/junit9101792858122759973/#all_manifests (branch=null) [filters=, groupedBy=] RuntimeFilters: []\r\n                     :- Project [named_struct(authority, authority#177, path, path#178, scheme, scheme#179, uriAsString, uriAsString#180) AS _2#229]\r\n                     :  +- Filter isnotnull(path#178)\r\n                     :     +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getAuthority, true, false, true) AS authority#177, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getPath, true, false, true) AS path#178, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getScheme, true, false, true) AS scheme#179, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getUriAsString, true, false, true) AS uriAsString#180]\r\n                     :        +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2728/869880469@290def7d, obj#176: org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI\r\n                     :           +- DeserializeToObject initializejavabean(newInstance(class org.apache.iceberg.spark.actions.FileInfo), (setPath,path#170.toString), (setType,type#171.toString)), obj#175: org.apache.iceberg.spark.actions.FileInfo\r\n                     :              +- LocalTableScan [path#170, type#171]\r\n                     +- Project [named_struct(authority, authority#188, path, path#189, scheme, scheme#190, uriAsString, uriAsString#191) AS _2#230]\r\n                        +- Filter isnotnull(path#189)\r\n                           +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getAuthority, true, false, true) AS authority#188, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getPath, true, false, true) AS path#189, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getScheme, true, false, true) AS scheme#190, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, assertnotnull(input[0, org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI, true]).getUriAsString, true, false, true) AS uriAsString#191]\r\n                              +- MapPartitions org.apache.spark.sql.Dataset$$Lambda$2728/869880469@10ea1754, obj#187: org.apache.iceberg.spark.actions.DeleteOrphanFilesSparkAction$FileURI\r\n                                 +- DeserializeToObject initializejavabean(newInstance(class org.apache.iceberg.spark.actions.FileInfo), (setPath,path#181.toString), (setType,type#182.toString)), obj#186: org.apache.iceberg.spark.actions.FileInfo\r\n                                    +- LocalTableScan [path#181, type#182]","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467275861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467588339","html_url":"https://github.com/apache/iceberg/issues/5119#issuecomment-1467588339","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5119","id":1467588339,"node_id":"IC_kwDOCW7NX85XeZ7z","user":{"login":"zhaofuw","id":35920488,"node_id":"MDQ6VXNlcjM1OTIwNDg4","avatar_url":"https://avatars.githubusercontent.com/u/35920488?v=4","gravatar_id":"","url":"https://api.github.com/users/zhaofuw","html_url":"https://github.com/zhaofuw","followers_url":"https://api.github.com/users/zhaofuw/followers","following_url":"https://api.github.com/users/zhaofuw/following{/other_user}","gists_url":"https://api.github.com/users/zhaofuw/gists{/gist_id}","starred_url":"https://api.github.com/users/zhaofuw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhaofuw/subscriptions","organizations_url":"https://api.github.com/users/zhaofuw/orgs","repos_url":"https://api.github.com/users/zhaofuw/repos","events_url":"https://api.github.com/users/zhaofuw/events{/privacy}","received_events_url":"https://api.github.com/users/zhaofuw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T08:02:04Z","updated_at":"2023-03-14T08:02:04Z","author_association":"NONE","body":"Is there any latest progress in this work?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467588339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467640396","html_url":"https://github.com/apache/iceberg/issues/6306#issuecomment-1467640396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6306","id":1467640396,"node_id":"IC_kwDOCW7NX85XempM","user":{"login":"sweetpythoncode","id":29664369,"node_id":"MDQ6VXNlcjI5NjY0MzY5","avatar_url":"https://avatars.githubusercontent.com/u/29664369?v=4","gravatar_id":"","url":"https://api.github.com/users/sweetpythoncode","html_url":"https://github.com/sweetpythoncode","followers_url":"https://api.github.com/users/sweetpythoncode/followers","following_url":"https://api.github.com/users/sweetpythoncode/following{/other_user}","gists_url":"https://api.github.com/users/sweetpythoncode/gists{/gist_id}","starred_url":"https://api.github.com/users/sweetpythoncode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sweetpythoncode/subscriptions","organizations_url":"https://api.github.com/users/sweetpythoncode/orgs","repos_url":"https://api.github.com/users/sweetpythoncode/repos","events_url":"https://api.github.com/users/sweetpythoncode/events{/privacy}","received_events_url":"https://api.github.com/users/sweetpythoncode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T08:36:24Z","updated_at":"2023-03-14T08:48:40Z","author_association":"NONE","body":"@szehon-ho(cc @RussellSpitzer )\r\nThanks for checking this, here is the case which I faced:\r\n1. We have a hive structure with partitions:\r\n```\r\ns3://bucket/data/id=1/name=test/timestamp=20231101191213/result.orc\r\ns3://bucket/data/id=2/name=test-2/timestamp=20231101191213/result.orc\r\n```\r\n2. We have partitioning by `id, name, timestamp` in the table.\r\n3. We run the procedure to `add_files` from hive into iceberg:\r\n```\r\nCALL iceberg_catalog.system.add_files(\r\ntable => 'test.test_name',\r\nsource_table => '`orc`.`s3://bucket/data/`'\r\n)\r\n```\r\n4. After some time **uncontrolled** hive system adds a new partition and removes the old one, or keep two partitions(for `timestamp`, it needed to control process version in other systems like Trino to avoid duplicates), now we have:\r\n```\r\ns3://bucket/data/id=1/name=test/timestamp=20231101191213/result.orc\r\ns3://bucket/data/id=2/name=test-2/timestamp=20231101191217/result.orc <- old timestamp removed, new one added\r\n```\r\n5. I want to sync the iceberg table to watch the new partition and remove removed from the bucket.\r\n6. We run these steps to register that one changed partition, otherwise iceberg will fail with the file does not exist:\r\n```\r\ndelete from test.test_name where 1=1;\r\nCALL iceberg_catalog.system.add_files(\r\n\ttable => 'test.test_name',\r\n\tsource_table => '`orc`.`s3://bucket/data/`',\r\n\tcheck_duplicate_files => false\r\n)\r\nCALL iceberg_catalog.system.expire_snapshots('test.test_name', TIMESTAMP '{now}', 1)\r\n```\r\n_use case can be changed with a new features at least to that:_\r\n6.\r\n```\r\ndelete from test.test_name where timestamp = 20231101191213; <- removed partitions from bucket\r\nCALL iceberg_catalog.system.add_files(\r\n\ttable => 'test.test_name',\r\n\tsource_table => '`orc`.`s3://bucket/data/`',\r\n\tduplicate_file_mode => 'skip'\r\n) <- here we register only the new partition, instead of scanning the whole data again.\r\nCALL iceberg_catalog.system.expire_snapshots('test.test_name', TIMESTAMP '{now}', 1) <- to expire old removed partition from snapshots\r\n```\r\n------------------\r\nAlso here is another workaround to add the full path to the new partition but I cannot just use the full path to the new partition because Iceberg will ignore partitions in the path and set them as null in a table, [here is link to issue](https://github.com/apache/iceberg/issues/7027)\r\n```\r\nCALL iceberg_catalog.system.add_files(\r\n\ttable => 'test.test_name',\r\n\tsource_table => '`orc`.`s3://bucket/data/id=2/name=test-2/timestamp=20231101191217/`'\r\n)\r\n\r\n```\r\np.s. I understand that Iceberg was designed to migrate Hive into Iceberg one time, and the Hive system after that will not be changed over time, but once Hive system changed at least one time after migration its produce these strange use cases","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467640396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467713736","html_url":"https://github.com/apache/iceberg/issues/7101#issuecomment-1467713736","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7101","id":1467713736,"node_id":"IC_kwDOCW7NX85Xe4jI","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T09:23:27Z","updated_at":"2023-03-14T09:25:55Z","author_association":"CONTRIBUTOR","body":"The Iceberg build doesn't officially support Windows. However, coud you maybe show why the tests are failing?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467713736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467749278","html_url":"https://github.com/apache/iceberg/issues/7101#issuecomment-1467749278","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7101","id":1467749278,"node_id":"IC_kwDOCW7NX85XfBOe","user":{"login":"liuxiaocs7","id":42756849,"node_id":"MDQ6VXNlcjQyNzU2ODQ5","avatar_url":"https://avatars.githubusercontent.com/u/42756849?v=4","gravatar_id":"","url":"https://api.github.com/users/liuxiaocs7","html_url":"https://github.com/liuxiaocs7","followers_url":"https://api.github.com/users/liuxiaocs7/followers","following_url":"https://api.github.com/users/liuxiaocs7/following{/other_user}","gists_url":"https://api.github.com/users/liuxiaocs7/gists{/gist_id}","starred_url":"https://api.github.com/users/liuxiaocs7/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liuxiaocs7/subscriptions","organizations_url":"https://api.github.com/users/liuxiaocs7/orgs","repos_url":"https://api.github.com/users/liuxiaocs7/repos","events_url":"https://api.github.com/users/liuxiaocs7/events{/privacy}","received_events_url":"https://api.github.com/users/liuxiaocs7/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T09:43:46Z","updated_at":"2023-03-14T09:43:46Z","author_association":"MEMBER","body":"> The Iceberg build doesn't officially support Windows. However, coud you maybe show why the tests are failing?\r\n\r\nAccording to the logs, there are mainly three modules that fail, they are:\r\n- iceberg-hive-metastore:test\r\n- iceberg-aliyun:test\r\n- iceberg-nessie:test\r\n\r\nHive metastore failed tests:\r\n![image](https://user-images.githubusercontent.com/42756849/224959255-16e5d2a6-7921-491b-9fc4-b5fa2f2776f9.png)\r\n\r\nsome wrong stack are:\r\n\r\n```\r\njava.lang.NullPointerException\r\n\tat org.apache.iceberg.hive.HiveMetastoreTest.stopMetastore(HiveMetastoreTest.java:79)\r\n\r\njava.lang.NoClassDefFoundError: Could not initialize class org.apache.iceberg.hive.TestHiveMetastore\r\n\tat org.apache.iceberg.hive.HiveMetastoreTest.startMetastore(HiveMetastoreTest.java:50)\r\n\tat org.apache.iceberg.hive.HiveMetastoreTest.startMetastore(HiveMetastoreTest.java:46)\r\n\r\njava.lang.NoClassDefFoundError: Could not initialize class org.apache.iceberg.hive.TestHiveMetastore\r\n\tat org.apache.iceberg.hive.HiveMetastoreTest.startMetastore(HiveMetastoreTest.java:50)\r\n\tat org.apache.iceberg.hive.TestHiveCommitLocks.startMetastore(TestHiveCommitLocks.java:87)\r\n```\r\n\r\n---\r\n\r\nAliyun failed tests:\r\n![image](https://user-images.githubusercontent.com/42756849/224959347-0432e356-fd1d-4061-a755-114f0af5d062.png)\r\n\r\n\r\nlog:\r\n\r\n```shell\r\ncom.aliyun.oss.OSSException: The bucket you tried to delete is not empty. \r\n[ErrorCode]: BucketNotEmpty\r\n[RequestId]: null\r\n[HostId]: null\r\n[ResponseError]:\r\n```\r\n\r\n---\r\n\r\nNessie failed tests:\r\n![image](https://user-images.githubusercontent.com/42756849/224959456-0b818d21-943a-42f0-9632-d6a401e22d46.png)\r\n\r\n\r\n```shell\r\njava.nio.file.InvalidPathException: Illegal character [:] in path at index 4: ///C:/Users/LIUXIA~1/AppData/Local/Temp/junit1820669570277894084//test-ns/table1_4da0d827-b94c-4073-900d-070e34024f79/data/initial-data.avro\r\n\tat sun.nio.fs.WindowsPathParser.nextSlash(WindowsPathParser.java:212)\r\n\tat sun.nio.fs.WindowsPathParser.parse(WindowsPathParser.java:111)\r\n\tat sun.nio.fs.WindowsPathParser.parse(WindowsPathParser.java:77)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467749278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467841874","html_url":"https://github.com/apache/iceberg/issues/7094#issuecomment-1467841874","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7094","id":1467841874,"node_id":"IC_kwDOCW7NX85XfX1S","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T10:38:38Z","updated_at":"2023-03-14T10:38:38Z","author_association":"CONTRIBUTOR","body":"@liuxiaocs7 Doing this on a module-by-module basis would be a good thing, as it makes it easier for reviewers to review small PRs. Also might be worth starting in one of the modules that has a lower amount of usages of `AssertHelpers`  (iceberg-orc can probably be combined with another module)\r\n\r\n![image](https://user-images.githubusercontent.com/271029/224974292-e70302d5-280e-4e9f-a61e-f13b68bc9049.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467841874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467850237","html_url":"https://github.com/apache/iceberg/issues/7102#issuecomment-1467850237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7102","id":1467850237,"node_id":"IC_kwDOCW7NX85XfZ39","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T10:43:23Z","updated_at":"2023-03-14T10:43:23Z","author_association":"CONTRIBUTOR","body":"I could handle all the deprecations in the `iceberg-core` module.\r\n\r\n@szehon-ho would you be interested in doing the same for spark 3.3?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1467850237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468178298","html_url":"https://github.com/apache/iceberg/issues/7100#issuecomment-1468178298","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7100","id":1468178298,"node_id":"IC_kwDOCW7NX85Xgp96","user":{"login":"LuigiCerone","id":24299345,"node_id":"MDQ6VXNlcjI0Mjk5MzQ1","avatar_url":"https://avatars.githubusercontent.com/u/24299345?v=4","gravatar_id":"","url":"https://api.github.com/users/LuigiCerone","html_url":"https://github.com/LuigiCerone","followers_url":"https://api.github.com/users/LuigiCerone/followers","following_url":"https://api.github.com/users/LuigiCerone/following{/other_user}","gists_url":"https://api.github.com/users/LuigiCerone/gists{/gist_id}","starred_url":"https://api.github.com/users/LuigiCerone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuigiCerone/subscriptions","organizations_url":"https://api.github.com/users/LuigiCerone/orgs","repos_url":"https://api.github.com/users/LuigiCerone/repos","events_url":"https://api.github.com/users/LuigiCerone/events{/privacy}","received_events_url":"https://api.github.com/users/LuigiCerone/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T14:12:04Z","updated_at":"2023-03-14T14:12:04Z","author_association":"CONTRIBUTOR","body":"Hello @Fokko, I'd like to work on this. Can you please assign it to me? Thanks :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468178298/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468389038","html_url":"https://github.com/apache/iceberg/pull/7104#issuecomment-1468389038","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7104","id":1468389038,"node_id":"IC_kwDOCW7NX85Xhdau","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T16:06:31Z","updated_at":"2023-03-14T16:06:31Z","author_association":"CONTRIBUTOR","body":"If we don't do another RC for 1.2.0, then let's wait with merging this until 1.2.0 is out. \r\nIf we end up doing another RC for 1.2.0, then I'll update the message to contain `1.3.0` and we can ship it with 1.2.0. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468389038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468398129","html_url":"https://github.com/apache/iceberg/pull/7105#issuecomment-1468398129","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7105","id":1468398129,"node_id":"IC_kwDOCW7NX85Xhfox","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T16:11:39Z","updated_at":"2023-03-14T16:11:39Z","author_association":"MEMBER","body":"cc: @rdblue, @aokolnychyi, @RussellSpitzer, @flyrain, @jackye1995, @szehon-ho     ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468398129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468517011","html_url":"https://github.com/apache/iceberg/pull/6862#issuecomment-1468517011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6862","id":1468517011,"node_id":"IC_kwDOCW7NX85Xh8qT","user":{"login":"munendrasn","id":9696252,"node_id":"MDQ6VXNlcjk2OTYyNTI=","avatar_url":"https://avatars.githubusercontent.com/u/9696252?v=4","gravatar_id":"","url":"https://api.github.com/users/munendrasn","html_url":"https://github.com/munendrasn","followers_url":"https://api.github.com/users/munendrasn/followers","following_url":"https://api.github.com/users/munendrasn/following{/other_user}","gists_url":"https://api.github.com/users/munendrasn/gists{/gist_id}","starred_url":"https://api.github.com/users/munendrasn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/munendrasn/subscriptions","organizations_url":"https://api.github.com/users/munendrasn/orgs","repos_url":"https://api.github.com/users/munendrasn/repos","events_url":"https://api.github.com/users/munendrasn/events{/privacy}","received_events_url":"https://api.github.com/users/munendrasn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T17:21:38Z","updated_at":"2023-03-14T17:21:38Z","author_association":"CONTRIBUTOR","body":"@jackye1995 \r\nI have included the suggestions, please let me know if any further changes required","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468517011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468673292","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1468673292","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1468673292,"node_id":"IC_kwDOCW7NX85Xii0M","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T19:03:39Z","updated_at":"2023-03-14T19:03:39Z","author_association":"COLLABORATOR","body":"Actually looks like this behavior is affected by: https://github.com/apache/iceberg/pull/6524  (not sure if its there before).  I'll also ping @aokolnychyi to get his opinion as well","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468673292/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468801258","html_url":"https://github.com/apache/iceberg/pull/7107#issuecomment-1468801258","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7107","id":1468801258,"node_id":"IC_kwDOCW7NX85XjCDq","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T20:33:26Z","updated_at":"2023-03-14T20:33:26Z","author_association":"CONTRIBUTOR","body":"I don't see a benefit to relaxing this constraint in the spec.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468801258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468845208","html_url":"https://github.com/apache/iceberg/pull/6962#issuecomment-1468845208","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6962","id":1468845208,"node_id":"IC_kwDOCW7NX85XjMyY","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T21:06:18Z","updated_at":"2023-03-14T21:06:18Z","author_association":"CONTRIBUTOR","body":"I'll try this week but can't promise.\r\n\r\ncc @flyrain ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468845208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468870730","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1468870730","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1468870730,"node_id":"IC_kwDOCW7NX85XjTBK","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T21:30:08Z","updated_at":"2023-03-14T21:32:03Z","author_association":"COLLABORATOR","body":"I stepped through the code.  The Spark rule is 'ConstantFolding'.  Unfortunately our code seems to return None is that case, as the filter becomes a filter without children, in the case of always true (1 == 1), which is opposite of what we want.\r\n\r\nI think we will have to add a unit test for this, and instead just have different case inside SparkExpressionConverter::collectResolvedSparkExpressionOption that handles that case as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468870730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468891226","html_url":"https://github.com/apache/iceberg/issues/7027#issuecomment-1468891226","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7027","id":1468891226,"node_id":"IC_kwDOCW7NX85XjYBa","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T21:52:16Z","updated_at":"2023-03-14T21:52:16Z","author_association":"COLLABORATOR","body":"Did you try full partition filter?  Also cc @abmo-x @dramaticlly , who are expert users of add_files, if they some experience.  Its been awhile since I looked at this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468891226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468893888","html_url":"https://github.com/apache/iceberg/issues/6306#issuecomment-1468893888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6306","id":1468893888,"node_id":"IC_kwDOCW7NX85XjYrA","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T21:55:18Z","updated_at":"2023-03-14T21:55:49Z","author_association":"COLLABORATOR","body":"```\r\ndelete from test.test_name where 1=1;\r\nCALL iceberg_catalog.system.add_files(\r\n\ttable => 'test.test_name',\r\n\tsource_table => '`orc`.`s3://bucket/data/`',\r\n\tcheck_duplicate_files => false\r\n)\r\nCALL iceberg_catalog.system.expire_snapshots('test.test_name', TIMESTAMP '{now}', 1)\r\n```\r\n\r\nI believe that this should work now, if you delete the entire table before adding the new file.  There was an issue before, but fixed by @dramaticlly , in #6889 , can you check if it fixes your issue?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468893888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468901735","html_url":"https://github.com/apache/iceberg/issues/7102#issuecomment-1468901735","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7102","id":1468901735,"node_id":"IC_kwDOCW7NX85Xjaln","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T22:03:59Z","updated_at":"2023-03-14T22:04:26Z","author_association":"COLLABORATOR","body":"Sure, I think @aokolnychyi has done some in https://github.com/apache/iceberg/pull/7069, and I did others in https://github.com/apache/iceberg/pull/7106 will see if there are more","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468901735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468907864","html_url":"https://github.com/apache/iceberg/issues/5649#issuecomment-1468907864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5649","id":1468907864,"node_id":"IC_kwDOCW7NX85XjcFY","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T22:10:46Z","updated_at":"2023-03-14T22:10:46Z","author_association":"COLLABORATOR","body":"This issue is still exists","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468907864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468920132","html_url":"https://github.com/apache/iceberg/issues/6306#issuecomment-1468920132","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6306","id":1468920132,"node_id":"IC_kwDOCW7NX85XjfFE","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T22:22:44Z","updated_at":"2023-03-14T22:22:44Z","author_association":"CONTRIBUTOR","body":"also what spark and iceberg version are you using at the moment? the #6889 was only introduced in latest spark 3.3, happy to backport if there's a need.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468920132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468929054","html_url":"https://github.com/apache/iceberg/issues/7022#issuecomment-1468929054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7022","id":1468929054,"node_id":"IC_kwDOCW7NX85XjhQe","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T22:30:30Z","updated_at":"2023-03-14T22:30:30Z","author_association":"CONTRIBUTOR","body":"I've created a PR https://github.com/apache/iceberg/pull/7109. This does fix the filtering but does not do the projection correctly (yet). I don't think this is an issue, the only downside is that you have to include the field that you're filtering in your projection. We can pick that up in a follow-up PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468929054/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468961424","html_url":"https://github.com/apache/iceberg/pull/7096#issuecomment-1468961424","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7096","id":1468961424,"node_id":"IC_kwDOCW7NX85XjpKQ","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T22:38:02Z","updated_at":"2023-03-14T22:38:02Z","author_association":"COLLABORATOR","body":"Question, Is it something you can set on spark, before using SparkActions.get(spark).deleteOrphanFiles","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468961424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468965350","html_url":"https://github.com/apache/iceberg/pull/7108#issuecomment-1468965350","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7108","id":1468965350,"node_id":"IC_kwDOCW7NX85XjqHm","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T22:42:37Z","updated_at":"2023-03-14T22:42:37Z","author_association":"CONTRIBUTOR","body":"@LuigiCerone what do you think? It feels a bit whacky on my end. Some pages are empty (for example Manifest), and all the menus are expanded which doesn't give a lot of useful information (I don't really care about the zstd decompression of Avro, and the page is also empty).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468965350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468988225","html_url":"https://github.com/apache/iceberg/pull/7059#issuecomment-1468988225","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7059","id":1468988225,"node_id":"IC_kwDOCW7NX85XjvtB","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T23:09:33Z","updated_at":"2023-03-14T23:09:33Z","author_association":"CONTRIBUTOR","body":"@Fokko, I think we can skip this one since it requires code changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468988225/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468989745","html_url":"https://github.com/apache/iceberg/pull/7057#issuecomment-1468989745","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7057","id":1468989745,"node_id":"IC_kwDOCW7NX85XjwEx","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T23:11:17Z","updated_at":"2023-03-14T23:11:17Z","author_association":"CONTRIBUTOR","body":"I think it's a good idea to keep up with patch versions so that we know that our tests still pass and can report issues back. In the event a patch version is incompatible, I don't think we can choose to support the later patch version. We didn't break compatibility and we should not make changes that could potentially break people on the older versions. I also don't think it's worth the time to make sure everything is compatible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468989745/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468991328","html_url":"https://github.com/apache/iceberg/pull/6879#issuecomment-1468991328","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6879","id":1468991328,"node_id":"IC_kwDOCW7NX85Xjwdg","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T23:13:22Z","updated_at":"2023-03-14T23:13:22Z","author_association":"CONTRIBUTOR","body":"> > We could add a \"session time zone\" like SQL and use that when it isn't specified. We can then default the session time zone to UTC\r\n> \r\n> That would work for me.\r\n\r\nOkay, so what would that look like? Is there precedent in other Python libraries for setting \"session\" properties?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1468991328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469032864","html_url":"https://github.com/apache/iceberg/issues/7027#issuecomment-1469032864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7027","id":1469032864,"node_id":"IC_kwDOCW7NX85Xj6mg","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T00:09:52Z","updated_at":"2023-03-15T00:09:52Z","author_association":"CONTRIBUTOR","body":"@sweetpythoncode  yes, I have come across both issues identified. Partition listing can be improved and when a path is provided which is not the root path without partition info, then partition values are not extracted correctly. I am working on them and will let you know once I have a PR out","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469032864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469036972","html_url":"https://github.com/apache/iceberg/issues/5678#issuecomment-1469036972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5678","id":1469036972,"node_id":"IC_kwDOCW7NX85Xj7ms","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T00:11:58Z","updated_at":"2023-03-15T00:11:58Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469036972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469037000","html_url":"https://github.com/apache/iceberg/issues/5677#issuecomment-1469037000","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5677","id":1469037000,"node_id":"IC_kwDOCW7NX85Xj7nI","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T00:12:01Z","updated_at":"2023-03-15T00:12:01Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469037000/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469077281","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1469077281","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1469077281,"node_id":"IC_kwDOCW7NX85XkFch","user":{"login":"ludlows","id":6441333,"node_id":"MDQ6VXNlcjY0NDEzMzM=","avatar_url":"https://avatars.githubusercontent.com/u/6441333?v=4","gravatar_id":"","url":"https://api.github.com/users/ludlows","html_url":"https://github.com/ludlows","followers_url":"https://api.github.com/users/ludlows/followers","following_url":"https://api.github.com/users/ludlows/following{/other_user}","gists_url":"https://api.github.com/users/ludlows/gists{/gist_id}","starred_url":"https://api.github.com/users/ludlows/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ludlows/subscriptions","organizations_url":"https://api.github.com/users/ludlows/orgs","repos_url":"https://api.github.com/users/ludlows/repos","events_url":"https://api.github.com/users/ludlows/events{/privacy}","received_events_url":"https://api.github.com/users/ludlows/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T01:03:35Z","updated_at":"2023-03-15T01:03:35Z","author_association":"CONTRIBUTOR","body":"hi @szehon-ho ,\r\nthank you so much for pointing out the problem.\r\n\r\n<img width=\"729\" alt=\"img\" src=\"https://user-images.githubusercontent.com/6441333/225176299-9859a34f-ad92-4d7b-9505-7f5e0e27fa1d.png\">\r\nit seems that the behavior of `collectFirst` is not what I expected.\r\nshould we implement another one to return a right expression if the `filter` expression is always true?\r\ndo you have any suggestions?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469077281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469155437","html_url":"https://github.com/apache/iceberg/pull/7096#issuecomment-1469155437","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7096","id":1469155437,"node_id":"IC_kwDOCW7NX85XkYht","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T01:44:27Z","updated_at":"2023-03-15T01:47:21Z","author_association":"CONTRIBUTOR","body":"> Question, Is it something you can set on spark, before using SparkActions.get(spark).deleteOrphanFiles\r\n\r\n@szehon-ho Yes, if we run the delete orphan action in code separately, it can directly set this config on spark. But if we need to run multiple SQLs or multiple ETL processes in one Spark Session, this may affect other SQLs or ETL processes. Our scenario is to share a service similar to Spark Thrift Server, and then submit CALL SQL to it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469155437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469179370","html_url":"https://github.com/apache/iceberg/pull/7057#issuecomment-1469179370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7057","id":1469179370,"node_id":"IC_kwDOCW7NX85XkeXq","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T02:00:14Z","updated_at":"2023-03-15T02:00:14Z","author_association":"CONTRIBUTOR","body":"Personally, I think it makes sense to skip incompatible patch versions. However, if we can achieve compatibility with little cost through the use of reflection and other means, then I would also vote for keeping backward compatibility. Of course, for major version, we shouldn't use this way.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469179370/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469201291","html_url":"https://github.com/apache/iceberg/pull/7096#issuecomment-1469201291","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7096","id":1469201291,"node_id":"IC_kwDOCW7NX85XkjuL","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T02:25:51Z","updated_at":"2023-03-15T02:25:51Z","author_association":"COLLABORATOR","body":"Maybe you can call spark.cloneSession() before passing it in via SparkActions.get(spark)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469201291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469202639","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1469202639","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1469202639,"node_id":"IC_kwDOCW7NX85XkkDP","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T02:27:36Z","updated_at":"2023-03-15T02:27:36Z","author_association":"COLLABORATOR","body":"Yea if we could  make a scala case that captures this exact case, that would be best.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469202639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469220598","html_url":"https://github.com/apache/iceberg/pull/7096#issuecomment-1469220598","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7096","id":1469220598,"node_id":"IC_kwDOCW7NX85Xkob2","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T02:44:16Z","updated_at":"2023-03-15T02:52:33Z","author_association":"CONTRIBUTOR","body":"> Maybe you can call spark.cloneSession() before passing it in via SparkActions.get(spark)?\r\n\r\n@szehon-ho I saw that `RemoveOrphanFilesProcedure` will get the Spark instance from `org.apache.iceberg.spark.procedures.BaseProcedure`. If I set the config here, I have two concerns:  \r\n1. One is that it may affect other Procedures. If other Procedures can use Broadcast Join later, it will not take effect.  \r\n2. The second is that if we call Delete Orphan through Action in code, there may still be OOM risks.  \r\nWhat do you think of it？Or do you mean just that all Procedures can use spark.cloneSession(), and only turn off Auto Broadcast Join in DeleteOrphanFilesSparkAction?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469220598/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469235521","html_url":"https://github.com/apache/iceberg/issues/7092#issuecomment-1469235521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7092","id":1469235521,"node_id":"IC_kwDOCW7NX85XksFB","user":{"login":"luxl6","id":101870212,"node_id":"U_kgDOBhJqhA","avatar_url":"https://avatars.githubusercontent.com/u/101870212?v=4","gravatar_id":"","url":"https://api.github.com/users/luxl6","html_url":"https://github.com/luxl6","followers_url":"https://api.github.com/users/luxl6/followers","following_url":"https://api.github.com/users/luxl6/following{/other_user}","gists_url":"https://api.github.com/users/luxl6/gists{/gist_id}","starred_url":"https://api.github.com/users/luxl6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luxl6/subscriptions","organizations_url":"https://api.github.com/users/luxl6/orgs","repos_url":"https://api.github.com/users/luxl6/repos","events_url":"https://api.github.com/users/luxl6/events{/privacy}","received_events_url":"https://api.github.com/users/luxl6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T02:58:41Z","updated_at":"2023-03-15T02:58:41Z","author_association":"NONE","body":" Configuration conf = new Configuration();\r\n        conf.set(\"fs.s3a.connection.ssl.enabled\", \"false\");\r\n        conf.set(\"fs.s3a.endpoint\", \"http://ip:9000\");\r\n        conf.set(\"fs.s3a.access.key\", \"minioadmin\");\r\n        conf.set(\"fs.s3a.secret.key\", \"minioadmin\");\r\n        conf.set(\"fs.s3a.path.style.access\", \"true\");\r\n        conf.set(\"fs.s3a.impl\", \"org.apache.hadoop.fs.s3a.S3AFileSystem\");\r\n        conf.set(\"fs.s3a.fast.upload\", \"true\");\r\n        conf.set(\"catalog-impl\", \"org.apache.iceberg.jdbc.JdbcCatalog\");\r\n        conf.set(\"uri\", \"jdbc:postgresql://ip:5432/icebergcat\");\r\n        conf.set(\"user\", \"PostgreSQL\");\r\n        conf.set(\"password\", \"PostgreSQL\");\r\n\r\n\r\n        TableLoader tableLoader = TableLoader.fromHadoopTable(\"s3a://iceberg/flink_db/flink_hb\",conf);\r\n        tableLoader.open();\r\n        Table table = tableLoader.loadTable();\r\n        RewriteDataFilesActionResult result = Actions.forTable(table)\r\n                .rewriteDataFiles()\r\n                .execute();\r\n\r\nTeacher, my main problem is that my catalog is not Hadoop catalog, but jdbc catalog. I merged Hadoop catalog successfully. I use jdbc to store catalog, and when I use Hadoop to merge files on minio, it cannot find it. Related table information, so the report does not exist all the time. Table does not exist at location: s3a://iceberg/flink_db/flink_hb","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1469235521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]