[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772322827","html_url":"https://github.com/apache/iceberg/pull/2150#issuecomment-772322827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2150","id":772322827,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjMyMjgyNw==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T08:17:15Z","updated_at":"2021-02-03T08:17:15Z","author_association":"COLLABORATOR","body":"Thanks for the merge, @rdblue, and @pvary for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772322827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772341638","html_url":"https://github.com/apache/iceberg/pull/2121#issuecomment-772341638","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2121","id":772341638,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjM0MTYzOA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T08:50:13Z","updated_at":"2021-02-03T08:50:13Z","author_association":"CONTRIBUTOR","body":"Thanks for the review and the merge @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772341638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772350727","html_url":"https://github.com/apache/iceberg/pull/2191#issuecomment-772350727","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2191","id":772350727,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjM1MDcyNw==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T09:05:18Z","updated_at":"2021-02-03T09:05:18Z","author_association":"COLLABORATOR","body":"@pvary Can you please take a look? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772350727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772380537","html_url":"https://github.com/apache/iceberg/pull/2182#issuecomment-772380537","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2182","id":772380537,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjM4MDUzNw==","user":{"login":"vvellanki","id":5296341,"node_id":"MDQ6VXNlcjUyOTYzNDE=","avatar_url":"https://avatars.githubusercontent.com/u/5296341?v=4","gravatar_id":"","url":"https://api.github.com/users/vvellanki","html_url":"https://github.com/vvellanki","followers_url":"https://api.github.com/users/vvellanki/followers","following_url":"https://api.github.com/users/vvellanki/following{/other_user}","gists_url":"https://api.github.com/users/vvellanki/gists{/gist_id}","starred_url":"https://api.github.com/users/vvellanki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vvellanki/subscriptions","organizations_url":"https://api.github.com/users/vvellanki/orgs","repos_url":"https://api.github.com/users/vvellanki/repos","events_url":"https://api.github.com/users/vvellanki/events{/privacy}","received_events_url":"https://api.github.com/users/vvellanki/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T09:53:18Z","updated_at":"2021-02-03T09:53:18Z","author_association":"NONE","body":"@rdblue The use case for tracking per-partition stats is mainly for planning purposes - estimating the number of rows (for join planning, and join ordering) and the number of files to read based on the dataset that needs to be read.\r\n\r\nAs of now, the submitted change rewrites only the required files. Are suggesting the following approach:\r\n- Commit the transaction by including placeholders for the partition stats files\r\n- Asynchronously write the partition stats files","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772380537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772513011","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-772513011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":772513011,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjUxMzAxMQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T13:39:31Z","updated_at":"2021-02-03T13:39:31Z","author_association":"MEMBER","body":"I have a pr with a small test, just need approval and I’ll put it up. Should be this morning\n\nSent from my iPhone\n\n> On Feb 3, 2021, at 1:16 AM, Stephen-Robin <notifications@github.com> wrote:\n> \n> ﻿\n> I tried a slightly different fix were we just check in the filter command whether there is more than 1 file OR if there is a single file but it is a partial scan, Scan Length < File sizeInBytes and that seems to work as well without building up the fileName set which may be an issue with very large numbers of files.\n> \n> Great, I will resubmit it with reference to your changes.\n> \n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub, or unsubscribe.\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772513011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772547080","html_url":"https://github.com/apache/iceberg/issues/2033#issuecomment-772547080","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2033","id":772547080,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjU0NzA4MA==","user":{"login":"pnowojski","id":8957547,"node_id":"MDQ6VXNlcjg5NTc1NDc=","avatar_url":"https://avatars.githubusercontent.com/u/8957547?v=4","gravatar_id":"","url":"https://api.github.com/users/pnowojski","html_url":"https://github.com/pnowojski","followers_url":"https://api.github.com/users/pnowojski/followers","following_url":"https://api.github.com/users/pnowojski/following{/other_user}","gists_url":"https://api.github.com/users/pnowojski/gists{/gist_id}","starred_url":"https://api.github.com/users/pnowojski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pnowojski/subscriptions","organizations_url":"https://api.github.com/users/pnowojski/orgs","repos_url":"https://api.github.com/users/pnowojski/repos","events_url":"https://api.github.com/users/pnowojski/events{/privacy}","received_events_url":"https://api.github.com/users/pnowojski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T14:23:21Z","updated_at":"2021-02-03T14:23:21Z","author_association":"NONE","body":"Thanks for your patience and help in investigating/discovering this issue. We will be merging fix today. I don't have a timeline when the respective bug fix releases will prepared and published, but the 1.12.2 release should be the first one containing bug fix for this issue hopefully somewhere next week.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772547080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772565506","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-772565506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":772565506,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjU2NTUwNg==","user":{"login":"Stephen-Robin","id":77377842,"node_id":"MDQ6VXNlcjc3Mzc3ODQy","avatar_url":"https://avatars.githubusercontent.com/u/77377842?v=4","gravatar_id":"","url":"https://api.github.com/users/Stephen-Robin","html_url":"https://github.com/Stephen-Robin","followers_url":"https://api.github.com/users/Stephen-Robin/followers","following_url":"https://api.github.com/users/Stephen-Robin/following{/other_user}","gists_url":"https://api.github.com/users/Stephen-Robin/gists{/gist_id}","starred_url":"https://api.github.com/users/Stephen-Robin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stephen-Robin/subscriptions","organizations_url":"https://api.github.com/users/Stephen-Robin/orgs","repos_url":"https://api.github.com/users/Stephen-Robin/repos","events_url":"https://api.github.com/users/Stephen-Robin/events{/privacy}","received_events_url":"https://api.github.com/users/Stephen-Robin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T14:49:56Z","updated_at":"2021-02-03T14:49:56Z","author_association":"CONTRIBUTOR","body":"> I have a pr with a small test, just need approval and I’ll put it up. Should be this morning\r\n\r\n@RussellSpitzer Thanks for your help, I have tried to fix the problem, and added some unit tests in [PR](https://github.com/Stephen-Robin/iceberg/commit/e04d45626977e9082be706789221552a6ef18f43), welcome to ask questions\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772565506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772579593","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-772579593","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":772579593,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjU3OTU5Mw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T15:09:01Z","updated_at":"2021-02-03T15:10:59Z","author_association":"MEMBER","body":"Left some comments, Looks good! \r\n~~Do you have a PR? or just the commit. If you need help setting up a PR please let me know~~\r\n\r\nNVM I see the PR :)\r\nhttps://github.com/apache/iceberg/pull/2196","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772579593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772581755","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772581755","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772581755,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjU4MTc1NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T15:12:02Z","updated_at":"2021-02-03T15:12:02Z","author_association":"MEMBER","body":"I think this PR is pretty much ready to go other than a few nits","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772581755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772584764","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772584764","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772584764,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjU4NDc2NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T15:15:57Z","updated_at":"2021-02-03T15:18:56Z","author_association":"MEMBER","body":"My quick notes on this issue:\r\n\r\n```\r\nPreviously when computing the rewrite tasks for RewriteDataFiles the code\r\nwould ignore scan tasks which referred to a single file. This is an issue because\r\nlarge files could be potentitally split into multiple read tasks. If one\r\nslice of a large file was combined with a slice from another file, that\r\nsecition would be rewritten with the other file, but the other slices would be ignored.\r\n\r\nFor example given 2 files\r\nFile A - 100 Bytes\r\nFile B - 10 Bytes\r\n\r\nIf the target split size was 60 bytes we would end up with 3 tasks\r\nA : 1 - 60\r\nA : 61 - 100\r\nB : 0 - 10\r\n\r\nWhich would be combined into\r\n\r\n(A : 1 - 60)\r\n(A : 61 -100, B : 0 -10)\r\n\r\nThe first task would be discarded since it only refered to one file. The\r\nsecond task would be rewritten, which would end with deleting file A and B.\r\n\r\nI believe the original intent was to ignore single file scan tasks as it was assumed these would\r\nbe unchanged files. But if a single file scan task only contains a partial scan of a file it must \r\nbe rewritten since it represents a new smaller file that needs to be rewritten.\r\n\r\nNormally this doesn't cause data loss since an ignored file won't be deleted, but if a split is\r\ncombined with another file, then that triggers the delete of the large file, even though several\r\nsplits of the large file will not have been written into new files.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772584764/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772590702","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-772590702","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":772590702,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjU5MDcwMg==","user":{"login":"Stephen-Robin","id":77377842,"node_id":"MDQ6VXNlcjc3Mzc3ODQy","avatar_url":"https://avatars.githubusercontent.com/u/77377842?v=4","gravatar_id":"","url":"https://api.github.com/users/Stephen-Robin","html_url":"https://github.com/Stephen-Robin","followers_url":"https://api.github.com/users/Stephen-Robin/followers","following_url":"https://api.github.com/users/Stephen-Robin/following{/other_user}","gists_url":"https://api.github.com/users/Stephen-Robin/gists{/gist_id}","starred_url":"https://api.github.com/users/Stephen-Robin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stephen-Robin/subscriptions","organizations_url":"https://api.github.com/users/Stephen-Robin/orgs","repos_url":"https://api.github.com/users/Stephen-Robin/repos","events_url":"https://api.github.com/users/Stephen-Robin/events{/privacy}","received_events_url":"https://api.github.com/users/Stephen-Robin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T15:23:41Z","updated_at":"2021-02-03T15:38:00Z","author_association":"CONTRIBUTOR","body":"> Left some comments, Looks good!\r\n> ~Do you have a PR? or just the commit. If you need help setting up a PR please let me know~\r\n #2196\r\n\r\n@RussellSpitzer Thank you very much!\r\nI immediately followed the comment to make changes.\r\nI do have a lot of PR, mainly refer to delta for Spark delete/update/merge function development, while supporting the snowflake multi-table operation syntax, I found that the community has not started to do these functions, we have completed the development 3 months ago And went online, but I only recently discovered that spark3-extentsion has been merged.\r\nIn addition, we intend to automate compaction of table data and support additional strategies, which are adjusted through intelligent parameters.\r\nDuring the development process we found https://docs.google.com/document/d/1aXo1VzuXxSuqcTzMLSQdnivMVgtLExgDWUFMvWeXRxc/edit#heading=h.41vc5dxcib1o\r\nThe document started to do this, but has not seen the corresponding progress in the community, Do you know what is the current progress of the proposal?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772590702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772600386","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-772600386","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":772600386,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjYwMDM4Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T15:36:16Z","updated_at":"2021-02-03T15:36:16Z","author_association":"MEMBER","body":"I mean to start on porting our internal versions of Datafile compaction tasks to OSS this week. I'm going to put off the issue of delete files atm as future work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772600386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772644140","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-772644140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":772644140,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjY0NDE0MA==","user":{"login":"Stephen-Robin","id":77377842,"node_id":"MDQ6VXNlcjc3Mzc3ODQy","avatar_url":"https://avatars.githubusercontent.com/u/77377842?v=4","gravatar_id":"","url":"https://api.github.com/users/Stephen-Robin","html_url":"https://github.com/Stephen-Robin","followers_url":"https://api.github.com/users/Stephen-Robin/followers","following_url":"https://api.github.com/users/Stephen-Robin/following{/other_user}","gists_url":"https://api.github.com/users/Stephen-Robin/gists{/gist_id}","starred_url":"https://api.github.com/users/Stephen-Robin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stephen-Robin/subscriptions","organizations_url":"https://api.github.com/users/Stephen-Robin/orgs","repos_url":"https://api.github.com/users/Stephen-Robin/repos","events_url":"https://api.github.com/users/Stephen-Robin/events{/privacy}","received_events_url":"https://api.github.com/users/Stephen-Robin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T16:34:53Z","updated_at":"2021-02-03T16:35:18Z","author_association":"CONTRIBUTOR","body":"> I mean to start on porting our internal versions of Datafile compaction tasks to OSS this week. I'm going to put off the issue of delete files atm as future work.\r\n\r\n@RussellSpitzer \r\nGreat, I am waiting for the OSS update, if there is related work that needs to be added, I hope to participate in the development of this part.\r\nThanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772644140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772653959","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772653959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772653959,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjY1Mzk1OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T16:47:50Z","updated_at":"2021-02-03T16:47:50Z","author_association":"MEMBER","body":"lgtm, @aokolnychyi do you have any comments?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772653959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772714356","html_url":"https://github.com/apache/iceberg/pull/2159#issuecomment-772714356","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2159","id":772714356,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjcxNDM1Ng==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T18:13:57Z","updated_at":"2021-02-03T18:13:57Z","author_association":"CONTRIBUTOR","body":"@danielcweeks could you take a look of this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772714356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772734858","html_url":"https://github.com/apache/iceberg/pull/2159#issuecomment-772734858","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2159","id":772734858,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjczNDg1OA==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T18:47:13Z","updated_at":"2021-02-03T18:47:13Z","author_association":"CONTRIBUTOR","body":"@stevenzwu Could you clarify as part of this why we need to fail fast?  Is this actually causing real-world problems or just an optimization for cases where a failure occurs during write?\r\n\r\nI have concerns about introducing an atomic reference check into a critical section (like `write(int)` though that method really shouldn't be used anyway) and unless there's significant problems with catching up in rare cases where a failure occurs, I'd rather not introduce the extra check (this was intentionally avoided in the initial implementation).\r\n\r\nAlso, for the multipart upload error, I feel like we we should not be catching and logging, but rather let the underlying exception propagate up.  We don't make guarantees around cleaning up multipart uploads (that should be handled by bucket policy because there are numerous failure scenarios we cannot cover).\r\n\r\nI'm probably missing context around what prompted this change.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772734858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772758415","html_url":"https://github.com/apache/iceberg/pull/2159#issuecomment-772758415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2159","id":772758415,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjc1ODQxNQ==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T19:24:21Z","updated_at":"2021-02-04T01:23:24Z","author_association":"CONTRIBUTOR","body":"@danielcweeks this is just an optimization for cases where async part upload failed. My understanding is that `completeMultiPartUpload` will fail during `close` time in this case of previous async part upload failure. Instead of waiting until close (which could be a few mins later), this change is trying to fail any writes fast and bubble up the async error to caller. Then jobs won't waste time on continuing writing and uploading data and maybe get restarted earlier.\r\n\r\n> I have concerns about introducing an atomic reference check into a critical section (like write(int))\r\n\r\nI would imagine it probably won't matter much compared to IO write. Plus, you mentioned that it should not be used anyway. \r\n\r\n> for the multipart upload error, I feel like we we should not be catching and logging\r\n\r\nAre you referring to the new catch-exception in the `abortUpload` method? It is a cleanup action. We don't want to bubble error from `abortUpload`. Instead, we want to bubble up the original error (like part upload error).\r\n\r\n> We don't make guarantees around cleaning up multipart uploads \r\n\r\nThat is true. This change doesn't change that aspect. still best effort. \r\n\r\n> unless there's significant problems with catching up in rare cases where a failure occurs, I'd rather not introduce the extra check (this was intentionally avoided in the initial implementation).\r\n\r\nYeah. I can agree with this argument. Maybe we don't have to fail fast in rare cases.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772758415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772775976","html_url":"https://github.com/apache/iceberg/issues/2202#issuecomment-772775976","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2202","id":772775976,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjc3NTk3Ng==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T19:47:59Z","updated_at":"2021-02-03T19:47:59Z","author_association":"CONTRIBUTOR","body":"@jackye1995 would you maybe have any ideas ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772775976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772786048","html_url":"https://github.com/apache/iceberg/pull/2182#issuecomment-772786048","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2182","id":772786048,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjc4NjA0OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T20:05:13Z","updated_at":"2021-02-03T20:05:13Z","author_association":"CONTRIBUTOR","body":"Thanks, @vvellanki. I think we will need to take a closer look at the plan for maintaining these files. I think we should track the last file and the snapshot it is based on, so we can apply diffs to it and update asynchronously.\r\n\r\nFor the use case, I'm curious why you aren't using the actual files? In Spark, we push filters down to Iceberg before producing stats. Then stats are based on the actual files that will be scanned, which can be significantly smaller than just partition-level stats. That allows a lot more joins to be converted to broadcast joins. Is it possible to push filters earlier in your job planning?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772786048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772805591","html_url":"https://github.com/apache/iceberg/pull/2205#issuecomment-772805591","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2205","id":772805591,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjgwNTU5MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T20:36:28Z","updated_at":"2021-02-03T20:36:28Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @dilipbiswal @mehtaashish23 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772805591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772806020","html_url":"https://github.com/apache/iceberg/issues/2202#issuecomment-772806020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2202","id":772806020,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjgwNjAyMA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T20:37:11Z","updated_at":"2021-02-03T20:37:11Z","author_association":"CONTRIBUTOR","body":"We see there are some issues with the Glue UI for displaying Iceberg tables, can you first check through AWS CLI to see if the table information is actually updated properly?\r\n\r\n```\r\naws glue get-table --database-name db --name table\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772806020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772809854","html_url":"https://github.com/apache/iceberg/pull/2206#issuecomment-772809854","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2206","id":772809854,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjgwOTg1NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T20:43:33Z","updated_at":"2021-02-03T20:43:33Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @dilipbiswal @RussellSpitzer @mehtaashish23 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772809854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772813182","html_url":"https://github.com/apache/iceberg/pull/2207#issuecomment-772813182","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2207","id":772813182,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjgxMzE4Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T20:49:12Z","updated_at":"2021-02-03T20:49:12Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @dilipbiswal @mehtaashish23 @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772813182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772828920","html_url":"https://github.com/apache/iceberg/pull/2205#issuecomment-772828920","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2205","id":772828920,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjgyODkyMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T21:15:54Z","updated_at":"2021-02-03T21:15:54Z","author_association":"CONTRIBUTOR","body":"The test failures in `TestFlinkTableSink ` seem unrelated to this PR.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772828920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772831625","html_url":"https://github.com/apache/iceberg/pull/2205#issuecomment-772831625","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2205","id":772831625,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjgzMTYyNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T21:20:14Z","updated_at":"2021-02-03T21:20:14Z","author_association":"CONTRIBUTOR","body":"You should be able to re-run the checks from the details page. I think anyone with commit privileges should be able to.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772831625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772836959","html_url":"https://github.com/apache/iceberg/issues/2174#issuecomment-772836959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2174","id":772836959,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjgzNjk1OQ==","user":{"login":"kkishoreyadav","id":3267947,"node_id":"MDQ6VXNlcjMyNjc5NDc=","avatar_url":"https://avatars.githubusercontent.com/u/3267947?v=4","gravatar_id":"","url":"https://api.github.com/users/kkishoreyadav","html_url":"https://github.com/kkishoreyadav","followers_url":"https://api.github.com/users/kkishoreyadav/followers","following_url":"https://api.github.com/users/kkishoreyadav/following{/other_user}","gists_url":"https://api.github.com/users/kkishoreyadav/gists{/gist_id}","starred_url":"https://api.github.com/users/kkishoreyadav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kkishoreyadav/subscriptions","organizations_url":"https://api.github.com/users/kkishoreyadav/orgs","repos_url":"https://api.github.com/users/kkishoreyadav/repos","events_url":"https://api.github.com/users/kkishoreyadav/events{/privacy}","received_events_url":"https://api.github.com/users/kkishoreyadav/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T21:29:26Z","updated_at":"2021-02-03T21:29:26Z","author_association":"NONE","body":"The following two things have fixed my problem\r\n\r\n- Ensured that I provided the correct path name for the iceberg table ( with gs:// prefix in my case)\r\n\r\n- Resolved the apache.avro dependency version conflict","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772836959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772843549","html_url":"https://github.com/apache/iceberg/issues/2202#issuecomment-772843549","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2202","id":772843549,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjg0MzU0OQ==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T21:41:56Z","updated_at":"2021-02-03T21:46:30Z","author_association":"CONTRIBUTOR","body":"This was the output I got @jackye1995 \r\n```\r\naws glue get-table --database-name iceberg_warehouse  --name iceberg_dummy_table\r\n{\r\n    \"Table\": {\r\n        \"UpdateTime\": 1612385097.0,\r\n        \"Name\": \"iceberg_dummy_table\",\r\n        \"Parameters\": {\r\n            \"table_type\": \"ICEBERG\",\r\n            \"previous_metadata_location\": \"s3://iceberg-warehouse/iceberg_warehouse.db/iceberg_dummy_table/metadata/00039-5b28310e-6767-4eff-9ff9-8827c010870f.metadata.json\",\r\n            \"metadata_location\": \"s3://iceberg_warehouse.db/iceberg_dummy_table/metadata/00040-d3069356-5ae6-4e76-9d33-63bfccfc04c8.metadata.json\"\r\n        },\r\n        \"CreateTime\": 1612243846.0,\r\n        \"CreatedBy\": \"arn:aws:sts::1234456:assumed-role/dev01InstanceProfile/i-0000\",\r\n        \"DatabaseName\": \"iceberg_warehouse\",\r\n        \"IsRegisteredWithLakeFormation\": false,\r\n        \"TableType\": \"EXTERNAL_TABLE\",\r\n        \"Retention\": 0\r\n    }\r\n} \r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772843549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772844183","html_url":"https://github.com/apache/iceberg/pull/2206#issuecomment-772844183","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2206","id":772844183,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjg0NDE4Mw==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T21:43:14Z","updated_at":"2021-02-03T21:43:14Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi A small request.. Is it possible for you to put the rewritten optimized plan in the pr description ? Just for us to refer back to quickly get an idea of the rewrite.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772844183/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772844267","html_url":"https://github.com/apache/iceberg/pull/2163#issuecomment-772844267","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2163","id":772844267,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjg0NDI2Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T21:43:26Z","updated_at":"2021-02-03T21:43:26Z","author_association":"CONTRIBUTOR","body":"Will merge when tests pass. Thanks for updating this, @marton-bod!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772844267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772844539","html_url":"https://github.com/apache/iceberg/issues/2202#issuecomment-772844539","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2202","id":772844539,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjg0NDUzOQ==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T21:43:57Z","updated_at":"2021-02-03T21:43:57Z","author_association":"CONTRIBUTOR","body":"attempt at a hive query:\r\n\r\n```\r\n hive> show tables;\r\nOK\r\niceberg_dummy_table\r\nTime taken: 0.367 seconds, Fetched: 1 row(s)\r\nhive> select count(*) from iceberg_dummy_table;\r\nFAILED: SemanticException Unable to fetch table iceberg_dummy_table. StorageDescriptor cannot be null for table: iceberg_dummy_table (Service: null; Status Code: 0; Error Code: null; Request ID: null; Proxy: null) \r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772844539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772844790","html_url":"https://github.com/apache/iceberg/pull/2205#issuecomment-772844790","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2205","id":772844790,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjg0NDc5MA==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T21:44:24Z","updated_at":"2021-02-03T21:44:24Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772844790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772844946","html_url":"https://github.com/apache/iceberg/issues/2173#issuecomment-772844946","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2173","id":772844946,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjg0NDk0Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T21:44:40Z","updated_at":"2021-02-03T21:44:40Z","author_association":"CONTRIBUTOR","body":"This was also sent to the dev list: https://lists.apache.org/thread.html/rd15bf1db711b1a31f39d4b98776f29753b544fa3a496111d3460e11e%40%3Cdev.iceberg.apache.org%3E\r\n\r\nLet's use the discussion there, since this isn't really a focused issue. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772844946/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772870628","html_url":"https://github.com/apache/iceberg/issues/2202#issuecomment-772870628","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2202","id":772870628,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjg3MDYyOA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T22:29:25Z","updated_at":"2021-02-03T22:37:45Z","author_association":"CONTRIBUTOR","body":"```\r\n        \"Parameters\": {\r\n            \"table_type\": \"ICEBERG\",\r\n            \"previous_metadata_location\": \"s3://iceberg-warehouse/iceberg_warehouse.db/iceberg_dummy_table/metadata/00039-5b28310e-6767-4eff-9ff9-8827c010870f.metadata.json\",\r\n            \"metadata_location\": \"s3://iceberg_warehouse.db/iceberg_dummy_table/metadata/00040-d3069356-5ae6-4e76-9d33-63bfccfc04c8.metadata.json\"\r\n        },\r\n```\r\nThis looks correct to me. In the title you said \"table location not updated\", is this the updated location or not?\r\n\r\nFor the schema issue, yes Glue UI currently does not support displaying Iceberg table schema, it is expected behavior, the shcema is stored in Iceberg's table metadata in S3.\r\n\r\nFor Hive, AWS module is not tested and added to Hive runtime jar yet, I do not know if Hive supports loading dynamic catalog yet. Currently Hive is still considered an experimental engine, that's why we have not added support yet.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772870628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772872207","html_url":"https://github.com/apache/iceberg/issues/2202#issuecomment-772872207","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2202","id":772872207,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjg3MjIwNw==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T22:32:33Z","updated_at":"2021-02-03T22:32:33Z","author_association":"CONTRIBUTOR","body":"Ahh I see, thanks a lot @jackye1995.\r\n\r\n>  In the title you said \"table location not updated\", is this the updated location or not?\r\n\r\nYea, that's the updated location. I think the problem I was facing was just a UI issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772872207/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772876944","html_url":"https://github.com/apache/iceberg/pull/2207#issuecomment-772876944","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2207","id":772876944,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjg3Njk0NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T22:42:22Z","updated_at":"2021-02-03T22:42:22Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @rdblue @dilipbiswal!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772876944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772877392","html_url":"https://github.com/apache/iceberg/pull/2205#issuecomment-772877392","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2205","id":772877392,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjg3NzM5Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T22:43:21Z","updated_at":"2021-02-03T22:43:21Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @rdblue @dilipbiswal!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772877392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772918680","html_url":"https://github.com/apache/iceberg/pull/2206#issuecomment-772918680","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2206","id":772918680,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjkxODY4MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T00:14:47Z","updated_at":"2021-02-04T00:14:47Z","author_association":"CONTRIBUTOR","body":"@dilipbiswal, good idea. I'll add a few sample plans.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772918680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772942654","html_url":"https://github.com/apache/iceberg/pull/2203#issuecomment-772942654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2203","id":772942654,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjk0MjY1NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T00:58:34Z","updated_at":"2021-02-04T00:58:34Z","author_association":"CONTRIBUTOR","body":"> NOTE: the HiveCatalog copies a new Hadoop Configuration which is a breaking change from how the constructor used to work. See HiveMetastoreTest changes for ramifications.\r\n\r\nCan you be more clear? I don't see anything major. What do you mean?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772942654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772951941","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772951941","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772951941,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjk1MTk0MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T01:19:50Z","updated_at":"2021-02-04T01:19:50Z","author_association":"CONTRIBUTOR","body":"Thank you for fixing this, @Stephen-Robin! I've tagged this for inclusion in the 0.11.1 patch release. We should probably do that soon since we have a correctness bug.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772951941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772969792","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-772969792","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":772969792,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjk2OTc5Mg==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T02:08:02Z","updated_at":"2021-02-04T02:08:02Z","author_association":"CONTRIBUTOR","body":"Why do you want to create multiple tables? I think it might be more reasonable to use dynamic partition","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772969792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772986334","html_url":"https://github.com/apache/iceberg/pull/2206#issuecomment-772986334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2206","id":772986334,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjk4NjMzNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T02:48:52Z","updated_at":"2021-02-04T02:48:52Z","author_association":"CONTRIBUTOR","body":"@dilipbiswal, added an example to the PR description.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772986334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773000160","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-773000160","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":773000160,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzAwMDE2MA==","user":{"login":"ashajyothi828","id":40180859,"node_id":"MDQ6VXNlcjQwMTgwODU5","avatar_url":"https://avatars.githubusercontent.com/u/40180859?v=4","gravatar_id":"","url":"https://api.github.com/users/ashajyothi828","html_url":"https://github.com/ashajyothi828","followers_url":"https://api.github.com/users/ashajyothi828/followers","following_url":"https://api.github.com/users/ashajyothi828/following{/other_user}","gists_url":"https://api.github.com/users/ashajyothi828/gists{/gist_id}","starred_url":"https://api.github.com/users/ashajyothi828/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashajyothi828/subscriptions","organizations_url":"https://api.github.com/users/ashajyothi828/orgs","repos_url":"https://api.github.com/users/ashajyothi828/repos","events_url":"https://api.github.com/users/ashajyothi828/events{/privacy}","received_events_url":"https://api.github.com/users/ashajyothi828/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T03:27:46Z","updated_at":"2021-02-04T03:27:46Z","author_association":"NONE","body":"> Why do you want to create multiple tables? I think it might be more reasonable to use dynamic partition\r\n\r\nBecause the incoming data belongs to different datasets. The transaction that I'm trying to insert here is a very simple schema, but our main aim is to implement this job for a larger usecase where the incoming data can belong to multiple datasets. I'm doing some groundwork for some design options we are considering and this is where I got stuck.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773000160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773011768","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-773011768","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":773011768,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzAxMTc2OA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T04:05:13Z","updated_at":"2021-02-04T04:05:13Z","author_association":"CONTRIBUTOR","body":"Currently, Flink Iceberg sink can only write to one table with exactly-once semantic.\r\n\r\nIf the table partition doesn't fit your requirements, maybe you can use filter or side output to split the stream into multiple sub streams. then attach a separate Iceberg sink to each sub DataStream. This probably won't work if the number of tables/datasets is really high (like hundreds). In that case, maybe split the uber stream before the Iceberg ingestion jobs. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773011768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773013632","html_url":"https://github.com/apache/iceberg/pull/2206#issuecomment-773013632","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2206","id":773013632,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzAxMzYzMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T04:11:53Z","updated_at":"2021-02-04T04:11:53Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @RussellSpitzer @dilipbiswal @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773013632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773014467","html_url":"https://github.com/apache/iceberg/pull/2210#issuecomment-773014467","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2210","id":773014467,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzAxNDQ2Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T04:14:33Z","updated_at":"2021-02-04T04:14:33Z","author_association":"MEMBER","body":"Implementation of #2068\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773014467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773014658","html_url":"https://github.com/apache/iceberg/issues/2068#issuecomment-773014658","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2068","id":773014658,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzAxNDY1OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T04:15:05Z","updated_at":"2021-02-05T18:31:25Z","author_association":"MEMBER","body":"Pull request added in case anyone wants an example to think about","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773014658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773063209","html_url":"https://github.com/apache/iceberg/pull/2182#issuecomment-773063209","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2182","id":773063209,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzA2MzIwOQ==","user":{"login":"vvellanki","id":5296341,"node_id":"MDQ6VXNlcjUyOTYzNDE=","avatar_url":"https://avatars.githubusercontent.com/u/5296341?v=4","gravatar_id":"","url":"https://api.github.com/users/vvellanki","html_url":"https://github.com/vvellanki","followers_url":"https://api.github.com/users/vvellanki/followers","following_url":"https://api.github.com/users/vvellanki/following{/other_user}","gists_url":"https://api.github.com/users/vvellanki/gists{/gist_id}","starred_url":"https://api.github.com/users/vvellanki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vvellanki/subscriptions","organizations_url":"https://api.github.com/users/vvellanki/orgs","repos_url":"https://api.github.com/users/vvellanki/repos","events_url":"https://api.github.com/users/vvellanki/events{/privacy}","received_events_url":"https://api.github.com/users/vvellanki/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T06:22:55Z","updated_at":"2021-02-04T06:22:55Z","author_association":"NONE","body":"@rdblue I did some experimentation with the approach you outlined by invoking planFiles(). I found that the time taken to read the manifest list file and the manifest files was quite high.\r\n\r\nAlso, the time taken increases when tables have a large number of columns (> 1000) and there are per-column stats for each of the data files (string columns increase the size of the per-column stats). This increases the number of manifest files that need to be read as part of this exercise and also increases the amount of time taken.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773063209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773117130","html_url":"https://github.com/apache/iceberg/pull/2197#issuecomment-773117130","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2197","id":773117130,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzExNzEzMA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T08:10:44Z","updated_at":"2021-02-04T08:10:44Z","author_association":"MEMBER","body":"Just merged this PR, thanks @zhangjun0x01 for contribution, and thanks @stevenzwu for reviewing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773117130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773217493","html_url":"https://github.com/apache/iceberg/pull/2129#issuecomment-773217493","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2129","id":773217493,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzIxNzQ5Mw==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T10:53:09Z","updated_at":"2021-02-04T10:53:09Z","author_association":"CONTRIBUTOR","body":"@rymurr Yes, I forgot to remove the CatalogLoader. Thanks for pointing that out. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773217493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773271127","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-773271127","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":773271127,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzI3MTEyNw==","user":{"login":"txdong-sz","id":5066512,"node_id":"MDQ6VXNlcjUwNjY1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5066512?v=4","gravatar_id":"","url":"https://api.github.com/users/txdong-sz","html_url":"https://github.com/txdong-sz","followers_url":"https://api.github.com/users/txdong-sz/followers","following_url":"https://api.github.com/users/txdong-sz/following{/other_user}","gists_url":"https://api.github.com/users/txdong-sz/gists{/gist_id}","starred_url":"https://api.github.com/users/txdong-sz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/txdong-sz/subscriptions","organizations_url":"https://api.github.com/users/txdong-sz/orgs","repos_url":"https://api.github.com/users/txdong-sz/repos","events_url":"https://api.github.com/users/txdong-sz/events{/privacy}","received_events_url":"https://api.github.com/users/txdong-sz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T12:30:35Z","updated_at":"2021-02-04T12:30:35Z","author_association":"NONE","body":"i donnot know how to run a daily report by flink 1.12 iceberg sql table \r\n\r\ni write code like this but get a error \r\n\r\ncould u please help me ? thanks. \r\n\r\n\r\n\r\nbsEnv.setRuntimeMode(RuntimeExecutionMode.BATCH);\r\n\r\nString querySql = \"SELECT ftime,extinfo,country,province,operator,apn,gw,src_ip_head,info_str,product_id,app_version,sdk_id,sdk_version,hardware_os,qua,upload_ip,client_ip,upload_apn,event_code,event_result,package_size,consume_time,event_value,event_time,upload_time,boundle_id,uin,platform,os_version,channel,brand,model from bfzt3 \";\r\n\t\tTable table = tEnv.sqlQuery(querySql);\r\n\r\n\t\tDataStream<AttaInfo> sinkStream = tEnv.toAppendStream(table, Types.POJO(AttaInfo.class, map));\r\n\r\n\r\n\t\tsinkStream.map(x->1).returns(Types.INT).keyBy(new NullByteKeySelector<Integer>()).reduce((x,y) -> {\r\n\t\t\treturn x+y;\r\n\t\t}).print();\r\n\r\n\t\tsinkStream.addSink(new RichSinkFunction<AttaInfo>() {\r\n\t\t\t@Override\r\n\t\t\tpublic void invoke(AttaInfo value, Context context) throws Exception {\r\n\r\n\r\n\t\t\t\tMap<String, String> map2 = value.getEvent_value();\r\n\r\n\t\t\t\tmap2.entrySet().stream().forEach(x->{\r\n\r\n\t\t\t\t\tSystem.out.println(x.getKey()+\":\" + x.getValue());\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n![image](https://user-images.githubusercontent.com/5066512/106892630-4a211680-6727-11eb-901d-8a26852df9c1.png)\r\n\r\norg.apache.flink.client.program.ProgramInvocationException: The main method caused an error: Detected an UNBOUNDED source with the 'execution.runtime-mode' set to 'BATCH'. This combination is not allowed, please set the 'execution.runtime-mode' to STREAMING or AUTOMATIC\r\n        at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:360)\r\n        at org.apache.flink.client.program.PackagedProgram.invokeInteractiveModeForExecution(PackagedProgram.java:213)\r\n        at org.apache.flink.client.ClientUtils.executeProgram(ClientUtils.java:114)\r\n        at org.apache.flink.client.cli.CliFrontend.executeProgram(CliFrontend.java:816)\r\n        at org.apache.flink.client.cli.CliFrontend.run(CliFrontend.java:248)\r\n        at org.apache.flink.client.cli.CliFrontend.parseAndRun(CliFrontend.java:1058)\r\n        at org.apache.flink.client.cli.CliFrontend.lambda$main$10(CliFrontend.java:1136)\r\n        at java.security.AccessController.doPrivileged(Native Method)\r\n        at javax.security.auth.Subject.doAs(Subject.java:422)\r\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1754)\r\n        at org.apache.flink.runtime.security.contexts.HadoopSecurityContext.runSecured(HadoopSecurityContext.java:41)\r\n        at org.apache.flink.client.cli.CliFrontend.main(CliFrontend.java:1136)\r\nCaused by: java.lang.IllegalStateException: Detected an UNBOUNDED source with the 'execution.runtime-mode' set to 'BATCH'. This combination is not allowed, please set the 'execution.runtime-mode' to STREAMING or AUTOMATIC\r\n        at org.apache.flink.util.Preconditions.checkState(Preconditions.java:193)\r\n        at org.apache.flink.streaming.api.graph.StreamGraphGenerator.shouldExecuteInBatchMode(StreamGraphGenerator.java:335)\r\n        at org.apache.flink.streaming.api.graph.StreamGraphGenerator.generate(StreamGraphGenerator.java:258)\r\n        at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.getStreamGraph(StreamExecutionEnvironment.java:1958)\r\n        at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.getStreamGraph(StreamExecutionEnvironment.java:1943)\r\n        at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.execute(StreamExecutionEnvironment.java:1782)\r\n        at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.execute(StreamExecutionEnvironment.java:1765)\r\n        at com.tencent.ReadStreamingZt2Cos.main(ReadStreamingZt2Cos.java:132)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:343)\r\n        ... 11 more","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773271127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773333997","html_url":"https://github.com/apache/iceberg/pull/2212#issuecomment-773333997","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2212","id":773333997,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzMzMzk5Nw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T14:15:23Z","updated_at":"2021-02-04T14:15:23Z","author_association":"CONTRIBUTOR","body":"> Using the same constant `JOB_ID` across test runs can cause conflicts\r\n\r\nAs discussed offline, it would be good to double check this. The same `JOB_ID` conflict should have caused issues with other `TestHiveIcebergOutputCommitter` tests as well. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773333997/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773347726","html_url":"https://github.com/apache/iceberg/pull/2203#issuecomment-773347726","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2203","id":773347726,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzM0NzcyNg==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T14:23:02Z","updated_at":"2021-02-04T14:23:02Z","author_association":"CONTRIBUTOR","body":"> > NOTE: the HiveCatalog copies a new Hadoop Configuration which is a breaking change from how the constructor used to work. See HiveMetastoreTest changes for ramifications.\r\n> \r\n> Can you be more clear? I don't see anything major. What do you mean?\r\n\r\n`setConf` of `HiveCatalog` does `new Configuration(conf)` whereas the constructor we are removing doesn't copy it. To ensure changes to hadoop configs is visible in `HiveCatalog` the user has to change or re-`setConf`. Not a huge issue and probably the correct behaviour as far as we are concerned. But it did require changing a test and may have repercussions for end users.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773347726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773373588","html_url":"https://github.com/apache/iceberg/pull/2203#issuecomment-773373588","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2203","id":773373588,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzM3MzU4OA==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T15:00:53Z","updated_at":"2021-02-04T15:00:53Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @rdblue I have updated based on your comments. I have also gone ahead and removed the deprecated constructors but that kicked off a few other changes. Let me know if you prefer that as a separate PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773373588/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773378908","html_url":"https://github.com/apache/iceberg/issues/2202#issuecomment-773378908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2202","id":773378908,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzM3ODkwOA==","user":{"login":"tracycarley","id":49887680,"node_id":"MDQ6VXNlcjQ5ODg3Njgw","avatar_url":"https://avatars.githubusercontent.com/u/49887680?v=4","gravatar_id":"","url":"https://api.github.com/users/tracycarley","html_url":"https://github.com/tracycarley","followers_url":"https://api.github.com/users/tracycarley/followers","following_url":"https://api.github.com/users/tracycarley/following{/other_user}","gists_url":"https://api.github.com/users/tracycarley/gists{/gist_id}","starred_url":"https://api.github.com/users/tracycarley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tracycarley/subscriptions","organizations_url":"https://api.github.com/users/tracycarley/orgs","repos_url":"https://api.github.com/users/tracycarley/repos","events_url":"https://api.github.com/users/tracycarley/events{/privacy}","received_events_url":"https://api.github.com/users/tracycarley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T15:08:25Z","updated_at":"2021-02-04T15:08:25Z","author_association":"NONE","body":"> ```\r\n>         \"Parameters\": {\r\n>             \"table_type\": \"ICEBERG\",\r\n>             \"previous_metadata_location\": \"s3://iceberg-warehouse/iceberg_warehouse.db/iceberg_dummy_table/metadata/00039-5b28310e-6767-4eff-9ff9-8827c010870f.metadata.json\",\r\n>             \"metadata_location\": \"s3://iceberg_warehouse.db/iceberg_dummy_table/metadata/00040-d3069356-5ae6-4e76-9d33-63bfccfc04c8.metadata.json\"\r\n>         },\r\n> ```\r\n> \r\n> This looks correct to me. In the title you said \"table location not updated\", is this the updated location or not?\r\n> \r\n> For the schema issue, yes Glue UI currently does not support displaying Iceberg table schema, it is expected behavior, the shcema is stored in Iceberg's table metadata in S3.\r\n> \r\n> For Hive, AWS module is not tested and added to Hive runtime jar yet, I do not know if Hive supports loading dynamic catalog yet. Currently Hive is still considered an experimental engine, that's why we have not added support yet.\r\n\r\n@jackye1995 Any idea on when will the support be added for Glue (AWS) and Hive?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773378908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773385768","html_url":"https://github.com/apache/iceberg/pull/2212#issuecomment-773385768","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2212","id":773385768,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzM4NTc2OA==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T15:17:48Z","updated_at":"2021-02-04T15:17:48Z","author_association":"COLLABORATOR","body":"Closing this as a non-issue. Test was not flaky after all but related to changes in the OutputCommitter code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773385768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773474731","html_url":"https://github.com/apache/iceberg/pull/2182#issuecomment-773474731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2182","id":773474731,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzQ3NDczMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T17:23:12Z","updated_at":"2021-02-04T17:23:39Z","author_association":"CONTRIBUTOR","body":"@vvellanki, what I'm suggesting is to plan early and use the actual stats from the splits. You will need to do the planning at some point either way because you'll need to dispatch a task for each input split.\r\n\r\nAs for the time taken to plan a scan with more columns, you should take a look at the table properties to control metrics that are kept in table metadata. The [metrics properties start with `write.metadata.metrics`](http://iceberg.apache.org/configuration/#write-properties).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773474731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773477732","html_url":"https://github.com/apache/iceberg/pull/2129#issuecomment-773477732","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2129","id":773477732,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzQ3NzczMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T17:27:49Z","updated_at":"2021-02-04T17:27:49Z","author_association":"CONTRIBUTOR","body":"@lcspinter, please ping me when you've had a chance to either replace HiveCatalogs or remove the changes from that class.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773477732/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773480120","html_url":"https://github.com/apache/iceberg/issues/2202#issuecomment-773480120","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2202","id":773480120,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzQ4MDEyMA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T17:31:36Z","updated_at":"2021-02-04T17:31:36Z","author_association":"CONTRIBUTOR","body":"I don't have an ETA for Glue side UI change yet, will reply when I have it.\r\nFor Hive, it is probably worth trying to add the AWS module in Hive runtime, let me have a try in the next few days.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773480120/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773563936","html_url":"https://github.com/apache/iceberg/pull/2163#issuecomment-773563936","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2163","id":773563936,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzU2MzkzNg==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T19:51:50Z","updated_at":"2021-02-04T19:51:50Z","author_association":"COLLABORATOR","body":"Thanks a lot for your review, @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773563936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773583796","html_url":"https://github.com/apache/iceberg/pull/2191#issuecomment-773583796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2191","id":773583796,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzU4Mzc5Ng==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T20:27:50Z","updated_at":"2021-02-04T20:27:50Z","author_association":"COLLABORATOR","body":"Thanks for your review @pvary!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773583796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773596909","html_url":"https://github.com/apache/iceberg/pull/2213#issuecomment-773596909","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2213","id":773596909,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzU5NjkwOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T20:52:55Z","updated_at":"2021-02-04T20:52:55Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @dilipbiswal @RussellSpitzer @mehtaashish23 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773596909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773662070","html_url":"https://github.com/apache/iceberg/issues/2068#issuecomment-773662070","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2068","id":773662070,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzY2MjA3MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T23:06:58Z","updated_at":"2021-02-04T23:06:58Z","author_association":"CONTRIBUTOR","body":"Just catching up on this thread.\r\n\r\nI agree with everything that @electrum said. Strong expectations help us. But we also need to have a way to handle existing data. That comes up all the time. Most existing data is tracked by name.\r\n\r\nTo support existing data files, we built name mappings so that you can take table data that previously identified columns by name and attach IDs. As long as the files that used name-based schema evolution are properly mapped, the Iceberg table can carry on with id-based resolution without problems. I think this is a reasonable path forward to get schema IDs.\r\n\r\nPosition-based schema evolution isn't very popular and doesn't work well with nested structures, so I think we should focus on name-based.\r\n\r\nI completely agree that we need to read part of each data file. For Parquet, we need to get column stats at a minimum, but we should also validate that at least one column is readable.\r\n\r\nI think that means that we have a few things to do to formally support this:\r\n1. Add name mapping to the Iceberg spec so that it is well-defined and we have test cases to validate\r\n2. Document how name mappings change when a schema evolves (allows adding aliases)\r\n3. Make sure that when we import files, there is a name mapping set for the table\r\n4. Build correct metadata from imported files based on the name mapping\r\n5. Identify problems with the name mapping, like files with no readable / mapped fields or incompatible data types\r\n\r\nOne last issue to note is how to get the partition for a data file. The current import code assumes that files are coming from a Hive table layout and converts the path to partition values as Hive would. We will need to make sure that an import procedure has a plan for handling this.\r\n\r\nAnd I should note that only Hive partition paths can be parsed. Iceberg purposely makes no guarantee that partition values can be recovered from paths and considers partition values to path conversion to be one-way. So we may want to have a way to pass the partition tuple. A struct is one option, but that makes it especially hard to use the date transforms. Another option is to import everything at the top level, or to try to infer values from lower/upper bounds in column stats.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773662070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773680667","html_url":"https://github.com/apache/iceberg/pull/2213#issuecomment-773680667","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2213","id":773680667,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzY4MDY2Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-04T23:53:49Z","updated_at":"2021-02-04T23:54:01Z","author_association":"CONTRIBUTOR","body":"This PR helped to detect an issue fixed in #2215. I'll rebase once merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773680667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773694335","html_url":"https://github.com/apache/iceberg/pull/2159#issuecomment-773694335","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2159","id":773694335,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzY5NDMzNQ==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T00:27:47Z","updated_at":"2021-02-05T00:27:47Z","author_association":"CONTRIBUTOR","body":"I closed this PR because Dan had a valid point if we need to pay the extra check for the rare cases of part upload failure. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773694335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773730670","html_url":"https://github.com/apache/iceberg/pull/2213#issuecomment-773730670","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2213","id":773730670,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzczMDY3MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T02:06:23Z","updated_at":"2021-02-05T02:06:23Z","author_association":"CONTRIBUTOR","body":"The underlying issue was merged, I rebased this PR as well. It is ready for review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773730670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773754797","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-773754797","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":773754797,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mzc1NDc5Nw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T03:11:37Z","updated_at":"2021-02-05T03:11:37Z","author_association":"CONTRIBUTOR","body":"> The main method caused an error: Detected an UNBOUNDED source with the 'execution.runtime-mode' set to 'BATCH'. This combination is not allowed, please set the 'execution.runtime-mode' to STREAMING or AUTOMATIC\r\n\r\nyour flink source is streaming source(UNBOUNDED),but you set the exectioin mode is BATCH.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773754797/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773759475","html_url":"https://github.com/apache/iceberg/pull/2213#issuecomment-773759475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2213","id":773759475,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mzc1OTQ3NQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T03:24:56Z","updated_at":"2021-02-05T03:24:56Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi Nice !!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773759475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773860134","html_url":"https://github.com/apache/iceberg/pull/2129#issuecomment-773860134","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2129","id":773860134,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mzg2MDEzNA==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T07:49:00Z","updated_at":"2021-02-05T07:49:00Z","author_association":"CONTRIBUTOR","body":"@rdblue I've reverted the changes in HiveCatalogs class. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773860134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773890650","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-773890650","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":773890650,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mzg5MDY1MA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T08:51:54Z","updated_at":"2021-02-05T08:51:54Z","author_association":"CONTRIBUTOR","body":"@openinx @stevenzwu could you help me review it ? thanks ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773890650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773940415","html_url":"https://github.com/apache/iceberg/pull/2119#issuecomment-773940415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2119","id":773940415,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mzk0MDQxNQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T10:20:11Z","updated_at":"2021-02-05T10:20:11Z","author_association":"CONTRIBUTOR","body":"@Jecarm: I really appreciate your work and sorry for being slow with the review (had to stop because of a meeting). I feel that we are almost there.\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773940415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773942196","html_url":"https://github.com/apache/iceberg/pull/2191#issuecomment-773942196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2191","id":773942196,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mzk0MjE5Ng==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T10:23:17Z","updated_at":"2021-02-05T10:23:17Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix @marton-bod ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/773942196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774019528","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-774019528","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":774019528,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDAxOTUyOA==","user":{"login":"caseylucas","id":517834,"node_id":"MDQ6VXNlcjUxNzgzNA==","avatar_url":"https://avatars.githubusercontent.com/u/517834?v=4","gravatar_id":"","url":"https://api.github.com/users/caseylucas","html_url":"https://github.com/caseylucas","followers_url":"https://api.github.com/users/caseylucas/followers","following_url":"https://api.github.com/users/caseylucas/following{/other_user}","gists_url":"https://api.github.com/users/caseylucas/gists{/gist_id}","starred_url":"https://api.github.com/users/caseylucas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/caseylucas/subscriptions","organizations_url":"https://api.github.com/users/caseylucas/orgs","repos_url":"https://api.github.com/users/caseylucas/repos","events_url":"https://api.github.com/users/caseylucas/events{/privacy}","received_events_url":"https://api.github.com/users/caseylucas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T13:02:03Z","updated_at":"2021-02-05T13:02:03Z","author_association":"NONE","body":"\r\nI work with Asha, so chiming in (and seeking guidance):\r\n\r\nAssumptions:\r\n1. There will N destination Iceberg tables that have *different schemas*.\r\n2. N will grow over time and may be large - probably unreasonable to have a growing number of Kafka topics.\r\n\r\nSo the scenario looks like:\r\n```\r\n1. data for all N destinations (packaged up with some discriminator)\r\n--->\r\n2. single Kafka topic\r\n--->\r\n3. Flink job (reading from Kafka source)\r\n--->\r\n4. N Iceberg tables\r\n```\r\n\r\nIn step 3 & 4, I assume there would need to be some demultiplexing - selecting the\r\nappropriate Iceberg table dynamically.  There are some options for doing this with\r\nKafka (https://stackoverflow.com/questions/45391877/apache-flink-dynamic-number-of-sinks) -\r\nallowing runtime selection of a destination topic\r\n(https://ci.apache.org/projects/flink/flink-docs-release-1.3/api/java/org/apache/flink/streaming/util/serialization/KeyedSerializationSchema.html),\r\nbut the Iceberg Sink doesn't appear to currently support this scenario.\r\n\r\nBeing new to Iceberg and Flink, I'm wondering if this demultiplexing needs to be implemented\r\nin the Iceberg Flink sink or maybe there is some built in Flink support or concept that we're\r\nmissing.\r\n\r\nIf demultiplexing needs to be built into the Flink sink, are there any issues that should be\r\nconsidered before we go down the path of implementing such a strategy?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774019528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774178386","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-774178386","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":774178386,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDE3ODM4Ng==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T17:36:07Z","updated_at":"2021-02-05T19:04:31Z","author_association":"CONTRIBUTOR","body":"Yeah, a single Kafka producer/sink supports writing to multiple Kafka topics as long as they are all on the same Kafka cluster. It is a comfortable situation for Kafka. However, it is not without some penalty though, as it will affect data batching and impact disk I/O on the broker side. \r\n\r\nIt is very expensive (and maybe impractical) for a single Iceberg sink to support growing and large number tables. The writers would need to keep many open files. That could lead to memory pressure for writer tasks. When it is time to checkpoint and commit, the writers need to flush and upload files for hundreds of tables and the committer needs to commit hundreds of tables. That would be very slow. I would suggest doing the demux before the sink jobs to Iceberg.\r\n\r\nAlso if you have single Kafka topic holding different and growing number of datasets, you also loose the benefit of schema validation when ingesting data to Kafka. Having separate Kafka topic and schema validation for each dataset may also help with the data quality.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774178386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774179675","html_url":"https://github.com/apache/iceberg/pull/1872#issuecomment-774179675","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1872","id":774179675,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDE3OTY3NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T17:38:27Z","updated_at":"2021-02-05T17:38:27Z","author_association":"CONTRIBUTOR","body":"Thanks @yyanyy! Looks great. I merged it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774179675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774208295","html_url":"https://github.com/apache/iceberg/issues/2068#issuecomment-774208295","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2068","id":774208295,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDIwODI5NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T18:29:28Z","updated_at":"2021-02-05T18:29:28Z","author_association":"CONTRIBUTOR","body":"I finally found time to get through recent comments. I believe the discussion is moving in the right direction. \r\n\r\n> 1. Add name mapping to the Iceberg spec so that it is well-defined and we have test cases to validate\r\n> 2. Document how name mappings change when a schema evolves (allows adding aliases)\r\n\r\n+1. We have tested how name mappings behave when a schema is evolved (e.g. simple cases like adding columns in the middle). That seems to work fine even when the imported files don't have column ids.\r\n\r\n> 3. Make sure that when we import files, there is a name mapping set for the table.\r\n\r\nI think we are already doing it in the snapshot and migrate procedures for Spark. If we are to add `add_files`, we can assign a default name mapping too.\r\n\r\n> 4. Build correct metadata from imported files based on the name mapping.\r\n\r\nWe try to respect name mappings while importing files in Spark (not sure about Trino) but we trust the name mapping is correct.\r\n\r\n> 5. Identify problems with the name mapping, like files with no readable / mapped fields or incompatible data types\r\n\r\nIt sounds like we should enhance our import code that currently reads footers to import stats to also perform schema checks?\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774208295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774209863","html_url":"https://github.com/apache/iceberg/issues/2068#issuecomment-774209863","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2068","id":774209863,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDIwOTg2Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T18:32:33Z","updated_at":"2021-02-05T18:32:33Z","author_association":"CONTRIBUTOR","body":"Also, I'd probably limit `add_files` to importing only existing files, not something one should do with files written through Iceberg. The primary use case is probably CREATE TABLE LIKE and then calling `add_files` for a couple of partitions to try reads/writes or migrating partition by partition if a table has too many partitions to migrate them at once. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774209863/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774213770","html_url":"https://github.com/apache/iceberg/pull/2210#issuecomment-774213770","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2210","id":774213770,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDIxMzc3MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T18:36:23Z","updated_at":"2021-02-05T18:36:23Z","author_association":"CONTRIBUTOR","body":"Thanks for working on this, @RussellSpitzer! Let me take a look today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774213770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774233172","html_url":"https://github.com/apache/iceberg/pull/1918#issuecomment-774233172","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1918","id":774233172,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDIzMzE3Mg==","user":{"login":"johnclara","id":9331049,"node_id":"MDQ6VXNlcjkzMzEwNDk=","avatar_url":"https://avatars.githubusercontent.com/u/9331049?v=4","gravatar_id":"","url":"https://api.github.com/users/johnclara","html_url":"https://github.com/johnclara","followers_url":"https://api.github.com/users/johnclara/followers","following_url":"https://api.github.com/users/johnclara/following{/other_user}","gists_url":"https://api.github.com/users/johnclara/gists{/gist_id}","starred_url":"https://api.github.com/users/johnclara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnclara/subscriptions","organizations_url":"https://api.github.com/users/johnclara/orgs","repos_url":"https://api.github.com/users/johnclara/repos","events_url":"https://api.github.com/users/johnclara/events{/privacy}","received_events_url":"https://api.github.com/users/johnclara/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T19:14:27Z","updated_at":"2021-02-05T19:14:27Z","author_association":"NONE","body":"@rdblue starting to look at this again. will post a refactor with a lot changed soon","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774233172/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774242073","html_url":"https://github.com/apache/iceberg/issues/2068#issuecomment-774242073","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2068","id":774242073,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDI0MjA3Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T19:30:32Z","updated_at":"2021-02-05T19:30:32Z","author_association":"CONTRIBUTOR","body":"I think @RussellSpitzer's implementation in PR #2210 is a pretty reasonable example of what we can do. We need to improve the code in `SparkTableUtil` to also perform extra checks while reading the footer, but it seems independent from the PR.\r\n\r\nThere is one point we should discuss on this thread. Should we allow importing a path which forces us to infer partitioning or should we always assume we import a single partition?  More details are in [this](https://github.com/apache/iceberg/pull/2210/files#r571191846) comment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774242073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774269683","html_url":"https://github.com/apache/iceberg/issues/1894#issuecomment-774269683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1894","id":774269683,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDI2OTY4Mw==","user":{"login":"nchammas","id":1039369,"node_id":"MDQ6VXNlcjEwMzkzNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1039369?v=4","gravatar_id":"","url":"https://api.github.com/users/nchammas","html_url":"https://github.com/nchammas","followers_url":"https://api.github.com/users/nchammas/followers","following_url":"https://api.github.com/users/nchammas/following{/other_user}","gists_url":"https://api.github.com/users/nchammas/gists{/gist_id}","starred_url":"https://api.github.com/users/nchammas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nchammas/subscriptions","organizations_url":"https://api.github.com/users/nchammas/orgs","repos_url":"https://api.github.com/users/nchammas/repos","events_url":"https://api.github.com/users/nchammas/events{/privacy}","received_events_url":"https://api.github.com/users/nchammas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T20:26:26Z","updated_at":"2021-02-05T20:26:26Z","author_association":"NONE","body":"I'm getting a similar exception on Spark 3.0.1 / Iceberg 0.11, though I don't understand the title of this issue, so perhaps my problem is unrelated.\r\n\r\nI was just trying to rewrite some Parquet data as an Iceberg table:\r\n\r\n```python\r\n(\r\n    partition_balanced_data\r\n    .write\r\n    .format('iceberg')\r\n    .partitionBy(partition_by_columns)\r\n    .save('s3://.../exposure-iceberg/')\r\n)\r\n```\r\n\r\nHere's the stack trace:\r\n\r\n```\r\n21/02/05 20:15:51 WARN TaskSetManager: Lost task 1151.0 in stage 14.0 (TID 295528, ip-10-0-10-131.ec2.internal, executor 1751): TaskKilled (Stage cancelled)\r\npy4j.protocol.Py4JJavaError: An error occurred while calling o140.save.\r\n: org.apache.spark.SparkException: Writing job aborted.\r\n        at org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.writeWithV2(WriteToDataSourceV2Exec.scala:413)\r\n        at org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.writeWithV2$(WriteToDataSourceV2Exec.scala:361)\r\n        at org.apache.spark.sql.execution.datasources.v2.AtomicCreateTableAsSelectExec.writeWithV2(WriteToDataSourceV2Exec.scala:118)\r\n        at org.apache.spark.sql.execution.datasources.v2.AtomicTableWriteExec.$anonfun$writeToStagedTable$1(WriteToDataSourceV2Exec.scala:500)\r\n        at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1411)\r\n        at org.apache.spark.sql.execution.datasources.v2.AtomicTableWriteExec.writeToStagedTable(WriteToDataSourceV2Exec.scala:489)\r\n        at org.apache.spark.sql.execution.datasources.v2.AtomicTableWriteExec.writeToStagedTable$(WriteToDataSourceV2Exec.scala:485)\r\n        at org.apache.spark.sql.execution.datasources.v2.AtomicCreateTableAsSelectExec.writeToStagedTable(WriteToDataSourceV2Exec.scala:118)\r\n        at org.apache.spark.sql.execution.datasources.v2.AtomicCreateTableAsSelectExec.run(WriteToDataSourceV2Exec.scala:138)\r\n        at org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result$lzycompute(V2CommandExec.scala:39)\r\n        at org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result(V2CommandExec.scala:39)\r\n        at org.apache.spark.sql.execution.datasources.v2.V2CommandExec.doExecute(V2CommandExec.scala:54)\r\n        at org.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:180)\r\n        at org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:218)\r\n        at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n        at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:215)\r\n        at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:176)\r\n        at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:124)\r\n        at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:123)\r\n        at org.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:963)\r\n        at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:104)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:227)\r\n        at org.apache.spark.sql.execution.SQLExecution$.executeQuery$1(SQLExecution.scala:107)\r\n        at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:132)\r\n        at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:104)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:227)\r\n        at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:132)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:248)\r\n        at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:131)\r\n        at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\r\n        at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:68)\r\n        at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:963)\r\n        at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:382)\r\n        at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:288)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n        at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n        at py4j.Gateway.invoke(Gateway.java:282)\r\n        at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n        at py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n        at py4j.GatewayConnection.run(GatewayConnection.java:238)\r\n        at java.lang.Thread.run(Thread.java:748)\r\nCaused by: org.apache.spark.SparkException: Job aborted due to stage failure: Task 277 in stage 14.0 failed 4 times, most recent failure: Lost task 277.3 in stage 14.0 (TID 295505, ip-10-0-10-34.ec2.internal, executor 1935): java.lang.IllegalStateException: Already closed files for partition: exposure_data_source_id=883/exposure_date_utc=2020-12-20\r\n        at org.apache.iceberg.io.PartitionedWriter.write(PartitionedWriter.java:69)\r\n        at org.apache.spark.sql.execution.datasources.v2.DataWritingSparkTask$.$anonfun$run$7(WriteToDataSourceV2Exec.scala:441)\r\n        at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1411)\r\n        at org.apache.spark.sql.execution.datasources.v2.DataWritingSparkTask$.run(WriteToDataSourceV2Exec.scala:477)\r\n        at org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.$anonfun$writeWithV2$2(WriteToDataSourceV2Exec.scala:385)\r\n        at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n        at org.apache.spark.scheduler.Task.run(Task.scala:127)\r\n        at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:446)\r\n        at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1377)\r\n        at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:449)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at java.lang.Thread.run(Thread.java:748)\r\n\r\nDriver stacktrace:\r\n        at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2215)\r\n        at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2164)\r\n        at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2163)\r\n        at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)\r\n        at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)\r\n        at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)\r\n        at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2163)\r\n        at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1013)\r\n        at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1013)\r\n        at scala.Option.foreach(Option.scala:407)\r\n        at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1013)\r\n        at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2395)\r\n        at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2344)\r\n        at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2333)\r\n        at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)\r\n        at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:815)\r\n        at org.apache.spark.SparkContext.runJob(SparkContext.scala:2099)\r\n        at org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.writeWithV2(WriteToDataSourceV2Exec.scala:382)\r\n        ... 44 more\r\nCaused by: java.lang.IllegalStateException: Already closed files for partition: exposure_data_source_id=883/exposure_date_utc=2020-12-20\r\n        at org.apache.iceberg.io.PartitionedWriter.write(PartitionedWriter.java:69)\r\n        at org.apache.spark.sql.execution.datasources.v2.DataWritingSparkTask$.$anonfun$run$7(WriteToDataSourceV2Exec.scala:441)\r\n        at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1411)\r\n        at org.apache.spark.sql.execution.datasources.v2.DataWritingSparkTask$.run(WriteToDataSourceV2Exec.scala:477)\r\n        at org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.$anonfun$writeWithV2$2(WriteToDataSourceV2Exec.scala:385)\r\n        at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n        at org.apache.spark.scheduler.Task.run(Task.scala:127)\r\n        at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:446)\r\n        at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1377)\r\n        at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:449)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        ... 1 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774269683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774276183","html_url":"https://github.com/apache/iceberg/issues/1894#issuecomment-774276183","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1894","id":774276183,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDI3NjE4Mw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T20:38:53Z","updated_at":"2021-02-05T20:42:06Z","author_association":"MEMBER","body":"\"Already closed files\" tends to occur when the write data was not actually partitioned on the correct columns. This is an error that says the data within a Spark Partition contained data for multiple Iceberg Partitions and that this data was not ordered correctly. IE there was a record for Iceberg partition A, then one for Iceberg partition B, then one for A again.\r\n\r\nSo my guess would be that `partition_by_columns` does not match the table","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774276183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774284421","html_url":"https://github.com/apache/iceberg/issues/1894#issuecomment-774284421","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1894","id":774284421,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDI4NDQyMQ==","user":{"login":"nchammas","id":1039369,"node_id":"MDQ6VXNlcjEwMzkzNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1039369?v=4","gravatar_id":"","url":"https://api.github.com/users/nchammas","html_url":"https://github.com/nchammas","followers_url":"https://api.github.com/users/nchammas/followers","following_url":"https://api.github.com/users/nchammas/following{/other_user}","gists_url":"https://api.github.com/users/nchammas/gists{/gist_id}","starred_url":"https://api.github.com/users/nchammas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nchammas/subscriptions","organizations_url":"https://api.github.com/users/nchammas/orgs","repos_url":"https://api.github.com/users/nchammas/repos","events_url":"https://api.github.com/users/nchammas/events{/privacy}","received_events_url":"https://api.github.com/users/nchammas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T20:56:50Z","updated_at":"2021-02-05T20:56:50Z","author_association":"NONE","body":"Hmm, I guess my mental model of how Iceberg works is incorrect.\r\n\r\nWhat does it mean for the `partitionBy()` columns to \"not match the table\"? I thought that `partitionBy()` was an output directive, allowing me to read in a table partitioned one way and write it out partitioned a different way.\r\n\r\nI'm not using any catalogs here. The `partition_balanced_data` DataFrame was read directly from an S3 path. There are 3 partitioning columns on the original data. I am attempting to write this data out to a separate location on S3 with only 2 partitioning columns.\r\n\r\nSo the partitioning columns on the output _do_ differ from the source table, but I'm confused as to why this would matter to Iceberg.\r\n\r\nIn other words, what's wrong with this contrived example?\r\n\r\n```python\r\ndata = spark.createDataFrame([(1, 2, 3, 4)], schema=['a', 'b', 'c', 'd'])\r\ndata.write.partitionBy(['a', 'b', 'c']).parquet('./data')\r\ndata = spark.read.parquet('./data')\r\ndata.write.format('iceberg').partitionBy(['a', 'b']).save('./data-iceberg')\r\n```\r\n\r\nThis example code actually works, but I am understanding from your comment that there may be something incorrect about it. This is roughly what I was trying to do when I got the stack trace I posted above.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774284421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774303754","html_url":"https://github.com/apache/iceberg/issues/1894#issuecomment-774303754","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1894","id":774303754,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDMwMzc1NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T21:41:40Z","updated_at":"2021-02-05T21:51:57Z","author_association":"MEMBER","body":"All Iceberg tables exist in the context of a Catalog. If you haven't specified one and just provided a path it is using the implied \"HadoopCatalog\". The table will have It's own Metadata.json file which will specify the schema of the table and partition spec. Once created, that is the schema and partition spec until it is specifically altered.\r\n\r\nSo in your example \"./data-iceberg\" will be treated as a HadoopTable and look in that directory for a Metadata.json with a specified schema and partitioning. If such a file did not exist you would get an error like\r\n\r\n```scala\r\nspark.read.parquet(\"/Users/russellspitzer/Temp/parquet_data\").write.format(\"iceberg\").save(\"/Users/russellspitzer/Temp/iceberg_table\")\r\norg.apache.iceberg.exceptions.NoSuchTableException: Table does not exist at location: /Users/russellspitzer/Temp/iceberg_table\r\n```\r\n\r\nSince you didn't get such an error means that a table does exist there and it has a schema.\r\n\r\nWhen attempting attempting to write Spark saw \"partitionBy\" \"a\", \"b\", and preformed a shuffle on the input data\r\nSo all spark partitions are now like\r\n\r\n```\r\nSparkPartition 1 - > (1,1,1,1) , (1,1,2,1), (1,1,1,3) ...\r\nSparkPartition 2 -> (1,2,1,1), (1,2,2,1), (1,2,1,2) ...\r\nSparkPartition 3 -> (2,4,1,1), (2,4,2,1), (2,4,1,2) ...\r\n```\r\n\r\nThe first two values are always the same within the spark partition, but the last two are in a random order.\r\n\r\nThen the Iceberg writer gets one of these partitions and it creates a writer based on it's Metadata.json which let's say is not\r\nthe same as the `partitionedBy` argument. For this example let's say the table is actually partitioned by 'c'\r\n\r\nBy default in Spark Iceberg's writer opens a file for each partition assumes it will write all the values for that partition, then close the file. If it tries to write partition 1 it ends up doing the following\r\n\r\n```\r\n(1,1,1,1) -> Open partition c = 1 and start new file\r\n(1,1,2,1) -> Close partition c = 1 file; Open partition c =2  and start new file\r\n(1,1,1,3) -> Open partition c = 1 /// Error already closed file for Partition c=1\r\n```\r\n\r\nSince this is a runtime check you won't see this error with a single row since that will always be able to open and close the file without incident, but a dataset with multiple rows can potentially trigger this. Most of the time you want this Spark partitioning to match the Iceberg partitioning because this minimizes the number of files you need to actually write.\r\n\r\nIf you really don't want to have the Spark Partitioning match for some reason you can use the sortWithinPartitions to order the data within the partitions by their Iceberg partition values.\r\n\r\nThe other possibility is to use the new spark fanout writer which keeps all of the files open until they entire task has been completed.\r\n\r\nNeither of these solutions is really as good as having your data partitioned like the data is expecting since that minimizes the number of files being written since all the files for a given partition will be done by the same Spark Task.\r\n\r\n\r\nAn example\r\n```scala\r\nscala> spark.sql(\"CREATE table ice.default.part (x Int, y Int) USING iceberg partitioned by (x) location '/Users/russellspitzer/Temp/iceberg_table'\");\r\nval df = spark.createDataFrame(Seq((1,1),(1,2),(1,3),(2,1),(2,2),(2,3),(3,1),(3,2),(3,3))).toDF(\"x\",\"y\")\r\nscala> df.write.format(\"iceberg\").partitionBy(\"x\").mode(\"overwrite\").saveAsTable(\"ice.default.part\")\r\n// No Error\r\nscala> df.write.format(\"iceberg\").partitionBy(\"y\").mode(\"overwrite\").saveAsTable(\"ice.default.part\")\r\n// Many errors\r\n// Caused by: java.lang.IllegalStateException: Already closed files for partition: y=1\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774303754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774305299","html_url":"https://github.com/apache/iceberg/issues/1894#issuecomment-774305299","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1894","id":774305299,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDMwNTI5OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T21:45:21Z","updated_at":"2021-02-05T21:45:21Z","author_association":"MEMBER","body":"https://iceberg.apache.org/spark-writes/#writing-to-partitioned-tables - Docs on this issue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774305299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774313769","html_url":"https://github.com/apache/iceberg/issues/1894#issuecomment-774313769","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1894","id":774313769,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDMxMzc2OQ==","user":{"login":"nchammas","id":1039369,"node_id":"MDQ6VXNlcjEwMzkzNjk=","avatar_url":"https://avatars.githubusercontent.com/u/1039369?v=4","gravatar_id":"","url":"https://api.github.com/users/nchammas","html_url":"https://github.com/nchammas","followers_url":"https://api.github.com/users/nchammas/followers","following_url":"https://api.github.com/users/nchammas/following{/other_user}","gists_url":"https://api.github.com/users/nchammas/gists{/gist_id}","starred_url":"https://api.github.com/users/nchammas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nchammas/subscriptions","organizations_url":"https://api.github.com/users/nchammas/orgs","repos_url":"https://api.github.com/users/nchammas/repos","events_url":"https://api.github.com/users/nchammas/events{/privacy}","received_events_url":"https://api.github.com/users/nchammas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-05T22:05:52Z","updated_at":"2021-02-05T22:05:52Z","author_association":"NONE","body":"Thank you for the detailed examples. I think I understand now. I guess this issue becomes transparent to the user once [SPARK-23889](https://issues.apache.org/jira/browse/SPARK-23889) is resolved, as called out in the docs you linked to.\r\n\r\nThere is one thing you said I am still confused about though:\r\n\r\n> Since you didn't get such an error means that a table does exist there and it has a schema.\r\n\r\nFor some reason, I am able to save to previously non-existent Iceberg locations just fine:\r\n\r\n```\r\n$ pyspark --packages org.apache.iceberg:iceberg-spark3-runtime:0.11.0\r\nWelcome to\r\n      ____              __\r\n     / __/__  ___ _____/ /__\r\n    _\\ \\/ _ \\/ _ `/ __/  '_/\r\n   /__ / .__/\\_,_/_/ /_/\\_\\   version 3.0.1\r\n      /_/\r\n\r\nUsing Python version 3.9.1 (default, Feb  3 2021 07:38:02)\r\n>>> import uuid\r\n>>> spark.range(3).write.format('iceberg').save('./' + str(uuid.uuid4()))\r\n$ ll\r\ndrwxr-xr-x - user  5 Feb 16:59 0f7e86eb-c8d8-467b-9499-845fa90acbe7\r\n$ ll 0f7e86eb-c8d8-467b-9499-845fa90acbe7/\r\ndrwxr-xr-x - user  5 Feb 16:59 data\r\ndrwxr-xr-x - user  5 Feb 16:59 metadata\r\n```\r\n\r\nSeparate issue, but I just wanted to point that out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774313769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774365397","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-774365397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":774365397,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM2NTM5Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T00:56:34Z","updated_at":"2021-02-06T00:56:34Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @rdblue, thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774365397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774365830","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-774365830","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":774365830,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM2NTgzMA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T00:58:45Z","updated_at":"2021-02-06T00:58:45Z","author_association":"MEMBER","body":"I think that's reasonable, better than full subquery support :) One thing I worry about is we have a bunch of code which relies on the snapshot chain being fully connected. So if we have Snapshots A, B, C and remove B, will we have issues?\r\n\r\nAlso this means we will have to extend the parser to also handle Array types I think","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774365830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774378949","html_url":"https://github.com/apache/iceberg/pull/2220#issuecomment-774378949","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2220","id":774378949,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM3ODk0OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T02:03:14Z","updated_at":"2021-02-06T02:03:14Z","author_association":"CONTRIBUTOR","body":"> The current default (unbound file sizes) will never take advantage of any predicate push down\r\n\r\nI'm not sure I understand what you're saying here. Why would this prevent predicate pushdown? Large files with unordered data may have larger and larger ranges, but the happens quickly in even a single row group. To get effective file pruning, you need to cluster data by filter columns. If you're doing that, then I would say that larger files _diminish_ the benefit of pusdown, but don't preclude it. And, parallelism concerns typically force people to create small files because writes are faster that way.\r\n\r\nI'm not sure this is needed, although I don't really have a problem with adding it. I'd also like to hear what Anton thinks.\r\n\r\n@szehon-ho, good to see you in this community!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774378949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774379247","html_url":"https://github.com/apache/iceberg/pull/2218#issuecomment-774379247","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2218","id":774379247,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM3OTI0Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T02:05:02Z","updated_at":"2021-02-06T02:05:02Z","author_association":"CONTRIBUTOR","body":"Thanks, @shardulm94! Great to have this fixed!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774379247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774380580","html_url":"https://github.com/apache/iceberg/pull/2149#issuecomment-774380580","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2149","id":774380580,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM4MDU4MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T02:14:28Z","updated_at":"2021-02-06T02:14:28Z","author_association":"CONTRIBUTOR","body":"I'm closing this since there was no reply. Feel free to reopen if you have time to pick it back up.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774380580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774385594","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-774385594","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":774385594,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM4NTU5NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T02:53:01Z","updated_at":"2021-02-06T02:53:01Z","author_association":"CONTRIBUTOR","body":"Hm, I'm not sure it's a good idea to age off individual snapshots. It is safe for the parallel operation, but it can cause issues with incremental snapshot expiration because of assumptions that snapshots are expired linearly. Maybe that's okay since the deletes happen using the reachability set?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774385594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774386338","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-774386338","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":774386338,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM4NjMzOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T02:58:06Z","updated_at":"2021-02-06T02:58:06Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @rdblue, isn't it a use case we allow in the Table and Actions APIs?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774386338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774386906","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-774386906","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":774386906,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM4NjkwNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T03:03:09Z","updated_at":"2021-02-06T03:03:09Z","author_association":"CONTRIBUTOR","body":"I think expiring B in A, B, C should be fine as we will have a union of all files referenced by A and C as our reachability set.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774386906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774387008","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-774387008","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":774387008,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM4NzAwOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T03:04:03Z","updated_at":"2021-02-06T03:04:03Z","author_association":"CONTRIBUTOR","body":"Plus, expiring by ids may be useful if a snapshot was rolled back, for example.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774387008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774388990","html_url":"https://github.com/apache/iceberg/pull/2222#issuecomment-774388990","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2222","id":774388990,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM4ODk5MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T03:20:10Z","updated_at":"2021-02-06T03:20:10Z","author_association":"CONTRIBUTOR","body":"cc @dilipbiswal @rdblue @mehtaashish23 @RussellSpitzer","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774388990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774389870","html_url":"https://github.com/apache/iceberg/pull/2220#issuecomment-774389870","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2220","id":774389870,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM4OTg3MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T03:26:59Z","updated_at":"2021-02-06T03:26:59Z","author_association":"CONTRIBUTOR","body":"I think we would want to use this property more after we refine our data compaction. Having this value as Long.MaxValue does not make much sense to me if we treat it as the target file size (not the max file size, like it is now). Internally, we have changed the default value quite some time ago. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774389870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774390316","html_url":"https://github.com/apache/iceberg/pull/2220#issuecomment-774390316","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2220","id":774390316,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM5MDMxNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T03:30:57Z","updated_at":"2021-02-06T03:30:57Z","author_association":"CONTRIBUTOR","body":"I'd support changing the default value but I admit my interpretation may be different from other folks in the community.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774390316/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774392711","html_url":"https://github.com/apache/iceberg/pull/2222#issuecomment-774392711","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2222","id":774392711,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM5MjcxMQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T03:50:40Z","updated_at":"2021-02-06T03:50:40Z","author_association":"MEMBER","body":"Is this just a move of the tests?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774392711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774513998","html_url":"https://github.com/apache/iceberg/pull/2220#issuecomment-774513998","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2220","id":774513998,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDUxMzk5OA==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T17:46:02Z","updated_at":"2021-02-06T17:46:02Z","author_association":"COLLABORATOR","body":"Hi @rdblue  thanks, yea nice to see you, hope I can ramp up and contribute more to the iceberg project, it is really growing~  \r\n\r\nYou are right, I definitely phrased it wrong, \"reduce\" is what I meant to say.  Having this does not affect pruning at the partition or row-group level.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774513998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774643313","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-774643313","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":774643313,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDY0MzMxMw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-07T09:40:05Z","updated_at":"2021-02-07T09:40:05Z","author_association":"CONTRIBUTOR","body":"@stevenzwu thanks for you review,I updated all","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774643313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]