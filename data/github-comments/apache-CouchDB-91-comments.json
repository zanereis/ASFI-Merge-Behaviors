[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/657399911","html_url":"https://github.com/apache/couchdb/issues/2941#issuecomment-657399911","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2941","id":657399911,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NzM5OTkxMQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-13T08:16:30Z","updated_at":"2020-07-13T08:16:30Z","author_association":"MEMBER","body":"Agreed this is a real bug and the cause is the commit you pointed out (123bf82370c21a8b5458299a7e36c477a0fedca4). The state is then passed as an option, and set_options (rightly) crashes if passed an unexpected option.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/657399911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/657560277","html_url":"https://github.com/apache/couchdb/issues/2941#issuecomment-657560277","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2941","id":657560277,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NzU2MDI3Nw==","user":{"login":"kathy1121","id":67960577,"node_id":"MDQ6VXNlcjY3OTYwNTc3","avatar_url":"https://avatars.githubusercontent.com/u/67960577?v=4","gravatar_id":"","url":"https://api.github.com/users/kathy1121","html_url":"https://github.com/kathy1121","followers_url":"https://api.github.com/users/kathy1121/followers","following_url":"https://api.github.com/users/kathy1121/following{/other_user}","gists_url":"https://api.github.com/users/kathy1121/gists{/gist_id}","starred_url":"https://api.github.com/users/kathy1121/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kathy1121/subscriptions","organizations_url":"https://api.github.com/users/kathy1121/orgs","repos_url":"https://api.github.com/users/kathy1121/repos","events_url":"https://api.github.com/users/kathy1121/events{/privacy}","received_events_url":"https://api.github.com/users/kathy1121/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-13T13:27:32Z","updated_at":"2020-07-13T13:27:32Z","author_association":"NONE","body":"Thanks Markus, I met the same issue and solved as you suggested. Much appreciate!!!!!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/657560277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/657639527","html_url":"https://github.com/apache/couchdb/issues/2941#issuecomment-657639527","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2941","id":657639527,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NzYzOTUyNw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-13T15:49:25Z","updated_at":"2020-07-13T15:49:25Z","author_association":"CONTRIBUTOR","body":"Merged the fix to 3.x branch: https://github.com/apache/couchdb/pull/3001\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/657639527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658165113","html_url":"https://github.com/apache/couchdb/issues/3004#issuecomment-658165113","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3004","id":658165113,"node_id":"MDEyOklzc3VlQ29tbWVudDY1ODE2NTExMw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-14T13:00:32Z","updated_at":"2020-07-14T13:00:32Z","author_association":"MEMBER","body":"`pread:iolist()` errors usually point to file corruption. Can you delete the index files for that view and rebuild them?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658165113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658185729","html_url":"https://github.com/apache/couchdb/issues/3004#issuecomment-658185729","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3004","id":658185729,"node_id":"MDEyOklzc3VlQ29tbWVudDY1ODE4NTcyOQ==","user":{"login":"tkrapp","id":1519437,"node_id":"MDQ6VXNlcjE1MTk0Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/1519437?v=4","gravatar_id":"","url":"https://api.github.com/users/tkrapp","html_url":"https://github.com/tkrapp","followers_url":"https://api.github.com/users/tkrapp/followers","following_url":"https://api.github.com/users/tkrapp/following{/other_user}","gists_url":"https://api.github.com/users/tkrapp/gists{/gist_id}","starred_url":"https://api.github.com/users/tkrapp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tkrapp/subscriptions","organizations_url":"https://api.github.com/users/tkrapp/orgs","repos_url":"https://api.github.com/users/tkrapp/repos","events_url":"https://api.github.com/users/tkrapp/events{/privacy}","received_events_url":"https://api.github.com/users/tkrapp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-14T13:40:34Z","updated_at":"2020-07-14T13:40:34Z","author_association":"NONE","body":"> `pread:iolist()` errors usually point to file corruption. Can you delete the index files for that view and rebuild them?\r\n\r\nThanks for the fast reply. We've rebuilt the views by changing them a little bit (e.g. adding space characters) which should do the trick but the error occurred again after one or two days :-(","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658185729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658229486","html_url":"https://github.com/apache/couchdb/pull/3003#issuecomment-658229486","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3003","id":658229486,"node_id":"MDEyOklzc3VlQ29tbWVudDY1ODIyOTQ4Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-14T14:57:27Z","updated_at":"2020-07-14T16:19:01Z","author_association":"CONTRIBUTOR","body":"@tonysun83 \r\n\r\nAgree with @garrensmith, for reporting the job on all the nodes, it might be easier to think of something like this:\r\n\r\n  * Add an `<<\"active_task_status\">>` section to each job's data section, already converted to json format.\r\n\r\n  * In the http handler we would query all the active jobs and just emit those json objects. All active jobs are conveniently  located under a single `?ACTIVITY` subspace and can be queried with [get_active_since/3]( https://github.com/apache/couchdb/blob/prototype/fdb-layer/src/couch_jobs/src/couch_jobs_fdb.erl#L358) (it was done that way on purpose to make it simple to query all active jobs in order to report _active_tasks easier ðŸ˜‰ ).\r\n\r\n * To get all the possible job types can use [get_types](https://github.com/apache/couchdb/blob/prototype/fdb-layer/src/couch_jobs/src/couch_jobs_fdb.erl#L321). \r\n\r\n * Since we'd be calling those outside of couch_jobs we could add a new function to `couch_jobs`, something like `get_active_jobs` perhaps.\r\n \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658229486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658238750","html_url":"https://github.com/apache/couchdb/issues/3004#issuecomment-658238750","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3004","id":658238750,"node_id":"MDEyOklzc3VlQ29tbWVudDY1ODIzODc1MA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-14T15:13:56Z","updated_at":"2020-07-14T15:13:56Z","author_association":"MEMBER","body":"can you do the delete route I mentioned. make sure to also delete any lingering .compact files.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658238750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658241580","html_url":"https://github.com/apache/couchdb/issues/3004#issuecomment-658241580","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3004","id":658241580,"node_id":"MDEyOklzc3VlQ29tbWVudDY1ODI0MTU4MA==","user":{"login":"tkrapp","id":1519437,"node_id":"MDQ6VXNlcjE1MTk0Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/1519437?v=4","gravatar_id":"","url":"https://api.github.com/users/tkrapp","html_url":"https://github.com/tkrapp","followers_url":"https://api.github.com/users/tkrapp/followers","following_url":"https://api.github.com/users/tkrapp/following{/other_user}","gists_url":"https://api.github.com/users/tkrapp/gists{/gist_id}","starred_url":"https://api.github.com/users/tkrapp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tkrapp/subscriptions","organizations_url":"https://api.github.com/users/tkrapp/orgs","repos_url":"https://api.github.com/users/tkrapp/repos","events_url":"https://api.github.com/users/tkrapp/events{/privacy}","received_events_url":"https://api.github.com/users/tkrapp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-14T15:18:51Z","updated_at":"2020-07-14T15:18:51Z","author_association":"NONE","body":"We also encountered this error #2941 while digging deeper into the log files and we did delete these .compact files. For now it seems to work. We will observe the issue the next few days and give you an update here.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658241580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658242422","html_url":"https://github.com/apache/couchdb/issues/3004#issuecomment-658242422","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3004","id":658242422,"node_id":"MDEyOklzc3VlQ29tbWVudDY1ODI0MjQyMg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-14T15:20:21Z","updated_at":"2020-07-14T15:20:21Z","author_association":"MEMBER","body":"cool, reopen when new things come in","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658242422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658372488","html_url":"https://github.com/apache/couchdb/issues/1600#issuecomment-658372488","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1600","id":658372488,"node_id":"MDEyOklzc3VlQ29tbWVudDY1ODM3MjQ4OA==","user":{"login":"pavellzubkov","id":18612709,"node_id":"MDQ6VXNlcjE4NjEyNzA5","avatar_url":"https://avatars.githubusercontent.com/u/18612709?v=4","gravatar_id":"","url":"https://api.github.com/users/pavellzubkov","html_url":"https://github.com/pavellzubkov","followers_url":"https://api.github.com/users/pavellzubkov/followers","following_url":"https://api.github.com/users/pavellzubkov/following{/other_user}","gists_url":"https://api.github.com/users/pavellzubkov/gists{/gist_id}","starred_url":"https://api.github.com/users/pavellzubkov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavellzubkov/subscriptions","organizations_url":"https://api.github.com/users/pavellzubkov/orgs","repos_url":"https://api.github.com/users/pavellzubkov/repos","events_url":"https://api.github.com/users/pavellzubkov/events{/privacy}","received_events_url":"https://api.github.com/users/pavellzubkov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-14T19:35:05Z","updated_at":"2020-07-14T22:46:11Z","author_association":"NONE","body":"now i get same error with ibmcom/couchdb3:3.1.0 image on windows desktop docker (v 2.3.0.3). \r\ni have Ryzen7 3700u proc, 16gb Ram , SSD\r\nlast errors:\r\n```\r\n[error] 2020-07-14T19:16:09.909029Z couchdb@127.0.0.1 <0.18562.88> 23794d840a req_err(50502807) unknown_error : normal\r\n    [<<\"chttpd:catch_error/3 L358\">>,<<\"chttpd:handle_req_after_auth/2 L324\">>,<<\"chttpd:process_request/1 L305\">>,<<\"chttpd:handle_request_int/1 L243\">>,<<\"mochiweb_http:headers/6 L150\">>,<<\"proc_lib:init_p_do_apply/3 L247\">>]\r\n[error] 2020-07-14T19:16:09.915970Z couchdb@127.0.0.1 <0.19757.88> cd5af352db req_err(50502807) unknown_error : normal\r\n    [<<\"chttpd:catch_error/3 L358\">>,<<\"chttpd:handle_req_after_auth/2 L324\">>,<<\"chttpd:process_request/1 L305\">>,<<\"chttpd:handle_request_int/1 L243\">>,<<\"mochiweb_http:headers/6 L150\">>,<<\"proc_lib:init_p_do_apply/3 L247\">>]\r\n[error] 2020-07-14T19:17:08.686461Z couchdb@127.0.0.1 <0.31109.97> 0eceb5635e req_err(50502807) unknown_error : normal\r\n    [<<\"chttpd:catch_error/3 L358\">>,<<\"chttpd:handle_req_after_auth/2 L324\">>,<<\"chttpd:process_request/1 L305\">>,<<\"chttpd:handle_request_int/1 L243\">>,<<\"mochiweb_http:headers/6 L150\">>,<<\"proc_lib:init_p_do_apply/3 L247\">>]\r\n[error] 2020-07-14T19:17:08.703069Z couchdb@127.0.0.1 <0.31500.97> 924c75301e req_err(50502807) unknown_error : normal\r\n    [<<\"chttpd:catch_error/3 L358\">>,<<\"chttpd:handle_req_after_auth/2 L324\">>,<<\"chttpd:process_request/1 L305\">>,<<\"chttpd:handle_request_int/1 L243\">>,<<\"mochiweb_http:headers/6 L150\">>,<<\"proc_lib:init_p_do_apply/3 L247\">>]\r\n```\r\ncouchdb server fall down and not responding. docker container didn't restart.\r\nstrange thing...\r\nI tried unsuccessfully to restart container with docker-compose . in terminal not errors, in log file not errors, but couchdb server didn't response. \r\n..... **ok i've catch it**\r\n. For develop my app i using yandex browser (based on chromium). When user login, i started replication with pouchdb to local db, then user logout. If user fast login/logout approx 4 times (without starting pouchdb replication it not happen), then DELETE request to _session from browser failed, but couchdb server respond ok from other browser in same time - not fall down. Server not respond from yandex browser while tab with broken DELETE request to _session point opened.  Strange errors in couch logs appears when broken tab closed or when pouchdb client with continuous replication sent DELETE request to _session .  Now i test in other browsers - Opera and Firefox - same problem, Google chrome better, but also block logout request for several seconds.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658372488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658466132","html_url":"https://github.com/apache/couchdb/issues/1600#issuecomment-658466132","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1600","id":658466132,"node_id":"MDEyOklzc3VlQ29tbWVudDY1ODQ2NjEzMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-14T23:44:20Z","updated_at":"2020-07-14T23:44:20Z","author_association":"MEMBER","body":"Sounds like a browser problem - nothing we can do here.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658466132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658466201","html_url":"https://github.com/apache/couchdb/issues/1600#issuecomment-658466201","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1600","id":658466201,"node_id":"MDEyOklzc3VlQ29tbWVudDY1ODQ2NjIwMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-14T23:44:34Z","updated_at":"2020-07-14T23:44:34Z","author_association":"MEMBER","body":"Whoops, sorry, didn't mean to close this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658466201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658566334","html_url":"https://github.com/apache/couchdb/issues/1600#issuecomment-658566334","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1600","id":658566334,"node_id":"MDEyOklzc3VlQ29tbWVudDY1ODU2NjMzNA==","user":{"login":"pavellzubkov","id":18612709,"node_id":"MDQ6VXNlcjE4NjEyNzA5","avatar_url":"https://avatars.githubusercontent.com/u/18612709?v=4","gravatar_id":"","url":"https://api.github.com/users/pavellzubkov","html_url":"https://github.com/pavellzubkov","followers_url":"https://api.github.com/users/pavellzubkov/followers","following_url":"https://api.github.com/users/pavellzubkov/following{/other_user}","gists_url":"https://api.github.com/users/pavellzubkov/gists{/gist_id}","starred_url":"https://api.github.com/users/pavellzubkov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavellzubkov/subscriptions","organizations_url":"https://api.github.com/users/pavellzubkov/orgs","repos_url":"https://api.github.com/users/pavellzubkov/repos","events_url":"https://api.github.com/users/pavellzubkov/events{/privacy}","received_events_url":"https://api.github.com/users/pavellzubkov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-15T06:10:07Z","updated_at":"2020-07-15T06:10:07Z","author_association":"NONE","body":"Now i stop pouchdb replications before user logout and all ok. No errors in couch log, all works fine. Obviously couchdb generate errors  and hold connection opened when user with opened live replications sent DELETE request to _session.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658566334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658838147","html_url":"https://github.com/apache/couchdb/issues/1600#issuecomment-658838147","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1600","id":658838147,"node_id":"MDEyOklzc3VlQ29tbWVudDY1ODgzODE0Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-15T15:33:41Z","updated_at":"2020-07-15T15:33:41Z","author_association":"MEMBER","body":"> I think at least in my case these errors are simply a result of the client dropping its connection to CouchDB.\r\n\r\nThis is the current best likely reason for this issue, unless anyone else has reasons this may be occurring.\r\n\r\n@iilyak 's theory is not applicable because we see this without any node in MM.\r\n\r\nSuppressing these logging comments is probably the only thing that needs to happen here, anyone want to have a go at a PR?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/658838147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659082929","html_url":"https://github.com/apache/couchdb/pull/2982#issuecomment-659082929","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2982","id":659082929,"node_id":"MDEyOklzc3VlQ29tbWVudDY1OTA4MjkyOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-16T00:23:11Z","updated_at":"2020-07-16T00:23:11Z","author_association":"MEMBER","body":"The machine is ready now and just needs the CNAMEs.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659082929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659082944","html_url":"https://github.com/apache/couchdb/pull/2983#issuecomment-659082944","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2983","id":659082944,"node_id":"MDEyOklzc3VlQ29tbWVudDY1OTA4Mjk0NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-16T00:23:15Z","updated_at":"2020-07-16T00:23:15Z","author_association":"MEMBER","body":"The machine is ready now and just needs the CNAMEs.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659082944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659238198","html_url":"https://github.com/apache/couchdb/issues/2962#issuecomment-659238198","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2962","id":659238198,"node_id":"MDEyOklzc3VlQ29tbWVudDY1OTIzODE5OA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-16T08:14:31Z","updated_at":"2020-07-16T08:14:31Z","author_association":"MEMBER","body":"hm, I swear I had asked for more info here, but now Iâ€™m completely blanking. Sorry for the confusing tag.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659238198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659238520","html_url":"https://github.com/apache/couchdb/issues/2962#issuecomment-659238520","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2962","id":659238520,"node_id":"MDEyOklzc3VlQ29tbWVudDY1OTIzODUyMA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-16T08:15:07Z","updated_at":"2020-07-16T08:15:07Z","author_association":"MEMBER","body":"Ah yes, weâ€™d need all your design docs in the affected db.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659238520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659777028","html_url":"https://github.com/apache/couchdb/issues/2962#issuecomment-659777028","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2962","id":659777028,"node_id":"MDEyOklzc3VlQ29tbWVudDY1OTc3NzAyOA==","user":{"login":"teebu","id":5531844,"node_id":"MDQ6VXNlcjU1MzE4NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5531844?v=4","gravatar_id":"","url":"https://api.github.com/users/teebu","html_url":"https://github.com/teebu","followers_url":"https://api.github.com/users/teebu/followers","following_url":"https://api.github.com/users/teebu/following{/other_user}","gists_url":"https://api.github.com/users/teebu/gists{/gist_id}","starred_url":"https://api.github.com/users/teebu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/teebu/subscriptions","organizations_url":"https://api.github.com/users/teebu/orgs","repos_url":"https://api.github.com/users/teebu/repos","events_url":"https://api.github.com/users/teebu/events{/privacy}","received_events_url":"https://api.github.com/users/teebu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-17T01:35:03Z","updated_at":"2020-07-17T01:35:03Z","author_association":"NONE","body":"I am unable to provide that.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659777028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659787923","html_url":"https://github.com/apache/couchdb/issues/2962#issuecomment-659787923","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2962","id":659787923,"node_id":"MDEyOklzc3VlQ29tbWVudDY1OTc4NzkyMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-17T02:05:30Z","updated_at":"2020-07-17T02:05:30Z","author_association":"MEMBER","body":"Can you try a newer version of CouchDB, specifically CouchDB 3.1.0 running on either Ubuntu 20.04 or Debian 10 (or our Docker container)? These have a newer version of CouchJS in them that may affect the results.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/659787923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/660024367","html_url":"https://github.com/apache/couchdb/issues/2962#issuecomment-660024367","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2962","id":660024367,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MDAyNDM2Nw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-17T10:26:22Z","updated_at":"2020-07-17T10:26:22Z","author_association":"MEMBER","body":"please reopen with sample ddocs if this happens on the systems @wohali mentioned.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/660024367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/660159224","html_url":"https://github.com/apache/couchdb/issues/1878#issuecomment-660159224","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1878","id":660159224,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MDE1OTIyNA==","user":{"login":"glrao","id":5660633,"node_id":"MDQ6VXNlcjU2NjA2MzM=","avatar_url":"https://avatars.githubusercontent.com/u/5660633?v=4","gravatar_id":"","url":"https://api.github.com/users/glrao","html_url":"https://github.com/glrao","followers_url":"https://api.github.com/users/glrao/followers","following_url":"https://api.github.com/users/glrao/following{/other_user}","gists_url":"https://api.github.com/users/glrao/gists{/gist_id}","starred_url":"https://api.github.com/users/glrao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glrao/subscriptions","organizations_url":"https://api.github.com/users/glrao/orgs","repos_url":"https://api.github.com/users/glrao/repos","events_url":"https://api.github.com/users/glrao/events{/privacy}","received_events_url":"https://api.github.com/users/glrao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-17T15:07:20Z","updated_at":"2020-07-17T15:07:20Z","author_association":"NONE","body":"is this issue resolved in any other next version 2.1.x ?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/660159224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/660167376","html_url":"https://github.com/apache/couchdb/issues/1878#issuecomment-660167376","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1878","id":660167376,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MDE2NzM3Ng==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-17T15:22:37Z","updated_at":"2020-07-17T15:22:37Z","author_association":"CONTRIBUTOR","body":"@glrao afaik not","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/660167376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/661471365","html_url":"https://github.com/apache/couchdb/issues/2471#issuecomment-661471365","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2471","id":661471365,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MTQ3MTM2NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-21T00:09:41Z","updated_at":"2020-07-21T00:09:41Z","author_association":"MEMBER","body":"I've filed https://issues.apache.org/jira/browse/INFRA-20564 for this, with the description \"Seamless multi-master syncing database with an intuitive HTTP/JSON API, designed for reliability\".","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/661471365/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/661754880","html_url":"https://github.com/apache/couchdb/pull/3017#issuecomment-661754880","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3017","id":661754880,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MTc1NDg4MA==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-21T09:46:53Z","updated_at":"2020-07-21T09:46:53Z","author_association":"MEMBER","body":"(Importing all the history)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/661754880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662325652","html_url":"https://github.com/apache/couchdb/pull/3017#issuecomment-662325652","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3017","id":662325652,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjMyNTY1Mg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-22T08:41:55Z","updated_at":"2020-07-22T08:41:55Z","author_association":"MEMBER","body":"I skimmed this over and ti looks _very_ clean. Great job everybody involved!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662325652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662430312","html_url":"https://github.com/apache/couchdb/pull/2992#issuecomment-662430312","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2992","id":662430312,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjQzMDMxMg==","user":{"login":"jjrodrig","id":1001724,"node_id":"MDQ6VXNlcjEwMDE3MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1001724?v=4","gravatar_id":"","url":"https://api.github.com/users/jjrodrig","html_url":"https://github.com/jjrodrig","followers_url":"https://api.github.com/users/jjrodrig/followers","following_url":"https://api.github.com/users/jjrodrig/following{/other_user}","gists_url":"https://api.github.com/users/jjrodrig/gists{/gist_id}","starred_url":"https://api.github.com/users/jjrodrig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jjrodrig/subscriptions","organizations_url":"https://api.github.com/users/jjrodrig/orgs","repos_url":"https://api.github.com/users/jjrodrig/repos","events_url":"https://api.github.com/users/jjrodrig/events{/privacy}","received_events_url":"https://api.github.com/users/jjrodrig/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-22T12:41:56Z","updated_at":"2020-07-22T12:41:56Z","author_association":"CONTRIBUTOR","body":"Thanks @dottorblaster ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662430312/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662529977","html_url":"https://github.com/apache/couchdb/pull/3003#issuecomment-662529977","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3003","id":662529977,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjUyOTk3Nw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-22T15:45:38Z","updated_at":"2020-07-22T15:50:33Z","author_association":"CONTRIBUTOR","body":"@tonysun83 looks better! Good improvement. I made a few comments-in line.\r\n\r\nOne part that I am not sure if it is worth starting two transactions per task item just to compute version stamps and maybe a few other fields. That seems quite expensive if, say, someone is polling status on a cluster with hundreds of tasks, given that jobs already have the dbs open and all that data available to start with. The reason we decided to do that was to ensure we are below 100KB for JobData, I think?\r\n\r\nWe'd have to make a convincing case that our active_jobs status section in each JobData would have a chance of pushing it over the 100KB value limit. I tried encoding a large-ish object similar to the one we are adding for the task status:\r\n\r\n```\r\nS = #{\r\n    <<\"database\">> => << <<\"x\">> || _ <- lists:seq(1,256) >>,\r\n    <<\"changes_done\">> => 999999999999999999999999999999,\r\n    <<\"design_document\">> => << <<\"d\">> || _ <- lists:seq(1,512) >>,\r\n    <<\"current_version_stamp\">> => <<\"1111111111111111111111111111111111111111\">>,\r\n    <<\"db_version_stamp\">> => <<\"222222222222222222222222222222222222222222222\">>\r\n}.\r\n```\r\n\r\n```\r\n>> size(iolist_to_binary(jiffy:encode(S))).\r\n984\r\n```\r\n\r\nSo we'd be adding at most another 1KB (in the worst case) to get closer to the 100KB limit if we save the status in the job data that doesn't seem that bad perhaps and it would simplify the design quite a bit more.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662529977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662550336","html_url":"https://github.com/apache/couchdb/pull/3024#issuecomment-662550336","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3024","id":662550336,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjU1MDMzNg==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-22T16:21:39Z","updated_at":"2020-07-22T16:22:22Z","author_association":"MEMBER","body":"With this feature, we can add aegis support with an encode_fun like this;\r\n\r\n```\r\n    EncodeFun = fun\r\n        (encode, Key, Term) ->\r\n            Bin = term_to_binary(Term, [compressed, {minor_version, 2}]),\r\n            aegis:encrypt(TxDb, Key, Bin);\r\n        (decode, Key, Ciphertext) ->\r\n            Bin = aegis:decrypt(TxDb, Key, Ciphertext),\r\n            binary_to_term(Bin, [safe])\r\n    end.\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662550336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662552156","html_url":"https://github.com/apache/couchdb/pull/3003#issuecomment-662552156","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3003","id":662552156,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjU1MjE1Ng==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-22T16:25:01Z","updated_at":"2020-07-22T16:25:01Z","author_association":"MEMBER","body":"I'm actually counting three possible transactions between opening the database if its not in cache, one for the reading the design doc, then one for the other two bits of info.\r\n\r\nCan someone point me to the discussion where we decided to move away from storing active task info in the job state? I'm not seeing how this is a better approach or why the job state approach is unworkable.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662552156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662557731","html_url":"https://github.com/apache/couchdb/pull/3003#issuecomment-662557731","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3003","id":662557731,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjU1NzczMQ==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-22T16:34:33Z","updated_at":"2020-07-22T16:35:11Z","author_association":"CONTRIBUTOR","body":"@davisp : Here was @garrensmith 's concern https://github.com/apache/couchdb/pull/3003#discussion_r457145064. But I think I found a compromise and pushed (now the populate_tasks function is way simpler without the reads). We really just need to add two new items to the JobData info: <<\"changes_done\">> and <<\"db_seq\">>","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662557731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662563321","html_url":"https://github.com/apache/couchdb/pull/3003#issuecomment-662563321","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3003","id":662563321,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjU2MzMyMQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-22T16:45:32Z","updated_at":"2020-07-22T16:45:32Z","author_association":"MEMBER","body":"@tonysun83 The history of this PR is super confusing to me. The last update appears to have reverted to storing all of the info back in the job state which means that this new populate_active_tasks is just \"format_job_as_active_task\". Which is fine I suppose. Though it seems like it'd be a lot more straightforward for the jobs to just store what they want their active_task output to look like in the first place?\r\n\r\nAdding a whole registration/callback system for this seems much more complex than the original plan to just spit out the job data as JSON.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662563321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662571992","html_url":"https://github.com/apache/couchdb/pull/3003#issuecomment-662571992","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3003","id":662571992,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjU3MTk5Mg==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-22T17:02:47Z","updated_at":"2020-07-22T17:02:47Z","author_association":"CONTRIBUTOR","body":"@davisp:  agreed that it's gotten way more complex. I think @nickva thought that the registration callback would help with the sizing issue, and as a side benefit, add flexibility for future `active_task` types (I know replication is next). I'm leaning toward the simpler method like we did previously without the callback but would like  @nickva  to chime in here since he would know what we would need for replication.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662571992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662582624","html_url":"https://github.com/apache/couchdb/pull/3003#issuecomment-662582624","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3003","id":662582624,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjU4MjYyNA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-22T17:24:41Z","updated_at":"2020-07-22T17:26:08Z","author_association":"CONTRIBUTOR","body":"@tonysun83:  Agree with @davisp, it's not worth having the registration system just for this.\r\n\r\nWe could still hide the `<<\"active_task_info\">>` field name with a simple library function like \r\n\r\n```\r\nfabric2_active_tasks:update_active_task_info(JobData, ActiveTaskInfo) ->\r\n     JobData#{?ACTIVE_TASK_INFO => ActiveTaskInfo}.\r\n```\r\n\r\nAnd use the original design https://github.com/apache/couchdb/pull/3003#issuecomment-658229486\r\n\r\n>  I think @nickva thought that the registration callback would help with the sizing issue\r\n\r\nThe registration would have helped with encapsulation, if we had a size issue and had to compute the section on the fly to avoid the http handle hard-coding knowledge about the replication and indexing apps.  But I think we determined computing on the fly was not as optimal, and it wasn't adding that much more to the job data size. If we ever do need to compute it on the fly, we could also come back add the complexity later.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662582624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662843026","html_url":"https://github.com/apache/couchdb/pull/3022#issuecomment-662843026","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3022","id":662843026,"node_id":"MDEyOklzc3VlQ29tbWVudDY2Mjg0MzAyNg==","user":{"login":"jjrodrig","id":1001724,"node_id":"MDQ6VXNlcjEwMDE3MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1001724?v=4","gravatar_id":"","url":"https://api.github.com/users/jjrodrig","html_url":"https://github.com/jjrodrig","followers_url":"https://api.github.com/users/jjrodrig/followers","following_url":"https://api.github.com/users/jjrodrig/following{/other_user}","gists_url":"https://api.github.com/users/jjrodrig/gists{/gist_id}","starred_url":"https://api.github.com/users/jjrodrig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jjrodrig/subscriptions","organizations_url":"https://api.github.com/users/jjrodrig/orgs","repos_url":"https://api.github.com/users/jjrodrig/repos","events_url":"https://api.github.com/users/jjrodrig/events{/privacy}","received_events_url":"https://api.github.com/users/jjrodrig/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-23T06:38:47Z","updated_at":"2020-07-23T06:38:47Z","author_association":"CONTRIBUTOR","body":"Thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662843026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662866086","html_url":"https://github.com/apache/couchdb/pull/3018#issuecomment-662866086","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3018","id":662866086,"node_id":"MDEyOklzc3VlQ29tbWVudDY2Mjg2NjA4Ng==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-23T07:46:19Z","updated_at":"2020-07-23T07:46:19Z","author_association":"MEMBER","body":"This PR is ready for a first review. Some notes about the design:\r\n\r\n1. I don't store the map values in the b-tree. I only store the reduce results. That means the leaf nodes contain the size of the reduce values and the reduce values. I didn't want do store duplicates of the map k/v in the b-tree that doesn't make any sense to me. \r\n\r\n2. I have a separate b-tree for each reduce function. So if we have a map function that has multiple reduce functions each reduce is in its own b-tree. I've done this to limit the size of the k/v's and nodes in the b-tree so that we are less likely to exceed any of FDB's k/v size limits when we have a higher order for a b-tree. \r\n\r\n3. I don't have very good tests yet for the size calculation. I'm still trying to decide the best approach for that. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662866086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662925449","html_url":"https://github.com/apache/couchdb/pull/3018#issuecomment-662925449","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3018","id":662925449,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjkyNTQ0OQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-23T10:10:57Z","updated_at":"2020-07-23T10:10:57Z","author_association":"MEMBER","body":"Thanks for taking a look @rnewson \r\n\r\n> your 1 and 2 strike me as the wrong approach though I think I see your reasoning. The first items claim to \"store the reduce results\" is misleading to the casual reader as, without something like ebtree and its storage of data on inner nodes, it's not possible to calculate useful intermediation reductions. What I think you're doing is reducing the k-v's emitted by a single document? If so, that is not something that CouchDB has done to date and seems to have limited value, certainly in the common case that a map function emits one row per document.\r\n\r\n> A simple design that uses less space over all would be to insert the emitted keys and values directly into ebtree and pass in a reducer function that calculates each of the desired reductions specified, and store those in a tuple or a map. couch_views can then call ebtree's functions for lookup (?key=), ranges (for ?startkey=X&endkey=Y&reduce=false) and the various reduce functions as needed (group=true, group_level=X, reduce=true). This ensures we only store each distinct thing once and the logic gets much simpler.\r\n\r\nI'm currently doing this, if a document emits the following from a map function:\r\n```\r\n([1, 1], 1)\r\n([1, 1], 2)\r\n([3, 3], 1)\r\n```\r\n\r\nThen the reduce results for a `_sum` would be:\r\n```\r\n([1, 1], 3)\r\n([3, 3], 1)\r\n```\r\n\r\nI would then store those values like this in ebtree\r\n\r\n```\r\n(([1, 1], doc_id), (KVSize, 3))\r\n(([3, 3], doc_id), (KVSize, 1))\r\n```\r\n\r\nI know this is different to how CouchDB had done in the previously. But I don't see what we would gain from storing the map index a second time. Querying the current map index should be faster than reading from the b-tree since we can do a range scan of the map index. I'm really not comfortable using ebtree for the map index. We would need to determine how performant it would be to do that and what advantages we would get. I would really like to keep ebtree just for the reduce part. I'm very cautious on the idea of using it outside of that. I think if we start loosing a lot of the functionality we get with FDB. \r\n\r\n>Finally, on insertion generally, if it's possible to do even a small amount of batching we'll reap considerable performance rewards. For the case where we update the view atomically with the document, obviously that can't happen, but for new indexes it would be good if we would update 10 or 20 documents per fdb txn that involves an ebtree. Insert performance would be approximately 10x / 20x faster.\r\n\r\nThis is already done in `couch_views_indexer`. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/662925449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663171318","html_url":"https://github.com/apache/couchdb/pull/3003#issuecomment-663171318","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3003","id":663171318,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzE3MTMxOA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-23T18:46:06Z","updated_at":"2020-07-23T18:46:06Z","author_association":"CONTRIBUTOR","body":"@nickva addressed your latest comments and added a test. Will add more tests later and then rebase with a proper commit history.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663171318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663181606","html_url":"https://github.com/apache/couchdb/pull/3003#issuecomment-663181606","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3003","id":663181606,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzE4MTYwNg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-23T19:07:48Z","updated_at":"2020-07-23T19:07:48Z","author_association":"CONTRIBUTOR","body":"@tonysun83 looks great! awesome work. Just a few minor nits, whitespace and indents and such","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663181606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663229809","html_url":"https://github.com/apache/couchdb/issues/3028#issuecomment-663229809","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3028","id":663229809,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzIyOTgwOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-23T21:00:22Z","updated_at":"2020-07-23T21:00:22Z","author_association":"MEMBER","body":"We don't advertise this, but you can use our downloadable MSI to install to a machine, then copy the entire installation folder somewhere else. It's 100% portable.\r\n\r\nJust don't install the service, and beware of any folder permissions when copying that folder around.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663229809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663246100","html_url":"https://github.com/apache/couchdb/pull/3022#issuecomment-663246100","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3022","id":663246100,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzI0NjEwMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-23T21:40:14Z","updated_at":"2020-07-23T21:40:14Z","author_association":"MEMBER","body":"Plz to keep backporting to 3.x, as we're still seeing occasional JS test suite issues there...and a 3.x release is coming up in a week or two.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663246100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663527706","html_url":"https://github.com/apache/couchdb/pull/2627#issuecomment-663527706","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2627","id":663527706,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzUyNzcwNg==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-24T13:03:52Z","updated_at":"2020-07-24T13:03:52Z","author_association":"CONTRIBUTOR","body":"close in favor of https://github.com/apache/couchdb-config/pull/30","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663527706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663731643","html_url":"https://github.com/apache/couchdb/issues/2858#issuecomment-663731643","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2858","id":663731643,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzczMTY0Mw==","user":{"login":"gesellix","id":432791,"node_id":"MDQ6VXNlcjQzMjc5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/432791?v=4","gravatar_id":"","url":"https://api.github.com/users/gesellix","html_url":"https://github.com/gesellix","followers_url":"https://api.github.com/users/gesellix/followers","following_url":"https://api.github.com/users/gesellix/following{/other_user}","gists_url":"https://api.github.com/users/gesellix/gists{/gist_id}","starred_url":"https://api.github.com/users/gesellix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gesellix/subscriptions","organizations_url":"https://api.github.com/users/gesellix/orgs","repos_url":"https://api.github.com/users/gesellix/repos","events_url":"https://api.github.com/users/gesellix/events{/privacy}","received_events_url":"https://api.github.com/users/gesellix/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-24T20:59:00Z","updated_at":"2020-07-24T21:04:44Z","author_association":"NONE","body":"Hey there, I stumbled upon the same issue using CouchDB 3.1.0 and I think #2797 should not have been closed with #2798.\r\n\r\nThe log message `uuid set to ...` caught my eye when using the workaround via `GET /`:\r\n\r\n```\r\ncouchdb1_1  | [notice] 2020-07-24T20:46:41.473471Z couchdb@172.16.238.11 <0.88.0> -------- config: [couchdb] uuid set to 84a3191a25a2955130956d131232f98b for reason nil\r\ncouchdb1_1  | [notice] 2020-07-24T20:46:41.481822Z couchdb@172.16.238.11 <0.1868.0> 2bc6d8040a localhost:15984 172.19.0.1 admin GET / 200 ok 20\r\n```\r\n\r\nWhen manually setting a uuid on the coordinating node everything worked fine (no `GET /` or `sleep 3` necessary).\r\n\r\nSo, an unset or empty uuid on the coordinating node seems to make the `finish_cluster` action fail. A fresh node even throws an error when trying to get its uuid:\r\n\r\n```\r\ncurl --user admin:password 'http://localhost:5984/_node/_local/_config/couchdb/uuid'\r\n{\"error\":\"not_found\",\"reason\":\"unknown_config_value\"}\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663731643/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663913013","html_url":"https://github.com/apache/couchdb/issues/3028#issuecomment-663913013","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3028","id":663913013,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzkxMzAxMw==","user":{"login":"DiegoJArg","id":25246225,"node_id":"MDQ6VXNlcjI1MjQ2MjI1","avatar_url":"https://avatars.githubusercontent.com/u/25246225?v=4","gravatar_id":"","url":"https://api.github.com/users/DiegoJArg","html_url":"https://github.com/DiegoJArg","followers_url":"https://api.github.com/users/DiegoJArg/followers","following_url":"https://api.github.com/users/DiegoJArg/following{/other_user}","gists_url":"https://api.github.com/users/DiegoJArg/gists{/gist_id}","starred_url":"https://api.github.com/users/DiegoJArg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DiegoJArg/subscriptions","organizations_url":"https://api.github.com/users/DiegoJArg/orgs","repos_url":"https://api.github.com/users/DiegoJArg/repos","events_url":"https://api.github.com/users/DiegoJArg/events{/privacy}","received_events_url":"https://api.github.com/users/DiegoJArg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-25T22:37:39Z","updated_at":"2020-07-25T22:37:55Z","author_association":"NONE","body":"Hi sr.\r\nCould you expand this answer for future searches?\r\nI see that in windows it is runned as a service, while on Mac as a systray icon.\r\nI cant find the systray application for windows if I choose not to install the service.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663913013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663913171","html_url":"https://github.com/apache/couchdb/issues/3028#issuecomment-663913171","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3028","id":663913171,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzkxMzE3MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-25T22:39:51Z","updated_at":"2020-07-25T22:39:51Z","author_association":"MEMBER","body":"@jacobidiego \r\n\r\nYou can't \"install portably\" and \"run as a service,\" that doesn't make any sense on Windows.\r\n\r\nThe Mac App is unique to Mac and doesn't exist on Windows.\r\n\r\nIf you want to launch CouchDB and you *didn't* choose to install the Windows Service, run the `bin\\couchdb.cmd` program wherever you copied the program to. You can do this with Win+R, or a Command Prompt.\r\n\r\nYou can then \"see\" CouchDB by opening any browser and pointing it to `http://localhost:5984`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663913171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663917570","html_url":"https://github.com/apache/couchdb/issues/3028#issuecomment-663917570","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3028","id":663917570,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzkxNzU3MA==","user":{"login":"DiegoJArg","id":25246225,"node_id":"MDQ6VXNlcjI1MjQ2MjI1","avatar_url":"https://avatars.githubusercontent.com/u/25246225?v=4","gravatar_id":"","url":"https://api.github.com/users/DiegoJArg","html_url":"https://github.com/DiegoJArg","followers_url":"https://api.github.com/users/DiegoJArg/followers","following_url":"https://api.github.com/users/DiegoJArg/following{/other_user}","gists_url":"https://api.github.com/users/DiegoJArg/gists{/gist_id}","starred_url":"https://api.github.com/users/DiegoJArg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DiegoJArg/subscriptions","organizations_url":"https://api.github.com/users/DiegoJArg/orgs","repos_url":"https://api.github.com/users/DiegoJArg/repos","events_url":"https://api.github.com/users/DiegoJArg/events{/privacy}","received_events_url":"https://api.github.com/users/DiegoJArg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-25T23:46:09Z","updated_at":"2020-07-25T23:46:09Z","author_association":"NONE","body":"Yes, I installed it as you say without service.\r\nOK, so windows wouldn't show the same systray icon as in mac. thank you for clarifying.\r\nThen it has to be run from a command prompt:\r\n\r\nC:\\Program Files\\Apache CouchDB>couchdb.cmd\r\n\r\nI noted that it wont run due to an error, so i run this\r\n\r\ncouchdb.cmd > logs.txt 2>&1\r\n\r\nThere was write permissions problem as user on that folder, so went to Apache CouchDB and give to it all permissions.\r\nHowever, it didn't start yet, it seem to be a _users database missing ?\r\nI know that I was asked for admin username and password at the installation process\r\nWhile at the folder data, there is only _dbs and _nodes and .delete\r\n\r\ncouchdb.cmd > logs.txt 2>&1\r\n\r\n\r\n```\r\nkernel-poll not supported; \"K\" parameter ignored\r\n[info] 2020-07-25T23:32:29.061000Z couchdb@localhost <0.11.0> -------- Application couch_log started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.073000Z couchdb@localhost <0.11.0> -------- Application folsom started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.131000Z couchdb@localhost <0.11.0> -------- Application couch_stats started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.131000Z couchdb@localhost <0.11.0> -------- Application khash started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.141000Z couchdb@localhost <0.11.0> -------- Application couch_event started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.142000Z couchdb@localhost <0.11.0> -------- Application hyper started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.151000Z couchdb@localhost <0.11.0> -------- Application ibrowse started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.160000Z couchdb@localhost <0.11.0> -------- Application ioq started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.160000Z couchdb@localhost <0.11.0> -------- Application mochiweb started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.167000Z couchdb@localhost <0.220.0> -------- Preflight check: Asserting Admin Account\r\n\r\n[info] 2020-07-25T23:32:29.172000Z couchdb@localhost <0.220.0> -------- Apache CouchDB 3.1.0 is starting.\r\n\r\n[info] 2020-07-25T23:32:29.172000Z couchdb@localhost <0.221.0> -------- Starting couch_sup\r\n[info] 2020-07-25T23:32:29.258000Z couchdb@localhost <0.220.0> -------- Apache CouchDB has started. Time to relax.\r\n\r\n[info] 2020-07-25T23:32:29.262000Z couchdb@localhost <0.11.0> -------- Application couch started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.263000Z couchdb@localhost <0.11.0> -------- Application ets_lru started on node couchdb@localhost\r\n[notice] 2020-07-25T23:32:29.282000Z couchdb@localhost <0.253.0> -------- rexi_server : started servers\r\n[notice] 2020-07-25T23:32:29.286000Z couchdb@localhost <0.257.0> -------- rexi_buffer : started servers\r\n[info] 2020-07-25T23:32:29.286000Z couchdb@localhost <0.11.0> -------- Application rexi started on node couchdb@localhost\r\n[notice] 2020-07-25T23:32:29.403000Z couchdb@localhost <0.287.0> -------- mem3_reshard_dbdoc start init()\r\n[notice] 2020-07-25T23:32:29.412000Z couchdb@localhost <0.289.0> -------- mem3_reshard start init()\r\n[notice] 2020-07-25T23:32:29.412000Z couchdb@localhost <0.290.0> -------- mem3_reshard db monitor <0.290.0> starting\r\n[notice] 2020-07-25T23:32:29.416000Z couchdb@localhost <0.289.0> -------- mem3_reshard starting reloading jobs\r\n[notice] 2020-07-25T23:32:29.416000Z couchdb@localhost <0.289.0> -------- mem3_reshard finished reloading jobs\r\n[info] 2020-07-25T23:32:29.418000Z couchdb@localhost <0.11.0> -------- Application mem3 started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.418000Z couchdb@localhost <0.11.0> -------- Application fabric started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.463000Z couchdb@localhost <0.11.0> -------- Application chttpd started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.484000Z couchdb@localhost <0.11.0> -------- Application couch_index started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.484000Z couchdb@localhost <0.11.0> -------- Application couch_mrview started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.484000Z couchdb@localhost <0.11.0> -------- Application couch_plugins started on node couchdb@localhost\r\n[notice] 2020-07-25T23:32:29.487000Z couchdb@localhost <0.317.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n**[error] 2020-07-25T23:32:29.487000Z couchdb@localhost emulator -------- Error in process <0.318.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,374}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,96}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,145}]}]}**\r\n\r\n[info] 2020-07-25T23:32:29.542000Z couchdb@localhost <0.11.0> -------- Application couch_replicator started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.554000Z couchdb@localhost <0.11.0> -------- Application couch_peruser started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.571000Z couchdb@localhost <0.11.0> -------- Application ddoc_cache started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.586000Z couchdb@localhost <0.11.0> -------- Application dreyfus started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.606000Z couchdb@localhost <0.11.0> -------- Application global_changes started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.606000Z couchdb@localhost <0.11.0> -------- Application jiffy started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.618000Z couchdb@localhost <0.11.0> -------- Application jwtf started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.630000Z couchdb@localhost <0.11.0> -------- Application ken started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.643000Z couchdb@localhost <0.11.0> -------- Application mango started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.652000Z couchdb@localhost <0.11.0> -------- Application setup started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.679000Z couchdb@localhost <0.11.0> -------- Application smoosh started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.679000Z couchdb@localhost <0.11.0> -------- Application snappy started on node couchdb@localhost\r\n[info] 2020-07-25T23:32:29.680000Z couchdb@localhost <0.11.0> -------- Application recon started on node couchdb@localhost\r\n[notice] 2020-07-25T23:32:34.492000Z couchdb@localhost <0.317.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2020-07-25T23:32:34.492000Z couchdb@localhost emulator -------- Error in process <0.456.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,374}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,96}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,145}]}]}\r\n\r\n[notice] 2020-07-25T23:32:34.509000Z couchdb@localhost <0.339.0> -------- couch_replicator_clustering : cluster stable\r\n[notice] 2020-07-25T23:32:34.514000Z couchdb@localhost <0.349.0> -------- Started replicator db changes listener <0.457.0>\r\n[info] 2020-07-25T23:32:34.515000Z couchdb@localhost <0.459.0> -------- open_result error {not_found,no_db_file} for _replicator\r\n[notice] 2020-07-25T23:32:39.499000Z couchdb@localhost <0.317.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2020-07-25T23:32:39.500000Z couchdb@localhost emulator -------- Error in process <0.495.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,374}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,96}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,145}]}]}\r\n\r\n[notice] 2020-07-25T23:32:44.288000Z couchdb@localhost <0.253.0> -------- rexi_server : cluster stable\r\n[notice] 2020-07-25T23:32:44.288000Z couchdb@localhost <0.257.0> -------- rexi_buffer : cluster stable\r\n[notice] 2020-07-25T23:32:44.508000Z couchdb@localhost <0.317.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2020-07-25T23:32:44.508000Z couchdb@localhost emulator -------- Error in process <0.544.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,374}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,96}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,145}]}]}\r\n\r\n[notice] 2020-07-25T23:32:49.514000Z couchdb@localhost <0.317.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2020-07-25T23:32:49.514000Z couchdb@localhost emulator -------- Error in process <0.577.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,374}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,96}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,145}]}]}\r\n\r\n[notice] 2020-07-25T23:32:54.522000Z couchdb@localhost <0.317.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2020-07-25T23:32:54.523000Z couchdb@localhost emulator -------- Error in process <0.626.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,374}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,96}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,145}]}]}\r\n\r\n[notice] 2020-07-25T23:32:56.752000Z couchdb@localhost <0.627.0> 58733e0d85 127.0.0.1:5984 127.0.0.1 undefined GET / 200 ok 93\r\n[notice] 2020-07-25T23:32:59.531000Z couchdb@localhost <0.317.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2020-07-25T23:32:59.532000Z couchdb@localhost emulator -------- Error in process <0.665.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,374}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,96}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,145}]}]}\r\n\r\n[notice] 2020-07-25T23:33:04.541000Z couchdb@localhost <0.317.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2020-07-25T23:33:04.541000Z couchdb@localhost emulator -------- Error in process <0.713.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,374}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,96}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,145}]}]}\r\n\r\n[notice] 2020-07-25T23:33:09.545000Z couchdb@localhost <0.317.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2020-07-25T23:33:09.545000Z couchdb@localhost emulator -------- Error in process <0.747.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,374}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,96}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,145}]}]}\r\n\r\n[notice] 2020-07-25T23:33:14.553000Z couchdb@localhost <0.317.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2020-07-25T23:33:14.553000Z couchdb@localhost emulator -------- Error in process <0.795.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,374}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,96}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,198}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,145}]}]}\r\n\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663917570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663918297","html_url":"https://github.com/apache/couchdb/issues/3028#issuecomment-663918297","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3028","id":663918297,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzkxODI5Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-25T23:59:19Z","updated_at":"2020-07-25T23:59:19Z","author_association":"MEMBER","body":"That is a normal startup. We do not create the `_users` database automatically on startup for various reasons.\r\n\r\nThese questions are all answered in our documentation:\r\n\r\n  https://docs.couchdb.org/en/latest/setup/single-node.html\r\n\r\nIf you have further questions, please use the `Discussions` tab above and open a new topic.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663918297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663970269","html_url":"https://github.com/apache/couchdb/pull/3036#issuecomment-663970269","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3036","id":663970269,"node_id":"MDEyOklzc3VlQ29tbWVudDY2Mzk3MDI2OQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-26T10:24:30Z","updated_at":"2020-07-26T10:24:30Z","author_association":"MEMBER","body":"perfect, thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/663970269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/664158813","html_url":"https://github.com/apache/couchdb/issues/2496#issuecomment-664158813","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2496","id":664158813,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NDE1ODgxMw==","user":{"login":"David-Klemenc","id":44705886,"node_id":"MDQ6VXNlcjQ0NzA1ODg2","avatar_url":"https://avatars.githubusercontent.com/u/44705886?v=4","gravatar_id":"","url":"https://api.github.com/users/David-Klemenc","html_url":"https://github.com/David-Klemenc","followers_url":"https://api.github.com/users/David-Klemenc/followers","following_url":"https://api.github.com/users/David-Klemenc/following{/other_user}","gists_url":"https://api.github.com/users/David-Klemenc/gists{/gist_id}","starred_url":"https://api.github.com/users/David-Klemenc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/David-Klemenc/subscriptions","organizations_url":"https://api.github.com/users/David-Klemenc/orgs","repos_url":"https://api.github.com/users/David-Klemenc/repos","events_url":"https://api.github.com/users/David-Klemenc/events{/privacy}","received_events_url":"https://api.github.com/users/David-Klemenc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-27T06:59:47Z","updated_at":"2020-07-27T06:59:47Z","author_association":"NONE","body":"The wrong number for `total_rows` is also returned when using a view:\r\n\r\n```shell\r\ncurl -b AuthSession=my-session 127.0.0.1:5984/my_db/_partition/my_partition          \r\n{\r\n    \"db_name\": \"my_db\",\r\n    \"sizes\": {\r\n        \"active\": 996092,\r\n        \"external\": 1369131\r\n    },\r\n    \"partition\": \"my_partition\",\r\n    \"doc_count\": 1264,\r\n    \"doc_del_count\": 6\r\n}\r\n\r\ncurl -b AuthSession=my-session 127.0.0.1:5984/my_db/_partition/my_partition/_design/my_design/_view/my_view\r\n{\r\n    \"total_rows\": 2348,\r\n    \"offset\": 0,\r\n    \"rows\": [\r\n        // ...\r\n    ]\r\n}\r\n```\r\n\r\nWhen using a view the `total_rows` shows data for the **entire** database not just for the partition.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/664158813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/664386591","html_url":"https://github.com/apache/couchdb/pull/3041#issuecomment-664386591","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3041","id":664386591,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NDM4NjU5MQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-27T13:10:38Z","updated_at":"2020-07-27T13:10:38Z","author_association":"MEMBER","body":"Approved, but Iâ€™d like to have one more +1 just to make sure :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/664386591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/664437265","html_url":"https://github.com/apache/couchdb/pull/3041#issuecomment-664437265","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3041","id":664437265,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NDQzNzI2NQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-27T14:39:31Z","updated_at":"2020-07-27T14:39:31Z","author_association":"MEMBER","body":"The ergonomics of an `$exists` with a dynamic key name are somewhat awkward, I bumped on that a few times before until I remember thatâ€™s an option. Thatâ€™s why I liked this a little more obvious variant.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/664437265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/664446048","html_url":"https://github.com/apache/couchdb/pull/3041#issuecomment-664446048","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3041","id":664446048,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NDQ0NjA0OA==","user":{"login":"borkowmichal","id":21311806,"node_id":"MDQ6VXNlcjIxMzExODA2","avatar_url":"https://avatars.githubusercontent.com/u/21311806?v=4","gravatar_id":"","url":"https://api.github.com/users/borkowmichal","html_url":"https://github.com/borkowmichal","followers_url":"https://api.github.com/users/borkowmichal/followers","following_url":"https://api.github.com/users/borkowmichal/following{/other_user}","gists_url":"https://api.github.com/users/borkowmichal/gists{/gist_id}","starred_url":"https://api.github.com/users/borkowmichal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/borkowmichal/subscriptions","organizations_url":"https://api.github.com/users/borkowmichal/orgs","repos_url":"https://api.github.com/users/borkowmichal/repos","events_url":"https://api.github.com/users/borkowmichal/events{/privacy}","received_events_url":"https://api.github.com/users/borkowmichal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-27T14:54:49Z","updated_at":"2020-07-27T14:54:49Z","author_association":"NONE","body":"For the use case, the example is not representative in itself indeed.\r\nHere's one of the use cases we have: \r\n\r\n\r\nGiven this partial representation of a document that has delegations (represented by the map keys), we would like to get all documents with a specific delegation. We also make more complex queries, and we use JSON indexes.\r\n\r\n```\r\n{\r\n    \"foo\": \"bar\",\r\n    \"delegations\": {\r\n        \"c4d16e9e-4da0-4bb0-8be1-2852e4618386\": [\r\n            {\r\n                \"owner\": \"c4d16e9e-4da0-4bb0-8be1-2852e4618386\",\r\n                \"delegatedTo\": \"c4d16e9e-4da0-4bb0-8be1-2852e4618386\",\r\n                \"key\": \"foo\"\r\n            }\r\n        ],\r\n        \"c314e17b-17f2-4b7d-ad0c-bcb173f23d58\": [\r\n            {\r\n                \"owner\": \"20e14384-4115-48f9-aec9-0ae667826cd2\",\r\n                \"delegatedTo\": \"c314e17b-17f2-4b7d-ad0c-bcb173f23d58\",\r\n                \"key\": \"bar\"\r\n            }\r\n        ],\r\n        \"f5d6776a-bf52-4f94-9d0c-ba4e700433ec\": [\r\n            {\r\n                \"owner\": \"149aca84-1fb6-40a6-82f2-cec9a3c4440d\",\r\n                \"delegatedTo\": \"f5d6776a-bf52-4f94-9d0c-ba4e700433ec\",\r\n                \"key\": \"x\"\r\n            }\r\n        ]\r\n    }\r\n}\r\n```\r\n\r\nIn this situation the `$exists` operator doesn't allow us to use an index on the `delegations` field to make this kind of queries; we get a warning that the index was not used.\r\n\r\nThat's what motivated us to create this operator.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/664446048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/664450317","html_url":"https://github.com/apache/couchdb/pull/3041#issuecomment-664450317","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3041","id":664450317,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NDQ1MDMxNw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-27T15:02:13Z","updated_at":"2020-07-27T15:02:13Z","author_association":"MEMBER","body":"@janl @borkowmichal Ah! Gotchya, that makes perfect sense.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/664450317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665141823","html_url":"https://github.com/apache/couchdb/issues/1540#issuecomment-665141823","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1540","id":665141823,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NTE0MTgyMw==","user":{"login":"VladimirCores","id":442111,"node_id":"MDQ6VXNlcjQ0MjExMQ==","avatar_url":"https://avatars.githubusercontent.com/u/442111?v=4","gravatar_id":"","url":"https://api.github.com/users/VladimirCores","html_url":"https://github.com/VladimirCores","followers_url":"https://api.github.com/users/VladimirCores/followers","following_url":"https://api.github.com/users/VladimirCores/following{/other_user}","gists_url":"https://api.github.com/users/VladimirCores/gists{/gist_id}","starred_url":"https://api.github.com/users/VladimirCores/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/VladimirCores/subscriptions","organizations_url":"https://api.github.com/users/VladimirCores/orgs","repos_url":"https://api.github.com/users/VladimirCores/repos","events_url":"https://api.github.com/users/VladimirCores/events{/privacy}","received_events_url":"https://api.github.com/users/VladimirCores/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-28T16:29:17Z","updated_at":"2020-07-28T16:29:17Z","author_association":"NONE","body":"I'm Interested in the progress of the feature.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665141823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665192290","html_url":"https://github.com/apache/couchdb/pull/3043#issuecomment-665192290","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3043","id":665192290,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NTE5MjI5MA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-28T18:07:36Z","updated_at":"2020-07-28T18:07:36Z","author_association":"CONTRIBUTOR","body":"besides that nitpick, I think the rest looks good","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665192290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665195781","html_url":"https://github.com/apache/couchdb/pull/3043#issuecomment-665195781","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3043","id":665195781,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NTE5NTc4MQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-28T18:14:10Z","updated_at":"2020-07-28T18:14:10Z","author_association":"MEMBER","body":"thanks @tonysun83 I've made the fix.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665195781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665197510","html_url":"https://github.com/apache/couchdb/pull/3043#issuecomment-665197510","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3043","id":665197510,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NTE5NzUxMA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-28T18:17:08Z","updated_at":"2020-07-28T18:17:08Z","author_association":"CONTRIBUTOR","body":"+1 after that final small whitespace ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665197510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665220158","html_url":"https://github.com/apache/couchdb/pull/3043#issuecomment-665220158","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3043","id":665220158,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NTIyMDE1OA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-28T19:02:01Z","updated_at":"2020-07-28T19:02:01Z","author_association":"CONTRIBUTOR","body":"@garrensmith This is a nice feature!\r\n\r\nSee a minor comment about keymember vs keyfind and value checking.\r\n\r\nThen perhaps we could add is a eunit test to maintain test coverage in fabric. There is already a map test with a variety of views in https://github.com/apache/couchdb/blob/12b7cdc4355866113c1df3f7ba2b036cbdd6c8a0/src/couch_views/test/couch_views_map_test.erl#L499 so could add it there. Maybe one where it is defined and `false` and the other one where it is `true`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665220158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665266462","html_url":"https://github.com/apache/couchdb/pull/3044#issuecomment-665266462","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3044","id":665266462,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NTI2NjQ2Mg==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-28T20:29:17Z","updated_at":"2020-07-28T20:29:17Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665266462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665280532","html_url":"https://github.com/apache/couchdb/pull/3031#issuecomment-665280532","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3031","id":665280532,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NTI4MDUzMg==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-28T21:01:32Z","updated_at":"2020-07-28T21:02:00Z","author_association":"CONTRIBUTOR","body":"I think shortening the complex terms is the right approach. Similar to what I wrote in the other PR about more meaningful output,  I was thinking if providing a length(Term) is necessary. It'll just be a bunch of integers in the output that don't have much meaning. Some other options\r\n1) Leaving it nil or blank (like what you did for `mrviews`\r\n2) Only show first X number or characters  (a little bit more work)\r\n3) Prepend it with some descriptor `{<name of field>_size, length(Term)}`\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665280532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665578748","html_url":"https://github.com/apache/couchdb/pull/3038#issuecomment-665578748","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3038","id":665578748,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NTU3ODc0OA==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-29T10:21:57Z","updated_at":"2020-07-29T10:23:16Z","author_association":"CONTRIBUTOR","body":"This is great, gratz! \r\n\r\nOne question: itâ€™s not clear to me how /_security response will look for buckets having access restrictions, is there a special field for those restrictions? I mean I want to explicitly mark buckets of the kind in Photon, so how can I detect _access restricted buckets reading /_security endpoint?\r\n\r\nRFC states `admins can grant individual users and groups access to a database using the databaseâ€™s _security object`, no details. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665578748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665908783","html_url":"https://github.com/apache/couchdb/issues/3047#issuecomment-665908783","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3047","id":665908783,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NTkwODc4Mw==","user":{"login":"rjharmon","id":42002,"node_id":"MDQ6VXNlcjQyMDAy","avatar_url":"https://avatars.githubusercontent.com/u/42002?v=4","gravatar_id":"","url":"https://api.github.com/users/rjharmon","html_url":"https://github.com/rjharmon","followers_url":"https://api.github.com/users/rjharmon/followers","following_url":"https://api.github.com/users/rjharmon/following{/other_user}","gists_url":"https://api.github.com/users/rjharmon/gists{/gist_id}","starred_url":"https://api.github.com/users/rjharmon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjharmon/subscriptions","organizations_url":"https://api.github.com/users/rjharmon/orgs","repos_url":"https://api.github.com/users/rjharmon/repos","events_url":"https://api.github.com/users/rjharmon/events{/privacy}","received_events_url":"https://api.github.com/users/rjharmon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-29T20:27:31Z","updated_at":"2020-07-29T20:27:31Z","author_association":"NONE","body":"I'm guessing you may have many design docs that aren't being actively used by your application, and the autoupdate traffic on those is causing the undesired load?  Maybe some of them are simply obsolete?\r\n\r\nDid you consider setting autoupdate: true on one design-doc at a time, for those design docs whose indexes you KNOW are going to be taking traffic?  The intent of the autoupdate behavior, as I understand it, is to shift indexing workload away from time-of-need and to execute it earlier - so it's ready when your application does a query.\r\n\r\nAdministratively, setting autoupdate: true gradually for all your less-used indexes, and removing any obsolete design docs, could get you caught up and cleaned up.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665908783/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665916311","html_url":"https://github.com/apache/couchdb/issues/3047#issuecomment-665916311","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3047","id":665916311,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NTkxNjMxMQ==","user":{"login":"ngspinu","id":35466661,"node_id":"MDQ6VXNlcjM1NDY2NjYx","avatar_url":"https://avatars.githubusercontent.com/u/35466661?v=4","gravatar_id":"","url":"https://api.github.com/users/ngspinu","html_url":"https://github.com/ngspinu","followers_url":"https://api.github.com/users/ngspinu/followers","following_url":"https://api.github.com/users/ngspinu/following{/other_user}","gists_url":"https://api.github.com/users/ngspinu/gists{/gist_id}","starred_url":"https://api.github.com/users/ngspinu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ngspinu/subscriptions","organizations_url":"https://api.github.com/users/ngspinu/orgs","repos_url":"https://api.github.com/users/ngspinu/repos","events_url":"https://api.github.com/users/ngspinu/events{/privacy}","received_events_url":"https://api.github.com/users/ngspinu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-29T20:43:09Z","updated_at":"2020-07-29T20:49:58Z","author_association":"NONE","body":"@rjharmon thanks for the hints. We have indeed removed all outdated/obsolete design docs and also compacted the views. We have quite a few views that are required so that the app can work, so whatever we would be doing - we still endup with a bunch of non-stop indexing views, that will eventually take our whole CPU. \r\n\r\nAs for `autoupdate: true` - that is indeed used to keep the indexes warm, but I reckon.. there must be a middle way to keep things in line: IE: No 100%","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665916311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665980112","html_url":"https://github.com/apache/couchdb/pull/3031#issuecomment-665980112","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3031","id":665980112,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NTk4MDExMg==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-29T23:22:56Z","updated_at":"2020-07-29T23:22:56Z","author_association":"CONTRIBUTOR","body":"+1, please squash and merge, good work!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/665980112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666029699","html_url":"https://github.com/apache/couchdb/issues/3047#issuecomment-666029699","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3047","id":666029699,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NjAyOTY5OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-30T01:45:28Z","updated_at":"2020-07-30T01:45:28Z","author_association":"MEMBER","body":"Check your thresholds for smoosh. \r\n\r\nhttps://docs.couchdb.org/en/latest/maintenance/compaction.html#channels\r\n\r\nProbably it's the default config for the slack channel(s), which enqueues a db or view for compaction if the difference between actual and file size is > 16MB. This is too small for larger databases. The ratio channel uses a value of 2.0 and this is usually fine on its own.\r\n\r\nTry increase the value by a few factors of two.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666029699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666030056","html_url":"https://github.com/apache/couchdb/issues/3047#issuecomment-666030056","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3047","id":666030056,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NjAzMDA1Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-30T01:46:26Z","updated_at":"2020-07-30T01:46:38Z","author_association":"MEMBER","body":"@rnewson This has come up here and in #3019. I think we should change the default. What do you think?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666030056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666300740","html_url":"https://github.com/apache/couchdb/issues/1611#issuecomment-666300740","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1611","id":666300740,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NjMwMDc0MA==","user":{"login":"skeyby","id":1609532,"node_id":"MDQ6VXNlcjE2MDk1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1609532?v=4","gravatar_id":"","url":"https://api.github.com/users/skeyby","html_url":"https://github.com/skeyby","followers_url":"https://api.github.com/users/skeyby/followers","following_url":"https://api.github.com/users/skeyby/following{/other_user}","gists_url":"https://api.github.com/users/skeyby/gists{/gist_id}","starred_url":"https://api.github.com/users/skeyby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skeyby/subscriptions","organizations_url":"https://api.github.com/users/skeyby/orgs","repos_url":"https://api.github.com/users/skeyby/repos","events_url":"https://api.github.com/users/skeyby/events{/privacy}","received_events_url":"https://api.github.com/users/skeyby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-30T11:05:36Z","updated_at":"2020-07-30T11:05:36Z","author_association":"NONE","body":"Hello, I'm facing the same issue on CouchDB 3.1:\r\n\r\n`[error] 2020-07-30T10:47:23.718632Z couchdb@10.133.136.126 <0.23319.995> -------- Bad security object in <<\"_users\">>: [{{[{<<\"members\">>,{[{<<\"roles\">>,[<<\"_admin\">>]}]}},{<<\"admins\">>,{[{<<\"roles\">>,[<<\"_admin\">>]}]}}]},8},{{[{<<\"admins\">>,{[{<<\"roles\">>,[<<\"_admin\">>]}]}}]},8}]\r\n`\r\n\r\nThis is the path I followed:\r\n- I added a new node to the cluster\r\n- I added all the shards/nodes to the metadata for the db\r\n- I invoked _sync_shards for the database\r\n\r\nThe shards correctly appeared on the other node but the security object got lost and the error started to appear in the log.\r\n\r\nI went in the db with Fauxton and the permission were back to basic _admin/_admin.\r\n\r\nI modified them and the error has now gone away.\r\n\r\nSo my guess is that there's something missing in the _sync_shards code when it comes to copying database permissions.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666300740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666337564","html_url":"https://github.com/apache/couchdb/pull/3031#issuecomment-666337564","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3031","id":666337564,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NjMzNzU2NA==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-30T12:35:23Z","updated_at":"2020-07-30T12:35:23Z","author_association":"CONTRIBUTOR","body":"`couch_jobs_tests:210: type_timeouts_and_server...*failed*` - is known to be flaky. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666337564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666737359","html_url":"https://github.com/apache/couchdb/pull/3050#issuecomment-666737359","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3050","id":666737359,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NjczNzM1OQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-30T22:12:16Z","updated_at":"2020-07-30T23:47:33Z","author_association":"CONTRIBUTOR","body":"Saw some unexpected success test failures:\r\n\r\n```\r\n   fabric2_db_crud_tests:40: crud_test_ (recreate_db)...*failed*\r\nin function fabric2_db_crud_tests:'-recreate_db/1-fun-4-'/1 (test/fabric2_db_crud_tests.erl, line 160)\r\nin call from fabric2_db_crud_tests:recreate_db/1 (test/fabric2_db_crud_tests.erl, line 160)\r\n**error:{assertException,\r\n    [{module,fabric2_db_crud_tests},\r\n     {line,160},\r\n     {expression,\"fabric2_db : get_db_info ( Db1 )\"},\r\n     {pattern,\"{ error , database_does_not_exist , [...] }\"},\r\n     {unexpected_success,\r\n         {ok,[{cluster,{[{n,0},{q,0},{r,...},{...}]}},\r\n```\r\n\r\nFrom https://github.com/apache/couchdb/blob/prototype/fdb-layer/src/fabric/test/fabric2_db_crud_tests.erl#L160\r\n\r\nSo perhaps the existing code wasn't totally wrong. The question is what should happen if we end up finding a previous instance of a db in the cache.  With the current PR we'll let the user roll with the old db, and when they perform a transaction operation, we'd silently upgrade it to the new db version. And then they can keep holding on that stale handle and be none the wiser.\r\n\r\nIn the previous scheme, any old db handle immediately threw a `database_does_not_exist` error which bubbled up to the client right away. That wasn't correct either, since a user may delete and recreate the db on node1 then make a re-quest for db_info to node2, get the previous db instance, then get a 404 response, which is wrong.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666737359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666775908","html_url":"https://github.com/apache/couchdb/pull/3050#issuecomment-666775908","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3050","id":666775908,"node_id":"MDEyOklzc3VlQ29tbWVudDY2Njc3NTkwOA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-30T23:40:16Z","updated_at":"2020-07-31T03:02:19Z","author_association":"CONTRIBUTOR","body":"Updated approach: the idea is that we have different behaviors for interactive requests vs background tasks. \r\n\r\nInteractive requests should be able to auto-reopen to a new db instance if it was re-created. Background tasks, like indexers, for example, would want to handle the `database_doest_not_exist` errors, since they don't want to keep holding on to a stale database handle that will continuously be reopen when doing any transactions.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/666775908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/667166127","html_url":"https://github.com/apache/couchdb/pull/3050#issuecomment-667166127","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3050","id":667166127,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NzE2NjEyNw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-31T15:01:45Z","updated_at":"2020-07-31T15:01:45Z","author_association":"CONTRIBUTOR","body":"@davisp good call about the security test, I don't think we enforce security check on the new instance.\r\n\r\nWe do have a test for when we reopen in a non-interactive way:\r\n\r\nhttps://github.com/apache/couchdb/blob/993e2d44cbecb995b40dbf78408d61bd38168ed7/src/fabric/test/fabric2_db_crud_tests.erl#L156-L161","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/667166127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/667167415","html_url":"https://github.com/apache/couchdb/pull/3050#issuecomment-667167415","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3050","id":667167415,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NzE2NzQxNQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-31T15:03:55Z","updated_at":"2020-07-31T15:03:55Z","author_association":"MEMBER","body":"Ah, good catch on there being a test already. Lets add a comment there to let future us know there's a subtle thing being tested with the new interactive flag.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/667167415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/667868676","html_url":"https://github.com/apache/couchdb/issues/3047#issuecomment-667868676","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3047","id":667868676,"node_id":"MDEyOklzc3VlQ29tbWVudDY2Nzg2ODY3Ng==","user":{"login":"ngspinu","id":35466661,"node_id":"MDQ6VXNlcjM1NDY2NjYx","avatar_url":"https://avatars.githubusercontent.com/u/35466661?v=4","gravatar_id":"","url":"https://api.github.com/users/ngspinu","html_url":"https://github.com/ngspinu","followers_url":"https://api.github.com/users/ngspinu/followers","following_url":"https://api.github.com/users/ngspinu/following{/other_user}","gists_url":"https://api.github.com/users/ngspinu/gists{/gist_id}","starred_url":"https://api.github.com/users/ngspinu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ngspinu/subscriptions","organizations_url":"https://api.github.com/users/ngspinu/orgs","repos_url":"https://api.github.com/users/ngspinu/repos","events_url":"https://api.github.com/users/ngspinu/events{/privacy}","received_events_url":"https://api.github.com/users/ngspinu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-03T07:52:56Z","updated_at":"2020-08-03T07:55:04Z","author_association":"NONE","body":"@wohali thank you for the hints. We have tried your suggestion IE: Increasing the 16MB to way more as our dbs are pretty big: ~1GB. Ratio too. Sadly - it still keeps indexing :(.\r\nIs there anything else we can try? We have around 35 environments that we need to upgrade to 3.* and we can't do it until we understand what is causing the continuous indexing/unorthodox CPU consumption.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/667868676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/667958679","html_url":"https://github.com/apache/couchdb/issues/3047#issuecomment-667958679","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3047","id":667958679,"node_id":"MDEyOklzc3VlQ29tbWVudDY2Nzk1ODY3OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-03T11:01:22Z","updated_at":"2020-08-03T11:01:22Z","author_association":"MEMBER","body":"Increase them more. If all you're seeing is forever running db and view compactions, smoosh is still being triggered too fast. Use the output of `GET /{db}` to determine the appropriate ratio for your needs. Or you can just disable certain DBs if they cause you trouble.\r\n\r\nIf what you're seeing is index _builds_ (not compactions) then `ken` is your issue, and you'll need to use configs to disable ken from building all your views. That's also explained in the documentation.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/667958679/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/668669601","html_url":"https://github.com/apache/couchdb/pull/3053#issuecomment-668669601","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3053","id":668669601,"node_id":"MDEyOklzc3VlQ29tbWVudDY2ODY2OTYwMQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-04T15:37:02Z","updated_at":"2020-08-04T15:37:02Z","author_association":"MEMBER","body":"will try to figure that bit out later","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/668669601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670027261","html_url":"https://github.com/apache/couchdb/issues/3061#issuecomment-670027261","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3061","id":670027261,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDAyNzI2MQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-06T16:14:25Z","updated_at":"2020-08-06T16:14:25Z","author_association":"MEMBER","body":"The odd thing is that this is actually an unknown process dying which suggests there's something else afoot. Perhaps we remove an indexer from ets before getting its `EXIT` signal?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670027261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670029585","html_url":"https://github.com/apache/couchdb/issues/3061#issuecomment-670029585","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3061","id":670029585,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDAyOTU4NQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-06T16:18:16Z","updated_at":"2020-08-06T16:18:16Z","author_association":"MEMBER","body":"And by unknown, I mean its a process that's linked cause we're getting the `EXIT` but the process isn't in ets. Which means we're either accidentally linking something to `couch_index_server` or we're removing a linked process from ets without unlinking/flushing any pending `EXIT` messages.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670029585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670030960","html_url":"https://github.com/apache/couchdb/issues/3061#issuecomment-670030960","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3061","id":670030960,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDAzMDk2MA==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-06T16:20:41Z","updated_at":"2020-08-06T16:20:41Z","author_association":"MEMBER","body":"in the original logs, which I can't share here, there's a design document deletion while that index is building. the delete removes the underlying .view files and kills the couch_file pids, so when the index_server process itself terminates, it crashes -in- terminate when trying to close the now dead pid\r\n\r\nI can't say that this is the only root to killing couch_index_server, though, so I would rather focus on removing the\r\n\r\n```\r\n[] when Reason /= normal ->\r\n    exit(Reason); \r\n```\r\n\r\nbit, which seems like an over-reaction now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670030960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670031871","html_url":"https://github.com/apache/couchdb/issues/3061#issuecomment-670031871","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3061","id":670031871,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDAzMTg3MQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-06T16:22:22Z","updated_at":"2020-08-06T16:22:22Z","author_association":"MEMBER","body":"Which sounds like we've removed it from ets before we should/without dropping a link or flushing a message.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670031871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670032090","html_url":"https://github.com/apache/couchdb/issues/3061#issuecomment-670032090","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3061","id":670032090,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDAzMjA5MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-06T16:22:42Z","updated_at":"2020-08-06T16:22:42Z","author_association":"MEMBER","body":"That is to say, freaking out when we get an unknown `EXIT` message seems like a pretty reasonable reaction.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670032090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670035773","html_url":"https://github.com/apache/couchdb/issues/3061#issuecomment-670035773","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3061","id":670035773,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDAzNTc3Mw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-06T16:29:06Z","updated_at":"2020-08-06T16:29:06Z","author_association":"MEMBER","body":"https://github.com/apache/couchdb/blob/master/src/couch_index/src/couch_index_server.erl#L246-L248\r\n\r\nWe do a monitor dance as well. We should add a second receive to flush the `EXIT` message.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670035773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670036006","html_url":"https://github.com/apache/couchdb/issues/3061#issuecomment-670036006","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3061","id":670036006,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDAzNjAwNg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-06T16:29:32Z","updated_at":"2020-08-06T16:29:32Z","author_association":"MEMBER","body":"And/or replace the monitor dance by waiting for the 'EXIT' instead would likely be better.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670036006/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670037960","html_url":"https://github.com/apache/couchdb/issues/3061#issuecomment-670037960","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3061","id":670037960,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDAzNzk2MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-06T16:32:56Z","updated_at":"2020-08-06T16:32:56Z","author_association":"MEMBER","body":"Could also add a `catch` on this line: https://github.com/apache/couchdb/blob/master/src/couch_mrview/src/couch_mrview_index.erl#L156\r\n\r\nOr we could change things so that close/shutdown/delete can return a new state so that they would know whether their couch_file pid is alive.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670037960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670158188","html_url":"https://github.com/apache/couchdb/pull/3064#issuecomment-670158188","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3064","id":670158188,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDE1ODE4OA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-06T19:49:03Z","updated_at":"2020-08-06T19:49:03Z","author_association":"MEMBER","body":"@rnewson found a better way.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670158188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670386156","html_url":"https://github.com/apache/couchdb/issues/3063#issuecomment-670386156","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3063","id":670386156,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDM4NjE1Ng==","user":{"login":"craftzdog","id":1332805,"node_id":"MDQ6VXNlcjEzMzI4MDU=","avatar_url":"https://avatars.githubusercontent.com/u/1332805?v=4","gravatar_id":"","url":"https://api.github.com/users/craftzdog","html_url":"https://github.com/craftzdog","followers_url":"https://api.github.com/users/craftzdog/followers","following_url":"https://api.github.com/users/craftzdog/following{/other_user}","gists_url":"https://api.github.com/users/craftzdog/gists{/gist_id}","starred_url":"https://api.github.com/users/craftzdog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/craftzdog/subscriptions","organizations_url":"https://api.github.com/users/craftzdog/orgs","repos_url":"https://api.github.com/users/craftzdog/repos","events_url":"https://api.github.com/users/craftzdog/events{/privacy}","received_events_url":"https://api.github.com/users/craftzdog/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-07T07:58:16Z","updated_at":"2020-08-07T07:58:16Z","author_association":"NONE","body":"The bottleneck was my network on EC2.\r\nMy cluster nodes were deployed across different regions in order to make them disaster tolerant.\r\nThat caused the network bottleneck between nodes where the RTT was around 166ms.\r\nI moved the nodes to the single region but in different availability zones.\r\nNow it works very fast!\r\n\r\nSorry for bothering you.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670386156/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670824224","html_url":"https://github.com/apache/couchdb/issues/3066#issuecomment-670824224","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3066","id":670824224,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDgyNDIyNA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-08T04:53:42Z","updated_at":"2020-08-08T04:53:42Z","author_association":"MEMBER","body":"Can you please double-check the checksum of the file after you download it? Use the following:\r\n\r\n```\r\nC:\\>fciv -both apache-couchdb-3.1.0.msi\r\n//\r\n// File Checksum Integrity Verifier version 2.05.\r\n//\r\n                MD5                             SHA-1\r\n-------------------------------------------------------------------------\r\n35a1d3e6b4df28e60abb0eef49180769 fbd609aa7d4e7fc796212d3a0c1fe71705ca425a apache-couchdb-3.1.0.msi\r\n```\r\n\r\nThe numbers should match mine above.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670824224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670826999","html_url":"https://github.com/apache/couchdb/issues/3066#issuecomment-670826999","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3066","id":670826999,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDgyNjk5OQ==","user":{"login":"samahudin","id":49563144,"node_id":"MDQ6VXNlcjQ5NTYzMTQ0","avatar_url":"https://avatars.githubusercontent.com/u/49563144?v=4","gravatar_id":"","url":"https://api.github.com/users/samahudin","html_url":"https://github.com/samahudin","followers_url":"https://api.github.com/users/samahudin/followers","following_url":"https://api.github.com/users/samahudin/following{/other_user}","gists_url":"https://api.github.com/users/samahudin/gists{/gist_id}","starred_url":"https://api.github.com/users/samahudin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samahudin/subscriptions","organizations_url":"https://api.github.com/users/samahudin/orgs","repos_url":"https://api.github.com/users/samahudin/repos","events_url":"https://api.github.com/users/samahudin/events{/privacy}","received_events_url":"https://api.github.com/users/samahudin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-08T05:27:18Z","updated_at":"2020-08-08T05:27:18Z","author_association":"NONE","body":"> Can you please double-check the checksum of the file after you download it? Use the following:\r\n> \r\n> ```\r\n> C:\\>fciv -both apache-couchdb-3.1.0.msi\r\n> //\r\n> // File Checksum Integrity Verifier version 2.05.\r\n> //\r\n>                 MD5                             SHA-1\r\n> -------------------------------------------------------------------------\r\n> 35a1d3e6b4df28e60abb0eef49180769 fbd609aa7d4e7fc796212d3a0c1fe71705ca425a apache-couchdb-3.1.0.msi\r\n> ```\r\n> \r\n> The numbers should match mine above.\r\n\r\nIt is different for me : \r\n3ea46579a22d9386585b1155113d23d5 5a8479bacb8442473ea36a5dff728935ff809208 apache-couchdb-3.1.0.msi\r\n\r\nWhat will be wrong ?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670826999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670827710","html_url":"https://github.com/apache/couchdb/issues/3066#issuecomment-670827710","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3066","id":670827710,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDgyNzcxMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-08T05:36:22Z","updated_at":"2020-08-08T05:37:01Z","author_association":"MEMBER","body":"Your download is corrupted.\r\n\r\nTry saving the file to a different drive.\r\n\r\nYour browser may have a corrupted download cached. Try downloading with a different browser, or a command line utility like `wget.exe`:\r\n\r\n`wget https://couchdb.neighbourhood.ie/downloads/3.1.0/win/apache-couchdb-3.1.0.msi`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670827710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670832929","html_url":"https://github.com/apache/couchdb/issues/3066#issuecomment-670832929","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3066","id":670832929,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDgzMjkyOQ==","user":{"login":"samahudin","id":49563144,"node_id":"MDQ6VXNlcjQ5NTYzMTQ0","avatar_url":"https://avatars.githubusercontent.com/u/49563144?v=4","gravatar_id":"","url":"https://api.github.com/users/samahudin","html_url":"https://github.com/samahudin","followers_url":"https://api.github.com/users/samahudin/followers","following_url":"https://api.github.com/users/samahudin/following{/other_user}","gists_url":"https://api.github.com/users/samahudin/gists{/gist_id}","starred_url":"https://api.github.com/users/samahudin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samahudin/subscriptions","organizations_url":"https://api.github.com/users/samahudin/orgs","repos_url":"https://api.github.com/users/samahudin/repos","events_url":"https://api.github.com/users/samahudin/events{/privacy}","received_events_url":"https://api.github.com/users/samahudin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-08T06:35:04Z","updated_at":"2020-08-08T06:35:40Z","author_association":"NONE","body":"I have used Edge browser now to download the file again, still no luck! \r\nAlso tried to get it by installing wget, but it is complaining \"Unable to establish SSL connection\".\r\n\r\nBelow are my observations, if anything leads to a conclusion : \r\n*I have tried with packages downloaded using chrome, FF, edge without success (6 times, I think).\r\n*Chrome and Edge showed a safety warning on the file.\r\n*Checksum of all these files are different than that you provided.\r\n*I have successfully installed v.2.3.1 without any glitch, so I cannot suspect browsers.\r\n\r\nThanks @wohali for you time on this!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670832929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670838030","html_url":"https://github.com/apache/couchdb/issues/3067#issuecomment-670838030","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3067","id":670838030,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDgzODAzMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-08T07:23:22Z","updated_at":"2020-08-08T07:23:22Z","author_association":"MEMBER","body":"Please do not make duplicate issues.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670838030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670838101","html_url":"https://github.com/apache/couchdb/issues/3066#issuecomment-670838101","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3066","id":670838101,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDgzODEwMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-08T07:23:51Z","updated_at":"2020-08-08T07:23:51Z","author_association":"MEMBER","body":"I don't have a good answer for you here. This is the first time we've seen this reported, and no one is able to reproduce this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670838101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670838310","html_url":"https://github.com/apache/couchdb/issues/3066#issuecomment-670838310","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3066","id":670838310,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDgzODMxMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-08T07:26:05Z","updated_at":"2020-08-08T07:26:05Z","author_association":"MEMBER","body":"From a host in Japan:\r\n\r\n```bash\r\n$ wget https://couchdb.neighbourhood.ie/downloads/3.1.0/win/apache-couchdb-3.1.0.msi\r\n--2020-08-08 03:24:05--  https://couchdb.neighbourhood.ie/downloads/3.1.0/win/apache-couchdb-3.1.0.msi\r\nResolving couchdb.neighbourhood.ie (couchdb.neighbourhood.ie)... 185.26.156.32\r\nConnecting to couchdb.neighbourhood.ie (couchdb.neighbourhood.ie)|185.26.156.32|:443... connected.\r\nHTTP request sent, awaiting response... 302 Found\r\nLocation: https://couchdbneighbourhoodie.fra1.digitaloceanspaces.com/downloads/3.1.0/win/apache-couchdb-3.1.0.msi [following]\r\n--2020-08-08 03:24:07--  https://couchdbneighbourhoodie.fra1.digitaloceanspaces.com/downloads/3.1.0/win/apache-couchdb-3.1.0.msi\r\nResolving couchdbneighbourhoodie.fra1.digitaloceanspaces.com (couchdbneighbourhoodie.fra1.digitaloceanspaces.com)... 5.101.109.41\r\nConnecting to couchdbneighbourhoodie.fra1.digitaloceanspaces.com (couchdbneighbourhoodie.fra1.digitaloceanspaces.com)|5.101.109.41|:443... connected.\r\nHTTP request sent, awaiting response... 200 OK\r\nLength: 60686336 (58M) []\r\nSaving to: â€˜apache-couchdb-3.1.0.msiâ€™\r\n\r\napache-couchdb-3.1.0.m 100%[==========================>]  57.88M  6.73MB/s    in 11s     \r\n\r\n2020-08-08 03:24:20 (5.33 MB/s) - â€˜apache-couchdb-3.1.0.msiâ€™ saved [60686336/60686336]\r\n\r\n$ sha1sum apache-couchdb-3.1.0.msi \r\nfbd609aa7d4e7fc796212d3a0c1fe71705ca425a  apache-couchdb-3.1.0.msi\r\n$ md5sum apache-couchdb-3.1.0.msi \r\n35a1d3e6b4df28e60abb0eef49180769  apache-couchdb-3.1.0.msi\r\n$ ls -la apache-couchdb-3.1.0.msi \r\n-rw-r--r-- 1 joant joant 60686336 May  4 20:03 apache-couchdb-3.1.0.msi\r\n\r\n```\r\n\r\nI have the same results from my laptop here in Canada.\r\n\r\nIf your downloaded file does not match this file's size or checksum, the problem isn't on our end - it's something related to your Internet provider or your connection to the Internet.\r\n\r\nThe only possibility is that whatever ISP you are behind, in whichever country you are in, is giving you a corrupted, truncated download.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670838310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670905228","html_url":"https://github.com/apache/couchdb/issues/3066#issuecomment-670905228","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3066","id":670905228,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDkwNTIyOA==","user":{"login":"samahudin","id":49563144,"node_id":"MDQ6VXNlcjQ5NTYzMTQ0","avatar_url":"https://avatars.githubusercontent.com/u/49563144?v=4","gravatar_id":"","url":"https://api.github.com/users/samahudin","html_url":"https://github.com/samahudin","followers_url":"https://api.github.com/users/samahudin/followers","following_url":"https://api.github.com/users/samahudin/following{/other_user}","gists_url":"https://api.github.com/users/samahudin/gists{/gist_id}","starred_url":"https://api.github.com/users/samahudin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samahudin/subscriptions","organizations_url":"https://api.github.com/users/samahudin/orgs","repos_url":"https://api.github.com/users/samahudin/repos","events_url":"https://api.github.com/users/samahudin/events{/privacy}","received_events_url":"https://api.github.com/users/samahudin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-08T11:16:25Z","updated_at":"2020-08-08T11:16:25Z","author_association":"NONE","body":"Thanks @wohali for your time on this! I am still struggling on this. Let me try on other options. If anything find success, I'll post here.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670905228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670943799","html_url":"https://github.com/apache/couchdb/issues/3066#issuecomment-670943799","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3066","id":670943799,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDk0Mzc5OQ==","user":{"login":"samahudin","id":49563144,"node_id":"MDQ6VXNlcjQ5NTYzMTQ0","avatar_url":"https://avatars.githubusercontent.com/u/49563144?v=4","gravatar_id":"","url":"https://api.github.com/users/samahudin","html_url":"https://github.com/samahudin","followers_url":"https://api.github.com/users/samahudin/followers","following_url":"https://api.github.com/users/samahudin/following{/other_user}","gists_url":"https://api.github.com/users/samahudin/gists{/gist_id}","starred_url":"https://api.github.com/users/samahudin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samahudin/subscriptions","organizations_url":"https://api.github.com/users/samahudin/orgs","repos_url":"https://api.github.com/users/samahudin/repos","events_url":"https://api.github.com/users/samahudin/events{/privacy}","received_events_url":"https://api.github.com/users/samahudin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-08T15:49:52Z","updated_at":"2020-08-08T15:49:52Z","author_association":"NONE","body":"Finally I got 3.1.0 installed! \r\nThe package from 'digitaloceanspaces' worked - https://couchdbneighbourhoodie.fra1.digitaloceanspaces.com/downloads/3.1.0/win/apache-couchdb-3.1.0.msi\r\nThe checksum also matches.\r\n\r\n**The file from https://couchdb.neighbourhood.ie still seems corrupted.**\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670943799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670969856","html_url":"https://github.com/apache/couchdb/issues/3066#issuecomment-670969856","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3066","id":670969856,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDk2OTg1Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-08T20:19:03Z","updated_at":"2020-08-08T20:19:03Z","author_association":"MEMBER","body":"They are the _exact same file_. There is no corruption.\r\n\r\nYour ISP must have a transparent proxy that cached the first URL truncated.\r\n\r\nI bet, if you try the download again in 48 or 72 hours, it will be fine.\r\n\r\nIn any case I am glad you have a successful download now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670969856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670991411","html_url":"https://github.com/apache/couchdb/issues/3066#issuecomment-670991411","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3066","id":670991411,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDk5MTQxMQ==","user":{"login":"samahudin","id":49563144,"node_id":"MDQ6VXNlcjQ5NTYzMTQ0","avatar_url":"https://avatars.githubusercontent.com/u/49563144?v=4","gravatar_id":"","url":"https://api.github.com/users/samahudin","html_url":"https://github.com/samahudin","followers_url":"https://api.github.com/users/samahudin/followers","following_url":"https://api.github.com/users/samahudin/following{/other_user}","gists_url":"https://api.github.com/users/samahudin/gists{/gist_id}","starred_url":"https://api.github.com/users/samahudin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samahudin/subscriptions","organizations_url":"https://api.github.com/users/samahudin/orgs","repos_url":"https://api.github.com/users/samahudin/repos","events_url":"https://api.github.com/users/samahudin/events{/privacy}","received_events_url":"https://api.github.com/users/samahudin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-09T01:11:23Z","updated_at":"2020-08-09T01:11:44Z","author_association":"NONE","body":"> They are the _exact same file_. There is no corruption.\r\n> \r\n> Your ISP must have a transparent proxy that cached the first URL truncated.\r\n> \r\n> I bet, if you try the download again in 48 or 72 hours, it will be fine.\r\n\r\nSure I'll check on later.\r\nSince this cannot be controlled from user-end, is it good to list all available mirrors in the download page?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/670991411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/671009087","html_url":"https://github.com/apache/couchdb/issues/3066#issuecomment-671009087","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3066","id":671009087,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MTAwOTA4Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-09T05:33:16Z","updated_at":"2020-08-09T05:33:16Z","author_association":"MEMBER","body":"There are no mirrors. The URL always redirects to a page under that domain.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/671009087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/671045089","html_url":"https://github.com/apache/couchdb/issues/2291#issuecomment-671045089","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2291","id":671045089,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MTA0NTA4OQ==","user":{"login":"mnxumalo","id":7589062,"node_id":"MDQ6VXNlcjc1ODkwNjI=","avatar_url":"https://avatars.githubusercontent.com/u/7589062?v=4","gravatar_id":"","url":"https://api.github.com/users/mnxumalo","html_url":"https://github.com/mnxumalo","followers_url":"https://api.github.com/users/mnxumalo/followers","following_url":"https://api.github.com/users/mnxumalo/following{/other_user}","gists_url":"https://api.github.com/users/mnxumalo/gists{/gist_id}","starred_url":"https://api.github.com/users/mnxumalo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mnxumalo/subscriptions","organizations_url":"https://api.github.com/users/mnxumalo/orgs","repos_url":"https://api.github.com/users/mnxumalo/repos","events_url":"https://api.github.com/users/mnxumalo/events{/privacy}","received_events_url":"https://api.github.com/users/mnxumalo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-09T12:19:20Z","updated_at":"2020-08-09T12:19:20Z","author_association":"NONE","body":"Hi,\r\nCan I work on this bug?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/671045089/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/671254847","html_url":"https://github.com/apache/couchdb/issues/3061#issuecomment-671254847","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3061","id":671254847,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MTI1NDg0Nw==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-10T09:31:57Z","updated_at":"2020-08-10T09:31:57Z","author_association":"MEMBER","body":"Original introduction of this problem is here https://github.com/apache/couchdb/commit/d977eb7ec52bc13dca7b4f530cb51f42df0f6224. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/671254847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/671255305","html_url":"https://github.com/apache/couchdb/issues/3061#issuecomment-671255305","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3061","id":671255305,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MTI1NTMwNQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-10T09:33:09Z","updated_at":"2020-08-10T09:33:09Z","author_association":"MEMBER","body":"```\r\ndiff --git a/src/couch_index/src/couch_index_server.erl b/src/couch_index/src/couch_index_server.erl\r\nindex 49d1e61b7..f1828c665 100644\r\n--- a/src/couch_index/src/couch_index_server.erl\r\n+++ b/src/couch_index/src/couch_index_server.erl\r\n@@ -243,9 +243,8 @@ reset_indexes(DbName, Root) ->\r\n     end, dict:new(), ets:lookup(?BY_DB, DbName)),\r\n     Fun = fun({Sig, DDocIds}) ->\r\n         [{_, Pid}] = ets:lookup(?BY_SIG, {DbName, Sig}),\r\n-        MRef = erlang:monitor(process, Pid),\r\n         gen_server:cast(Pid, delete),\r\n-        receive {'DOWN', MRef, _, _, _} -> ok end,\r\n+        receive {'EXIT', Pid, _Reason} -> ok end,\r\n         rem_from_ets(DbName, Sig, DDocIds, Pid)\r\n     end,\r\n     lists:foreach(Fun, dict:to_list(SigDDocIds)),\r\n```\r\n\r\nIs this what you mean, @davisp?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/671255305/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]