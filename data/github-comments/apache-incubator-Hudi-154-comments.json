[{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919758805","html_url":"https://github.com/apache/hudi/pull/3664#issuecomment-919758805","issue_url":"https://api.github.com/repos/apache/hudi/issues/3664","id":919758805,"node_id":"IC_kwDOBI7nWM420mfV","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T07:09:44Z","updated_at":"2021-09-15T22:39:13Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"8798ec848605c413be660a58cb0b01aebaf0bf47\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2231\",\n    \"triggerID\" : \"8798ec848605c413be660a58cb0b01aebaf0bf47\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"8798ec848605c413be660a58cb0b01aebaf0bf47\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2239\",\n    \"triggerID\" : \"920187126\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"8798ec848605c413be660a58cb0b01aebaf0bf47\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2240\",\n    \"triggerID\" : \"920201009\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"8798ec848605c413be660a58cb0b01aebaf0bf47\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2239\",\n    \"triggerID\" : \"920201009\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"546ceddf55ba181711ad0073b464a03302650db6\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2241\",\n    \"triggerID\" : \"546ceddf55ba181711ad0073b464a03302650db6\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"bc99d3169605da957d2b5c0807db351ffda9f845\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2243\",\n    \"triggerID\" : \"920328060\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"bc99d3169605da957d2b5c0807db351ffda9f845\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2243\",\n    \"triggerID\" : \"bc99d3169605da957d2b5c0807db351ffda9f845\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"bc99d3169605da957d2b5c0807db351ffda9f845\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2244\",\n    \"triggerID\" : \"920329753\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"bc99d3169605da957d2b5c0807db351ffda9f845\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2243\",\n    \"triggerID\" : \"920329753\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"c070774d6c7d1c876eb3c529ba6cacf0bb58a948\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2245\",\n    \"triggerID\" : \"920330492\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"c070774d6c7d1c876eb3c529ba6cacf0bb58a948\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2245\",\n    \"triggerID\" : \"c070774d6c7d1c876eb3c529ba6cacf0bb58a948\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"c070774d6c7d1c876eb3c529ba6cacf0bb58a948\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2245\",\n    \"triggerID\" : \"920352971\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"af7a424d65677f10dba51836220751afb3fd6f4a\",\n    \"status\" : \"UNKNOWN\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"af7a424d65677f10dba51836220751afb3fd6f4a\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"920328060\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"920330492\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"37b53485eaef00800e1ec5ce833c54b618cb3054\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2246\",\n    \"triggerID\" : \"37b53485eaef00800e1ec5ce833c54b618cb3054\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* af7a424d65677f10dba51836220751afb3fd6f4a UNKNOWN\n* 37b53485eaef00800e1ec5ce833c54b618cb3054 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2246) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919758805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919761938","html_url":"https://github.com/apache/hudi/issues/3657#issuecomment-919761938","issue_url":"https://api.github.com/repos/apache/hudi/issues/3657","id":919761938,"node_id":"IC_kwDOBI7nWM420nQS","user":{"login":"gaoshihang","id":20013931,"node_id":"MDQ6VXNlcjIwMDEzOTMx","avatar_url":"https://avatars.githubusercontent.com/u/20013931?v=4","gravatar_id":"","url":"https://api.github.com/users/gaoshihang","html_url":"https://github.com/gaoshihang","followers_url":"https://api.github.com/users/gaoshihang/followers","following_url":"https://api.github.com/users/gaoshihang/following{/other_user}","gists_url":"https://api.github.com/users/gaoshihang/gists{/gist_id}","starred_url":"https://api.github.com/users/gaoshihang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaoshihang/subscriptions","organizations_url":"https://api.github.com/users/gaoshihang/orgs","repos_url":"https://api.github.com/users/gaoshihang/repos","events_url":"https://api.github.com/users/gaoshihang/events{/privacy}","received_events_url":"https://api.github.com/users/gaoshihang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T07:14:50Z","updated_at":"2021-09-15T07:14:50Z","author_association":"CONTRIBUTOR","body":"I have exactly the some problem.........","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919761938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919771818","html_url":"https://github.com/apache/hudi/issues/3657#issuecomment-919771818","issue_url":"https://api.github.com/repos/apache/hudi/issues/3657","id":919771818,"node_id":"IC_kwDOBI7nWM420pqq","user":{"login":"gaoshihang","id":20013931,"node_id":"MDQ6VXNlcjIwMDEzOTMx","avatar_url":"https://avatars.githubusercontent.com/u/20013931?v=4","gravatar_id":"","url":"https://api.github.com/users/gaoshihang","html_url":"https://github.com/gaoshihang","followers_url":"https://api.github.com/users/gaoshihang/followers","following_url":"https://api.github.com/users/gaoshihang/following{/other_user}","gists_url":"https://api.github.com/users/gaoshihang/gists{/gist_id}","starred_url":"https://api.github.com/users/gaoshihang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaoshihang/subscriptions","organizations_url":"https://api.github.com/users/gaoshihang/orgs","repos_url":"https://api.github.com/users/gaoshihang/repos","events_url":"https://api.github.com/users/gaoshihang/events{/privacy}","received_events_url":"https://api.github.com/users/gaoshihang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T07:31:05Z","updated_at":"2021-09-15T07:31:05Z","author_association":"CONTRIBUTOR","body":"and if I use flink 1.13.1 and hudi master, there are another ERROR:\r\norg.apache.flink.runtime.JobException: Recovery is suppressed by NoRestartBackoffTimeStrategy\r\n\tat org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.handleFailure(ExecutionFailureHandler.java:138)\r\n\tat org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.getFailureHandlingResult(ExecutionFailureHandler.java:82)\r\n\tat org.apache.flink.runtime.scheduler.DefaultScheduler.handleTaskFailure(DefaultScheduler.java:207)\r\n\tat org.apache.flink.runtime.scheduler.DefaultScheduler.maybeHandleTaskFailure(DefaultScheduler.java:197)\r\n\tat org.apache.flink.runtime.scheduler.DefaultScheduler.updateTaskExecutionStateInternal(DefaultScheduler.java:188)\r\n\tat org.apache.flink.runtime.scheduler.SchedulerBase.updateTaskExecutionState(SchedulerBase.java:677)\r\n\tat org.apache.flink.runtime.scheduler.SchedulerNG.updateTaskExecutionState(SchedulerNG.java:79)\r\n\tat org.apache.flink.runtime.jobmaster.JobMaster.updateTaskExecutionState(JobMaster.java:435)\r\n\tat sun.reflect.GeneratedMethodAccessor23.invoke(Unknown Source)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcInvocation(AkkaRpcActor.java:305)\r\n\tat org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:212)\r\n\tat org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:77)\r\n\tat org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:158)\r\n\tat akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26)\r\n\tat akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21)\r\n\tat scala.PartialFunction$class.applyOrElse(PartialFunction.scala:123)\r\n\tat akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21)\r\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:170)\r\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)\r\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)\r\n\tat akka.actor.Actor$class.aroundReceive(Actor.scala:517)\r\n\tat akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225)\r\n\tat akka.actor.ActorCell.receiveMessage(ActorCell.scala:592)\r\n\tat akka.actor.ActorCell.invoke(ActorCell.scala:561)\r\n\tat akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258)\r\n\tat akka.dispatch.Mailbox.run(Mailbox.scala:225)\r\n\tat akka.dispatch.Mailbox.exec(Mailbox.scala:235)\r\n\tat akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)\r\n\tat akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)\r\n\tat akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)\r\n\tat akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)\r\nCaused by: java.lang.IllegalArgumentException: hoodie.properties file seems invalid. Please check for left over `.updated` files if any, manually copy it to hoodie.properties and retry\r\n\tat org.apache.hudi.common.util.ValidationUtils.checkArgument(ValidationUtils.java:40)\r\n\tat org.apache.hudi.common.table.HoodieTableConfig.<init>(HoodieTableConfig.java:184)\r\n\tat org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:114)\r\n\tat org.apache.hudi.common.table.HoodieTableMetaClient.<init>(HoodieTableMetaClient.java:74)\r\n\tat org.apache.hudi.common.table.HoodieTableMetaClient$Builder.build(HoodieTableMetaClient.java:607)\r\n\tat org.apache.hudi.table.HoodieFlinkTable.create(HoodieFlinkTable.java:48)\r\n\tat org.apache.hudi.sink.partitioner.profile.WriteProfile.<init>(WriteProfile.java:118)\r\n\tat org.apache.hudi.sink.partitioner.profile.DeltaWriteProfile.<init>(DeltaWriteProfile.java:43)\r\n\tat org.apache.hudi.sink.partitioner.profile.WriteProfiles.getWriteProfile(WriteProfiles.java:75)\r\n\tat org.apache.hudi.sink.partitioner.profile.WriteProfiles.lambda$singleton$0(WriteProfiles.java:64)\r\n\tat java.util.HashMap.computeIfAbsent(HashMap.java:1127)\r\n\tat org.apache.hudi.sink.partitioner.profile.WriteProfiles.singleton(WriteProfiles.java:63)\r\n\tat org.apache.hudi.sink.partitioner.BucketAssigners.create(BucketAssigners.java:56)\r\n\tat org.apache.hudi.sink.partitioner.BucketAssignFunction.open(BucketAssignFunction.java:123)\r\n\tat org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:34)\r\n\tat org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.open(AbstractUdfStreamOperator.java:102)\r\n\tat org.apache.flink.streaming.api.operators.KeyedProcessOperator.open(KeyedProcessOperator.java:55)\r\n\tat org.apache.hudi.sink.partitioner.BucketAssignOperator.open(BucketAssignOperator.java:41)\r\n\tat org.apache.flink.streaming.runtime.tasks.OperatorChain.initializeStateAndOpenOperators(OperatorChain.java:437)\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.restoreGates(StreamTask.java:582)\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55)\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.executeRestore(StreamTask.java:562)\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.runWithCleanUpOnFail(StreamTask.java:647)\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:537)\r\n\tat org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:759)\r\n\tat org.apache.flink.runtime.taskmanager.Task.run(Task.java:566)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n\tSuppressed: java.lang.NullPointerException\r\n\t\tat org.apache.hudi.sink.partitioner.BucketAssignFunction.close(BucketAssignFunction.java:244)\r\n\t\tat org.apache.flink.api.common.functions.util.FunctionUtils.closeFunction(FunctionUtils.java:41)\r\n\t\tat org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.dispose(AbstractUdfStreamOperator.java:117)\r\n\t\tat org.apache.flink.streaming.runtime.tasks.StreamTask.disposeAllOperators(StreamTask.java:861)\r\n\t\tat org.apache.flink.streaming.runtime.tasks.StreamTask.runAndSuppressThrowable(StreamTask.java:840)\r\n\t\tat org.apache.flink.streaming.runtime.tasks.StreamTask.cleanUpInvoke(StreamTask.java:753)\r\n\t\tat org.apache.flink.streaming.runtime.tasks.StreamTask.runWithCleanUpOnFail(StreamTask.java:659)\r\n\t\t... 4 more","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919771818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919772218","html_url":"https://github.com/apache/hudi/issues/3665#issuecomment-919772218","issue_url":"https://api.github.com/repos/apache/hudi/issues/3665","id":919772218,"node_id":"IC_kwDOBI7nWM420pw6","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T07:31:42Z","updated_at":"2021-09-15T07:31:42Z","author_association":"CONTRIBUTOR","body":"If you shorten this time, can you meet your needs? . It is true that time should be used as a configuration item, and users can configure it based on this. I will open an issue to track this matter, and you will be able to use this feature soon","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919772218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919801616","html_url":"https://github.com/apache/hudi/pull/3666#issuecomment-919801616","issue_url":"https://api.github.com/repos/apache/hudi/issues/3666","id":919801616,"node_id":"IC_kwDOBI7nWM420w8Q","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T08:15:39Z","updated_at":"2021-09-24T05:25:57Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"a28e73a2afbf7d793f4468df1b3e8f4a20516155\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2232\",\n    \"triggerID\" : \"a28e73a2afbf7d793f4468df1b3e8f4a20516155\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"91c8a9be88ffcfd2e52e6c45f9cc525b0c58a930\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2363\",\n    \"triggerID\" : \"91c8a9be88ffcfd2e52e6c45f9cc525b0c58a930\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"3c644ce10e79d7ada8e04ef8227e12ad4a1d7e7e\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2364\",\n    \"triggerID\" : \"3c644ce10e79d7ada8e04ef8227e12ad4a1d7e7e\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 3c644ce10e79d7ada8e04ef8227e12ad4a1d7e7e Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2364) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919801616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919813603","html_url":"https://github.com/apache/hudi/pull/3667#issuecomment-919813603","issue_url":"https://api.github.com/repos/apache/hudi/issues/3667","id":919813603,"node_id":"IC_kwDOBI7nWM420z3j","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T08:32:27Z","updated_at":"2021-09-16T13:09:58Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"372ed628dd3af059afaedb29e9b5ebe3b0e1cc47\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2233\",\n    \"triggerID\" : \"372ed628dd3af059afaedb29e9b5ebe3b0e1cc47\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"372ed628dd3af059afaedb29e9b5ebe3b0e1cc47\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2234\",\n    \"triggerID\" : \"919832944\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"aba0e0d101bfde2f42236fb65e5e212683dbe657\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2236\",\n    \"triggerID\" : \"aba0e0d101bfde2f42236fb65e5e212683dbe657\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"aba0e0d101bfde2f42236fb65e5e212683dbe657\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2236\",\n    \"triggerID\" : \"919832944\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"10f05d42a895e0c1083bb0ce3f7102f59416a012\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2252\",\n    \"triggerID\" : \"10f05d42a895e0c1083bb0ce3f7102f59416a012\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"10f05d42a895e0c1083bb0ce3f7102f59416a012\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2255\",\n    \"triggerID\" : \"920688486\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"53fea88f4c72ba3ec3c855f14bf244dbcaf0afc6\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2257\",\n    \"triggerID\" : \"53fea88f4c72ba3ec3c855f14bf244dbcaf0afc6\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"53fea88f4c72ba3ec3c855f14bf244dbcaf0afc6\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2257\",\n    \"triggerID\" : \"920688486\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"13611371aa425cf2acf4fee39dd78265d47d4703\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2262\",\n    \"triggerID\" : \"13611371aa425cf2acf4fee39dd78265d47d4703\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 13611371aa425cf2acf4fee39dd78265d47d4703 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2262) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919813603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919814995","html_url":"https://github.com/apache/hudi/issues/3665#issuecomment-919814995","issue_url":"https://api.github.com/repos/apache/hudi/issues/3665","id":919814995,"node_id":"IC_kwDOBI7nWM4200NT","user":{"login":"Wrekkers","id":24206010,"node_id":"MDQ6VXNlcjI0MjA2MDEw","avatar_url":"https://avatars.githubusercontent.com/u/24206010?v=4","gravatar_id":"","url":"https://api.github.com/users/Wrekkers","html_url":"https://github.com/Wrekkers","followers_url":"https://api.github.com/users/Wrekkers/followers","following_url":"https://api.github.com/users/Wrekkers/following{/other_user}","gists_url":"https://api.github.com/users/Wrekkers/gists{/gist_id}","starred_url":"https://api.github.com/users/Wrekkers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Wrekkers/subscriptions","organizations_url":"https://api.github.com/users/Wrekkers/orgs","repos_url":"https://api.github.com/users/Wrekkers/repos","events_url":"https://api.github.com/users/Wrekkers/events{/privacy}","received_events_url":"https://api.github.com/users/Wrekkers/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T08:34:21Z","updated_at":"2021-09-15T08:34:21Z","author_association":"NONE","body":"We are creating a user defined class to shorten the time. will update if it\nsolves the issue.\n\nThank you\n\nOn Wed, 15 Sep 2021, 1:01 pm liujinhui, ***@***.***> wrote:\n\n> If you shorten this time, can you meet your needs? . It is true that time\n> should be used as a configuration item, and users can configure it based on\n> this. I will open an issue to track this matter, and you will be able to\n> use this feature soon\n>\n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/hudi/issues/3665#issuecomment-919772218>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AFYVVOVAWX56PZMBBC4GDXTUCBDWTANCNFSM5EBY5CDQ>\n> .\n> Triage notifications on the go with GitHub Mobile for iOS\n> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n> or Android\n> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n>\n>\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919814995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919815630","html_url":"https://github.com/apache/hudi/issues/3665#issuecomment-919815630","issue_url":"https://api.github.com/repos/apache/hudi/issues/3665","id":919815630,"node_id":"IC_kwDOBI7nWM4200XO","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T08:35:15Z","updated_at":"2021-09-15T08:35:15Z","author_association":"CONTRIBUTOR","body":"Will be resolved today","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919815630/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919826819","html_url":"https://github.com/apache/hudi/pull/3652#issuecomment-919826819","issue_url":"https://api.github.com/repos/apache/hudi/issues/3652","id":919826819,"node_id":"IC_kwDOBI7nWM4203GD","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T08:50:57Z","updated_at":"2021-09-15T08:50:57Z","author_association":"CONTRIBUTOR","body":"@hudi-bot  run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919826819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919832944","html_url":"https://github.com/apache/hudi/pull/3667#issuecomment-919832944","issue_url":"https://api.github.com/repos/apache/hudi/issues/3667","id":919832944,"node_id":"IC_kwDOBI7nWM4204lw","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T08:59:19Z","updated_at":"2021-09-15T08:59:19Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919832944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919852009","html_url":"https://github.com/apache/hudi/pull/3666#issuecomment-919852009","issue_url":"https://api.github.com/repos/apache/hudi/issues/3666","id":919852009,"node_id":"IC_kwDOBI7nWM4209Pp","user":{"login":"zhangyue19921010","id":69956021,"node_id":"MDQ6VXNlcjY5OTU2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/69956021?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyue19921010","html_url":"https://github.com/zhangyue19921010","followers_url":"https://api.github.com/users/zhangyue19921010/followers","following_url":"https://api.github.com/users/zhangyue19921010/following{/other_user}","gists_url":"https://api.github.com/users/zhangyue19921010/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyue19921010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyue19921010/subscriptions","organizations_url":"https://api.github.com/users/zhangyue19921010/orgs","repos_url":"https://api.github.com/users/zhangyue19921010/repos","events_url":"https://api.github.com/users/zhangyue19921010/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyue19921010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T09:24:09Z","updated_at":"2021-09-15T09:24:09Z","author_association":"CONTRIBUTOR","body":"Here 's driver log \r\n```\r\n21/09/15 08:26:13 INFO client.SparkRDDWriteClient: Committing Clustering 20210915043458. Finished with result xxxxxxx\r\n21/09/15 08:26:13 INFO timeline.HoodieActiveTimeline: Checking for file exists ?s3a://xxx/xxxx/xxx/xxxx_delivered_hourly/.hoodie/20210915043458.replacecommit.inflight\r\n21/09/15 08:26:14 INFO timeline.HoodieActiveTimeline: Create new file for toInstant ?s3a://xxxx/xxx/xxxxxx/xxxxx_delivered_hourly/.hoodie/20210915043458.replacecommit\r\n21/09/15 08:26:14 INFO client.SparkRDDWriteClient: Clustering successfully on commit 20210915043458\r\n```\r\n\r\nHere's one of the executor log\r\n```\r\n21/09/15 08:28:39 INFO queue.IteratorBasedQueueProducer: starting to buffer records\r\n21/09/15 08:28:39 INFO queue.BoundedInMemoryExecutor: starting consumer thread\r\n21/09/15 08:28:39 INFO fs.FSUtils: Hadoop Configuration: fs.defaultFS: [hdfs://dev-HBase-hadoop-aws], Config:[Configuration: ], FileSystem: [org.apache.hadoop.fs.s3a.S3AFileSystem@6df37e26]\r\n21/09/15 08:28:39 INFO table.MarkerFiles: Creating Marker Path=s3a://xxxxx/xxx/xxxx/xxxxx_delivered_hourly/.hoodie/.temp/20210915043458/2021080920/eb3c98ba-1df9-41c6-bd7c-a4708f4728db-0_3-82-2226_20210915043458.parquet.marker.CREATE\r\n21/09/15 08:28:40 INFO fs.FSUtils: Hadoop Configuration: fs.defaultFS: [hdfs://dev-HBase-hadoop-aws], Config:[Configuration: ], FileSystem: [org.apache.hadoop.fs.s3a.S3AFileSystem@6df37e26]\r\n21/09/15 08:28:40 INFO fs.FSUtils: Hadoop Configuration: fs.defaultFS: [hdfs://dev-HBase-hadoop-aws], Config:[Configuration: ], FileSystem: [org.apache.hadoop.fs.s3a.S3AFileSystem@6df37e26]\r\n21/09/15 08:28:40 INFO fs.FSUtils: Hadoop Configuration: fs.defaultFS: [hdfs://dev-HBase-hadoop-aws], Config:[Configuration: ], FileSystem: [org.apache.hadoop.fs.s3a.S3AFileSystem@6df37e26]\r\n21/09/15 08:28:40 INFO fs.FSUtils: Hadoop Configuration: fs.defaultFS: [hdfs://dev-HBase-hadoop-aws], Config:[Configuration: ], FileSystem: [org.apache.hadoop.fs.s3a.S3AFileSystem@6df37e26]\r\n21/09/15 08:28:40 INFO io.HoodieCreateHandle: New CreateHandle for partition :2021080920 with fileId eb3c98ba-1df9-41c6-bd7c-a4708f4728db-0\r\n21/09/15 08:29:59 INFO hadoop.InternalParquetRecordWriter: mem size 127089967 > 125829120: flushing 1820100 records to disk.\r\n21/09/15 08:29:59 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 90099622\r\n21/09/15 08:31:28 INFO hadoop.InternalParquetRecordWriter: mem size 128373302 > 125829120: flushing 2080100 records to disk.\r\n21/09/15 08:31:28 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 92189808\r\n21/09/15 08:32:36 INFO hadoop.InternalParquetRecordWriter: mem size 127167016 > 125829120: flushing 1570100 records to disk.\r\n21/09/15 08:32:36 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 88982724\r\n21/09/15 08:33:53 INFO hadoop.InternalParquetRecordWriter: mem size 128862551 > 125829120: flushing 1831855 records to disk.\r\n21/09/15 08:33:53 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 91370793\r\n21/09/15 08:35:20 INFO hadoop.InternalParquetRecordWriter: mem size 131655158 > 125829120: flushing 2080100 records to disk.\r\n21/09/15 08:35:20 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 92697898\r\n21/09/15 08:36:48 INFO hadoop.InternalParquetRecordWriter: mem size 131995642 > 125829120: flushing 2090100 records to disk.\r\n21/09/15 08:36:48 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 89312422\r\n21/09/15 08:38:15 INFO hadoop.InternalParquetRecordWriter: mem size 129924890 > 125829120: flushing 2080100 records to disk.\r\n21/09/15 08:38:15 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 92490914\r\n21/09/15 08:39:43 INFO hadoop.InternalParquetRecordWriter: mem size 132976241 > 125829120: flushing 2090100 records to disk.\r\n21/09/15 08:39:43 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 93174323\r\n21/09/15 08:41:11 INFO hadoop.InternalParquetRecordWriter: mem size 127472104 > 125829120: flushing 2080100 records to disk.\r\n21/09/15 08:41:11 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 90252952\r\n21/09/15 08:42:27 INFO hadoop.InternalParquetRecordWriter: mem size 126290145 > 125829120: flushing 1820100 records to disk.\r\n21/09/15 08:42:27 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 88456116\r\n21/09/15 08:43:54 INFO hadoop.InternalParquetRecordWriter: mem size 130410565 > 125829120: flushing 2090100 records to disk.\r\n21/09/15 08:43:54 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 89164496\r\n21/09/15 08:45:21 INFO hadoop.InternalParquetRecordWriter: mem size 131209888 > 125829120: flushing 2090100 records to disk.\r\n21/09/15 08:45:21 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 87793573\r\n21/09/15 08:46:39 INFO hadoop.InternalParquetRecordWriter: mem size 126494819 > 125829120: flushing 1820100 records to disk.\r\n21/09/15 08:46:39 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 88404896\r\n21/09/15 08:47:24 INFO hadoop.InternalParquetRecordWriter: mem size 129103207 > 125829120: flushing 1040100 records to disk.\r\n21/09/15 08:47:24 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 80514268\r\n21/09/15 08:48:41 INFO hadoop.InternalParquetRecordWriter: mem size 128490439 > 125829120: flushing 1820100 records to disk.\r\n21/09/15 08:48:41 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 89663525\r\n21/09/15 08:50:10 INFO hadoop.InternalParquetRecordWriter: mem size 132832927 > 125829120: flushing 2088626 records to disk.\r\n21/09/15 08:50:10 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 94414992\r\n21/09/15 08:50:11 INFO io.HoodieCreateHandle: Closing the file eb3c98ba-1df9-41c6-bd7c-a4708f4728db-0 as we are done with all the records 30491881\r\n21/09/15 08:50:11 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 0\r\n21/09/15 08:50:18 INFO io.HoodieCreateHandle: CreateHandle for partitionPath 2021080920 fileID eb3c98ba-1df9-41c6-bd7c-a4708f4728db-0, took 1299522 ms.\r\n21/09/15 08:50:18 INFO table.MarkerFiles: Creating Marker Path=s3a://xxxxx/xxx/xxxxx/xxxxx_delivered_hourly/.hoodie/.temp/20210915043458/2021080920/eb3c98ba-1df9-41c6-bd7c-a4708f4728db-1_3-82-2226_20210915043458.parquet.marker.CREATE\r\n21/09/15 08:50:19 INFO fs.FSUtils: Hadoop Configuration: fs.defaultFS: [hdfs://dev-HBase-hadoop-aws], Config:[Configuration: ], FileSystem: [org.apache.hadoop.fs.s3a.S3AFileSystem@6df37e26]\r\n21/09/15 08:50:19 INFO fs.FSUtils: Hadoop Configuration: fs.defaultFS: [hdfs://dev-HBase-hadoop-aws], Config:[Configuration: ], FileSystem: [org.apache.hadoop.fs.s3a.S3AFileSystem@6df37e26]\r\n21/09/15 08:50:19 INFO fs.FSUtils: Hadoop Configuration: fs.defaultFS: [hdfs://dev-HBase-hadoop-aws], Config:[Configuration: ], FileSystem: [org.apache.hadoop.fs.s3a.S3AFileSystem@6df37e26]\r\n21/09/15 08:50:19 INFO fs.FSUtils: Hadoop Configuration: fs.defaultFS: [hdfs://dev-HBase-hadoop-aws], Config:[Configuration: ], FileSystem: [org.apache.hadoop.fs.s3a.S3AFileSystem@6df37e26]\r\n21/09/15 08:50:19 INFO io.HoodieCreateHandle: New CreateHandle for partition :2021080920 with fileId eb3c98ba-1df9-41c6-bd7c-a4708f4728db-1\r\n21/09/15 08:51:47 INFO hadoop.InternalParquetRecordWriter: mem size 126517453 > 125829120: flushing 2080100 records to disk.\r\n21/09/15 08:51:47 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 88199400\r\n21/09/15 08:53:18 INFO hadoop.InternalParquetRecordWriter: mem size 129113451 > 125829120: flushing 2080100 records to disk.\r\n21/09/15 08:53:18 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 91238066\r\n21/09/15 08:54:28 INFO hadoop.InternalParquetRecordWriter: mem size 125984672 > 125829120: flushing 1570100 records to disk.\r\n21/09/15 08:54:28 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 87981933\r\n21/09/15 08:55:47 INFO hadoop.InternalParquetRecordWriter: mem size 126144533 > 125829120: flushing 1820100 records to disk.\r\n21/09/15 08:55:47 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 88299835\r\n21/09/15 08:57:05 INFO hadoop.InternalParquetRecordWriter: mem size 127071756 > 125829120: flushing 1830100 records to disk.\r\n21/09/15 08:57:05 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 89667896\r\n21/09/15 08:58:24 INFO hadoop.InternalParquetRecordWriter: mem size 127160360 > 125829120: flushing 1830100 records to disk.\r\n21/09/15 08:58:24 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 89757682\r\n21/09/15 08:58:26 INFO queue.IteratorBasedQueueProducer: finished buffering records\r\n21/09/15 08:58:27 INFO io.HoodieCreateHandle: Closing the file eb3c98ba-1df9-41c6-bd7c-a4708f4728db-1 as we are done with all the records 11244525\r\n21/09/15 08:58:27 INFO hadoop.InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 14709580\r\n21/09/15 08:58:30 INFO io.HoodieCreateHandle: CreateHandle for partitionPath 2021080920 fileID eb3c98ba-1df9-41c6-bd7c-a4708f4728db-1, took 492192 ms.\r\n21/09/15 08:58:30 INFO queue.BoundedInMemoryExecutor: Queue Consumption is done; notifying producer threads\r\n21/09/15 08:58:30 INFO memory.MemoryStore: Block rdd_225_3 stored as values in memory (estimated size 771.0 B, free 30.9 GB)\r\n21/09/15 08:58:30 INFO executor.Executor: Finished task 3.0 in stage 82.0 (TID 2226). 1182 bytes result sent to driver\r\n21/09/15 08:58:30 INFO executor.CoarseGrainedExecutorBackend: Driver commanded a shutdown\r\n21/09/15 08:58:30 INFO executor.CoarseGrainedExecutorBackend: Driver from ip-10-23-24-94.ec2.internal:45530 disconnected during shutdown\r\n21/09/15 08:58:30 INFO executor.CoarseGrainedExecutorBackend: Driver from ip-10-23-24-94.ec2.internal:45530 disconnected during shutdown\r\n21/09/15 08:58:31 INFO memory.MemoryStore: MemoryStore cleared\r\n21/09/15 08:58:31 INFO storage.BlockManager: BlockManager stopped\r\n21/09/15 08:58:31 INFO util.ShutdownHookManager: Shutdown hook called\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919852009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919853585","html_url":"https://github.com/apache/hudi/pull/3666#issuecomment-919853585","issue_url":"https://api.github.com/repos/apache/hudi/issues/3666","id":919853585,"node_id":"IC_kwDOBI7nWM4209oR","user":{"login":"zhangyue19921010","id":69956021,"node_id":"MDQ6VXNlcjY5OTU2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/69956021?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyue19921010","html_url":"https://github.com/zhangyue19921010","followers_url":"https://api.github.com/users/zhangyue19921010/followers","following_url":"https://api.github.com/users/zhangyue19921010/following{/other_user}","gists_url":"https://api.github.com/users/zhangyue19921010/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyue19921010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyue19921010/subscriptions","organizations_url":"https://api.github.com/users/zhangyue19921010/orgs","repos_url":"https://api.github.com/users/zhangyue19921010/repos","events_url":"https://api.github.com/users/zhangyue19921010/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyue19921010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T09:26:15Z","updated_at":"2021-09-15T09:27:20Z","author_association":"CONTRIBUTOR","body":"As we can see, marker is performed and clustering committed at `21/09/15 08:26:14`\r\nBut `New CreateHandle for partition :2021080920 with fileId eb3c98ba-1df9-41c6-bd7c-a4708f4728db-0` \r\nand `New CreateHandle for partition :2021080920 with fileId eb3c98ba-1df9-41c6-bd7c-a4708f4728db-1` is created by handleErrors' collect action at `21/09/15 08:28:39`","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919853585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919858335","html_url":"https://github.com/apache/hudi/pull/3330#issuecomment-919858335","issue_url":"https://api.github.com/repos/apache/hudi/issues/3330","id":919858335,"node_id":"IC_kwDOBI7nWM420-yf","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T09:32:41Z","updated_at":"2021-09-15T09:32:41Z","author_association":"CONTRIBUTOR","body":"@vinothchandar   sorry for later, i will deal with these views as soon as possible","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919858335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919861244","html_url":"https://github.com/apache/hudi/pull/3668#issuecomment-919861244","issue_url":"https://api.github.com/repos/apache/hudi/issues/3668","id":919861244,"node_id":"IC_kwDOBI7nWM420_f8","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T09:36:44Z","updated_at":"2021-09-15T09:36:44Z","author_association":"CONTRIBUTOR","body":"kindly ping @bvaradar @leesf  could you help me review those code . thanks ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919861244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919862538","html_url":"https://github.com/apache/hudi/pull/3652#issuecomment-919862538","issue_url":"https://api.github.com/repos/apache/hudi/issues/3652","id":919862538,"node_id":"IC_kwDOBI7nWM420_0K","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T09:38:31Z","updated_at":"2021-09-15T09:38:31Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919862538/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919914225","html_url":"https://github.com/apache/hudi/pull/3652#issuecomment-919914225","issue_url":"https://api.github.com/repos/apache/hudi/issues/3652","id":919914225,"node_id":"IC_kwDOBI7nWM421Mbx","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T10:54:52Z","updated_at":"2021-09-15T10:54:52Z","author_association":"CONTRIBUTOR","body":"Will review it later","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919914225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919918921","html_url":"https://github.com/apache/hudi/pull/3668#issuecomment-919918921","issue_url":"https://api.github.com/repos/apache/hudi/issues/3668","id":919918921,"node_id":"IC_kwDOBI7nWM421NlJ","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T11:02:11Z","updated_at":"2021-09-15T11:02:11Z","author_association":"CONTRIBUTOR","body":"This PR is about RFC-33? Have we reached an agreement on the design?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919918921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919927899","html_url":"https://github.com/apache/hudi/pull/3659#issuecomment-919927899","issue_url":"https://api.github.com/repos/apache/hudi/issues/3659","id":919927899,"node_id":"IC_kwDOBI7nWM421Pxb","user":{"login":"geertjanw","id":5309985,"node_id":"MDQ6VXNlcjUzMDk5ODU=","avatar_url":"https://avatars.githubusercontent.com/u/5309985?v=4","gravatar_id":"","url":"https://api.github.com/users/geertjanw","html_url":"https://github.com/geertjanw","followers_url":"https://api.github.com/users/geertjanw/followers","following_url":"https://api.github.com/users/geertjanw/following{/other_user}","gists_url":"https://api.github.com/users/geertjanw/gists{/gist_id}","starred_url":"https://api.github.com/users/geertjanw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/geertjanw/subscriptions","organizations_url":"https://api.github.com/users/geertjanw/orgs","repos_url":"https://api.github.com/users/geertjanw/repos","events_url":"https://api.github.com/users/geertjanw/events{/privacy}","received_events_url":"https://api.github.com/users/geertjanw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T11:15:50Z","updated_at":"2021-09-15T11:15:50Z","author_association":"MEMBER","body":"Ah, I see. Apologies for not doing it correctly.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919927899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919955374","html_url":"https://github.com/apache/hudi/pull/3668#issuecomment-919955374","issue_url":"https://api.github.com/repos/apache/hudi/issues/3668","id":919955374,"node_id":"IC_kwDOBI7nWM421Weu","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T12:00:05Z","updated_at":"2021-09-15T12:00:05Z","author_association":"CONTRIBUTOR","body":"@yanghua  yes, We reached a preliminary consensus. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919955374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919961961","html_url":"https://github.com/apache/hudi/pull/3664#issuecomment-919961961","issue_url":"https://api.github.com/repos/apache/hudi/issues/3664","id":919961961,"node_id":"IC_kwDOBI7nWM421YFp","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T12:09:12Z","updated_at":"2021-09-15T12:09:12Z","author_association":"CONTRIBUTOR","body":"@yihua Can you make the CI successful?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919961961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919980674","html_url":"https://github.com/apache/hudi/pull/3668#issuecomment-919980674","issue_url":"https://api.github.com/repos/apache/hudi/issues/3668","id":919980674,"node_id":"IC_kwDOBI7nWM421cqC","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T12:37:18Z","updated_at":"2021-09-15T12:37:18Z","author_association":"MEMBER","body":"cc @codope @bvaradar lets use this as a basis and evolve our design, move forward. \r\n\r\n@yanghua we are close I think. Few open items, that can be resolved soon hopefully. \r\nYou can follow along the discussion in the comments here\r\nhttps://cwiki.apache.org/confluence/display/HUDI/RFC+-+33++Hudi+supports+more+comprehensive+Schema+Evolution \r\n\r\n@codope also has a bunch of these working on presto and trino already. Flink would be a good thing to tackle as well. Does Flink use the Hive record readers? cc @danny0405 as well.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/919980674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920019202","html_url":"https://github.com/apache/hudi/issues/1751#issuecomment-920019202","issue_url":"https://api.github.com/repos/apache/hudi/issues/1751","id":920019202,"node_id":"IC_kwDOBI7nWM421mEC","user":{"login":"parisni","id":9535350,"node_id":"MDQ6VXNlcjk1MzUzNTA=","avatar_url":"https://avatars.githubusercontent.com/u/9535350?v=4","gravatar_id":"","url":"https://api.github.com/users/parisni","html_url":"https://github.com/parisni","followers_url":"https://api.github.com/users/parisni/followers","following_url":"https://api.github.com/users/parisni/following{/other_user}","gists_url":"https://api.github.com/users/parisni/gists{/gist_id}","starred_url":"https://api.github.com/users/parisni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/parisni/subscriptions","organizations_url":"https://api.github.com/users/parisni/orgs","repos_url":"https://api.github.com/users/parisni/repos","events_url":"https://api.github.com/users/parisni/events{/privacy}","received_events_url":"https://api.github.com/users/parisni/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T13:28:39Z","updated_at":"2021-09-15T13:28:39Z","author_association":"CONTRIBUTOR","body":"@dude0001 \r\n```\r\n.option(\"hoodie.datasource.hive_sync.use_jdbc\", \"false\")\r\n.option(\"hoodie.datasource.hive_sync.mode\": \"hms\"),\r\n```\r\ndid the trick for me","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920019202/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920035893","html_url":"https://github.com/apache/hudi/pull/3664#issuecomment-920035893","issue_url":"https://api.github.com/repos/apache/hudi/issues/3664","id":920035893,"node_id":"IC_kwDOBI7nWM421qI1","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T13:49:12Z","updated_at":"2021-09-15T13:49:12Z","author_association":"MEMBER","body":"cc @nsivabalan healthy competition on who's going to be rebasing :) . \r\n\r\ncan you review this please? since you are actively working on this. My take would be land this and redo yours on top, that way, we get a \"deeper\" review as you rethink/rework as well. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920035893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920110356","html_url":"https://github.com/apache/hudi/issues/3603#issuecomment-920110356","issue_url":"https://api.github.com/repos/apache/hudi/issues/3603","id":920110356,"node_id":"IC_kwDOBI7nWM4218UU","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T15:12:37Z","updated_at":"2021-09-15T15:12:37Z","author_association":"MEMBER","body":"@fengjian428 I could not reproduce the issue. I have the same setup i.e. deltastreamer continuous job consuming from Kafka. Though my schema in extraMetadata is simple one. There is a similar issue #3559  with 0.8.0. Based on this [SO answer](https://stackoverflow.com/questions/26720257/nullpointerexception-in-avro-reflectdatumwriter), I think we need to use ReflectDatumWriter to allow nulls. Could you please try [this patch](https://github.com/codope/hudi/commit/750a3315badeb362d3b57cfc016e3661f4e25564) in your environment? If it works, then I'll upstream the change.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920110356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920313306","html_url":"https://github.com/apache/hudi/pull/3664#issuecomment-920313306","issue_url":"https://api.github.com/repos/apache/hudi/issues/3664","id":920313306,"node_id":"IC_kwDOBI7nWM422t3a","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T19:24:29Z","updated_at":"2021-09-15T19:24:29Z","author_association":"CONTRIBUTOR","body":"> @yihua Can you make the CI successful?\r\n\r\nLooks like there are two flaky tests around rollback.  Another Azure CI run is triggered.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920313306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920313961","html_url":"https://github.com/apache/hudi/issues/3581#issuecomment-920313961","issue_url":"https://api.github.com/repos/apache/hudi/issues/3581","id":920313961,"node_id":"IC_kwDOBI7nWM422uBp","user":{"login":"codejoyan","id":48707638,"node_id":"MDQ6VXNlcjQ4NzA3NjM4","avatar_url":"https://avatars.githubusercontent.com/u/48707638?v=4","gravatar_id":"","url":"https://api.github.com/users/codejoyan","html_url":"https://github.com/codejoyan","followers_url":"https://api.github.com/users/codejoyan/followers","following_url":"https://api.github.com/users/codejoyan/following{/other_user}","gists_url":"https://api.github.com/users/codejoyan/gists{/gist_id}","starred_url":"https://api.github.com/users/codejoyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codejoyan/subscriptions","organizations_url":"https://api.github.com/users/codejoyan/orgs","repos_url":"https://api.github.com/users/codejoyan/repos","events_url":"https://api.github.com/users/codejoyan/events{/privacy}","received_events_url":"https://api.github.com/users/codejoyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T19:25:38Z","updated_at":"2021-09-15T19:26:47Z","author_association":"CONTRIBUTOR","body":"Hi @xushiyan / @vinothchandar\r\n\r\nTo this question: Not sure if \"Listing leaf files ...\" shows up with file listings enabled\" -> Even I thought so. But I could see that the metadata table is created while writing. Doesn't that mean it should read from the metadata table instead of doing a file listing:\r\n\r\n       295  2021-09-15T17:50:46Z  gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1/.hoodie/hoodie.properties\r\n                                 gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1/.hoodie/.temp/\r\n                                 gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1/.hoodie/archived/\r\n                                 gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1/.hoodie/metadata/\r\n\r\nAlso in the log I see the time taken to load is as below. I have daily partitions and table has 3 months data, so for 90 partitions it is taking > 2 minutes to list. Below is the log snippet. I also see the below warning message:\r\n21/09/15 18:52:22 WARN org.apache.spark.sql.execution.datasources.SharedInMemoryCache: Evicting cached table partition metadata from memory due to size constraints (spark.sql.hive.filesourcePartitionFileCacheSize = 262144000 bytes). This may impact query planning performance.\r\n\r\n**Log Snippet**\r\n21/09/15 18:51:00 INFO org.apache.hudi.common.table.HoodieTableMetaClient: Finished Loading Table of type COPY_ON_WRITE(version=1, baseFileFormat=PARQUET) from gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1\r\n21/09/15 18:51:00 INFO org.apache.hudi.DefaultSource: Is bootstrapped table => false\r\n21/09/15 18:51:00 WARN org.apache.hudi.DefaultSource: Loading Base File Only View.\r\n21/09/15 18:51:00 INFO org.apache.hudi.DefaultSource: Constructing hoodie (as parquet) data source with options :Map(hoodie.file.index.enable -> true, hoodie.datasource.query.type -> snapshot, path -> gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1)\r\n21/09/15 18:51:08 INFO org.apache.hudi.common.table.HoodieTableMetaClient: Loading HoodieTableMetaClient from gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1\r\n21/09/15 18:51:08 INFO org.apache.hudi.common.fs.FSUtils: Hadoop Configuration: fs.defaultFS: [hdfs://wl1-hudi-delta-poc-m], Config:[Configuration: core-default.xml, core-site.xml, yarn-default.xml, yarn-site.xml, resource-types.xml, mapred-default.xml, mapred-site.xml, hdfs-default.xml, hdfs-site.xml, __spark_hadoop_conf__.xml], FileSystem: [com.google.cloud.hadoop.fs.gcs.GoogleHadoopFileSystem@3dbf8b79]\r\n21/09/15 18:51:08 INFO org.apache.hudi.common.table.HoodieTableConfig: Loading table properties from gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1/.hoodie/hoodie.properties\r\n21/09/15 18:51:08 INFO org.apache.hudi.common.table.HoodieTableMetaClient: Finished Loading Table of type COPY_ON_WRITE(version=1, baseFileFormat=PARQUET) from gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1\r\n21/09/15 18:51:08 INFO org.apache.hudi.common.table.HoodieTableMetaClient: Loading Active commit timeline for gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1\r\n21/09/15 18:51:08 INFO org.apache.hudi.common.table.timeline.HoodieActiveTimeline: Loaded instants [[20210912173234__clean__COMPLETED], [20210912173527__clean__COMPLETED], [20210912173901__clean__COMPLETED], [20210912174152__clean__COMPLETED], [20210912174502__clean__COMPLETED], [20210912174759__clean__COMPLETED], [20210912174924__clean__COMPLETED], [20210912175218__clean__COMPLETED], [20210912175537__clean__COMPLETED], [20210912175855__clean__COMPLETED], [20210912180207__clean__COMPLETED], [20210912180333__clean__COMPLETED], [20210912180725__clean__COMPLETED], [20210912180924__clean__COMPLETED], [20210915123142__clean__COMPLETED], [20210915123711__clean__COMPLETED], [20210915124117__clean__COMPLETED], [20210915124530__clean__COMPLETED], [20210915125255__clean__COMPLETED], [20210915130150__clean__COMPLETED], [20210915144750__commit__COMPLETED], [20210915145319__commit__COMPLETED], [20210915145759__commit__COMPLETED], [20210915150055__commit__COMPLETED], [20210915150548__commit__COMPLETED], [20210915151050__commit__COMPLETED], [20210915151538__commit__COMPLETED], [20210915152045__commit__COMPLETED], [20210915152606__commit__COMPLETED], [20210915153100__commit__COMPLETED], [20210915153610__commit__COMPLETED], [20210915154035__commit__COMPLETED], [20210915154500__commit__COMPLETED], [20210915155004__commit__COMPLETED], [20210915155512__commit__COMPLETED], [20210915160015__commit__COMPLETED], [20210915160528__commit__COMPLETED], [20210915161020__commit__COMPLETED], [20210915161534__commit__COMPLETED], [20210915161949__commit__COMPLETED], [20210915162501__commit__COMPLETED], [20210915162953__commit__COMPLETED], [20210915163456__commit__COMPLETED], [20210915164016__commit__COMPLETED], [20210915164523__commit__COMPLETED], [20210915165033__commit__COMPLETED], [20210915165545__commit__COMPLETED], [20210915170102__commit__COMPLETED], [20210915182112__commit__COMPLETED], [20210915182251__replacecommit__COMPLETED]]\r\n21/09/15 18:51:08 INFO org.apache.hudi.common.table.view.FileSystemViewManager: Creating InMemory based view for basePath gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1\r\n21/09/15 18:51:08 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: Took 156 ms to read  1 instants, 3000 replaced file groups\r\n21/09/15 18:51:08 INFO org.apache.hudi.common.util.ClusteringUtils: Found 0 files in pending clustering operations\r\n21/09/15 18:51:08 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: Building file system view for partition (WMT-US/2020-11-01)\r\n21/09/15 18:51:08 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: #files found in partition (WMT-US/2020-11-01) =1501, Time taken =204\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.table.view.HoodieTableFileSystemView: Adding file-groups for partition :WMT-US/2020-11-01, #FileGroups=1500\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: addFilesToView: NumFiles=1501, NumFileGroups=1500, FileGroupsCreationTime=91, StoreTimeTaken=3\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: Time to load partition (WMT-US/2020-11-01) =340\r\n21/09/15 18:51:09 INFO org.apache.hudi.hadoop.HoodieROTablePathFilter: Based on hoodie metadata from base path: gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1, caching 1500 files under gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1/WMT-US/2020-11-01\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: Took 117 ms to read  1 instants, 3000 replaced file groups\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.util.ClusteringUtils: Found 0 files in pending clustering operations\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.table.view.FileSystemViewManager: Creating InMemory based view for basePath gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: Took 91 ms to read  1 instants, 3000 replaced file groups\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.util.ClusteringUtils: Found 0 files in pending clustering operations\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: Building file system view for partition (WMT-US/2020-11-02)\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: #files found in partition (WMT-US/2020-11-02) =1501, Time taken =177\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.table.view.HoodieTableFileSystemView: Adding file-groups for partition :WMT-US/2020-11-02, #FileGroups=1500\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: addFilesToView: NumFiles=1501, NumFileGroups=1500, FileGroupsCreationTime=63, StoreTimeTaken=1\r\n21/09/15 18:51:09 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: Time to load partition (WMT-US/2020-11-02) =280\r\n21/09/15 18:51:09 INFO org.apache.hudi.hadoop.HoodieROTablePathFilter: Based on hoodie metadata from base path: gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1, caching 1500 files under gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v1/WMT-US/2020-11-02\r\n21/09/15 18:51:10 INFO org.apache.hudi.common.table.view.AbstractTableFileSystemView: Took 93 ms to read  1 instants, 3000 replaced file groups\r\n....\r\n21/09/15 18:52:22 WARN org.apache.spark.sql.execution.datasources.SharedInMemoryCache: Evicting cached table partition metadata from memory due to size constraints (spark.sql.hive.filesourcePartitionFileCacheSize = 262144000 bytes). This may impact query planning performance.\r\n\r\nLooking forward to some pointers. Let me know if I can do some analysis on my end that would help?\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920313961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920330492","html_url":"https://github.com/apache/hudi/pull/3664#issuecomment-920330492","issue_url":"https://api.github.com/repos/apache/hudi/issues/3664","id":920330492,"node_id":"IC_kwDOBI7nWM422yD8","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T19:53:28Z","updated_at":"2021-09-15T19:53:28Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920330492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920337157","html_url":"https://github.com/apache/hudi/pull/3482#issuecomment-920337157","issue_url":"https://api.github.com/repos/apache/hudi/issues/3482","id":920337157,"node_id":"IC_kwDOBI7nWM422zsF","user":{"login":"rmahindra123","id":76502047,"node_id":"MDQ6VXNlcjc2NTAyMDQ3","avatar_url":"https://avatars.githubusercontent.com/u/76502047?v=4","gravatar_id":"","url":"https://api.github.com/users/rmahindra123","html_url":"https://github.com/rmahindra123","followers_url":"https://api.github.com/users/rmahindra123/followers","following_url":"https://api.github.com/users/rmahindra123/following{/other_user}","gists_url":"https://api.github.com/users/rmahindra123/gists{/gist_id}","starred_url":"https://api.github.com/users/rmahindra123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmahindra123/subscriptions","organizations_url":"https://api.github.com/users/rmahindra123/orgs","repos_url":"https://api.github.com/users/rmahindra123/repos","events_url":"https://api.github.com/users/rmahindra123/events{/privacy}","received_events_url":"https://api.github.com/users/rmahindra123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T20:03:39Z","updated_at":"2021-09-15T20:03:39Z","author_association":"CONTRIBUTOR","body":"@nsivabalan Can you finish reviewing this diff? Lets plan on landing it soon.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920337157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920352971","html_url":"https://github.com/apache/hudi/pull/3664#issuecomment-920352971","issue_url":"https://api.github.com/repos/apache/hudi/issues/3664","id":920352971,"node_id":"IC_kwDOBI7nWM4223jL","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T20:27:57Z","updated_at":"2021-09-15T20:27:57Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920352971/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920393451","html_url":"https://github.com/apache/hudi/pull/3664#issuecomment-920393451","issue_url":"https://api.github.com/repos/apache/hudi/issues/3664","id":920393451,"node_id":"IC_kwDOBI7nWM423Bbr","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T21:24:20Z","updated_at":"2021-09-15T21:24:20Z","author_association":"CONTRIBUTOR","body":"@hudi-bot azure run","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920393451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920408212","html_url":"https://github.com/apache/hudi/issues/3161#issuecomment-920408212","issue_url":"https://api.github.com/repos/apache/hudi/issues/3161","id":920408212,"node_id":"IC_kwDOBI7nWM423FCU","user":{"login":"cb149","id":35238779,"node_id":"MDQ6VXNlcjM1MjM4Nzc5","avatar_url":"https://avatars.githubusercontent.com/u/35238779?v=4","gravatar_id":"","url":"https://api.github.com/users/cb149","html_url":"https://github.com/cb149","followers_url":"https://api.github.com/users/cb149/followers","following_url":"https://api.github.com/users/cb149/following{/other_user}","gists_url":"https://api.github.com/users/cb149/gists{/gist_id}","starred_url":"https://api.github.com/users/cb149/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cb149/subscriptions","organizations_url":"https://api.github.com/users/cb149/orgs","repos_url":"https://api.github.com/users/cb149/repos","events_url":"https://api.github.com/users/cb149/events{/privacy}","received_events_url":"https://api.github.com/users/cb149/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T21:52:10Z","updated_at":"2021-09-15T21:53:40Z","author_association":"NONE","body":"@codope `startingOffsets` is set to `earliest`.\r\n\r\nI changed my application from scheduled every hour to every two hours to allow for more new messages in the topic and I haven't really seen the issue more than a couple of times since then.\r\n\r\nI added a failsafe comparing `numInputRows` and `endOffset - startOffset`, but in the last month or so the only time I was alerted of a missmatch between those was when there were 0 new messages for the input topic and one of the offsets was increased by 1 for some reason.\r\n\r\nI somehow get the feeling that the issue is unrelated to Hudi and probably has its cause somewhere with Kafka or Spark, maybe somehow with the relatively unbalanced Kafka partitions. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920408212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920439964","html_url":"https://github.com/apache/hudi/pull/3010#issuecomment-920439964","issue_url":"https://api.github.com/repos/apache/hudi/issues/3010","id":920439964,"node_id":"IC_kwDOBI7nWM423Myc","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T22:44:57Z","updated_at":"2021-09-15T22:44:57Z","author_association":"CONTRIBUTOR","body":"@pratyakshsharma : Can you follow up on this PR please. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920439964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920447490","html_url":"https://github.com/apache/hudi/pull/3576#issuecomment-920447490","issue_url":"https://api.github.com/repos/apache/hudi/issues/3576","id":920447490,"node_id":"IC_kwDOBI7nWM423OoC","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-15T22:59:09Z","updated_at":"2021-09-15T22:59:09Z","author_association":"CONTRIBUTOR","body":"@minihippo : Can you rebase and let me know once CI succeeds. I can land it once ready. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920447490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920487082","html_url":"https://github.com/apache/hudi/issues/3657#issuecomment-920487082","issue_url":"https://api.github.com/repos/apache/hudi/issues/3657","id":920487082,"node_id":"IC_kwDOBI7nWM423YSq","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T00:40:05Z","updated_at":"2021-09-16T00:40:05Z","author_association":"CONTRIBUTOR","body":"> > you may need to past the \"caused by\" part of the error stack trace.\r\n> > yes, I see the the \"caused by\" part of the error stack trace:\r\n> \r\n> Caused by: org.apache.flink.util.FlinkRuntimeException: Failed to start the operator coordinators\r\n> at org.apache.flink.runtime.scheduler.SchedulerBase.startAllOperatorCoordinators(SchedulerBase.java:1258) ~[flink-dist_2.11-1.12.2.jar:1.12.2]\r\n> at org.apache.flink.runtime.scheduler.SchedulerBase.startScheduling(SchedulerBase.java:624) ~[flink-dist_2.11-1.12.2.jar:1.12.2]\r\n> at org.apache.flink.runtime.jobmaster.JobMaster.startScheduling(JobMaster.java:1032) ~[flink-dist_2.11-1.12.2.jar:1.12.2]\r\n> at java.util.concurrent.CompletableFuture.uniRun(CompletableFuture.java:705) ~[?:1.8.0_144]\r\n> ... 27 more\r\n> Caused by: org.apache.hudi.exception.HoodieException: Unable to load class\r\n> at org.apache.hudi.common.util.ReflectionUtils.getClass(ReflectionUtils.java:58) ~[?:?]\r\n> at org.apache.hudi.common.config.HoodieConfig.setDefaults(HoodieConfig.java:100) ~[?:?]\r\n> at org.apache.hudi.config.HoodieCompactionConfig.access$100(HoodieCompactionConfig.java:51) ~[?:?]\r\n> at org.apache.hudi.config.HoodieCompactionConfig$Builder.build(HoodieCompactionConfig.java:607) ~[?:?]\r\n> at org.apache.hudi.util.StreamerUtil.getHoodieClientConfig(StreamerUtil.java:173) ~[?:?]\r\n> at org.apache.hudi.util.StreamerUtil.createWriteClient(StreamerUtil.java:317) ~[?:?]\r\n> at org.apache.hudi.sink.StreamWriteOperatorCoordinator.start(StreamWriteOperatorCoordinator.java:153) ~[?:?]\r\n> at org.apache.flink.runtime.operators.coordination.OperatorCoordinatorHolder.start(OperatorCoordinatorHolder.java:189) ~[flink-dist_2.11-1.12.2.jar:1.12.2]\r\n> at org.apache.flink.runtime.scheduler.SchedulerBase.startAllOperatorCoordinators(SchedulerBase.java:1253) ~[flink-dist_2.11-1.12.2.jar:1.12.2]\r\n> at org.apache.flink.runtime.scheduler.SchedulerBase.startScheduling(SchedulerBase.java:624) ~[flink-dist_2.11-1.12.2.jar:1.12.2]\r\n> at org.apache.flink.runtime.jobmaster.JobMaster.startScheduling(JobMaster.java:1032) ~[flink-dist_2.11-1.12.2.jar:1.12.2]\r\n> at java.util.concurrent.CompletableFuture.uniRun(CompletableFuture.java:705) ~[?:1.8.0_144]\r\n> ... 27 more\r\n> Caused by: java.lang.ClassNotFoundException: org.apache.hudi.config.HoodieCompactionConfig\r\n> at java.net.URLClassLoader.findClass(URLClassLoader.java:381) ~[?:1.8.0_144]\r\n> at java.lang.ClassLoader.loadClass(ClassLoader.java:424) ~[?:1.8.0_144]\r\n> at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:335) ~[?:1.8.0_144]\r\n> at java.lang.ClassLoader.loadClass(ClassLoader.java:357) ~[?:1.8.0_144]\r\n> at java.lang.Class.forName0(Native Method) ~[?:1.8.0_144]\r\n> at java.lang.Class.forName(Class.java:348) ~[?:1.8.0_144]\r\n> at org.apache.hudi.common.util.ReflectionUtils.getClass(ReflectionUtils.java:54) ~[?:?]\r\n> at org.apache.hudi.common.config.HoodieConfig.setDefaults(HoodieConfig.java:100) ~[?:?]\r\n> at org.apache.hudi.config.HoodieCompactionConfig.access$100(HoodieCompactionConfig.java:51) ~[?:?]\r\n> at org.apache.hudi.config.HoodieCompactionConfig$Builder.build(HoodieCompactionConfig.java:607) ~[?:?]\r\n> at org.apache.hudi.util.StreamerUtil.getHoodieClientConfig(StreamerUtil.java:173) ~[?:?]\r\n> at org.apache.hudi.util.StreamerUtil.createWriteClient(StreamerUtil.java:317) ~[?:?]\r\n> at org.apache.hudi.sink.StreamWriteOperatorCoordinator.start(StreamWriteOperatorCoordinator.java:153) ~[?:?]\r\n> at org.apache.flink.runtime.operators.coordination.OperatorCoordinatorHolder.start(OperatorCoordinatorHolder.java:189) ~[flink-dist_2.11-1.12.2.jar:1.12.2]\r\n> at org.apache.flink.runtime.scheduler.SchedulerBase.startAllOperatorCoordinators(SchedulerBase.java:1253) ~[flink-dist_2.11-1.12.2.jar:1.12.2]\r\n> at org.apache.flink.runtime.scheduler.SchedulerBase.startScheduling(SchedulerBase.java:624) ~[flink-dist_2.11-1.12.2.jar:1.12.2]\r\n> at org.apache.flink.runtime.jobmaster.JobMaster.startScheduling(JobMaster.java:1032) ~[flink-dist_2.11-1.12.2.jar:1.12.2]\r\n> at java.util.concurrent.CompletableFuture.uniRun(CompletableFuture.java:705) ~[?:1.8.0_144]\r\n> ... 27 more\r\n\r\nThis is the problem of the classloader, which is fixed in branch: https://github.com/apache/hudi/pull/3519 and master","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920487082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920487323","html_url":"https://github.com/apache/hudi/issues/3657#issuecomment-920487323","issue_url":"https://api.github.com/repos/apache/hudi/issues/3657","id":920487323,"node_id":"IC_kwDOBI7nWM423YWb","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T00:40:45Z","updated_at":"2021-09-16T00:40:45Z","author_association":"CONTRIBUTOR","body":"> and if I use flink 1.13.1 and hudi master, there are another ERROR:\r\n> org.apache.flink.runtime.JobException: Recovery is suppressed by NoRestartBackoffTimeStrategy\r\n> at org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.handleFailure(ExecutionFailureHandler.java:138)\r\n> at org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.getFailureHandlingResult(ExecutionFailureHandler.java:82)\r\n> at org.apache.flink.runtime.scheduler.DefaultScheduler.handleTaskFailure(DefaultScheduler.java:207)\r\n> at org.apache.flink.runtime.scheduler.DefaultScheduler.maybeHandleTaskFailure(DefaultScheduler.java:197)\r\n> at org.apache.flink.runtime.scheduler.DefaultScheduler.updateTaskExecutionStateInternal(DefaultScheduler.java:188)\r\n> at org.apache.flink.runtime.scheduler.SchedulerBase.updateTaskExecutionState(SchedulerBase.java:677)\r\n> at org.apache.flink.runtime.scheduler.SchedulerNG.updateTaskExecutionState(SchedulerNG.java:79)\r\n> at org.apache.flink.runtime.jobmaster.JobMaster.updateTaskExecutionState(JobMaster.java:435)\r\n> at sun.reflect.GeneratedMethodAccessor23.invoke(Unknown Source)\r\n> at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n> at java.lang.reflect.Method.invoke(Method.java:498)\r\n> at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcInvocation(AkkaRpcActor.java:305)\r\n> at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:212)\r\n> at org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:77)\r\n> at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:158)\r\n> at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26)\r\n> at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21)\r\n> at scala.PartialFunction$class.applyOrElse(PartialFunction.scala:123)\r\n> at akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21)\r\n> at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:170)\r\n> at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)\r\n> at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)\r\n> at akka.actor.Actor$class.aroundReceive(Actor.scala:517)\r\n> at akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225)\r\n> at akka.actor.ActorCell.receiveMessage(ActorCell.scala:592)\r\n> at akka.actor.ActorCell.invoke(ActorCell.scala:561)\r\n> at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258)\r\n> at akka.dispatch.Mailbox.run(Mailbox.scala:225)\r\n> at akka.dispatch.Mailbox.exec(Mailbox.scala:235)\r\n> at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)\r\n> at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)\r\n> at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)\r\n> at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)\r\n> Caused by: java.lang.IllegalArgumentException: hoodie.properties file seems invalid. Please check for left over `.updated` files if any, manually copy it to hoodie.properties and retry\r\n> at org.apache.hudi.common.util.ValidationUtils.checkArgument(ValidationUtils.java:40)\r\n> at org.apache.hudi.common.table.HoodieTableConfig.(HoodieTableConfig.java:184)\r\n> at org.apache.hudi.common.table.HoodieTableMetaClient.(HoodieTableMetaClient.java:114)\r\n> at org.apache.hudi.common.table.HoodieTableMetaClient.(HoodieTableMetaClient.java:74)\r\n> at org.apache.hudi.common.table.HoodieTableMetaClient$Builder.build(HoodieTableMetaClient.java:607)\r\n> at org.apache.hudi.table.HoodieFlinkTable.create(HoodieFlinkTable.java:48)\r\n> at org.apache.hudi.sink.partitioner.profile.WriteProfile.(WriteProfile.java:118)\r\n> at org.apache.hudi.sink.partitioner.profile.DeltaWriteProfile.(DeltaWriteProfile.java:43)\r\n> at org.apache.hudi.sink.partitioner.profile.WriteProfiles.getWriteProfile(WriteProfiles.java:75)\r\n> at org.apache.hudi.sink.partitioner.profile.WriteProfiles.lambda$singleton$0(WriteProfiles.java:64)\r\n> at java.util.HashMap.computeIfAbsent(HashMap.java:1127)\r\n> at org.apache.hudi.sink.partitioner.profile.WriteProfiles.singleton(WriteProfiles.java:63)\r\n> at org.apache.hudi.sink.partitioner.BucketAssigners.create(BucketAssigners.java:56)\r\n> at org.apache.hudi.sink.partitioner.BucketAssignFunction.open(BucketAssignFunction.java:123)\r\n> at org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:34)\r\n> at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.open(AbstractUdfStreamOperator.java:102)\r\n> at org.apache.flink.streaming.api.operators.KeyedProcessOperator.open(KeyedProcessOperator.java:55)\r\n> at org.apache.hudi.sink.partitioner.BucketAssignOperator.open(BucketAssignOperator.java:41)\r\n> at org.apache.flink.streaming.runtime.tasks.OperatorChain.initializeStateAndOpenOperators(OperatorChain.java:437)\r\n> at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreGates(StreamTask.java:582)\r\n> at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55)\r\n> at org.apache.flink.streaming.runtime.tasks.StreamTask.executeRestore(StreamTask.java:562)\r\n> at org.apache.flink.streaming.runtime.tasks.StreamTask.runWithCleanUpOnFail(StreamTask.java:647)\r\n> at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:537)\r\n> at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:759)\r\n> at org.apache.flink.runtime.taskmanager.Task.run(Task.java:566)\r\n> at java.lang.Thread.run(Thread.java:748)\r\n> Suppressed: java.lang.NullPointerException\r\n> at org.apache.hudi.sink.partitioner.BucketAssignFunction.close(BucketAssignFunction.java:244)\r\n> at org.apache.flink.api.common.functions.util.FunctionUtils.closeFunction(FunctionUtils.java:41)\r\n> at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.dispose(AbstractUdfStreamOperator.java:117)\r\n> at org.apache.flink.streaming.runtime.tasks.StreamTask.disposeAllOperators(StreamTask.java:861)\r\n> at org.apache.flink.streaming.runtime.tasks.StreamTask.runAndSuppressThrowable(StreamTask.java:840)\r\n> at org.apache.flink.streaming.runtime.tasks.StreamTask.cleanUpInvoke(StreamTask.java:753)\r\n> at org.apache.flink.streaming.runtime.tasks.StreamTask.runWithCleanUpOnFail(StreamTask.java:659)\r\n> ... 4 more\r\n\r\nLooks like you declare a wrong table type, try to clean the .hoodie directory and try again.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920487323/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920561496","html_url":"https://github.com/apache/hudi/issues/3605#issuecomment-920561496","issue_url":"https://api.github.com/repos/apache/hudi/issues/3605","id":920561496,"node_id":"IC_kwDOBI7nWM423qdY","user":{"login":"Ambarish-Giri","id":85560823,"node_id":"MDQ6VXNlcjg1NTYwODIz","avatar_url":"https://avatars.githubusercontent.com/u/85560823?v=4","gravatar_id":"","url":"https://api.github.com/users/Ambarish-Giri","html_url":"https://github.com/Ambarish-Giri","followers_url":"https://api.github.com/users/Ambarish-Giri/followers","following_url":"https://api.github.com/users/Ambarish-Giri/following{/other_user}","gists_url":"https://api.github.com/users/Ambarish-Giri/gists{/gist_id}","starred_url":"https://api.github.com/users/Ambarish-Giri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ambarish-Giri/subscriptions","organizations_url":"https://api.github.com/users/Ambarish-Giri/orgs","repos_url":"https://api.github.com/users/Ambarish-Giri/repos","events_url":"https://api.github.com/users/Ambarish-Giri/events{/privacy}","received_events_url":"https://api.github.com/users/Ambarish-Giri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T04:14:21Z","updated_at":"2021-09-16T04:14:21Z","author_association":"NONE","body":"Hi @nsivabalan ,\r\n\r\nWe have been trying to optimize the upsert but still the 44GB upsert over a 54 GB bulk-insert in a fairly big cluster is taking more than 3 hrs. Below in the EMR cluster configuration and the Upsert config:\r\n\r\nuserSegDf.write\r\n      .format(\"hudi\")\r\n      .option(DataSourceWriteOptions.TABLE_TYPE_OPT_KEY, DataSourceWriteOptions.COW_TABLE_TYPE_OPT_VAL)\r\n       .option(DataSourceWriteOptions.KEYGENERATOR_CLASS_OPT_KEY, keyGenClass)\r\n      .option(DataSourceWriteOptions.RECORDKEY_FIELD_OPT_KEY, key)\r\n      .option(DataSourceWriteOptions.PARTITIONPATH_FIELD_OPT_KEY, partitionKey)\r\n      .option(DataSourceWriteOptions.PRECOMBINE_FIELD_OPT_KEY, combineKey)\r\n      .option(HoodieWriteConfig.TABLE_NAME, tableName)\r\n      .option(HoodieIndexConfig.INDEX_TYPE_PROP,HoodieIndex.IndexType.SIMPLE.toString())\r\n      .option(HoodieIndexConfig.SIMPLE_INDEX_PARALLELISM_PROP,50)\r\n      .option(HoodieMetadataConfig.METADATA_ENABLE_PROP, true)\r\n      .option(DataSourceWriteOptions.OPERATION_OPT_KEY, DataSourceWriteOptions.UPSERT_OPERATION_OPT_VAL)\r\n      .option(DataSourceWriteOptions.ENABLE_ROW_WRITER_OPT_KEY, true)\r\n      .option(HoodieWriteConfig.UPSERT_PARALLELISM, 200)\r\n      .option(HoodieWriteConfig.COMBINE_BEFORE_UPSERT_PROP, false)\r\n      .option(HoodieWriteConfig.WRITE_BUFFER_LIMIT_BYTES, 41943040)\r\n      .option(HoodieCompactionConfig.COPY_ON_WRITE_TABLE_RECORD_SIZE_ESTIMATE, 100)\r\n      .option(DataSourceWriteOptions.HIVE_STYLE_PARTITIONING_OPT_KEY, true)\r\n        .mode(SaveMode.Append)\r\n      .save(s\"$basePath/$tableName/\")\r\n\r\nCluster config:\r\nStatic EMR cluster: 1 Master (m5.xlarge) node and 8 * (r5d.24xlarge) core nodes\r\n\r\nSpark-Submit Command 👍 \r\n\r\nspark-submit --master yarn --deploy-mode client \\\r\n     --num-executors 192 --driver-memory 4G --executor-memory 20G \\\r\n     --conf spark.yarn.executor.memoryOverhead=4096 \\\r\n     --conf spark.yarn.driver.memoryOverhead=2048 \\\r\n     --conf spark.yarn.max.executor.failures=100 \\\r\n     --conf spark.task.cpus=1 \\\r\n     --conf spark.rdd.compress=true \\\r\n     --conf spark.kryoserializer.buffer.max=512m \\\r\n     --conf spark.yarn.maxAppAttempts=3 \\\r\n     --conf spark.executor.cores=4 \\\r\n     --conf spark.segment.etl.numexecutors=192 \\\r\n     --conf spark.network.timeout=800 \\\r\n     --conf spark.shuffle.service.enabled=true \\\r\n     --conf spark.sql.hive.convertMetastoreParquet=false \\\r\n\t --conf spark.task.maxFailures=4 \\\r\n     --conf spark.shuffle.minNumPartitionsToHighlyCompress=32 \\\r\n     --conf spark.segment.processor.partition.count=1536 \\\r\n     --conf spark.segment.processor.output-shard.count=60 \\\r\n     --conf spark.segment.processor.binseg.partition.threshold.bytes=500000000000 \\\r\n     --conf spark.driver.maxResultSize=0 \\\r\n     --conf spark.hadoop.fs.s3.maxRetries=20 \\\r\n     --conf spark.kryoserializer.buffer.max=512m \\\r\n     --conf spark.serializer=org.apache.spark.serializer.KryoSerializer \\\r\n     --conf spark.sql.shuffle.partitions=3000 \\\r\n     --class <class-name>\\\r\n     --jars /usr/lib/hudi/hudi-spark-bundle.jar,/usr/lib/spark/external/lib/spark-avro.jar  \\\r\n     s3://<application>.jar","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920561496/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920594203","html_url":"https://github.com/apache/hudi/pull/3668#issuecomment-920594203","issue_url":"https://api.github.com/repos/apache/hudi/issues/3668","id":920594203,"node_id":"IC_kwDOBI7nWM423ycb","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T05:39:49Z","updated_at":"2021-09-16T05:39:49Z","author_association":"CONTRIBUTOR","body":"> cc @codope @bvaradar lets use this as a basis and evolve our design, move forward.\r\n> \r\n> @yanghua we are close I think. Few open items, that can be resolved soon hopefully.\r\n> You can follow along the discussion in the comments here\r\n> https://cwiki.apache.org/confluence/display/HUDI/RFC+-+33++Hudi+supports+more+comprehensive+Schema+Evolution\r\n> \r\n> @codope also has a bunch of these working on presto and trino already. Flink would be a good thing to tackle as well. Does Flink use the Hive record readers? cc @danny0405 as well.\r\n\r\nFlink does not use the Hive record readers now ~","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920594203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920597436","html_url":"https://github.com/apache/hudi/issues/3555#issuecomment-920597436","issue_url":"https://api.github.com/repos/apache/hudi/issues/3555","id":920597436,"node_id":"IC_kwDOBI7nWM423zO8","user":{"login":"YannByron","id":10036681,"node_id":"MDQ6VXNlcjEwMDM2Njgx","avatar_url":"https://avatars.githubusercontent.com/u/10036681?v=4","gravatar_id":"","url":"https://api.github.com/users/YannByron","html_url":"https://github.com/YannByron","followers_url":"https://api.github.com/users/YannByron/followers","following_url":"https://api.github.com/users/YannByron/following{/other_user}","gists_url":"https://api.github.com/users/YannByron/gists{/gist_id}","starred_url":"https://api.github.com/users/YannByron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannByron/subscriptions","organizations_url":"https://api.github.com/users/YannByron/orgs","repos_url":"https://api.github.com/users/YannByron/repos","events_url":"https://api.github.com/users/YannByron/events{/privacy}","received_events_url":"https://api.github.com/users/YannByron/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T05:47:56Z","updated_at":"2021-09-16T05:47:56Z","author_association":"CONTRIBUTOR","body":"@nsivabalan @pengzhiwei2018  i'm glad to take it up.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920597436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920619025","html_url":"https://github.com/apache/hudi/pull/3668#issuecomment-920619025","issue_url":"https://api.github.com/repos/apache/hudi/issues/3668","id":920619025,"node_id":"IC_kwDOBI7nWM4234gR","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T06:36:14Z","updated_at":"2021-09-16T06:36:14Z","author_association":"CONTRIBUTOR","body":"@danny0405  Hope you can help us complete the full schema evolution of flink， thanks","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920619025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920635637","html_url":"https://github.com/apache/hudi/pull/3652#issuecomment-920635637","issue_url":"https://api.github.com/repos/apache/hudi/issues/3652","id":920635637,"node_id":"IC_kwDOBI7nWM4238j1","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T07:08:19Z","updated_at":"2021-09-16T07:08:19Z","author_association":"CONTRIBUTOR","body":"@yanghua  thanks","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920635637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920664496","html_url":"https://github.com/apache/hudi/issues/3635#issuecomment-920664496","issue_url":"https://api.github.com/repos/apache/hudi/issues/3635","id":920664496,"node_id":"IC_kwDOBI7nWM424Dmw","user":{"login":"deshpandeanoop","id":16821076,"node_id":"MDQ6VXNlcjE2ODIxMDc2","avatar_url":"https://avatars.githubusercontent.com/u/16821076?v=4","gravatar_id":"","url":"https://api.github.com/users/deshpandeanoop","html_url":"https://github.com/deshpandeanoop","followers_url":"https://api.github.com/users/deshpandeanoop/followers","following_url":"https://api.github.com/users/deshpandeanoop/following{/other_user}","gists_url":"https://api.github.com/users/deshpandeanoop/gists{/gist_id}","starred_url":"https://api.github.com/users/deshpandeanoop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deshpandeanoop/subscriptions","organizations_url":"https://api.github.com/users/deshpandeanoop/orgs","repos_url":"https://api.github.com/users/deshpandeanoop/repos","events_url":"https://api.github.com/users/deshpandeanoop/events{/privacy}","received_events_url":"https://api.github.com/users/deshpandeanoop/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T07:38:35Z","updated_at":"2021-09-16T07:38:35Z","author_association":"NONE","body":"@vinothchandar : A gentle reminder to help us out here :) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920664496/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920680430","html_url":"https://github.com/apache/hudi/pull/3312#issuecomment-920680430","issue_url":"https://api.github.com/repos/apache/hudi/issues/3312","id":920680430,"node_id":"IC_kwDOBI7nWM424Hfu","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T08:03:39Z","updated_at":"2021-09-16T08:03:39Z","author_association":"CONTRIBUTOR","body":"I will reply after verification","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920680430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920688486","html_url":"https://github.com/apache/hudi/pull/3667#issuecomment-920688486","issue_url":"https://api.github.com/repos/apache/hudi/issues/3667","id":920688486,"node_id":"IC_kwDOBI7nWM424Jdm","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T08:15:04Z","updated_at":"2021-09-16T08:15:04Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920688486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920689069","html_url":"https://github.com/apache/hudi/pull/3623#issuecomment-920689069","issue_url":"https://api.github.com/repos/apache/hudi/issues/3623","id":920689069,"node_id":"IC_kwDOBI7nWM424Jmt","user":{"login":"zhangyue19921010","id":69956021,"node_id":"MDQ6VXNlcjY5OTU2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/69956021?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyue19921010","html_url":"https://github.com/zhangyue19921010","followers_url":"https://api.github.com/users/zhangyue19921010/followers","following_url":"https://api.github.com/users/zhangyue19921010/following{/other_user}","gists_url":"https://api.github.com/users/zhangyue19921010/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyue19921010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyue19921010/subscriptions","organizations_url":"https://api.github.com/users/zhangyue19921010/orgs","repos_url":"https://api.github.com/users/zhangyue19921010/repos","events_url":"https://api.github.com/users/zhangyue19921010/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyue19921010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T08:15:50Z","updated_at":"2021-09-16T08:15:50Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920689069/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920690239","html_url":"https://github.com/apache/hudi/pull/3674#issuecomment-920690239","issue_url":"https://api.github.com/repos/apache/hudi/issues/3674","id":920690239,"node_id":"IC_kwDOBI7nWM424J4_","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T08:17:22Z","updated_at":"2021-09-30T06:16:26Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"61baa2fb144ba3521441b03c51b12da9ff9b11bf\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2256\",\n    \"triggerID\" : \"61baa2fb144ba3521441b03c51b12da9ff9b11bf\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"a844e075069d260f22f1a3244708560bebf0128b\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2273\",\n    \"triggerID\" : \"a844e075069d260f22f1a3244708560bebf0128b\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"e16725afd2d76d509abb7415166bfe4468ee6e58\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2321\",\n    \"triggerID\" : \"e16725afd2d76d509abb7415166bfe4468ee6e58\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"7c634fd5d815d4643732d0c26144171c9dd8e64c\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2333\",\n    \"triggerID\" : \"7c634fd5d815d4643732d0c26144171c9dd8e64c\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"cf1f2dba2dd9ca560cd33ca012dbe5613e42a733\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2469\",\n    \"triggerID\" : \"cf1f2dba2dd9ca560cd33ca012dbe5613e42a733\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* cf1f2dba2dd9ca560cd33ca012dbe5613e42a733 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2469) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920690239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920693998","html_url":"https://github.com/apache/hudi/pull/3623#issuecomment-920693998","issue_url":"https://api.github.com/repos/apache/hudi/issues/3623","id":920693998,"node_id":"IC_kwDOBI7nWM424Kzu","user":{"login":"zhangyue19921010","id":69956021,"node_id":"MDQ6VXNlcjY5OTU2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/69956021?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyue19921010","html_url":"https://github.com/zhangyue19921010","followers_url":"https://api.github.com/users/zhangyue19921010/followers","following_url":"https://api.github.com/users/zhangyue19921010/following{/other_user}","gists_url":"https://api.github.com/users/zhangyue19921010/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyue19921010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyue19921010/subscriptions","organizations_url":"https://api.github.com/users/zhangyue19921010/orgs","repos_url":"https://api.github.com/users/zhangyue19921010/repos","events_url":"https://api.github.com/users/zhangyue19921010/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyue19921010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T08:21:31Z","updated_at":"2021-09-16T08:21:31Z","author_association":"CONTRIBUTOR","body":"Although IT for presto seems failed somehow. I'm struggling with it and takes a few days :(","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920693998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920748080","html_url":"https://github.com/apache/hudi/issues/3132#issuecomment-920748080","issue_url":"https://api.github.com/repos/apache/hudi/issues/3132","id":920748080,"node_id":"IC_kwDOBI7nWM424YAw","user":{"login":"deep-teliacompany","id":85501086,"node_id":"MDQ6VXNlcjg1NTAxMDg2","avatar_url":"https://avatars.githubusercontent.com/u/85501086?v=4","gravatar_id":"","url":"https://api.github.com/users/deep-teliacompany","html_url":"https://github.com/deep-teliacompany","followers_url":"https://api.github.com/users/deep-teliacompany/followers","following_url":"https://api.github.com/users/deep-teliacompany/following{/other_user}","gists_url":"https://api.github.com/users/deep-teliacompany/gists{/gist_id}","starred_url":"https://api.github.com/users/deep-teliacompany/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deep-teliacompany/subscriptions","organizations_url":"https://api.github.com/users/deep-teliacompany/orgs","repos_url":"https://api.github.com/users/deep-teliacompany/repos","events_url":"https://api.github.com/users/deep-teliacompany/events{/privacy}","received_events_url":"https://api.github.com/users/deep-teliacompany/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T09:40:45Z","updated_at":"2021-09-16T09:44:57Z","author_association":"NONE","body":"Hi, I am not using hive sync tool, will try and and will share the observations.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920748080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920845738","html_url":"https://github.com/apache/hudi/pull/3675#issuecomment-920845738","issue_url":"https://api.github.com/repos/apache/hudi/issues/3675","id":920845738,"node_id":"IC_kwDOBI7nWM424v2q","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T12:09:44Z","updated_at":"2021-09-16T12:53:12Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"f3c5e11727731de42256eeb54efd910d7be637eb\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2261\",\n    \"triggerID\" : \"f3c5e11727731de42256eeb54efd910d7be637eb\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* f3c5e11727731de42256eeb54efd910d7be637eb Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2261) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/920845738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921095856","html_url":"https://github.com/apache/hudi/issues/2680#issuecomment-921095856","issue_url":"https://api.github.com/repos/apache/hudi/issues/2680","id":921095856,"node_id":"IC_kwDOBI7nWM425s6w","user":{"login":"stym06","id":20970728,"node_id":"MDQ6VXNlcjIwOTcwNzI4","avatar_url":"https://avatars.githubusercontent.com/u/20970728?v=4","gravatar_id":"","url":"https://api.github.com/users/stym06","html_url":"https://github.com/stym06","followers_url":"https://api.github.com/users/stym06/followers","following_url":"https://api.github.com/users/stym06/following{/other_user}","gists_url":"https://api.github.com/users/stym06/gists{/gist_id}","starred_url":"https://api.github.com/users/stym06/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stym06/subscriptions","organizations_url":"https://api.github.com/users/stym06/orgs","repos_url":"https://api.github.com/users/stym06/repos","events_url":"https://api.github.com/users/stym06/events{/privacy}","received_events_url":"https://api.github.com/users/stym06/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T17:32:31Z","updated_at":"2021-09-16T17:32:31Z","author_association":"CONTRIBUTOR","body":"@moranyuwen  I was facing this issue and it got fixed when I ran it after turning on the hiveserver2 in the pod. My hunch is that it needs the hive-site.xml to know that it has to use mysql driver else it uses the default derby driver.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921095856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921114745","html_url":"https://github.com/apache/hudi/issues/3095#issuecomment-921114745","issue_url":"https://api.github.com/repos/apache/hudi/issues/3095","id":921114745,"node_id":"IC_kwDOBI7nWM425xh5","user":{"login":"zhedoubushishi","id":31263084,"node_id":"MDQ6VXNlcjMxMjYzMDg0","avatar_url":"https://avatars.githubusercontent.com/u/31263084?v=4","gravatar_id":"","url":"https://api.github.com/users/zhedoubushishi","html_url":"https://github.com/zhedoubushishi","followers_url":"https://api.github.com/users/zhedoubushishi/followers","following_url":"https://api.github.com/users/zhedoubushishi/following{/other_user}","gists_url":"https://api.github.com/users/zhedoubushishi/gists{/gist_id}","starred_url":"https://api.github.com/users/zhedoubushishi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhedoubushishi/subscriptions","organizations_url":"https://api.github.com/users/zhedoubushishi/orgs","repos_url":"https://api.github.com/users/zhedoubushishi/repos","events_url":"https://api.github.com/users/zhedoubushishi/events{/privacy}","received_events_url":"https://api.github.com/users/zhedoubushishi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T17:59:51Z","updated_at":"2021-09-16T17:59:51Z","author_association":"CONTRIBUTOR","body":"Sorry for the late reply. I also think this is not a Hudi specific issue, it's more like an EMR implementation issue. You can just open a customer support ticket to EMR.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921114745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921203076","html_url":"https://github.com/apache/hudi/pull/3678#issuecomment-921203076","issue_url":"https://api.github.com/repos/apache/hudi/issues/3678","id":921203076,"node_id":"IC_kwDOBI7nWM426HGE","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T19:58:24Z","updated_at":"2021-09-20T10:55:48Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"b1eef40fd1ea04c059f75ce5f34b8f637ef73f5f\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2268\",\n    \"triggerID\" : \"b1eef40fd1ea04c059f75ce5f34b8f637ef73f5f\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"478a4a1774e5143608079bb60e1fdbca8c574aa9\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2269\",\n    \"triggerID\" : \"478a4a1774e5143608079bb60e1fdbca8c574aa9\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"8dad899da6d388d301efb6bb5b336b70f395444b\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2290\",\n    \"triggerID\" : \"8dad899da6d388d301efb6bb5b336b70f395444b\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"113e65fcba1dc88589aae8267554567baa121aa1\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2294\",\n    \"triggerID\" : \"113e65fcba1dc88589aae8267554567baa121aa1\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 113e65fcba1dc88589aae8267554567baa121aa1 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2294) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921203076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921206253","html_url":"https://github.com/apache/hudi/pull/3659#issuecomment-921206253","issue_url":"https://api.github.com/repos/apache/hudi/issues/3659","id":921206253,"node_id":"IC_kwDOBI7nWM426H3t","user":{"login":"xushiyan","id":2701446,"node_id":"MDQ6VXNlcjI3MDE0NDY=","avatar_url":"https://avatars.githubusercontent.com/u/2701446?v=4","gravatar_id":"","url":"https://api.github.com/users/xushiyan","html_url":"https://github.com/xushiyan","followers_url":"https://api.github.com/users/xushiyan/followers","following_url":"https://api.github.com/users/xushiyan/following{/other_user}","gists_url":"https://api.github.com/users/xushiyan/gists{/gist_id}","starred_url":"https://api.github.com/users/xushiyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xushiyan/subscriptions","organizations_url":"https://api.github.com/users/xushiyan/orgs","repos_url":"https://api.github.com/users/xushiyan/repos","events_url":"https://api.github.com/users/xushiyan/events{/privacy}","received_events_url":"https://api.github.com/users/xushiyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T20:03:34Z","updated_at":"2021-09-16T20:03:34Z","author_association":"MEMBER","body":"@geertjanw no worries. mind fixing it?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921206253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921230495","html_url":"https://github.com/apache/hudi/issues/3581#issuecomment-921230495","issue_url":"https://api.github.com/repos/apache/hudi/issues/3581","id":921230495,"node_id":"IC_kwDOBI7nWM426Nyf","user":{"login":"xushiyan","id":2701446,"node_id":"MDQ6VXNlcjI3MDE0NDY=","avatar_url":"https://avatars.githubusercontent.com/u/2701446?v=4","gravatar_id":"","url":"https://api.github.com/users/xushiyan","html_url":"https://github.com/xushiyan","followers_url":"https://api.github.com/users/xushiyan/followers","following_url":"https://api.github.com/users/xushiyan/following{/other_user}","gists_url":"https://api.github.com/users/xushiyan/gists{/gist_id}","starred_url":"https://api.github.com/users/xushiyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xushiyan/subscriptions","organizations_url":"https://api.github.com/users/xushiyan/orgs","repos_url":"https://api.github.com/users/xushiyan/repos","events_url":"https://api.github.com/users/xushiyan/events{/privacy}","received_events_url":"https://api.github.com/users/xushiyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T20:42:18Z","updated_at":"2021-09-16T20:42:18Z","author_association":"MEMBER","body":"@codejoyan for reading can you also try enabling the metadata config too? like `.option(\"hoodie.metadata.enable\", \"true\")`. certainly we need to make the docs better..","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921230495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921259161","html_url":"https://github.com/apache/hudi/pull/3679#issuecomment-921259161","issue_url":"https://api.github.com/repos/apache/hudi/issues/3679","id":921259161,"node_id":"IC_kwDOBI7nWM426UyZ","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T21:24:09Z","updated_at":"2021-09-16T21:24:09Z","author_association":"MEMBER","body":"@rmahindra123 can you give me a quick review of this?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921259161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921265173","html_url":"https://github.com/apache/hudi/pull/3679#issuecomment-921265173","issue_url":"https://api.github.com/repos/apache/hudi/issues/3679","id":921265173,"node_id":"IC_kwDOBI7nWM426WQV","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T21:28:41Z","updated_at":"2021-09-16T22:14:13Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"95f2f0d2ed51d04084be38c3b2c15785b76f503d\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2270\",\n    \"triggerID\" : \"95f2f0d2ed51d04084be38c3b2c15785b76f503d\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 95f2f0d2ed51d04084be38c3b2c15785b76f503d Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2270) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921265173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921300090","html_url":"https://github.com/apache/hudi/pull/3679#issuecomment-921300090","issue_url":"https://api.github.com/repos/apache/hudi/issues/3679","id":921300090,"node_id":"IC_kwDOBI7nWM426ex6","user":{"login":"rmahindra123","id":76502047,"node_id":"MDQ6VXNlcjc2NTAyMDQ3","avatar_url":"https://avatars.githubusercontent.com/u/76502047?v=4","gravatar_id":"","url":"https://api.github.com/users/rmahindra123","html_url":"https://github.com/rmahindra123","followers_url":"https://api.github.com/users/rmahindra123/followers","following_url":"https://api.github.com/users/rmahindra123/following{/other_user}","gists_url":"https://api.github.com/users/rmahindra123/gists{/gist_id}","starred_url":"https://api.github.com/users/rmahindra123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmahindra123/subscriptions","organizations_url":"https://api.github.com/users/rmahindra123/orgs","repos_url":"https://api.github.com/users/rmahindra123/repos","events_url":"https://api.github.com/users/rmahindra123/events{/privacy}","received_events_url":"https://api.github.com/users/rmahindra123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T22:24:10Z","updated_at":"2021-09-16T22:24:10Z","author_association":"CONTRIBUTOR","body":"> @rmahindra123 can you give me a quick review of this?\r\n\r\nlgtm","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921300090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921317594","html_url":"https://github.com/apache/hudi/pull/3678#issuecomment-921317594","issue_url":"https://api.github.com/repos/apache/hudi/issues/3678","id":921317594,"node_id":"IC_kwDOBI7nWM426jDa","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-16T22:56:45Z","updated_at":"2021-09-16T22:56:45Z","author_association":"MEMBER","body":"CI is failing","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921317594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921467046","html_url":"https://github.com/apache/hudi/pull/3668#issuecomment-921467046","issue_url":"https://api.github.com/repos/apache/hudi/issues/3668","id":921467046,"node_id":"IC_kwDOBI7nWM427Him","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T04:49:55Z","updated_at":"2021-09-17T04:50:45Z","author_association":"CONTRIBUTOR","body":"@codope  thanks for your review.   Let me answer some your questions first，pls forgive me for being busy today, I need to modify something for the pr of zorder\r\n**Let's add docs for all the public classes and APIs.**\r\nok，i will added。\r\n**Does the merge schema action handle evolution of non-leaf fields in nested fields? For example, if a.b.c is renamed to a.d.c.**\r\nthis is a strange demand， if you want to change a.b.c to a.d.c , why donot use  spark.sql(s\"alter table ${tableName} rename column a.b to d\"). we support handle all the non-leaf fields.\r\n\r\n**IIUC, the patch has not yet handled old or existing schema compatibility as mentioned in the RFC right?**\r\nalready deal with this situation. pls see the TestSpark3DDL,  we first create  a table and insert some data to it. now no id-schema is produced. then we do schema change, and the id-schema is produced.  the test result confirmed this。  \r\n\r\n**Since schema history is being changed not only at the write time but also at the read time, so we need to think of both writer and reader concurrency.**\r\nA little doubtful， hudi is snapshot isolated， maybe only need to deal with concurrency between write and write， if i am wrong pls fix me ， thanks\r\n\r\n\r\nNow there is the most important question， I now tend to use metatable to store historical schema。 as we know metatable use hfile to store data， the hfile has a very good point query performance， what do you suggest？\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921467046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921517144","html_url":"https://github.com/apache/hudi/pull/3671#issuecomment-921517144","issue_url":"https://api.github.com/repos/apache/hudi/issues/3671","id":921517144,"node_id":"IC_kwDOBI7nWM427TxY","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T05:47:47Z","updated_at":"2021-09-17T05:47:47Z","author_association":"CONTRIBUTOR","body":"@fengjian428 thanks for your contribution. Please check the CI failure.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921517144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921558668","html_url":"https://github.com/apache/hudi/issues/3609#issuecomment-921558668","issue_url":"https://api.github.com/repos/apache/hudi/issues/3609","id":921558668,"node_id":"IC_kwDOBI7nWM427d6M","user":{"login":"YannByron","id":10036681,"node_id":"MDQ6VXNlcjEwMDM2Njgx","avatar_url":"https://avatars.githubusercontent.com/u/10036681?v=4","gravatar_id":"","url":"https://api.github.com/users/YannByron","html_url":"https://github.com/YannByron","followers_url":"https://api.github.com/users/YannByron/followers","following_url":"https://api.github.com/users/YannByron/following{/other_user}","gists_url":"https://api.github.com/users/YannByron/gists{/gist_id}","starred_url":"https://api.github.com/users/YannByron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannByron/subscriptions","organizations_url":"https://api.github.com/users/YannByron/orgs","repos_url":"https://api.github.com/users/YannByron/repos","events_url":"https://api.github.com/users/YannByron/events{/privacy}","received_events_url":"https://api.github.com/users/YannByron/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T07:17:00Z","updated_at":"2021-09-17T07:17:00Z","author_association":"CONTRIBUTOR","body":"This exception is caused by the org.apache.spark.sql.catalyst.expressions.Alias's definition being changed in Spark 3.1.x.( https://github.com/apache/spark/pull/30682 ).\r\n\r\nUpgrading to Spark3.1 will be work: #3580 ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921558668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921608329","html_url":"https://github.com/apache/hudi/issues/2215#issuecomment-921608329","issue_url":"https://api.github.com/repos/apache/hudi/issues/2215","id":921608329,"node_id":"IC_kwDOBI7nWM427qCJ","user":{"login":"wxplovecc","id":3350718,"node_id":"MDQ6VXNlcjMzNTA3MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3350718?v=4","gravatar_id":"","url":"https://api.github.com/users/wxplovecc","html_url":"https://github.com/wxplovecc","followers_url":"https://api.github.com/users/wxplovecc/followers","following_url":"https://api.github.com/users/wxplovecc/following{/other_user}","gists_url":"https://api.github.com/users/wxplovecc/gists{/gist_id}","starred_url":"https://api.github.com/users/wxplovecc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wxplovecc/subscriptions","organizations_url":"https://api.github.com/users/wxplovecc/orgs","repos_url":"https://api.github.com/users/wxplovecc/repos","events_url":"https://api.github.com/users/wxplovecc/events{/privacy}","received_events_url":"https://api.github.com/users/wxplovecc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T08:26:14Z","updated_at":"2021-09-17T09:37:42Z","author_association":"CONTRIBUTOR","body":"@bvaradar  I have the same problem in 0.9.0 release\r\n![memory leak](https://user-images.githubusercontent.com/3350718/133750266-4010e6f0-3e65-496b-b5fd-e45390f0543b.png)\r\n![企业微信截图_16318714201895](https://user-images.githubusercontent.com/3350718/133761628-ebda6371-099a-409b-8263-1e54d9776815.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921608329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921614646","html_url":"https://github.com/apache/hudi/pull/3330#issuecomment-921614646","issue_url":"https://api.github.com/repos/apache/hudi/issues/3330","id":921614646,"node_id":"IC_kwDOBI7nWM427rk2","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T08:35:38Z","updated_at":"2021-09-18T01:46:56Z","author_association":"CONTRIBUTOR","body":"@vinothchandar  thanks for your review。\r\nupdate the code.\r\n1. Merge HoodieOptimizeConfig to HoodieClusteringConfig. Add more docs for parameter\r\n2. fix  all comments.\r\n3.   deal with  the scenario  that handling of failed, retried cluster operations at the same instant time.  before we save statistics info into indexTable，all  residual  files will be delete，include the files which produced by retried.\r\n4. this pr only use the unsafe compare method from hbase.  \r\nno code from other project\r\nthe unsafe Lexicographically comparison algorithm in hbase is faster then jave implement。\r\nIf you think the unsafe method should not be used, I can provide a java implementation。\r\n\r\n\r\nOne last thing：\r\nThis pr actually implements two functions, one is zorder and the other is dataskipping。\r\nFor better review,  maybe we can split this pr into two prs","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921614646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921638587","html_url":"https://github.com/apache/hudi/pull/3681#issuecomment-921638587","issue_url":"https://api.github.com/repos/apache/hudi/issues/3681","id":921638587,"node_id":"IC_kwDOBI7nWM427xa7","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T09:11:16Z","updated_at":"2021-09-17T09:57:42Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"f7d0269bae0b9057181e0d439b46c81c6eea4f62\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2275\",\n    \"triggerID\" : \"f7d0269bae0b9057181e0d439b46c81c6eea4f62\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* f7d0269bae0b9057181e0d439b46c81c6eea4f62 Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2275) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921638587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921657259","html_url":"https://github.com/apache/hudi/issues/3680#issuecomment-921657259","issue_url":"https://api.github.com/repos/apache/hudi/issues/3680","id":921657259,"node_id":"IC_kwDOBI7nWM4271-r","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T09:38:38Z","updated_at":"2021-09-17T09:38:38Z","author_association":"CONTRIBUTOR","body":"Hi, here is the doc how you can sync the hive: https://www.yuque.com/docs/share/01c98494-a980-414c-9c45-152023bf3c17?#IsoNU\r\n\r\n1. You may need to modify the hive dependency version as what you are using\r\n2. You need to add the hive profile","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921657259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921662908","html_url":"https://github.com/apache/hudi/pull/3682#issuecomment-921662908","issue_url":"https://api.github.com/repos/apache/hudi/issues/3682","id":921662908,"node_id":"IC_kwDOBI7nWM4273W8","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T09:47:34Z","updated_at":"2021-09-17T09:50:58Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"4ba3cc5890c5e6960843fd0fc48b4f40ddbb74fb\",\n    \"status\" : \"PENDING\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2276\",\n    \"triggerID\" : \"4ba3cc5890c5e6960843fd0fc48b4f40ddbb74fb\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 4ba3cc5890c5e6960843fd0fc48b4f40ddbb74fb Azure: [PENDING](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2276) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921662908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921673327","html_url":"https://github.com/apache/hudi/issues/3680#issuecomment-921673327","issue_url":"https://api.github.com/repos/apache/hudi/issues/3680","id":921673327,"node_id":"IC_kwDOBI7nWM42755v","user":{"login":"zhouhongyu888","id":59045547,"node_id":"MDQ6VXNlcjU5MDQ1NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/59045547?v=4","gravatar_id":"","url":"https://api.github.com/users/zhouhongyu888","html_url":"https://github.com/zhouhongyu888","followers_url":"https://api.github.com/users/zhouhongyu888/followers","following_url":"https://api.github.com/users/zhouhongyu888/following{/other_user}","gists_url":"https://api.github.com/users/zhouhongyu888/gists{/gist_id}","starred_url":"https://api.github.com/users/zhouhongyu888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhouhongyu888/subscriptions","organizations_url":"https://api.github.com/users/zhouhongyu888/orgs","repos_url":"https://api.github.com/users/zhouhongyu888/repos","events_url":"https://api.github.com/users/zhouhongyu888/events{/privacy}","received_events_url":"https://api.github.com/users/zhouhongyu888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T10:04:05Z","updated_at":"2021-09-17T10:10:12Z","author_association":"NONE","body":"> Hi, here is the doc how you can sync the hive: https://www.yuque.com/docs/share/01c98494-a980-414c-9c45-152023bf3c17?#IsoNU\r\n> \r\n> 1. You may need to modify the hive dependency version as what you are using\r\n> 2. You need to add the hive profile\r\nyes , I compiled hudi using the parameter -Pflink-bundle-shade-hive3 and my hive version is 3.1.2 which is the same as it in the pom.xml, so I think maybe there exits other reason","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921673327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921673503","html_url":"https://github.com/apache/hudi/pull/3682#issuecomment-921673503","issue_url":"https://api.github.com/repos/apache/hudi/issues/3682","id":921673503,"node_id":"IC_kwDOBI7nWM42758f","user":{"login":"dongkelun","id":13376555,"node_id":"MDQ6VXNlcjEzMzc2NTU1","avatar_url":"https://avatars.githubusercontent.com/u/13376555?v=4","gravatar_id":"","url":"https://api.github.com/users/dongkelun","html_url":"https://github.com/dongkelun","followers_url":"https://api.github.com/users/dongkelun/followers","following_url":"https://api.github.com/users/dongkelun/following{/other_user}","gists_url":"https://api.github.com/users/dongkelun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongkelun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongkelun/subscriptions","organizations_url":"https://api.github.com/users/dongkelun/orgs","repos_url":"https://api.github.com/users/dongkelun/repos","events_url":"https://api.github.com/users/dongkelun/events{/privacy}","received_events_url":"https://api.github.com/users/dongkelun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T10:04:17Z","updated_at":"2021-09-17T10:04:17Z","author_association":"CONTRIBUTOR","body":"I'm very sorry, JIRA ID is wrong","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921673503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921678146","html_url":"https://github.com/apache/hudi/pull/3683#issuecomment-921678146","issue_url":"https://api.github.com/repos/apache/hudi/issues/3683","id":921678146,"node_id":"IC_kwDOBI7nWM4277FC","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T10:11:07Z","updated_at":"2021-09-17T10:56:54Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"794170c9c99bc65cc7e56182c1993028fc4a37f1\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2277\",\n    \"triggerID\" : \"794170c9c99bc65cc7e56182c1993028fc4a37f1\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 794170c9c99bc65cc7e56182c1993028fc4a37f1 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2277) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921678146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921727498","html_url":"https://github.com/apache/hudi/issues/3684#issuecomment-921727498","issue_url":"https://api.github.com/repos/apache/hudi/issues/3684","id":921727498,"node_id":"IC_kwDOBI7nWM428HIK","user":{"login":"vanderzh","id":30547463,"node_id":"MDQ6VXNlcjMwNTQ3NDYz","avatar_url":"https://avatars.githubusercontent.com/u/30547463?v=4","gravatar_id":"","url":"https://api.github.com/users/vanderzh","html_url":"https://github.com/vanderzh","followers_url":"https://api.github.com/users/vanderzh/followers","following_url":"https://api.github.com/users/vanderzh/following{/other_user}","gists_url":"https://api.github.com/users/vanderzh/gists{/gist_id}","starred_url":"https://api.github.com/users/vanderzh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanderzh/subscriptions","organizations_url":"https://api.github.com/users/vanderzh/orgs","repos_url":"https://api.github.com/users/vanderzh/repos","events_url":"https://api.github.com/users/vanderzh/events{/privacy}","received_events_url":"https://api.github.com/users/vanderzh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T11:36:27Z","updated_at":"2021-09-17T11:36:27Z","author_association":"CONTRIBUTOR","body":"```\r\n<dependency>\r\n    <groupId>org.apache.hudi</groupId>\r\n    <artifactId>hudi-spark-bundle_2.11</artifactId>\r\n    <version>0.10.0-SNAPSHOT</version>\r\n</dependency>\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921727498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921776941","html_url":"https://github.com/apache/hudi/pull/3648#issuecomment-921776941","issue_url":"https://api.github.com/repos/apache/hudi/issues/3648","id":921776941,"node_id":"IC_kwDOBI7nWM428TMt","user":{"login":"dongkelun","id":13376555,"node_id":"MDQ6VXNlcjEzMzc2NTU1","avatar_url":"https://avatars.githubusercontent.com/u/13376555?v=4","gravatar_id":"","url":"https://api.github.com/users/dongkelun","html_url":"https://github.com/dongkelun","followers_url":"https://api.github.com/users/dongkelun/followers","following_url":"https://api.github.com/users/dongkelun/following{/other_user}","gists_url":"https://api.github.com/users/dongkelun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongkelun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongkelun/subscriptions","organizations_url":"https://api.github.com/users/dongkelun/orgs","repos_url":"https://api.github.com/users/dongkelun/repos","events_url":"https://api.github.com/users/dongkelun/events{/privacy}","received_events_url":"https://api.github.com/users/dongkelun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T12:59:43Z","updated_at":"2021-09-17T13:11:19Z","author_association":"CONTRIBUTOR","body":"Hi,I also encountered the same problem in the previous use. I simply wrote the checkpoint as \"0\". Overall LGTM but I have a question about whether the empty string is repeated with 'formatAdapter.getSource() instanceof SqlSource', and whether it only needs to add a judgment in DeltaSync?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921776941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921785819","html_url":"https://github.com/apache/hudi/issues/3665#issuecomment-921785819","issue_url":"https://api.github.com/repos/apache/hudi/issues/3665","id":921785819,"node_id":"IC_kwDOBI7nWM428VXb","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T13:11:59Z","updated_at":"2021-09-17T13:11:59Z","author_association":"CONTRIBUTOR","body":"@Wrekkers Using the master branch, which is now supported","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921785819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921882784","html_url":"https://github.com/apache/hudi/issues/2970#issuecomment-921882784","issue_url":"https://api.github.com/repos/apache/hudi/issues/2970","id":921882784,"node_id":"IC_kwDOBI7nWM428tCg","user":{"login":"Natielle","id":27839450,"node_id":"MDQ6VXNlcjI3ODM5NDUw","avatar_url":"https://avatars.githubusercontent.com/u/27839450?v=4","gravatar_id":"","url":"https://api.github.com/users/Natielle","html_url":"https://github.com/Natielle","followers_url":"https://api.github.com/users/Natielle/followers","following_url":"https://api.github.com/users/Natielle/following{/other_user}","gists_url":"https://api.github.com/users/Natielle/gists{/gist_id}","starred_url":"https://api.github.com/users/Natielle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Natielle/subscriptions","organizations_url":"https://api.github.com/users/Natielle/orgs","repos_url":"https://api.github.com/users/Natielle/repos","events_url":"https://api.github.com/users/Natielle/events{/privacy}","received_events_url":"https://api.github.com/users/Natielle/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T15:21:56Z","updated_at":"2021-09-17T15:23:33Z","author_association":"NONE","body":"I had the same problem and I was sure that no other jobs running in parallel. The root problem was the partition column containing a value \".\". To solve, I transformed \".\" into null value (with python was None/NaN value).","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921882784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921983770","html_url":"https://github.com/apache/hudi/pull/3010#issuecomment-921983770","issue_url":"https://api.github.com/repos/apache/hudi/issues/3010","id":921983770,"node_id":"IC_kwDOBI7nWM429Fsa","user":{"login":"pratyakshsharma","id":30863489,"node_id":"MDQ6VXNlcjMwODYzNDg5","avatar_url":"https://avatars.githubusercontent.com/u/30863489?v=4","gravatar_id":"","url":"https://api.github.com/users/pratyakshsharma","html_url":"https://github.com/pratyakshsharma","followers_url":"https://api.github.com/users/pratyakshsharma/followers","following_url":"https://api.github.com/users/pratyakshsharma/following{/other_user}","gists_url":"https://api.github.com/users/pratyakshsharma/gists{/gist_id}","starred_url":"https://api.github.com/users/pratyakshsharma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pratyakshsharma/subscriptions","organizations_url":"https://api.github.com/users/pratyakshsharma/orgs","repos_url":"https://api.github.com/users/pratyakshsharma/repos","events_url":"https://api.github.com/users/pratyakshsharma/events{/privacy}","received_events_url":"https://api.github.com/users/pratyakshsharma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T18:05:11Z","updated_at":"2021-09-17T18:05:11Z","author_association":"CONTRIBUTOR","body":"> @pratyakshsharma : Can you follow up on this PR please.\r\n\r\nYes. Will close this over the weekend.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921983770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921991089","html_url":"https://github.com/apache/hudi/pull/3671#issuecomment-921991089","issue_url":"https://api.github.com/repos/apache/hudi/issues/3671","id":921991089,"node_id":"IC_kwDOBI7nWM429Hex","user":{"login":"fengjian428","id":4403474,"node_id":"MDQ6VXNlcjQ0MDM0NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/4403474?v=4","gravatar_id":"","url":"https://api.github.com/users/fengjian428","html_url":"https://github.com/fengjian428","followers_url":"https://api.github.com/users/fengjian428/followers","following_url":"https://api.github.com/users/fengjian428/following{/other_user}","gists_url":"https://api.github.com/users/fengjian428/gists{/gist_id}","starred_url":"https://api.github.com/users/fengjian428/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengjian428/subscriptions","organizations_url":"https://api.github.com/users/fengjian428/orgs","repos_url":"https://api.github.com/users/fengjian428/repos","events_url":"https://api.github.com/users/fengjian428/events{/privacy}","received_events_url":"https://api.github.com/users/fengjian428/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T18:17:07Z","updated_at":"2021-09-17T18:17:07Z","author_association":"CONTRIBUTOR","body":"> @fengjian428 thanks for your contribution. Please check the CI failure.\r\n\r\nseems has check style error, already fix it","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/921991089/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922046864","html_url":"https://github.com/apache/hudi/issues/3581#issuecomment-922046864","issue_url":"https://api.github.com/repos/apache/hudi/issues/3581","id":922046864,"node_id":"IC_kwDOBI7nWM429VGQ","user":{"login":"umehrot2","id":8647012,"node_id":"MDQ6VXNlcjg2NDcwMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8647012?v=4","gravatar_id":"","url":"https://api.github.com/users/umehrot2","html_url":"https://github.com/umehrot2","followers_url":"https://api.github.com/users/umehrot2/followers","following_url":"https://api.github.com/users/umehrot2/following{/other_user}","gists_url":"https://api.github.com/users/umehrot2/gists{/gist_id}","starred_url":"https://api.github.com/users/umehrot2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/umehrot2/subscriptions","organizations_url":"https://api.github.com/users/umehrot2/orgs","repos_url":"https://api.github.com/users/umehrot2/repos","events_url":"https://api.github.com/users/umehrot2/events{/privacy}","received_events_url":"https://api.github.com/users/umehrot2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T19:58:58Z","updated_at":"2021-09-17T19:58:58Z","author_association":"CONTRIBUTOR","body":"@codejoyan since you are observing `Listing leaf files...` it means that your code is using `InMemoryFileIndex` instead of `HoodieFileIndex`. I think you are using an older version of Hudi and not Hudi 0.9.0 for your testing. In Hudi 0.9.0 to enable metadata listing you can just do `SET hoodie.metadata.enable=true` in Spark SQL.\r\n\r\nIf you are using earlier version of Hudi i.e 0.8.0 or 0.7.0 it does have `HoodieFileIndex`. To obtain best listing performance you should use the Hoodie RO Path Filter (if using COW table) https://hudi.apache.org/docs/querying_data/#spark-sql. To further enable metadata listing in release 0.8.0 or 0.7.0 (either COW or MOR) you need to pass it as a hadoop conf: `spark.hadoop.hoodie.metadata.enable`. But main benefits of metadata listing you would observe only since Hudi 0.9.0 with the introduction of HoodieFileIndex.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922046864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922052140","html_url":"https://github.com/apache/hudi/issues/2970#issuecomment-922052140","issue_url":"https://api.github.com/repos/apache/hudi/issues/2970","id":922052140,"node_id":"IC_kwDOBI7nWM429WYs","user":{"login":"deep-teliacompany","id":85501086,"node_id":"MDQ6VXNlcjg1NTAxMDg2","avatar_url":"https://avatars.githubusercontent.com/u/85501086?v=4","gravatar_id":"","url":"https://api.github.com/users/deep-teliacompany","html_url":"https://github.com/deep-teliacompany","followers_url":"https://api.github.com/users/deep-teliacompany/followers","following_url":"https://api.github.com/users/deep-teliacompany/following{/other_user}","gists_url":"https://api.github.com/users/deep-teliacompany/gists{/gist_id}","starred_url":"https://api.github.com/users/deep-teliacompany/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deep-teliacompany/subscriptions","organizations_url":"https://api.github.com/users/deep-teliacompany/orgs","repos_url":"https://api.github.com/users/deep-teliacompany/repos","events_url":"https://api.github.com/users/deep-teliacompany/events{/privacy}","received_events_url":"https://api.github.com/users/deep-teliacompany/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T20:08:26Z","updated_at":"2021-09-17T20:08:26Z","author_association":"NONE","body":"if want to run jobs in parallel updaing  update same directory then can try Hoodie locking mechanism- \r\nhttps://hudi.apache.org/docs/concurrency_control/","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922052140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922103526","html_url":"https://github.com/apache/hudi/pull/3659#issuecomment-922103526","issue_url":"https://api.github.com/repos/apache/hudi/issues/3659","id":922103526,"node_id":"IC_kwDOBI7nWM429i7m","user":{"login":"geertjanw","id":5309985,"node_id":"MDQ6VXNlcjUzMDk5ODU=","avatar_url":"https://avatars.githubusercontent.com/u/5309985?v=4","gravatar_id":"","url":"https://api.github.com/users/geertjanw","html_url":"https://github.com/geertjanw","followers_url":"https://api.github.com/users/geertjanw/followers","following_url":"https://api.github.com/users/geertjanw/following{/other_user}","gists_url":"https://api.github.com/users/geertjanw/gists{/gist_id}","starred_url":"https://api.github.com/users/geertjanw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/geertjanw/subscriptions","organizations_url":"https://api.github.com/users/geertjanw/orgs","repos_url":"https://api.github.com/users/geertjanw/repos","events_url":"https://api.github.com/users/geertjanw/events{/privacy}","received_events_url":"https://api.github.com/users/geertjanw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-17T21:58:27Z","updated_at":"2021-09-17T21:58:27Z","author_association":"MEMBER","body":"For sure, will provide a new pull request.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922103526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922227113","html_url":"https://github.com/apache/hudi/pull/3686#issuecomment-922227113","issue_url":"https://api.github.com/repos/apache/hudi/issues/3686","id":922227113,"node_id":"IC_kwDOBI7nWM42-BGp","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T06:45:36Z","updated_at":"2021-09-18T14:23:11Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"ee24afb6bafbb7e1b55765f3d75574c1ae83a31a\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2282\",\n    \"triggerID\" : \"ee24afb6bafbb7e1b55765f3d75574c1ae83a31a\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"9db7b072ba2854bf4936553a77fa59c3d01ffa62\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2284\",\n    \"triggerID\" : \"9db7b072ba2854bf4936553a77fa59c3d01ffa62\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"1c822f1233e3615a851248bceaba2c564f6b3606\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2286\",\n    \"triggerID\" : \"1c822f1233e3615a851248bceaba2c564f6b3606\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"b45ab2f60907c4ea95b68d46ad3f5807af09ad54\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2287\",\n    \"triggerID\" : \"b45ab2f60907c4ea95b68d46ad3f5807af09ad54\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"76a7c8144cfc59430b37e7338e4b54af6793235d\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2288\",\n    \"triggerID\" : \"76a7c8144cfc59430b37e7338e4b54af6793235d\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"a9e002e9a59f0ebecffd8eb994cb7a6f27aa9048\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2289\",\n    \"triggerID\" : \"a9e002e9a59f0ebecffd8eb994cb7a6f27aa9048\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* a9e002e9a59f0ebecffd8eb994cb7a6f27aa9048 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2289) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922227113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922231621","html_url":"https://github.com/apache/hudi/pull/3687#issuecomment-922231621","issue_url":"https://api.github.com/repos/apache/hudi/issues/3687","id":922231621,"node_id":"IC_kwDOBI7nWM42-CNF","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T07:20:08Z","updated_at":"2021-09-26T04:07:22Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"4e82a56014054b002006e4e7fa4879ecd6b7351a\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2283\",\n    \"triggerID\" : \"4e82a56014054b002006e4e7fa4879ecd6b7351a\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"04325b06460c57dd05cf7432daaf5e5d8557bb15\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2296\",\n    \"triggerID\" : \"04325b06460c57dd05cf7432daaf5e5d8557bb15\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"c27b13f2e93c25ed73599a3738a79117b5979406\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2297\",\n    \"triggerID\" : \"c27b13f2e93c25ed73599a3738a79117b5979406\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"8bf69f434d26957422054d1ad2ab40db22c8dbcb\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2339\",\n    \"triggerID\" : \"8bf69f434d26957422054d1ad2ab40db22c8dbcb\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"e99345eab2e19026bfb344b5679031127a45ee15\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2340\",\n    \"triggerID\" : \"e99345eab2e19026bfb344b5679031127a45ee15\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"e99345eab2e19026bfb344b5679031127a45ee15\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2359\",\n    \"triggerID\" : \"926278188\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"e99345eab2e19026bfb344b5679031127a45ee15\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2396\",\n    \"triggerID\" : \"927222084\",\n    \"triggerType\" : \"MANUAL\"\n  } ]\n}-->\n## CI report:\n\n* e99345eab2e19026bfb344b5679031127a45ee15 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2340) Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2359) Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2396) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922231621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922240546","html_url":"https://github.com/apache/hudi/issues/3647#issuecomment-922240546","issue_url":"https://api.github.com/repos/apache/hudi/issues/3647","id":922240546,"node_id":"IC_kwDOBI7nWM42-EYi","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T08:29:51Z","updated_at":"2021-09-18T08:29:51Z","author_association":"CONTRIBUTOR","body":"This is because the Spark bulk insert use Spark's parquet writer which has its own decimal encode, how do you set up the parameter writelegacyformat ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922240546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922241477","html_url":"https://github.com/apache/hudi/issues/3680#issuecomment-922241477","issue_url":"https://api.github.com/repos/apache/hudi/issues/3680","id":922241477,"node_id":"IC_kwDOBI7nWM42-EnF","user":{"login":"zhouhongyu888","id":59045547,"node_id":"MDQ6VXNlcjU5MDQ1NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/59045547?v=4","gravatar_id":"","url":"https://api.github.com/users/zhouhongyu888","html_url":"https://github.com/zhouhongyu888","followers_url":"https://api.github.com/users/zhouhongyu888/followers","following_url":"https://api.github.com/users/zhouhongyu888/following{/other_user}","gists_url":"https://api.github.com/users/zhouhongyu888/gists{/gist_id}","starred_url":"https://api.github.com/users/zhouhongyu888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhouhongyu888/subscriptions","organizations_url":"https://api.github.com/users/zhouhongyu888/orgs","repos_url":"https://api.github.com/users/zhouhongyu888/repos","events_url":"https://api.github.com/users/zhouhongyu888/events{/privacy}","received_events_url":"https://api.github.com/users/zhouhongyu888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T08:37:16Z","updated_at":"2021-09-18T08:37:16Z","author_association":"NONE","body":"> Hi, here is the doc how you can sync the hive: https://www.yuque.com/docs/share/01c98494-a980-414c-9c45-152023bf3c17?#IsoNU\r\n> \r\n> 1. You may need to modify the hive dependency version as what you are using\r\n> 2. You need to add the hive profile\r\n\r\nHi, I have done as what you said above,  but  another error appeared:\r\n\r\n_2021-09-18 16:23:22,723 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DeclarativeSlotManager [] - Clearing resource requirements of job e211f6a0afcc69363a6b9915b367a3d5\r\n2021-09-18 16:23:22,722 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job insert-into_default_catalog.default_database.t10 (e211f6a0afcc69363a6b9915b367a3d5) switched from state FAILING to FAILED.\r\norg.apache.flink.runtime.JobException: Recovery is suppressed by NoRestartBackoffTimeStrategy\r\n\tat org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.handleFailure(ExecutionFailureHandler.java:138) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.getFailureHandlingResult(ExecutionFailureHandler.java:82) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.scheduler.DefaultScheduler.handleTaskFailure(DefaultScheduler.java:207) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.scheduler.DefaultScheduler.maybeHandleTaskFailure(DefaultScheduler.java:197) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.scheduler.DefaultScheduler.updateTaskExecutionStateInternal(DefaultScheduler.java:188) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.scheduler.SchedulerBase.updateTaskExecutionState(SchedulerBase.java:677) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.scheduler.SchedulerNG.updateTaskExecutionState(SchedulerNG.java:79) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.jobmaster.JobMaster.updateTaskExecutionState(JobMaster.java:435) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat sun.reflect.GeneratedMethodAccessor16.invoke(Unknown Source) ~[?:?]\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_144]\r\n\tat java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_144]\r\n\tat org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcInvocation(AkkaRpcActor.java:305) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:212) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:77) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:158) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat scala.PartialFunction.applyOrElse(PartialFunction.scala:123) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat scala.PartialFunction.applyOrElse$(PartialFunction.scala:122) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:172) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:172) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.actor.Actor.aroundReceive(Actor.scala:517) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.actor.Actor.aroundReceive$(Actor.scala:515) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.actor.ActorCell.receiveMessage(ActorCell.scala:592) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.actor.ActorCell.invoke(ActorCell.scala:561) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.dispatch.Mailbox.run(Mailbox.scala:225) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.dispatch.Mailbox.exec(Mailbox.scala:235) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107) [flink-dist_2.12-1.13.1.jar:1.13.1]\r\nCaused by: java.lang.ClassCastException: org.apache.hudi.common.fs.HoodieWrapperFileSystem cannot be cast to org.apache.hudi.common.fs.HoodieWrapperFileSystem\r\n\tat org.apache.hudi.io.storage.HoodieParquetWriter.<init>(HoodieParquetWriter.java:63) ~[?:?]\r\n\tat org.apache.hudi.io.storage.HoodieFileWriterFactory.newParquetFileWriter(HoodieFileWriterFactory.java:76) ~[?:?]\r\n\tat org.apache.hudi.io.storage.HoodieFileWriterFactory.newParquetFileWriter(HoodieFileWriterFactory.java:63) ~[?:?]\r\n\tat org.apache.hudi.io.storage.HoodieFileWriterFactory.getFileWriter(HoodieFileWriterFactory.java:49) ~[?:?]\r\n\tat org.apache.hudi.io.HoodieCreateHandle.<init>(HoodieCreateHandle.java:101) ~[?:?]\r\n\tat org.apache.hudi.io.HoodieCreateHandle.<init>(HoodieCreateHandle.java:81) ~[?:?]\r\n\tat org.apache.hudi.io.FlinkCreateHandle.<init>(FlinkCreateHandle.java:67) ~[?:?]\r\n\tat org.apache.hudi.io.FlinkCreateHandle.<init>(FlinkCreateHandle.java:60) ~[?:?]\r\n\tat org.apache.hudi.client.HoodieFlinkWriteClient.getOrCreateWriteHandle(HoodieFlinkWriteClient.java:470) ~[?:?]\r\n\tat org.apache.hudi.client.HoodieFlinkWriteClient.upsert(HoodieFlinkWriteClient.java:149) ~[?:?]\r\n\tat org.apache.hudi.sink.StreamWriteFunction.lambda$initWriteFunction$1(StreamWriteFunction.java:184) ~[?:?]\r\n\tat org.apache.hudi.sink.StreamWriteFunction.lambda$flushRemaining$7(StreamWriteFunction.java:460) ~[?:?]\r\n\tat java.util.LinkedHashMap$LinkedValues.forEach(LinkedHashMap.java:608) ~[?:1.8.0_144]\r\n\tat org.apache.hudi.sink.StreamWriteFunction.flushRemaining(StreamWriteFunction.java:453) ~[?:?]\r\n\tat org.apache.hudi.sink.StreamWriteFunction.endInput(StreamWriteFunction.java:150) ~[?:?]\r\n\tat org.apache.hudi.sink.common.AbstractWriteOperator.endInput(AbstractWriteOperator.java:48) ~[?:?]\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.endOperatorInput(StreamOperatorWrapper.java:91) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.streaming.runtime.tasks.OperatorChain.endInput(OperatorChain.java:423) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.processInput(StreamOneInputProcessor.java:69) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.processInput(StreamTask.java:423) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:204) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:681) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.executeInvoke(StreamTask.java:636) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.runWithCleanUpOnFail(StreamTask.java:647) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:620) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:779) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat org.apache.flink.runtime.taskmanager.Task.run(Task.java:566) ~[flink-dist_2.12-1.13.1.jar:1.13.1]\r\n\tat java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_144]\r\n2021-09-18 16:23:22,729 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Stopping checkpoint coordinator for job e211f6a0afcc69363a6b9915b367a3d5._\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922241477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922242162","html_url":"https://github.com/apache/hudi/issues/3688#issuecomment-922242162","issue_url":"https://api.github.com/repos/apache/hudi/issues/3688","id":922242162,"node_id":"IC_kwDOBI7nWM42-Exy","user":{"login":"xuzifu666","id":10645422,"node_id":"MDQ6VXNlcjEwNjQ1NDIy","avatar_url":"https://avatars.githubusercontent.com/u/10645422?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzifu666","html_url":"https://github.com/xuzifu666","followers_url":"https://api.github.com/users/xuzifu666/followers","following_url":"https://api.github.com/users/xuzifu666/following{/other_user}","gists_url":"https://api.github.com/users/xuzifu666/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzifu666/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzifu666/subscriptions","organizations_url":"https://api.github.com/users/xuzifu666/orgs","repos_url":"https://api.github.com/users/xuzifu666/repos","events_url":"https://api.github.com/users/xuzifu666/events{/privacy}","received_events_url":"https://api.github.com/users/xuzifu666/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T08:42:31Z","updated_at":"2021-09-18T08:42:31Z","author_association":"MEMBER","body":"@xushiyan  @nsivabalan ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922242162/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922242304","html_url":"https://github.com/apache/hudi/issues/3688#issuecomment-922242304","issue_url":"https://api.github.com/repos/apache/hudi/issues/3688","id":922242304,"node_id":"IC_kwDOBI7nWM42-E0A","user":{"login":"xuzifu666","id":10645422,"node_id":"MDQ6VXNlcjEwNjQ1NDIy","avatar_url":"https://avatars.githubusercontent.com/u/10645422?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzifu666","html_url":"https://github.com/xuzifu666","followers_url":"https://api.github.com/users/xuzifu666/followers","following_url":"https://api.github.com/users/xuzifu666/following{/other_user}","gists_url":"https://api.github.com/users/xuzifu666/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzifu666/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzifu666/subscriptions","organizations_url":"https://api.github.com/users/xuzifu666/orgs","repos_url":"https://api.github.com/users/xuzifu666/repos","events_url":"https://api.github.com/users/xuzifu666/events{/privacy}","received_events_url":"https://api.github.com/users/xuzifu666/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T08:43:34Z","updated_at":"2021-09-18T08:43:34Z","author_association":"MEMBER","body":"the problem about metadata table upsert is need resolve, data record key is not \"\" or null ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922242304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922247348","html_url":"https://github.com/apache/hudi/issues/3680#issuecomment-922247348","issue_url":"https://api.github.com/repos/apache/hudi/issues/3680","id":922247348,"node_id":"IC_kwDOBI7nWM42-GC0","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T09:22:58Z","updated_at":"2021-09-18T09:22:58Z","author_association":"CONTRIBUTOR","body":"> > Hi, here is the doc how you can sync the hive: https://www.yuque.com/docs/share/01c98494-a980-414c-9c45-152023bf3c17?#IsoNU\r\n> > \r\n> > 1. You may need to modify the hive dependency version as what you are using\r\n> > 2. You need to add the hive profile\r\n> \r\n> Hi, I have done as what you said above, but another error appeared:\r\n> \r\n> _2021-09-18 16:23:22,723 INFO org.apache.flink.runtime.resourcemanager.slotmanager.DeclarativeSlotManager [] - Clearing resource requirements of job e211f6a0afcc69363a6b9915b367a3d5 2021-09-18 16:23:22,722 INFO org.apache.flink.runtime.executiongraph.ExecutionGraph [] - Job insert-into_default_catalog.default_database.t10 (e211f6a0afcc69363a6b9915b367a3d5) switched from state FAILING to FAILED. org.apache.flink.runtime.JobException: Recovery is suppressed by NoRestartBackoffTimeStrategy at org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.handleFailure(ExecutionFailureHandler.java:138) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.getFailureHandlingResult(ExecutionFailureHandler.java:82) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.scheduler.DefaultScheduler.handleTaskFailure(DefaultScheduler.java:207) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.scheduler.DefaultScheduler.maybeHandleTaskFailure(DefaultScheduler.java:197) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.scheduler.DefaultScheduler.updateTaskExecutionStateInternal(DefaultScheduler.java:188) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.scheduler.SchedulerBase.updateTaskExecutionState(SchedulerBase.java:677) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.scheduler.SchedulerNG.updateTaskExecutionState(SchedulerNG.java:79) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.jobmaster.JobMaster.updateTaskExecutionState(JobMaster.java:435) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at sun.reflect.GeneratedMethodAccessor16.invoke(Unknown Source) ~[?:?] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_144] at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_144] at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcInvocation(AkkaRpcActor.java:305) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:212) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:77) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:158) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21) [flink-dist_2.12-1.13.1.jar:1.13.1] at scala.PartialFunction.applyOrElse(PartialFunction.scala:123) [flink-dist_2.12-1.13.1.jar:1.13.1] at scala.PartialFunction.applyOrElse$(PartialFunction.scala:122) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21) [flink-dist_2.12-1.13.1.jar:1.13.1] at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171) [flink-dist_2.12-1.13.1.jar:1.13.1] at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:172) [flink-dist_2.12-1.13.1.jar:1.13.1] at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:172) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.actor.Actor.aroundReceive(Actor.scala:517) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.actor.Actor.aroundReceive$(Actor.scala:515) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.actor.ActorCell.receiveMessage(ActorCell.scala:592) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.actor.ActorCell.invoke(ActorCell.scala:561) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.dispatch.Mailbox.run(Mailbox.scala:225) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.dispatch.Mailbox.exec(Mailbox.scala:235) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979) [flink-dist_2.12-1.13.1.jar:1.13.1] at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107) [flink-dist_2.12-1.13.1.jar:1.13.1] Caused by: java.lang.ClassCastException: org.apache.hudi.common.fs.HoodieWrapperFileSystem cannot be cast to org.apache.hudi.common.fs.HoodieWrapperFileSystem at org.apache.hudi.io.storage.HoodieParquetWriter.(HoodieParquetWriter.java:63) ~[?:?] at org.apache.hudi.io.storage.HoodieFileWriterFactory.newParquetFileWriter(HoodieFileWriterFactory.java:76) ~[?:?] at org.apache.hudi.io.storage.HoodieFileWriterFactory.newParquetFileWriter(HoodieFileWriterFactory.java:63) ~[?:?] at org.apache.hudi.io.storage.HoodieFileWriterFactory.getFileWriter(HoodieFileWriterFactory.java:49) ~[?:?] at org.apache.hudi.io.HoodieCreateHandle.(HoodieCreateHandle.java:101) ~[?:?] at org.apache.hudi.io.HoodieCreateHandle.(HoodieCreateHandle.java:81) ~[?:?] at org.apache.hudi.io.FlinkCreateHandle.(FlinkCreateHandle.java:67) ~[?:?] at org.apache.hudi.io.FlinkCreateHandle.(FlinkCreateHandle.java:60) ~[?:?] at org.apache.hudi.client.HoodieFlinkWriteClient.getOrCreateWriteHandle(HoodieFlinkWriteClient.java:470) ~[?:?] at org.apache.hudi.client.HoodieFlinkWriteClient.upsert(HoodieFlinkWriteClient.java:149) ~[?:?] at org.apache.hudi.sink.StreamWriteFunction.lambda$initWriteFunction$1(StreamWriteFunction.java:184) ~[?:?] at org.apache.hudi.sink.StreamWriteFunction.lambda$flushRemaining$7(StreamWriteFunction.java:460) ~[?:?] at java.util.LinkedHashMap$LinkedValues.forEach(LinkedHashMap.java:608) ~[?:1.8.0_144] at org.apache.hudi.sink.StreamWriteFunction.flushRemaining(StreamWriteFunction.java:453) ~[?:?] at org.apache.hudi.sink.StreamWriteFunction.endInput(StreamWriteFunction.java:150) ~[?:?] at org.apache.hudi.sink.common.AbstractWriteOperator.endInput(AbstractWriteOperator.java:48) ~[?:?] at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.endOperatorInput(StreamOperatorWrapper.java:91) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.streaming.runtime.tasks.OperatorChain.endInput(OperatorChain.java:423) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.processInput(StreamOneInputProcessor.java:69) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.streaming.runtime.tasks.StreamTask.processInput(StreamTask.java:423) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:204) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:681) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.streaming.runtime.tasks.StreamTask.executeInvoke(StreamTask.java:636) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.streaming.runtime.tasks.StreamTask.runWithCleanUpOnFail(StreamTask.java:647) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:620) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:779) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at org.apache.flink.runtime.taskmanager.Task.run(Task.java:566) ~[flink-dist_2.12-1.13.1.jar:1.13.1] at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_144] 2021-09-18 16:23:22,729 INFO org.apache.flink.runtime.checkpoint.CheckpointCoordinator [] - Stopping checkpoint coordinator for job e211f6a0afcc69363a6b9915b367a3d5._\r\n\r\nThis is the classloader problem, what version did you use, you may need to copy the jar into flink lib, and in master branch and 0.9.0 cherry pick branch we have fixed the problem.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922247348/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922247449","html_url":"https://github.com/apache/hudi/pull/3668#issuecomment-922247449","issue_url":"https://api.github.com/repos/apache/hudi/issues/3668","id":922247449,"node_id":"IC_kwDOBI7nWM42-GEZ","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T09:23:49Z","updated_at":"2021-09-18T09:23:49Z","author_association":"CONTRIBUTOR","body":"@leesf @codope @bvaradar   update the code , add docs to all public method, and resolved most comments.  pls help me review those code again.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922247449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922251982","html_url":"https://github.com/apache/hudi/issues/3647#issuecomment-922251982","issue_url":"https://api.github.com/repos/apache/hudi/issues/3647","id":922251982,"node_id":"IC_kwDOBI7nWM42-HLO","user":{"login":"novakov-alexey-zz","id":11204284,"node_id":"MDQ6VXNlcjExMjA0Mjg0","avatar_url":"https://avatars.githubusercontent.com/u/11204284?v=4","gravatar_id":"","url":"https://api.github.com/users/novakov-alexey-zz","html_url":"https://github.com/novakov-alexey-zz","followers_url":"https://api.github.com/users/novakov-alexey-zz/followers","following_url":"https://api.github.com/users/novakov-alexey-zz/following{/other_user}","gists_url":"https://api.github.com/users/novakov-alexey-zz/gists{/gist_id}","starred_url":"https://api.github.com/users/novakov-alexey-zz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/novakov-alexey-zz/subscriptions","organizations_url":"https://api.github.com/users/novakov-alexey-zz/orgs","repos_url":"https://api.github.com/users/novakov-alexey-zz/repos","events_url":"https://api.github.com/users/novakov-alexey-zz/events{/privacy}","received_events_url":"https://api.github.com/users/novakov-alexey-zz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T09:59:54Z","updated_at":"2021-09-18T09:59:54Z","author_association":"NONE","body":"In my case, this issue can be workaround to use insert operation instead of bulk-insert. \r\nShould not Hudi bulk-insert and insert operations be consistent in what they use and how they write Parquet data under the hood?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922251982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922254701","html_url":"https://github.com/apache/hudi/pull/3622#issuecomment-922254701","issue_url":"https://api.github.com/repos/apache/hudi/issues/3622","id":922254701,"node_id":"IC_kwDOBI7nWM42-H1t","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T10:21:37Z","updated_at":"2021-09-18T10:21:37Z","author_association":"CONTRIBUTOR","body":"> 1. Perform Kerberos authentication on the client\r\n\r\nHow can we do that ? What do you mean by the client ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922254701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922256804","html_url":"https://github.com/apache/hudi/pull/3203#issuecomment-922256804","issue_url":"https://api.github.com/repos/apache/hudi/issues/3203","id":922256804,"node_id":"IC_kwDOBI7nWM42-IWk","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T10:39:45Z","updated_at":"2021-09-18T10:39:45Z","author_association":"CONTRIBUTOR","body":"Hi, can we push this PR forward, this is important because the global index table can not query through Hive, which is a critical bug.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922256804/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":2},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922282821","html_url":"https://github.com/apache/hudi/issues/3581#issuecomment-922282821","issue_url":"https://api.github.com/repos/apache/hudi/issues/3581","id":922282821,"node_id":"IC_kwDOBI7nWM42-OtF","user":{"login":"codejoyan","id":48707638,"node_id":"MDQ6VXNlcjQ4NzA3NjM4","avatar_url":"https://avatars.githubusercontent.com/u/48707638?v=4","gravatar_id":"","url":"https://api.github.com/users/codejoyan","html_url":"https://github.com/codejoyan","followers_url":"https://api.github.com/users/codejoyan/followers","following_url":"https://api.github.com/users/codejoyan/following{/other_user}","gists_url":"https://api.github.com/users/codejoyan/gists{/gist_id}","starred_url":"https://api.github.com/users/codejoyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codejoyan/subscriptions","organizations_url":"https://api.github.com/users/codejoyan/orgs","repos_url":"https://api.github.com/users/codejoyan/repos","events_url":"https://api.github.com/users/codejoyan/events{/privacy}","received_events_url":"https://api.github.com/users/codejoyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T14:17:36Z","updated_at":"2021-09-18T14:24:08Z","author_association":"CONTRIBUTOR","body":"Thanks for the response @umehrot2 and @xushiyan . I am using 0.9.0 but still observing `Listing leaf files and directories` even after making the changes you suggested. Below are the code snippet and Spark UI details:\r\n\r\n```\r\nscala> import org.apache.hudi.DataSourceReadOptions\r\nimport org.apache.hudi.DataSourceReadOptions\r\n\r\nscala> spark.sql(\"SET hoodie.metadata.enable=true\")\r\nres0: org.apache.spark.sql.DataFrame = [key: string, value: string]\r\n\r\nscala> spark.sql(\"SET hoodie.metadata.metrics.enable=true\")\r\nres1: org.apache.spark.sql.DataFrame = [key: string, value: string]\r\n\r\nscala> spark.time(spark.read.format(\"hudi\").option(\"hoodie.file.index.enable\", \"true\").load(\"gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v3/*/*/*\"))\r\n21/09/18 14:13:24 WARN org.apache.spark.sql.execution.datasources.SharedInMemoryCache: Evicting cached table partition metadata from memory due to size constraints (spark.sql.hive.filesourcePartitionFileCacheSize = 262144000 bytes). This may impact query planning performance.\r\nTime taken: 144686 ms\r\nres2: org.apache.spark.sql.DataFrame = [_hoodie_commit_time: string, _hoodie_commit_seqno: string ... 124 more fields]\r\n```\r\nCorresponding stage details on Spark UI for the above command:\r\n<img width=\"1715\" alt=\"Screenshot 2021-09-18 at 7 46 45 PM\" src=\"https://user-images.githubusercontent.com/48707638/133891815-d0a025a0-a51d-46d0-9589-306082287e35.png\">\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922282821/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922326982","html_url":"https://github.com/apache/hudi/issues/3572#issuecomment-922326982","issue_url":"https://api.github.com/repos/apache/hudi/issues/3572","id":922326982,"node_id":"IC_kwDOBI7nWM42-ZfG","user":{"login":"niloo-sh","id":15998136,"node_id":"MDQ6VXNlcjE1OTk4MTM2","avatar_url":"https://avatars.githubusercontent.com/u/15998136?v=4","gravatar_id":"","url":"https://api.github.com/users/niloo-sh","html_url":"https://github.com/niloo-sh","followers_url":"https://api.github.com/users/niloo-sh/followers","following_url":"https://api.github.com/users/niloo-sh/following{/other_user}","gists_url":"https://api.github.com/users/niloo-sh/gists{/gist_id}","starred_url":"https://api.github.com/users/niloo-sh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niloo-sh/subscriptions","organizations_url":"https://api.github.com/users/niloo-sh/orgs","repos_url":"https://api.github.com/users/niloo-sh/repos","events_url":"https://api.github.com/users/niloo-sh/events{/privacy}","received_events_url":"https://api.github.com/users/niloo-sh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T15:16:54Z","updated_at":"2021-09-18T15:16:54Z","author_association":"NONE","body":"@vinothchandar I use intellij IDE, add libraryDependencies += \"org.apache.hudi\" %% \"hudi-spark-bundle\" % \"0.6.0\" in build.sbt and get this error :\r\nException in thread \"main\" java.lang.NoClassDefFoundError: org/apache/hadoop/hive/conf/HiveConf\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.org$apache$hudi$HoodieSparkSqlWriter$$syncHive(HoodieSparkSqlWriter.scala:319)\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922326982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922375568","html_url":"https://github.com/apache/hudi/issues/3676#issuecomment-922375568","issue_url":"https://api.github.com/repos/apache/hudi/issues/3676","id":922375568,"node_id":"IC_kwDOBI7nWM42-lWQ","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-18T21:21:19Z","updated_at":"2021-09-18T21:21:37Z","author_association":"CONTRIBUTOR","body":"I see you have very aggressive cleaner and archival commits to retain. Can you leave it to default and try it out.\r\n```\r\n'hoodie.cleaner.commits.retained': 1,\r\n\"hoodie.keep.min.commits\": 2,\r\n```\r\nmay be we can deduce if cleaner/archival interplays w/ small file handling.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922375568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922402354","html_url":"https://github.com/apache/hudi/issues/3689#issuecomment-922402354","issue_url":"https://api.github.com/repos/apache/hudi/issues/3689","id":922402354,"node_id":"IC_kwDOBI7nWM42-r4y","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-19T02:00:39Z","updated_at":"2021-09-19T02:00:39Z","author_association":"CONTRIBUTOR","body":"Hi, you may need to use the 0.9.0 with flink 1.12.2 or master with flink 1.13.1. You also need to open the checkpoint.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922402354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922406636","html_url":"https://github.com/apache/hudi/issues/3676#issuecomment-922406636","issue_url":"https://api.github.com/repos/apache/hudi/issues/3676","id":922406636,"node_id":"IC_kwDOBI7nWM42-s7s","user":{"login":"FelixKJose","id":22526075,"node_id":"MDQ6VXNlcjIyNTI2MDc1","avatar_url":"https://avatars.githubusercontent.com/u/22526075?v=4","gravatar_id":"","url":"https://api.github.com/users/FelixKJose","html_url":"https://github.com/FelixKJose","followers_url":"https://api.github.com/users/FelixKJose/followers","following_url":"https://api.github.com/users/FelixKJose/following{/other_user}","gists_url":"https://api.github.com/users/FelixKJose/gists{/gist_id}","starred_url":"https://api.github.com/users/FelixKJose/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FelixKJose/subscriptions","organizations_url":"https://api.github.com/users/FelixKJose/orgs","repos_url":"https://api.github.com/users/FelixKJose/repos","events_url":"https://api.github.com/users/FelixKJose/events{/privacy}","received_events_url":"https://api.github.com/users/FelixKJose/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-19T02:49:26Z","updated_at":"2021-09-19T02:49:26Z","author_association":"NONE","body":"I have tried to set those two configs to default but I am having the same behavior (10MB)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922406636/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922412247","html_url":"https://github.com/apache/hudi/issues/3581#issuecomment-922412247","issue_url":"https://api.github.com/repos/apache/hudi/issues/3581","id":922412247,"node_id":"IC_kwDOBI7nWM42-uTX","user":{"login":"xushiyan","id":2701446,"node_id":"MDQ6VXNlcjI3MDE0NDY=","avatar_url":"https://avatars.githubusercontent.com/u/2701446?v=4","gravatar_id":"","url":"https://api.github.com/users/xushiyan","html_url":"https://github.com/xushiyan","followers_url":"https://api.github.com/users/xushiyan/followers","following_url":"https://api.github.com/users/xushiyan/following{/other_user}","gists_url":"https://api.github.com/users/xushiyan/gists{/gist_id}","starred_url":"https://api.github.com/users/xushiyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xushiyan/subscriptions","organizations_url":"https://api.github.com/users/xushiyan/orgs","repos_url":"https://api.github.com/users/xushiyan/repos","events_url":"https://api.github.com/users/xushiyan/events{/privacy}","received_events_url":"https://api.github.com/users/xushiyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-19T04:10:12Z","updated_at":"2021-09-19T04:11:03Z","author_association":"MEMBER","body":"@codejoyan after diving into the code, i saw the logic to enable HoodieFileIndex, which we should have clearly stated somewhere in the docs. Please try loading the dataset without glob path, like reading from `\"gs://udp-hudi-storage3/store_visit_scan_hudi_spark_3_tgt_v3\"`. Also to make sure partition pruning works, can you see if your `hoodie.properties` file contains `hoodie.table.partition.fields= cntry,part_date` ? If not, please add it manually there. Let us know how it works for you.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922412247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922419073","html_url":"https://github.com/apache/hudi/pull/3691#issuecomment-922419073","issue_url":"https://api.github.com/repos/apache/hudi/issues/3691","id":922419073,"node_id":"IC_kwDOBI7nWM42-v-B","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-19T05:44:56Z","updated_at":"2021-09-19T06:27:59Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"575b8598e500d51cbc6c8b10312498af84e4967a\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2292\",\n    \"triggerID\" : \"575b8598e500d51cbc6c8b10312498af84e4967a\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 575b8598e500d51cbc6c8b10312498af84e4967a Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=2292) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run travis` re-run the last Travis build\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922419073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922421084","html_url":"https://github.com/apache/hudi/pull/3203#issuecomment-922421084","issue_url":"https://api.github.com/repos/apache/hudi/issues/3203","id":922421084,"node_id":"IC_kwDOBI7nWM42-wdc","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-19T06:07:49Z","updated_at":"2021-09-19T06:07:49Z","author_association":"CONTRIBUTOR","body":"@danny0405  Thank you for your attention to this pr。 This pr has not been updated for a long time. Do we still need this now？","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922421084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922423975","html_url":"https://github.com/apache/hudi/pull/3691#issuecomment-922423975","issue_url":"https://api.github.com/repos/apache/hudi/issues/3691","id":922423975,"node_id":"IC_kwDOBI7nWM42-xKn","user":{"login":"YannByron","id":10036681,"node_id":"MDQ6VXNlcjEwMDM2Njgx","avatar_url":"https://avatars.githubusercontent.com/u/10036681?v=4","gravatar_id":"","url":"https://api.github.com/users/YannByron","html_url":"https://github.com/YannByron","followers_url":"https://api.github.com/users/YannByron/followers","following_url":"https://api.github.com/users/YannByron/following{/other_user}","gists_url":"https://api.github.com/users/YannByron/gists{/gist_id}","starred_url":"https://api.github.com/users/YannByron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannByron/subscriptions","organizations_url":"https://api.github.com/users/YannByron/orgs","repos_url":"https://api.github.com/users/YannByron/repos","events_url":"https://api.github.com/users/YannByron/events{/privacy}","received_events_url":"https://api.github.com/users/YannByron/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-19T06:43:01Z","updated_at":"2021-09-19T06:43:01Z","author_association":"CONTRIBUTOR","body":"@nsivabalan can you help to run workflows?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922423975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922441246","html_url":"https://github.com/apache/hudi/issues/3555#issuecomment-922441246","issue_url":"https://api.github.com/repos/apache/hudi/issues/3555","id":922441246,"node_id":"IC_kwDOBI7nWM42-1Ye","user":{"login":"YannByron","id":10036681,"node_id":"MDQ6VXNlcjEwMDM2Njgx","avatar_url":"https://avatars.githubusercontent.com/u/10036681?v=4","gravatar_id":"","url":"https://api.github.com/users/YannByron","html_url":"https://github.com/YannByron","followers_url":"https://api.github.com/users/YannByron/followers","following_url":"https://api.github.com/users/YannByron/following{/other_user}","gists_url":"https://api.github.com/users/YannByron/gists{/gist_id}","starred_url":"https://api.github.com/users/YannByron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannByron/subscriptions","organizations_url":"https://api.github.com/users/YannByron/orgs","repos_url":"https://api.github.com/users/YannByron/repos","events_url":"https://api.github.com/users/YannByron/events{/privacy}","received_events_url":"https://api.github.com/users/YannByron/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-19T09:10:36Z","updated_at":"2021-09-22T17:04:26Z","author_association":"CONTRIBUTOR","body":"jira to show partitions: https://issues.apache.org/jira/browse/HUDI-2456","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922441246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922508543","html_url":"https://github.com/apache/hudi/issues/3676#issuecomment-922508543","issue_url":"https://api.github.com/repos/apache/hudi/issues/3676","id":922508543,"node_id":"IC_kwDOBI7nWM42_Fz_","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-19T17:27:43Z","updated_at":"2021-09-19T17:27:43Z","author_association":"CONTRIBUTOR","body":"I found the rootcause. Looks like in MOR, when an index is used which cannot index log files (which is the case for all out of box indexes in hudi), we just choose the smallest parquet file for every commit. So, over time, every file will grow to become fullest is the idea here. \r\n\r\nsource [link](https://github.com/apache/hudi/blob/3354fac42f9a2c4dbc8ac73ca4749160e9b9459b/hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/deltacommit/SparkUpsertDeltaCommitPartitioner.java#L66)\r\n\r\n@vinothchandar : do you know whats the reason here. my understanding is that, new inserts will not go into delta logs at all and only updates go into delta logs. If this statement is true, we don't need to do special handling if HoodieIndex can index log files or not. \r\nOr am I missing something here. \r\n\r\n@FelixKJose : So, if you keep adding more and more commits, each parquet data file will slowly grow to get to its full size. just that for one commit, only one base file per partition will be chosen. \r\n\r\nAlso, a suggestion wrt some other configs as we are dealing w/ small file handling. do pay attention to [recordsizeestimate](https://hudi.apache.org/docs/configurations#hoodiecopyonwriterecordsizeestimate)  . bcoz, only those files whose size is > ( [recordsizeestimationthreshold](https://hudi.apache.org/docs/configurations#hoodierecordsizeestimationthreshold) * [smallfilelimit](https://hudi.apache.org/docs/configurations#hoodieclusteringplanstrategysmallfilelimit)) will be considered while determining the avg record size. \r\n\r\nTo illustrate w/ an example: \r\nfor first commit, hudi relies on [recordsizeestimate](https://hudi.apache.org/docs/configurations#hoodiecopyonwriterecordsizeestimate ) to pack records into data files. After that, hudi can calculate based on previous commit stats. But even in that, only those files which has some min size threshold will be considered. for eg, as per default values, record size estimation threshold is 1.0 and parquet small file size is 100Mb. and so only those data files whose size is > 100Mb will be looked into to determine avg record size. Until then, hudi just takes the value from [recordsizeestimate](https://hudi.apache.org/docs/configurations#hoodiecopyonwriterecordsizeestimate ). \r\n\r\nSo, for eg, avg record size in your case is 200kb. but you did not set the right value for [recordsizeestimate](https://hudi.apache.org/docs/configurations#hoodiecopyonwriterecordsizeestimate ). So, until there is one data file whose size is > 100Mb, hudi will assume record size as [recordsizeestimate](https://hudi.apache.org/docs/configurations#hoodiecopyonwriterecordsizeestimate ). So, in summary, hudi will keep assuming avg record size as 1024 and assign records to data files based on this estimation. \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922508543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922536416","html_url":"https://github.com/apache/hudi/issues/3581#issuecomment-922536416","issue_url":"https://api.github.com/repos/apache/hudi/issues/3581","id":922536416,"node_id":"IC_kwDOBI7nWM42_Mng","user":{"login":"codejoyan","id":48707638,"node_id":"MDQ6VXNlcjQ4NzA3NjM4","avatar_url":"https://avatars.githubusercontent.com/u/48707638?v=4","gravatar_id":"","url":"https://api.github.com/users/codejoyan","html_url":"https://github.com/codejoyan","followers_url":"https://api.github.com/users/codejoyan/followers","following_url":"https://api.github.com/users/codejoyan/following{/other_user}","gists_url":"https://api.github.com/users/codejoyan/gists{/gist_id}","starred_url":"https://api.github.com/users/codejoyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codejoyan/subscriptions","organizations_url":"https://api.github.com/users/codejoyan/orgs","repos_url":"https://api.github.com/users/codejoyan/repos","events_url":"https://api.github.com/users/codejoyan/events{/privacy}","received_events_url":"https://api.github.com/users/codejoyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-19T21:00:31Z","updated_at":"2021-09-19T21:00:31Z","author_association":"CONTRIBUTOR","body":"It works without the file listing step and is reading from metadata table !!! \r\n@xushiyan Thanks a lot for the solution. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/922536416/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]