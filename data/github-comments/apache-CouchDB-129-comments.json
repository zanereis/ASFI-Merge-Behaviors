[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2090702652","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2090702652","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2090702652,"node_id":"IC_kwDOAAMmUc58nZc8","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-02T14:48:07Z","updated_at":"2024-05-02T14:48:07Z","author_association":"NONE","body":"here's the ab result\r\n\r\n```\r\nDocument Length:        47691 bytes\r\n\r\nConcurrency Level:      10\r\nTime taken for tests:   2219.996 seconds\r\nComplete requests:      100000\r\nFailed requests:        0\r\nTotal transferred:      4792500000 bytes\r\nHTML transferred:       4769100000 bytes\r\nRequests per second:    45.05 [#/sec] (mean)\r\nTime per request:       222.000 [ms] (mean)\r\nTime per request:       22.200 [ms] (mean, across all concurrent requests)\r\nTransfer rate:          2108.19 [Kbytes/sec] received\r\n\r\nConnection Times (ms)\r\n              min  mean[+/-sd] median   max\r\nConnect:       45   54  41.0     52    1089\r\nProcessing:   147  168  28.6    163     854\r\nWaiting:       47   57   7.1     56     361\r\nTotal:        193  222  51.2    216    1650\r\n\r\nPercentage of the requests served within a certain time (ms)\r\n  50%    216\r\n  66%    220\r\n  75%    223\r\n  80%    227\r\n  90%    238\r\n  95%    250\r\n  98%    291\r\n  99%    349\r\n 100%   1650 (longest request)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2090702652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2092882583","html_url":"https://github.com/apache/couchdb/issues/5046#issuecomment-2092882583","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5046","id":2092882583,"node_id":"IC_kwDOAAMmUc58vtqX","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T12:05:31Z","updated_at":"2024-05-03T12:05:31Z","author_association":"MEMBER","body":"We used to validate the `exp` claim if present in the token, regardless of whether it was in `required_claims`, but this turned out to be a spec violation, so we changed to ignore the non-required claims.\r\n\r\n```\r\ncommit 331894a6acb4565c71d800f2e63206101dfbb48c\r\nAuthor: Jay Doane <jaydoane@apache.org>\r\nDate:   Mon Mar 1 13:48:19 2021 -0800\r\n\r\n    Ignore unchecked JWT claims\r\n\r\n    Previously, if a JWT claim was present, it was validated regardless of\r\n    whether it was required.\r\n\r\n    However, according to the spec [1]:\r\n\r\n    \"all claims that are not understood by implementations MUST be ignored\"\r\n\r\n    which we interpret to mean that we should not attempt to validate\r\n    claims we don't require.\r\n\r\n    With this change, only claims listed in required checks are validated.\r\n\r\n    [1] https://tools.ietf.org/html/rfc7519#section-4\r\n```\r\n\r\nI agree with you that `exp` is an important field (along with `nbf`) and there is an argument for it being in the default list of `required_claims`. The current default is an empty list (`alg` and `sub` are required for other reasons, we can't validate without `alg` and without `sub` we wouldn't know which user we'd be authenticating).\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2092882583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2092946341","html_url":"https://github.com/apache/couchdb/issues/5046#issuecomment-2092946341","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5046","id":2092946341,"node_id":"IC_kwDOAAMmUc58v9Ol","user":{"login":"evavica","id":144010478,"node_id":"U_kgDOCJVs7g","avatar_url":"https://avatars.githubusercontent.com/u/144010478?v=4","gravatar_id":"","url":"https://api.github.com/users/evavica","html_url":"https://github.com/evavica","followers_url":"https://api.github.com/users/evavica/followers","following_url":"https://api.github.com/users/evavica/following{/other_user}","gists_url":"https://api.github.com/users/evavica/gists{/gist_id}","starred_url":"https://api.github.com/users/evavica/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/evavica/subscriptions","organizations_url":"https://api.github.com/users/evavica/orgs","repos_url":"https://api.github.com/users/evavica/repos","events_url":"https://api.github.com/users/evavica/events{/privacy}","received_events_url":"https://api.github.com/users/evavica/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T12:45:30Z","updated_at":"2024-05-03T12:45:30Z","author_association":"NONE","body":"Thank you for your quick reply, I agree that sticking to the spec here makes sense. And also to differentiate between claims that are required for the fundamental usability of the tokens by the app (`alg` and `sub`) and those which are important for a properly defined JWT in general. \r\nChanging the default list to one containing `exp` and maybe also `nbf` sounds good to me.  \r\nThat would greatly reduce the risk of people just forgetting about them while still maintaining flexibility.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2092946341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093045782","html_url":"https://github.com/apache/couchdb/issues/5046#issuecomment-2093045782","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5046","id":2093045782,"node_id":"IC_kwDOAAMmUc58wVgW","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T13:39:59Z","updated_at":"2024-05-03T13:39:59Z","author_association":"MEMBER","body":"comparing to another JWT library; \r\n\r\nhttps://github.com/G-Corp/jwerl/blob/6e778543ef7470e9e8ae32700f5e5a8cc25e00a4/src/jwerl.erl#L115\r\n\r\n```\r\ncheck_claim(TokenData, exp, false, fun(ExpireTime) ->\r\n                                            ExpLeeway = proplists:get_value(exp_leeway, Opts, 0),\r\n                                            Now < ExpireTime + ExpLeeway\r\n                                        end, exp),\r\n```\r\n\r\nthat `false` is the `Required` argument of `check_claim`. I'm obviously skimming here but it seems `jwerl` also doesn't check `exp` by default.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093045782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093213507","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2093213507","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2093213507,"node_id":"IC_kwDOAAMmUc58w-dD","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T15:09:44Z","updated_at":"2024-05-03T15:09:44Z","author_association":"NONE","body":"browsing through old issues I found this one, which sounds a lot like our problem:\r\nhttps://github.com/apache/couchdb/issues/1319#issuecomment-388409052\r\nat this point: could this be related to how hyperledger manages connections?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093213507/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093232702","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2093232702","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2093232702,"node_id":"IC_kwDOAAMmUc58xDI-","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T15:20:42Z","updated_at":"2024-05-03T15:20:42Z","author_association":"MEMBER","body":"Hi, yes, it could be. A typical http client would reuse connections (indeed, would manage a pool of them), check that you're doing that first. Otherwise you could possibly use up all possible ports and have to wait for one to become available.\r\n\r\nTry your `ab` command again, but change it to run for longer(either more requests or switch to `-t`) and compare a run with and without the `-k` parameter, which enables http keepalive. The results with `-k` should have much more consistent durations.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093232702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093249143","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2093249143","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2093249143,"node_id":"IC_kwDOAAMmUc58xHJ3","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T15:31:07Z","updated_at":"2024-05-03T15:31:07Z","author_association":"CONTRIBUTOR","body":"With `include_docs=true` tweaking `[fabric] all_docs_concurrency = 10` might have an effect. \r\n\r\nhttps://github.com/apache/couchdb/blob/main/src/fabric/src/fabric_view_all_docs.erl#L297\r\n\r\nThat spawns 10 background workers at the fabric (cluster level) to open 10 documents in parallel, but that puts more work on the cluster. Can try decreasing it or increasing it a bit and see if it changes anything.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093249143/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093282640","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2093282640","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2093282640,"node_id":"IC_kwDOAAMmUc58xPVQ","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T15:52:05Z","updated_at":"2024-05-03T15:52:05Z","author_association":"NONE","body":"> Hi, yes, it could be. A typical http client would reuse connections (indeed, would manage a pool of them), check that you're doing that first. Otherwise you could possibly use up all possible ports and have to wait for one to become available.\r\n> \r\n> Try your `ab` command again, but change it to run for longer(either more requests or switch to `-t`) and compare a run with and without the `-k` parameter, which enables http keepalive. The results with `-k` should have much more consistent durations.\r\n\r\nI tried with `-k` which yield similar results to the yesterday's test. We don't have much we can do with the connections since we're using CouchDB indirectly, through Hyperledger Fabric.\r\n\r\n\r\n> With `include_docs=true` tweaking `[fabric] all_docs_concurrency = 10` might have an effect.\r\n> \r\n> https://github.com/apache/couchdb/blob/main/src/fabric/src/fabric_view_all_docs.erl#L297\r\n> \r\n> That spawns 10 background workers at the fabric (cluster level) to open 10 documents in parallel, but that puts more work on the cluster. Can try decreasing it or increasing it a bit and see if it changes anything.\r\n\r\nwe'll definitely try this!!\r\nthanks","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093282640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093316446","html_url":"https://github.com/apache/couchdb/pull/5045#issuecomment-2093316446","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5045","id":2093316446,"node_id":"IC_kwDOAAMmUc58xXle","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T16:11:41Z","updated_at":"2024-05-03T16:11:41Z","author_association":"CONTRIBUTOR","body":"Hey Nick, thanks for testing. I retried it to and it works for me. I deleted the pip cache to get a fresh download of alle wheels.\r\nMaybe the package wasn't completly downloaded when you run the `setup.bat`?\r\n\r\n```console\r\nC:\\Users\\couchdb\\Documents\\couchdb\\src\\docs>setup.bat && make.bat html\r\nCould Not Find C:\\Users\\couchdb\\Documents\\couchdb\\src\\docs\\.venv\r\nRequirement already satisfied: pip in c:\\users\\couchdb\\documents\\couchdb\\src\\docs\\.venv\\lib\\site-packages (24.0)\r\nCollecting Sphinx==7.2.6 (from -r requirements.txt (line 1))\r\n  Downloading sphinx-7.2.6-py3-none-any.whl.metadata (5.9 kB)\r\nCollecting sphinx-rtd-theme==2.0.0 (from -r requirements.txt (line 2))\r\n  Downloading sphinx_rtd_theme-2.0.0-py2.py3-none-any.whl.metadata (4.4 kB)\r\nCollecting sphinxcontrib-httpdomain==1.8.1 (from -r requirements.txt (line 3))\r\n  Downloading sphinxcontrib_httpdomain-1.8.1-py2.py3-none-any.whl.metadata (2.0 kB)\r\nCollecting sphinxcontrib-jquery==4.1 (from -r requirements.txt (line 4))\r\n  Downloading sphinxcontrib_jquery-4.1-py2.py3-none-any.whl.metadata (2.6 kB)\r\nCollecting sphinx-copybutton==0.5.2 (from -r requirements.txt (line 5))\r\n  Downloading sphinx_copybutton-0.5.2-py3-none-any.whl.metadata (3.2 kB)\r\nCollecting sphinxcontrib-applehelp (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading sphinxcontrib_applehelp-1.0.8-py3-none-any.whl.metadata (2.3 kB)\r\nCollecting sphinxcontrib-devhelp (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading sphinxcontrib_devhelp-1.0.6-py3-none-any.whl.metadata (2.3 kB)\r\nCollecting sphinxcontrib-jsmath (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading sphinxcontrib_jsmath-1.0.1-py2.py3-none-any.whl.metadata (1.4 kB)\r\nCollecting sphinxcontrib-htmlhelp>=2.0.0 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading sphinxcontrib_htmlhelp-2.0.5-py3-none-any.whl.metadata (2.3 kB)\r\nCollecting sphinxcontrib-serializinghtml>=1.1.9 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading sphinxcontrib_serializinghtml-1.1.10-py3-none-any.whl.metadata (2.4 kB)\r\nCollecting sphinxcontrib-qthelp (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading sphinxcontrib_qthelp-1.0.7-py3-none-any.whl.metadata (2.2 kB)\r\nCollecting Jinja2>=3.0 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading Jinja2-3.1.3-py3-none-any.whl.metadata (3.3 kB)\r\nCollecting Pygments>=2.14 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading pygments-2.17.2-py3-none-any.whl.metadata (2.6 kB)\r\nCollecting docutils<0.21,>=0.18.1 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading docutils-0.20.1-py3-none-any.whl.metadata (2.8 kB)\r\nCollecting snowballstemmer>=2.0 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading snowballstemmer-2.2.0-py2.py3-none-any.whl.metadata (6.5 kB)\r\nCollecting babel>=2.9 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading Babel-2.14.0-py3-none-any.whl.metadata (1.6 kB)\r\nCollecting alabaster<0.8,>=0.7 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading alabaster-0.7.16-py3-none-any.whl.metadata (2.9 kB)\r\nCollecting imagesize>=1.3 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading imagesize-1.4.1-py2.py3-none-any.whl.metadata (1.5 kB)\r\nCollecting requests>=2.25.0 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading requests-2.31.0-py3-none-any.whl.metadata (4.6 kB)\r\nCollecting packaging>=21.0 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading packaging-24.0-py3-none-any.whl.metadata (3.2 kB)\r\nCollecting colorama>=0.4.5 (from Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading colorama-0.4.6-py2.py3-none-any.whl.metadata (17 kB)\r\nCollecting six (from sphinxcontrib-httpdomain==1.8.1->-r requirements.txt (line 3))\r\n  Downloading six-1.16.0-py2.py3-none-any.whl.metadata (1.8 kB)\r\nCollecting MarkupSafe>=2.0 (from Jinja2>=3.0->Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading MarkupSafe-2.1.5-cp311-cp311-win_amd64.whl.metadata (3.1 kB)\r\nCollecting charset-normalizer<4,>=2 (from requests>=2.25.0->Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading charset_normalizer-3.3.2-cp311-cp311-win_amd64.whl.metadata (34 kB)\r\nCollecting idna<4,>=2.5 (from requests>=2.25.0->Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading idna-3.7-py3-none-any.whl.metadata (9.9 kB)\r\nCollecting urllib3<3,>=1.21.1 (from requests>=2.25.0->Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading urllib3-2.2.1-py3-none-any.whl.metadata (6.4 kB)\r\nCollecting certifi>=2017.4.17 (from requests>=2.25.0->Sphinx==7.2.6->-r requirements.txt (line 1))\r\n  Downloading certifi-2024.2.2-py3-none-any.whl.metadata (2.2 kB)\r\nDownloading sphinx-7.2.6-py3-none-any.whl (3.2 MB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.2/3.2 MB 14.6 MB/s eta 0:00:00\r\nDownloading sphinx_rtd_theme-2.0.0-py2.py3-none-any.whl (2.8 MB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.8/2.8 MB 29.9 MB/s eta 0:00:00\r\nDownloading sphinxcontrib_httpdomain-1.8.1-py2.py3-none-any.whl (25 kB)\r\nDownloading sphinxcontrib_jquery-4.1-py2.py3-none-any.whl (121 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 121.1/121.1 kB 6.9 MB/s eta 0:00:00\r\nDownloading sphinx_copybutton-0.5.2-py3-none-any.whl (13 kB)\r\nDownloading alabaster-0.7.16-py3-none-any.whl (13 kB)\r\nDownloading Babel-2.14.0-py3-none-any.whl (11.0 MB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 11.0/11.0 MB 28.4 MB/s eta 0:00:00\r\nDownloading colorama-0.4.6-py2.py3-none-any.whl (25 kB)\r\nDownloading docutils-0.20.1-py3-none-any.whl (572 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 572.7/572.7 kB 37.5 MB/s eta 0:00:00\r\nDownloading imagesize-1.4.1-py2.py3-none-any.whl (8.8 kB)\r\nDownloading Jinja2-3.1.3-py3-none-any.whl (133 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 133.2/133.2 kB 7.7 MB/s eta 0:00:00\r\nDownloading packaging-24.0-py3-none-any.whl (53 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 53.5/53.5 kB 2.7 MB/s eta 0:00:00\r\nDownloading pygments-2.17.2-py3-none-any.whl (1.2 MB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 24.9 MB/s eta 0:00:00\r\nDownloading requests-2.31.0-py3-none-any.whl (62 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.6/62.6 kB ? eta 0:00:00\r\nDownloading snowballstemmer-2.2.0-py2.py3-none-any.whl (93 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 93.0/93.0 kB 5.5 MB/s eta 0:00:00\r\nDownloading sphinxcontrib_htmlhelp-2.0.5-py3-none-any.whl (99 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 99.2/99.2 kB 5.6 MB/s eta 0:00:00\r\nDownloading sphinxcontrib_serializinghtml-1.1.10-py3-none-any.whl (92 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 92.7/92.7 kB ? eta 0:00:00\r\nDownloading six-1.16.0-py2.py3-none-any.whl (11 kB)\r\nDownloading sphinxcontrib_applehelp-1.0.8-py3-none-any.whl (120 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 120.0/120.0 kB 6.9 MB/s eta 0:00:00\r\nDownloading sphinxcontrib_devhelp-1.0.6-py3-none-any.whl (83 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 83.5/83.5 kB ? eta 0:00:00\r\nDownloading sphinxcontrib_jsmath-1.0.1-py2.py3-none-any.whl (5.1 kB)\r\nDownloading sphinxcontrib_qthelp-1.0.7-py3-none-any.whl (89 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 89.4/89.4 kB 5.0 MB/s eta 0:00:00\r\nDownloading certifi-2024.2.2-py3-none-any.whl (163 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 163.8/163.8 kB 10.2 MB/s eta 0:00:00\r\nDownloading charset_normalizer-3.3.2-cp311-cp311-win_amd64.whl (99 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 99.9/99.9 kB ? eta 0:00:00\r\nDownloading idna-3.7-py3-none-any.whl (66 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 66.8/66.8 kB ? eta 0:00:00\r\nDownloading MarkupSafe-2.1.5-cp311-cp311-win_amd64.whl (17 kB)\r\nDownloading urllib3-2.2.1-py3-none-any.whl (121 kB)\r\n   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 121.1/121.1 kB 6.9 MB/s eta 0:00:00\r\nInstalling collected packages: snowballstemmer, urllib3, sphinxcontrib-serializinghtml, sphinxcontrib-qthelp, sphinxcontrib-jsmath, sphinxcontrib-htmlhelp, sphinxcontrib-devhelp, sphinxcontrib-applehelp, six, Pygments, packaging, MarkupSafe, imagesize, idna, docutils, colorama, charset-normalizer, certifi, babel, alabaster, requests, Jinja2, Sphinx, sphinxcontrib-jquery, sphinxcontrib-httpdomain, sphinx-copybutton, sphinx-rtd-theme\r\nSuccessfully installed Jinja2-3.1.3 MarkupSafe-2.1.5 Pygments-2.17.2 Sphinx-7.2.6 alabaster-0.7.16 babel-2.14.0 certifi-2024.2.2 charset-normalizer-3.3.2 colorama-0.4.6 docutils-0.20.1 idna-3.7 imagesize-1.4.1 packaging-24.0 requests-2.31.0 six-1.16.0 snowballstemmer-2.2.0 sphinx-copybutton-0.5.2 sphinx-rtd-theme-2.0.0 sphinxcontrib-applehelp-1.0.8 sphinxcontrib-devhelp-1.0.6 sphinxcontrib-htmlhelp-2.0.5 sphinxcontrib-httpdomain-1.8.1 sphinxcontrib-jquery-4.1 sphinxcontrib-jsmath-1.0.1 sphinxcontrib-qthelp-1.0.7 sphinxcontrib-serializinghtml-1.1.10 urllib3-2.2.1\r\nRunning Sphinx v7.2.6\r\nloading pickled environment... done\r\nbuilding [mo]: all of 0 po files\r\nwriting output...\r\nbuilding [html]: all source files\r\nupdating environment: 0 added, 0 changed, 0 removed\r\nreading sources...\r\nlooking for now-outdated files... none found\r\npreparing documents... done\r\ncopying assets... copying static files... done\r\ncopying extra files... done\r\ndone\r\nwriting output... [100%] whatsnew/index\r\ngenerating indices... config-ref http-routingtable done\r\nwriting additional pages... download index search done\r\ncopying images... [100%] ../images/tea-erl-grey-hot-replicator.png\r\ndumping search index in English (code: en)... done\r\ndumping object inventory... done\r\nbuild succeeded.\r\n\r\nThe HTML pages are in build\\html.\r\n\r\nBuild finished. The HTML pages are in build/html.\r\n\r\n(.venv) C:\\Users\\couchdb\\Documents\\couchdb\\src\\docs>\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093316446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093320677","html_url":"https://github.com/apache/couchdb/pull/5045#issuecomment-2093320677","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5045","id":2093320677,"node_id":"IC_kwDOAAMmUc58xYnl","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T16:14:46Z","updated_at":"2024-05-03T16:15:00Z","author_association":"CONTRIBUTOR","body":"Ah and only informational, you need to chain both commands, because the python venv is activated through `setup.bat`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093320677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093355685","html_url":"https://github.com/apache/couchdb/pull/5045#issuecomment-2093355685","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5045","id":2093355685,"node_id":"IC_kwDOAAMmUc58xhKl","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T16:30:46Z","updated_at":"2024-05-03T16:30:46Z","author_association":"CONTRIBUTOR","body":"Thanks, Ronny.  That makes sense.\r\n\r\nI was trying it in a powershell and it doesn't seem to like the `&&` operator. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093355685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093372073","html_url":"https://github.com/apache/couchdb/pull/5045#issuecomment-2093372073","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5045","id":2093372073,"node_id":"IC_kwDOAAMmUc58xlKp","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T16:38:23Z","updated_at":"2024-05-03T16:38:34Z","author_association":"CONTRIBUTOR","body":"> I was trying it in a powershell and it doesn't seem to like the `&&` operator.\r\n\r\nThat should work since Powershell v7 ...\r\n\r\nAnd the Makefile is run with the cmd-interpreter...\r\n\r\nhttps://github.com/apache/couchdb/blob/f5292d8ba971391a7b1796382770427a2ca9e869/Makefile.win#L19","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093372073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093381802","html_url":"https://github.com/apache/couchdb/pull/5045#issuecomment-2093381802","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5045","id":2093381802,"node_id":"IC_kwDOAAMmUc58xniq","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-03T16:45:05Z","updated_at":"2024-05-03T16:45:05Z","author_association":"CONTRIBUTOR","body":"I guess my powershell is not new enough and I don't really want to upgrade this windows machine to Windows 11\r\n\r\n+1 to merge it, if it works for you it's good enough","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2093381802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2095390970","html_url":"https://github.com/apache/couchdb/issues/5046#issuecomment-2095390970","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5046","id":2095390970,"node_id":"IC_kwDOAAMmUc585SD6","user":{"login":"evavica","id":144010478,"node_id":"U_kgDOCJVs7g","avatar_url":"https://avatars.githubusercontent.com/u/144010478?v=4","gravatar_id":"","url":"https://api.github.com/users/evavica","html_url":"https://github.com/evavica","followers_url":"https://api.github.com/users/evavica/followers","following_url":"https://api.github.com/users/evavica/following{/other_user}","gists_url":"https://api.github.com/users/evavica/gists{/gist_id}","starred_url":"https://api.github.com/users/evavica/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/evavica/subscriptions","organizations_url":"https://api.github.com/users/evavica/orgs","repos_url":"https://api.github.com/users/evavica/repos","events_url":"https://api.github.com/users/evavica/events{/privacy}","received_events_url":"https://api.github.com/users/evavica/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-06T07:53:43Z","updated_at":"2024-05-06T07:59:37Z","author_association":"NONE","body":"Interesting piece of code, so by default they just skip the checks of some important properties (could have just returned ok instead ). The reason why I stopped by here initially is that while having worked with several applications validating JWTs using different libs for that, none of them required me to configure these checks but implemented them as defaults. That's kind of the expected behavior. \r\nThat is probably often done via application logic and not necessarily enforced by the lib used. However, still a good choice to make in my opinion. \r\nWhile it is nice to have many configuration options as CouchDB users, this particular case would be a nice fit for convention over configuration. And with the solution mentioned above, users could still configure it otherwise so it doesn't hurt having the sensible defaults.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2095390970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2095833126","html_url":"https://github.com/apache/couchdb/issues/5033#issuecomment-2095833126","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5033","id":2095833126,"node_id":"IC_kwDOAAMmUc586-Am","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-06T11:51:54Z","updated_at":"2024-05-06T11:51:54Z","author_association":"CONTRIBUTOR","body":"@Aakash1247 Do you have more news or updates of your problem? If not, I would close this ticket in the next days.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2095833126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2095865322","html_url":"https://github.com/apache/couchdb/issues/5033#issuecomment-2095865322","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5033","id":2095865322,"node_id":"IC_kwDOAAMmUc587F3q","user":{"login":"Aakash1247","id":125426691,"node_id":"U_kgDOB3ncAw","avatar_url":"https://avatars.githubusercontent.com/u/125426691?v=4","gravatar_id":"","url":"https://api.github.com/users/Aakash1247","html_url":"https://github.com/Aakash1247","followers_url":"https://api.github.com/users/Aakash1247/followers","following_url":"https://api.github.com/users/Aakash1247/following{/other_user}","gists_url":"https://api.github.com/users/Aakash1247/gists{/gist_id}","starred_url":"https://api.github.com/users/Aakash1247/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Aakash1247/subscriptions","organizations_url":"https://api.github.com/users/Aakash1247/orgs","repos_url":"https://api.github.com/users/Aakash1247/repos","events_url":"https://api.github.com/users/Aakash1247/events{/privacy}","received_events_url":"https://api.github.com/users/Aakash1247/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-06T12:08:08Z","updated_at":"2024-05-06T12:08:08Z","author_association":"NONE","body":"yes, you can close thank you.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2095865322/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2096113379","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2096113379","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2096113379,"node_id":"IC_kwDOAAMmUc588Cbj","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-06T14:09:22Z","updated_at":"2024-05-06T14:09:22Z","author_association":"NONE","body":"> With `include_docs=true` tweaking `[fabric] all_docs_concurrency = 10` might have an effect.\r\n> \r\n> https://github.com/apache/couchdb/blob/main/src/fabric/src/fabric_view_all_docs.erl#L297\r\n> \r\n> That spawns 10 background workers at the fabric (cluster level) to open 10 documents in parallel, but that puts more work on the cluster. Can try decreasing it or increasing it a bit and see if it changes anything.\r\n\r\nWe tried using this, but with no luck. \r\nOne thing that might be of any help, we see the memory increasing linearly as the requests are made.\r\n\r\nThis is the memory in the last seven days:\r\n\r\n<img width=\"489\" alt=\"Screenshot 2024-05-06 alle 16 08 14\" src=\"https://github.com/apache/couchdb/assets/44196863/a3bba0b7-1f07-42ea-a837-005e77995efa\">\r\n\r\nThe points were the memory rapidly decreases are the restarts of the couchdb service, which make the system fast again (for a couple of minutes).\r\nI'm really wondering if there's any kind of memory leak somewhere.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2096113379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2097377016","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2097377016","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2097377016,"node_id":"IC_kwDOAAMmUc59A274","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-07T03:26:47Z","updated_at":"2024-05-07T20:25:43Z","author_association":"CONTRIBUTOR","body":"@luca-simonetti thanks for trying the concurrency setting.\r\n\r\nYeah, memory leak is plausible we have debugged a number of those last few years. Some in OTP 25 and 24:\r\n * https://github.com/erlang/otp/issues/8044\r\n * https://github.com/erlang/otp/issues/6947\r\n * https://github.com/erlang/otp/issues/7834\r\n * https://github.com/erlang/otp/issues/7801\r\n\r\nSome memory usage increase is expected perhaps if it's the page cache that's using the memory, thought that wouldn't explain the slowdown...\r\n\r\nAnother thing to tweak might be the [max_dbs_open](https://docs.couchdb.org/en/stable/config/couchdb.html#couchdb/max_dbs_open). That helped in another issue related to memory usage: https://github.com/apache/couchdb/discussions/4992, another interesting one might be: https://github.com/apache/couchdb/issues/4988#issuecomment-1955460577. Though, again in those cases performance didn't seem to be much of an issue.\r\n\r\nAre there any exceptions or errors showing in the logs?\r\n\r\nTo get more details about the internals cay try getting the output from `/_node/_local/_system` and see what the `\"memory\"` objects and `\"message_queues\"` values increase. https://github.com/apache/couchdb/discussions/4992#discussioncomment-8596562 has an example of calling that and what part of the response might look like. `_local` can be replaced with an Erlang (distribution) node name as well.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2097377016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2099175091","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2099175091","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2099175091,"node_id":"IC_kwDOAAMmUc59Ht6z","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-07T19:45:46Z","updated_at":"2024-05-07T19:45:46Z","author_association":"MEMBER","body":"which version of erlang are you using?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2099175091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2099742866","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2099742866","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2099742866,"node_id":"IC_kwDOAAMmUc59J4iS","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T04:58:56Z","updated_at":"2024-05-08T04:58:56Z","author_association":"NONE","body":"> which version of erlang are you using?\r\n\r\n```json\r\n{\r\n    \"javascript_engine\": {\r\n        \"version\": \"78\",\r\n        \"name\": \"spidermonkey\"\r\n    },\r\n    \"erlang\": {\r\n        \"version\": \"24.3.4.15\",\r\n        \"supported_hashes\": [\r\n            \"blake2s\",\r\n            \"blake2b\",\r\n            \"sha3_512\",\r\n            \"sha3_384\",\r\n            \"sha3_256\",\r\n            \"sha3_224\",\r\n            \"sha512\",\r\n            \"sha384\",\r\n            \"sha256\",\r\n            \"sha224\",\r\n            \"sha\",\r\n            \"ripemd160\",\r\n            \"md5\",\r\n            \"md4\"\r\n        ]\r\n    },\r\n    \"collation_driver\": {\r\n        \"name\": \"libicu\",\r\n        \"library_version\": \"70.1\",\r\n        \"collator_version\": \"153.112\",\r\n        \"collation_algorithm_version\": \"14\"\r\n    }\r\n}\r\n```\r\n\r\nthis is the full _config/_local/_versions output\r\n\r\n\r\nas for the memory leaks provided: we tried to look into that but those are like 50GB memory leak whereas in our case the memory used is around 200MB and it's only 15% of the total available. For this very reason I don't really think it's related to those problems.\r\n\r\nAlso: we noticed that the CPU used is around 25% which is really low and tweaking the all_docs_concurrency to 100 didn't change really much meaning that the time taken increases over time, CPU and RAM usages are the same as before.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2099742866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2099806428","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2099806428","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2099806428,"node_id":"IC_kwDOAAMmUc59KIDc","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T06:04:24Z","updated_at":"2024-05-08T06:04:24Z","author_association":"NONE","body":"and this is the current state of _node/_local/_system\r\nit doesn't look too bad I guess...\r\n\r\n```json\r\n{\r\n    \"uptime\": 77078,\r\n    \"memory\": {\r\n        \"other\": 26982505,\r\n        \"atom\": 631001,\r\n        \"atom_used\": 605053,\r\n        \"processes\": 170112432,\r\n        \"processes_used\": 170076040,\r\n        \"binary\": 474168,\r\n        \"code\": 13917182,\r\n        \"ets\": 2267344\r\n    },\r\n    \"run_queue\": 0,\r\n    \"run_queue_dirty_cpu\": 0,\r\n    \"ets_table_count\": 157,\r\n    \"context_switches\": 851304076,\r\n    \"reductions\": 3036158123783,\r\n    \"garbage_collection_count\": 20109323,\r\n    \"words_reclaimed\": 35778913031,\r\n    \"io_input\": 144808316,\r\n    \"io_output\": 1204370753,\r\n    \"os_proc_count\": 0,\r\n    \"stale_proc_count\": 0,\r\n    \"process_count\": 444,\r\n    \"process_limit\": 262144,\r\n    \"message_queues\": {\r\n        \"couch_file\": {\r\n            \"50\": 0,\r\n            \"90\": 0,\r\n            \"99\": 0,\r\n            \"count\": 38,\r\n            \"min\": 0,\r\n            \"max\": 0\r\n        },\r\n        \"couch_db_updater\": {\r\n            \"50\": 0,\r\n            \"90\": 0,\r\n            \"99\": 0,\r\n            \"count\": 38,\r\n            \"min\": 0,\r\n            \"max\": 0\r\n        },\r\n// a bunch of keys with value:0\r\n    }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2099806428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2100170944","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2100170944","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2100170944,"node_id":"IC_kwDOAAMmUc59LhDA","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T09:35:21Z","updated_at":"2024-05-08T12:21:42Z","author_association":"NONE","body":"for an extreme test we tried to set `[fabric] all_docs_concurrency = 10000` (ten thousands) and it suddendly worked perfectly for the first 8.000 requests. Then it started immediately slow down to the previous point\r\nSince we need to get to 200.000 requests we need this behaviour to be constant.\r\nWith this new information what is the actual problem?\r\n\r\nUPDATE: I actually restarted the process to verify that this value actually fixes the problem and it **does not**.\r\nWhen it was _fast_ it was basically requesting the \"container\" of the subtokens and somehow somewhere the values were given like super fast. After restarting couchdb it went back to the previous state where it takes the token and then the 100 subdocuments.\r\nIf you could explain what `all_docs_concurrency` does, since it's not documented.\r\n\r\nUPDATE2: Idk if this is the case, but it could just be related to some hyperledger internal caching. I'm really struggling how the whole system works","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2100170944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2100810799","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2100810799","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2100810799,"node_id":"IC_kwDOAAMmUc59N9Qv","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T15:10:31Z","updated_at":"2024-05-08T15:10:31Z","author_association":"CONTRIBUTOR","body":"> for an extreme test we tried to set [fabric] all_docs_concurrency = 10000 (ten thousands) and it suddenly worked perfectly for the first 8.000 requests.\r\n\r\n> After restarting couchdb it went back to the previous state where it takes the token and then the 100 subdocuments.\r\nIf you could explain what all_docs_concurrency does, since it's not documented.\r\n\r\nAll doc_docs concurrency limit how many parallel doc read to do at the cluster level. That speeds up the `include_docs=true` `_all_docs` but at the expensive of consuming more resources per request.\r\n\r\nAnother factor to play with is Q. What is your Q value for the dbs? By default it's 2. You can try experimenting with higher values like 8, 16, 64.\r\n\r\n> UPDATE2: Idk if this is the case, but it could just be related to some hyperledger internal caching. I'm really struggling how the whole system works\r\n\r\nIf on your containers your CPU and memory usage are not very high, it does seem like a slow disk problem issue but a disk with a page  cache or other limited faster cache in front of it. Try using a faster local disk or another setup as an experiment with the same container and see what numbers you get.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2100810799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2101928684","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2101928684","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2101928684,"node_id":"IC_kwDOAAMmUc59SOLs","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-09T04:51:14Z","updated_at":"2024-05-09T04:51:14Z","author_association":"NONE","body":"I don't think the disk is the issue here:\r\n\r\n```\r\nprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\r\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\r\n 2  0      0 312512 478476 2741660    0    0     2    19    0    0  3  0 97  0  0\r\n```\r\n\r\nas you can see the system doesn't spend any time waiting for IO ops.\r\n\r\nWhat I see though is a memory cache increasing. After restart that very same cache decreases a lot and starts growing back again.\r\n\r\nOne more note: the requests that are slow are not the \"include_documents=true\" ones, but the \"attachments=true\"\r\nI reiterate just so we're on the same page: we do 10-20 millions request to download ALL documents with a key prefix in the database. For example we might have\r\npiece0000001\r\npiece0000002\r\n...\r\npiece1000000\r\n...\r\npiece9999999\r\n\r\nand we make a request for each of those. So if there's something cached it's of no use or even in this case a issue since each subsequent request is accessing a different document from the request before.\r\n\r\nAlso: we cannot change the Q factor since the database is already created and we don't want to risk resharding and losing the whole thing...\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2101928684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2105744603","html_url":"https://github.com/apache/couchdb/issues/5051#issuecomment-2105744603","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5051","id":2105744603,"node_id":"IC_kwDOAAMmUc59gxzb","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-11T13:24:43Z","updated_at":"2024-05-11T13:24:43Z","author_association":"MEMBER","body":"https://docs.couchdb.org/en/stable/api/server/common.html#post--_search_analyze","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2105744603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2106163561","html_url":"https://github.com/apache/couchdb/issues/5051#issuecomment-2106163561","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5051","id":2106163561,"node_id":"IC_kwDOAAMmUc59iYFp","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-12T08:20:52Z","updated_at":"2024-05-12T08:20:52Z","author_association":"MEMBER","body":"boo!\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2106163561/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2108160727","html_url":"https://github.com/apache/couchdb/pull/5050#issuecomment-2108160727","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5050","id":2108160727,"node_id":"IC_kwDOAAMmUc59p_rX","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T16:33:07Z","updated_at":"2024-05-13T16:33:07Z","author_association":"CONTRIBUTOR","body":"Hrm, CentOS 7 is supported until June 30, 2024.  However, CentOS 8 was supported until end of 2021: https://endoflife.date/centos — personally, I will miss 7, it helped us to catch many curious mistakes last year.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2108160727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2108214397","html_url":"https://github.com/apache/couchdb/pull/5050#issuecomment-2108214397","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5050","id":2108214397,"node_id":"IC_kwDOAAMmUc59qMx9","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T16:53:33Z","updated_at":"2024-05-13T16:53:33Z","author_association":"CONTRIBUTOR","body":"8 support will go until 2029 at least https://access.redhat.com/support/policy/updates/errata/\r\n\r\nYeah, we'll definitely miss CentOS 7, it was a good helper finding various bugs all those years.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2108214397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2108224616","html_url":"https://github.com/apache/couchdb/pull/5050#issuecomment-2108224616","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5050","id":2108224616,"node_id":"IC_kwDOAAMmUc59qPRo","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T16:56:23Z","updated_at":"2024-05-13T16:56:23Z","author_association":"CONTRIBUTOR","body":"Your link points to RHEL8 which probably shares the same assets but managed differently?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2108224616/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2110913038","html_url":"https://github.com/apache/couchdb/issues/4916#issuecomment-2110913038","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4916","id":2110913038,"node_id":"IC_kwDOAAMmUc590foO","user":{"login":"dch","id":284368,"node_id":"MDQ6VXNlcjI4NDM2OA==","avatar_url":"https://avatars.githubusercontent.com/u/284368?v=4","gravatar_id":"","url":"https://api.github.com/users/dch","html_url":"https://github.com/dch","followers_url":"https://api.github.com/users/dch/followers","following_url":"https://api.github.com/users/dch/following{/other_user}","gists_url":"https://api.github.com/users/dch/gists{/gist_id}","starred_url":"https://api.github.com/users/dch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dch/subscriptions","organizations_url":"https://api.github.com/users/dch/orgs","repos_url":"https://api.github.com/users/dch/repos","events_url":"https://api.github.com/users/dch/events{/privacy}","received_events_url":"https://api.github.com/users/dch/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T18:49:17Z","updated_at":"2024-05-14T18:49:56Z","author_association":"CONTRIBUTOR","body":"these are caused by a SIGSEGV in couchjs, during GC. worker threads are paused, main thread\r\nis in the middle of GC. Filed [upstream](https://bugzilla.mozilla.org/show_bug.cgi?id=1896604) but they rightly point out we need to be on a SM supported\r\nversion for this to be worth looking at.\r\n\r\n```\r\n* thread #1, name = 'couchjs', stop reason = signal SIGSEGV\r\n  * frame #0: 0x000000008321f3a0 libmozjs-91.so`js::gc::MapAlignedPages(unsigned long, unsigned long) + 1232\r\n    frame #1: 0x00000000831e56f0 libmozjs-91.so`js::gc::GCRuntime::pickChunk(js::AutoLockGCBgAlloc&) + 132\r\n    frame #2: 0x00000000831e54a4 libmozjs-91.so`js::gc::ArenaLists::refillFreeListAndAllocate(js::gc::FreeLists&, js::gc::AllocKind, js::gc::ShouldCheckThresholds) + 308\r\n    frame #3: 0x00000000831e4638 libmozjs-91.so`js::jit::JitCode* js::Allocate<js::jit::JitCode, (js::AllowGC)0>(JSContext*) + 128\r\n    frame #4: 0x0000000083478618 libmozjs-91.so`js::jit::JitCode* js::jit::JitCode::New<(js::AllowGC)0>(JSContext*, unsigned char*, unsigned int, unsigned int, js::jit::ExecutablePool*, js::jit::CodeKind) + 44\r\n    frame #5: 0x00000000834a27c8 libmozjs-91.so`js::jit::Linker::newCode(JSContext*, js::jit::CodeKind) + 284\r\n    frame #6: 0x00000000832922c8 libmozjs-91.so`js::jit::BaselineCacheIRCompiler::compile() + 15424\r\n    frame #7: 0x000000008329b6e0 libmozjs-91.so`js::jit::AttachBaselineCacheIRStub(JSContext*, js::jit::CacheIRWriter const&, js::jit::CacheKind, JSScript*, js::jit::ICScript*, js::jit::ICFallbackStub*, bool*) + 212\r\n    frame #8: 0x00000000832cf2a0 libmozjs-91.so`___lldb_unnamed_symbol30268 + 276\r\n    frame #9: 0x00000000832cf070 libmozjs-91.so`js::jit::DoGetPropFallback(JSContext*, js::jit::BaselineFrame*, js::jit::ICFallbackStub*, JS::MutableHandle<JS::Value>, JS::MutableHandle<JS::Value>) + 444\r\n    frame #10: 0x000014c25c2ea554\r\n```\r\n\r\nI will see if I can track down what dependencies changed back in December,\r\nthat this stopped working. couchjs is not exactly a fast-moving target.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2110913038/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2113454782","html_url":"https://github.com/apache/couchdb/pull/5055#issuecomment-2113454782","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5055","id":2113454782,"node_id":"IC_kwDOAAMmUc59-MK-","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T21:05:32Z","updated_at":"2024-05-15T21:05:32Z","author_association":"CONTRIBUTOR","body":"It is already 0.13 on main","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2113454782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114574954","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2114574954","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2114574954,"node_id":"IC_kwDOAAMmUc5-Cdpq","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T08:56:21Z","updated_at":"2024-05-16T08:56:21Z","author_association":"MEMBER","body":"a memory leak around attachments is feasible, as they are handled as large binaries in erlang, and there have been some leaks in BEAM around that.\r\n\r\nWhat version of erlang is couchdb using here?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114574954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114581548","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2114581548","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2114581548,"node_id":"IC_kwDOAAMmUc5-CfQs","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T08:57:47Z","updated_at":"2024-05-16T08:58:43Z","author_association":"MEMBER","body":"as for resharding, our advice to increase `q` would be to make a new, empty database with the new `q` and replicate from current db to the new one with admin credentials and no filter. This ensures everything gets across. You could leave a continuous:true replication running while switching clients over from the old url to the new one, and then cancel it, and delete the old database, once everything is switched (i.e, no more reads or writes arriving at the old db).\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114581548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114591131","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2114591131","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2114591131,"node_id":"IC_kwDOAAMmUc5-Chmb","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T09:00:08Z","updated_at":"2024-05-16T09:00:08Z","author_association":"NONE","body":"> a memory leak around attachments is feasible, as they are handled as large binaries in erlang, and there have been some leaks in BEAM around that.\r\n> \r\n> What version of erlang is couchdb using here?\r\n\r\nthe Erlang version inside couchdb is:\r\n        \"version\": \"24.3.4.15\"\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114591131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114699458","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2114699458","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2114699458,"node_id":"IC_kwDOAAMmUc5-C8DC","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T09:34:55Z","updated_at":"2024-05-16T09:34:55Z","author_association":"MEMBER","body":"ok, let's get you onto 24.3.4.17, as we know there are bugs in earlier point releases of that series. Let's rule those out first.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114699458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114711940","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2114711940","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2114711940,"node_id":"IC_kwDOAAMmUc5-C_GE","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T09:41:38Z","updated_at":"2024-05-16T09:41:38Z","author_association":"NONE","body":"ok, cool! How do I do that?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114711940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114738743","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2114738743","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2114738743,"node_id":"IC_kwDOAAMmUc5-DFo3","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T09:52:56Z","updated_at":"2024-05-16T09:52:56Z","author_association":"MEMBER","body":"you'll need to download or build 24.3.4.17 (https://www.erlang.org/patches/otp-24.3.4.17) and build couchdb against it. \r\n\r\nHow did you install couchdb initially? We should update our binary packages with 24.3.4.17 for the same reason.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114738743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114782124","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2114782124","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2114782124,"node_id":"IC_kwDOAAMmUc5-DQOs","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T10:08:54Z","updated_at":"2024-05-16T10:08:54Z","author_association":"NONE","body":"we installed the current couchdb version (3.3..3) using the official repository version for Ubuntu. I think erlang came bundled with it","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2114782124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2116023755","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2116023755","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2116023755,"node_id":"IC_kwDOAAMmUc5-H_XL","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T19:24:58Z","updated_at":"2024-05-16T19:24:58Z","author_association":"CONTRIBUTOR","body":"I just rebuilt all the 3.3.3 packages to use the latest Erlang patch version 24.3.4.17. If you update from the deb repo you should get the latest version from there: 3.3.3-2","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2116023755/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2116652251","html_url":"https://github.com/apache/couchdb/pull/5058#issuecomment-2116652251","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5058","id":2116652251,"node_id":"IC_kwDOAAMmUc5-KYzb","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T05:14:27Z","updated_at":"2024-05-17T05:14:27Z","author_association":"CONTRIBUTOR","body":"> Is it worth adding a test for this?\r\n\r\n@jaydoane Good idea. Will add a few tests for VDU only, filter only, maps only etc. Will need to check if process proc errors were raised, we record those in `couch_stats` so I'll sample those at the end of the plugin run.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2116652251/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2117456407","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2117456407","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2117456407,"node_id":"IC_kwDOAAMmUc5-NdIX","user":{"login":"luca-simonetti","id":44196863,"node_id":"MDQ6VXNlcjQ0MTk2ODYz","avatar_url":"https://avatars.githubusercontent.com/u/44196863?v=4","gravatar_id":"","url":"https://api.github.com/users/luca-simonetti","html_url":"https://github.com/luca-simonetti","followers_url":"https://api.github.com/users/luca-simonetti/followers","following_url":"https://api.github.com/users/luca-simonetti/following{/other_user}","gists_url":"https://api.github.com/users/luca-simonetti/gists{/gist_id}","starred_url":"https://api.github.com/users/luca-simonetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luca-simonetti/subscriptions","organizations_url":"https://api.github.com/users/luca-simonetti/orgs","repos_url":"https://api.github.com/users/luca-simonetti/repos","events_url":"https://api.github.com/users/luca-simonetti/events{/privacy}","received_events_url":"https://api.github.com/users/luca-simonetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T12:09:08Z","updated_at":"2024-05-17T12:09:21Z","author_association":"NONE","body":"thank you for the help! We updated couchdb as requested:\r\n\r\n```json\r\n{\r\n\"javascript_engine\": {\r\n\"version\": \"78\",\r\n\"name\": \"spidermonkey\"\r\n},\r\n\"erlang\": {\r\n\"version\": \"24.3.4.17\",\r\n\"supported_hashes\": [\r\n\"blake2s\",\r\n\"blake2b\",\r\n\"sha3_512\",\r\n\"sha3_384\",\r\n\"sha3_256\",\r\n\"sha3_224\",\r\n\"sha512\",\r\n\"sha384\",\r\n\"sha256\",\r\n\"sha224\",\r\n\"sha\",\r\n\"ripemd160\",\r\n\"md5\",\r\n\"md4\"\r\n]\r\n},\r\n\"collation_driver\": {\r\n\"name\": \"libicu\",\r\n\"library_version\": \"70.1\",\r\n\"collator_version\": \"153.112\",\r\n\"collation_algorithm_version\": \"14\"\r\n}\r\n}\r\n```\r\nbut unfortunately didn't help. The problem is still the same 😢 ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2117456407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118006020","html_url":"https://github.com/apache/couchdb/issues/5059#issuecomment-2118006020","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5059","id":2118006020,"node_id":"IC_kwDOAAMmUc5-PjUE","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T16:53:50Z","updated_at":"2024-05-17T16:53:50Z","author_association":"CONTRIBUTOR","body":"Hi,\r\n\r\ncan you paste your JWT token?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118006020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118028530","html_url":"https://github.com/apache/couchdb/issues/5059#issuecomment-2118028530","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5059","id":2118028530,"node_id":"IC_kwDOAAMmUc5-Pozy","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T17:07:03Z","updated_at":"2024-05-17T17:07:03Z","author_association":"MEMBER","body":"I think it's a decode error for the public key in the config, @big-r81 \r\n\r\nwe don't need the token","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118028530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118029081","html_url":"https://github.com/apache/couchdb/issues/5059#issuecomment-2118029081","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5059","id":2118029081,"node_id":"IC_kwDOAAMmUc5-Po8Z","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T17:07:32Z","updated_at":"2024-05-17T17:07:32Z","author_association":"MEMBER","body":"we should catch and rethrow as something more presentable, but the config is wrong.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118029081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118037003","html_url":"https://github.com/apache/couchdb/issues/5059#issuecomment-2118037003","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5059","id":2118037003,"node_id":"IC_kwDOAAMmUc5-Pq4L","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T17:13:16Z","updated_at":"2024-05-17T17:13:16Z","author_association":"MEMBER","body":"```\r\n4> public_key:pem_decode(BinPEM).\r\n[{'SubjectPublicKeyInfo',<<48,130,2,181,48,130,1,157,2,6,\r\n                           1,136,80,108,152,219,48,13,6,9,\r\n                           42,134,72,134,247,13,...>>,\r\n                         not_encrypted}]\r\n5> [PEMEntry] =public_key:pem_decode(BinPEM).\r\n[{'SubjectPublicKeyInfo',<<48,130,2,181,48,130,1,157,2,6,\r\n                           1,136,80,108,152,219,48,13,6,9,\r\n                           42,134,72,134,247,13,...>>,\r\n                         not_encrypted}]\r\n6> public_key:pem_entry_decode(PEMEntry).\r\n** exception error: no match of right hand side value {error,{asn1,{{wrong_tag,{{expected,6},\r\n                                                                                {got,2,{2,<<1,136,80,108,152,219>>}}}},\r\n                                                                    [{'OTP-PUB-KEY',match_tags,2,\r\n                                                                                    [{file,\"OTP-PUB-KEY.erl\"},{line,23999}]},\r\n                                                                     {'OTP-PUB-KEY',decode_object_identifier,2,\r\n                                                                                    [{file,\"OTP-PUB-KEY.erl\"},{line,23557}]},\r\n                                                                     {'OTP-PUB-KEY',dec_AlgorithmIdentifier,2,\r\n                                                                                    [{file,\"OTP-PUB-KEY.erl\"},{line,14558}]},\r\n                                                                     {'OTP-PUB-KEY',dec_SubjectPublicKeyInfo,2,\r\n                                                                                    [{file,\"OTP-PUB-KEY.erl\"},{line,15014}]},\r\n                                                                     {'OTP-PUB-KEY',decode,2,\r\n                                                                                    [{file,\"OTP-PUB-KEY.erl\"},{line,1232}]},\r\n                                                                     {public_key,der_decode,2,\r\n                                                                                 [{file,\"public_key.erl\"},{line,358}]},\r\n                                                                     {public_key,pem_entry_decode,1,\r\n                                                                                 [{file,\"public_key.erl\"},{line,226}]},\r\n                                                                     {erl_eval,do_apply,6,[{file,\"erl_eval.erl\"},{line,689}]}]}}}\r\n     in function  public_key:der_decode/2 (public_key.erl, line 362)\r\n     in call from public_key:pem_entry_decode/1 (public_key.erl, line 226)\r\n7>\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118037003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118108427","html_url":"https://github.com/apache/couchdb/issues/5059#issuecomment-2118108427","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5059","id":2118108427,"node_id":"IC_kwDOAAMmUc5-P8UL","user":{"login":"tommyli","id":117335,"node_id":"MDQ6VXNlcjExNzMzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/117335?v=4","gravatar_id":"","url":"https://api.github.com/users/tommyli","html_url":"https://github.com/tommyli","followers_url":"https://api.github.com/users/tommyli/followers","following_url":"https://api.github.com/users/tommyli/following{/other_user}","gists_url":"https://api.github.com/users/tommyli/gists{/gist_id}","starred_url":"https://api.github.com/users/tommyli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tommyli/subscriptions","organizations_url":"https://api.github.com/users/tommyli/orgs","repos_url":"https://api.github.com/users/tommyli/repos","events_url":"https://api.github.com/users/tommyli/events{/privacy}","received_events_url":"https://api.github.com/users/tommyli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T17:45:40Z","updated_at":"2024-05-17T17:45:40Z","author_association":"NONE","body":"OK, thanks for confirming that the key config is wrong, I worked out what happened.\r\n\r\nI'm using Keycloak and I used the certificate instead of the public key from the realm settings.  The cryptic error is probably trying to parse a public key but was given a certificate, i.e. the error `{\"error\":\"bad_request\",\"reason\":\"not an RSA public key\"}` is a lot more meaningful as soon as I used `-----BEGIN CERTIFICATE-----` instead of `-----BEGIN PUBLIC KEY-----`.\r\n\r\nIt's working now, thanks for your help.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118108427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118112510","html_url":"https://github.com/apache/couchdb/issues/5059#issuecomment-2118112510","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5059","id":2118112510,"node_id":"IC_kwDOAAMmUc5-P9T-","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T17:48:38Z","updated_at":"2024-05-17T17:48:38Z","author_association":"MEMBER","body":":)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118112510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118113271","html_url":"https://github.com/apache/couchdb/issues/5059#issuecomment-2118113271","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5059","id":2118113271,"node_id":"IC_kwDOAAMmUc5-P9f3","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T17:49:13Z","updated_at":"2024-05-17T17:49:13Z","author_association":"MEMBER","body":"yup, error handling is poor here, we'll improve it.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2118113271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2121601977","html_url":"https://github.com/apache/couchdb/pull/5061#issuecomment-2121601977","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5061","id":2121601977,"node_id":"IC_kwDOAAMmUc5-dRO5","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-21T02:41:46Z","updated_at":"2024-05-21T02:41:46Z","author_association":"CONTRIBUTOR","body":"@dependabot ignore this dependency\r\n\r\nThis is dependent on the python version on the lowest supported OS currently","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2121601977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2121602012","html_url":"https://github.com/apache/couchdb/pull/5061#issuecomment-2121602012","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5061","id":2121602012,"node_id":"IC_kwDOAAMmUc5-dRPc","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2024-05-21T02:41:49Z","updated_at":"2024-05-21T02:41:49Z","author_association":"CONTRIBUTOR","body":"OK, I won't notify you about requests again, unless you re-open this PR.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2121602012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":29110,"client_id":"Iv1.4f9a6346434f815e","slug":"dependabot","node_id":"MDM6QXBwMjkxMTA=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"Dependabot","description":"","external_url":"https://dependabot-api.githubapp.com","html_url":"https://github.com/apps/dependabot","created_at":"2019-04-16T22:34:25Z","updated_at":"2024-03-20T21:06:35Z","permissions":{"actions":"read","checks":"write","contents":"write","issues":"write","members":"read","metadata":"read","pull_requests":"write","statuses":"read","vulnerability_alerts":"read","workflows":"write"},"events":["check_suite","issues","issue_comment","label","pull_request","pull_request_review","pull_request_review_comment","repository"]}},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2123126431","html_url":"https://github.com/apache/couchdb/issues/5062#issuecomment-2123126431","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5062","id":2123126431,"node_id":"IC_kwDOAAMmUc5-jFaf","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-21T17:41:31Z","updated_at":"2024-05-21T17:41:31Z","author_association":"CONTRIBUTOR","body":"Hi,\r\n\r\non Windows you need to bind the chttp interface to 127.0.0.1 or to your real ip.\r\n\r\n```\r\n[chttpd]\r\nbind_address = 127.0.0.1\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2123126431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2123203692","html_url":"https://github.com/apache/couchdb/issues/5062#issuecomment-2123203692","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5062","id":2123203692,"node_id":"IC_kwDOAAMmUc5-jYRs","user":{"login":"NETEROabdelrahman","id":114447180,"node_id":"U_kgDOBtJTTA","avatar_url":"https://avatars.githubusercontent.com/u/114447180?v=4","gravatar_id":"","url":"https://api.github.com/users/NETEROabdelrahman","html_url":"https://github.com/NETEROabdelrahman","followers_url":"https://api.github.com/users/NETEROabdelrahman/followers","following_url":"https://api.github.com/users/NETEROabdelrahman/following{/other_user}","gists_url":"https://api.github.com/users/NETEROabdelrahman/gists{/gist_id}","starred_url":"https://api.github.com/users/NETEROabdelrahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NETEROabdelrahman/subscriptions","organizations_url":"https://api.github.com/users/NETEROabdelrahman/orgs","repos_url":"https://api.github.com/users/NETEROabdelrahman/repos","events_url":"https://api.github.com/users/NETEROabdelrahman/events{/privacy}","received_events_url":"https://api.github.com/users/NETEROabdelrahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-21T18:29:37Z","updated_at":"2024-05-21T18:51:53Z","author_association":"NONE","body":"i still get the same issue, \r\n![Screenshot (118)](https://github.com/apache/couchdb/assets/114447180/9245af60-d602-468e-94d1-2a404feb8fe3)\r\n![Screenshot (119)](https://github.com/apache/couchdb/assets/114447180/16f22af9-882b-4917-acfc-d3f61aa1bb4b)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2123203692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2123293891","html_url":"https://github.com/apache/couchdb/issues/5064#issuecomment-2123293891","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5064","id":2123293891,"node_id":"IC_kwDOAAMmUc5-juTD","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-21T19:23:02Z","updated_at":"2024-05-21T19:28:56Z","author_association":"CONTRIBUTOR","body":"Playing a bit with mochiweb headers parser, I think we may have to use `mochiweb_headers:to_list/1`, then go through each `'Set-Cookie`' parse out the cookie and ignore any not coming from CouchDB?\r\n\r\n```erlang\r\nHeads = mochiweb_headers:from_binary([<<\"Content-Length:47\\r\\n\">>, <<\"Set-Cookie:Custom=ABC; Version=42\\r\\n\">>, <<\"Foo:bar\\r\\n\">>, <<\"sEt-cOokie:Kustom=DEF; Version=43\\r\\n\\rn\">>]), ok.\r\nok\r\n\r\n> mochiweb_headers:get_value(\"set-cookie\", Heads).\r\n\"Kustom=DEF; Version=43, Custom=ABC; Version=42\"\r\n\r\n> mochiweb_headers:get_primary_value(\"set-cookie\", Heads).\r\n\"Kustom=DEF\"\r\n\r\n> mochiweb_headers:get_combined_value(\"set-cookie\", Heads).\r\nundefined\r\n\r\n> mochiweb_headers:to_list(Heads).\r\n[{'Content-Length',\"47\"},\r\n {\"Foo\",\"bar\"},\r\n {'Set-Cookie',\"Kustom=DEF; Version=43\"},\r\n {'Set-Cookie',\"Custom=ABC; Version=42\"}]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2123293891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2123486621","html_url":"https://github.com/apache/couchdb/issues/5062#issuecomment-2123486621","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5062","id":2123486621,"node_id":"IC_kwDOAAMmUc5-kdWd","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-21T21:41:05Z","updated_at":"2024-05-21T21:41:05Z","author_association":"CONTRIBUTOR","body":"Can you show your config from Fauxton or via command line like (maybe you need to install curl for Windows):\r\n\r\n```\r\ncurl.exe -s --user user:password http://127.0.0.1:5984/_node/_local/_config\r\n```\r\nCould you append your log file too?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2123486621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2125131995","html_url":"https://github.com/apache/couchdb/issues/5062#issuecomment-2125131995","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5062","id":2125131995,"node_id":"IC_kwDOAAMmUc5-qvDb","user":{"login":"NETEROabdelrahman","id":114447180,"node_id":"U_kgDOBtJTTA","avatar_url":"https://avatars.githubusercontent.com/u/114447180?v=4","gravatar_id":"","url":"https://api.github.com/users/NETEROabdelrahman","html_url":"https://github.com/NETEROabdelrahman","followers_url":"https://api.github.com/users/NETEROabdelrahman/followers","following_url":"https://api.github.com/users/NETEROabdelrahman/following{/other_user}","gists_url":"https://api.github.com/users/NETEROabdelrahman/gists{/gist_id}","starred_url":"https://api.github.com/users/NETEROabdelrahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NETEROabdelrahman/subscriptions","organizations_url":"https://api.github.com/users/NETEROabdelrahman/orgs","repos_url":"https://api.github.com/users/NETEROabdelrahman/repos","events_url":"https://api.github.com/users/NETEROabdelrahman/events{/privacy}","received_events_url":"https://api.github.com/users/NETEROabdelrahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-22T15:49:21Z","updated_at":"2024-05-22T15:49:21Z","author_association":"NONE","body":"I figured out that Avira is blocking couchspawnkillable.exe, i restored the file and now create view is working just fine","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2125131995/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2125640011","html_url":"https://github.com/apache/couchdb/issues/4939#issuecomment-2125640011","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4939","id":2125640011,"node_id":"IC_kwDOAAMmUc5-srFL","user":{"login":"ErikVerheul","id":532341,"node_id":"MDQ6VXNlcjUzMjM0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/532341?v=4","gravatar_id":"","url":"https://api.github.com/users/ErikVerheul","html_url":"https://github.com/ErikVerheul","followers_url":"https://api.github.com/users/ErikVerheul/followers","following_url":"https://api.github.com/users/ErikVerheul/following{/other_user}","gists_url":"https://api.github.com/users/ErikVerheul/gists{/gist_id}","starred_url":"https://api.github.com/users/ErikVerheul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ErikVerheul/subscriptions","organizations_url":"https://api.github.com/users/ErikVerheul/orgs","repos_url":"https://api.github.com/users/ErikVerheul/repos","events_url":"https://api.github.com/users/ErikVerheul/events{/privacy}","received_events_url":"https://api.github.com/users/ErikVerheul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-22T19:55:58Z","updated_at":"2024-05-22T19:55:58Z","author_association":"NONE","body":"I experienced the same problem. To solve it check the -setcookie parameter in /opt/couchdb/etc/vm.args. Generate a long string with openssl rand -hex 32 or so and add it to your config.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2125640011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2130096594","html_url":"https://github.com/apache/couchdb/pull/5069#issuecomment-2130096594","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5069","id":2130096594,"node_id":"IC_kwDOAAMmUc5-9rHS","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-24T18:00:02Z","updated_at":"2024-05-24T18:00:02Z","author_association":"CONTRIBUTOR","body":"Closes #5065.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2130096594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2130097140","html_url":"https://github.com/apache/couchdb/issues/5065#issuecomment-2130097140","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5065","id":2130097140,"node_id":"IC_kwDOAAMmUc5-9rP0","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-24T18:00:27Z","updated_at":"2024-05-24T18:00:27Z","author_association":"CONTRIBUTOR","body":"Done via #5069.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2130097140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2140695807","html_url":"https://github.com/apache/couchdb/issues/5072#issuecomment-2140695807","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5072","id":2140695807,"node_id":"IC_kwDOAAMmUc5_mGz_","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-30T19:02:35Z","updated_at":"2024-05-30T19:02:35Z","author_association":"CONTRIBUTOR","body":"Does it worked before?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2140695807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2140700113","html_url":"https://github.com/apache/couchdb/issues/5023#issuecomment-2140700113","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5023","id":2140700113,"node_id":"IC_kwDOAAMmUc5_mH3R","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-30T19:04:39Z","updated_at":"2024-05-30T19:04:39Z","author_association":"CONTRIBUTOR","body":"No response from the user, closing for now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2140700113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2141238837","html_url":"https://github.com/apache/couchdb/pull/5073#issuecomment-2141238837","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5073","id":2141238837,"node_id":"IC_kwDOAAMmUc5_oLY1","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-31T05:05:27Z","updated_at":"2024-05-31T05:05:27Z","author_association":"CONTRIBUTOR","body":" To test, make two copies of the src directory, one with asdf shell erlang 26 the other with 25. `./configure && make && make release` in both and check that `re/couchdb/lib/*` doesn't have `.ez` archives.\r\n\r\nInstead of\r\n\r\n```\r\n% ls lib\r\nasn1-5.0.18.2/                                  hyper-1.0/\r\nasn1-5.0.18.2.ez                                hyper-1.0.ez\r\nb64url-3.3.2.post1-440-ga326cdc53/              ibrowse-4.4.2/\r\nb64url-3.3.2.post1-440-ga326cdc53.ez            ibrowse-4.4.2.ez\r\n```\r\n\r\nIt should look like\r\n\r\n```\r\n % ls rel/couchdb/lib\r\nasn1-5.0.18.2/                               hyper-1.0/\r\nb64url-3.3.2.post1-440-ga326cdc53/           ibrowse-4.4.2/\r\nchttpd-3.3.2.post1-440-ga326cdc53/           inets-7.5.3.4/\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2141238837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2143345124","html_url":"https://github.com/apache/couchdb/issues/5072#issuecomment-2143345124","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5072","id":2143345124,"node_id":"IC_kwDOAAMmUc5_wNnk","user":{"login":"Drayton007","id":171241376,"node_id":"U_kgDOCjTvoA","avatar_url":"https://avatars.githubusercontent.com/u/171241376?v=4","gravatar_id":"","url":"https://api.github.com/users/Drayton007","html_url":"https://github.com/Drayton007","followers_url":"https://api.github.com/users/Drayton007/followers","following_url":"https://api.github.com/users/Drayton007/following{/other_user}","gists_url":"https://api.github.com/users/Drayton007/gists{/gist_id}","starred_url":"https://api.github.com/users/Drayton007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Drayton007/subscriptions","organizations_url":"https://api.github.com/users/Drayton007/orgs","repos_url":"https://api.github.com/users/Drayton007/repos","events_url":"https://api.github.com/users/Drayton007/events{/privacy}","received_events_url":"https://api.github.com/users/Drayton007/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-01T07:42:03Z","updated_at":"2024-06-01T07:42:03Z","author_association":"NONE","body":"Never worked before , seems that erl.exe crash ing and not able to start , the C++ seems to be okay ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2143345124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2149171640","html_url":"https://github.com/apache/couchdb/issues/5072#issuecomment-2149171640","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5072","id":2149171640,"node_id":"IC_kwDOAAMmUc6AGcG4","user":{"login":"Drayton007","id":171241376,"node_id":"U_kgDOCjTvoA","avatar_url":"https://avatars.githubusercontent.com/u/171241376?v=4","gravatar_id":"","url":"https://api.github.com/users/Drayton007","html_url":"https://github.com/Drayton007","followers_url":"https://api.github.com/users/Drayton007/followers","following_url":"https://api.github.com/users/Drayton007/following{/other_user}","gists_url":"https://api.github.com/users/Drayton007/gists{/gist_id}","starred_url":"https://api.github.com/users/Drayton007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Drayton007/subscriptions","organizations_url":"https://api.github.com/users/Drayton007/orgs","repos_url":"https://api.github.com/users/Drayton007/repos","events_url":"https://api.github.com/users/Drayton007/events{/privacy}","received_events_url":"https://api.github.com/users/Drayton007/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-05T08:15:10Z","updated_at":"2024-06-06T07:39:11Z","author_association":"NONE","body":"\r\n[erl_crash.txt](https://github.com/user-attachments/files/15605503/erl_crash.txt)\r\nwindows event log showing this issue : \r\n![image](https://github.com/apache/couchdb/assets/171241376/46b82079-7efd-42ef-bdc3-feea04bd33dd)\r\n\r\ngetting dump file created when trying to run erl.exe\r\nSlogan: init terminating in do_boot ({cannot get bootfile,C:\\CouchDB/bin/start.boot})\r\n\r\n![image](https://github.com/apache/couchdb/assets/171241376/63b3d972-806d-4e43-a389-549f000bc044)\r\n\r\n\r\nany suggestions or thoughts ? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2149171640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2149328339","html_url":"https://github.com/apache/couchdb/issues/5051#issuecomment-2149328339","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5051","id":2149328339,"node_id":"IC_kwDOAAMmUc6AHCXT","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-05T09:30:54Z","updated_at":"2024-06-05T09:30:54Z","author_association":"MEMBER","body":"fixed in https://github.com/apache/couchdb-pkg/pull/125","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2149328339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2149975723","html_url":"https://github.com/apache/couchdb/issues/5072#issuecomment-2149975723","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5072","id":2149975723,"node_id":"IC_kwDOAAMmUc6AJgar","user":{"login":"Drayton007","id":171241376,"node_id":"U_kgDOCjTvoA","avatar_url":"https://avatars.githubusercontent.com/u/171241376?v=4","gravatar_id":"","url":"https://api.github.com/users/Drayton007","html_url":"https://github.com/Drayton007","followers_url":"https://api.github.com/users/Drayton007/followers","following_url":"https://api.github.com/users/Drayton007/following{/other_user}","gists_url":"https://api.github.com/users/Drayton007/gists{/gist_id}","starred_url":"https://api.github.com/users/Drayton007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Drayton007/subscriptions","organizations_url":"https://api.github.com/users/Drayton007/orgs","repos_url":"https://api.github.com/users/Drayton007/repos","events_url":"https://api.github.com/users/Drayton007/events{/privacy}","received_events_url":"https://api.github.com/users/Drayton007/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-05T13:40:04Z","updated_at":"2024-06-05T13:40:04Z","author_association":"NONE","body":"@wohali any idea on this issue ?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2149975723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2150238057","html_url":"https://github.com/apache/couchdb/issues/5077#issuecomment-2150238057","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5077","id":2150238057,"node_id":"IC_kwDOAAMmUc6AKgdp","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-05T14:43:35Z","updated_at":"2024-06-05T14:43:35Z","author_association":"CONTRIBUTOR","body":"Hi,\r\n\r\nUbuntu 24.04 LTS isn't listed under the [convenience binary packages](https://docs.couchdb.org/en/latest/install/unix.html#installation-using-the-apache-couchdb-convenience-binary-packages) section in our docs, so you get the error message you encountered. I think and hope that this will be done in the near future.\r\n\r\nIn the meantime you could use the [Snap package](https://snapcraft.io/couchdb) or build CouchDB on your Raspi by yourself.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2150238057/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2150258871","html_url":"https://github.com/apache/couchdb/issues/5072#issuecomment-2150258871","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5072","id":2150258871,"node_id":"IC_kwDOAAMmUc6AKli3","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-05T14:48:47Z","updated_at":"2024-06-05T14:48:47Z","author_association":"CONTRIBUTOR","body":"Can you completely remove an re-install the latest version v3.3.3?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2150258871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2150975146","html_url":"https://github.com/apache/couchdb/issues/5072#issuecomment-2150975146","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5072","id":2150975146,"node_id":"IC_kwDOAAMmUc6ANUaq","user":{"login":"Drayton007","id":171241376,"node_id":"U_kgDOCjTvoA","avatar_url":"https://avatars.githubusercontent.com/u/171241376?v=4","gravatar_id":"","url":"https://api.github.com/users/Drayton007","html_url":"https://github.com/Drayton007","followers_url":"https://api.github.com/users/Drayton007/followers","following_url":"https://api.github.com/users/Drayton007/following{/other_user}","gists_url":"https://api.github.com/users/Drayton007/gists{/gist_id}","starred_url":"https://api.github.com/users/Drayton007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Drayton007/subscriptions","organizations_url":"https://api.github.com/users/Drayton007/orgs","repos_url":"https://api.github.com/users/Drayton007/repos","events_url":"https://api.github.com/users/Drayton007/events{/privacy}","received_events_url":"https://api.github.com/users/Drayton007/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-05T21:15:32Z","updated_at":"2024-06-06T07:40:13Z","author_association":"NONE","body":"attached the erl_crash file \r\n[erl_crash.txt](https://github.com/user-attachments/files/15605507/erl_crash.txt)\r\nwe did many times but did not help , we are already using 3.3.3\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2150975146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2153061688","html_url":"https://github.com/apache/couchdb/pull/5080#issuecomment-2153061688","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5080","id":2153061688,"node_id":"IC_kwDOAAMmUc6AVR04","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-06T17:34:28Z","updated_at":"2024-06-06T17:34:28Z","author_association":"CONTRIBUTOR","body":"Hopefully fixes the failing rtd pdf build ...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2153061688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2153224222","html_url":"https://github.com/apache/couchdb/issues/5072#issuecomment-2153224222","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5072","id":2153224222,"node_id":"IC_kwDOAAMmUc6AV5ge","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-06T19:05:16Z","updated_at":"2024-06-06T19:05:16Z","author_association":"CONTRIBUTOR","body":"Looking at your screenshots, there where different CouchDB version installed. Please remove them all and delete all existing CouchDB dirs and reinstall it. For testing purpose, don't install the CouchDB service and try to start CouchDB from an admin shell after installation.\r\nDo you have any anti-virus software running?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2153224222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2153487854","html_url":"https://github.com/apache/couchdb/pull/5081#issuecomment-2153487854","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5081","id":2153487854,"node_id":"IC_kwDOAAMmUc6AW53u","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-06T22:13:58Z","updated_at":"2024-06-06T22:13:58Z","author_association":"CONTRIBUTOR","body":"It did show one failure:\r\n\r\n```\r\n024-06-06T22:09:44.508Z] Caching disabled for task ':test' because:\r\n\r\n[2024-06-06T22:09:44.508Z]   Build cache is disabled\r\n\r\n[2024-06-06T22:09:44.508Z] Task ':test' is not up-to-date because:\r\n\r\n[2024-06-06T22:09:44.508Z]   Task.upToDateWhen is false.\r\n\r\n[2024-06-06T22:09:44.508Z] Starting process 'Gradle Test Executor 1'. Working directory: /home/jenkins/workspace/jenkins-cm1_PullRequests_PR-5081/25.3.2.12/build/apache-couchdb-3.3.3-89a5769/nouveau Command: /opt/java/openjdk/bin/java -Dorg.gradle.internal.worker.tmpdir=/home/jenkins/workspace/jenkins-cm1_PullRequests_PR-5081/25.3.2.12/build/apache-couchdb-3.3.3-89a5769/nouveau/build/tmp/test/work -Dorg.gradle.native=false -javaagent:/home/jenkins/workspace/jenkins-cm1_PullRequests_PR-5081/25.3.2.12/build/apache-couchdb-3.3.3-89a5769/nouveau/build/tmp/.cache/expanded/zip_cde35f471dab581134460fc9a50e2c59/jacocoagent.jar=destfile=build/jacoco/test.exec,append=true,inclnolocationclasses=false,dumponexit=true,output=file,jmx=false @/home/jenkins/.gradle/.tmp/gradle-worker-classpath17310477907838578221txt -Xmx512m -Dfile.encoding=US-ASCII -Duser.country=US -Duser.language=en -Duser.variant -ea worker.org.gradle.process.internal.worker.GradleWorkerMain 'Gradle Test Executor 1'\r\n\r\n[2024-06-06T22:09:44.508Z] Successfully started process 'Gradle Test Executor 1'\r\n[2024-06-06T22:09:45.706Z] \r\n[2024-06-06T22:09:45.706Z] IndexHealthCheckTest > testIndexHealthCheck(Path) STANDARD_OUT\r\n[2024-06-06T22:09:45.706Z]     22:09:45.555 [Test worker] INFO org.apache.couchdb.nouveau.core.IndexManager -- deleting indexes below ___test9 (excluding nothing)\r\n[2024-06-06T22:09:45.706Z]     22:09:45.586 [ForkJoinPool.commonPool-worker-3] INFO org.apache.couchdb.nouveau.core.IndexManager -- opening ___test9\r\n[2024-06-06T22:09:46.052Z]     22:09:45.985 [Test worker] INFO org.apache.couchdb.nouveau.core.IndexManager -- closing ___test9 for cause EXPIRED\r\n[2024-06-06T22:09:46.398Z]     22:09:46.167 [Test worker] DEBUG org.apache.couchdb.nouveau.core.IndexManager -- committed ___test9 before close\r\n[2024-06-06T22:09:46.398Z]     22:09:46.173 [ForkJoinPool.commonPool-worker-3] INFO org.apache.couchdb.nouveau.core.IndexManager -- opening ___test9\r\n[2024-06-06T22:09:46.743Z]     22:09:46.366 [Test worker] INFO org.apache.couchdb.nouveau.core.IndexManager -- deleting indexes below ___test9 (excluding nothing)\r\n[2024-06-06T22:09:47.940Z] \r\n[2024-06-06T22:09:47.940Z] Gradle Test Executor 1 finished executing tests.\r\n[2024-06-06T22:09:47.940Z] \r\n[2024-06-06T22:09:47.940Z] > Task :test\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2153487854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2153506510","html_url":"https://github.com/apache/couchdb/pull/5081#issuecomment-2153506510","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5081","id":2153506510,"node_id":"IC_kwDOAAMmUc6AW-bO","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-06T22:31:54Z","updated_at":"2024-06-06T22:31:54Z","author_association":"CONTRIBUTOR","body":"Interestingly, the failure is not always the same. In a previous run on main the reason for closure was `SIZE` while in the case above it's `EXPIRED`\r\n\r\n```\r\n\r\n[2024-06-06T20:54:41.651Z] IndexHealthCheckTest > testIndexHealthCheck(Path) STANDARD_OUT\r\n[2024-06-06T20:54:41.651Z]     20:54:41.136 [Test worker] INFO org.apache.couchdb.nouveau.core.IndexManager -- deleting indexes below ___test9 (excluding nothing)\r\n[2024-06-06T20:54:41.651Z]     20:54:41.168 [ForkJoinPool.commonPool-worker-3] INFO org.apache.couchdb.nouveau.core.IndexManager -- opening ___test9\r\n[2024-06-06T20:54:41.996Z]     20:54:41.554 [ForkJoinPool.commonPool-worker-5] INFO org.apache.couchdb.nouveau.core.IndexManager -- closing ___test9 for cause SIZE\r\n[2024-06-06T20:54:41.996Z]     20:54:41.596 [ForkJoinPool.commonPool-worker-5] DEBUG org.apache.couchdb.nouveau.core.IndexManager -- committed ___test9 before close\r\n[2024-06-06T20:54:41.996Z]     20:54:41.706 [ForkJoinPool.commonPool-worker-3] INFO org.apache.couchdb.nouveau.core.IndexManager -- opening ___test9\r\n[2024-06-06T20:54:41.996Z]     20:54:41.723 [ForkJoinPool.commonPool-worker-7] INFO org.apache.couchdb.nouveau.core.IndexManager -- closing ___test9 for cause SIZE\r\n[2024-06-06T20:54:41.996Z]     20:54:41.890 [Test worker] INFO org.apache.couchdb.nouveau.core.IndexManager -- deleting indexes below ___test9 (excluding nothing)\r\n[2024-06-06T20:54:42.464Z] \r\n[2024-06-06T20:54:42.464Z] IndexHealthCheckTest > testIndexHealthCheck(Path) FAILED\r\n[2024-06-06T20:54:42.464Z]     org.opentest4j.AssertionFailedError: Result{isHealthy=false, message=Wrong number of search results, expected 1, got 0, duration=0, timestamp=2024-06-06T20:54:41.890Z} ==> expected: <true> but was: <false>\r\n[2024-06-06T20:54:42.464Z]         at app//org.junit.jupiter.api.AssertionFailureBuilder.build(AssertionFailureBuilder.java:151)\r\n[2024-06-06T20:54:42.464Z]         at app//org.junit.jupiter.api.AssertionFailureBuilder.buildAndThrow(AssertionFailureBuilder.java:132)\r\n[2024-06-06T20:54:42.464Z]         at app//org.junit.jupiter.api.AssertTrue.failNotTrue(AssertTrue.java:63)\r\n[2024-06-06T20:54:42.464Z]         at app//org.junit.jupiter.api.AssertTrue.assertTrue(AssertTrue.java:36)\r\n[2024-06-06T20:54:42.464Z]         at app//org.junit.jupiter.api.Assertions.assertTrue(Assertions.java:214)\r\n[2024-06-06T20:54:42.464Z]         at app//org.apache.couchdb.nouveau.health.IndexHealthCheckTest.testIndexHealthCheck(IndexHealthCheckTest.java:45)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2153506510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2154274544","html_url":"https://github.com/apache/couchdb/pull/5081#issuecomment-2154274544","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5081","id":2154274544,"node_id":"IC_kwDOAAMmUc6AZ57w","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-07T07:41:03Z","updated_at":"2024-06-07T07:41:03Z","author_association":"MEMBER","body":"@nickva good catch, that was also because idleseconds defaults to zero.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2154274544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2161452315","html_url":"https://github.com/apache/couchdb/issues/1497#issuecomment-2161452315","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1497","id":2161452315,"node_id":"IC_kwDOAAMmUc6A1SUb","user":{"login":"pertsevds","id":33601,"node_id":"MDQ6VXNlcjMzNjAx","avatar_url":"https://avatars.githubusercontent.com/u/33601?v=4","gravatar_id":"","url":"https://api.github.com/users/pertsevds","html_url":"https://github.com/pertsevds","followers_url":"https://api.github.com/users/pertsevds/followers","following_url":"https://api.github.com/users/pertsevds/following{/other_user}","gists_url":"https://api.github.com/users/pertsevds/gists{/gist_id}","starred_url":"https://api.github.com/users/pertsevds/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pertsevds/subscriptions","organizations_url":"https://api.github.com/users/pertsevds/orgs","repos_url":"https://api.github.com/users/pertsevds/repos","events_url":"https://api.github.com/users/pertsevds/events{/privacy}","received_events_url":"https://api.github.com/users/pertsevds/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-11T19:20:23Z","updated_at":"2024-06-11T19:20:23Z","author_association":"NONE","body":"How about https://github.com/mtrudel/bandit ?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2161452315/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2161466505","html_url":"https://github.com/apache/couchdb/issues/1497#issuecomment-2161466505","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1497","id":2161466505,"node_id":"IC_kwDOAAMmUc6A1VyJ","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-11T19:29:12Z","updated_at":"2024-06-11T19:29:12Z","author_association":"CONTRIBUTOR","body":"If it's integrates and works well with Erlang. To me, cowboy so far seems the most promising and been around the longest. Even started to gain some experimental HTTP3 support lately, as well.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2161466505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2167111488","html_url":"https://github.com/apache/couchdb/pull/5088#issuecomment-2167111488","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5088","id":2167111488,"node_id":"IC_kwDOAAMmUc6BK39A","user":{"login":"ben-manes","id":378614,"node_id":"MDQ6VXNlcjM3ODYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/378614?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-manes","html_url":"https://github.com/ben-manes","followers_url":"https://api.github.com/users/ben-manes/followers","following_url":"https://api.github.com/users/ben-manes/following{/other_user}","gists_url":"https://api.github.com/users/ben-manes/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-manes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-manes/subscriptions","organizations_url":"https://api.github.com/users/ben-manes/orgs","repos_url":"https://api.github.com/users/ben-manes/repos","events_url":"https://api.github.com/users/ben-manes/events{/privacy}","received_events_url":"https://api.github.com/users/ben-manes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-14T02:46:05Z","updated_at":"2024-06-14T02:56:39Z","author_association":"NONE","body":"did you intend to have `IndexEvictionListener` run atomically within the map operation that removes the entry? In your new logic you defer that work to be asynchronous, so I believe you could use `Caffeine.removalListener` with `cause.wasEvicted()` or dispatch it yourself for the same effect. The naming is a little unobvious, unfortunately, and a characteristic of feature evolution and keeping familiarity with Guava Cache for straightforward migrations.\r\n\r\nEdit:\r\noops, I missed that `removeEldestEntry` always returns `false` to evict the entry asynchronously.\r\n\r\nI suppose another alternative would be to atomically evict into a victim cache which the `AsyncIndexLoader`. The `AsyncIndexLoader` could load from that first if the entry was found, either removing it or optionally having the `IndexWeigher` give the entry the weight of zero while unloading. When the `IndexEvictionListener` evicts it to the victim cache it could do your unloading procedure to discard it fully. I don't know whether that dance is any better than your own code that you can more easily understand and control, so just providing options if a helpful thought exercise.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2167111488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2167524989","html_url":"https://github.com/apache/couchdb/pull/5088#issuecomment-2167524989","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5088","id":2167524989,"node_id":"IC_kwDOAAMmUc6BMc59","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-14T08:29:06Z","updated_at":"2024-06-14T08:29:06Z","author_association":"MEMBER","body":"@ben-manes Hi, and thanks for jumping in (and for developing Caffeine). Yes, I need the eviction to happen atomically (or, at least, no client should try to use the item while it is unloading), and it can be very slow (potentially minutes). I concluded that I was using Caffeine inappropriately; caching stateful objects that have a mutex external to the JVM, a file-based lock, where loading _and_ evicting can be very slow.\r\n\r\nI need to ensure that any given cache entry is loaded and not unloading at the time of any interaction. I also can't load the same item twice (Lucene's write.lock is preventing that for very good reasons), which made the race between an eviction and a concurrent get() somewhat fun.\r\n\r\nAs you've seen I'm just using `LinkedHashMap` as a way to trigger awareness that we're at capacity, and I perform the unloading later. Happy to just accept that we might go a little over capacity, the trade-off in code simplicity is worth it to me.\r\n\r\nYour suggestions are very helpful though, and I might be pulled back to Caffeine for this as I get more results from real world performance (I am not too thrilled about the synchronized(cache) bits, especially when reading the cache). What I like about this PR though is it pulls all of the concurrency logic into IndexManager directly, and there's not too much of it. Time will tell if it holds up, of course.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2167524989/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2168313452","html_url":"https://github.com/apache/couchdb/pull/5088#issuecomment-2168313452","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5088","id":2168313452,"node_id":"IC_kwDOAAMmUc6BPdZs","user":{"login":"ben-manes","id":378614,"node_id":"MDQ6VXNlcjM3ODYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/378614?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-manes","html_url":"https://github.com/ben-manes","followers_url":"https://api.github.com/users/ben-manes/followers","following_url":"https://api.github.com/users/ben-manes/following{/other_user}","gists_url":"https://api.github.com/users/ben-manes/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-manes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-manes/subscriptions","organizations_url":"https://api.github.com/users/ben-manes/orgs","repos_url":"https://api.github.com/users/ben-manes/repos","events_url":"https://api.github.com/users/ben-manes/events{/privacy}","received_events_url":"https://api.github.com/users/ben-manes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-14T15:52:34Z","updated_at":"2024-06-14T15:52:34Z","author_association":"NONE","body":"Since the mapping is discarded asynchronously, I suppose `removeEldestEntry` could try to evict the same one multiple times during a slow unloading? In those cases then once that completes the cache would still exceed its capacity and be stuck there, since the call only happens once on insertion. I think you would need to prune the cache yourself after unloading to avoid a memory leak.\r\n\r\nIf you need a quick-and-dirty concurrent cache, the simple and classic and earliest approaches are to use a Clock (aka SecondChance) or a random sampling based strategy. These are popular, easy to write and maintain, can have good hit rates, are lock-free on reads, and the longer lock hold time on a write is typically okay for small caches. The exact workloads where they are good and bad varies, so it can require algorithm tuning to maximize hit rates, whereas Caffeine does that automatically.\r\n\r\nIt sounds like the key insight of your approach is to evict the entry from the eviction policy while asynchronously removing it from the data map. Caffeine works the other way by keeping the data map linearizable (as user-visible) and the policy eventually consistent. If you decided to keep using Caffeine then you could have it act as the policy but store the data in a another hash table and use the loader + listener for coordination. You can think of that as an L1 / L2 inclusive cache where L1 pulls from L2 and L2 invalidations are sent to L1. That's not uncommon for local + remote cache layers, but here both would be on-heap.\r\n\r\nHowever you go about it, it sounds like a fun but tricky little problem.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2168313452/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2168331840","html_url":"https://github.com/apache/couchdb/pull/5088#issuecomment-2168331840","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5088","id":2168331840,"node_id":"IC_kwDOAAMmUc6BPh5A","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-14T16:04:37Z","updated_at":"2024-06-14T16:04:37Z","author_association":"MEMBER","body":"hmm, maybe. concurrent attempts to cache.get() while we're unloading should all get the IndexHolder while it is either write-locked (currently unloading) or not locked but in the UN_LOADED state (in which event we retry, as the entry should be removed from the cache and the first thread that gets the lock on `cache` will create a new IndexHolder in NOT_LOADED state). However, it's exactly all these kinds of cases that I wanted to delegate to something else, like Caffeine, so I will be holding off merging this PR while I ponder it some more.\r\n\r\nYou've given me a lot to think about, and, yes, it _is_ a surprisingly fun little problem to solve. You'd think on my third \"full text for couchdb\" codebase that I'd have a solid solution to it by now. alas...\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2168331840/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2171745244","html_url":"https://github.com/apache/couchdb/issues/5090#issuecomment-2171745244","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5090","id":2171745244,"node_id":"IC_kwDOAAMmUc6BcjPc","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-16T15:33:55Z","updated_at":"2024-06-16T15:33:55Z","author_association":"CONTRIBUTOR","body":"Do you have a minimal working example, like a script to reproduce this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2171745244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2171770016","html_url":"https://github.com/apache/couchdb/issues/5090#issuecomment-2171770016","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5090","id":2171770016,"node_id":"IC_kwDOAAMmUc6BcpSg","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-16T16:56:44Z","updated_at":"2024-06-16T16:56:44Z","author_association":"MEMBER","body":"This is possible if N>1 (i.e, you have a cluster, not a standalone single node) for a period of time. Once the DELETE has happened at all N nodes subsequent queries (assuming you didn't specify update=false or stale=ok) will not return that document. There can be a period where a DELETE is completed (i.e, you get a 200 OK response) but one or more nodes have not yet processed it, a _find at that time might get a response from one of those nodes (all queries are inherently R=1, they read just one of the copies).\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2171770016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172113263","html_url":"https://github.com/apache/couchdb/issues/5090#issuecomment-2172113263","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5090","id":2172113263,"node_id":"IC_kwDOAAMmUc6Bd9Fv","user":{"login":"lpcy","id":70789644,"node_id":"MDQ6VXNlcjcwNzg5NjQ0","avatar_url":"https://avatars.githubusercontent.com/u/70789644?v=4","gravatar_id":"","url":"https://api.github.com/users/lpcy","html_url":"https://github.com/lpcy","followers_url":"https://api.github.com/users/lpcy/followers","following_url":"https://api.github.com/users/lpcy/following{/other_user}","gists_url":"https://api.github.com/users/lpcy/gists{/gist_id}","starred_url":"https://api.github.com/users/lpcy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lpcy/subscriptions","organizations_url":"https://api.github.com/users/lpcy/orgs","repos_url":"https://api.github.com/users/lpcy/repos","events_url":"https://api.github.com/users/lpcy/events{/privacy}","received_events_url":"https://api.github.com/users/lpcy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-17T03:35:38Z","updated_at":"2024-06-17T03:35:38Z","author_association":"NONE","body":"> This is possible if N>1 (i.e, you have a cluster, not a standalone single node) for a period of time. Once the DELETE has happened at all N nodes subsequent queries (assuming you didn't specify update=false or stale=ok) will not return that document. There can be a period where a DELETE is completed (i.e, you get a 200 OK response) but one or more nodes have not yet processed it, a _find at that time might get a response from one of those nodes (all queries are inherently R=1, they read just one of the copies).\r\n\r\nThank you, I'm sorry but I realized that I made an error: delete in the code is asynchronous. \r\nAt the same time, there is a new question: Is the tombstone information always retained? Is there any way to clean it up? It seems that Google's method is to synchronize to a new database while excluding deleted documents, which seems cumbersome. Currently, I am using a single node.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172113263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172115008","html_url":"https://github.com/apache/couchdb/issues/5090#issuecomment-2172115008","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5090","id":2172115008,"node_id":"IC_kwDOAAMmUc6Bd9hA","user":{"login":"lpcy","id":70789644,"node_id":"MDQ6VXNlcjcwNzg5NjQ0","avatar_url":"https://avatars.githubusercontent.com/u/70789644?v=4","gravatar_id":"","url":"https://api.github.com/users/lpcy","html_url":"https://github.com/lpcy","followers_url":"https://api.github.com/users/lpcy/followers","following_url":"https://api.github.com/users/lpcy/following{/other_user}","gists_url":"https://api.github.com/users/lpcy/gists{/gist_id}","starred_url":"https://api.github.com/users/lpcy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lpcy/subscriptions","organizations_url":"https://api.github.com/users/lpcy/orgs","repos_url":"https://api.github.com/users/lpcy/repos","events_url":"https://api.github.com/users/lpcy/events{/privacy}","received_events_url":"https://api.github.com/users/lpcy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-17T03:38:23Z","updated_at":"2024-06-17T03:38:23Z","author_association":"NONE","body":"> Do you have a minimal working example, like a script to reproduce this?\r\n\r\nI rewrote the script and found it to be working properly. Sorry, it's my problem: delete is asynchronous.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172115008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172500693","html_url":"https://github.com/apache/couchdb/issues/5090#issuecomment-2172500693","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5090","id":2172500693,"node_id":"IC_kwDOAAMmUc6BfbrV","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-17T07:27:22Z","updated_at":"2024-06-17T07:27:22Z","author_association":"MEMBER","body":"\"Tombstone\" is a loose term, more precisely it is a document with the deleted flag set to true, and may contain other data. They are preserved forever, just as non-deleted documents are, to ensure that replication works correctly. You can replicate with a filter to drop them (or any other subset of documents) as long as you're aware of that consequence.\r\n\r\nDelete is not asynchronous (any more than doc create or update is), I'm referring to the way we only wait for the first 2 of the total 3 responses in a 3 or more node cluster, which seems not to apply in your case.\r\n\r\nIf this is a single node setup then your opening comment is a bit more interesting. when the DELETE response is returned the document has been marked as deleted, and so any subsequent request should reflect that, including indexes (`_view`, `_find`, etc). Are you querying with stale=ok or update=false parameters? Assuming not, how long is the delay between the deleted document appearing in results after deletion and it finally being gone?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172500693/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172716154","html_url":"https://github.com/apache/couchdb/issues/5090#issuecomment-2172716154","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5090","id":2172716154,"node_id":"IC_kwDOAAMmUc6BgQR6","user":{"login":"lpcy","id":70789644,"node_id":"MDQ6VXNlcjcwNzg5NjQ0","avatar_url":"https://avatars.githubusercontent.com/u/70789644?v=4","gravatar_id":"","url":"https://api.github.com/users/lpcy","html_url":"https://github.com/lpcy","followers_url":"https://api.github.com/users/lpcy/followers","following_url":"https://api.github.com/users/lpcy/following{/other_user}","gists_url":"https://api.github.com/users/lpcy/gists{/gist_id}","starred_url":"https://api.github.com/users/lpcy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lpcy/subscriptions","organizations_url":"https://api.github.com/users/lpcy/orgs","repos_url":"https://api.github.com/users/lpcy/repos","events_url":"https://api.github.com/users/lpcy/events{/privacy}","received_events_url":"https://api.github.com/users/lpcy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-17T08:47:54Z","updated_at":"2024-06-17T08:47:54Z","author_association":"NONE","body":"> \"Tombstone\" is a loose term, more precisely it is a document with the deleted flag set to true, and may contain other data. They are preserved forever, just as non-deleted documents are, to ensure that replication works correctly. You can replicate with a filter to drop them (or any other subset of documents) as long as you're aware of that consequence.\r\n> \r\n> Delete is not asynchronous (any more than doc create or update is), I'm referring to the way we only wait for the first 2 of the total 3 responses in a 3 or more node cluster, which seems not to apply in your case.\r\n> \r\n> If this is a single node setup then your opening comment is a bit more interesting. when the DELETE response is returned the document has been marked as deleted, and so any subsequent request should reflect that, including indexes (`_view`, `_find`, etc). Are you querying with stale=ok or update=false parameters? Assuming not, how long is the delay between the deleted document appearing in results after deletion and it finally being gone?\r\n\r\nThank you for your patient answer. Actually, what I meant was that the reason for my original question was that I used DELETE in the asynchronous environment of JavaScript, which caused _find to retrieve old data at the same time. This issue can be ignored.\r\nThe \"Tombstone\" you mentioned is for replication, but if I don't have replication requirements, is there a simple command to clear them? Will not cleaning them have an impact on database performance?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172716154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172755446","html_url":"https://github.com/apache/couchdb/issues/5090#issuecomment-2172755446","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5090","id":2172755446,"node_id":"IC_kwDOAAMmUc6BgZ32","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-17T09:06:59Z","updated_at":"2024-06-17T09:07:08Z","author_association":"MEMBER","body":"Ah, that makes sense, thank you for clarifying.\r\n\r\nIf you don't need to keep deleted documents, as you never replicate, you can use the [purge](https://docs.couchdb.org/en/stable/api/database/misc.html) endpoint. The main downside to keeping them is the disk space they will continue to occupy. This is quite small (assuming you used the DELETE method which also empties the document body) but it is not zero.\r\n\r\nAlternative strategies;\r\n\r\n1) if your data is temporal/time-based, you could make a database for distinct time periods (say, monthly), and when your oldest database contains only deleted documents you simply delete the entire database.\r\n2) periodically replicate the database to a new database but with a filter that rejects deleted documents, then switch usage to the new database.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172755446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172855644","html_url":"https://github.com/apache/couchdb/issues/5090#issuecomment-2172855644","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5090","id":2172855644,"node_id":"IC_kwDOAAMmUc6BgyVc","user":{"login":"lpcy","id":70789644,"node_id":"MDQ6VXNlcjcwNzg5NjQ0","avatar_url":"https://avatars.githubusercontent.com/u/70789644?v=4","gravatar_id":"","url":"https://api.github.com/users/lpcy","html_url":"https://github.com/lpcy","followers_url":"https://api.github.com/users/lpcy/followers","following_url":"https://api.github.com/users/lpcy/following{/other_user}","gists_url":"https://api.github.com/users/lpcy/gists{/gist_id}","starred_url":"https://api.github.com/users/lpcy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lpcy/subscriptions","organizations_url":"https://api.github.com/users/lpcy/orgs","repos_url":"https://api.github.com/users/lpcy/repos","events_url":"https://api.github.com/users/lpcy/events{/privacy}","received_events_url":"https://api.github.com/users/lpcy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-17T09:26:19Z","updated_at":"2024-06-17T09:26:19Z","author_association":"NONE","body":"> Ah, that makes sense, thank you for clarifying.\r\n> \r\n> If you don't need to keep deleted documents, as you never replicate, you can use the [purge](https://docs.couchdb.org/en/stable/api/database/misc.html) endpoint. The main downside to keeping them is the disk space they will continue to occupy. This is quite small (assuming you used the DELETE method which also empties the document body) but it is not zero.\r\n> \r\n> Alternative strategies;\r\n> \r\n> 1. if your data is temporal/time-based, you could make a database for distinct time periods (say, monthly), and when your oldest database contains only deleted documents you simply delete the entire database.\r\n> 2. periodically replicate the database to a new database but with a filter that rejects deleted documents, then switch usage to the new database.\r\n\r\nThank you again for your answer, I've got it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2172855644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2175821151","html_url":"https://github.com/apache/couchdb/issues/5091#issuecomment-2175821151","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5091","id":2175821151,"node_id":"IC_kwDOAAMmUc6BsGVf","user":{"login":"Stwissel","id":542549,"node_id":"MDQ6VXNlcjU0MjU0OQ==","avatar_url":"https://avatars.githubusercontent.com/u/542549?v=4","gravatar_id":"","url":"https://api.github.com/users/Stwissel","html_url":"https://github.com/Stwissel","followers_url":"https://api.github.com/users/Stwissel/followers","following_url":"https://api.github.com/users/Stwissel/following{/other_user}","gists_url":"https://api.github.com/users/Stwissel/gists{/gist_id}","starred_url":"https://api.github.com/users/Stwissel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stwissel/subscriptions","organizations_url":"https://api.github.com/users/Stwissel/orgs","repos_url":"https://api.github.com/users/Stwissel/repos","events_url":"https://api.github.com/users/Stwissel/events{/privacy}","received_events_url":"https://api.github.com/users/Stwissel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-18T10:59:58Z","updated_at":"2024-06-18T10:59:58Z","author_association":"NONE","body":".... aaaaand once submitted the ticket, the solution presented itself:\r\n\r\n## WRONG\r\n\r\n```bash\r\ncurl --request PUT 'http://localhost:5984/_node/nonode@nohost/_config/jwt_keys/rsa:S1-oBDEUlMfN-FP5EeG6UcaKdeCs01_dx5AIw-SogiQ' \\\r\n--header 'Content-Type: application/json' \\\r\n--header 'Authorization: Basic YWRtaW46cGFzc3dvcmQ=' \\\r\n--data '\"-----BEGIN PUBLIC KEY-----\\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx9SJFyVWvBonL3K+giuzeQ4Vp1bH9ftu\\nzjrtLMMBUWESQEMXsml7s58/8UOWQ40j71eu+63sLvCnLhcP9jmKI8vwofkMo91ulZn2ntKTsawJ\\nmnrR7k1W5okbLlnwYq1KN3SRcjeHYa3JruoDmHHW9dO5dAGu09ookgWxYr2K1jXT1+L1NFOfBXqs\\njFqr3a+ArMOg5POcg9I6lI9kmi8aOJgTfRydJbuUC8vtgc7rdHY4g7IdGlOM+LWdor23P16vzfVK\\nGNDNbi072S0vzkt+Q/WLb9UuQi64wB3LxVLDfUKNg2OGJ6/ju1bZX+Fo02hG6lkMa2BO3CwmirGR\\nLiWb4wIDAQAB\\n-----END PUBLIC KEY-----\\n\"'\r\n```\r\n\r\n## Right\r\n\r\n```bash\r\ncurl --request PUT 'http://localhost:5984/_node/nonode@nohost/_config/jwt_keys/rsa:S1-oBDEUlMfN-FP5EeG6UcaKdeCs01_dx5AIw-SogiQ' \\\r\n--header 'Content-Type: application/json' \\\r\n--header 'Authorization: Basic YWRtaW46cGFzc3dvcmQ=' \\\r\n--data '\"-----BEGIN PUBLIC KEY-----\\\\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx9SJFyVWvBonL3K+giuzeQ4Vp1bH9ftu\\\\nzjrtLMMBUWESQEMXsml7s58/8UOWQ40j71eu+63sLvCnLhcP9jmKI8vwofkMo91ulZn2ntKTsawJ\\\\nmnrR7k1W5okbLlnwYq1KN3SRcjeHYa3JruoDmHHW9dO5dAGu09ookgWxYr2K1jXT1+L1NFOfBXqs\\\\njFqr3a+ArMOg5POcg9I6lI9kmi8aOJgTfRydJbuUC8vtgc7rdHY4g7IdGlOM+LWdor23P16vzfVK\\\\nGNDNbi072S0vzkt+Q/WLb9UuQi64wB3LxVLDfUKNg2OGJ6/ju1bZX+Fo02hG6lkMa2BO3CwmirGR\\\\nLiWb4wIDAQAB\\\\n-----END PUBLIC KEY-----\\\\n\"'\r\n```\r\n\r\nhttp treats `\\n` as new line on submission, but the ini value needs to be the String `\\n`, so it needs another `\\` to be sent as `\\\\n`. Then it works as advertised.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2175821151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2175833372","html_url":"https://github.com/apache/couchdb/issues/5091#issuecomment-2175833372","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5091","id":2175833372,"node_id":"IC_kwDOAAMmUc6BsJUc","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-18T11:06:38Z","updated_at":"2024-06-18T11:06:38Z","author_association":"MEMBER","body":"Glad you figured it out. To confirm, this is your shell converting the `\\n` in your --data into actual newline characters, and it is that which the config PUT code is rejecting (for not matching the regexp `\"^[[:graph:]\\t\\s]*$\"`).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2175833372/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2176504144","html_url":"https://github.com/apache/couchdb/pull/5088#issuecomment-2176504144","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5088","id":2176504144,"node_id":"IC_kwDOAAMmUc6ButFQ","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-18T16:23:21Z","updated_at":"2024-06-18T16:23:21Z","author_association":"MEMBER","body":"thanks Nick. I expect we'll find a corner case but at least we have all the logic in one place, and it's quite small. Time will tell, and we clearly have some other options to try from what Ben has contributed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2176504144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2176636360","html_url":"https://github.com/apache/couchdb/pull/5088#issuecomment-2176636360","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5088","id":2176636360,"node_id":"IC_kwDOAAMmUc6BvNXI","user":{"login":"ben-manes","id":378614,"node_id":"MDQ6VXNlcjM3ODYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/378614?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-manes","html_url":"https://github.com/ben-manes","followers_url":"https://api.github.com/users/ben-manes/followers","following_url":"https://api.github.com/users/ben-manes/following{/other_user}","gists_url":"https://api.github.com/users/ben-manes/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-manes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-manes/subscriptions","organizations_url":"https://api.github.com/users/ben-manes/orgs","repos_url":"https://api.github.com/users/ben-manes/repos","events_url":"https://api.github.com/users/ben-manes/events{/privacy}","received_events_url":"https://api.github.com/users/ben-manes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-18T17:39:22Z","updated_at":"2024-06-18T17:39:22Z","author_association":"NONE","body":"@rnewson did you review if there is a memory leak as I suspected? The scenario is,\r\n\r\n1. Insert N items\r\n2. Insert key N+1 to trigger an eviction for key K0 (removeEldestEntry => false)\r\n3. Unload starts\r\n4. Insert K entries (removeEldestEntry => false, still selects key=0)\r\n5. Unload finished\r\n6. Insert key X => what is evicted?\r\n\r\nI believe since `removeEldestEntry` returns false it will be stuck growing to higher thresholds based on the number of observed concurrent evictions. Since unloading is slow, over time the cache could greatly exceed your threshold. That excess won't be unloaded since only the eldest in-flight unload is observable.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2176636360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2176854320","html_url":"https://github.com/apache/couchdb/pull/5088#issuecomment-2176854320","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5088","id":2176854320,"node_id":"IC_kwDOAAMmUc6BwCkw","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-18T19:56:35Z","updated_at":"2024-06-18T19:56:35Z","author_association":"MEMBER","body":"ah, oops. will check, and fix in subsequent PR. thanks.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2176854320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2178455096","html_url":"https://github.com/apache/couchdb/issues/5094#issuecomment-2178455096","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5094","id":2178455096,"node_id":"IC_kwDOAAMmUc6B2JY4","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-19T11:29:46Z","updated_at":"2024-06-19T11:29:46Z","author_association":"MEMBER","body":"Can you clarify step 5? I assume you meant that document \"penny-003\" did not appear in couchdb-A? \r\n\r\nFurther questions;\r\n\r\n1) The one-shot replications return important information in the response like the number of documents written to the target. Can you please show those?\r\n2) Are you running any proxy or other software in front of either couchdb server? If so, what is it and what is it doing?\r\n3) In your 5 step example did you use a filter on the replication?\r\n4) Your discovery of \"not_found\" missing is perhaps a failure to find the design document that your `filter` is in, rather than suggesting that the _changes endpoint itself is missing (which would indicate a broken installation).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2178455096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2178795131","html_url":"https://github.com/apache/couchdb/issues/4825#issuecomment-2178795131","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4825","id":2178795131,"node_id":"IC_kwDOAAMmUc6B3cZ7","user":{"login":"xnox","id":19779,"node_id":"MDQ6VXNlcjE5Nzc5","avatar_url":"https://avatars.githubusercontent.com/u/19779?v=4","gravatar_id":"","url":"https://api.github.com/users/xnox","html_url":"https://github.com/xnox","followers_url":"https://api.github.com/users/xnox/followers","following_url":"https://api.github.com/users/xnox/following{/other_user}","gists_url":"https://api.github.com/users/xnox/gists{/gist_id}","starred_url":"https://api.github.com/users/xnox/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xnox/subscriptions","organizations_url":"https://api.github.com/users/xnox/orgs","repos_url":"https://api.github.com/users/xnox/repos","events_url":"https://api.github.com/users/xnox/events{/privacy}","received_events_url":"https://api.github.com/users/xnox/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-19T14:00:27Z","updated_at":"2024-06-19T14:00:27Z","author_association":"NONE","body":"I see that quickjs is merged into main branch, is there a release coming soon? or at least an rc tag? it would be interesting to try out quickjs builds.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2178795131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2178838723","html_url":"https://github.com/apache/couchdb/issues/4825#issuecomment-2178838723","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4825","id":2178838723,"node_id":"IC_kwDOAAMmUc6B3nDD","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-19T14:19:31Z","updated_at":"2024-06-19T14:19:31Z","author_association":"CONTRIBUTOR","body":"@xnox we're working toward a 3.4 release. QuickJS will be released as an experimental change, off by default,  with a scanner option to validate your views for compatibility. \r\n\r\nTo try it out off of the `main` branch using QuickJS as a default:  `./configure --disable-spidermonkey` (add `--dev` if you don't want to build Fauxton or docs). Then `make && make release`\r\n\r\nSome Linux OS still maintain SM 78 packages, so that may still be an option if you can use those.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2178838723/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2178843742","html_url":"https://github.com/apache/couchdb/issues/4825#issuecomment-2178843742","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4825","id":2178843742,"node_id":"IC_kwDOAAMmUc6B3oRe","user":{"login":"xnox","id":19779,"node_id":"MDQ6VXNlcjE5Nzc5","avatar_url":"https://avatars.githubusercontent.com/u/19779?v=4","gravatar_id":"","url":"https://api.github.com/users/xnox","html_url":"https://github.com/xnox","followers_url":"https://api.github.com/users/xnox/followers","following_url":"https://api.github.com/users/xnox/following{/other_user}","gists_url":"https://api.github.com/users/xnox/gists{/gist_id}","starred_url":"https://api.github.com/users/xnox/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xnox/subscriptions","organizations_url":"https://api.github.com/users/xnox/orgs","repos_url":"https://api.github.com/users/xnox/repos","events_url":"https://api.github.com/users/xnox/events{/privacy}","received_events_url":"https://api.github.com/users/xnox/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-19T14:21:58Z","updated_at":"2024-06-19T14:21:58Z","author_association":"NONE","body":"@nickva i am linux distribution and was hoping to axe mozjs 91 from wolfi-os =)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2178843742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2179677955","html_url":"https://github.com/apache/couchdb/issues/5094#issuecomment-2179677955","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5094","id":2179677955,"node_id":"IC_kwDOAAMmUc6B6z8D","user":{"login":"zhangjingcat","id":17232084,"node_id":"MDQ6VXNlcjE3MjMyMDg0","avatar_url":"https://avatars.githubusercontent.com/u/17232084?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjingcat","html_url":"https://github.com/zhangjingcat","followers_url":"https://api.github.com/users/zhangjingcat/followers","following_url":"https://api.github.com/users/zhangjingcat/following{/other_user}","gists_url":"https://api.github.com/users/zhangjingcat/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjingcat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjingcat/subscriptions","organizations_url":"https://api.github.com/users/zhangjingcat/orgs","repos_url":"https://api.github.com/users/zhangjingcat/repos","events_url":"https://api.github.com/users/zhangjingcat/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjingcat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-20T01:58:54Z","updated_at":"2024-06-20T06:49:30Z","author_association":"NONE","body":"> Can you clarify step 5? I assume you meant that document \"penny-003\" did not appear in couchdb-A?\r\n> \r\n> Further questions;\r\n> \r\n> 1. The one-shot replications return important information in the response like the number of documents written to the target. Can you please show those?\r\n> 2. Are you running any proxy or other software in front of either couchdb server? If so, what is it and what is it doing?\r\n> 3. In your 5 step example did you use a filter on the replication?\r\n> 4. Your discovery of \"not_found\" missing is perhaps a failure to find the design document that your `filter` is in, rather than suggesting that the _changes endpoint itself is missing (which would indicate a broken installation).\r\n\r\nHi @rnewson , thanks a lot for your quick reply!\r\n\r\nYes the \"penny-003\" did not appear in couchdb-A.\r\n\r\n1.I used UI to config the replications and did not keep the response. What I remembered is 0 Documents written and null pending. (I can try to re-produce that and copy the new result here for you later)\r\n\r\n2.No.\r\n\r\n3.I did not use the filter on replication and I just follow the UI instructions to use a source and target.\r\n\r\n4.I have some more discoveries depending on the .ini files that might cause the replication to fail.\r\n\r\nThis is the special case for data syncing , I carried out some tests on replicating data from local to local (with another dummy name).\r\n\r\nFor example, we have a \"sw360db\" which is a small database, and a \"sw360changelogs\" which is a large database.\r\n\r\nThe replication job from local existing \"sw360db\"  database to local new \"penny1\" database succeed. \r\n \r\nThe replication job from local existing \"sw360changelogs\"  database to local new \"penny2\" database failed. (0 documents written and null pending)\r\n\r\nI'm suspicious of the [replicator] configurations and carrying out some tests to prove my assumptions.\r\n\r\n```\r\n[couchdb]\r\nmax_document_size = 4294967296 ; bytes\r\nuuid = ca6e9bf190c040ec9987fc5512563704\r\ndatabase_dir = ./data\r\nview_index_dir = ./data\r\nfile_compression = snappy\r\nmax_document_size = 8000000 ; bytes\r\nos_process_timeout = 7000 ; 7 seconds. for view servers.\r\nmax_document_size = 8000000 ; bytes\r\nmax_dbs_open = 500\r\nattachment_stream_buffer_size = 8192\r\n\r\n[purge]\r\nmax_document_id_number = 1000\r\nmax_revisions_number = 1000\r\nindex_lag_warn_seconds = 86400\r\n\r\n[cluster]\r\nq=8\r\nn=3\r\nseedlist = xxx,xxx,xxx\r\n\r\n[database_compaction]\r\ndoc_buffer_size = 524288\r\ncheckpoint_after = 5242880\r\n\r\n[view_compaction]\r\nkeyvalue_buffer_size = 2097152\r\n\r\n[smoosh]\r\ndb_channels = upgrade_dbs,ratio_dbs,slack_dbs\r\nview_channels = upgrade_views,ratio_views,slack_views\r\ncleanup_channels = index_cleanup\r\ncompaction_log_level = info\r\npersist = true\r\n\r\n[smoosh.ratio_dbs]\r\npriority = ratio\r\nmin_priority = 2.0\r\n\r\n[smoosh.ratio_views]\r\npriority = ratio\r\nmin_priority = 2.0\r\n\r\n[smoosh.slack_dbs]\r\npriority = slack\r\nmin_priority = 536870912\r\n\r\n[smoosh.slack_views]\r\npriority = slack\r\nmin_priority = 536870912\r\n\r\n[attachments]\r\ncompression_level = 9\r\ncompressible_types = text/*, application/javascript, application/json, application/xml\r\n\r\n[uuids]\r\nalgorithm = sequential\r\n\r\n[stats]\r\ninterval = 10\r\n\r\n[ioq]\r\nconcurrency = 12\r\nratio = 0.01\r\n\r\n[ioq.bypass]\r\nos_process = true\r\nread = true\r\nwrite = true\r\nview_update = true\r\n\r\n[replicator]\r\nmax_jobs = 500\r\ninterval = 60000\r\nmax_churn = 20\r\nmax_history = 20\r\nworker_batch_size = 500\r\nworker_processes = 8\r\nhttp_connections = 20\r\nretries_per_request = 5\r\nconnection_timeout = 30000\r\nsocket_options = [{keepalive, true}, {nodelay, false}]\r\ncheckpoint_interval = 5000\r\nuse_checkpoints = true\r\nuse_bulk_get = true\r\nvalid_socket_options = buffer,keepalive,nodelay,priority,recbuf,sndbuf\r\n\r\n[chttpd]\r\nbind_address = 0.0.0.0\r\nbuffer_response = true\r\nmax_http_request_size = 4294967296 ; 4 GB\r\n\r\n[httpd]\r\nserver_options = [{backlog, 1024}, {acceptor_pool_size, 16}, {max, 8192}]\r\n\r\n[chttpd_auth]\r\nsecret = f2336db1\r\nallow_persistent_cookies = true\r\nauth_cache_size = 50\r\ntimeout = 600\r\n\r\n[rexi]\r\nbuffer_count = 2000\r\nserver_per_node = true\r\nuse_kill_all = true\r\nstream_limit = 7\r\n\r\n[prometheus]\r\nadditional_port = true\r\nbind_address = 0.0.0.0\r\nport = 9985\r\n\r\n[admins]\r\nadmin = xxxxxx\r\n\r\n```\r\n\r\nSteps:\r\n\r\n1.Create the one-time replication job\r\n\r\n<img width=\"1690\" alt=\"Screenshot 2024-06-20 at 10 39 15\" src=\"https://github.com/apache/couchdb/assets/17232084/ab06d80d-1c1b-4139-bd15-cf6cebbf2acc\">\r\n\r\n2.Check the replication job status\r\n\r\n<img width=\"1716\" alt=\"Screenshot 2024-06-20 at 10 39 24\" src=\"https://github.com/apache/couchdb/assets/17232084/0c1fa8a9-26ea-4a4f-a231-abc4e7474606\">\r\n\r\n3. See if any documents succeed, but unfortunately none\r\n\r\n<img width=\"1706\" alt=\"Screenshot 2024-06-20 at 10 39 33\" src=\"https://github.com/apache/couchdb/assets/17232084/31b3c194-7ae4-472a-b9e6-8a5ad13abbfe\">\r\n\r\n\r\nI got this error when creating the replication job.\r\n\r\nRequest:\r\n\r\ncurl --request POST \\\r\n  --url https://xxx:xxx@xxxxxx/_replicate \\\r\n  --header 'Content-Type: application/json' \\\r\n  --data '\r\n{\r\n\"source\": \"https://xxx:xxx@xxxxxx/sw360changelogs\",\r\n\"target\": \"https://xxx:xxx@xxxxxx/penny\",\r\n\"create_target\" : true\r\n}'\r\n\r\nResponse:\r\n\r\n{\r\n\t\"error\": \"changes_req_failed\",\r\n\t\"reason\": \"{error,req_timedout}\"\r\n}\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2179677955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2179818726","html_url":"https://github.com/apache/couchdb/pull/5093#issuecomment-2179818726","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5093","id":2179818726,"node_id":"IC_kwDOAAMmUc6B7WTm","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-20T05:05:56Z","updated_at":"2024-06-20T05:05:56Z","author_association":"CONTRIBUTOR","body":"Playing with the new PR locally I noticed that the couch replicator clustering and the db monitoring separate module were not needed any longer and removed. Added a separate `[fixup]` commit to explain why they were not needed any longer.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2179818726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2179826053","html_url":"https://github.com/apache/couchdb/pull/5093#issuecomment-2179826053","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5093","id":2179826053,"node_id":"IC_kwDOAAMmUc6B7YGF","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-20T05:10:14Z","updated_at":"2024-06-20T05:10:14Z","author_association":"CONTRIBUTOR","body":"To test the job migration even when the local shard doesn't get updated, I used an N=5 db and then stopped one of the nodes where the job wasn't running. Then noticed that the job correctly migrated to one of the remaining N=3 nodes.\r\n\r\nI used this silly script to create the replication job:\r\n\r\n```shell\r\n#!/bin/bash\r\n# make && ./dev/run --admin=adm:pass -n 5 --with-haproxy\r\n\r\nS=localhost:5984\r\nSA=adm:pass@${S}\r\nJSON=\"Content-Type: application/json\"\r\n\r\ncurl -s -XDELETE $SA/t > /dev/null\r\ncurl -s -XDELETE $SA/s > /dev/null\r\ncurl -s -XDELETE $SA/_replicator > /dev/null\r\n\r\nsleep 1\r\necho \"Creating _replicator db\"\r\ncurl -f -s -XPUT $SA/_replicator'?n=5' > /dev/null\r\n\r\nsleep 1\r\necho \"Creating src and tgt dbs\"\r\ncurl -f -s -XPUT $SA/t > /dev/null\r\ncurl -f -s -XPUT $SA/s > /dev/null\r\n\r\necho \"Posting replication job\"\r\ncurl -f -XPUT $SA/_replicator/r -H \"$JSON\" \\\r\n -d '{\"source\":\"http://adm:pass@localhost:5984/s\", \"target\":\"http://adm:pass@localhost:5984/t\", \"worker_processes\":1, \"continuous\":true}'\r\n```\r\n\r\nCluster started with:\r\n```shell\r\nmake && ./dev/run --admin=adm:pass -n 5 --with-haproxy\r\n```\r\n\r\nAs a result my replication job ended up running on NODE4. I then stopped NODE2 and that altered the hashing used in the ownership algorithm and the new owner becomes NODE1:\r\n\r\n```\r\nNODE4\r\nReplication doc shards/00000000-7fffffff/_replicator.1718859537:r with id {\"5fe95cdd2e5718789c106b986a2d8340\",\"+continuous\"} usurped by node 'node1@127.0.0.1'\r\ncouch_replicator_scheduler: Job {\"5fe95cdd2e5718789c106b986a2d8340\",\"+continuous\"} stopped as <0.19718.0>\r\n\r\nNODE2\r\n(node2@127.0.0.1)1> init:stop().\r\n(node2@127.0.0.1)2> *** ERROR: Shell process terminated! (^G to start new job) ***\r\n\r\nNODE1\r\nNode 'node1@127.0.0.1' is the usurper for doc shards/00000000-7fffffff/_replicator.1718859537:r with id nil\r\ncouch_replicator_scheduler: Job {\"5fe95cdd2e5718789c106b986a2d8340\",\"+continuous\"} started as <0.21919.0>\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2179826053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2179946130","html_url":"https://github.com/apache/couchdb/issues/5094#issuecomment-2179946130","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5094","id":2179946130,"node_id":"IC_kwDOAAMmUc6B71aS","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-20T06:51:48Z","updated_at":"2024-06-20T06:51:48Z","author_association":"MEMBER","body":"Ok, so it sounds like the replication simply crashes at the start, which explains the state of the databases, we don't get as far as knowing which documents on the source need replicating to the target.\r\n\r\nI don't see anything in your configuration that explains the issue.\r\n\r\nI see you are using https but your configuration did not include the settings to enable that natively in couchdb. is there something else providing https or did you just omit those settings from the configuration above?\r\n\r\nCan you test independently of the replicator? e.g, with ApacheBench, something like `ab -n 5000 -A user:pass <url to source db/_changes>` and see if they all succeed. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2179946130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]