[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1856243795","html_url":"https://github.com/apache/iceberg/issues/8333#issuecomment-1856243795","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8333","id":1856243795,"node_id":"IC_kwDOCW7NX85upAhT","user":{"login":"sabyasachinandy","id":68219968,"node_id":"MDQ6VXNlcjY4MjE5OTY4","avatar_url":"https://avatars.githubusercontent.com/u/68219968?v=4","gravatar_id":"","url":"https://api.github.com/users/sabyasachinandy","html_url":"https://github.com/sabyasachinandy","followers_url":"https://api.github.com/users/sabyasachinandy/followers","following_url":"https://api.github.com/users/sabyasachinandy/following{/other_user}","gists_url":"https://api.github.com/users/sabyasachinandy/gists{/gist_id}","starred_url":"https://api.github.com/users/sabyasachinandy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sabyasachinandy/subscriptions","organizations_url":"https://api.github.com/users/sabyasachinandy/orgs","repos_url":"https://api.github.com/users/sabyasachinandy/repos","events_url":"https://api.github.com/users/sabyasachinandy/events{/privacy}","received_events_url":"https://api.github.com/users/sabyasachinandy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-14T17:10:19Z","updated_at":"2023-12-14T17:10:19Z","author_association":"NONE","body":"Adding to this, I did a quick check of the stackstrace, seems like\r\nsomething is happening after the addMetadataRows function is getting\r\ncalled. It creates a generated class, which looks like it's assigning the\r\ndatatypes of the source data to long\r\n\r\n\r\nOn Thu, 14 Dec, 2023, 20:42 Harshith Bolar, ***@***.***>\r\nwrote:\r\n\r\n> Quick heads up, the merge into query works fine in version 1.0.0, starts\r\n> breaking from 1.1.0.\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/apache/iceberg/issues/8333#issuecomment-1856030578>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AQIPIQDO6GQQ4DGNYBZ5273YJMJNPAVCNFSM6AAAAAA3SKCVNSVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMYTQNJWGAZTANJXHA>\r\n> .\r\n> You are receiving this because you commented.Message ID:\r\n> ***@***.***>\r\n>\r\n\r\n-- \r\n\r\n\r\nTHIS EMAIL COMMUNICATION IS PRIVILEGED AND MAY CONTAIN CONFIDENTIAL \r\nINFORMATION OF RAPIDO. IF YOU ARE NOT THE INTENDED RECIPIENT, YOU ARE \r\nHEREBY NOTIFIED THAT YOU HAVE RECEIVED THIS MESSAGE IN ERROR AND ANY \r\nREVIEW, DISSEMINATION, DISTRIBUTION OR COPYING OF THIS MESSAGE IS STRICTLY \r\nPROHIBITED. PLEASE NOTIFY US IMMEDIATELY BY EMAIL AND DELETE THE MESSAGE \r\nFROM YOUR SYSTEM.****\r\n\r\nNOTHING CONTAINED IN THIS DISCLAIMER SHALL BE \r\nCONSTRUED IN ANY WAY TO GRANT PERMISSION TO TRANSMIT CONFIDENTIAL \r\nINFORMATION OR AS A WAIVER OF ANY CONFIDENTIALITY OR PRIVILEGE.****\r\n\r\nRAPIDO \r\nDOES NOT ACCEPT ANY RESPONSIBILITY OR LIABILITY ARISING FROM THE USE OF \r\nTHIS COMMUNICATION. NO REPRESENTATION IS BEING MADE THAT THE INFORMATION \r\nPRESENTED IS ACCURATE, CURRENT OR COMPLETE AND SUCH INFORMATION IS AT ALL \r\nTIMES SUBJECT TO CHANGE WITHOUT NOTICE\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1856243795/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1856508439","html_url":"https://github.com/apache/iceberg/pull/8502#issuecomment-1856508439","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8502","id":1856508439,"node_id":"IC_kwDOCW7NX85uqBIX","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-14T20:06:24Z","updated_at":"2023-12-14T20:06:24Z","author_association":"CONTRIBUTOR","body":"@ajantha-bhat, I'll take a look at other PRs once this is in. I feel this one is almost ready to go.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1856508439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1856811895","html_url":"https://github.com/apache/iceberg/pull/9230#issuecomment-1856811895","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9230","id":1856811895,"node_id":"IC_kwDOCW7NX85urLN3","user":{"login":"jasonf20","id":1601106,"node_id":"MDQ6VXNlcjE2MDExMDY=","avatar_url":"https://avatars.githubusercontent.com/u/1601106?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonf20","html_url":"https://github.com/jasonf20","followers_url":"https://api.github.com/users/jasonf20/followers","following_url":"https://api.github.com/users/jasonf20/following{/other_user}","gists_url":"https://api.github.com/users/jasonf20/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonf20/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonf20/subscriptions","organizations_url":"https://api.github.com/users/jasonf20/orgs","repos_url":"https://api.github.com/users/jasonf20/repos","events_url":"https://api.github.com/users/jasonf20/events{/privacy}","received_events_url":"https://api.github.com/users/jasonf20/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-14T22:29:23Z","updated_at":"2023-12-14T22:58:57Z","author_association":"CONTRIBUTOR","body":"Based on further Slack discussions I re-added the FastApply fix. \r\n\r\nCouple of notes:\r\n* I think it’s better to clear the lists instead of removing one item at a time. If the list is left partially full it will create the same bug. This can’t happen as far as I can tell since the entire transaction will fail or succeed, but in terms of protecting ourselves, clearing might be better.\r\n* I found a similar bug with Transaction, it would also not clear its cache properly and end up committing a TableMetadata that pointed to a manifest file that got deleted. I added a fix for this as well in the PR (4th commit)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1856811895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857049525","html_url":"https://github.com/apache/iceberg/issues/7639#issuecomment-1857049525","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7639","id":1857049525,"node_id":"IC_kwDOCW7NX85usFO1","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T00:12:00Z","updated_at":"2023-12-15T00:12:00Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857049525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857049772","html_url":"https://github.com/apache/iceberg/issues/7303#issuecomment-1857049772","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7303","id":1857049772,"node_id":"IC_kwDOCW7NX85usFSs","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T00:12:06Z","updated_at":"2023-12-15T00:12:06Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857049772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857145512","html_url":"https://github.com/apache/iceberg/pull/9216#issuecomment-1857145512","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9216","id":1857145512,"node_id":"IC_kwDOCW7NX85uscqo","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T01:51:38Z","updated_at":"2023-12-15T01:56:43Z","author_association":"CONTRIBUTOR","body":"@pvary can you follow up? if this can't be fixed quickly, let's ignore this test for now","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857145512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857355625","html_url":"https://github.com/apache/iceberg/issues/9299#issuecomment-1857355625","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9299","id":1857355625,"node_id":"IC_kwDOCW7NX85utP9p","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T06:37:09Z","updated_at":"2023-12-15T06:37:09Z","author_association":"CONTRIBUTOR","body":"Do I understand correctly, that you have 2 different jobs writing to the same table in update mode?\r\n\r\nI think this situation should be avoided.\r\n\r\nFlink update mode deletes the rows like this:\r\n- If the row is added in a previous checkpoint, it adds an equality delete row - every row with a given primary key before this checkpoint should be deleted\r\n- If the row is added in this checkpoint, it adds a position delete row for the last inserted row.\r\n\r\nThis is designed for a single writer case, but could work for multiple writers too, with one serious caveat. If you have multiple writers, then you never know which one will checkpoint first. The second checkpoint will overwrite the results of the first one.\r\n\r\nSo in the end the **table contents are defined by the Iceberg commit time**, and not the time when the actual update happens.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857355625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857382064","html_url":"https://github.com/apache/iceberg/issues/9178#issuecomment-1857382064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9178","id":1857382064,"node_id":"IC_kwDOCW7NX85utWaw","user":{"login":"Zhangg7723","id":18146312,"node_id":"MDQ6VXNlcjE4MTQ2MzEy","avatar_url":"https://avatars.githubusercontent.com/u/18146312?v=4","gravatar_id":"","url":"https://api.github.com/users/Zhangg7723","html_url":"https://github.com/Zhangg7723","followers_url":"https://api.github.com/users/Zhangg7723/followers","following_url":"https://api.github.com/users/Zhangg7723/following{/other_user}","gists_url":"https://api.github.com/users/Zhangg7723/gists{/gist_id}","starred_url":"https://api.github.com/users/Zhangg7723/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zhangg7723/subscriptions","organizations_url":"https://api.github.com/users/Zhangg7723/orgs","repos_url":"https://api.github.com/users/Zhangg7723/repos","events_url":"https://api.github.com/users/Zhangg7723/events{/privacy}","received_events_url":"https://api.github.com/users/Zhangg7723/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T07:08:29Z","updated_at":"2023-12-15T07:08:29Z","author_association":"CONTRIBUTOR","body":"From https://iceberg.apache.org/docs/1.2.1/configuration/#write-properties\r\nwrite.update.isolation-level, write.merge.isolation-level","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857382064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857383702","html_url":"https://github.com/apache/iceberg/pull/9161#issuecomment-1857383702","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9161","id":1857383702,"node_id":"IC_kwDOCW7NX85utW0W","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T07:10:10Z","updated_at":"2023-12-15T07:10:10Z","author_association":"CONTRIBUTOR","body":"@Fokko @pvary could you review this one please? Once this is merged we can use it for https://github.com/apache/iceberg/pull/9185","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857383702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857444166","html_url":"https://github.com/apache/iceberg/issues/9297#issuecomment-1857444166","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9297","id":1857444166,"node_id":"IC_kwDOCW7NX85utllG","user":{"login":"wfy-belief","id":58450591,"node_id":"MDQ6VXNlcjU4NDUwNTkx","avatar_url":"https://avatars.githubusercontent.com/u/58450591?v=4","gravatar_id":"","url":"https://api.github.com/users/wfy-belief","html_url":"https://github.com/wfy-belief","followers_url":"https://api.github.com/users/wfy-belief/followers","following_url":"https://api.github.com/users/wfy-belief/following{/other_user}","gists_url":"https://api.github.com/users/wfy-belief/gists{/gist_id}","starred_url":"https://api.github.com/users/wfy-belief/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wfy-belief/subscriptions","organizations_url":"https://api.github.com/users/wfy-belief/orgs","repos_url":"https://api.github.com/users/wfy-belief/repos","events_url":"https://api.github.com/users/wfy-belief/events{/privacy}","received_events_url":"https://api.github.com/users/wfy-belief/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T08:03:24Z","updated_at":"2023-12-15T08:03:24Z","author_association":"NONE","body":"@pvary Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857444166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857499004","html_url":"https://github.com/apache/iceberg/issues/9026#issuecomment-1857499004","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9026","id":1857499004,"node_id":"IC_kwDOCW7NX85uty98","user":{"login":"MehulBatra","id":66407733,"node_id":"MDQ6VXNlcjY2NDA3NzMz","avatar_url":"https://avatars.githubusercontent.com/u/66407733?v=4","gravatar_id":"","url":"https://api.github.com/users/MehulBatra","html_url":"https://github.com/MehulBatra","followers_url":"https://api.github.com/users/MehulBatra/followers","following_url":"https://api.github.com/users/MehulBatra/following{/other_user}","gists_url":"https://api.github.com/users/MehulBatra/gists{/gist_id}","starred_url":"https://api.github.com/users/MehulBatra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MehulBatra/subscriptions","organizations_url":"https://api.github.com/users/MehulBatra/orgs","repos_url":"https://api.github.com/users/MehulBatra/repos","events_url":"https://api.github.com/users/MehulBatra/events{/privacy}","received_events_url":"https://api.github.com/users/MehulBatra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T08:46:22Z","updated_at":"2023-12-15T08:46:22Z","author_association":"CONTRIBUTOR","body":"@nastra So is this ticket closed as #9131 states it's an expected behavior, or do we need to work on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857499004/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857555925","html_url":"https://github.com/apache/iceberg/issues/5927#issuecomment-1857555925","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5927","id":1857555925,"node_id":"IC_kwDOCW7NX85uuA3V","user":{"login":"thuongle2210","id":67187155,"node_id":"MDQ6VXNlcjY3MTg3MTU1","avatar_url":"https://avatars.githubusercontent.com/u/67187155?v=4","gravatar_id":"","url":"https://api.github.com/users/thuongle2210","html_url":"https://github.com/thuongle2210","followers_url":"https://api.github.com/users/thuongle2210/followers","following_url":"https://api.github.com/users/thuongle2210/following{/other_user}","gists_url":"https://api.github.com/users/thuongle2210/gists{/gist_id}","starred_url":"https://api.github.com/users/thuongle2210/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thuongle2210/subscriptions","organizations_url":"https://api.github.com/users/thuongle2210/orgs","repos_url":"https://api.github.com/users/thuongle2210/repos","events_url":"https://api.github.com/users/thuongle2210/events{/privacy}","received_events_url":"https://api.github.com/users/thuongle2210/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T09:29:40Z","updated_at":"2023-12-15T09:39:25Z","author_association":"NONE","body":"i faced the same problem with impala version 4.0 though i turn off vectorized reading of parquet.\r\nCan you help me @wypoon, pls?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857555925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857686284","html_url":"https://github.com/apache/iceberg/issues/9026#issuecomment-1857686284","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9026","id":1857686284,"node_id":"IC_kwDOCW7NX85uugsM","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T10:58:33Z","updated_at":"2023-12-15T10:58:33Z","author_association":"CONTRIBUTOR","body":"@MehulBatra yes, this is expected behavior, but sorry that I forgot to close this issue out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857686284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857726420","html_url":"https://github.com/apache/iceberg/pull/7844#issuecomment-1857726420","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7844","id":1857726420,"node_id":"IC_kwDOCW7NX85uuqfU","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T11:29:46Z","updated_at":"2023-12-15T11:29:46Z","author_association":"MEMBER","body":"cc @danielcweeks ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857726420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857853254","html_url":"https://github.com/apache/iceberg/pull/8502#issuecomment-1857853254","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8502","id":1857853254,"node_id":"IC_kwDOCW7NX85uvJdG","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T13:05:09Z","updated_at":"2023-12-15T13:05:09Z","author_association":"MEMBER","body":"@aokolnychyi: I have handled all the new comments. Thanks again for the review.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857853254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857854433","html_url":"https://github.com/apache/iceberg/pull/9298#issuecomment-1857854433","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9298","id":1857854433,"node_id":"IC_kwDOCW7NX85uvJvh","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T13:06:06Z","updated_at":"2023-12-15T13:06:06Z","author_association":"MEMBER","body":"@nastra, @Fokko: PR is ready for review.   ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857854433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857964575","html_url":"https://github.com/apache/iceberg/pull/9302#issuecomment-1857964575","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9302","id":1857964575,"node_id":"IC_kwDOCW7NX85uvkof","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T14:22:36Z","updated_at":"2023-12-15T14:22:36Z","author_association":"CONTRIBUTOR","body":"Could this be that the following error is caused by this change:\r\n```\r\n# Danger! Multiple jars contain identically named classes. This may cause different behaviour depending on classpath ordering.\r\n# Run ./gradlew checkClassUniqueness --write-locks to update this file\r\n\r\n## runtimeClasspath\r\n[org.apache.iceberg:iceberg-api, org.apache.iceberg:iceberg-core]\r\n  - org.apache.iceberg.view.SQLViewRepresentation\r\n```\r\n\r\nThe error could be reproduced by:\r\n```\r\n./gradlew checkClassUniqueness --write-locks\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857964575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857969574","html_url":"https://github.com/apache/iceberg/pull/9216#issuecomment-1857969574","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9216","id":1857969574,"node_id":"IC_kwDOCW7NX85uvl2m","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T14:26:20Z","updated_at":"2023-12-15T14:26:20Z","author_association":"CONTRIBUTOR","body":"I was originally not able to run the tests multiple times using IntelliJ, but found some issues, and fixed them.\r\nNow I have a test which I was able to run 1000 times from IntelliJ without errors.\r\nLet me prepare the PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1857969574/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858055733","html_url":"https://github.com/apache/iceberg/pull/9308#issuecomment-1858055733","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9308","id":1858055733,"node_id":"IC_kwDOCW7NX85uv641","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T15:24:01Z","updated_at":"2023-12-15T15:24:01Z","author_association":"CONTRIBUTOR","body":"CC: @ajantha-bhat - further fixes on the test","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858055733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858058869","html_url":"https://github.com/apache/iceberg/pull/9302#issuecomment-1858058869","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9302","id":1858058869,"node_id":"IC_kwDOCW7NX85uv7p1","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T15:25:42Z","updated_at":"2023-12-15T15:26:11Z","author_association":"CONTRIBUTOR","body":"@pvary did you see this error on CI or just when running `./gradlew checkClassUniqueness --write-locks`? I tried to repro this but I'm not able to see that error (I tried JDK8 and JDK18), so I'm curious to know under which circumstances this happens","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858058869/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858086083","html_url":"https://github.com/apache/iceberg/issues/9306#issuecomment-1858086083","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9306","id":1858086083,"node_id":"IC_kwDOCW7NX85uwCTD","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T15:44:48Z","updated_at":"2023-12-15T15:44:48Z","author_association":"CONTRIBUTOR","body":"Currently the only supported action is https://github.com/apache/iceberg/blob/main/flink/v1.18/flink/src/main/java/org/apache/iceberg/flink/actions/RewriteDataFilesAction.java\r\n\r\nWe are working on migrating the Flink Sink to the Flink SinkV2 API. See: #8653. After that we plan to add the possibility to add compaction to the `PostCommitTopology` for a Sink.\r\n\r\nIf someone could make the zorder rewrite startegy available as a Flink action, it would greatly reduce the time to make it available even in the Sink as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858086083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858092550","html_url":"https://github.com/apache/iceberg/pull/9301#issuecomment-1858092550","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9301","id":1858092550,"node_id":"IC_kwDOCW7NX85uwD4G","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T15:48:55Z","updated_at":"2023-12-15T15:48:55Z","author_association":"CONTRIBUTOR","body":"Cool! Thanks @deniskuzZ for coming back with the results!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858092550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858100586","html_url":"https://github.com/apache/iceberg/pull/8195#issuecomment-1858100586","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8195","id":1858100586,"node_id":"IC_kwDOCW7NX85uwF1q","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T15:54:18Z","updated_at":"2023-12-15T15:54:18Z","author_association":"COLLABORATOR","body":"However, there's no primary key in Spark or Trino. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858100586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858112362","html_url":"https://github.com/apache/iceberg/pull/9302#issuecomment-1858112362","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9302","id":1858112362,"node_id":"IC_kwDOCW7NX85uwItq","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T16:02:25Z","updated_at":"2023-12-15T16:02:25Z","author_association":"CONTRIBUTOR","body":"I am using java 8\r\n\r\nPreviuosly, I have run this:\r\n```\r\n$ ./gradlew :iceberg-flink:iceberg-flink-runtime-1.18:build\r\nStarting a Gradle Daemon, 1 busy Daemon could not be reused, use --status for details\r\n> Task :iceberg-flink:iceberg-flink-runtime-1.18:checkClassUniqueness FAILED\r\n\r\n> Task :iceberg-flink:iceberg-flink-1.18:compileTestJava\r\nNote: Some input files use or override a deprecated API.\r\nNote: Recompile with -Xlint:deprecation for details.\r\nNote: Some input files use unchecked or unsafe operations.\r\nNote: Recompile with -Xlint:unchecked for details.\r\n\r\nFAILURE: Build failed with an exception.\r\n\r\n* What went wrong:\r\nExecution failed for task ':iceberg-flink:iceberg-flink-runtime-1.18:checkClassUniqueness'.\r\n> baseline-class-uniqueness detected multiple jars containing identically named classes. Please resolve these problems, or run `./gradlew checkClassUniqueness --write-locks` to accept them:\r\n  \r\n  # Danger! Multiple jars contain identically named classes. This may cause different behaviour depending on classpath ordering.\r\n  # Run ./gradlew checkClassUniqueness --write-locks to update this file\r\n  \r\n  ## runtimeClasspath\r\n  [org.apache.iceberg:iceberg-api, org.apache.iceberg:iceberg-core]\r\n    - org.apache.iceberg.view.SQLViewRepresentation\r\n\r\n\r\n* Try:\r\n> Run with --stacktrace option to get the stack trace.\r\n> Run with --info or --debug option to get more log output.\r\n> Run with --scan to get full insights.\r\n\r\n* Get more help at https://help.gradle.org\r\n\r\nDeprecated Gradle features were used in this build, making it incompatible with Gradle 9.0.\r\n\r\nYou can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins.\r\n\r\nSee https://docs.gradle.org/8.1.1/userguide/command_line_interface.html#sec:command_line_warnings\r\n\r\nBUILD FAILED in 1m 8s\r\n53 actionable tasks: 4 executed, 49 up-to-date\r\n```\r\n\r\nI have run the `./gradlew checkClassUniqueness --write-locks` as suggested, and that created plenty of `lock` files:\r\n```\r\n\taliyun/baseline-class-uniqueness.lock\r\n\tarrow/baseline-class-uniqueness.lock\r\n\taws/baseline-class-uniqueness.lock\r\n\taws/src/main/generated/\r\n\tazure/baseline-class-uniqueness.lock\r\n\tcore/src/main/generated/\r\n\tdata/baseline-class-uniqueness.lock\r\n\tdell/baseline-class-uniqueness.lock\r\n\tdelta-lake/baseline-class-uniqueness.lock\r\n\tflink/v1.18/flink-runtime/baseline-class-uniqueness.lock\r\n\tflink/v1.18/flink/baseline-class-uniqueness.lock\r\n\tgcp/baseline-class-uniqueness.lock\r\n\thive-metastore/baseline-class-uniqueness.lock\r\n\thive-metastore/src/main/generated/\r\n\thive-runtime/baseline-class-uniqueness.lock\r\n\tmr/baseline-class-uniqueness.lock\r\n\tnessie/baseline-class-uniqueness.lock\r\n\torc/baseline-class-uniqueness.lock\r\n\tparquet/baseline-class-uniqueness.lock\r\n\tpig/baseline-class-uniqueness.lock\r\n\tsettings-gradle.lockfile\r\n\tsnowflake/baseline-class-uniqueness.lock\r\n\tspark/v3.5/spark-runtime/baseline-class-uniqueness.lock\r\n\tspark/v3.5/spark/baseline-class-uniqueness.lock\r\n```\r\n\r\nI tried to find the indicated duplicate file, but failed.\r\nSince then I can not repro it either, so just disregard my previous comment.\r\n\r\nSorry for the noise 😢 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858112362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858113490","html_url":"https://github.com/apache/iceberg/pull/9302#issuecomment-1858113490","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9302","id":1858113490,"node_id":"IC_kwDOCW7NX85uwI_S","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T16:03:13Z","updated_at":"2023-12-15T16:03:13Z","author_association":"CONTRIBUTOR","body":"Maybe it was a gradle issue which is fixed by a clean build....","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858113490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858116202","html_url":"https://github.com/apache/iceberg/pull/9302#issuecomment-1858116202","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9302","id":1858116202,"node_id":"IC_kwDOCW7NX85uwJpq","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T16:05:16Z","updated_at":"2023-12-15T16:05:16Z","author_association":"CONTRIBUTOR","body":"@pvary thanks for the input, I think that's quite helpful. I'll take a closer look and will provide an update once I know more.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858116202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858140592","html_url":"https://github.com/apache/iceberg/pull/8502#issuecomment-1858140592","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8502","id":1858140592,"node_id":"IC_kwDOCW7NX85uwPmw","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T16:23:21Z","updated_at":"2023-12-15T16:23:21Z","author_association":"MEMBER","body":"Re-triggering build due to flaky test in Flink\r\n\r\nhttps://github.com/apache/iceberg/actions/runs/7222400549/job/19679307743?pr=8502","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858140592/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858158123","html_url":"https://github.com/apache/iceberg/pull/8195#issuecomment-1858158123","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8195","id":1858158123,"node_id":"IC_kwDOCW7NX85uwT4r","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T16:36:01Z","updated_at":"2023-12-15T16:36:01Z","author_association":"CONTRIBUTOR","body":"> However, there's no primary key in Spark or Trino.\r\n\r\nI think it should be possible to provide the identity fields there too.\r\n\r\nThe java API provides the possibility through the `Schema`\r\nhttps://github.com/apache/iceberg/blob/7c3c34897a2e452311f085af67d6f546ba56e44e/api/src/main/java/org/apache/iceberg/Schema.java#L82\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858158123/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858166115","html_url":"https://github.com/apache/iceberg/issues/9306#issuecomment-1858166115","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9306","id":1858166115,"node_id":"IC_kwDOCW7NX85uwV1j","user":{"login":"lkokhreidze","id":8927925,"node_id":"MDQ6VXNlcjg5Mjc5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/8927925?v=4","gravatar_id":"","url":"https://api.github.com/users/lkokhreidze","html_url":"https://github.com/lkokhreidze","followers_url":"https://api.github.com/users/lkokhreidze/followers","following_url":"https://api.github.com/users/lkokhreidze/following{/other_user}","gists_url":"https://api.github.com/users/lkokhreidze/gists{/gist_id}","starred_url":"https://api.github.com/users/lkokhreidze/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lkokhreidze/subscriptions","organizations_url":"https://api.github.com/users/lkokhreidze/orgs","repos_url":"https://api.github.com/users/lkokhreidze/repos","events_url":"https://api.github.com/users/lkokhreidze/events{/privacy}","received_events_url":"https://api.github.com/users/lkokhreidze/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T16:41:59Z","updated_at":"2023-12-15T16:41:59Z","author_association":"CONTRIBUTOR","body":"Thanks @pvary that looks really awesome and helpful.\r\nI'll try to look at zorder implementation and see what we could do to contribute.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858166115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858167251","html_url":"https://github.com/apache/iceberg/issues/3619#issuecomment-1858167251","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3619","id":1858167251,"node_id":"IC_kwDOCW7NX85uwWHT","user":{"login":"kuldeepsinghchauhan","id":11781941,"node_id":"MDQ6VXNlcjExNzgxOTQx","avatar_url":"https://avatars.githubusercontent.com/u/11781941?v=4","gravatar_id":"","url":"https://api.github.com/users/kuldeepsinghchauhan","html_url":"https://github.com/kuldeepsinghchauhan","followers_url":"https://api.github.com/users/kuldeepsinghchauhan/followers","following_url":"https://api.github.com/users/kuldeepsinghchauhan/following{/other_user}","gists_url":"https://api.github.com/users/kuldeepsinghchauhan/gists{/gist_id}","starred_url":"https://api.github.com/users/kuldeepsinghchauhan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kuldeepsinghchauhan/subscriptions","organizations_url":"https://api.github.com/users/kuldeepsinghchauhan/orgs","repos_url":"https://api.github.com/users/kuldeepsinghchauhan/repos","events_url":"https://api.github.com/users/kuldeepsinghchauhan/events{/privacy}","received_events_url":"https://api.github.com/users/kuldeepsinghchauhan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T16:42:55Z","updated_at":"2023-12-15T16:42:55Z","author_association":"NONE","body":"We are using EMR 614 with Apache Iceberg 1.3.1 and ranger plugin for spark and emrfs/s3 to govern access. We were hoping that existing ranger plugins for spark and trino would support the iceberg access and to a certain extent it does, for an example users with read access on a hive table can not migrate it to the iceberg table however we were surprised to see that users with read access on an iceberg table can perform rollback snapshot operations. Is there a way that we can prevent users with read access from performing such metadata change operations on iceberg tables?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858167251/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858175706","html_url":"https://github.com/apache/iceberg/issues/3619#issuecomment-1858175706","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3619","id":1858175706,"node_id":"IC_kwDOCW7NX85uwYLa","user":{"login":"kuldeepsinghchauhan","id":11781941,"node_id":"MDQ6VXNlcjExNzgxOTQx","avatar_url":"https://avatars.githubusercontent.com/u/11781941?v=4","gravatar_id":"","url":"https://api.github.com/users/kuldeepsinghchauhan","html_url":"https://github.com/kuldeepsinghchauhan","followers_url":"https://api.github.com/users/kuldeepsinghchauhan/followers","following_url":"https://api.github.com/users/kuldeepsinghchauhan/following{/other_user}","gists_url":"https://api.github.com/users/kuldeepsinghchauhan/gists{/gist_id}","starred_url":"https://api.github.com/users/kuldeepsinghchauhan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kuldeepsinghchauhan/subscriptions","organizations_url":"https://api.github.com/users/kuldeepsinghchauhan/orgs","repos_url":"https://api.github.com/users/kuldeepsinghchauhan/repos","events_url":"https://api.github.com/users/kuldeepsinghchauhan/events{/privacy}","received_events_url":"https://api.github.com/users/kuldeepsinghchauhan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T16:49:56Z","updated_at":"2023-12-15T16:49:56Z","author_association":"NONE","body":"> As I see it, this integration would have to be done in one of two ways:\r\n> \r\n> 1. Integration into the Runtime components, which would take time as it would require updates to everything that has built a Iceberg integration. (Trino, Spark, Hive, etc.)\r\n> 2. Integration into the Rest Catalog, This would allow for a custom error response if the use is unauthorized. This difficulty in this would be that the Rest Catalog would need improvements on Authentication as well as implementing Ranger support for Authorization. It would really need to be able to support more than just OAUTH2 (LDAP and SAML2 come to mind) And pass that user information to the Ranger integration for validating Authorization.\r\n> \r\n> I wouldn't mind writing up a proposal on this, but I would like some guidance on which direction would be preferred. I admit that I'm personally more inclined to the addition of it into the Rest Catalog, as it seems to make more sense to have it there. Since doing so would protect not only the data attempting to be accessed but the metadata surrounding it.\r\n\r\nThis integration is in demand now as more and more organizations now want to leverage apache iceberg for their data lake table format. However, if existing ranger plugins do not support apache iceberg access control, then it would be a major roadblock. Please let me know your thoughts! Happy to contribute to the proposal.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858175706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858352676","html_url":"https://github.com/apache/iceberg/pull/9308#issuecomment-1858352676","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9308","id":1858352676,"node_id":"IC_kwDOCW7NX85uxDYk","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T18:58:07Z","updated_at":"2023-12-15T19:00:11Z","author_association":"CONTRIBUTOR","body":"@pvary is the whole PR addressing the flaky test? if not, please separate out the flaky test part (hopefully small) into a separate PR. I would like to merge the flaky test fix ASAP. And you can include all 3 versions (1.16, 1.17, 1.18) in one PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858352676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858369750","html_url":"https://github.com/apache/iceberg/pull/7844#issuecomment-1858369750","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7844","id":1858369750,"node_id":"IC_kwDOCW7NX85uxHjW","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T19:14:06Z","updated_at":"2023-12-15T19:14:06Z","author_association":"CONTRIBUTOR","body":"One minor comment but otherwise looks good to me.   @nastra thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858369750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858414638","html_url":"https://github.com/apache/iceberg/pull/9308#issuecomment-1858414638","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9308","id":1858414638,"node_id":"IC_kwDOCW7NX85uxSgu","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T19:54:12Z","updated_at":"2023-12-15T19:54:12Z","author_association":"CONTRIBUTOR","body":"> @pvary is the whole PR addressing the flaky test? if not, please separate out the flaky test part (hopefully small) into a separate PR. I would like to merge the flaky test fix ASAP. And you can include all 3 versions (1.16, 1.17, 1.18) in one PR.\r\n\r\nAs mentioned in the description, the missing `pauseOrResumeSplits` method causes flakiness. I think it is better to fix it in one PR, than having a PR disabling the test, and another PR adding the test back. WDYT?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858414638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858477802","html_url":"https://github.com/apache/iceberg/pull/9247#issuecomment-1858477802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9247","id":1858477802,"node_id":"IC_kwDOCW7NX85uxh7q","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T20:57:28Z","updated_at":"2023-12-15T20:57:28Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @rdblue , merging! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858477802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858628332","html_url":"https://github.com/apache/iceberg/issues/7440#issuecomment-1858628332","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7440","id":1858628332,"node_id":"IC_kwDOCW7NX85uyGrs","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T00:11:39Z","updated_at":"2023-12-16T00:11:39Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858628332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858628353","html_url":"https://github.com/apache/iceberg/issues/7406#issuecomment-1858628353","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7406","id":1858628353,"node_id":"IC_kwDOCW7NX85uyGsB","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T00:11:41Z","updated_at":"2023-12-16T00:11:41Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858628353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858628375","html_url":"https://github.com/apache/iceberg/issues/7332#issuecomment-1858628375","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7332","id":1858628375,"node_id":"IC_kwDOCW7NX85uyGsX","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T00:11:43Z","updated_at":"2023-12-16T00:11:43Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858628375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858628410","html_url":"https://github.com/apache/iceberg/issues/7287#issuecomment-1858628410","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7287","id":1858628410,"node_id":"IC_kwDOCW7NX85uyGs6","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T00:11:46Z","updated_at":"2023-12-16T00:11:46Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858628410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858649569","html_url":"https://github.com/apache/iceberg/pull/9141#issuecomment-1858649569","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9141","id":1858649569,"node_id":"IC_kwDOCW7NX85uyL3h","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T00:56:57Z","updated_at":"2023-12-16T00:56:57Z","author_association":"CONTRIBUTOR","body":"Sorry for the delay. Here is what happened.\r\n1. s1 adds data file 1 in partition 1\r\n2. s2 adds data file 2 in partition 2\r\n3. s3 insert overwrite partition 2, which deletes data file 2 and create a new data file 3 in partition 2\r\n4. Expire-snapshot procedure deletes data file2 by metadata deleting.\r\n5. the changes table require data file2 to construct deleted rows, but failed to load it\r\n\r\nShould we keep the data file refered in the new snapshot in expire-snapshot action? cc @aokolnychyi @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858649569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858758126","html_url":"https://github.com/apache/iceberg/pull/9245#issuecomment-1858758126","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9245","id":1858758126,"node_id":"IC_kwDOCW7NX85uymXu","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T08:14:05Z","updated_at":"2023-12-16T08:14:05Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, I started by extending `AbstractSet`. Unfortunately, `hashCode` does not work. It is implemented using the iterator that in our case returns unwrapped elements and breaks the contract.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858758126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858758541","html_url":"https://github.com/apache/iceberg/pull/9245#issuecomment-1858758541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9245","id":1858758541,"node_id":"IC_kwDOCW7NX85uymeN","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T08:15:42Z","updated_at":"2023-12-16T08:15:42Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858758541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858762537","html_url":"https://github.com/apache/iceberg/pull/9309#issuecomment-1858762537","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9309","id":1858762537,"node_id":"IC_kwDOCW7NX85uyncp","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T08:37:59Z","updated_at":"2023-12-16T08:37:59Z","author_association":"MEMBER","body":"Please also handle for other flink modules. Flakiness can come from any of the modules. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858762537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858867436","html_url":"https://github.com/apache/iceberg/pull/9311#issuecomment-1858867436","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9311","id":1858867436,"node_id":"IC_kwDOCW7NX85uzBDs","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T16:50:25Z","updated_at":"2023-12-16T16:50:25Z","author_association":"CONTRIBUTOR","body":"Looks like the unrelated Flink test TestIcebergSourceWithWatermarkExtractor is still flaky? I see there's a PR out for this https://github.com/apache/iceberg/pull/9309/files \r\n\r\nI'm going to close and re-open to retrigger CI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858867436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858885364","html_url":"https://github.com/apache/iceberg/pull/9310#issuecomment-1858885364","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9310","id":1858885364,"node_id":"IC_kwDOCW7NX85uzFb0","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T17:52:37Z","updated_at":"2023-12-16T17:52:37Z","author_association":"CONTRIBUTOR","body":"@ajantha-bhat the same unrelated Flink flaky test is occurring that https://github.com/apache/iceberg/pull/9309 is fixing. I'm going to close and re-open this PR to retrigger CI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858885364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858921063","html_url":"https://github.com/apache/iceberg/pull/8625#issuecomment-1858921063","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8625","id":1858921063,"node_id":"IC_kwDOCW7NX85uzOJn","user":{"login":"rustyconover","id":731941,"node_id":"MDQ6VXNlcjczMTk0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/731941?v=4","gravatar_id":"","url":"https://api.github.com/users/rustyconover","html_url":"https://github.com/rustyconover","followers_url":"https://api.github.com/users/rustyconover/followers","following_url":"https://api.github.com/users/rustyconover/following{/other_user}","gists_url":"https://api.github.com/users/rustyconover/gists{/gist_id}","starred_url":"https://api.github.com/users/rustyconover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rustyconover/subscriptions","organizations_url":"https://api.github.com/users/rustyconover/orgs","repos_url":"https://api.github.com/users/rustyconover/repos","events_url":"https://api.github.com/users/rustyconover/events{/privacy}","received_events_url":"https://api.github.com/users/rustyconover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T20:10:49Z","updated_at":"2023-12-16T20:10:49Z","author_association":"CONTRIBUTOR","body":"Hello @aokolnychyi and @Fokko,\r\n\r\n>> Question. Aren't we using DataFileWriter from Avro in our AvroFileAppender? If so, how is this PR affecting it? Won't we still use direct encoders there?\r\n\r\n> This is a good question. The goal of this PR is to write the block sizes for the manifests. @rustyconover any thoughts on this?\r\n\r\nI am particularly interested in the explicit inclusion of block sizes in manifest files. Currently, PyIceberg requires deserialization of three maps (high, low, and null counts) even when the query planner may not necessarily need that information. If block sizes are explicitly written, I plan to modify the PyIceberg Avro decoder to adopt a \"lazy\" approach. It would involve copying arrays or maps as byte buffers, deferring the decoding process until they are accessed by client code. Consequently, if the code never accesses the map, the deserialization code would not execute.\r\n\r\nThis optimization could significantly reduce scan planning time, especially for tables with numerous files across multiple columns. For instance, in a table with 1,250,000 files, copying bytes in memory for later decoding proves much faster than the deserialization of Avro structures.\r\n\r\nCurrently the PyIceberg Avro code isn't performing lazy decoding, it just decodes everything. This is because due to the choices in the Java code about how Avro is serialized directly without buffering so the byte length count be included.  I can prepare a PR to do this.\r\n\r\nRusty","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858921063/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858993562","html_url":"https://github.com/apache/iceberg/issues/7656#issuecomment-1858993562","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7656","id":1858993562,"node_id":"IC_kwDOCW7NX85uzf2a","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T00:12:56Z","updated_at":"2023-12-17T00:12:56Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858993562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858993579","html_url":"https://github.com/apache/iceberg/issues/7238#issuecomment-1858993579","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7238","id":1858993579,"node_id":"IC_kwDOCW7NX85uzf2r","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T00:13:00Z","updated_at":"2023-12-17T00:13:00Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858993579/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858993589","html_url":"https://github.com/apache/iceberg/issues/7170#issuecomment-1858993589","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7170","id":1858993589,"node_id":"IC_kwDOCW7NX85uzf21","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T00:13:01Z","updated_at":"2023-12-17T00:13:01Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858993589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858993599","html_url":"https://github.com/apache/iceberg/issues/7129#issuecomment-1858993599","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7129","id":1858993599,"node_id":"IC_kwDOCW7NX85uzf2_","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T00:13:03Z","updated_at":"2023-12-17T00:13:03Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1858993599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859030933","html_url":"https://github.com/apache/iceberg/pull/9040#issuecomment-1859030933","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9040","id":1859030933,"node_id":"IC_kwDOCW7NX85uzo-V","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T04:02:32Z","updated_at":"2023-12-17T04:02:32Z","author_association":"CONTRIBUTOR","body":"Superseded by #9315.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859030933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":29110,"client_id":"Iv1.4f9a6346434f815e","slug":"dependabot","node_id":"MDM6QXBwMjkxMTA=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"Dependabot","description":"","external_url":"https://dependabot-api.githubapp.com","html_url":"https://github.com/apps/dependabot","created_at":"2019-04-16T22:34:25Z","updated_at":"2024-03-20T21:06:35Z","permissions":{"actions":"read","checks":"write","contents":"write","issues":"write","members":"read","metadata":"read","pull_requests":"write","statuses":"read","vulnerability_alerts":"read","workflows":"write"},"events":["check_suite","issues","issue_comment","label","pull_request","pull_request_review","pull_request_review_comment","repository"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859030974","html_url":"https://github.com/apache/iceberg/pull/9156#issuecomment-1859030974","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9156","id":1859030974,"node_id":"IC_kwDOCW7NX85uzo--","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T04:02:45Z","updated_at":"2023-12-17T04:02:45Z","author_association":"CONTRIBUTOR","body":"Superseded by #9316.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859030974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":29110,"client_id":"Iv1.4f9a6346434f815e","slug":"dependabot","node_id":"MDM6QXBwMjkxMTA=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"Dependabot","description":"","external_url":"https://dependabot-api.githubapp.com","html_url":"https://github.com/apps/dependabot","created_at":"2019-04-16T22:34:25Z","updated_at":"2024-03-20T21:06:35Z","permissions":{"actions":"read","checks":"write","contents":"write","issues":"write","members":"read","metadata":"read","pull_requests":"write","statuses":"read","vulnerability_alerts":"read","workflows":"write"},"events":["check_suite","issues","issue_comment","label","pull_request","pull_request_review","pull_request_review_comment","repository"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859040607","html_url":"https://github.com/apache/iceberg/pull/9308#issuecomment-1859040607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9308","id":1859040607,"node_id":"IC_kwDOCW7NX85uzrVf","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T05:13:02Z","updated_at":"2023-12-17T05:13:02Z","author_association":"CONTRIBUTOR","body":"> @pvary we are changing some critical code here. I would prefer we take a little more time here and get more people to review.\r\n> \r\n> Hence I would prefer if we disable/ignore the test first so that we make other PR/CI builds stable ASAP.\r\n\r\nThat is why I created #9309. That contains the most important other fixes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859040607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859147694","html_url":"https://github.com/apache/iceberg/pull/9308#issuecomment-1859147694","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9308","id":1859147694,"node_id":"IC_kwDOCW7NX85u0Feu","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T11:45:12Z","updated_at":"2023-12-17T11:45:12Z","author_association":"CONTRIBUTOR","body":"@stevenzwu: Here is what I have found:\r\n`wakeUp` is called whenever there is a new message concerning the `SplitReader`:\r\n- new split added/removed\r\n- split paused/resumed\r\n\r\nThese messages are executed in the same thread as the fetch method, so in this case we have to return from the fetch loop, even with empty results. This is somewhat concerning to me considering the comment here:\r\nhttps://github.com/apache/iceberg/blob/820fc3ceda386149f42db8b54e6db9171d1a3a6d/flink/v1.18/flink/src/main/java/org/apache/iceberg/flink/source/reader/IcebergSourceSplitReader.java#L76-L78\r\n\r\nI do not see that it is closed, but probably you know more...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859147694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859197491","html_url":"https://github.com/apache/iceberg/pull/9323#issuecomment-1859197491","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9323","id":1859197491,"node_id":"IC_kwDOCW7NX85u0Roz","user":{"login":"jasonf20","id":1601106,"node_id":"MDQ6VXNlcjE2MDExMDY=","avatar_url":"https://avatars.githubusercontent.com/u/1601106?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonf20","html_url":"https://github.com/jasonf20","followers_url":"https://api.github.com/users/jasonf20/followers","following_url":"https://api.github.com/users/jasonf20/following{/other_user}","gists_url":"https://api.github.com/users/jasonf20/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonf20/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonf20/subscriptions","organizations_url":"https://api.github.com/users/jasonf20/orgs","repos_url":"https://api.github.com/users/jasonf20/repos","events_url":"https://api.github.com/users/jasonf20/events{/privacy}","received_events_url":"https://api.github.com/users/jasonf20/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T15:08:21Z","updated_at":"2023-12-19T16:16:45Z","author_association":"CONTRIBUTOR","body":"**Benchmark**\r\nThe following test was run locally just to demonstrate that the difference in IO performance is very significant. While the transaction approach IO grows linearly with the number of batches, the Streaming API has constant IO overhead. \r\n\r\nThe test uses just 10 batches, but increasing the batch count will increase the difference linearly. \r\n\r\n**code**\r\n```scala\r\nobject IcebergUpsert {\r\n\r\n\r\n  def main(args: Array[String]): Unit = {\r\n    val catalog = new GlueCatalog()\r\n    catalog.initialize(\"iceberg\", Map.empty[String, String].asJava)\r\n\r\n    val schema = new Schema(\r\n      IcebergTypes.NestedField.required(1, \"id\", IcebergTypes.StringType.get()),\r\n    );\r\n    val tableName = \"streams\"\r\n    val tableId = TableIdentifier.of(\"prod_iceberg\", tableName)\r\n    val basePath = s\"s3://bucket/ice/tables/${tableName}/\"\r\n\r\n    if (!catalog.tableExists(tableId)) {\r\n      catalog.createTable(tableId, schema, PartitionSpec.unpartitioned(), basePath, Map.empty[String, String].asJava)\r\n    }\r\n\r\n    val table = catalog.loadTable(tableId)\r\n\r\n    val updateBatches = (1 to 10).par.map(_ => {\r\n      writeFile(basePath, table) -> writeDeleteFile(basePath, table)\r\n    }).seq\r\n\r\n    println(\"Starting with rowDelta\")\r\n    var startTime = System.currentTimeMillis()\r\n    val transaction = table.newTransaction()\r\n    updateBatches.foreach({\r\n      case (dataFile, deleteFile) =>\r\n        transaction.newRowDelta()\r\n          .addRows(dataFile)\r\n          .addDeletes(deleteFile)\r\n          .commit()\r\n    })\r\n    transaction.commitTransaction()\r\n    println(s\"Row delta took ${System.currentTimeMillis() - startTime} millis\")\r\n    table.refresh()\r\n    println(s\"Table has ${table.currentSnapshot().allManifests(table.io()).size()} manifests\")\r\n\r\n    println(\"Starting with streaming update\")\r\n    startTime = System.currentTimeMillis()\r\n    val update = table.newStreamingUpdate()\r\n    updateBatches.foreach({\r\n      case (dataFile, deleteFile) =>\r\n        update.newBatch().addFile(dataFile).addFile(deleteFile)\r\n    })\r\n    update.commit()\r\n    println(s\"Streaming update took ${System.currentTimeMillis() - startTime} millis\")\r\n    table.refresh()\r\n    println(s\"Table has ${table.currentSnapshot().allManifests(table.io()).size()} manifests\")\r\n  }\r\n\r\n  private def writeFile(basePath: String, table: Table) = {\r\n    val writer = Parquet.writeData(\r\n        table.io().newOutputFile(basePath + UUID.randomUUID().toString + \".parquet\"))\r\n      .forTable(table)\r\n      .overwrite(true)\r\n      .createWriterFunc(GenericParquetWriter.buildWriter)\r\n      .build[data.Record]()\r\n    writer.write(Iterable(GenericRecord.create(table.schema()).copy(\"id\", \"1\")).asJava)\r\n    writer.close()\r\n    writer.toDataFile\r\n  }\r\n\r\n  private def writeDeleteFile(basePath: String, table: Table) = {\r\n    val writer = Parquet.writeDeletes(\r\n        table.io().newOutputFile(basePath + UUID.randomUUID().toString + \".parquet\"))\r\n      .forTable(table)\r\n      .overwrite(true)\r\n      .createWriterFunc(GenericParquetWriter.buildWriter)\r\n      .equalityFieldIds(table.schema().columns().asScala.map(_.fieldId().asInstanceOf[Integer]).asJava)\r\n      .buildEqualityWriter[data.Record]()\r\n    writer.write(Iterable(GenericRecord.create(table.schema()).copy(\"id\", \"1\")).asJava)\r\n    writer.close()\r\n    writer.toDeleteFile\r\n  }\r\n}\r\n```\r\n\r\n**results**\r\n```\r\nStarting with rowDelta\r\n2023-12-15 14:40:34,801 8637 [main] INFO  org.apache.iceberg.SnapshotProducer  - Committed snapshot 3558899585328564531 (BaseRowDelta)\r\n2023-12-15 14:40:35,219 9055 [main] INFO  o.a.i.m.LoggingMetricsReporter  - Received metrics report: CommitReport{tableName=iceberg.prod_iceberg.streams, snapshotId=3558899585328564531, sequenceNumber=41, operation=overwrite, commitMetrics=CommitMetricsResult{totalDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT2.337073916S, count=1}, attempts=CounterResult{unit=COUNT, value=1}, addedDataFiles=CounterResult{unit=COUNT, value=1}, removedDataFiles=null, totalDataFiles=CounterResult{unit=COUNT, value=41}, addedDeleteFiles=CounterResult{unit=COUNT, value=1}, addedEqualityDeleteFiles=CounterResult{unit=COUNT, value=1}, addedPositionalDeleteFiles=null, removedDeleteFiles=null, removedEqualityDeleteFiles=null, removedPositionalDeleteFiles=null, totalDeleteFiles=CounterResult{unit=COUNT, value=41}, addedRecords=CounterResult{unit=COUNT, value=1}, removedRecords=null, totalRecords=CounterResult{unit=COUNT, value=41}, addedFilesSizeInBytes=CounterResult{unit=BYTES, value=806}, removedFilesSizeInBytes=null, totalFilesSizeInBytes=CounterResult{unit=BYTES, value=33046}, addedPositionalDeletes=null, removedPositionalDeletes=null, totalPositionalDeletes=CounterResult{unit=COUNT, value=0}, addedEqualityDeletes=CounterResult{unit=COUNT, value=1}, removedEqualityDeletes=null, totalEqualityDeletes=CounterResult{unit=COUNT, value=41}}, metadata={iceberg-version=Apache Iceberg 1.5.0-SNAPSHOT (commit 0b63a580f84dc38fc891a75fa244724cb9d57385)}}\r\n2023-12-15 14:40:36,498 10334 [main] INFO  org.apache.iceberg.SnapshotProducer  - Committed snapshot 616856435651832528 (BaseRowDelta)\r\n2023-12-15 14:40:36,917 10753 [main] INFO  o.a.i.m.LoggingMetricsReporter  - Received metrics report: CommitReport{tableName=iceberg.prod_iceberg.streams, snapshotId=616856435651832528, sequenceNumber=42, operation=overwrite, commitMetrics=CommitMetricsResult{totalDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT1.698149167S, count=1}, attempts=CounterResult{unit=COUNT, value=1}, addedDataFiles=CounterResult{unit=COUNT, value=1}, removedDataFiles=null, totalDataFiles=CounterResult{unit=COUNT, value=42}, addedDeleteFiles=CounterResult{unit=COUNT, value=1}, addedEqualityDeleteFiles=CounterResult{unit=COUNT, value=1}, addedPositionalDeleteFiles=null, removedDeleteFiles=null, removedEqualityDeleteFiles=null, removedPositionalDeleteFiles=null, totalDeleteFiles=CounterResult{unit=COUNT, value=42}, addedRecords=CounterResult{unit=COUNT, value=1}, removedRecords=null, totalRecords=CounterResult{unit=COUNT, value=42}, addedFilesSizeInBytes=CounterResult{unit=BYTES, value=806}, removedFilesSizeInBytes=null, totalFilesSizeInBytes=CounterResult{unit=BYTES, value=33852}, addedPositionalDeletes=null, removedPositionalDeletes=null, totalPositionalDeletes=CounterResult{unit=COUNT, value=0}, addedEqualityDeletes=CounterResult{unit=COUNT, value=1}, removedEqualityDeletes=null, totalEqualityDeletes=CounterResult{unit=COUNT, value=42}}, metadata={iceberg-version=Apache Iceberg 1.5.0-SNAPSHOT (commit 0b63a580f84dc38fc891a75fa244724cb9d57385)}}\r\n2023-12-15 14:40:38,226 12062 [main] INFO  org.apache.iceberg.SnapshotProducer  - Committed snapshot 4567773841167163715 (BaseRowDelta)\r\n2023-12-15 14:40:38,642 12478 [main] INFO  o.a.i.m.LoggingMetricsReporter  - Received metrics report: CommitReport{tableName=iceberg.prod_iceberg.streams, snapshotId=4567773841167163715, sequenceNumber=43, operation=overwrite, commitMetrics=CommitMetricsResult{totalDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT1.723988375S, count=1}, attempts=CounterResult{unit=COUNT, value=1}, addedDataFiles=CounterResult{unit=COUNT, value=1}, removedDataFiles=null, totalDataFiles=CounterResult{unit=COUNT, value=43}, addedDeleteFiles=CounterResult{unit=COUNT, value=1}, addedEqualityDeleteFiles=CounterResult{unit=COUNT, value=1}, addedPositionalDeleteFiles=null, removedDeleteFiles=null, removedEqualityDeleteFiles=null, removedPositionalDeleteFiles=null, totalDeleteFiles=CounterResult{unit=COUNT, value=43}, addedRecords=CounterResult{unit=COUNT, value=1}, removedRecords=null, totalRecords=CounterResult{unit=COUNT, value=43}, addedFilesSizeInBytes=CounterResult{unit=BYTES, value=806}, removedFilesSizeInBytes=null, totalFilesSizeInBytes=CounterResult{unit=BYTES, value=34658}, addedPositionalDeletes=null, removedPositionalDeletes=null, totalPositionalDeletes=CounterResult{unit=COUNT, value=0}, addedEqualityDeletes=CounterResult{unit=COUNT, value=1}, removedEqualityDeletes=null, totalEqualityDeletes=CounterResult{unit=COUNT, value=43}}, metadata={iceberg-version=Apache Iceberg 1.5.0-SNAPSHOT (commit 0b63a580f84dc38fc891a75fa244724cb9d57385)}}\r\n2023-12-15 14:40:39,991 13827 [main] INFO  org.apache.iceberg.SnapshotProducer  - Committed snapshot 4541277781112838040 (BaseRowDelta)\r\n2023-12-15 14:40:40,466 14302 [main] INFO  o.a.i.m.LoggingMetricsReporter  - Received metrics report: CommitReport{tableName=iceberg.prod_iceberg.streams, snapshotId=4541277781112838040, sequenceNumber=44, operation=overwrite, commitMetrics=CommitMetricsResult{totalDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT1.82380625S, count=1}, attempts=CounterResult{unit=COUNT, value=1}, addedDataFiles=CounterResult{unit=COUNT, value=1}, removedDataFiles=null, totalDataFiles=CounterResult{unit=COUNT, value=44}, addedDeleteFiles=CounterResult{unit=COUNT, value=1}, addedEqualityDeleteFiles=CounterResult{unit=COUNT, value=1}, addedPositionalDeleteFiles=null, removedDeleteFiles=null, removedEqualityDeleteFiles=null, removedPositionalDeleteFiles=null, totalDeleteFiles=CounterResult{unit=COUNT, value=44}, addedRecords=CounterResult{unit=COUNT, value=1}, removedRecords=null, totalRecords=CounterResult{unit=COUNT, value=44}, addedFilesSizeInBytes=CounterResult{unit=BYTES, value=806}, removedFilesSizeInBytes=null, totalFilesSizeInBytes=CounterResult{unit=BYTES, value=35464}, addedPositionalDeletes=null, removedPositionalDeletes=null, totalPositionalDeletes=CounterResult{unit=COUNT, value=0}, addedEqualityDeletes=CounterResult{unit=COUNT, value=1}, removedEqualityDeletes=null, totalEqualityDeletes=CounterResult{unit=COUNT, value=44}}, metadata={iceberg-version=Apache Iceberg 1.5.0-SNAPSHOT (commit 0b63a580f84dc38fc891a75fa244724cb9d57385)}}\r\n2023-12-15 14:40:41,776 15612 [main] INFO  org.apache.iceberg.SnapshotProducer  - Committed snapshot 6741568890407525576 (BaseRowDelta)\r\n2023-12-15 14:40:42,184 16020 [main] INFO  o.a.i.m.LoggingMetricsReporter  - Received metrics report: CommitReport{tableName=iceberg.prod_iceberg.streams, snapshotId=6741568890407525576, sequenceNumber=45, operation=overwrite, commitMetrics=CommitMetricsResult{totalDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT1.717269417S, count=1}, attempts=CounterResult{unit=COUNT, value=1}, addedDataFiles=CounterResult{unit=COUNT, value=1}, removedDataFiles=null, totalDataFiles=CounterResult{unit=COUNT, value=45}, addedDeleteFiles=CounterResult{unit=COUNT, value=1}, addedEqualityDeleteFiles=CounterResult{unit=COUNT, value=1}, addedPositionalDeleteFiles=null, removedDeleteFiles=null, removedEqualityDeleteFiles=null, removedPositionalDeleteFiles=null, totalDeleteFiles=CounterResult{unit=COUNT, value=45}, addedRecords=CounterResult{unit=COUNT, value=1}, removedRecords=null, totalRecords=CounterResult{unit=COUNT, value=45}, addedFilesSizeInBytes=CounterResult{unit=BYTES, value=806}, removedFilesSizeInBytes=null, totalFilesSizeInBytes=CounterResult{unit=BYTES, value=36270}, addedPositionalDeletes=null, removedPositionalDeletes=null, totalPositionalDeletes=CounterResult{unit=COUNT, value=0}, addedEqualityDeletes=CounterResult{unit=COUNT, value=1}, removedEqualityDeletes=null, totalEqualityDeletes=CounterResult{unit=COUNT, value=45}}, metadata={iceberg-version=Apache Iceberg 1.5.0-SNAPSHOT (commit 0b63a580f84dc38fc891a75fa244724cb9d57385)}}\r\n2023-12-15 14:40:43,460 17296 [main] INFO  org.apache.iceberg.SnapshotProducer  - Committed snapshot 1018838099119420123 (BaseRowDelta)\r\n2023-12-15 14:40:43,877 17713 [main] INFO  o.a.i.m.LoggingMetricsReporter  - Received metrics report: CommitReport{tableName=iceberg.prod_iceberg.streams, snapshotId=1018838099119420123, sequenceNumber=46, operation=overwrite, commitMetrics=CommitMetricsResult{totalDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT1.692011958S, count=1}, attempts=CounterResult{unit=COUNT, value=1}, addedDataFiles=CounterResult{unit=COUNT, value=1}, removedDataFiles=null, totalDataFiles=CounterResult{unit=COUNT, value=46}, addedDeleteFiles=CounterResult{unit=COUNT, value=1}, addedEqualityDeleteFiles=CounterResult{unit=COUNT, value=1}, addedPositionalDeleteFiles=null, removedDeleteFiles=null, removedEqualityDeleteFiles=null, removedPositionalDeleteFiles=null, totalDeleteFiles=CounterResult{unit=COUNT, value=46}, addedRecords=CounterResult{unit=COUNT, value=1}, removedRecords=null, totalRecords=CounterResult{unit=COUNT, value=46}, addedFilesSizeInBytes=CounterResult{unit=BYTES, value=806}, removedFilesSizeInBytes=null, totalFilesSizeInBytes=CounterResult{unit=BYTES, value=37076}, addedPositionalDeletes=null, removedPositionalDeletes=null, totalPositionalDeletes=CounterResult{unit=COUNT, value=0}, addedEqualityDeletes=CounterResult{unit=COUNT, value=1}, removedEqualityDeletes=null, totalEqualityDeletes=CounterResult{unit=COUNT, value=46}}, metadata={iceberg-version=Apache Iceberg 1.5.0-SNAPSHOT (commit 0b63a580f84dc38fc891a75fa244724cb9d57385)}}\r\n2023-12-15 14:40:45,192 19028 [main] INFO  org.apache.iceberg.SnapshotProducer  - Committed snapshot 758872760345785094 (BaseRowDelta)\r\n2023-12-15 14:40:45,630 19466 [main] INFO  o.a.i.m.LoggingMetricsReporter  - Received metrics report: CommitReport{tableName=iceberg.prod_iceberg.streams, snapshotId=758872760345785094, sequenceNumber=47, operation=overwrite, commitMetrics=CommitMetricsResult{totalDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT1.752748416S, count=1}, attempts=CounterResult{unit=COUNT, value=1}, addedDataFiles=CounterResult{unit=COUNT, value=1}, removedDataFiles=null, totalDataFiles=CounterResult{unit=COUNT, value=47}, addedDeleteFiles=CounterResult{unit=COUNT, value=1}, addedEqualityDeleteFiles=CounterResult{unit=COUNT, value=1}, addedPositionalDeleteFiles=null, removedDeleteFiles=null, removedEqualityDeleteFiles=null, removedPositionalDeleteFiles=null, totalDeleteFiles=CounterResult{unit=COUNT, value=47}, addedRecords=CounterResult{unit=COUNT, value=1}, removedRecords=null, totalRecords=CounterResult{unit=COUNT, value=47}, addedFilesSizeInBytes=CounterResult{unit=BYTES, value=806}, removedFilesSizeInBytes=null, totalFilesSizeInBytes=CounterResult{unit=BYTES, value=37882}, addedPositionalDeletes=null, removedPositionalDeletes=null, totalPositionalDeletes=CounterResult{unit=COUNT, value=0}, addedEqualityDeletes=CounterResult{unit=COUNT, value=1}, removedEqualityDeletes=null, totalEqualityDeletes=CounterResult{unit=COUNT, value=47}}, metadata={iceberg-version=Apache Iceberg 1.5.0-SNAPSHOT (commit 0b63a580f84dc38fc891a75fa244724cb9d57385)}}\r\n2023-12-15 14:40:46,938 20774 [main] INFO  org.apache.iceberg.SnapshotProducer  - Committed snapshot 8330568458953296944 (BaseRowDelta)\r\n2023-12-15 14:40:47,345 21181 [main] INFO  o.a.i.m.LoggingMetricsReporter  - Received metrics report: CommitReport{tableName=iceberg.prod_iceberg.streams, snapshotId=8330568458953296944, sequenceNumber=48, operation=overwrite, commitMetrics=CommitMetricsResult{totalDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT1.714607334S, count=1}, attempts=CounterResult{unit=COUNT, value=1}, addedDataFiles=CounterResult{unit=COUNT, value=1}, removedDataFiles=null, totalDataFiles=CounterResult{unit=COUNT, value=48}, addedDeleteFiles=CounterResult{unit=COUNT, value=1}, addedEqualityDeleteFiles=CounterResult{unit=COUNT, value=1}, addedPositionalDeleteFiles=null, removedDeleteFiles=null, removedEqualityDeleteFiles=null, removedPositionalDeleteFiles=null, totalDeleteFiles=CounterResult{unit=COUNT, value=48}, addedRecords=CounterResult{unit=COUNT, value=1}, removedRecords=null, totalRecords=CounterResult{unit=COUNT, value=48}, addedFilesSizeInBytes=CounterResult{unit=BYTES, value=806}, removedFilesSizeInBytes=null, totalFilesSizeInBytes=CounterResult{unit=BYTES, value=38688}, addedPositionalDeletes=null, removedPositionalDeletes=null, totalPositionalDeletes=CounterResult{unit=COUNT, value=0}, addedEqualityDeletes=CounterResult{unit=COUNT, value=1}, removedEqualityDeletes=null, totalEqualityDeletes=CounterResult{unit=COUNT, value=48}}, metadata={iceberg-version=Apache Iceberg 1.5.0-SNAPSHOT (commit 0b63a580f84dc38fc891a75fa244724cb9d57385)}}\r\n2023-12-15 14:40:48,875 22711 [main] INFO  org.apache.iceberg.SnapshotProducer  - Committed snapshot 380337181704891470 (BaseRowDelta)\r\n2023-12-15 14:40:49,281 23117 [main] INFO  o.a.i.m.LoggingMetricsReporter  - Received metrics report: CommitReport{tableName=iceberg.prod_iceberg.streams, snapshotId=380337181704891470, sequenceNumber=49, operation=overwrite, commitMetrics=CommitMetricsResult{totalDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT1.934422667S, count=1}, attempts=CounterResult{unit=COUNT, value=1}, addedDataFiles=CounterResult{unit=COUNT, value=1}, removedDataFiles=null, totalDataFiles=CounterResult{unit=COUNT, value=49}, addedDeleteFiles=CounterResult{unit=COUNT, value=1}, addedEqualityDeleteFiles=CounterResult{unit=COUNT, value=1}, addedPositionalDeleteFiles=null, removedDeleteFiles=null, removedEqualityDeleteFiles=null, removedPositionalDeleteFiles=null, totalDeleteFiles=CounterResult{unit=COUNT, value=49}, addedRecords=CounterResult{unit=COUNT, value=1}, removedRecords=null, totalRecords=CounterResult{unit=COUNT, value=49}, addedFilesSizeInBytes=CounterResult{unit=BYTES, value=806}, removedFilesSizeInBytes=null, totalFilesSizeInBytes=CounterResult{unit=BYTES, value=39494}, addedPositionalDeletes=null, removedPositionalDeletes=null, totalPositionalDeletes=CounterResult{unit=COUNT, value=0}, addedEqualityDeletes=CounterResult{unit=COUNT, value=1}, removedEqualityDeletes=null, totalEqualityDeletes=CounterResult{unit=COUNT, value=49}}, metadata={iceberg-version=Apache Iceberg 1.5.0-SNAPSHOT (commit 0b63a580f84dc38fc891a75fa244724cb9d57385)}}\r\n2023-12-15 14:40:50,558 24394 [main] INFO  org.apache.iceberg.SnapshotProducer  - Committed snapshot 2626027648794038319 (BaseRowDelta)\r\n2023-12-15 14:40:50,960 24796 [main] INFO  o.a.i.m.LoggingMetricsReporter  - Received metrics report: CommitReport{tableName=iceberg.prod_iceberg.streams, snapshotId=2626027648794038319, sequenceNumber=50, operation=overwrite, commitMetrics=CommitMetricsResult{totalDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT1.679267084S, count=1}, attempts=CounterResult{unit=COUNT, value=1}, addedDataFiles=CounterResult{unit=COUNT, value=1}, removedDataFiles=null, totalDataFiles=CounterResult{unit=COUNT, value=50}, addedDeleteFiles=CounterResult{unit=COUNT, value=1}, addedEqualityDeleteFiles=CounterResult{unit=COUNT, value=1}, addedPositionalDeleteFiles=null, removedDeleteFiles=null, removedEqualityDeleteFiles=null, removedPositionalDeleteFiles=null, totalDeleteFiles=CounterResult{unit=COUNT, value=50}, addedRecords=CounterResult{unit=COUNT, value=1}, removedRecords=null, totalRecords=CounterResult{unit=COUNT, value=50}, addedFilesSizeInBytes=CounterResult{unit=BYTES, value=806}, removedFilesSizeInBytes=null, totalFilesSizeInBytes=CounterResult{unit=BYTES, value=40300}, addedPositionalDeletes=null, removedPositionalDeletes=null, totalPositionalDeletes=CounterResult{unit=COUNT, value=0}, addedEqualityDeletes=CounterResult{unit=COUNT, value=1}, removedEqualityDeletes=null, totalEqualityDeletes=CounterResult{unit=COUNT, value=50}}, metadata={iceberg-version=Apache Iceberg 1.5.0-SNAPSHOT (commit 0b63a580f84dc38fc891a75fa244724cb9d57385)}}\r\n2023-12-15 14:40:52,297 26133 [main] INFO  o.a.i.BaseMetastoreTableOperations  - Successfully committed to table iceberg.prod_iceberg.streams in 1041 ms\r\n2023-12-15 14:40:52,588 26424 [main] INFO  o.a.i.BaseMetastoreTableOperations  - Refreshing table metadata from new version: s3://bucket/ice/tables/streams/metadata/00005-20fd758e-5cb9-431d-95d5-1de0e06bea8f.metadata.json\r\nRow delta took 24493 millis\r\nTable has 20 manifests\r\nStarting with streaming update\r\n2023-12-15 14:40:59,957 33793 [main] INFO  o.a.i.BaseMetastoreTableOperations  - Successfully committed to table iceberg.prod_iceberg.streams in 1003 ms\r\n2023-12-15 14:40:59,957 33793 [main] INFO  org.apache.iceberg.SnapshotProducer  - Committed snapshot 6955191004682032851 (BaseStreamingUpdate)\r\n2023-12-15 14:41:00,242 34078 [main] INFO  o.a.i.BaseMetastoreTableOperations  - Refreshing table metadata from new version: s3://bucket/ice/tables/streams/metadata/00006-435a312d-615d-4ae0-8c0a-96d60a1aa9d5.metadata.json\r\n2023-12-15 14:41:01,349 35185 [main] INFO  o.a.i.m.LoggingMetricsReporter  - Received metrics report: CommitReport{tableName=iceberg.prod_iceberg.streams, snapshotId=6955191004682032851, sequenceNumber=60, operation=overwrite, commitMetrics=CommitMetricsResult{totalDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT3.728768833S, count=1}, attempts=CounterResult{unit=COUNT, value=1}, addedDataFiles=CounterResult{unit=COUNT, value=10}, removedDataFiles=null, totalDataFiles=CounterResult{unit=COUNT, value=60}, addedDeleteFiles=CounterResult{unit=COUNT, value=10}, addedEqualityDeleteFiles=CounterResult{unit=COUNT, value=10}, addedPositionalDeleteFiles=null, removedDeleteFiles=null, removedEqualityDeleteFiles=null, removedPositionalDeleteFiles=null, totalDeleteFiles=CounterResult{unit=COUNT, value=60}, addedRecords=CounterResult{unit=COUNT, value=10}, removedRecords=null, totalRecords=CounterResult{unit=COUNT, value=60}, addedFilesSizeInBytes=CounterResult{unit=BYTES, value=8060}, removedFilesSizeInBytes=null, totalFilesSizeInBytes=CounterResult{unit=BYTES, value=48360}, addedPositionalDeletes=null, removedPositionalDeletes=null, totalPositionalDeletes=CounterResult{unit=COUNT, value=0}, addedEqualityDeletes=CounterResult{unit=COUNT, value=10}, removedEqualityDeletes=null, totalEqualityDeletes=CounterResult{unit=COUNT, value=60}}, metadata={iceberg-version=Apache Iceberg 1.5.0-SNAPSHOT (commit 0b63a580f84dc38fc891a75fa244724cb9d57385)}}\r\nStreaming update took 4010 millis\r\nTable has 22 manifests\r\n```\r\n**24** seconds and **20** manifests _vs_ **4** seconds and **2** manifests","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859197491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859284853","html_url":"https://github.com/apache/iceberg/pull/9324#issuecomment-1859284853","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9324","id":1859284853,"node_id":"IC_kwDOCW7NX85u0m91","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T21:08:00Z","updated_at":"2023-12-17T21:08:00Z","author_association":"CONTRIBUTOR","body":"@jackye1995, this is the fix I mentioned for Parquet data files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859284853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859338957","html_url":"https://github.com/apache/iceberg/issues/7113#issuecomment-1859338957","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7113","id":1859338957,"node_id":"IC_kwDOCW7NX85u00LN","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T00:12:19Z","updated_at":"2023-12-18T00:12:19Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859338957/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859338977","html_url":"https://github.com/apache/iceberg/issues/7110#issuecomment-1859338977","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7110","id":1859338977,"node_id":"IC_kwDOCW7NX85u00Lh","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T00:12:21Z","updated_at":"2023-12-18T00:12:21Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859338977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859338991","html_url":"https://github.com/apache/iceberg/issues/7103#issuecomment-1859338991","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7103","id":1859338991,"node_id":"IC_kwDOCW7NX85u00Lv","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T00:12:23Z","updated_at":"2023-12-18T00:12:23Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859338991/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859376491","html_url":"https://github.com/apache/iceberg/pull/9230#issuecomment-1859376491","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9230","id":1859376491,"node_id":"IC_kwDOCW7NX85u09Vr","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T01:09:41Z","updated_at":"2023-12-18T18:17:30Z","author_association":"CONTRIBUTOR","body":"@jasonf20, sorry for being unclear in my reply earlier, but I don't think that the tests in this PR reproduce the error. The tests here reproduce similar errors, but do it by manually calling `commit` on operations multiple times, which is only allowed by transactions.\r\n\r\nAfter looking at the problem more, I was able to produce a test case that used both the transaction and append APIs correctly and lost data. Here's the test:\r\n\r\n```java\r\n  @Test\r\n  public void testTransactionRecommit() {\r\n    // update table settings to merge when there are 3 manifests\r\n    table.updateProperties().set(TableProperties.MANIFEST_MIN_MERGE_COUNT, \"3\").commit();\r\n\r\n    // create manifests so that the next commit will trigger a merge\r\n    table.newFastAppend().appendFile(FILE_A).commit();\r\n    table.newFastAppend().appendFile(FILE_B).commit();\r\n\r\n    // start a transaction with appended files that will merge\r\n    Transaction transaction = Transactions.newTransaction(table.name(), table.ops());\r\n\r\n    AppendFiles append = transaction.newAppend().appendFile(FILE_D);\r\n    Snapshot pending = append.apply();\r\n\r\n    Assert.assertEquals(\r\n        \"Should produce 1 pending merged manifest\", 1, pending.allManifests(table.io()).size());\r\n\r\n    // because a merge happened, the appended manifest is deleted the by append operation\r\n    append.commit();\r\n\r\n    // concurrently commit FILE_A without a transaction to cause the previous append to retry\r\n    table.newAppend().appendFile(FILE_C).commit();\r\n    Assert.assertEquals(\r\n        \"Should produce 1 committed merged manifest\",\r\n        1,\r\n        table.currentSnapshot().allManifests(table.io()).size());\r\n\r\n    transaction.commitTransaction();\r\n\r\n    Set<String> paths =\r\n        Sets.newHashSet(\r\n            Iterables.transform(\r\n                table.newScan().planFiles(), task -> task.file().path().toString()));\r\n    Set<String> expectedPaths = Sets.newHashSet(\r\n        FILE_A.path().toString(),\r\n        FILE_B.path().toString(),\r\n        FILE_C.path().toString(),\r\n        FILE_D.path().toString()\r\n    );\r\n\r\n    Assert.assertEquals(\"Should contain all committed files\", expectedPaths, paths);\r\n\r\n    Assert.assertEquals(\r\n        \"Should produce 2 manifests\",\r\n        2,\r\n        table.currentSnapshot().allManifests(table.io()).size());\r\n  }\r\n```\r\n\r\nThe problem happens when two concurrent commits both compact the latest manifests. When that happens, the new data file manifest is removed by the operation cleanup logic because it was not committed to the transaction. Then, when the transaction needs to re-apply the change, the reuse logic notices that the appended file manifests have already been written and reuses them. However, the list is no longer correct because it was filtered.\r\n\r\nThere are a few things to take away from this. First, this doesn't affect fast appends because that operation never merges manifests. However, it's still incorrect to filter the added manifests list so we should apply the same fix to `FastAppend` that we do to `MergingSnapshotProducer`. Second, we can't recover when any new file manifest has been deleted, so I think the solution is to catch when any manifest is deleted and rewrite the batch by setting the reused manifests to `null`. That's like your original solution, but the difference is that we need to check whether `deleteFunc` is called and only set the cached manifests to `null` if that's the case:\r\n\r\n```diff\r\ndiff --git a/core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java b/core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java\r\nindex e06a491098..bde92daa4a 100644\r\n--- a/core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java\r\n+++ b/core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java\r\n@@ -879,16 +879,20 @@ abstract class MergingSnapshotProducer<ThisT> extends SnapshotProducer<ThisT> {\r\n \r\n   private void cleanUncommittedAppends(Set<ManifestFile> committed) {\r\n     if (cachedNewDataManifests != null) {\r\n+      boolean hasDelete = false;\r\n       List<ManifestFile> committedNewDataManifests = Lists.newArrayList();\r\n       for (ManifestFile manifest : cachedNewDataManifests) {\r\n         if (committed.contains(manifest)) {\r\n           committedNewDataManifests.add(manifest);\r\n         } else {\r\n           deleteFile(manifest.path());\r\n+          hasDelete = true;\r\n         }\r\n       }\r\n \r\n-      this.cachedNewDataManifests = committedNewDataManifests;\r\n+      if (hasDelete) {\r\n+        cachedNewDataManifests = null;\r\n+      }\r\n     }\r\n \r\n     ListIterator<ManifestFile> deleteManifestsIterator = cachedNewDeleteManifests.listIterator();\r\n```\r\n\r\nThis is going to be better for transactions than always setting the cached manifests to null because the manifests are _usually_ in the committed list. We also need to check whether similar logic is needed for `cachedNewDeleteManifests`, which is also modified. I think we will need it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859376491/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859492897","html_url":"https://github.com/apache/iceberg/issues/9327#issuecomment-1859492897","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9327","id":1859492897,"node_id":"IC_kwDOCW7NX85u1Zwh","user":{"login":"BsoBird","id":30249475,"node_id":"MDQ6VXNlcjMwMjQ5NDc1","avatar_url":"https://avatars.githubusercontent.com/u/30249475?v=4","gravatar_id":"","url":"https://api.github.com/users/BsoBird","html_url":"https://github.com/BsoBird","followers_url":"https://api.github.com/users/BsoBird/followers","following_url":"https://api.github.com/users/BsoBird/following{/other_user}","gists_url":"https://api.github.com/users/BsoBird/gists{/gist_id}","starred_url":"https://api.github.com/users/BsoBird/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BsoBird/subscriptions","organizations_url":"https://api.github.com/users/BsoBird/orgs","repos_url":"https://api.github.com/users/BsoBird/repos","events_url":"https://api.github.com/users/BsoBird/events{/privacy}","received_events_url":"https://api.github.com/users/BsoBird/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T03:24:36Z","updated_at":"2023-12-18T03:24:36Z","author_association":"NONE","body":"@RussellSpitzer  @nastra \r\ncan you help me?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859492897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859495578","html_url":"https://github.com/apache/iceberg/issues/9327#issuecomment-1859495578","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9327","id":1859495578,"node_id":"IC_kwDOCW7NX85u1aaa","user":{"login":"BsoBird","id":30249475,"node_id":"MDQ6VXNlcjMwMjQ5NDc1","avatar_url":"https://avatars.githubusercontent.com/u/30249475?v=4","gravatar_id":"","url":"https://api.github.com/users/BsoBird","html_url":"https://github.com/BsoBird","followers_url":"https://api.github.com/users/BsoBird/followers","following_url":"https://api.github.com/users/BsoBird/following{/other_user}","gists_url":"https://api.github.com/users/BsoBird/gists{/gist_id}","starred_url":"https://api.github.com/users/BsoBird/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BsoBird/subscriptions","organizations_url":"https://api.github.com/users/BsoBird/orgs","repos_url":"https://api.github.com/users/BsoBird/repos","events_url":"https://api.github.com/users/BsoBird/events{/privacy}","received_events_url":"https://api.github.com/users/BsoBird/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T03:28:52Z","updated_at":"2023-12-18T03:35:31Z","author_association":"NONE","body":"I also found another situation where I have a table that has never had a CALL command executed on it. All I did was to run a MERGE INTO once a day, but after the OOM(Write interrupt), the table did happend same thing. It's been so long that I didn't keep a log of that scenario.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859495578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859496024","html_url":"https://github.com/apache/iceberg/issues/9327#issuecomment-1859496024","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9327","id":1859496024,"node_id":"IC_kwDOCW7NX85u1ahY","user":{"login":"BsoBird","id":30249475,"node_id":"MDQ6VXNlcjMwMjQ5NDc1","avatar_url":"https://avatars.githubusercontent.com/u/30249475?v=4","gravatar_id":"","url":"https://api.github.com/users/BsoBird","html_url":"https://github.com/BsoBird","followers_url":"https://api.github.com/users/BsoBird/followers","following_url":"https://api.github.com/users/BsoBird/following{/other_user}","gists_url":"https://api.github.com/users/BsoBird/gists{/gist_id}","starred_url":"https://api.github.com/users/BsoBird/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BsoBird/subscriptions","organizations_url":"https://api.github.com/users/BsoBird/orgs","repos_url":"https://api.github.com/users/BsoBird/repos","events_url":"https://api.github.com/users/BsoBird/events{/privacy}","received_events_url":"https://api.github.com/users/BsoBird/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T03:29:33Z","updated_at":"2023-12-18T03:30:39Z","author_association":"NONE","body":"@chennurchaitanya\r\nPlease check if this question is similar to yours We can discuss this issue together here","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859496024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859497363","html_url":"https://github.com/apache/iceberg/issues/9327#issuecomment-1859497363","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9327","id":1859497363,"node_id":"IC_kwDOCW7NX85u1a2T","user":{"login":"BsoBird","id":30249475,"node_id":"MDQ6VXNlcjMwMjQ5NDc1","avatar_url":"https://avatars.githubusercontent.com/u/30249475?v=4","gravatar_id":"","url":"https://api.github.com/users/BsoBird","html_url":"https://github.com/BsoBird","followers_url":"https://api.github.com/users/BsoBird/followers","following_url":"https://api.github.com/users/BsoBird/following{/other_user}","gists_url":"https://api.github.com/users/BsoBird/gists{/gist_id}","starred_url":"https://api.github.com/users/BsoBird/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BsoBird/subscriptions","organizations_url":"https://api.github.com/users/BsoBird/orgs","repos_url":"https://api.github.com/users/BsoBird/repos","events_url":"https://api.github.com/users/BsoBird/events{/privacy}","received_events_url":"https://api.github.com/users/BsoBird/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T03:31:38Z","updated_at":"2023-12-18T03:31:38Z","author_association":"NONE","body":"Slack link:   https://apache-iceberg.slack.com/archives/C025PH0G1D4/p1700291064787019","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859497363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859515258","html_url":"https://github.com/apache/iceberg/issues/9327#issuecomment-1859515258","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9327","id":1859515258,"node_id":"IC_kwDOCW7NX85u1fN6","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T04:02:57Z","updated_at":"2023-12-18T04:04:18Z","author_association":"MEMBER","body":"When I see this sort of thing it's usually one of two issues\r\n\r\n1. The user has accidentally run some command which deletes files without talking to iceberg, the snapshot refers to a file which no longer exists. This was done accidentally so the file must be removed via a metadata delete to get the table back to a healthy status. \r\n\r\n   Common reasons for this\r\n   * User has mutliple tables homed in the same directory, Remove orphan files for one deletes files for the other. This is generally unrecoverable and you'll notice that many files do not exist that should according to iceberg metadata\r\n   * User error, manually deleting a file.\r\n   * Third party ttl system\r\n\r\n2. The query is running a snapshot which has been expired but not yet removed from cache, or the  query was started and then the snapshot was expired. In this case you just refresh the cache and the query will work","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859515258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859523079","html_url":"https://github.com/apache/iceberg/issues/9327#issuecomment-1859523079","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9327","id":1859523079,"node_id":"IC_kwDOCW7NX85u1hIH","user":{"login":"BsoBird","id":30249475,"node_id":"MDQ6VXNlcjMwMjQ5NDc1","avatar_url":"https://avatars.githubusercontent.com/u/30249475?v=4","gravatar_id":"","url":"https://api.github.com/users/BsoBird","html_url":"https://github.com/BsoBird","followers_url":"https://api.github.com/users/BsoBird/followers","following_url":"https://api.github.com/users/BsoBird/following{/other_user}","gists_url":"https://api.github.com/users/BsoBird/gists{/gist_id}","starred_url":"https://api.github.com/users/BsoBird/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BsoBird/subscriptions","organizations_url":"https://api.github.com/users/BsoBird/orgs","repos_url":"https://api.github.com/users/BsoBird/repos","events_url":"https://api.github.com/users/BsoBird/events{/privacy}","received_events_url":"https://api.github.com/users/BsoBird/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T04:15:05Z","updated_at":"2023-12-18T04:15:21Z","author_association":"NONE","body":"@RussellSpitzer \r\n\r\n--User has mutliple tables homed in the same directory, Remove orphan files for one deletes files for the other. This is generally unrecoverable and you'll notice that many files do not exist that should according to iceberg metadata\r\nno,Our catalogues and tables are one-to-one.\r\n\r\n--User error, manually deleting a file.\r\nno. No one but me can manipulate iceberg's data files. And I just run the CALL command every day.\r\n\r\n--Third party ttl system\r\nno. we haven't.\r\n\r\n\r\n--The query is running a snapshot which has been expired but not yet removed from cache, or the query was started and then the snapshot was expired. In this case you just refresh the cache and the query will work\r\nHow do I flush the cache? I've restarted the spark job. I've restarted the spark job. If it's an in-memory cache, then it shouldn't have a problem. If it's cached in memory, then it shouldn't be a problem, and I do have a snapshot of the file.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859523079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859545554","html_url":"https://github.com/apache/iceberg/pull/9286#issuecomment-1859545554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9286","id":1859545554,"node_id":"IC_kwDOCW7NX85u1mnS","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T04:48:58Z","updated_at":"2023-12-18T04:48:58Z","author_association":"CONTRIBUTOR","body":"@nastra would be great if you reviewed this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859545554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859610834","html_url":"https://github.com/apache/iceberg/issues/9328#issuecomment-1859610834","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9328","id":1859610834,"node_id":"IC_kwDOCW7NX85u12jS","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T06:04:54Z","updated_at":"2023-12-18T06:04:54Z","author_association":"CONTRIBUTOR","body":"I do not really understand your question, but the Flink commit logic is described here: https://github.com/apache/iceberg/issues/9089#issuecomment-1843199768\r\n\r\nThis might help you ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859610834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859711825","html_url":"https://github.com/apache/iceberg/issues/9327#issuecomment-1859711825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9327","id":1859711825,"node_id":"IC_kwDOCW7NX85u2PNR","user":{"login":"BsoBird","id":30249475,"node_id":"MDQ6VXNlcjMwMjQ5NDc1","avatar_url":"https://avatars.githubusercontent.com/u/30249475?v=4","gravatar_id":"","url":"https://api.github.com/users/BsoBird","html_url":"https://github.com/BsoBird","followers_url":"https://api.github.com/users/BsoBird/followers","following_url":"https://api.github.com/users/BsoBird/following{/other_user}","gists_url":"https://api.github.com/users/BsoBird/gists{/gist_id}","starred_url":"https://api.github.com/users/BsoBird/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BsoBird/subscriptions","organizations_url":"https://api.github.com/users/BsoBird/orgs","repos_url":"https://api.github.com/users/BsoBird/repos","events_url":"https://api.github.com/users/BsoBird/events{/privacy}","received_events_url":"https://api.github.com/users/BsoBird/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T07:49:28Z","updated_at":"2023-12-18T09:43:25Z","author_association":"NONE","body":"I will submit a PR for fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859711825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859744822","html_url":"https://github.com/apache/iceberg/pull/9309#issuecomment-1859744822","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9309","id":1859744822,"node_id":"IC_kwDOCW7NX85u2XQ2","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T08:16:30Z","updated_at":"2023-12-18T08:16:30Z","author_association":"CONTRIBUTOR","body":"@stevenzwu: The v1.16 does not have the `ALLOW_UNALIGNED_SOURCE_SPLITS` yet, so I had to remove this setting. I still hope that the fix would be enough itself. Merged the changes.\r\nIs there a way to monitor the results of a specific test case?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859744822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859859240","html_url":"https://github.com/apache/iceberg/pull/9331#issuecomment-1859859240","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9331","id":1859859240,"node_id":"IC_kwDOCW7NX85u2zMo","user":{"login":"panbingkun","id":15246973,"node_id":"MDQ6VXNlcjE1MjQ2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/15246973?v=4","gravatar_id":"","url":"https://api.github.com/users/panbingkun","html_url":"https://github.com/panbingkun","followers_url":"https://api.github.com/users/panbingkun/followers","following_url":"https://api.github.com/users/panbingkun/following{/other_user}","gists_url":"https://api.github.com/users/panbingkun/gists{/gist_id}","starred_url":"https://api.github.com/users/panbingkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panbingkun/subscriptions","organizations_url":"https://api.github.com/users/panbingkun/orgs","repos_url":"https://api.github.com/users/panbingkun/repos","events_url":"https://api.github.com/users/panbingkun/events{/privacy}","received_events_url":"https://api.github.com/users/panbingkun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T09:11:30Z","updated_at":"2023-12-18T09:11:30Z","author_association":"CONTRIBUTOR","body":"The above modifications are based on the following document:\r\nhttps://github.com/actions/labeler/tree/main?tab=readme-ov-file#usage\r\n\r\nSome features have been validated in private repo\r\nhttps://github.com/panbingkun/github-action-test/pull/2\r\nhttps://github.com/panbingkun/github-action-test/pull/3\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859859240/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859864397","html_url":"https://github.com/apache/iceberg/pull/9320#issuecomment-1859864397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9320","id":1859864397,"node_id":"IC_kwDOCW7NX85u20dN","user":{"login":"panbingkun","id":15246973,"node_id":"MDQ6VXNlcjE1MjQ2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/15246973?v=4","gravatar_id":"","url":"https://api.github.com/users/panbingkun","html_url":"https://github.com/panbingkun","followers_url":"https://api.github.com/users/panbingkun/followers","following_url":"https://api.github.com/users/panbingkun/following{/other_user}","gists_url":"https://api.github.com/users/panbingkun/gists{/gist_id}","starred_url":"https://api.github.com/users/panbingkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panbingkun/subscriptions","organizations_url":"https://api.github.com/users/panbingkun/orgs","repos_url":"https://api.github.com/users/panbingkun/repos","events_url":"https://api.github.com/users/panbingkun/events{/privacy}","received_events_url":"https://api.github.com/users/panbingkun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T09:14:52Z","updated_at":"2023-12-18T09:14:52Z","author_association":"CONTRIBUTOR","body":"A new pr about it: https://github.com/apache/iceberg/pull/9331","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859864397/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859879328","html_url":"https://github.com/apache/iceberg/pull/9230#issuecomment-1859879328","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9230","id":1859879328,"node_id":"IC_kwDOCW7NX85u24Gg","user":{"login":"jasonf20","id":1601106,"node_id":"MDQ6VXNlcjE2MDExMDY=","avatar_url":"https://avatars.githubusercontent.com/u/1601106?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonf20","html_url":"https://github.com/jasonf20","followers_url":"https://api.github.com/users/jasonf20/followers","following_url":"https://api.github.com/users/jasonf20/following{/other_user}","gists_url":"https://api.github.com/users/jasonf20/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonf20/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonf20/subscriptions","organizations_url":"https://api.github.com/users/jasonf20/orgs","repos_url":"https://api.github.com/users/jasonf20/repos","events_url":"https://api.github.com/users/jasonf20/events{/privacy}","received_events_url":"https://api.github.com/users/jasonf20/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T09:24:46Z","updated_at":"2023-12-18T13:32:38Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue. Thanks for info. \r\n\r\nGood to know about the manifest compaction conflict case. I was looking for a way the list could be partially cleared and this answers that. \r\n\r\nI have pushed another commit returning to my original fix with the `hasDelete` optimization. \r\n\r\nSome more notes/questions:\r\n\r\n1. The transaction test I added did fail before the fix since the cleanup is called with `EMPTY_SET` anyway if the commit fails and the manifest list files are also cleaned up in `SnapshotProducer::cleanAll()`. The manifest lists being cleaned up required adding `forceReApply` fix and the manifest files are fixed by the change in `MergingSnapshotProducer`. I think this fix is still relevant as the test fails without it. Removing either of the fixes causes the test to fail. \r\n\r\n2. I understand that calling `commit()` again is only allowed by transaction in theory, but the API doesn't prevent this currently and I think it's safer to fix it for now. The only change that is specifically for this use case is the `forceReApply` I added to the transaction, the other changes are needed regardless. If we decide to block this at some point in the future the tests I added can be modified to verify that they get an invalid usage exception.\r\n\r\nWhat do you think?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1859879328/reactions","total_count":4,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":2,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860003242","html_url":"https://github.com/apache/iceberg/issues/9178#issuecomment-1860003242","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9178","id":1860003242,"node_id":"IC_kwDOCW7NX85u3WWq","user":{"login":"AllenWee1106","id":146182256,"node_id":"U_kgDOCLaQcA","avatar_url":"https://avatars.githubusercontent.com/u/146182256?v=4","gravatar_id":"","url":"https://api.github.com/users/AllenWee1106","html_url":"https://github.com/AllenWee1106","followers_url":"https://api.github.com/users/AllenWee1106/followers","following_url":"https://api.github.com/users/AllenWee1106/following{/other_user}","gists_url":"https://api.github.com/users/AllenWee1106/gists{/gist_id}","starred_url":"https://api.github.com/users/AllenWee1106/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AllenWee1106/subscriptions","organizations_url":"https://api.github.com/users/AllenWee1106/orgs","repos_url":"https://api.github.com/users/AllenWee1106/repos","events_url":"https://api.github.com/users/AllenWee1106/events{/privacy}","received_events_url":"https://api.github.com/users/AllenWee1106/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T10:08:53Z","updated_at":"2023-12-18T10:08:53Z","author_association":"NONE","body":"@Zhangg7723 \r\n![screenshot-20231218-180612](https://github.com/apache/iceberg/assets/146182256/a42dd52d-7bf8-42ae-90d7-e7a5bb0606c2)\r\nThank you. Is the method set in the above picture ? Or use table. properties. put ()?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860003242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860064933","html_url":"https://github.com/apache/iceberg/pull/8023#issuecomment-1860064933","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8023","id":1860064933,"node_id":"IC_kwDOCW7NX85u3lal","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T10:34:14Z","updated_at":"2023-12-18T10:34:14Z","author_association":"MEMBER","body":"Just linking the conclusion here as I was searching for it.\r\nhttps://lists.apache.org/thread/sv70lr0bwl9jmxtzvho2ml5xcrcpzf3b","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860064933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860081404","html_url":"https://github.com/apache/iceberg/issues/9178#issuecomment-1860081404","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9178","id":1860081404,"node_id":"IC_kwDOCW7NX85u3pb8","user":{"login":"Zhangg7723","id":18146312,"node_id":"MDQ6VXNlcjE4MTQ2MzEy","avatar_url":"https://avatars.githubusercontent.com/u/18146312?v=4","gravatar_id":"","url":"https://api.github.com/users/Zhangg7723","html_url":"https://github.com/Zhangg7723","followers_url":"https://api.github.com/users/Zhangg7723/followers","following_url":"https://api.github.com/users/Zhangg7723/following{/other_user}","gists_url":"https://api.github.com/users/Zhangg7723/gists{/gist_id}","starred_url":"https://api.github.com/users/Zhangg7723/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zhangg7723/subscriptions","organizations_url":"https://api.github.com/users/Zhangg7723/orgs","repos_url":"https://api.github.com/users/Zhangg7723/repos","events_url":"https://api.github.com/users/Zhangg7723/events{/privacy}","received_events_url":"https://api.github.com/users/Zhangg7723/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T10:42:13Z","updated_at":"2023-12-18T10:42:13Z","author_association":"CONTRIBUTOR","body":"> @Zhangg7723 ![screenshot-20231218-180612](https://private-user-images.githubusercontent.com/146182256/291238715-a42dd52d-7bf8-42ae-90d7-e7a5bb0606c2.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTEiLCJleHAiOjE3MDI4OTYzMzMsIm5iZiI6MTcwMjg5NjAzMywicGF0aCI6Ii8xNDYxODIyNTYvMjkxMjM4NzE1LWE0MmRkNTJkLTdiZjgtNDJhZS05MGQ3LWU3YTViYjA2MDZjMi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBSVdOSllBWDRDU1ZFSDUzQSUyRjIwMjMxMjE4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDIzMTIxOFQxMDQwMzNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mNjJmZmIxMDgwOTAzMTFjYzc5ZGQwYTIyYmFjNWRkZmZlNTZjMTk0MmQ4NzQ3YjAxMjIzZTFhZDQzNWUzY2RlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.HQfefQGsADWlKqIkKZVU1SOB4q9E5Qv--agcDqW3Cz4) Thank you. Is the method set in the above picture ? Or use table. properties. put ()?\r\n\r\nuse set() and don't forget to commit this update","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860081404/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860221881","html_url":"https://github.com/apache/iceberg/pull/9301#issuecomment-1860221881","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9301","id":1860221881,"node_id":"IC_kwDOCW7NX85u4Lu5","user":{"login":"deniskuzZ","id":2761528,"node_id":"MDQ6VXNlcjI3NjE1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2761528?v=4","gravatar_id":"","url":"https://api.github.com/users/deniskuzZ","html_url":"https://github.com/deniskuzZ","followers_url":"https://api.github.com/users/deniskuzZ/followers","following_url":"https://api.github.com/users/deniskuzZ/following{/other_user}","gists_url":"https://api.github.com/users/deniskuzZ/gists{/gist_id}","starred_url":"https://api.github.com/users/deniskuzZ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deniskuzZ/subscriptions","organizations_url":"https://api.github.com/users/deniskuzZ/orgs","repos_url":"https://api.github.com/users/deniskuzZ/repos","events_url":"https://api.github.com/users/deniskuzZ/events{/privacy}","received_events_url":"https://api.github.com/users/deniskuzZ/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T11:30:13Z","updated_at":"2023-12-18T11:30:13Z","author_association":"MEMBER","body":"@pvary, thanks for the review! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860221881/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860252682","html_url":"https://github.com/apache/iceberg/issues/9178#issuecomment-1860252682","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9178","id":1860252682,"node_id":"IC_kwDOCW7NX85u4TQK","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T11:44:03Z","updated_at":"2023-12-18T11:44:03Z","author_association":"CONTRIBUTOR","body":"@AllenWee1106  could you also try with higher  `commit.retry.num-retries` (default is 4) . to see if this decreases the conflicts. this is another [table property ](https://iceberg.apache.org/spec/#table-metadata-fields). or check it in debug logs to see if commit-retry happening at all? \r\n\r\n\r\nif that doesn't help, could try to add retry manually where you do commit operation. (Im not sure if the catalogs do retry operation by default)\r\n\r\n[more detail on commit resolution](https://iceberg.apache.org/spec/#commit-conflict-resolution-and-retry)\r\n\r\nan example: \r\nhttps://github.com/apache/iceberg/blob/9342f64a713ed4a1c540046ae5db91b3ac86ac02/core/src/main/java/org/apache/iceberg/BaseReplaceSortOrder.java#L39-L67\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860252682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860267364","html_url":"https://github.com/apache/iceberg/pull/9320#issuecomment-1860267364","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9320","id":1860267364,"node_id":"IC_kwDOCW7NX85u4W1k","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T11:49:53Z","updated_at":"2023-12-18T11:49:53Z","author_association":"MEMBER","body":"Closing in favour of https://github.com/apache/iceberg/pull/9331\r\n\r\nLast time we reverted this version bump as a quick fix to unblock PR builders. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860267364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860267634","html_url":"https://github.com/apache/iceberg/pull/9320#issuecomment-1860267634","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9320","id":1860267634,"node_id":"IC_kwDOCW7NX85u4W5y","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T11:49:56Z","updated_at":"2023-12-18T11:49:56Z","author_association":"CONTRIBUTOR","body":"OK, I won't notify you again about this release, but will get in touch when a new version is available. If you'd rather skip all updates until the next major or minor version, let me know by commenting `@dependabot ignore this major version` or `@dependabot ignore this minor version`. You can also ignore all major, minor, or patch releases for a dependency by adding an [`ignore` condition](https://docs.github.com/en/code-security/supply-chain-security/configuration-options-for-dependency-updates#ignore) with the desired `update_types` to your config file.\n\nIf you change your mind, just re-open this PR and I'll resolve any conflicts on it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860267634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":29110,"client_id":"Iv1.4f9a6346434f815e","slug":"dependabot","node_id":"MDM6QXBwMjkxMTA=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"Dependabot","description":"","external_url":"https://dependabot-api.githubapp.com","html_url":"https://github.com/apps/dependabot","created_at":"2019-04-16T22:34:25Z","updated_at":"2024-03-20T21:06:35Z","permissions":{"actions":"read","checks":"write","contents":"write","issues":"write","members":"read","metadata":"read","pull_requests":"write","statuses":"read","vulnerability_alerts":"read","workflows":"write"},"events":["check_suite","issues","issue_comment","label","pull_request","pull_request_review","pull_request_review_comment","repository"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860276788","html_url":"https://github.com/apache/iceberg/issues/9089#issuecomment-1860276788","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9089","id":1860276788,"node_id":"IC_kwDOCW7NX85u4ZI0","user":{"login":"FranMorilloAWS","id":85679820,"node_id":"MDQ6VXNlcjg1Njc5ODIw","avatar_url":"https://avatars.githubusercontent.com/u/85679820?v=4","gravatar_id":"","url":"https://api.github.com/users/FranMorilloAWS","html_url":"https://github.com/FranMorilloAWS","followers_url":"https://api.github.com/users/FranMorilloAWS/followers","following_url":"https://api.github.com/users/FranMorilloAWS/following{/other_user}","gists_url":"https://api.github.com/users/FranMorilloAWS/gists{/gist_id}","starred_url":"https://api.github.com/users/FranMorilloAWS/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FranMorilloAWS/subscriptions","organizations_url":"https://api.github.com/users/FranMorilloAWS/orgs","repos_url":"https://api.github.com/users/FranMorilloAWS/repos","events_url":"https://api.github.com/users/FranMorilloAWS/events{/privacy}","received_events_url":"https://api.github.com/users/FranMorilloAWS/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T11:51:58Z","updated_at":"2023-12-18T11:51:58Z","author_association":"NONE","body":"There is no other job writing to those tables, nor job with same operator id and job id writing.   So why could a table have a different checkpointID than the rest of the tables, and different from the number of checkpoints in that Flink Job?     What does happen is a compaction/ maintenance job run in spark that only maintains, it never adds any new data to table. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860276788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860284457","html_url":"https://github.com/apache/iceberg/pull/9313#issuecomment-1860284457","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9313","id":1860284457,"node_id":"IC_kwDOCW7NX85u4bAp","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T11:54:05Z","updated_at":"2023-12-18T11:54:05Z","author_association":"MEMBER","body":"Looks like env is flaky (only spark 3.3 test failed)\r\n\r\n`TestStoragePartitionedJoins > testJoinsWithDaysOnDateColumn FAILED\r\n`\r\n\r\nmkdir failed\r\n    \t```\r\nSuppressed: java.io.IOException: No space left on device\r\n    \t\tat java.io.FileOutputStream.writeBytes(Native Method)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860284457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860285720","html_url":"https://github.com/apache/iceberg/pull/9313#issuecomment-1860285720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9313","id":1860285720,"node_id":"IC_kwDOCW7NX85u4bUY","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T11:54:28Z","updated_at":"2023-12-18T11:54:28Z","author_association":"MEMBER","body":"@dependabot rebase","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860285720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860285884","html_url":"https://github.com/apache/iceberg/pull/9313#issuecomment-1860285884","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9313","id":1860285884,"node_id":"IC_kwDOCW7NX85u4bW8","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T11:54:31Z","updated_at":"2023-12-18T11:54:31Z","author_association":"CONTRIBUTOR","body":"Sorry, only users with push access can use that command.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860285884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":29110,"client_id":"Iv1.4f9a6346434f815e","slug":"dependabot","node_id":"MDM6QXBwMjkxMTA=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"Dependabot","description":"","external_url":"https://dependabot-api.githubapp.com","html_url":"https://github.com/apps/dependabot","created_at":"2019-04-16T22:34:25Z","updated_at":"2024-03-20T21:06:35Z","permissions":{"actions":"read","checks":"write","contents":"write","issues":"write","members":"read","metadata":"read","pull_requests":"write","statuses":"read","vulnerability_alerts":"read","workflows":"write"},"events":["check_suite","issues","issue_comment","label","pull_request","pull_request_review","pull_request_review_comment","repository"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860299155","html_url":"https://github.com/apache/iceberg/pull/9313#issuecomment-1860299155","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9313","id":1860299155,"node_id":"IC_kwDOCW7NX85u4emT","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T12:00:37Z","updated_at":"2023-12-18T12:00:37Z","author_association":"MEMBER","body":"> Sorry, only users with push access can use that command.\r\n\r\nPlease ask dependabot to rebase to retrigger the build. \r\ncc: @nastra, @Fokko  \r\n\r\nI can't close and reopen the PR as dependabot deletes the branch when PR is closed. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860299155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860311383","html_url":"https://github.com/apache/iceberg/pull/9333#issuecomment-1860311383","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9333","id":1860311383,"node_id":"IC_kwDOCW7NX85u4hlX","user":{"login":"BsoBird","id":30249475,"node_id":"MDQ6VXNlcjMwMjQ5NDc1","avatar_url":"https://avatars.githubusercontent.com/u/30249475?v=4","gravatar_id":"","url":"https://api.github.com/users/BsoBird","html_url":"https://github.com/BsoBird","followers_url":"https://api.github.com/users/BsoBird/followers","following_url":"https://api.github.com/users/BsoBird/following{/other_user}","gists_url":"https://api.github.com/users/BsoBird/gists{/gist_id}","starred_url":"https://api.github.com/users/BsoBird/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BsoBird/subscriptions","organizations_url":"https://api.github.com/users/BsoBird/orgs","repos_url":"https://api.github.com/users/BsoBird/repos","events_url":"https://api.github.com/users/BsoBird/events{/privacy}","received_events_url":"https://api.github.com/users/BsoBird/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T12:05:55Z","updated_at":"2023-12-18T12:05:55Z","author_association":"NONE","body":"@RussellSpitzer  Hi. can you check this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860311383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860352366","html_url":"https://github.com/apache/iceberg/issues/9089#issuecomment-1860352366","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9089","id":1860352366,"node_id":"IC_kwDOCW7NX85u4rlu","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T12:22:38Z","updated_at":"2023-12-18T12:22:38Z","author_association":"CONTRIBUTOR","body":"@FranMorilloAWS: Does the Spark job expires snapshots by any chance? If the Spark job removes the snapshots created by the Flink job, then it would cause the Flink job to forget the last committed checkpointId. But this would not describe how the checkpointId is advanced beyond the one created by the current job (are you sure on this?)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860352366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860370409","html_url":"https://github.com/apache/iceberg/pull/9313#issuecomment-1860370409","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9313","id":1860370409,"node_id":"IC_kwDOCW7NX85u4v_p","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T12:30:34Z","updated_at":"2023-12-18T12:30:34Z","author_association":"CONTRIBUTOR","body":"@dependabot rebase","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860370409/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860377763","html_url":"https://github.com/apache/iceberg/pull/9333#issuecomment-1860377763","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9333","id":1860377763,"node_id":"IC_kwDOCW7NX85u4xyj","user":{"login":"BsoBird","id":30249475,"node_id":"MDQ6VXNlcjMwMjQ5NDc1","avatar_url":"https://avatars.githubusercontent.com/u/30249475?v=4","gravatar_id":"","url":"https://api.github.com/users/BsoBird","html_url":"https://github.com/BsoBird","followers_url":"https://api.github.com/users/BsoBird/followers","following_url":"https://api.github.com/users/BsoBird/following{/other_user}","gists_url":"https://api.github.com/users/BsoBird/gists{/gist_id}","starred_url":"https://api.github.com/users/BsoBird/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BsoBird/subscriptions","organizations_url":"https://api.github.com/users/BsoBird/orgs","repos_url":"https://api.github.com/users/BsoBird/repos","events_url":"https://api.github.com/users/BsoBird/events{/privacy}","received_events_url":"https://api.github.com/users/BsoBird/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T12:33:43Z","updated_at":"2023-12-18T12:33:43Z","author_association":"NONE","body":"@RussellSpitzer  I have a question, since the versionId we defined is of type Integer, it looks like it could easily overflow. Isn't there some problem when it overflows?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860377763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860397381","html_url":"https://github.com/apache/iceberg/pull/9308#issuecomment-1860397381","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9308","id":1860397381,"node_id":"IC_kwDOCW7NX85u42lF","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T12:41:57Z","updated_at":"2023-12-18T12:41:57Z","author_association":"CONTRIBUTOR","body":"> These messages are executed in the same thread as the fetch method, so in this case we have to return from the fetch loop, even with empty results. This is somewhat concerning to me considering the comment here:\r\n\r\nI have checked, and the idleness is defined like this:\r\nhttps://github.com/apache/flink/blob/1d33773e6b7f9f76f03ff8ffd73171b95fa24ccb/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/reader/fetcher/SplitFetcher.java#L338-L345\r\n```\r\n    boolean isIdle() {\r\n        lock.lock();\r\n        try {\r\n            return assignedSplits.isEmpty() && taskQueue.isEmpty() && runningTask == null;\r\n        } finally {\r\n            lock.unlock();\r\n        }\r\n    }\r\n```\r\n\r\nSo if we have tasks (split manipulation/pause), then we are not idle, so the Fetcher is not removed.\r\n\r\nAlso the Fetcher also handles the `wakeUp` flag, so we are golden:\r\nhttps://github.com/apache/flink/blob/c28dd942e3dded4cab7a33037077a1d3bfa0929e/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/reader/fetcher/FetchTask.java#L61-L71\r\n```\r\n            if (!isWakenUp()) {\r\n                // The order matters here. We must first put the last records into the queue.\r\n                // This ensures the handling of the fetched records is atomic to wakeup.\r\n                if (elementsQueue.put(fetcherIndex, lastRecords)) {\r\n                    if (!lastRecords.finishedSplits().isEmpty()) {\r\n                        // The callback does not throw InterruptedException.\r\n                        splitFinishedCallback.accept(lastRecords.finishedSplits());\r\n                    }\r\n                    lastRecords = null;\r\n                }\r\n            }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860397381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860413716","html_url":"https://github.com/apache/iceberg/pull/9333#issuecomment-1860413716","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9333","id":1860413716,"node_id":"IC_kwDOCW7NX85u46kU","user":{"login":"BsoBird","id":30249475,"node_id":"MDQ6VXNlcjMwMjQ5NDc1","avatar_url":"https://avatars.githubusercontent.com/u/30249475?v=4","gravatar_id":"","url":"https://api.github.com/users/BsoBird","html_url":"https://github.com/BsoBird","followers_url":"https://api.github.com/users/BsoBird/followers","following_url":"https://api.github.com/users/BsoBird/following{/other_user}","gists_url":"https://api.github.com/users/BsoBird/gists{/gist_id}","starred_url":"https://api.github.com/users/BsoBird/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BsoBird/subscriptions","organizations_url":"https://api.github.com/users/BsoBird/orgs","repos_url":"https://api.github.com/users/BsoBird/repos","events_url":"https://api.github.com/users/BsoBird/events{/privacy}","received_events_url":"https://api.github.com/users/BsoBird/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T12:49:13Z","updated_at":"2023-12-18T12:49:13Z","author_association":"NONE","body":"If the int overflow doesn't cause any problems with versionId-related logic, I agree that the change to int->long will be reversed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860413716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860673870","html_url":"https://github.com/apache/iceberg/issues/8343#issuecomment-1860673870","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8343","id":1860673870,"node_id":"IC_kwDOCW7NX85u56FO","user":{"login":"MojoML","id":60922141,"node_id":"MDQ6VXNlcjYwOTIyMTQx","avatar_url":"https://avatars.githubusercontent.com/u/60922141?v=4","gravatar_id":"","url":"https://api.github.com/users/MojoML","html_url":"https://github.com/MojoML","followers_url":"https://api.github.com/users/MojoML/followers","following_url":"https://api.github.com/users/MojoML/following{/other_user}","gists_url":"https://api.github.com/users/MojoML/gists{/gist_id}","starred_url":"https://api.github.com/users/MojoML/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MojoML/subscriptions","organizations_url":"https://api.github.com/users/MojoML/orgs","repos_url":"https://api.github.com/users/MojoML/repos","events_url":"https://api.github.com/users/MojoML/events{/privacy}","received_events_url":"https://api.github.com/users/MojoML/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T14:39:14Z","updated_at":"2023-12-18T14:39:14Z","author_association":"NONE","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860673870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860773854","html_url":"https://github.com/apache/iceberg/issues/2633#issuecomment-1860773854","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2633","id":1860773854,"node_id":"IC_kwDOCW7NX85u6Sfe","user":{"login":"zz22394","id":516268,"node_id":"MDQ6VXNlcjUxNjI2OA==","avatar_url":"https://avatars.githubusercontent.com/u/516268?v=4","gravatar_id":"","url":"https://api.github.com/users/zz22394","html_url":"https://github.com/zz22394","followers_url":"https://api.github.com/users/zz22394/followers","following_url":"https://api.github.com/users/zz22394/following{/other_user}","gists_url":"https://api.github.com/users/zz22394/gists{/gist_id}","starred_url":"https://api.github.com/users/zz22394/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zz22394/subscriptions","organizations_url":"https://api.github.com/users/zz22394/orgs","repos_url":"https://api.github.com/users/zz22394/repos","events_url":"https://api.github.com/users/zz22394/events{/privacy}","received_events_url":"https://api.github.com/users/zz22394/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T15:13:00Z","updated_at":"2023-12-18T15:13:00Z","author_association":"NONE","body":"Short answer:\r\nYes.\r\n\r\nRef:\r\n# How does Iceberg handle multiple concurrent writes?\r\nhttps://www.dremio.com/apache-iceberg-faq/#h-how-does-iceberg-handle-multiple-concurrent-writes\r\n```\r\nIceberg uses \"optimistic concurrency\" to provide transactional guarantees during multiple concurrent writes.\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860773854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860777197","html_url":"https://github.com/apache/iceberg/issues/2633#issuecomment-1860777197","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2633","id":1860777197,"node_id":"IC_kwDOCW7NX85u6TTt","user":{"login":"zz22394","id":516268,"node_id":"MDQ6VXNlcjUxNjI2OA==","avatar_url":"https://avatars.githubusercontent.com/u/516268?v=4","gravatar_id":"","url":"https://api.github.com/users/zz22394","html_url":"https://github.com/zz22394","followers_url":"https://api.github.com/users/zz22394/followers","following_url":"https://api.github.com/users/zz22394/following{/other_user}","gists_url":"https://api.github.com/users/zz22394/gists{/gist_id}","starred_url":"https://api.github.com/users/zz22394/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zz22394/subscriptions","organizations_url":"https://api.github.com/users/zz22394/orgs","repos_url":"https://api.github.com/users/zz22394/repos","events_url":"https://api.github.com/users/zz22394/events{/privacy}","received_events_url":"https://api.github.com/users/zz22394/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T15:14:15Z","updated_at":"2023-12-18T15:14:15Z","author_association":"NONE","body":"https://iceberg.apache.org/docs/latest/spark-writes/\r\n**MERGE INTO** is recommended instead of **INSERT OVERWRITE** because Iceberg can replace only the affected data files","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1860777197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861098805","html_url":"https://github.com/apache/iceberg/pull/9309#issuecomment-1861098805","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9309","id":1861098805,"node_id":"IC_kwDOCW7NX85u7h01","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T17:15:02Z","updated_at":"2023-12-18T17:15:02Z","author_association":"CONTRIBUTOR","body":"@pvary you can monitor the actions/workflows for Flink CI. https://github.com/apache/iceberg/actions/workflows/flink-ci.yml","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861098805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861228366","html_url":"https://github.com/apache/iceberg/pull/7844#issuecomment-1861228366","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7844","id":1861228366,"node_id":"IC_kwDOCW7NX85u8BdO","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T18:09:47Z","updated_at":"2023-12-18T18:09:47Z","author_association":"CONTRIBUTOR","body":"This class cannot use a blocking queue with the worker pool, so I'm -1 on this change.\r\n\r\nThe problem is that planning uses a shared threadpool. Using a blocking queue would cause tasks to stall, which would then tie up the threads in the shared pool and cause all planning to halt.\r\n\r\nIf you want to limit memory consumption here, then you need to do the following:\r\n1. Add a new `BlockingParallelIterable`\r\n2. Use a blocking queue in `BlockingParallelIterable`\r\n3. Use an isolated threadpool in `BlockingParallelIterable` that is not shared with other planning tasks\r\n\r\nOnce that new variant is in, we can look at how to use it from the scan API. Feel free to contact me to review this, since this is a part of the code where bad changes can cause a lot of trouble!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861228366/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861255463","html_url":"https://github.com/apache/iceberg/pull/9308#issuecomment-1861255463","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9308","id":1861255463,"node_id":"IC_kwDOCW7NX85u8IEn","user":{"login":"mas-chen","id":6834335,"node_id":"MDQ6VXNlcjY4MzQzMzU=","avatar_url":"https://avatars.githubusercontent.com/u/6834335?v=4","gravatar_id":"","url":"https://api.github.com/users/mas-chen","html_url":"https://github.com/mas-chen","followers_url":"https://api.github.com/users/mas-chen/followers","following_url":"https://api.github.com/users/mas-chen/following{/other_user}","gists_url":"https://api.github.com/users/mas-chen/gists{/gist_id}","starred_url":"https://api.github.com/users/mas-chen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mas-chen/subscriptions","organizations_url":"https://api.github.com/users/mas-chen/orgs","repos_url":"https://api.github.com/users/mas-chen/repos","events_url":"https://api.github.com/users/mas-chen/events{/privacy}","received_events_url":"https://api.github.com/users/mas-chen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T18:21:21Z","updated_at":"2023-12-18T18:21:21Z","author_association":"CONTRIBUTOR","body":"BTW, should we add an integration test?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861255463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861257079","html_url":"https://github.com/apache/iceberg/pull/9230#issuecomment-1861257079","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9230","id":1861257079,"node_id":"IC_kwDOCW7NX85u8Id3","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T18:22:01Z","updated_at":"2023-12-18T18:22:10Z","author_association":"CONTRIBUTOR","body":"> I think this fix is still relevant as the test fails without it.\r\n\r\nTo which test case are you referring? I didn't think any of them were valid uses of the API because commit was called multiple times and the behavior is undefined.\r\n\r\n> The only change that is specifically for this use case is the forceReApply I added to the transaction\r\n\r\nWhat is the purpose of `forceReApply`?\r\n\r\nI think that we should focus on fixing the bug and then discuss cases where `commit` or `commitTransaction` are called multiple times. The important thing is getting a fix we can put in a patch release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861257079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861295520","html_url":"https://github.com/apache/iceberg/pull/7161#issuecomment-1861295520","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7161","id":1861295520,"node_id":"IC_kwDOCW7NX85u8R2g","user":{"login":"bendevera","id":6827916,"node_id":"MDQ6VXNlcjY4Mjc5MTY=","avatar_url":"https://avatars.githubusercontent.com/u/6827916?v=4","gravatar_id":"","url":"https://api.github.com/users/bendevera","html_url":"https://github.com/bendevera","followers_url":"https://api.github.com/users/bendevera/followers","following_url":"https://api.github.com/users/bendevera/following{/other_user}","gists_url":"https://api.github.com/users/bendevera/gists{/gist_id}","starred_url":"https://api.github.com/users/bendevera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bendevera/subscriptions","organizations_url":"https://api.github.com/users/bendevera/orgs","repos_url":"https://api.github.com/users/bendevera/repos","events_url":"https://api.github.com/users/bendevera/events{/privacy}","received_events_url":"https://api.github.com/users/bendevera/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T18:38:17Z","updated_at":"2023-12-18T18:38:17Z","author_association":"NONE","body":"@stevenzwu I see defaulting to `BucketPartitioner` was reverted here: https://github.com/apache/iceberg/pull/8848\r\n\r\nWe've found performance issues with `DistributionMode.HASH`, and wanted to test `BucketPartitioner` but it isn't `public`. \r\n\r\nYou mentioned above that to use the bucketing partitioner, users will need to manually apply `keyBy`. Believe the code snippet though is the default `HASH` logic. What is the recommended method for using the bucket partitioner and any issues reported by users that resulted in reverting?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861295520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861356815","html_url":"https://github.com/apache/iceberg/pull/9308#issuecomment-1861356815","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9308","id":1861356815,"node_id":"IC_kwDOCW7NX85u8g0P","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T19:03:22Z","updated_at":"2023-12-18T19:03:22Z","author_association":"CONTRIBUTOR","body":"> BTW, should we add an integration test?\r\n\r\nThat reminds me, to remove the `set(PipelineOptions.ALLOW_UNALIGNED_SOURCE_SPLITS, true)` from the `TestIcebergSourceWithWatermarkExtractor` test. That is how I have found this issue.\r\n\r\nThe `TestIcebergSourceWithWatermarkExtractor.testThrottling` was slightly flaky because of this change (1 out of 1000), but I do not see any other good way to integration test it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1861356815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]